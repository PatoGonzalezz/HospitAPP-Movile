(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{5984:(Gn,At,K)=>{"use strict";K.d(At,{w:()=>en});var I=K(7582),dt=K(5592),l=K(2438),ve={error:"cordova_not_available"},Ue={error:"plugin_not_installed"};function Le(bt){if(typeof window<"u"&&window.angular){var ue=window.document,me=window.angular.element(ue.querySelector("[ng-app]")||ue.body).injector();if(me)return me.get("$q")(function(ct,Lt){bt(ct,Lt)});console.warn("Angular 1 was detected but $q couldn't be retrieved. This is usually when the app is not bootstrapped on the html or body tag. Falling back to native promises which won't trigger an automatic digest when promises resolve.")}return function(){if(Promise)return new Promise(function(ct,Lt){bt(ct,Lt)});console.error("No Promise support or polyfill found. To enable Ionic Native support, please add the es6-promise polyfill before this script, or run with a library like Angular or on a recent browser.")}()}function Ze(bt,$e,ue){var me,ze;"string"==typeof bt?me=bt:(me=bt.constructor.getPluginRef(),ue=bt.constructor.getPluginName(),ze=bt.constructor.getPluginInstallName());var ct=_t(me);return!(!ct||$e&&typeof ct[$e]>"u")||(typeof window>"u"||!window.cordova?(function Ft(bt,$e){typeof process>"u"&&console.warn($e?"Native: tried calling "+bt+"."+$e+", but Cordova is not available. Make sure to include cordova.js or run in a device/simulator":"Native: tried accessing the "+bt+" plugin but Cordova is not available. Make sure to include cordova.js or run in a device/simulator")}(ue,$e),ve):(function Bt(bt,$e,ue){console.warn(ue?"Native: tried calling "+bt+"."+ue+", but the "+bt+" plugin is not installed.":"Native: tried accessing the "+bt+" plugin but it's not installed."),$e&&console.warn("Install the "+bt+" plugin: 'ionic cordova plugin add "+$e+"'")}(ue,ze,$e),Ue))}function pt(bt,$e,ue,me,ze,ct){void 0===me&&(me={}),ue=function lt(bt,$e,ue,me){if(void 0===$e&&($e={}),$e.sync)return bt;if("reverse"===$e.callbackOrder)bt.unshift(me),bt.unshift(ue);else if("node"===$e.callbackStyle)bt.push(function(Gt,Yt){Gt?me(Gt):ue(Yt)});else if("object"===$e.callbackStyle&&$e.successName&&$e.errorName){var ze={};ze[$e.successName]=ue,ze[$e.errorName]=me,bt.push(ze)}else if(typeof $e.successIndex<"u"||typeof $e.errorIndex<"u"){var ct=function(){$e.successIndex>bt.length?bt[$e.successIndex]=ue:bt.splice($e.successIndex,0,ue)},Lt=function(){$e.errorIndex>bt.length?bt[$e.errorIndex]=me:bt.splice($e.errorIndex,0,me)};$e.successIndex>$e.errorIndex?(Lt(),ct()):(ct(),Lt())}else bt.push(ue),bt.push(me);return bt}(ue,me,ze,ct);var Lt=Ze(bt,$e);if(!0===Lt){var Gt=_t(bt.constructor.getPluginRef());return Gt[$e].apply(Gt,ue)}return Lt}function _t(bt){return typeof window<"u"?nt(window,bt):null}function nt(bt,$e){for(var ue=$e.split("."),me=bt,ze=0;ze<ue.length;ze++){if(!me)return null;me=me[ue[ze]]}return me}var Je=function(){function bt(){}return bt.installed=function(){return!0===Ze(this.pluginRef)},bt.getPlugin=function(){return typeof window<"u"?function ht(bt,$e){for(var ue=$e.split("."),me=bt,ze=0;ze<ue.length;ze++){if(!me)return null;me=me[ue[ze]]}return me}(window,this.pluginRef):null},bt.getPluginName=function(){return this.pluginName},bt.getPluginRef=function(){return this.pluginRef},bt.getPluginInstallName=function(){return this.plugin},bt.getSupportedPlatforms=function(){return this.platforms},bt.pluginName="",bt.pluginRef="",bt.plugin="",bt.repo="",bt.platforms=[],bt.install="",bt}();function mt(bt,$e,ue,me){return function(bt,$e,ue){return void 0===ue&&(ue={}),function(){for(var me=[],ze=0;ze<arguments.length;ze++)me[ze]=arguments[ze];return ue.sync?pt(bt,$e,me,ue):ue.observable?function xe(bt,$e,ue,me){return void 0===me&&(me={}),new dt.y(function(ze){var ct;return ct=me.destruct?pt(bt,$e,ue,me,function(){for(var Lt=[],Gt=0;Gt<arguments.length;Gt++)Lt[Gt]=arguments[Gt];return ze.next(Lt)},function(){for(var Lt=[],Gt=0;Gt<arguments.length;Gt++)Lt[Gt]=arguments[Gt];return ze.error(Lt)}):pt(bt,$e,ue,me,ze.next.bind(ze),ze.error.bind(ze)),ct&&ct.error&&(ze.error(ct.error),ze.complete()),function(){try{if(me.clearFunction)return me.clearWithArgs?pt(bt,me.clearFunction,ue,me,ze.next.bind(ze),ze.error.bind(ze)):pt(bt,me.clearFunction,[])}catch(Lt){console.warn("Unable to clear the previous observable watch for",bt.constructor.getPluginName(),$e),console.warn(Lt)}}})}(bt,$e,me,ue):ue.eventObservable&&ue.event?function Re(bt,$e){return $e=typeof window<"u"&&$e?nt(window,$e):$e||(typeof window<"u"?window:{}),(0,l.R)($e,bt)}(ue.event,ue.element):ue.otherPromise?function et(bt,$e,ue,me){return void 0===me&&(me={}),Le(function(ze,ct){var Lt=pt(bt,$e,ue,me);Lt?Lt.error?ct(Lt.error):Lt.then&&Lt.then(ze).catch(ct):ct({error:"unexpected_error"})})}(bt,$e,me,ue):function it(bt,$e,ue,me){void 0===me&&(me={});var ze,ct,Lt=Le(function(Gt,Yt){ze=me.destruct?pt(bt,$e,ue,me,function(){for(var hn=[],sn=0;sn<arguments.length;sn++)hn[sn]=arguments[sn];return Gt(hn)},function(){for(var hn=[],sn=0;sn<arguments.length;sn++)hn[sn]=arguments[sn];return Yt(hn)}):pt(bt,$e,ue,me,Gt,Yt),ct=Yt});return ze&&ze.error&&(Lt.catch(function(){}),"function"==typeof ct&&ct(ze.error)),Lt}(bt,$e,me,ue)}}(bt,$e,ue).apply(this,me)}!function b(){if(typeof process>"u"){var bt=typeof window<"u"?window:{},ue=Date.now(),me=!1;bt.document.addEventListener("deviceready",function(){console.log("Ionic Native: deviceready event fired after "+(Date.now()-ue)+" ms"),me=!0}),setTimeout(function(){!me&&bt.cordova&&console.warn("Ionic Native: deviceready did not fire within 5000ms. This can happen when plugins are in an inconsistent state. Try removing plugins from plugins/ and reinstalling them.")},5e3)}}();var Yn=K(5879),en=function(bt){function $e(){return null!==bt&&bt.apply(this,arguments)||this}return(0,I.ZT)($e,bt),$e.prototype.hasPermission=function(){return mt(this,"hasPermission",{successIndex:0,errorIndex:2},arguments)},$e.prototype.requestPermission=function(){return mt(this,"requestPermission",{successIndex:0,errorIndex:2},arguments)},$e.prototype.hasAccount=function(){var ue=this;return function(){if(!0===Ze(ue))return Le(function(me){$e.getPlugin().hasAccount(function(ze){me(!!ze)})})}()},$e.prototype.hasClient=function(ue){var me=this;return function(){if(!0===Ze(me))return Le(function(ze){ue?$e.getPlugin().hasClient(ue,function(ct){ze(!!ct)}):$e.getPlugin().getClients(function(ct){ze(ct&&ct.length>0)})})}()},$e.prototype.getClients=function(){var ue=this;return function(){if(!0===Ze(ue))return Le(function(me){$e.getPlugin().getClients(function(ze){"[object String]"===Object.prototype.toString.call(ze)&&(ze=[ze]),me(ze)})})}()},$e.prototype.isAvailable=function(ue){var me=this;return function(){if(!0===Ze(me))return Le(function(ze){Promise.all([me.hasAccount,me.hasClient(ue)]).then(function(ct){return ze(2===ct.length&&ct[0]&&ct[1])})})}()},$e.prototype.open=function(ue,me){return mt(this,"open",{successIndex:1,errorIndex:3},arguments)},$e.prototype.addAlias=function(ue,me){return mt(this,"addAlias",{},arguments)},$e.\u0275fac=function(){let ue;return function(ze){return(ue||(ue=Yn.n5z($e)))(ze||$e)}}(),$e.\u0275prov=Yn.Yz7({token:$e,factory:$e.\u0275fac}),$e.pluginName="EmailComposer",$e.plugin="cordova-plugin-email-composer",$e.pluginRef="cordova.plugins.email",$e.repo="https://github.com/katzer/cordova-plugin-email-composer",$e.platforms=["Amazon Fire OS","Android","Browser","iOS","Windows","macOS"],$e=(0,I.gn)([],$e)}(Je)},9058:(Gn,At,K)=>{"use strict";K.d(At,{BH:()=>ht,G6:()=>$e,L:()=>et,LL:()=>Gt,P0:()=>Ft,Pz:()=>Me,Sg:()=>It,UG:()=>Kt,ZB:()=>Ze,ZR:()=>Lt,aH:()=>Se,b$:()=>on,eu:()=>me,hl:()=>ue,jU:()=>Ut,m9:()=>yn,ne:()=>gr,pd:()=>Er,q4:()=>Bt,r3:()=>nr,ru:()=>dn,tV:()=>xe,uI:()=>mt,vZ:()=>bn,w1:()=>Yn,xO:()=>hi,xb:()=>Kn,z$:()=>Je,zd:()=>fr});const l=function(Be){const le=[];let de=0;for(let Ne=0;Ne<Be.length;Ne++){let pe=Be.charCodeAt(Ne);pe<128?le[de++]=pe:pe<2048?(le[de++]=pe>>6|192,le[de++]=63&pe|128):55296==(64512&pe)&&Ne+1<Be.length&&56320==(64512&Be.charCodeAt(Ne+1))?(pe=65536+((1023&pe)<<10)+(1023&Be.charCodeAt(++Ne)),le[de++]=pe>>18|240,le[de++]=pe>>12&63|128,le[de++]=pe>>6&63|128,le[de++]=63&pe|128):(le[de++]=pe>>12|224,le[de++]=pe>>6&63|128,le[de++]=63&pe|128)}return le},Ue={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(Be,le){if(!Array.isArray(Be))throw Error("encodeByteArray takes an array as a parameter");this.init_();const de=le?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ne=[];for(let pe=0;pe<Be.length;pe+=3){const ot=Be[pe],$t=pe+1<Be.length,vn=$t?Be[pe+1]:0,Xn=pe+2<Be.length,Wn=Xn?Be[pe+2]:0;let Wr=(15&vn)<<2|Wn>>6,ni=63&Wn;Xn||(ni=64,$t||(Wr=64)),Ne.push(de[ot>>2],de[(3&ot)<<4|vn>>4],de[Wr],de[ni])}return Ne.join("")},encodeString(Be,le){return this.HAS_NATIVE_SUPPORT&&!le?btoa(Be):this.encodeByteArray(l(Be),le)},decodeString(Be,le){return this.HAS_NATIVE_SUPPORT&&!le?atob(Be):function(Be){const le=[];let de=0,Ne=0;for(;de<Be.length;){const pe=Be[de++];if(pe<128)le[Ne++]=String.fromCharCode(pe);else if(pe>191&&pe<224){const ot=Be[de++];le[Ne++]=String.fromCharCode((31&pe)<<6|63&ot)}else if(pe>239&&pe<365){const Xn=((7&pe)<<18|(63&Be[de++])<<12|(63&Be[de++])<<6|63&Be[de++])-65536;le[Ne++]=String.fromCharCode(55296+(Xn>>10)),le[Ne++]=String.fromCharCode(56320+(1023&Xn))}else{const ot=Be[de++],$t=Be[de++];le[Ne++]=String.fromCharCode((15&pe)<<12|(63&ot)<<6|63&$t)}}return le.join("")}(this.decodeStringToByteArray(Be,le))},decodeStringToByteArray(Be,le){this.init_();const de=le?this.charToByteMapWebSafe_:this.charToByteMap_,Ne=[];for(let pe=0;pe<Be.length;){const ot=de[Be.charAt(pe++)],vn=pe<Be.length?de[Be.charAt(pe)]:0;++pe;const Wn=pe<Be.length?de[Be.charAt(pe)]:64;++pe;const vr=pe<Be.length?de[Be.charAt(pe)]:64;if(++pe,null==ot||null==vn||null==Wn||null==vr)throw new Le;Ne.push(ot<<2|vn>>4),64!==Wn&&(Ne.push(vn<<4&240|Wn>>2),64!==vr&&Ne.push(Wn<<6&192|vr))}return Ne},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let Be=0;Be<this.ENCODED_VALS.length;Be++)this.byteToCharMap_[Be]=this.ENCODED_VALS.charAt(Be),this.charToByteMap_[this.byteToCharMap_[Be]]=Be,this.byteToCharMapWebSafe_[Be]=this.ENCODED_VALS_WEBSAFE.charAt(Be),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[Be]]=Be,Be>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(Be)]=Be,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(Be)]=Be)}}};class Le extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const et=function(Be){return function(Be){const le=l(Be);return Ue.encodeByteArray(le,!0)}(Be).replace(/\./g,"")},xe=function(Be){try{return Ue.decodeString(Be,!0)}catch(le){console.error("base64Decode failed: ",le)}return null};function Ze(Be,le){if(!(le instanceof Object))return le;switch(le.constructor){case Date:return new Date(le.getTime());case Object:void 0===Be&&(Be={});break;case Array:Be=[];break;default:return le}for(const de in le)!le.hasOwnProperty(de)||!tt(de)||(Be[de]=Ze(Be[de],le[de]));return Be}function tt(Be){return"__proto__"!==Be}const nt=()=>{try{return function lt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const Be=process.env.__FIREBASE_DEFAULTS__;return Be?JSON.parse(Be):void 0})()||(()=>{if(typeof document>"u")return;let Be;try{Be=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const le=Be&&xe(Be[1]);return le&&JSON.parse(le)})()}catch(Be){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${Be}`)}},Bt=Be=>{var le,de;return null===(de=null===(le=nt())||void 0===le?void 0:le.emulatorHosts)||void 0===de?void 0:de[Be]},Ft=Be=>{const le=Bt(Be);if(!le)return;const de=le.lastIndexOf(":");if(de<=0||de+1===le.length)throw new Error(`Invalid host ${le} with no separate hostname and port!`);const Ne=parseInt(le.substring(de+1),10);return"["===le[0]?[le.substring(1,de-1),Ne]:[le.substring(0,de),Ne]},Se=()=>{var Be;return null===(Be=nt())||void 0===Be?void 0:Be.config},Me=Be=>{var le;return null===(le=nt())||void 0===le?void 0:le[`_${Be}`]};class ht{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((le,de)=>{this.resolve=le,this.reject=de})}wrapCallback(le){return(de,Ne)=>{de?this.reject(de):this.resolve(Ne),"function"==typeof le&&(this.promise.catch(()=>{}),1===le.length?le(de):le(de,Ne))}}}function It(Be,le){if(Be.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ne=le||"demo-project",pe=Be.iat||0,ot=Be.sub||Be.user_id;if(!ot)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const $t=Object.assign({iss:`https://securetoken.google.com/${Ne}`,aud:Ne,iat:pe,exp:pe+3600,auth_time:pe,sub:ot,user_id:ot,firebase:{sign_in_provider:"custom",identities:{}}},Be);return[et(JSON.stringify({alg:"none",type:"JWT"})),et(JSON.stringify($t)),""].join(".")}function Je(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function mt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Je())}function Kt(){var Be;const le=null===(Be=nt())||void 0===Be?void 0:Be.forceEnvironment;if("node"===le)return!0;if("browser"===le)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Ut(){return"object"==typeof self&&self.self===self}function dn(){const Be="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof Be&&void 0!==Be.id}function on(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Yn(){const Be=Je();return Be.indexOf("MSIE ")>=0||Be.indexOf("Trident/")>=0}function $e(){return!Kt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ue(){try{return"object"==typeof indexedDB}catch{return!1}}function me(){return new Promise((Be,le)=>{try{let de=!0;const Ne="validate-browser-context-for-indexeddb-analytics-module",pe=self.indexedDB.open(Ne);pe.onsuccess=()=>{pe.result.close(),de||self.indexedDB.deleteDatabase(Ne),Be(!0)},pe.onupgradeneeded=()=>{de=!1},pe.onerror=()=>{var ot;le((null===(ot=pe.error)||void 0===ot?void 0:ot.message)||"")}}catch(de){le(de)}})}class Lt extends Error{constructor(le,de,Ne){super(de),this.code=le,this.customData=Ne,this.name="FirebaseError",Object.setPrototypeOf(this,Lt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gt.prototype.create)}}class Gt{constructor(le,de,Ne){this.service=le,this.serviceName=de,this.errors=Ne}create(le,...de){const Ne=de[0]||{},pe=`${this.service}/${le}`,ot=this.errors[le],$t=ot?function Yt(Be,le){return Be.replace(hn,(de,Ne)=>{const pe=le[Ne];return null!=pe?String(pe):`<${Ne}?>`})}(ot,Ne):"Error";return new Lt(pe,`${this.serviceName}: ${$t} (${pe}).`,Ne)}}const hn=/\{\$([^}]+)}/g;function nr(Be,le){return Object.prototype.hasOwnProperty.call(Be,le)}function Kn(Be){for(const le in Be)if(Object.prototype.hasOwnProperty.call(Be,le))return!1;return!0}function bn(Be,le){if(Be===le)return!0;const de=Object.keys(Be),Ne=Object.keys(le);for(const pe of de){if(!Ne.includes(pe))return!1;const ot=Be[pe],$t=le[pe];if(Jr(ot)&&Jr($t)){if(!bn(ot,$t))return!1}else if(ot!==$t)return!1}for(const pe of Ne)if(!de.includes(pe))return!1;return!0}function Jr(Be){return null!==Be&&"object"==typeof Be}function hi(Be){const le=[];for(const[de,Ne]of Object.entries(Be))Array.isArray(Ne)?Ne.forEach(pe=>{le.push(encodeURIComponent(de)+"="+encodeURIComponent(pe))}):le.push(encodeURIComponent(de)+"="+encodeURIComponent(Ne));return le.length?"&"+le.join("&"):""}function fr(Be){const le={};return Be.replace(/^\?/,"").split("&").forEach(Ne=>{if(Ne){const[pe,ot]=Ne.split("=");le[decodeURIComponent(pe)]=decodeURIComponent(ot)}}),le}function Er(Be){const le=Be.indexOf("?");if(!le)return"";const de=Be.indexOf("#",le);return Be.substring(le,de>0?de:void 0)}function gr(Be,le){const de=new Ci(Be,le);return de.subscribe.bind(de)}class Ci{constructor(le,de){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=de,this.task.then(()=>{le(this)}).catch(Ne=>{this.error(Ne)})}next(le){this.forEachObserver(de=>{de.next(le)})}error(le){this.forEachObserver(de=>{de.error(le)}),this.close(le)}complete(){this.forEachObserver(le=>{le.complete()}),this.close()}subscribe(le,de,Ne){let pe;if(void 0===le&&void 0===de&&void 0===Ne)throw new Error("Missing Observer.");pe=function Sr(Be,le){if("object"!=typeof Be||null===Be)return!1;for(const de of le)if(de in Be&&"function"==typeof Be[de])return!0;return!1}(le,["next","error","complete"])?le:{next:le,error:de,complete:Ne},void 0===pe.next&&(pe.next=Ai),void 0===pe.error&&(pe.error=Ai),void 0===pe.complete&&(pe.complete=Ai);const ot=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?pe.error(this.finalError):pe.complete()}catch{}}),this.observers.push(pe),ot}unsubscribeOne(le){void 0===this.observers||void 0===this.observers[le]||(delete this.observers[le],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(le){if(!this.finalized)for(let de=0;de<this.observers.length;de++)this.sendOne(de,le)}sendOne(le,de){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[le])try{de(this.observers[le])}catch(Ne){typeof console<"u"&&console.error&&console.error(Ne)}})}close(le){this.finalized||(this.finalized=!0,void 0!==le&&(this.finalError=le),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ai(){}function yn(Be){return Be&&Be._delegate?Be._delegate:Be}},6506:(Gn,At,K)=>{"use strict";K.d(At,{c:()=>vt});var I=K(7643),b=K(544);let dt;const ve=_t=>_t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ue=_t=>(void 0===dt&&(dt=void 0===_t.style.animationName&&void 0!==_t.style.webkitAnimationName?"-webkit-":""),dt),Le=(_t,nt,Bt)=>{const Ft=nt.startsWith("animation")?Ue(_t):"";_t.style.setProperty(Ft+nt,Bt)},it=(_t,nt)=>{const Bt=nt.startsWith("animation")?Ue(_t):"";_t.style.removeProperty(Bt+nt)},Re=[],pt=(_t=[],nt)=>{if(void 0!==nt){const Bt=Array.isArray(nt)?nt:[nt];return[..._t,...Bt]}return _t},vt=_t=>{let nt,Bt,Ft,Se,Me,ht,Ut,ue,me,ze,ct,hn,sn,It=[],Je=[],mt=[],Kt=!1,dn={},on=[],Ht=[],Yn={},en=0,bt=!1,$e=!1,Lt=!0,Gt=!1,Yt=!0,jt=!1;const Xt=_t,an=[],mn=[],Bn=[],mr=[],nr=[],_r=[],Kn=[],Lr=[],bn=[],Jr=[],Fi="function"==typeof AnimationEffect||void 0!==I.w&&"function"==typeof I.w.AnimationEffect,hi="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Fi,Er=()=>Jr,Sr=(Ce,Ve)=>((Ve?.oneTimeCallback?mn:an).push({c:Ce,o:Ve}),sn),vi=()=>{if(hi)Jr.forEach(Ce=>{Ce.cancel()}),Jr.length=0;else{const Ce=Bn.slice();(0,b.r)(()=>{Ce.forEach(Ve=>{it(Ve,"animation-name"),it(Ve,"animation-duration"),it(Ve,"animation-timing-function"),it(Ve,"animation-iteration-count"),it(Ve,"animation-delay"),it(Ve,"animation-play-state"),it(Ve,"animation-fill-mode"),it(Ve,"animation-direction")})})}},Yr=()=>{nr.forEach(Ce=>{Ce?.parentNode&&Ce.parentNode.removeChild(Ce)}),nr.length=0},Vt=()=>void 0!==Me?Me:Ut?Ut.getFill():"both",yn=()=>void 0!==me?me:void 0!==ht?ht:Ut?Ut.getDirection():"normal",Be=()=>bt?"linear":void 0!==Ft?Ft:Ut?Ut.getEasing():"linear",le=()=>$e?0:void 0!==ze?ze:void 0!==Bt?Bt:Ut?Ut.getDuration():0,de=()=>void 0!==Se?Se:Ut?Ut.getIterations():1,Ne=()=>void 0!==ct?ct:void 0!==nt?nt:Ut?Ut.getDelay():0,Dn=()=>{0!==en&&(en--,0===en&&((()=>{oi(),Lr.forEach(fn=>fn()),bn.forEach(fn=>fn());const Ce=Lt?1:0,Ve=on,St=Ht,zt=Yn;Bn.forEach(fn=>{const xn=fn.classList;Ve.forEach(pn=>xn.add(pn)),St.forEach(pn=>xn.remove(pn));for(const pn in zt)zt.hasOwnProperty(pn)&&Le(fn,pn,zt[pn])}),an.forEach(fn=>fn.c(Ce,sn)),mn.forEach(fn=>fn.c(Ce,sn)),mn.length=0,Yt=!0,Lt&&(Gt=!0),Lt=!0})(),Ut&&Ut.animationFinish()))},ur=(Ce=!0)=>{Yr();const Ve=(_t=>(_t.forEach(nt=>{for(const Bt in nt)if(nt.hasOwnProperty(Bt)){const Ft=nt[Bt];if("easing"===Bt)nt["animation-timing-function"]=Ft,delete nt[Bt];else{const Se=ve(Bt);Se!==Bt&&(nt[Se]=Ft,delete nt[Bt])}}}),_t))(It);Bn.forEach(St=>{if(Ve.length>0){const zt=((_t=[])=>_t.map(nt=>{const Bt=nt.offset,Ft=[];for(const Se in nt)nt.hasOwnProperty(Se)&&"offset"!==Se&&Ft.push(`${Se}: ${nt[Se]};`);return`${100*Bt}% { ${Ft.join(" ")} }`}).join(" "))(Ve);hn=void 0!==_t?_t:(_t=>{let nt=Re.indexOf(_t);return nt<0&&(nt=Re.push(_t)-1),`ion-animation-${nt}`})(zt);const fn=((_t,nt,Bt)=>{var Ft;const Se=(_t=>{const nt=void 0!==_t.getRootNode?_t.getRootNode():_t;return nt.head||nt})(Bt),Me=Ue(Bt),ht=Se.querySelector("#"+_t);if(ht)return ht;const It=(null!==(Ft=Bt.ownerDocument)&&void 0!==Ft?Ft:document).createElement("style");return It.id=_t,It.textContent=`@${Me}keyframes ${_t} { ${nt} } @${Me}keyframes ${_t}-alt { ${nt} }`,Se.appendChild(It),It})(hn,zt,St);nr.push(fn),Le(St,"animation-duration",`${le()}ms`),Le(St,"animation-timing-function",Be()),Le(St,"animation-delay",`${Ne()}ms`),Le(St,"animation-fill-mode",Vt()),Le(St,"animation-direction",yn());const xn=de()===1/0?"infinite":de().toString();Le(St,"animation-iteration-count",xn),Le(St,"animation-play-state","paused"),Ce&&Le(St,"animation-name",`${fn.id}-alt`),(0,b.r)(()=>{Le(St,"animation-name",fn.id||null)})}})},Rr=(Ce=!0)=>{(()=>{_r.forEach(zt=>zt()),Kn.forEach(zt=>zt());const Ce=Je,Ve=mt,St=dn;Bn.forEach(zt=>{const fn=zt.classList;Ce.forEach(xn=>fn.add(xn)),Ve.forEach(xn=>fn.remove(xn));for(const xn in St)St.hasOwnProperty(xn)&&Le(zt,xn,St[xn])})})(),It.length>0&&(hi?(Bn.forEach(Ce=>{const Ve=Ce.animate(It,{id:Xt,delay:Ne(),duration:le(),easing:Be(),iterations:de(),fill:Vt(),direction:yn()});Ve.pause(),Jr.push(Ve)}),Jr.length>0&&(Jr[0].onfinish=()=>{Dn()})):ur(Ce)),Kt=!0},Fr=Ce=>{if(Ce=Math.min(Math.max(Ce,0),.9999),hi)Jr.forEach(Ve=>{Ve.currentTime=Ve.effect.getComputedTiming().delay+le()*Ce,Ve.pause()});else{const Ve=`-${le()*Ce}ms`;Bn.forEach(St=>{It.length>0&&(Le(St,"animation-delay",Ve),Le(St,"animation-play-state","paused"))})}},fi=Ce=>{Jr.forEach(Ve=>{Ve.effect.updateTiming({delay:Ne(),duration:le(),easing:Be(),iterations:de(),fill:Vt(),direction:yn()})}),void 0!==Ce&&Fr(Ce)},Ti=(Ce=!0,Ve)=>{(0,b.r)(()=>{Bn.forEach(St=>{Le(St,"animation-name",hn||null),Le(St,"animation-duration",`${le()}ms`),Le(St,"animation-timing-function",Be()),Le(St,"animation-delay",void 0!==Ve?`-${Ve*le()}ms`:`${Ne()}ms`),Le(St,"animation-fill-mode",Vt()||null),Le(St,"animation-direction",yn()||null);const zt=de()===1/0?"infinite":de().toString();Le(St,"animation-iteration-count",zt),Ce&&Le(St,"animation-name",`${hn}-alt`),(0,b.r)(()=>{Le(St,"animation-name",hn||null)})})})},Qr=(Ce=!1,Ve=!0,St)=>(Ce&&mr.forEach(zt=>{zt.update(Ce,Ve,St)}),hi?fi(St):Ti(Ve,St),sn),cn=()=>{Kt&&(hi?Jr.forEach(Ce=>{Ce.pause()}):Bn.forEach(Ce=>{Le(Ce,"animation-play-state","paused")}),jt=!0)},wi=()=>{ue=void 0,Dn()},oi=()=>{ue&&clearTimeout(ue)},No=Ce=>new Promise(Ve=>{Ce?.sync&&($e=!0,Sr(()=>$e=!1,{oneTimeCallback:!0})),Kt||Rr(),Gt&&(hi?(Fr(0),fi()):Ti(),Gt=!1),Yt&&(en=mr.length+1,Yt=!1),Sr(()=>Ve(),{oneTimeCallback:!0}),mr.forEach(St=>{St.play()}),hi?(Jr.forEach(Ce=>{Ce.play()}),(0===It.length||0===Bn.length)&&Dn()):(()=>{if(oi(),(0,b.r)(()=>{Bn.forEach(Ce=>{It.length>0&&Le(Ce,"animation-play-state","running")})}),0===It.length||0===Bn.length)Dn();else{const Ce=Ne()||0,Ve=le()||0,St=de()||1;isFinite(St)&&(ue=setTimeout(wi,Ce+Ve*St+100)),((_t,nt)=>{let Bt;const Ft={passive:!0},Me=ht=>{_t===ht.target&&(Bt&&Bt(),oi(),(0,b.r)(()=>{Bn.forEach(Ce=>{it(Ce,"animation-duration"),it(Ce,"animation-delay"),it(Ce,"animation-play-state")}),(0,b.r)(Dn)}))};_t&&(_t.addEventListener("webkitAnimationEnd",Me,Ft),_t.addEventListener("animationend",Me,Ft),Bt=()=>{_t.removeEventListener("webkitAnimationEnd",Me,Ft),_t.removeEventListener("animationend",Me,Ft)})})(Bn[0])}})(),jt=!1}),Cr=(Ce,Ve)=>{const St=It[0];return void 0===St||void 0!==St.offset&&0!==St.offset?It=[{offset:0,[Ce]:Ve},...It]:St[Ce]=Ve,sn};return sn={parentAnimation:Ut,elements:Bn,childAnimations:mr,id:Xt,animationFinish:Dn,from:Cr,to:(Ce,Ve)=>{const St=It[It.length-1];return void 0===St||void 0!==St.offset&&1!==St.offset?It=[...It,{offset:1,[Ce]:Ve}]:St[Ce]=Ve,sn},fromTo:(Ce,Ve,St)=>Cr(Ce,Ve).to(Ce,St),parent:Ce=>(Ut=Ce,sn),play:No,pause:()=>(mr.forEach(Ce=>{Ce.pause()}),cn(),sn),stop:()=>{mr.forEach(Ce=>{Ce.stop()}),Kt&&(vi(),Kt=!1),bt=!1,$e=!1,Yt=!0,me=void 0,ze=void 0,ct=void 0,en=0,Gt=!1,Lt=!0,jt=!1},destroy:Ce=>(mr.forEach(Ve=>{Ve.destroy(Ce)}),(Ce=>{vi(),Ce&&Yr()})(Ce),Bn.length=0,mr.length=0,It.length=0,an.length=0,mn.length=0,Kt=!1,Yt=!0,sn),keyframes:Ce=>{const Ve=It!==Ce;return It=Ce,Ve&&(Ce=>{hi?Er().forEach(Ve=>{if(Ve.effect.setKeyframes)Ve.effect.setKeyframes(Ce);else{const St=new KeyframeEffect(Ve.effect.target,Ce,Ve.effect.getTiming());Ve.effect=St}}):ur()})(It),sn},addAnimation:Ce=>{if(null!=Ce)if(Array.isArray(Ce))for(const Ve of Ce)Ve.parent(sn),mr.push(Ve);else Ce.parent(sn),mr.push(Ce);return sn},addElement:Ce=>{if(null!=Ce)if(1===Ce.nodeType)Bn.push(Ce);else if(Ce.length>=0)for(let Ve=0;Ve<Ce.length;Ve++)Bn.push(Ce[Ve]);else console.error("Invalid addElement value");return sn},update:Qr,fill:Ce=>(Me=Ce,Qr(!0),sn),direction:Ce=>(ht=Ce,Qr(!0),sn),iterations:Ce=>(Se=Ce,Qr(!0),sn),duration:Ce=>(!hi&&0===Ce&&(Ce=1),Bt=Ce,Qr(!0),sn),easing:Ce=>(Ft=Ce,Qr(!0),sn),delay:Ce=>(nt=Ce,Qr(!0),sn),getWebAnimations:Er,getKeyframes:()=>It,getFill:Vt,getDirection:yn,getDelay:Ne,getIterations:de,getEasing:Be,getDuration:le,afterAddRead:Ce=>(Lr.push(Ce),sn),afterAddWrite:Ce=>(bn.push(Ce),sn),afterClearStyles:(Ce=[])=>{for(const Ve of Ce)Yn[Ve]="";return sn},afterStyles:(Ce={})=>(Yn=Ce,sn),afterRemoveClass:Ce=>(Ht=pt(Ht,Ce),sn),afterAddClass:Ce=>(on=pt(on,Ce),sn),beforeAddRead:Ce=>(_r.push(Ce),sn),beforeAddWrite:Ce=>(Kn.push(Ce),sn),beforeClearStyles:(Ce=[])=>{for(const Ve of Ce)dn[Ve]="";return sn},beforeStyles:(Ce={})=>(dn=Ce,sn),beforeRemoveClass:Ce=>(mt=pt(mt,Ce),sn),beforeAddClass:Ce=>(Je=pt(Je,Ce),sn),onFinish:Sr,isRunning:()=>0!==en&&!jt,progressStart:(Ce=!1,Ve)=>(mr.forEach(St=>{St.progressStart(Ce,Ve)}),cn(),bt=Ce,Kt||Rr(),Qr(!1,!0,Ve),sn),progressStep:Ce=>(mr.forEach(Ve=>{Ve.progressStep(Ce)}),Fr(Ce),sn),progressEnd:(Ce,Ve,St)=>(bt=!1,mr.forEach(zt=>{zt.progressEnd(Ce,Ve,St)}),void 0!==St&&(ze=St),Gt=!1,Lt=!0,0===Ce?(me="reverse"===yn()?"normal":"reverse","reverse"===me&&(Lt=!1),hi?(Qr(),Fr(1-Ve)):(ct=(1-Ve)*le()*-1,Qr(!1,!1))):1===Ce&&(hi?(Qr(),Fr(Ve)):(ct=Ve*le()*-1,Qr(!1,!1))),void 0!==Ce&&(Sr(()=>{ze=void 0,me=void 0,ct=void 0},{oneTimeCallback:!0}),Ut||No()),sn)}}},1273:(Gn,At,K)=>{"use strict";K.d(At,{E:()=>xe,a:()=>I,s:()=>it});const I=Re=>{try{if(Re instanceof Le)return Re.value;if(!l()||"string"!=typeof Re||""===Re)return Re;if(Re.includes("onload="))return"";const Ze=document.createDocumentFragment(),tt=document.createElement("div");Ze.appendChild(tt),tt.innerHTML=Re,Ue.forEach(_t=>{const nt=Ze.querySelectorAll(_t);for(let Bt=nt.length-1;Bt>=0;Bt--){const Ft=nt[Bt];Ft.parentNode?Ft.parentNode.removeChild(Ft):Ze.removeChild(Ft);const Se=dt(Ft);for(let Me=0;Me<Se.length;Me++)b(Se[Me])}});const lt=dt(Ze);for(let _t=0;_t<lt.length;_t++)b(lt[_t]);const pt=document.createElement("div");pt.appendChild(Ze);const vt=pt.querySelector("div");return null!==vt?vt.innerHTML:pt.innerHTML}catch(Ze){return console.error(Ze),""}},b=Re=>{if(Re.nodeType&&1!==Re.nodeType)return;if(typeof NamedNodeMap<"u"&&!(Re.attributes instanceof NamedNodeMap))return void Re.remove();for(let tt=Re.attributes.length-1;tt>=0;tt--){const lt=Re.attributes.item(tt),pt=lt.name;if(!ve.includes(pt.toLowerCase())){Re.removeAttribute(pt);continue}const vt=lt.value,_t=Re[pt];(null!=vt&&vt.toLowerCase().includes("javascript:")||null!=_t&&_t.toLowerCase().includes("javascript:"))&&Re.removeAttribute(pt)}const Ze=dt(Re);for(let tt=0;tt<Ze.length;tt++)b(Ze[tt])},dt=Re=>null!=Re.children?Re.children:Re.childNodes,l=()=>{var Re;const Ze=window,tt=null===(Re=Ze?.Ionic)||void 0===Re?void 0:Re.config;return!tt||(tt.get?tt.get("sanitizerEnabled",!0):!0===tt.sanitizerEnabled||void 0===tt.sanitizerEnabled)},ve=["class","id","href","src","name","slot"],Ue=["script","style","iframe","meta","link","object","embed"];class Le{constructor(Ze){this.value=Ze}}const it=Re=>{const Ze=window,tt=Ze.Ionic;if(!tt||!tt.config||"Object"===tt.config.constructor.name)return Ze.Ionic=Ze.Ionic||{},Ze.Ionic.config=Object.assign(Object.assign({},Ze.Ionic.config),Re),Ze.Ionic.config},xe=!1},9439:(Gn,At,K)=>{"use strict";K.d(At,{C:()=>ve,a:()=>dt,d:()=>l});var I=K(5861),b=K(544);const dt=function(){var Ue=(0,I.Z)(function*(Le,it,et,xe,Re,Ze){var tt;if(Le)return Le.attachViewToDom(it,et,Re,xe);if(!(Ze||"string"==typeof et||et instanceof HTMLElement))throw new Error("framework delegate is missing");const lt="string"==typeof et?null===(tt=it.ownerDocument)||void 0===tt?void 0:tt.createElement(et):et;return xe&&xe.forEach(pt=>lt.classList.add(pt)),Re&&Object.assign(lt,Re),it.appendChild(lt),yield new Promise(pt=>(0,b.c)(lt,pt)),lt});return function(it,et,xe,Re,Ze,tt){return Ue.apply(this,arguments)}}(),l=(Ue,Le)=>{if(Le){if(Ue)return Ue.removeViewFromDom(Le.parentElement,Le);Le.remove()}return Promise.resolve()},ve=()=>{let Ue,Le;return{attachViewToDom:function(){var xe=(0,I.Z)(function*(Re,Ze,tt={},lt=[]){var pt,vt;if(Ue=Re,Ze){const nt="string"==typeof Ze?null===(pt=Ue.ownerDocument)||void 0===pt?void 0:pt.createElement(Ze):Ze;lt.forEach(Bt=>nt.classList.add(Bt)),Object.assign(nt,tt),Ue.appendChild(nt),yield new Promise(Bt=>(0,b.c)(nt,Bt))}else if(Ue.children.length>0&&("ION-MODAL"===Ue.tagName||"ION-POPOVER"===Ue.tagName)&&!Ue.children[0].classList.contains("ion-delegate-host")){const Bt=null===(vt=Ue.ownerDocument)||void 0===vt?void 0:vt.createElement("div");Bt.classList.add("ion-delegate-host"),lt.forEach(Ft=>Bt.classList.add(Ft)),Bt.append(...Ue.children),Ue.appendChild(Bt)}const _t=document.querySelector("ion-app")||document.body;return Le=document.createComment("ionic teleport"),Ue.parentNode.insertBefore(Le,Ue),_t.appendChild(Ue),Ue});return function(Ze,tt){return xe.apply(this,arguments)}}(),removeViewFromDom:()=>(Ue&&Le&&(Le.parentNode.insertBefore(Ue,Le),Le.remove()),Promise.resolve())}}},4587:(Gn,At,K)=>{"use strict";K.d(At,{G:()=>ve});class b{constructor(Le,it,et,xe,Re){this.id=it,this.name=et,this.disableScroll=Re,this.priority=1e6*xe+it,this.ctrl=Le}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const Le=this.ctrl.capture(this.name,this.id,this.priority);return Le&&this.disableScroll&&this.ctrl.disableScroll(this.id),Le}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class dt{constructor(Le,it,et,xe){this.id=it,this.disable=et,this.disableScroll=xe,this.ctrl=Le}block(){if(this.ctrl){if(this.disable)for(const Le of this.disable)this.ctrl.disableGesture(Le,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const Le of this.disable)this.ctrl.enableGesture(Le,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const l="backdrop-no-scroll",ve=new class I{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(Le){var it;return new b(this,this.newID(),Le.name,null!==(it=Le.priority)&&void 0!==it?it:0,!!Le.disableScroll)}createBlocker(Le={}){return new dt(this,this.newID(),Le.disable,!!Le.disableScroll)}start(Le,it,et){return this.canStart(Le)?(this.requestedStart.set(it,et),!0):(this.requestedStart.delete(it),!1)}capture(Le,it,et){if(!this.start(Le,it,et))return!1;const xe=this.requestedStart;let Re=-1e4;if(xe.forEach(Ze=>{Re=Math.max(Re,Ze)}),Re===et){this.capturedId=it,xe.clear();const Ze=new CustomEvent("ionGestureCaptured",{detail:{gestureName:Le}});return document.dispatchEvent(Ze),!0}return xe.delete(it),!1}release(Le){this.requestedStart.delete(Le),this.capturedId===Le&&(this.capturedId=void 0)}disableGesture(Le,it){let et=this.disabledGestures.get(Le);void 0===et&&(et=new Set,this.disabledGestures.set(Le,et)),et.add(it)}enableGesture(Le,it){const et=this.disabledGestures.get(Le);void 0!==et&&et.delete(it)}disableScroll(Le){this.disabledScroll.add(Le),1===this.disabledScroll.size&&document.body.classList.add(l)}enableScroll(Le){this.disabledScroll.delete(Le),0===this.disabledScroll.size&&document.body.classList.remove(l)}canStart(Le){return!(void 0!==this.capturedId||this.isDisabled(Le))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(Le){const it=this.disabledGestures.get(Le);return!!(it&&it.size>0)}newID(){return this.gestureId++,this.gestureId}}},5421:(Gn,At,K)=>{"use strict";K.r(At),K.d(At,{MENU_BACK_BUTTON_PRIORITY:()=>ve,OVERLAY_BACK_BUTTON_PRIORITY:()=>l,blockHardwareBackButton:()=>b,startHardwareBackButton:()=>dt});var I=K(5861);const b=()=>{document.addEventListener("backbutton",()=>{})},dt=()=>{const Ue=document;let Le=!1;Ue.addEventListener("backbutton",()=>{if(Le)return;let it=0,et=[];const xe=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(tt,lt){et.push({priority:tt,handler:lt,id:it++})}}});Ue.dispatchEvent(xe);const Re=function(){var tt=(0,I.Z)(function*(lt){try{if(lt?.handler){const pt=lt.handler(Ze);null!=pt&&(yield pt)}}catch(pt){console.error(pt)}});return function(pt){return tt.apply(this,arguments)}}(),Ze=()=>{if(et.length>0){let tt={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};et.forEach(lt=>{lt.priority>=tt.priority&&(tt=lt)}),Le=!0,et=et.filter(lt=>lt.id!==tt.id),Re(tt).then(()=>Le=!1)}};Ze()})},l=100,ve=99},544:(Gn,At,K)=>{"use strict";K.d(At,{a:()=>it,b:()=>et,c:()=>dt,d:()=>vt,e:()=>pt,f:()=>lt,g:()=>xe,h:()=>tt,i:()=>Le,j:()=>Me,k:()=>ve,l:()=>_t,m:()=>l,n:()=>Ze,o:()=>nt,p:()=>Se,q:()=>ht,r:()=>Re,s:()=>It,t:()=>I,u:()=>Bt,v:()=>Ft});const I=(Je,mt=0)=>new Promise(Kt=>{b(Je,mt,Kt)}),b=(Je,mt=0,Kt)=>{let Ut,dn;const on={passive:!0},Yn=()=>{Ut&&Ut()},en=bt=>{(void 0===bt||Je===bt.target)&&(Yn(),Kt(bt))};return Je&&(Je.addEventListener("webkitTransitionEnd",en,on),Je.addEventListener("transitionend",en,on),dn=setTimeout(en,mt+500),Ut=()=>{dn&&(clearTimeout(dn),dn=void 0),Je.removeEventListener("webkitTransitionEnd",en,on),Je.removeEventListener("transitionend",en,on)}),Yn},dt=(Je,mt)=>{Je.componentOnReady?Je.componentOnReady().then(Kt=>mt(Kt)):Re(()=>mt(Je))},l=Je=>void 0!==Je.componentOnReady,ve=(Je,mt=[])=>{const Kt={};return mt.forEach(Ut=>{Je.hasAttribute(Ut)&&(null!==Je.getAttribute(Ut)&&(Kt[Ut]=Je.getAttribute(Ut)),Je.removeAttribute(Ut))}),Kt},Ue=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Le=(Je,mt)=>{let Kt=Ue;return mt&&mt.length>0&&(Kt=Kt.filter(Ut=>!mt.includes(Ut))),ve(Je,Kt)},it=(Je,mt,Kt,Ut)=>{var dn;if(typeof window<"u"){const on=window,Ht=null===(dn=on?.Ionic)||void 0===dn?void 0:dn.config;if(Ht){const Yn=Ht.get("_ael");if(Yn)return Yn(Je,mt,Kt,Ut);if(Ht._ael)return Ht._ael(Je,mt,Kt,Ut)}}return Je.addEventListener(mt,Kt,Ut)},et=(Je,mt,Kt,Ut)=>{var dn;if(typeof window<"u"){const on=window,Ht=null===(dn=on?.Ionic)||void 0===dn?void 0:dn.config;if(Ht){const Yn=Ht.get("_rel");if(Yn)return Yn(Je,mt,Kt,Ut);if(Ht._rel)return Ht._rel(Je,mt,Kt,Ut)}}return Je.removeEventListener(mt,Kt,Ut)},xe=(Je,mt=Je)=>Je.shadowRoot||mt,Re=Je=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Je):"function"==typeof requestAnimationFrame?requestAnimationFrame(Je):setTimeout(Je),Ze=Je=>!!Je.shadowRoot&&!!Je.attachShadow,tt=Je=>{const mt=Je.closest("ion-item");return mt?mt.querySelector("ion-label"):null},lt=Je=>{if(Je.focus(),Je.classList.contains("ion-focusable")){const mt=Je.closest("ion-app");mt&&mt.setFocus([Je])}},pt=(Je,mt)=>{let Kt;const Ut=Je.getAttribute("aria-labelledby"),dn=Je.id;let on=null!==Ut&&""!==Ut.trim()?Ut:mt+"-lbl",Ht=null!==Ut&&""!==Ut.trim()?document.getElementById(Ut):tt(Je);return Ht?(null===Ut&&(Ht.id=on),Kt=Ht.textContent,Ht.setAttribute("aria-hidden","true")):""!==dn.trim()&&(Ht=document.querySelector(`label[for="${dn}"]`),Ht&&(""!==Ht.id?on=Ht.id:Ht.id=on=`${dn}-lbl`,Kt=Ht.textContent)),{label:Ht,labelId:on,labelText:Kt}},vt=(Je,mt,Kt,Ut,dn)=>{if(Je||Ze(mt)){let on=mt.querySelector("input.aux-input");on||(on=mt.ownerDocument.createElement("input"),on.type="hidden",on.classList.add("aux-input"),mt.appendChild(on)),on.disabled=dn,on.name=Kt,on.value=Ut||""}},_t=(Je,mt,Kt)=>Math.max(Je,Math.min(mt,Kt)),nt=(Je,mt)=>{if(!Je){const Kt="ASSERT: "+mt;throw console.error(Kt),new Error(Kt)}},Bt=Je=>Je.timeStamp||Date.now(),Ft=Je=>{if(Je){const mt=Je.changedTouches;if(mt&&mt.length>0){const Kt=mt[0];return{x:Kt.clientX,y:Kt.clientY}}if(void 0!==Je.pageX)return{x:Je.pageX,y:Je.pageY}}return{x:0,y:0}},Se=Je=>{const mt="rtl"===document.dir;switch(Je){case"start":return mt;case"end":return!mt;default:throw new Error(`"${Je}" is not a valid value for [side]. Use "start" or "end" instead.`)}},Me=(Je,mt)=>{const Kt=Je._original||Je;return{_original:Je,emit:ht(Kt.emit.bind(Kt),mt)}},ht=(Je,mt=0)=>{let Kt;return(...Ut)=>{clearTimeout(Kt),Kt=setTimeout(Je,mt,...Ut)}},It=(Je,mt)=>{if(Je??(Je={}),mt??(mt={}),Je===mt)return!0;const Kt=Object.keys(Je);if(Kt.length!==Object.keys(mt).length)return!1;for(const Ut of Kt)if(!(Ut in mt)||Je[Ut]!==mt[Ut])return!1;return!0}},6953:(Gn,At,K)=>{"use strict";K.d(At,{B:()=>Re,H:()=>Yn,a:()=>Es,b:()=>Wn,c:()=>Gt,d:()=>jt,e:()=>qn,f:()=>sn,g:()=>Yt,h:()=>on,i:()=>xt,j:()=>Ze,p:()=>io,r:()=>Tt,w:()=>Cr});var I=K(5861);let dt,l,ve,Ue=!1,Le=!1,it=!1,et=!1,xe=!1;const Re={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},Ze=fe=>{const je=new URL(fe,qr.$resourcesUrl$);return je.origin!==Qr.location.origin?je.href:je.pathname},Bt="s-id",Ft="sty-id",ht="http://www.w3.org/1999/xlink",It={},Ut=fe=>"object"==(fe=typeof fe)||"function"===fe;function dn(fe){var je,Ce,Ve;return null!==(Ve=null===(Ce=null===(je=fe.head)||void 0===je?void 0:je.querySelector('meta[name="csp-nonce"]'))||void 0===Ce?void 0:Ce.getAttribute("content"))&&void 0!==Ve?Ve:void 0}const on=(fe,je,...Ce)=>{let Ve=null,St=null,zt=null,fn=!1,xn=!1;const pn=[],An=Tr=>{for(let kr=0;kr<Tr.length;kr++)Ve=Tr[kr],Array.isArray(Ve)?An(Ve):null!=Ve&&"boolean"!=typeof Ve&&((fn="function"!=typeof fe&&!Ut(Ve))&&(Ve=String(Ve)),fn&&xn?pn[pn.length-1].$text$+=Ve:pn.push(fn?Ht(null,Ve):Ve),xn=fn)};if(An(Ce),je){je.key&&(St=je.key),je.name&&(zt=je.name);{const Tr=je.className||je.class;Tr&&(je.class="object"!=typeof Tr?Tr:Object.keys(Tr).filter(kr=>Tr[kr]).join(" "))}}if("function"==typeof fe)return fe(null===je?{}:je,pn,bt);const cr=Ht(fe,null);return cr.$attrs$=je,pn.length>0&&(cr.$children$=pn),cr.$key$=St,cr.$name$=zt,cr},Ht=(fe,je)=>({$flags$:0,$tag$:fe,$text$:je,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),Yn={},bt={forEach:(fe,je)=>fe.map($e).forEach(je),map:(fe,je)=>fe.map($e).map(je).map(ue)},$e=fe=>({vattrs:fe.$attrs$,vchildren:fe.$children$,vkey:fe.$key$,vname:fe.$name$,vtag:fe.$tag$,vtext:fe.$text$}),ue=fe=>{if("function"==typeof fe.vtag){const Ce=Object.assign({},fe.vattrs);return fe.vkey&&(Ce.key=fe.vkey),fe.vname&&(Ce.name=fe.vname),on(fe.vtag,Ce,...fe.vchildren||[])}const je=Ht(fe.vtag,fe.vtext);return je.$attrs$=fe.vattrs,je.$children$=fe.vchildren,je.$key$=fe.vkey,je.$name$=fe.vname,je},ze=(fe,je,Ce,Ve,St,zt,fn)=>{let xn,pn,An,cr;if(1===zt.nodeType){for(xn=zt.getAttribute("c-id"),xn&&(pn=xn.split("."),(pn[0]===fn||"0"===pn[0])&&(An={$flags$:0,$hostId$:pn[0],$nodeId$:pn[1],$depth$:pn[2],$index$:pn[3],$tag$:zt.tagName.toLowerCase(),$elm$:zt,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},je.push(An),zt.removeAttribute("c-id"),fe.$children$||(fe.$children$=[]),fe.$children$[An.$index$]=An,fe=An,Ve&&"0"===An.$depth$&&(Ve[An.$index$]=An.$elm$))),cr=zt.childNodes.length-1;cr>=0;cr--)ze(fe,je,Ce,Ve,St,zt.childNodes[cr],fn);if(zt.shadowRoot)for(cr=zt.shadowRoot.childNodes.length-1;cr>=0;cr--)ze(fe,je,Ce,Ve,St,zt.shadowRoot.childNodes[cr],fn)}else if(8===zt.nodeType)pn=zt.nodeValue.split("."),(pn[1]===fn||"0"===pn[1])&&(xn=pn[0],An={$flags$:0,$hostId$:pn[1],$nodeId$:pn[2],$depth$:pn[3],$index$:pn[4],$elm$:zt,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===xn?(An.$elm$=zt.nextSibling,An.$elm$&&3===An.$elm$.nodeType&&(An.$text$=An.$elm$.textContent,je.push(An),zt.remove(),fe.$children$||(fe.$children$=[]),fe.$children$[An.$index$]=An,Ve&&"0"===An.$depth$&&(Ve[An.$index$]=An.$elm$))):An.$hostId$===fn&&("s"===xn?(An.$tag$="slot",zt["s-sn"]=pn[5]?An.$name$=pn[5]:"",zt["s-sr"]=!0,Ve&&(An.$elm$=ui.createElement(An.$tag$),An.$name$&&An.$elm$.setAttribute("name",An.$name$),zt.parentNode.insertBefore(An.$elm$,zt),zt.remove(),"0"===An.$depth$&&(Ve[An.$index$]=An.$elm$)),Ce.push(An),fe.$children$||(fe.$children$=[]),fe.$children$[An.$index$]=An):"r"===xn&&(Ve?zt.remove():(St["s-cr"]=zt,zt["s-cn"]=!0))));else if(fe&&"style"===fe.$tag$){const Tr=Ht(null,zt.textContent);Tr.$elm$=zt,Tr.$index$="0",fe.$children$=[Tr]}},ct=(fe,je)=>{if(1===fe.nodeType){let Ce=0;for(;Ce<fe.childNodes.length;Ce++)ct(fe.childNodes[Ce],je);if(fe.shadowRoot)for(Ce=0;Ce<fe.shadowRoot.childNodes.length;Ce++)ct(fe.shadowRoot.childNodes[Ce],je)}else if(8===fe.nodeType){const Ce=fe.nodeValue.split(".");"o"===Ce[0]&&(je.set(Ce[1]+"."+Ce[2],fe),fe.nodeValue="",fe["s-en"]=Ce[3])}},Gt=fe=>Ti.push(fe),Yt=fe=>rn(fe).$modeName$,sn=fe=>rn(fe).$hostElement$,jt=(fe,je,Ce)=>{const Ve=sn(fe);return{emit:St=>Xt(Ve,je,{bubbles:!!(4&Ce),composed:!!(2&Ce),cancelable:!!(1&Ce),detail:St})}},Xt=(fe,je,Ce)=>{const Ve=qr.ce(je,Ce);return fe.dispatchEvent(Ve),Ve},an=new WeakMap,mn=(fe,je,Ce)=>{let Ve=fi.get(fe);wi&&Ce?(Ve=Ve||new CSSStyleSheet,"string"==typeof Ve?Ve=je:Ve.replaceSync(je)):Ve=je,fi.set(fe,Ve)},Bn=(fe,je,Ce,Ve)=>{var St;let zt=nr(je,Ce);const fn=fi.get(zt);if(fe=11===fe.nodeType?fe:ui,fn)if("string"==typeof fn){let pn,xn=an.get(fe=fe.head||fe);if(xn||an.set(fe,xn=new Set),!xn.has(zt)){if(fe.host&&(pn=fe.querySelector(`[${Ft}="${zt}"]`)))pn.innerHTML=fn;else{pn=ui.createElement("style"),pn.innerHTML=fn;const An=null!==(St=qr.$nonce$)&&void 0!==St?St:dn(ui);null!=An&&pn.setAttribute("nonce",An),fe.insertBefore(pn,fe.querySelector("link"))}xn&&xn.add(zt)}}else fe.adoptedStyleSheets.includes(fn)||(fe.adoptedStyleSheets=[...fe.adoptedStyleSheets,fn]);return zt},nr=(fe,je)=>"sc-"+(je&&32&fe.$flags$?fe.$tagName$+"-"+je:fe.$tagName$),_r=fe=>fe.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),Kn=(fe,je,Ce,Ve,St,zt)=>{if(Ce!==Ve){let fn=ur(fe,je),xn=je.toLowerCase();if("class"===je){const pn=fe.classList,An=bn(Ce),cr=bn(Ve);pn.remove(...An.filter(Tr=>Tr&&!cr.includes(Tr))),pn.add(...cr.filter(Tr=>Tr&&!An.includes(Tr)))}else if("style"===je){for(const pn in Ce)(!Ve||null==Ve[pn])&&(pn.includes("-")?fe.style.removeProperty(pn):fe.style[pn]="");for(const pn in Ve)(!Ce||Ve[pn]!==Ce[pn])&&(pn.includes("-")?fe.style.setProperty(pn,Ve[pn]):fe.style[pn]=Ve[pn])}else if("key"!==je)if("ref"===je)Ve&&Ve(fe);else if(fn||"o"!==je[0]||"n"!==je[1]){const pn=Ut(Ve);if((fn||pn&&null!==Ve)&&!St)try{if(fe.tagName.includes("-"))fe[je]=Ve;else{const cr=Ve??"";"list"===je?fn=!1:(null==Ce||fe[je]!=cr)&&(fe[je]=cr)}}catch{}let An=!1;xn!==(xn=xn.replace(/^xlink\:?/,""))&&(je=xn,An=!0),null==Ve||!1===Ve?(!1!==Ve||""===fe.getAttribute(je))&&(An?fe.removeAttributeNS(ht,je):fe.removeAttribute(je)):(!fn||4&zt||St)&&!pn&&(Ve=!0===Ve?"":Ve,An?fe.setAttributeNS(ht,je,Ve):fe.setAttribute(je,Ve))}else je="-"===je[2]?je.slice(3):ur(Qr,xn)?xn.slice(2):xn[2]+je.slice(3),Ce&&qr.rel(fe,je,Ce,!1),Ve&&qr.ael(fe,je,Ve,!1)}},Lr=/\s/,bn=fe=>fe?fe.split(Lr):[],Jr=(fe,je,Ce,Ve)=>{const St=11===je.$elm$.nodeType&&je.$elm$.host?je.$elm$.host:je.$elm$,zt=fe&&fe.$attrs$||It,fn=je.$attrs$||It;for(Ve in zt)Ve in fn||Kn(St,Ve,zt[Ve],void 0,Ce,je.$flags$);for(Ve in fn)Kn(St,Ve,zt[Ve],fn[Ve],Ce,je.$flags$)},Fi=(fe,je,Ce,Ve)=>{const St=je.$children$[Ce];let fn,xn,pn,zt=0;if(Ue||(it=!0,"slot"===St.$tag$&&(dt&&Ve.classList.add(dt+"-s"),St.$flags$|=St.$children$?2:1)),null!==St.$text$)fn=St.$elm$=ui.createTextNode(St.$text$);else if(1&St.$flags$)fn=St.$elm$=ui.createTextNode("");else{if(et||(et="svg"===St.$tag$),fn=St.$elm$=ui.createElementNS(et?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&St.$flags$?"slot-fb":St.$tag$),et&&"foreignObject"===St.$tag$&&(et=!1),Jr(null,St,et),(fe=>null!=fe)(dt)&&fn["s-si"]!==dt&&fn.classList.add(fn["s-si"]=dt),St.$children$)for(zt=0;zt<St.$children$.length;++zt)xn=Fi(fe,St,zt,fn),xn&&fn.appendChild(xn);"svg"===St.$tag$?et=!1:"foreignObject"===fn.tagName&&(et=!0)}return fn["s-hn"]=ve,3&St.$flags$&&(fn["s-sr"]=!0,fn["s-cr"]=l,fn["s-sn"]=St.$name$||"",pn=fe&&fe.$children$&&fe.$children$[Ce],pn&&pn.$tag$===St.$tag$&&fe.$elm$&&hi(fe.$elm$,!1)),fn},hi=(fe,je)=>{qr.$flags$|=1;const Ce=fe.childNodes;for(let Ve=Ce.length-1;Ve>=0;Ve--){const St=Ce[Ve];St["s-hn"]!==ve&&St["s-ol"]&&(qi(St).insertBefore(St,Ci(St)),St["s-ol"].remove(),St["s-ol"]=void 0,it=!0),je&&hi(St,je)}qr.$flags$&=-2},fr=(fe,je,Ce,Ve,St,zt)=>{let xn,fn=fe["s-cr"]&&fe["s-cr"].parentNode||fe;for(fn.shadowRoot&&fn.tagName===ve&&(fn=fn.shadowRoot);St<=zt;++St)Ve[St]&&(xn=Fi(null,Ce,St,fe),xn&&(Ve[St].$elm$=xn,fn.insertBefore(xn,Ci(je))))},Er=(fe,je,Ce)=>{for(let Ve=je;Ve<=Ce;++Ve){const St=fe[Ve];if(St){const zt=St.$elm$;Or(St),zt&&(Le=!0,zt["s-ol"]?zt["s-ol"].remove():hi(zt,!0),zt.remove())}}},gr=(fe,je)=>fe.$tag$===je.$tag$&&("slot"===fe.$tag$?fe.$name$===je.$name$:fe.$key$===je.$key$),Ci=fe=>fe&&fe["s-ol"]||fe,qi=fe=>(fe["s-ol"]?fe["s-ol"]:fe).parentNode,Sr=(fe,je)=>{const Ce=je.$elm$=fe.$elm$,Ve=fe.$children$,St=je.$children$,zt=je.$tag$,fn=je.$text$;let xn;null===fn?(et="svg"===zt||"foreignObject"!==zt&&et,"slot"===zt||Jr(fe,je,et),null!==Ve&&null!==St?((fe,je,Ce,Ve)=>{let oo,Wi,St=0,zt=0,fn=0,xn=0,pn=je.length-1,An=je[0],cr=je[pn],Tr=Ve.length-1,kr=Ve[0],Ei=Ve[Tr];for(;St<=pn&&zt<=Tr;)if(null==An)An=je[++St];else if(null==cr)cr=je[--pn];else if(null==kr)kr=Ve[++zt];else if(null==Ei)Ei=Ve[--Tr];else if(gr(An,kr))Sr(An,kr),An=je[++St],kr=Ve[++zt];else if(gr(cr,Ei))Sr(cr,Ei),cr=je[--pn],Ei=Ve[--Tr];else if(gr(An,Ei))("slot"===An.$tag$||"slot"===Ei.$tag$)&&hi(An.$elm$.parentNode,!1),Sr(An,Ei),fe.insertBefore(An.$elm$,cr.$elm$.nextSibling),An=je[++St],Ei=Ve[--Tr];else if(gr(cr,kr))("slot"===An.$tag$||"slot"===Ei.$tag$)&&hi(cr.$elm$.parentNode,!1),Sr(cr,kr),fe.insertBefore(cr.$elm$,An.$elm$),cr=je[--pn],kr=Ve[++zt];else{for(fn=-1,xn=St;xn<=pn;++xn)if(je[xn]&&null!==je[xn].$key$&&je[xn].$key$===kr.$key$){fn=xn;break}fn>=0?(Wi=je[fn],Wi.$tag$!==kr.$tag$?oo=Fi(je&&je[zt],Ce,fn,fe):(Sr(Wi,kr),je[fn]=void 0,oo=Wi.$elm$),kr=Ve[++zt]):(oo=Fi(je&&je[zt],Ce,zt,fe),kr=Ve[++zt]),oo&&qi(An.$elm$).insertBefore(oo,Ci(An.$elm$))}St>pn?fr(fe,null==Ve[Tr+1]?null:Ve[Tr+1].$elm$,Ce,Ve,zt,Tr):zt>Tr&&Er(je,St,pn)})(Ce,Ve,je,St):null!==St?(null!==fe.$text$&&(Ce.textContent=""),fr(Ce,null,je,St,0,St.length-1)):null!==Ve&&Er(Ve,0,Ve.length-1),et&&"svg"===zt&&(et=!1)):(xn=Ce["s-cr"])?xn.parentNode.textContent=fn:fe.$text$!==fn&&(Ce.data=fn)},Ai=fe=>{const je=fe.childNodes;let Ce,Ve,St,zt,fn,xn;for(Ve=0,St=je.length;Ve<St;Ve++)if(Ce=je[Ve],1===Ce.nodeType){if(Ce["s-sr"])for(fn=Ce["s-sn"],Ce.hidden=!1,zt=0;zt<St;zt++)if(xn=je[zt].nodeType,je[zt]["s-hn"]!==Ce["s-hn"]||""!==fn){if(1===xn&&fn===je[zt].getAttribute("slot")){Ce.hidden=!0;break}}else if(1===xn||3===xn&&""!==je[zt].textContent.trim()){Ce.hidden=!0;break}Ai(Ce)}},vi=[],Yr=fe=>{let je,Ce,Ve,St,zt,fn,xn=0;const pn=fe.childNodes,An=pn.length;for(;xn<An;xn++){if(je=pn[xn],je["s-sr"]&&(Ce=je["s-cr"])&&Ce.parentNode)for(Ve=Ce.parentNode.childNodes,St=je["s-sn"],fn=Ve.length-1;fn>=0;fn--)Ce=Ve[fn],!Ce["s-cn"]&&!Ce["s-nr"]&&Ce["s-hn"]!==je["s-hn"]&&(Do(Ce,St)?(zt=vi.find(cr=>cr.$nodeToRelocate$===Ce),Le=!0,Ce["s-sn"]=Ce["s-sn"]||St,zt?zt.$slotRefNode$=je:vi.push({$slotRefNode$:je,$nodeToRelocate$:Ce}),Ce["s-sr"]&&vi.map(cr=>{Do(cr.$nodeToRelocate$,Ce["s-sn"])&&(zt=vi.find(Tr=>Tr.$nodeToRelocate$===Ce),zt&&!cr.$slotRefNode$&&(cr.$slotRefNode$=zt.$slotRefNode$))})):vi.some(cr=>cr.$nodeToRelocate$===Ce)||vi.push({$nodeToRelocate$:Ce}));1===je.nodeType&&Yr(je)}},Do=(fe,je)=>1===fe.nodeType?null===fe.getAttribute("slot")&&""===je||fe.getAttribute("slot")===je:fe["s-sn"]===je||""===je,Or=fe=>{fe.$attrs$&&fe.$attrs$.ref&&fe.$attrs$.ref(null),fe.$children$&&fe.$children$.map(Or)},Qe=(fe,je)=>{je&&!fe.$onRenderResolve$&&je["s-p"]&&je["s-p"].push(new Promise(Ce=>fe.$onRenderResolve$=Ce))},he=(fe,je)=>{if(fe.$flags$|=16,!(4&fe.$flags$))return Qe(fe,fe.$ancestorComponent$),Cr(()=>_e(fe,je));fe.$flags$|=512},_e=(fe,je)=>{const Ve=fe.$lazyInstance$;let St;return je&&(fe.$flags$|=256,fe.$queuedListeners$&&(fe.$queuedListeners$.map(([zt,fn])=>yn(Ve,zt,fn)),fe.$queuedListeners$=void 0),St=yn(Ve,"componentWillLoad")),St=qe(St,()=>yn(Ve,"componentWillRender")),qe(St,()=>wt(fe,Ve,je))},qe=(fe,je)=>ut(fe)?fe.then(je):je(),ut=fe=>fe instanceof Promise||fe&&fe.then&&"function"==typeof fe.then,wt=function(){var fe=(0,I.Z)(function*(je,Ce,Ve){var St;const zt=je.$hostElement$,xn=zt["s-rc"];Ve&&(fe=>{const je=fe.$cmpMeta$,Ce=fe.$hostElement$,Ve=je.$flags$,zt=Bn(Ce.shadowRoot?Ce.shadowRoot:Ce.getRootNode(),je,fe.$modeName$);10&Ve&&(Ce["s-sc"]=zt,Ce.classList.add(zt+"-h"),2&Ve&&Ce.classList.add(zt+"-s"))})(je);Ot(je,Ce),xn&&(xn.map(An=>An()),zt["s-rc"]=void 0);{const An=null!==(St=zt["s-p"])&&void 0!==St?St:[],cr=()=>kt(je);0===An.length?cr():(Promise.all(An).then(cr),je.$flags$|=4,An.length=0)}});return function(Ce,Ve,St){return fe.apply(this,arguments)}}(),Ot=(fe,je,Ce)=>{try{je=je.render&&je.render(),fe.$flags$&=-17,fe.$flags$|=2,((fe,je)=>{const Ce=fe.$hostElement$,Ve=fe.$cmpMeta$,St=fe.$vnode$||Ht(null,null),zt=(fe=>fe&&fe.$tag$===Yn)(je)?je:on(null,null,je);if(ve=Ce.tagName,Ve.$attrsToReflect$&&(zt.$attrs$=zt.$attrs$||{},Ve.$attrsToReflect$.map(([fn,xn])=>zt.$attrs$[xn]=Ce[fn])),zt.$tag$=null,zt.$flags$|=4,fe.$vnode$=zt,zt.$elm$=St.$elm$=Ce.shadowRoot||Ce,dt=Ce["s-sc"],l=Ce["s-cr"],Ue=0!=(1&Ve.$flags$),Le=!1,Sr(St,zt),qr.$flags$|=1,it){Yr(zt.$elm$);let fn,xn,pn,An,cr,Tr,kr=0;for(;kr<vi.length;kr++)fn=vi[kr],xn=fn.$nodeToRelocate$,xn["s-ol"]||(pn=ui.createTextNode(""),pn["s-nr"]=xn,xn.parentNode.insertBefore(xn["s-ol"]=pn,xn));for(kr=0;kr<vi.length;kr++)if(fn=vi[kr],xn=fn.$nodeToRelocate$,fn.$slotRefNode$){for(An=fn.$slotRefNode$.parentNode,cr=fn.$slotRefNode$.nextSibling,pn=xn["s-ol"];pn=pn.previousSibling;)if(Tr=pn["s-nr"],Tr&&Tr["s-sn"]===xn["s-sn"]&&An===Tr.parentNode&&(Tr=Tr.nextSibling,!Tr||!Tr["s-nr"])){cr=Tr;break}(!cr&&An!==xn.parentNode||xn.nextSibling!==cr)&&xn!==cr&&(!xn["s-hn"]&&xn["s-ol"]&&(xn["s-hn"]=xn["s-ol"].parentNode.nodeName),An.insertBefore(xn,cr))}else 1===xn.nodeType&&(xn.hidden=!0)}Le&&Ai(zt.$elm$),qr.$flags$&=-2,vi.length=0})(fe,je)}catch(Ve){Zn(Ve,fe.$hostElement$)}return null},kt=fe=>{const Ce=fe.$hostElement$,St=fe.$lazyInstance$,zt=fe.$ancestorComponent$;yn(St,"componentDidRender"),64&fe.$flags$?yn(St,"componentDidUpdate"):(fe.$flags$|=64,Be(Ce),yn(St,"componentDidLoad"),fe.$onReadyResolve$(Ce),zt||Vt()),fe.$onInstanceResolve$(Ce),fe.$onRenderResolve$&&(fe.$onRenderResolve$(),fe.$onRenderResolve$=void 0),512&fe.$flags$&&No(()=>he(fe,!1)),fe.$flags$&=-517},xt=fe=>{{const je=rn(fe),Ce=je.$hostElement$.isConnected;return Ce&&2==(18&je.$flags$)&&he(je,!1),Ce}},Vt=fe=>{Be(ui.documentElement),No(()=>Xt(Qr,"appload",{detail:{namespace:"ionic"}}))},yn=(fe,je,Ce)=>{if(fe&&fe[je])try{return fe[je](Ce)}catch(Ve){Zn(Ve)}},Be=fe=>fe.classList.add("hydrated"),Ne=(fe,je,Ce)=>{if(je.$members$){fe.watchers&&(je.$watchers$=fe.watchers);const Ve=Object.entries(je.$members$),St=fe.prototype;if(Ve.map(([zt,[fn]])=>{31&fn||2&Ce&&32&fn?Object.defineProperty(St,zt,{get(){return((fe,je)=>rn(this).$instanceValues$.get(je))(0,zt)},set(xn){((fe,je,Ce,Ve)=>{const St=rn(fe),zt=St.$hostElement$,fn=St.$instanceValues$.get(je),xn=St.$flags$,pn=St.$lazyInstance$;Ce=((fe,je)=>null==fe||Ut(fe)?fe:4&je?"false"!==fe&&(""===fe||!!fe):2&je?parseFloat(fe):1&je?String(fe):fe)(Ce,Ve.$members$[je][0]);const An=Number.isNaN(fn)&&Number.isNaN(Ce);if((!(8&xn)||void 0===fn)&&Ce!==fn&&!An&&(St.$instanceValues$.set(je,Ce),pn)){if(Ve.$watchers$&&128&xn){const Tr=Ve.$watchers$[je];Tr&&Tr.map(kr=>{try{pn[kr](Ce,fn,je)}catch(Ei){Zn(Ei,zt)}})}2==(18&xn)&&he(St,!1)}})(this,zt,xn,je)},configurable:!0,enumerable:!0}):1&Ce&&64&fn&&Object.defineProperty(St,zt,{value(...xn){const pn=rn(this);return pn.$onInstancePromise$.then(()=>pn.$lazyInstance$[zt](...xn))}})}),1&Ce){const zt=new Map;St.attributeChangedCallback=function(fn,xn,pn){qr.jmp(()=>{const An=zt.get(fn);if(this.hasOwnProperty(An))pn=this[An],delete this[An];else if(St.hasOwnProperty(An)&&"number"==typeof this[An]&&this[An]==pn)return;this[An]=(null!==pn||"boolean"!=typeof this[An])&&pn})},fe.observedAttributes=Ve.filter(([fn,xn])=>15&xn[0]).map(([fn,xn])=>{const pn=xn[1]||fn;return zt.set(pn,fn),512&xn[0]&&je.$attrsToReflect$.push([fn,pn]),pn})}}return fe},pe=function(){var fe=(0,I.Z)(function*(je,Ce,Ve,St,zt){if(!(32&Ce.$flags$)){Ce.$flags$|=32;{if((zt=Fr(Ve)).then){const An=()=>{};zt=yield zt,An()}zt.isProxied||(Ve.$watchers$=zt.watchers,Ne(zt,Ve,2),zt.isProxied=!0);const pn=()=>{};Ce.$flags$|=8;try{new zt(Ce)}catch(An){Zn(An)}Ce.$flags$&=-9,Ce.$flags$|=128,pn(),ot(Ce.$lazyInstance$)}if(zt.style){let pn=zt.style;"string"!=typeof pn&&(pn=pn[Ce.$modeName$=(fe=>Ti.map(je=>je(fe)).find(je=>!!je))(je)]);const An=nr(Ve,Ce.$modeName$);if(!fi.has(An)){const cr=()=>{};mn(An,pn,!!(1&Ve.$flags$)),cr()}}}const fn=Ce.$ancestorComponent$,xn=()=>he(Ce,!0);fn&&fn["s-rc"]?fn["s-rc"].push(xn):xn()});return function(Ce,Ve,St,zt,fn){return fe.apply(this,arguments)}}(),ot=fe=>{yn(fe,"connectedCallback")},vn=fe=>{const je=fe["s-cr"]=ui.createComment("");je["s-cn"]=!0,fe.insertBefore(je,fe.firstChild)},Wn=(fe,je={})=>{var Ce;const St=[],zt=je.exclude||[],fn=Qr.customElements,xn=ui.head,pn=xn.querySelector("meta[charset]"),An=ui.createElement("style"),cr=[],Tr=ui.querySelectorAll(`[${Ft}]`);let kr,Ei=!0,oo=0;for(Object.assign(qr,je),qr.$resourcesUrl$=new URL(je.resourcesUrl||"./",ui.baseURI).href,qr.$flags$|=2;oo<Tr.length;oo++)mn(Tr[oo].getAttribute(Ft),_r(Tr[oo].innerHTML),!0);fe.map(Wi=>{Wi[1].map(Ji=>{const Ri={$flags$:Ji[0],$tagName$:Ji[1],$members$:Ji[2],$listeners$:Ji[3]};Ri.$members$=Ji[2],Ri.$listeners$=Ji[3],Ri.$attrsToReflect$=[],Ri.$watchers$={};const To=Ri.$tagName$,jr=class extends HTMLElement{constructor(Zr){super(Zr),Dn(Zr=this,Ri),1&Ri.$flags$&&Zr.attachShadow({mode:"open",delegatesFocus:!!(16&Ri.$flags$)})}connectedCallback(){kr&&(clearTimeout(kr),kr=null),Ei?cr.push(this):qr.jmp(()=>(fe=>{if(!(1&qr.$flags$)){const je=rn(fe),Ce=je.$cmpMeta$,Ve=()=>{};if(1&je.$flags$)hr(fe,je,Ce.$listeners$),ot(je.$lazyInstance$);else{let St;if(je.$flags$|=1,St=fe.getAttribute(Bt),St){if(1&Ce.$flags$){const zt=Bn(fe.shadowRoot,Ce,fe.getAttribute("s-mode"));fe.classList.remove(zt+"-h",zt+"-s")}((fe,je,Ce,Ve)=>{const zt=fe.shadowRoot,fn=[],pn=zt?[]:null,An=Ve.$vnode$=Ht(je,null);qr.$orgLocNodes$||ct(ui.body,qr.$orgLocNodes$=new Map),fe[Bt]=Ce,fe.removeAttribute(Bt),ze(An,fn,[],pn,fe,fe,Ce),fn.map(cr=>{const Tr=cr.$hostId$+"."+cr.$nodeId$,kr=qr.$orgLocNodes$.get(Tr),Ei=cr.$elm$;kr&&cn&&""===kr["s-en"]&&kr.parentNode.insertBefore(Ei,kr.nextSibling),zt||(Ei["s-hn"]=je,kr&&(Ei["s-ol"]=kr,Ei["s-ol"]["s-nr"]=Ei)),qr.$orgLocNodes$.delete(Tr)}),zt&&pn.map(cr=>{cr&&zt.appendChild(cr)})})(fe,Ce.$tagName$,St,je)}St||12&Ce.$flags$&&vn(fe);{let zt=fe;for(;zt=zt.parentNode||zt.host;)if(1===zt.nodeType&&zt.hasAttribute("s-id")&&zt["s-p"]||zt["s-p"]){Qe(je,je.$ancestorComponent$=zt);break}}Ce.$members$&&Object.entries(Ce.$members$).map(([zt,[fn]])=>{if(31&fn&&fe.hasOwnProperty(zt)){const xn=fe[zt];delete fe[zt],fe[zt]=xn}}),pe(fe,je,Ce)}Ve()}})(this))}disconnectedCallback(){qr.jmp(()=>(fe=>{if(!(1&qr.$flags$)){const je=rn(this),Ce=je.$lazyInstance$;je.$rmListeners$&&(je.$rmListeners$.map(Ve=>Ve()),je.$rmListeners$=void 0),yn(Ce,"disconnectedCallback")}})())}componentOnReady(){return rn(this).$onReadyPromise$}};Ri.$lazyBundleId$=Wi[0],!zt.includes(To)&&!fn.get(To)&&(St.push(To),fn.define(To,Ne(jr,Ri,1)))})});{An.innerHTML=St+"{visibility:hidden}.hydrated{visibility:inherit}",An.setAttribute("data-styles","");const Wi=null!==(Ce=qr.$nonce$)&&void 0!==Ce?Ce:dn(ui);null!=Wi&&An.setAttribute("nonce",Wi),xn.insertBefore(An,pn?pn.nextSibling:xn.firstChild)}Ei=!1,cr.length?cr.map(Wi=>Wi.connectedCallback()):qr.jmp(()=>kr=setTimeout(Vt,30))},hr=(fe,je,Ce,Ve)=>{Ce&&Ce.map(([St,zt,fn])=>{const xn=Wr(fe,St),pn=vr(je,fn),An=ni(St);qr.ael(xn,zt,pn,An),(je.$rmListeners$=je.$rmListeners$||[]).push(()=>qr.rel(xn,zt,pn,An))})},vr=(fe,je)=>Ce=>{try{256&fe.$flags$?fe.$lazyInstance$[je](Ce):(fe.$queuedListeners$=fe.$queuedListeners$||[]).push([je,Ce])}catch(Ve){Zn(Ve)}},Wr=(fe,je)=>4&je?ui:8&je?Qr:16&je?ui.body:fe,ni=fe=>0!=(2&fe),Bo=new WeakMap,rn=fe=>Bo.get(fe),Tt=(fe,je)=>Bo.set(je.$lazyInstance$=fe,je),Dn=(fe,je)=>{const Ce={$flags$:0,$hostElement$:fe,$cmpMeta$:je,$instanceValues$:new Map};return Ce.$onInstancePromise$=new Promise(Ve=>Ce.$onInstanceResolve$=Ve),Ce.$onReadyPromise$=new Promise(Ve=>Ce.$onReadyResolve$=Ve),fe["s-p"]=[],fe["s-rc"]=[],hr(fe,Ce,je.$listeners$),Bo.set(fe,Ce)},ur=(fe,je)=>je in fe,Zn=(fe,je)=>(0,console.error)(fe,je),Rr=new Map,Fr=(fe,je,Ce)=>{const Ve=fe.$tagName$.replace(/-/g,"_"),St=fe.$lazyBundleId$,zt=Rr.get(St);return zt?zt[Ve]:K(863)(`./${St}.entry.js`).then(fn=>(Rr.set(St,fn),fn[Ve]),Zn)},fi=new Map,Ti=[],Qr=typeof window<"u"?window:{},ui=Qr.document||{head:{}},qr={$flags$:0,$resourcesUrl$:"",jmp:fe=>fe(),raf:fe=>requestAnimationFrame(fe),ael:(fe,je,Ce,Ve)=>fe.addEventListener(je,Ce,Ve),rel:(fe,je,Ce,Ve)=>fe.removeEventListener(je,Ce,Ve),ce:(fe,je)=>new CustomEvent(fe,je)},Es=fe=>{Object.assign(qr,fe)},cn=!0,io=fe=>Promise.resolve(fe),wi=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),oi=[],Yo=[],Vi=(fe,je)=>Ce=>{fe.push(Ce),xe||(xe=!0,je&&4&qr.$flags$?No(Po):qr.raf(Po))},ss=fe=>{for(let je=0;je<fe.length;je++)try{fe[je](performance.now())}catch(Ce){Zn(Ce)}fe.length=0},Po=()=>{ss(oi),ss(Yo),(xe=oi.length>0)&&qr.raf(Po)},No=fe=>io().then(fe),qn=Vi(oi,!1),Cr=Vi(Yo,!0)},8077:(Gn,At,K)=>{"use strict";K.r(At),K.d(At,{GESTURE_CONTROLLER:()=>I.G,createGesture:()=>et});var I=K(4587);const b=(tt,lt,pt,vt)=>{const _t=dt(tt)?{capture:!!vt.capture,passive:!!vt.passive}:!!vt.capture;let nt,Bt;return tt.__zone_symbol__addEventListener?(nt="__zone_symbol__addEventListener",Bt="__zone_symbol__removeEventListener"):(nt="addEventListener",Bt="removeEventListener"),tt[nt](lt,pt,_t),()=>{tt[Bt](lt,pt,_t)}},dt=tt=>{if(void 0===l)try{const lt=Object.defineProperty({},"passive",{get:()=>{l=!0}});tt.addEventListener("optsTest",()=>{},lt)}catch{l=!1}return!!l};let l;const Le=tt=>tt instanceof Document?tt:tt.ownerDocument,et=tt=>{let lt=!1,pt=!1,vt=!0,_t=!1;const nt=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},tt),Bt=nt.canStart,Ft=nt.onWillStart,Se=nt.onStart,Me=nt.onEnd,ht=nt.notCaptured,It=nt.onMove,Je=nt.threshold,mt=nt.passive,Kt=nt.blurOnStart,Ut={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},dn=((tt,lt,pt)=>{const vt=pt*(Math.PI/180),_t="x"===tt,nt=Math.cos(vt),Bt=lt*lt;let Ft=0,Se=0,Me=!1,ht=0;return{start(It,Je){Ft=It,Se=Je,ht=0,Me=!0},detect(It,Je){if(!Me)return!1;const mt=It-Ft,Kt=Je-Se,Ut=mt*mt+Kt*Kt;if(Ut<Bt)return!1;const dn=Math.sqrt(Ut),on=(_t?mt:Kt)/dn;return ht=on>nt?1:on<-nt?-1:0,Me=!1,!0},isGesture:()=>0!==ht,getDirection:()=>ht}})(nt.direction,nt.threshold,nt.maxAngle),on=I.G.createGesture({name:tt.gestureName,priority:tt.gesturePriority,disableScroll:tt.disableScroll}),en=()=>{lt&&(_t=!1,It&&It(Ut))},bt=()=>!!on.capture()&&(lt=!0,vt=!1,Ut.startX=Ut.currentX,Ut.startY=Ut.currentY,Ut.startTime=Ut.currentTime,Ft?Ft(Ut).then(ue):ue(),!0),ue=()=>{Kt&&(()=>{if(typeof document<"u"){const Gt=document.activeElement;Gt?.blur&&Gt.blur()}})(),Se&&Se(Ut),vt=!0},me=()=>{lt=!1,pt=!1,_t=!1,vt=!0,on.release()},ze=Gt=>{const Yt=lt,hn=vt;if(me(),hn){if(xe(Ut,Gt),Yt)return void(Me&&Me(Ut));ht&&ht(Ut)}},ct=((tt,lt,pt,vt,_t)=>{let nt,Bt,Ft,Se,Me,ht,It,Je=0;const mt=$e=>{Je=Date.now()+2e3,lt($e)&&(!Bt&&pt&&(Bt=b(tt,"touchmove",pt,_t)),Ft||(Ft=b($e.target,"touchend",Ut,_t)),Se||(Se=b($e.target,"touchcancel",Ut,_t)))},Kt=$e=>{Je>Date.now()||lt($e)&&(!ht&&pt&&(ht=b(Le(tt),"mousemove",pt,_t)),It||(It=b(Le(tt),"mouseup",dn,_t)))},Ut=$e=>{on(),vt&&vt($e)},dn=$e=>{Ht(),vt&&vt($e)},on=()=>{Bt&&Bt(),Ft&&Ft(),Se&&Se(),Bt=Ft=Se=void 0},Ht=()=>{ht&&ht(),It&&It(),ht=It=void 0},Yn=()=>{on(),Ht()},en=($e=!0)=>{$e?(nt||(nt=b(tt,"touchstart",mt,_t)),Me||(Me=b(tt,"mousedown",Kt,_t))):(nt&&nt(),Me&&Me(),nt=Me=void 0,Yn())};return{enable:en,stop:Yn,destroy:()=>{en(!1),vt=pt=lt=void 0}}})(nt.el,Gt=>{const Yt=Ze(Gt);return!(pt||!vt||(Re(Gt,Ut),Ut.startX=Ut.currentX,Ut.startY=Ut.currentY,Ut.startTime=Ut.currentTime=Yt,Ut.velocityX=Ut.velocityY=Ut.deltaX=Ut.deltaY=0,Ut.event=Gt,Bt&&!1===Bt(Ut))||(on.release(),!on.start()))&&(pt=!0,0===Je?bt():(dn.start(Ut.startX,Ut.startY),!0))},Gt=>{lt?!_t&&vt&&(_t=!0,xe(Ut,Gt),requestAnimationFrame(en)):(xe(Ut,Gt),dn.detect(Ut.currentX,Ut.currentY)&&(!dn.isGesture()||!bt())&&Lt())},ze,{capture:!1,passive:mt}),Lt=()=>{me(),ct.stop(),ht&&ht(Ut)};return{enable(Gt=!0){Gt||(lt&&ze(void 0),me()),ct.enable(Gt)},destroy(){on.destroy(),ct.destroy()}}},xe=(tt,lt)=>{if(!lt)return;const pt=tt.currentX,vt=tt.currentY,_t=tt.currentTime;Re(lt,tt);const nt=tt.currentX,Bt=tt.currentY,Se=(tt.currentTime=Ze(lt))-_t;if(Se>0&&Se<100){const ht=(Bt-vt)/Se;tt.velocityX=(nt-pt)/Se*.7+.3*tt.velocityX,tt.velocityY=.7*ht+.3*tt.velocityY}tt.deltaX=nt-tt.startX,tt.deltaY=Bt-tt.startY,tt.event=lt},Re=(tt,lt)=>{let pt=0,vt=0;if(tt){const _t=tt.changedTouches;if(_t&&_t.length>0){const nt=_t[0];pt=nt.clientX,vt=nt.clientY}else void 0!==tt.pageX&&(pt=tt.pageX,vt=tt.pageY)}lt.currentX=pt,lt.currentY=vt},Ze=tt=>tt.timeStamp||Date.now()},1767:(Gn,At,K)=>{"use strict";K.d(At,{m:()=>Re});var I=K(5861),b=K(5421),dt=K(544),l=K(7876),ve=K(6506);const Ue=Ze=>(0,ve.c)().duration(Ze?400:300),Le=Ze=>{let tt,lt;const pt=Ze.width+8,vt=(0,ve.c)(),_t=(0,ve.c)();Ze.isEndSide?(tt=pt+"px",lt="0px"):(tt=-pt+"px",lt="0px"),vt.addElement(Ze.menuInnerEl).fromTo("transform",`translateX(${tt})`,`translateX(${lt})`);const Bt="ios"===(0,l.b)(Ze),Ft=Bt?.2:.25;return _t.addElement(Ze.backdropEl).fromTo("opacity",.01,Ft),Ue(Bt).addAnimation([vt,_t])},it=Ze=>{let tt,lt;const pt=(0,l.b)(Ze),vt=Ze.width;Ze.isEndSide?(tt=-vt+"px",lt=vt+"px"):(tt=vt+"px",lt=-vt+"px");const _t=(0,ve.c)().addElement(Ze.menuInnerEl).fromTo("transform",`translateX(${lt})`,"translateX(0px)"),nt=(0,ve.c)().addElement(Ze.contentEl).fromTo("transform","translateX(0px)",`translateX(${tt})`),Bt=(0,ve.c)().addElement(Ze.backdropEl).fromTo("opacity",.01,.32);return Ue("ios"===pt).addAnimation([_t,nt,Bt])},et=Ze=>{const tt=(0,l.b)(Ze),lt=Ze.width*(Ze.isEndSide?-1:1)+"px",pt=(0,ve.c)().addElement(Ze.contentEl).fromTo("transform","translateX(0px)",`translateX(${lt})`);return Ue("ios"===tt).addAnimation(pt)},Re=(()=>{const Ze=new Map,tt=[],lt=function(){var ue=(0,I.Z)(function*(me){const ze=yield Se(me);return!!ze&&ze.open()});return function(ze){return ue.apply(this,arguments)}}(),pt=function(){var ue=(0,I.Z)(function*(me){const ze=yield void 0!==me?Se(me):Me();return void 0!==ze&&ze.close()});return function(ze){return ue.apply(this,arguments)}}(),vt=function(){var ue=(0,I.Z)(function*(me){const ze=yield Se(me);return!!ze&&ze.toggle()});return function(ze){return ue.apply(this,arguments)}}(),_t=function(){var ue=(0,I.Z)(function*(me,ze){const ct=yield Se(ze);return ct&&(ct.disabled=!me),ct});return function(ze,ct){return ue.apply(this,arguments)}}(),nt=function(){var ue=(0,I.Z)(function*(me,ze){const ct=yield Se(ze);return ct&&(ct.swipeGesture=me),ct});return function(ze,ct){return ue.apply(this,arguments)}}(),Bt=function(){var ue=(0,I.Z)(function*(me){if(null!=me){const ze=yield Se(me);return void 0!==ze&&ze.isOpen()}return void 0!==(yield Me())});return function(ze){return ue.apply(this,arguments)}}(),Ft=function(){var ue=(0,I.Z)(function*(me){const ze=yield Se(me);return!!ze&&!ze.disabled});return function(ze){return ue.apply(this,arguments)}}(),Se=function(){var ue=(0,I.Z)(function*(me){return yield $e(),"start"===me||"end"===me?bt(Lt=>Lt.side===me&&!Lt.disabled)||bt(Lt=>Lt.side===me):null!=me?bt(ct=>ct.menuId===me):bt(ct=>!ct.disabled)||(tt.length>0?tt[0].el:void 0)});return function(ze){return ue.apply(this,arguments)}}(),Me=function(){var ue=(0,I.Z)(function*(){return yield $e(),Ht()});return function(){return ue.apply(this,arguments)}}(),ht=function(){var ue=(0,I.Z)(function*(){return yield $e(),Yn()});return function(){return ue.apply(this,arguments)}}(),It=function(){var ue=(0,I.Z)(function*(){return yield $e(),en()});return function(){return ue.apply(this,arguments)}}(),Je=(ue,me)=>{Ze.set(ue,me)},Ut=ue=>{const me=ue.side;tt.filter(ze=>ze.side===me&&ze!==ue).forEach(ze=>ze.disabled=!0)},dn=function(){var ue=(0,I.Z)(function*(me,ze,ct){if(en())return!1;if(ze){const Lt=yield Me();Lt&&me.el!==Lt&&(yield Lt.setOpen(!1,!1))}return me._setOpen(ze,ct)});return function(ze,ct,Lt){return ue.apply(this,arguments)}}(),Ht=()=>bt(ue=>ue._isOpen),Yn=()=>tt.map(ue=>ue.el),en=()=>tt.some(ue=>ue.isAnimating),bt=ue=>{const me=tt.find(ue);if(void 0!==me)return me.el},$e=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(ue=>new Promise(me=>(0,dt.c)(ue,me))));return Je("reveal",et),Je("push",it),Je("overlay",Le),typeof document<"u"&&document.addEventListener("ionBackButton",ue=>{const me=Ht();me&&ue.detail.register(b.MENU_BACK_BUTTON_PRIORITY,()=>me.close())}),{registerAnimation:Je,get:Se,getMenus:ht,getOpen:Me,isEnabled:Ft,swipeGesture:nt,isAnimating:It,isOpen:Bt,enable:_t,toggle:vt,close:pt,open:lt,_getOpenSync:Ht,_createAnimation:(ue,me)=>{const ze=Ze.get(ue);if(!ze)throw new Error("animation not registered");return ze(me)},_register:ue=>{tt.indexOf(ue)<0&&(ue.disabled||Ut(ue),tt.push(ue))},_unregister:ue=>{const me=tt.indexOf(ue);me>-1&&tt.splice(me,1)},_setOpen:dn,_setActiveMenu:Ut}})()},8354:(Gn,At,K)=>{"use strict";K.d(At,{L:()=>l,a:()=>ve,b:()=>Ue,c:()=>Le,d:()=>it,e:()=>Je,g:()=>Ut,l:()=>ht,s:()=>mt,t:()=>Re,w:()=>It});var I=K(5861),b=K(6953),dt=K(544);const l="ionViewWillEnter",ve="ionViewDidEnter",Ue="ionViewWillLeave",Le="ionViewDidLeave",it="ionViewWillUnload",Re=dn=>new Promise((on,Ht)=>{(0,b.w)(()=>{Ze(dn),tt(dn).then(Yn=>{Yn.animation&&Yn.animation.destroy(),lt(dn),on(Yn)},Yn=>{lt(dn),Ht(Yn)})})}),Ze=dn=>{const on=dn.enteringEl,Ht=dn.leavingEl;Kt(on,Ht,dn.direction),dn.showGoBack?on.classList.add("can-go-back"):on.classList.remove("can-go-back"),mt(on,!1),on.style.setProperty("pointer-events","none"),Ht&&(mt(Ht,!1),Ht.style.setProperty("pointer-events","none"))},tt=function(){var dn=(0,I.Z)(function*(on){const Ht=yield pt(on);return Ht&&b.B.isBrowser?vt(Ht,on):_t(on)});return function(Ht){return dn.apply(this,arguments)}}(),lt=dn=>{const on=dn.enteringEl,Ht=dn.leavingEl;on.classList.remove("ion-page-invisible"),on.style.removeProperty("pointer-events"),void 0!==Ht&&(Ht.classList.remove("ion-page-invisible"),Ht.style.removeProperty("pointer-events"))},pt=function(){var dn=(0,I.Z)(function*(on){return on.leavingEl&&on.animated&&0!==on.duration?on.animationBuilder?on.animationBuilder:"ios"===on.mode?(yield Promise.resolve().then(K.bind(K,8899))).iosTransitionAnimation:(yield Promise.resolve().then(K.bind(K,5298))).mdTransitionAnimation:void 0});return function(Ht){return dn.apply(this,arguments)}}(),vt=function(){var dn=(0,I.Z)(function*(on,Ht){yield nt(Ht,!0);const Yn=on(Ht.baseEl,Ht);Se(Ht.enteringEl,Ht.leavingEl);const en=yield Ft(Yn,Ht);return Ht.progressCallback&&Ht.progressCallback(void 0),en&&Me(Ht.enteringEl,Ht.leavingEl),{hasCompleted:en,animation:Yn}});return function(Ht,Yn){return dn.apply(this,arguments)}}(),_t=function(){var dn=(0,I.Z)(function*(on){const Ht=on.enteringEl,Yn=on.leavingEl;return yield nt(on,!1),Se(Ht,Yn),Me(Ht,Yn),{hasCompleted:!0}});return function(Ht){return dn.apply(this,arguments)}}(),nt=function(){var dn=(0,I.Z)(function*(on,Ht){(void 0!==on.deepWait?on.deepWait:Ht)&&(yield Promise.all([Je(on.enteringEl),Je(on.leavingEl)])),yield Bt(on.viewIsReady,on.enteringEl)});return function(Ht,Yn){return dn.apply(this,arguments)}}(),Bt=function(){var dn=(0,I.Z)(function*(on,Ht){on&&(yield on(Ht))});return function(Ht,Yn){return dn.apply(this,arguments)}}(),Ft=(dn,on)=>{const Ht=on.progressCallback,Yn=new Promise(en=>{dn.onFinish(bt=>en(1===bt))});return Ht?(dn.progressStart(!0),Ht(dn)):dn.play(),Yn},Se=(dn,on)=>{ht(on,Ue),ht(dn,l)},Me=(dn,on)=>{ht(dn,ve),ht(on,Le)},ht=(dn,on)=>{if(dn){const Ht=new CustomEvent(on,{bubbles:!1,cancelable:!1});dn.dispatchEvent(Ht)}},It=()=>new Promise(dn=>(0,dt.r)(()=>(0,dt.r)(()=>dn()))),Je=function(){var dn=(0,I.Z)(function*(on){const Ht=on;if(Ht){if(null!=Ht.componentOnReady){if(null!=(yield Ht.componentOnReady()))return}else if(null!=Ht.__registerHost)return void(yield new Promise(en=>(0,dt.r)(en)));yield Promise.all(Array.from(Ht.children).map(Je))}});return function(Ht){return dn.apply(this,arguments)}}(),mt=(dn,on)=>{on?(dn.setAttribute("aria-hidden","true"),dn.classList.add("ion-page-hidden")):(dn.hidden=!1,dn.removeAttribute("aria-hidden"),dn.classList.remove("ion-page-hidden"))},Kt=(dn,on,Ht)=>{void 0!==dn&&(dn.style.zIndex="back"===Ht?"99":"101"),void 0!==on&&(on.style.zIndex="100")},Ut=dn=>dn.classList.contains("ion-page")?dn:dn.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||dn},7643:(Gn,At,K)=>{"use strict";K.d(At,{d:()=>b,w:()=>I});const I=typeof window<"u"?window:void 0,b=typeof document<"u"?document:void 0},7690:(Gn,At,K)=>{"use strict";K.d(At,{a:()=>b,b:()=>dt,p:()=>I});const I=(l,...ve)=>console.warn(`[Ionic Warning]: ${l}`,...ve),b=(l,...ve)=>console.error(`[Ionic Error]: ${l}`,...ve),dt=(l,...ve)=>console.error(`<${l.tagName.toLowerCase()}> must be used inside ${ve.join(" or ")}.`)},7876:(Gn,At,K)=>{"use strict";K.d(At,{a:()=>Re,b:()=>en,c:()=>dt,g:()=>xe,i:()=>bt});var I=K(6953);class b{constructor(){this.m=new Map}reset(ue){this.m=new Map(Object.entries(ue))}get(ue,me){const ze=this.m.get(ue);return void 0!==ze?ze:me}getBoolean(ue,me=!1){const ze=this.m.get(ue);return void 0===ze?me:"string"==typeof ze?"true"===ze:!!ze}getNumber(ue,me){const ze=parseFloat(this.m.get(ue));return isNaN(ze)?void 0!==me?me:NaN:ze}set(ue,me){this.m.set(ue,me)}}const dt=new b,et="ionic-persist-config",xe=$e=>Ze($e),Re=($e,ue)=>("string"==typeof $e&&(ue=$e,$e=void 0),xe($e).includes(ue)),Ze=($e=window)=>{if(typeof $e>"u")return[];$e.Ionic=$e.Ionic||{};let ue=$e.Ionic.platforms;return null==ue&&(ue=$e.Ionic.platforms=tt($e),ue.forEach(me=>$e.document.documentElement.classList.add(`plt-${me}`))),ue},tt=$e=>{const ue=dt.get("platform");return Object.keys(Ht).filter(me=>{const ze=ue?.[me];return"function"==typeof ze?ze($e):Ht[me]($e)})},pt=$e=>!!(dn($e,/iPad/i)||dn($e,/Macintosh/i)&&Me($e)),nt=$e=>dn($e,/android|sink/i),Me=$e=>on($e,"(any-pointer:coarse)"),It=$e=>Je($e)||mt($e),Je=$e=>!!($e.cordova||$e.phonegap||$e.PhoneGap),mt=$e=>{const ue=$e.Capacitor;return!!ue?.isNative},dn=($e,ue)=>ue.test($e.navigator.userAgent),on=($e,ue)=>{var me;return null===(me=$e.matchMedia)||void 0===me?void 0:me.call($e,ue).matches},Ht={ipad:pt,iphone:$e=>dn($e,/iPhone/i),ios:$e=>dn($e,/iPhone|iPod/i)||pt($e),android:nt,phablet:$e=>{const ue=$e.innerWidth,me=$e.innerHeight,ze=Math.min(ue,me),ct=Math.max(ue,me);return ze>390&&ze<520&&ct>620&&ct<800},tablet:$e=>{const ue=$e.innerWidth,me=$e.innerHeight,ze=Math.min(ue,me),ct=Math.max(ue,me);return pt($e)||($e=>nt($e)&&!dn($e,/mobile/i))($e)||ze>460&&ze<820&&ct>780&&ct<1400},cordova:Je,capacitor:mt,electron:$e=>dn($e,/electron/i),pwa:$e=>{var ue;return!!(null!==(ue=$e.matchMedia)&&void 0!==ue&&ue.call($e,"(display-mode: standalone)").matches||$e.navigator.standalone)},mobile:Me,mobileweb:$e=>Me($e)&&!It($e),desktop:$e=>!Me($e),hybrid:It};let Yn;const en=$e=>$e&&(0,I.g)($e)||Yn,bt=($e={})=>{if(typeof window>"u")return;const ue=window.document,me=window,ze=me.Ionic=me.Ionic||{},ct={};$e._ael&&(ct.ael=$e._ael),$e._rel&&(ct.rel=$e._rel),$e._ce&&(ct.ce=$e._ce),(0,I.a)(ct);const Lt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},($e=>{try{const ue=$e.sessionStorage.getItem(et);return null!==ue?JSON.parse(ue):{}}catch{return{}}})(me)),{persistConfig:!1}),ze.config),($e=>{const ue={};return $e.location.search.slice(1).split("&").map(me=>me.split("=")).map(([me,ze])=>[decodeURIComponent(me),decodeURIComponent(ze)]).filter(([me])=>(($e,ue)=>$e.substr(0,ue.length)===ue)(me,"ionic:")).map(([me,ze])=>[me.slice(6),ze]).forEach(([me,ze])=>{ue[me]=ze}),ue})(me)),$e);dt.reset(Lt),dt.getBoolean("persistConfig")&&(($e,ue)=>{try{$e.sessionStorage.setItem(et,JSON.stringify(ue))}catch{return}})(me,Lt),Ze(me),ze.config=dt,ze.mode=Yn=dt.get("mode",ue.documentElement.getAttribute("mode")||(Re(me,"ios")?"ios":"md")),dt.set("mode",Yn),ue.documentElement.setAttribute("mode",Yn),ue.documentElement.classList.add(Yn),dt.getBoolean("_testing")&&dt.set("animated",!1);const Gt=hn=>{var sn;return null===(sn=hn.tagName)||void 0===sn?void 0:sn.startsWith("ION-")},Yt=hn=>["ios","md"].includes(hn);(0,I.c)(hn=>{for(;hn;){const sn=hn.mode||hn.getAttribute("mode");if(sn){if(Yt(sn))return sn;Gt(hn)&&console.warn('Invalid ionic mode: "'+sn+'", expected: "ios" or "md"')}hn=hn.parentElement}return Yn})}},8899:(Gn,At,K)=>{"use strict";K.r(At),K.d(At,{iosTransitionAnimation:()=>tt,shadow:()=>Le});var I=K(6506),b=K(8354);K(7643),K(6953);const Ue=lt=>document.querySelector(`${lt}.ion-cloned-element`),Le=lt=>lt.shadowRoot||lt,it=lt=>{const pt="ION-TABS"===lt.tagName?lt:lt.querySelector("ion-tabs"),vt="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=pt){const _t=pt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=_t?_t.querySelector(vt):null}return lt.querySelector(vt)},et=(lt,pt)=>{const vt="ION-TABS"===lt.tagName?lt:lt.querySelector("ion-tabs");let _t=[];if(null!=vt){const nt=vt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=nt&&(_t=nt.querySelectorAll("ion-buttons"))}else _t=lt.querySelectorAll("ion-buttons");for(const nt of _t){const Bt=nt.closest("ion-header"),Ft=Bt&&!Bt.classList.contains("header-collapse-condense-inactive"),Se=nt.querySelector("ion-back-button"),Me=nt.classList.contains("buttons-collapse");if(null!==Se&&("start"===nt.slot||""===nt.slot)&&(Me&&Ft&&pt||!Me))return Se}return null},Re=(lt,pt,vt,_t,nt,Bt)=>{const Ft=pt?`calc(100% - ${Bt.right+4}px)`:Bt.left-4+"px",Se=pt?"7px":"-7px",Me=pt?"-4px":"4px",ht=pt?"-4px":"4px",It=pt?"right":"left",Je=pt?"left":"right",Ut=vt?[{offset:0,opacity:1,transform:`translate3d(${Me}, ${Bt.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Se}, ${nt.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Se}, ${nt.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${Me}, ${Bt.top-46}px, 0) scale(1)`}],Ht=vt?[{offset:0,opacity:1,transform:`translate3d(${ht}, ${Bt.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${ht}, ${Bt.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${ht}, ${Bt.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${ht}, ${Bt.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${ht}, ${Bt.top-46}px, 0) scale(1)`}],Yn=(0,I.c)(),en=(0,I.c)(),bt=Ue("ion-back-button"),$e=Le(bt).querySelector(".button-text"),ue=Le(bt).querySelector("ion-icon");bt.text=_t.text,bt.mode=_t.mode,bt.icon=_t.icon,bt.color=_t.color,bt.disabled=_t.disabled,bt.style.setProperty("display","block"),bt.style.setProperty("position","fixed"),en.addElement(ue),Yn.addElement($e),Yn.beforeStyles({"transform-origin":`${It} center`}).beforeAddWrite(()=>{_t.style.setProperty("display","none"),bt.style.setProperty(It,Ft)}).afterAddWrite(()=>{_t.style.setProperty("display",""),bt.style.setProperty("display","none"),bt.style.removeProperty(It)}).keyframes(Ut),en.beforeStyles({"transform-origin":`${Je} center`}).keyframes(Ht),lt.addAnimation([Yn,en])},Ze=(lt,pt,vt,_t,nt,Bt)=>{const Ft=pt?`calc(100% - ${nt.right}px)`:`${nt.left}px`,Se=pt?"-18px":"18px",Me=pt?"right":"left",Je=vt?[{offset:0,opacity:0,transform:`translate3d(${Se}, ${Bt.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${nt.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${nt.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Se}, ${Bt.top-4}px, 0) scale(0.5)`}],mt=Ue("ion-title"),Kt=(0,I.c)();mt.innerText=_t.innerText,mt.size=_t.size,mt.color=_t.color,Kt.addElement(mt),Kt.beforeStyles({"transform-origin":`${Me} center`,height:"46px",display:"",position:"relative",[Me]:Ft}).beforeAddWrite(()=>{_t.style.setProperty("display","none")}).afterAddWrite(()=>{_t.style.setProperty("display",""),mt.style.setProperty("display","none")}).keyframes(Je),lt.addAnimation(Kt)},tt=(lt,pt)=>{var vt;try{const _t="cubic-bezier(0.32,0.72,0,1)",nt="opacity",Bt="transform",Ft="0%",Me="rtl"===lt.ownerDocument.dir,ht=Me?"-99.5%":"99.5%",It=Me?"33%":"-33%",Je=pt.enteringEl,mt=pt.leavingEl,Kt="back"===pt.direction,Ut=Je.querySelector(":scope > ion-content"),dn=Je.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),on=Je.querySelectorAll(":scope > ion-header > ion-toolbar"),Ht=(0,I.c)(),Yn=(0,I.c)();if(Ht.addElement(Je).duration((null!==(vt=pt.duration)&&void 0!==vt?vt:0)||540).easing(pt.easing||_t).fill("both").beforeRemoveClass("ion-page-invisible"),mt&&null!=lt){const ue=(0,I.c)();ue.addElement(lt),Ht.addAnimation(ue)}if(Ut||0!==on.length||0!==dn.length?(Yn.addElement(Ut),Yn.addElement(dn)):Yn.addElement(Je.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ht.addAnimation(Yn),Kt?Yn.beforeClearStyles([nt]).fromTo("transform",`translateX(${It})`,`translateX(${Ft})`).fromTo(nt,.8,1):Yn.beforeClearStyles([nt]).fromTo("transform",`translateX(${ht})`,`translateX(${Ft})`),Ut){const ue=Le(Ut).querySelector(".transition-effect");if(ue){const me=ue.querySelector(".transition-cover"),ze=ue.querySelector(".transition-shadow"),ct=(0,I.c)(),Lt=(0,I.c)(),Gt=(0,I.c)();ct.addElement(ue).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Lt.addElement(me).beforeClearStyles([nt]).fromTo(nt,0,.1),Gt.addElement(ze).beforeClearStyles([nt]).fromTo(nt,.03,.7),ct.addAnimation([Lt,Gt]),Yn.addAnimation([ct])}}const en=Je.querySelector("ion-header.header-collapse-condense"),{forward:bt,backward:$e}=((lt,pt,vt,_t,nt)=>{const Bt=et(_t,vt),Ft=it(nt),Se=it(_t),Me=et(nt,vt),ht=null!==Bt&&null!==Ft&&!vt,It=null!==Se&&null!==Me&&vt;if(ht){const Je=Ft.getBoundingClientRect(),mt=Bt.getBoundingClientRect();Ze(lt,pt,vt,Ft,Je,mt),Re(lt,pt,vt,Bt,Je,mt)}else if(It){const Je=Se.getBoundingClientRect(),mt=Me.getBoundingClientRect();Ze(lt,pt,vt,Se,Je,mt),Re(lt,pt,vt,Me,Je,mt)}return{forward:ht,backward:It}})(Ht,Me,Kt,Je,mt);if(on.forEach(ue=>{const me=(0,I.c)();me.addElement(ue),Ht.addAnimation(me);const ze=(0,I.c)();ze.addElement(ue.querySelector("ion-title"));const ct=(0,I.c)(),Lt=Array.from(ue.querySelectorAll("ion-buttons,[menuToggle]")),Gt=ue.closest("ion-header"),Yt=Gt?.classList.contains("header-collapse-condense-inactive");let hn;hn=Lt.filter(Kt?mn=>{const Bn=mn.classList.contains("buttons-collapse");return Bn&&!Yt||!Bn}:mn=>!mn.classList.contains("buttons-collapse")),ct.addElement(hn);const sn=(0,I.c)();sn.addElement(ue.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const jt=(0,I.c)();jt.addElement(Le(ue).querySelector(".toolbar-background"));const Xt=(0,I.c)(),an=ue.querySelector("ion-back-button");if(an&&Xt.addElement(an),me.addAnimation([ze,ct,sn,jt,Xt]),ct.fromTo(nt,.01,1),sn.fromTo(nt,.01,1),Kt)Yt||ze.fromTo("transform",`translateX(${It})`,`translateX(${Ft})`).fromTo(nt,.01,1),sn.fromTo("transform",`translateX(${It})`,`translateX(${Ft})`),Xt.fromTo(nt,.01,1);else if(en||ze.fromTo("transform",`translateX(${ht})`,`translateX(${Ft})`).fromTo(nt,.01,1),sn.fromTo("transform",`translateX(${ht})`,`translateX(${Ft})`),jt.beforeClearStyles([nt,"transform"]),Gt?.translucent?jt.fromTo("transform",Me?"translateX(-100%)":"translateX(100%)","translateX(0px)"):jt.fromTo(nt,.01,"var(--opacity)"),bt||Xt.fromTo(nt,.01,1),an&&!bt){const Bn=(0,I.c)();Bn.addElement(Le(an).querySelector(".button-text")).fromTo("transform",Me?"translateX(-100px)":"translateX(100px)","translateX(0px)"),me.addAnimation(Bn)}}),mt){const ue=(0,I.c)(),me=mt.querySelector(":scope > ion-content"),ze=mt.querySelectorAll(":scope > ion-header > ion-toolbar"),ct=mt.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(me||0!==ze.length||0!==ct.length?(ue.addElement(me),ue.addElement(ct)):ue.addElement(mt.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ht.addAnimation(ue),Kt){ue.beforeClearStyles([nt]).fromTo("transform",`translateX(${Ft})`,Me?"translateX(-100%)":"translateX(100%)");const Lt=(0,b.g)(mt);Ht.afterAddWrite(()=>{"normal"===Ht.getDirection()&&Lt.style.setProperty("display","none")})}else ue.fromTo("transform",`translateX(${Ft})`,`translateX(${It})`).fromTo(nt,1,.8);if(me){const Lt=Le(me).querySelector(".transition-effect");if(Lt){const Gt=Lt.querySelector(".transition-cover"),Yt=Lt.querySelector(".transition-shadow"),hn=(0,I.c)(),sn=(0,I.c)(),jt=(0,I.c)();hn.addElement(Lt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),sn.addElement(Gt).beforeClearStyles([nt]).fromTo(nt,.1,0),jt.addElement(Yt).beforeClearStyles([nt]).fromTo(nt,.7,.03),hn.addAnimation([sn,jt]),ue.addAnimation([hn])}}ze.forEach(Lt=>{const Gt=(0,I.c)();Gt.addElement(Lt);const Yt=(0,I.c)();Yt.addElement(Lt.querySelector("ion-title"));const hn=(0,I.c)(),sn=Lt.querySelectorAll("ion-buttons,[menuToggle]"),jt=Lt.closest("ion-header"),Xt=jt?.classList.contains("header-collapse-condense-inactive"),an=Array.from(sn).filter(Kn=>{const Lr=Kn.classList.contains("buttons-collapse");return Lr&&!Xt||!Lr});hn.addElement(an);const mn=(0,I.c)(),Bn=Lt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");Bn.length>0&&mn.addElement(Bn);const mr=(0,I.c)();mr.addElement(Le(Lt).querySelector(".toolbar-background"));const nr=(0,I.c)(),_r=Lt.querySelector("ion-back-button");if(_r&&nr.addElement(_r),Gt.addAnimation([Yt,hn,mn,nr,mr]),Ht.addAnimation(Gt),nr.fromTo(nt,.99,0),hn.fromTo(nt,.99,0),mn.fromTo(nt,.99,0),Kt){if(Xt||Yt.fromTo("transform",`translateX(${Ft})`,Me?"translateX(-100%)":"translateX(100%)").fromTo(nt,.99,0),mn.fromTo("transform",`translateX(${Ft})`,Me?"translateX(-100%)":"translateX(100%)"),mr.beforeClearStyles([nt,"transform"]),jt?.translucent?mr.fromTo("transform","translateX(0px)",Me?"translateX(-100%)":"translateX(100%)"):mr.fromTo(nt,"var(--opacity)",0),_r&&!$e){const Lr=(0,I.c)();Lr.addElement(Le(_r).querySelector(".button-text")).fromTo("transform",`translateX(${Ft})`,`translateX(${(Me?-124:124)+"px"})`),Gt.addAnimation(Lr)}}else Xt||Yt.fromTo("transform",`translateX(${Ft})`,`translateX(${It})`).fromTo(nt,.99,0).afterClearStyles([Bt,nt]),mn.fromTo("transform",`translateX(${Ft})`,`translateX(${It})`).afterClearStyles([Bt,nt]),nr.afterClearStyles([nt]),Yt.afterClearStyles([nt]),hn.afterClearStyles([nt])})}return Ht}catch(_t){throw _t}}},5298:(Gn,At,K)=>{"use strict";K.r(At),K.d(At,{mdTransitionAnimation:()=>ve});var I=K(6506),b=K(8354);K(7643),K(6953);const ve=(Ue,Le)=>{var it,et,xe;const tt="back"===Le.direction,pt=Le.leavingEl,vt=(0,b.g)(Le.enteringEl),_t=vt.querySelector("ion-toolbar"),nt=(0,I.c)();if(nt.addElement(vt).fill("both").beforeRemoveClass("ion-page-invisible"),tt?nt.duration((null!==(it=Le.duration)&&void 0!==it?it:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):nt.duration((null!==(et=Le.duration)&&void 0!==et?et:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),_t){const Bt=(0,I.c)();Bt.addElement(_t),nt.addAnimation(Bt)}if(pt&&tt){nt.duration((null!==(xe=Le.duration)&&void 0!==xe?xe:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const Bt=(0,I.c)();Bt.addElement((0,b.g)(pt)).onFinish(Ft=>{1===Ft&&Bt.elements.length>0&&Bt.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),nt.addAnimation(Bt)}return nt}},8946:(Gn,At,K)=>{"use strict";K.d(At,{B:()=>Gt,G:()=>Yt,a:()=>Re,b:()=>Ze,c:()=>vt,d:()=>hn,e:()=>sn,f:()=>Ht,g:()=>en,h:()=>ue,i:()=>ze,j:()=>nt,k:()=>Bt,l:()=>tt,m:()=>lt,n:()=>et,o:()=>Me,q:()=>dn,s:()=>Lt,t:()=>_t});var I=K(5861),b=K(7876),dt=K(9439),l=K(5421),ve=K(544),Ue=K(7690);let Le=0,it=0;const et=new WeakMap,xe=jt=>({create:Xt=>Ft(jt,Xt),dismiss:(Xt,an,mn)=>Kt(document,Xt,an,jt,mn),getTop:()=>(0,I.Z)(function*(){return dn(document,jt)})()}),Re=xe("ion-alert"),Ze=xe("ion-action-sheet"),tt=xe("ion-loading"),lt=xe("ion-modal"),vt=xe("ion-popover"),_t=xe("ion-toast"),nt=jt=>{typeof document<"u"&&mt(document);const Xt=Le++;jt.overlayIndex=Xt},Bt=jt=>(jt.hasAttribute("id")||(jt.id="ion-overlay-"+ ++it),jt.id),Ft=(jt,Xt)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(jt).then(()=>{const an=document.createElement(jt);return an.classList.add("overlay-hidden"),Object.assign(an,Object.assign(Object.assign({},Xt),{hasController:!0})),bt(document).appendChild(an),new Promise(mn=>(0,ve.c)(an,mn))}):Promise.resolve(),Se='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Me=(jt,Xt)=>{let an=jt.querySelector(Se);const mn=an?.shadowRoot;mn&&(an=mn.querySelector(Se)||an),an?(0,ve.f)(an):Xt.focus()},It=(jt,Xt)=>{const an=Array.from(jt.querySelectorAll(Se));let mn=an.length>0?an[an.length-1]:null;const Bn=mn?.shadowRoot;Bn&&(mn=Bn.querySelector(Se)||mn),mn?mn.focus():Xt.focus()},mt=jt=>{0===Le&&(Le=1,jt.addEventListener("focus",Xt=>{((jt,Xt)=>{const an=dn(Xt,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),mn=jt.target;an&&mn&&!an.classList.contains("ion-disable-focus-trap")&&(an.shadowRoot?(()=>{if(an.contains(mn))an.lastFocus=mn;else{const nr=an.lastFocus;Me(an,an),nr===Xt.activeElement&&It(an,an),an.lastFocus=Xt.activeElement}})():(()=>{if(an===mn)an.lastFocus=void 0;else{const nr=(0,ve.g)(an);if(!nr.contains(mn))return;const _r=nr.querySelector(".ion-overlay-wrapper");if(!_r)return;if(_r.contains(mn)||mn===nr.querySelector("ion-backdrop"))an.lastFocus=mn;else{const Kn=an.lastFocus;Me(_r,an),Kn===Xt.activeElement&&It(_r,an),an.lastFocus=Xt.activeElement}}})())})(Xt,jt)},!0),jt.addEventListener("ionBackButton",Xt=>{const an=dn(jt);an?.backdropDismiss&&Xt.detail.register(l.OVERLAY_BACK_BUTTON_PRIORITY,()=>an.dismiss(void 0,Gt))}),jt.addEventListener("keydown",Xt=>{if("Escape"===Xt.key){const an=dn(jt);an?.backdropDismiss&&an.dismiss(void 0,Gt)}}))},Kt=(jt,Xt,an,mn,Bn)=>{const mr=dn(jt,mn,Bn);return mr?mr.dismiss(Xt,an):Promise.reject("overlay does not exist")},dn=(jt,Xt,an)=>{const mn=((jt,Xt)=>(void 0===Xt&&(Xt="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(jt.querySelectorAll(Xt)).filter(an=>an.overlayIndex>0)))(jt,Xt).filter(Bn=>!(jt=>jt.classList.contains("overlay-hidden"))(Bn));return void 0===an?mn[mn.length-1]:mn.find(Bn=>Bn.id===an)},on=(jt=!1)=>{const an=bt(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");an&&(jt?an.setAttribute("aria-hidden","true"):an.removeAttribute("aria-hidden"))},Ht=function(){var jt=(0,I.Z)(function*(Xt,an,mn,Bn,mr){var nr,_r;if(Xt.presented)return;on(!0),Xt.presented=!0,Xt.willPresent.emit(),null===(nr=Xt.willPresentShorthand)||void 0===nr||nr.emit();const Kn=(0,b.b)(Xt),Lr=Xt.enterAnimation?Xt.enterAnimation:b.c.get(an,"ios"===Kn?mn:Bn);(yield $e(Xt,Lr,Xt.el,mr))&&(Xt.didPresent.emit(),null===(_r=Xt.didPresentShorthand)||void 0===_r||_r.emit()),"ION-TOAST"!==Xt.el.tagName&&Yn(Xt.el),Xt.keyboardClose&&(null===document.activeElement||!Xt.el.contains(document.activeElement))&&Xt.el.focus()});return function(an,mn,Bn,mr,nr){return jt.apply(this,arguments)}}(),Yn=function(){var jt=(0,I.Z)(function*(Xt){let an=document.activeElement;if(!an)return;const mn=an?.shadowRoot;mn&&(an=mn.querySelector(Se)||an),yield Xt.onDidDismiss(),an.focus()});return function(an){return jt.apply(this,arguments)}}(),en=function(){var jt=(0,I.Z)(function*(Xt,an,mn,Bn,mr,nr,_r){var Kn,Lr;if(!Xt.presented)return!1;on(!1),Xt.presented=!1;try{Xt.el.style.setProperty("pointer-events","none"),Xt.willDismiss.emit({data:an,role:mn}),null===(Kn=Xt.willDismissShorthand)||void 0===Kn||Kn.emit({data:an,role:mn});const bn=(0,b.b)(Xt),Jr=Xt.leaveAnimation?Xt.leaveAnimation:b.c.get(Bn,"ios"===bn?mr:nr);mn!==Yt&&(yield $e(Xt,Jr,Xt.el,_r)),Xt.didDismiss.emit({data:an,role:mn}),null===(Lr=Xt.didDismissShorthand)||void 0===Lr||Lr.emit({data:an,role:mn}),et.delete(Xt),Xt.el.classList.add("overlay-hidden"),Xt.el.style.removeProperty("pointer-events"),void 0!==Xt.el.lastFocus&&(Xt.el.lastFocus=void 0)}catch(bn){console.error(bn)}return Xt.el.remove(),!0});return function(an,mn,Bn,mr,nr,_r,Kn){return jt.apply(this,arguments)}}(),bt=jt=>jt.querySelector("ion-app")||jt.body,$e=function(){var jt=(0,I.Z)(function*(Xt,an,mn,Bn){mn.classList.remove("overlay-hidden");const nr=an(Xt.el,Bn);(!Xt.animated||!b.c.getBoolean("animated",!0))&&nr.duration(0),Xt.keyboardClose&&nr.beforeAddWrite(()=>{const Kn=mn.ownerDocument.activeElement;Kn?.matches("input,ion-input, ion-textarea")&&Kn.blur()});const _r=et.get(Xt)||[];return et.set(Xt,[..._r,nr]),yield nr.play(),!0});return function(an,mn,Bn,mr){return jt.apply(this,arguments)}}(),ue=(jt,Xt)=>{let an;const mn=new Promise(Bn=>an=Bn);return me(jt,Xt,Bn=>{an(Bn.detail)}),mn},me=(jt,Xt,an)=>{const mn=Bn=>{(0,ve.b)(jt,Xt,mn),an(Bn)};(0,ve.a)(jt,Xt,mn)},ze=jt=>"cancel"===jt||jt===Gt,ct=jt=>jt(),Lt=(jt,Xt)=>{if("function"==typeof jt)return b.c.get("_zoneGate",ct)(()=>{try{return jt(Xt)}catch(mn){throw mn}})},Gt="backdrop",Yt="gesture",hn=jt=>{let an,Xt=!1;const mn=(0,dt.C)(),Bn=(_r=!1)=>{if(an&&!_r)return{delegate:an,inline:Xt};const{el:Kn,hasController:Lr,delegate:bn}=jt;return Xt=null!==Kn.parentNode&&!Lr,an=Xt?bn||mn:bn,{inline:Xt,delegate:an}};return{attachViewToDom:function(){var _r=(0,I.Z)(function*(Kn){const{delegate:Lr}=Bn(!0);if(Lr)return yield Lr.attachViewToDom(jt.el,Kn);const{hasController:bn}=jt;if(bn&&void 0!==Kn)throw new Error("framework delegate is missing");return null});return function(Lr){return _r.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:_r}=Bn();_r&&void 0!==jt.el&&_r.removeViewFromDom(jt.el.parentElement,jt.el)}}},sn=()=>{let jt;const Xt=()=>{jt&&(jt(),jt=void 0)};return{addClickListener:(mn,Bn)=>{Xt();const mr=void 0!==Bn?document.getElementById(Bn):null;mr?jt=((_r,Kn)=>{const Lr=()=>{Kn.present()};return _r.addEventListener("click",Lr),()=>{_r.removeEventListener("click",Lr)}})(mr,mn):(0,Ue.p)(`A trigger element with the ID "${Bn}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,mn)},removeClickListener:Xt}}},335:(Gn,At,K)=>{"use strict";var I=K(6593),b=K(5879),dt=K(1160),l=K(7852);let ve=(()=>{var D;class _{constructor(){}}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275cmp=b.Xpm({type:D,selectors:[["app-root"]],decls:2,vars:0,template:function(M,q){1&M&&(b.TgZ(0,"ion-app"),b._UZ(1,"ion-router-outlet"),b.qZA())},dependencies:[l.dr,l.jP]}),_})(),Ue=(()=>{var D;class _{constructor(){this.navCTRL=(0,b.tBr)(l.SH)}canActivate(M,q){return!!localStorage.getItem("ingresado")||(this.navCTRL.navigateRoot("login"),!1)}}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),_})();const it=[{path:"home",loadChildren:()=>K.e(1605).then(K.bind(K,1605)).then(D=>D.HomePageModule),canActivate:[Ue]},{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadChildren:()=>K.e(6488).then(K.bind(K,6488)).then(D=>D.LoginPageModule),canActivate:[(()=>{var D;class _{constructor(){this.navCTRL=(0,b.f3M)(l.SH)}canActivate(M,q){return!localStorage.getItem("ingresado")||(this.navCTRL.navigateRoot("home"),!1)}}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),_})()]},{path:"historial",loadChildren:()=>K.e(3030).then(K.bind(K,3030)).then(D=>D.HistorialPageModule),canActivate:[Ue]},{path:"perfil",loadChildren:()=>Promise.all([K.e(6488),K.e(280)]).then(K.bind(K,280)).then(D=>D.PerfilPageModule),canActivate:[Ue]},{path:"mapa-x",loadChildren:()=>K.e(5001).then(K.bind(K,5001)).then(D=>D.MapaXPageModule),canActivate:[Ue]},{path:"config",loadChildren:()=>K.e(6305).then(K.bind(K,6305)).then(D=>D.ConfigPageModule),canActivate:[Ue]},{path:"**",loadChildren:()=>K.e(1123).then(K.bind(K,1123)).then(D=>D.NotfoundPageModule),canActivate:[Ue]}];let et=(()=>{var D;class _{}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275mod=b.oAB({type:D}),D.\u0275inj=b.cJS({imports:[dt.Bz.forRoot(it,{preloadingStrategy:dt.wm}),dt.Bz]}),_})();var xe=K(6825);function Ze(D){return new b.vHH(3e3,!1)}function Bn(D){switch(D.length){case 0:return new xe.ZN;case 1:return D[0];default:return new xe.ZE(D)}}function mr(D,_,E=new Map,M=new Map){const q=[],oe=[];let ge=-1,Oe=null;if(_.forEach(Pt=>{const Jt=Pt.get("offset"),sr=Jt==ge,Qn=sr&&Oe||new Map;Pt.forEach((Vr,Hr)=>{let Nr=Hr,zr=Vr;if("offset"!==Hr)switch(Nr=D.normalizePropertyName(Nr,q),zr){case xe.k1:zr=E.get(Hr);break;case xe.l3:zr=M.get(Hr);break;default:zr=D.normalizeStyleValue(Hr,Nr,zr,q)}Qn.set(Nr,zr)}),sr||oe.push(Qn),Oe=Qn,ge=Jt}),q.length)throw function ue(D){return new b.vHH(3502,!1)}();return oe}function nr(D,_,E,M){switch(_){case"start":D.onStart(()=>M(E&&_r(E,"start",D)));break;case"done":D.onDone(()=>M(E&&_r(E,"done",D)));break;case"destroy":D.onDestroy(()=>M(E&&_r(E,"destroy",D)))}}function _r(D,_,E){const oe=Kn(D.element,D.triggerName,D.fromState,D.toState,_||D.phaseName,E.totalTime??D.totalTime,!!E.disabled),ge=D._data;return null!=ge&&(oe._data=ge),oe}function Kn(D,_,E,M,q="",oe=0,ge){return{element:D,triggerName:_,fromState:E,toState:M,phaseName:q,totalTime:oe,disabled:!!ge}}function Lr(D,_,E){let M=D.get(_);return M||D.set(_,M=E),M}function bn(D){const _=D.indexOf(":");return[D.substring(1,_),D.slice(_+1)]}const Jr=(()=>typeof document>"u"?null:document.documentElement)();function Fi(D){const _=D.parentNode||D.host||null;return _===Jr?null:_}let fr=null,Er=!1;function qi(D,_){for(;_;){if(_===D)return!0;_=Fi(_)}return!1}function Sr(D,_,E){if(E)return Array.from(D.querySelectorAll(_));const M=D.querySelector(_);return M?[M]:[]}let vi=(()=>{var D;class _{validateStyleProperty(M){return function yr(D){fr||(fr=function Ci(){return typeof document<"u"?document.body:null}()||{},Er=!!fr.style&&"WebkitAppearance"in fr.style);let _=!0;return fr.style&&!function hi(D){return"ebkit"==D.substring(1,6)}(D)&&(_=D in fr.style,!_&&Er&&(_="Webkit"+D.charAt(0).toUpperCase()+D.slice(1)in fr.style)),_}(M)}matchesElement(M,q){return!1}containsElement(M,q){return qi(M,q)}getParentElement(M){return Fi(M)}query(M,q,oe){return Sr(M,q,oe)}computeStyle(M,q,oe){return oe||""}animate(M,q,oe,ge,Oe,Pt=[],Jt){return new xe.ZN(oe,ge)}}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})(),Yr=(()=>{class _{}return _.NOOP=new vi,_})();const Do=1e3,Qe="ng-enter",he="ng-leave",_e="ng-trigger",qe=".ng-trigger",ut="ng-animating",wt=".ng-animating";function Ot(D){if("number"==typeof D)return D;const _=D.match(/^(-?[\.\d]+)(m?s)/);return!_||_.length<2?0:kt(parseFloat(_[1]),_[2])}function kt(D,_){return"s"===_?D*Do:D}function xt(D,_,E){return D.hasOwnProperty("duration")?D:function Vt(D,_,E){let q,oe=0,ge="";if("string"==typeof D){const Oe=D.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===Oe)return _.push(Ze()),{duration:0,delay:0,easing:""};q=kt(parseFloat(Oe[1]),Oe[2]);const Pt=Oe[3];null!=Pt&&(oe=kt(parseFloat(Pt),Oe[4]));const Jt=Oe[5];Jt&&(ge=Jt)}else q=D;if(!E){let Oe=!1,Pt=_.length;q<0&&(_.push(function tt(){return new b.vHH(3100,!1)}()),Oe=!0),oe<0&&(_.push(function lt(){return new b.vHH(3101,!1)}()),Oe=!0),Oe&&_.splice(Pt,0,Ze())}return{duration:q,delay:oe,easing:ge}}(D,_,E)}function yn(D,_={}){return Object.keys(D).forEach(E=>{_[E]=D[E]}),_}function Be(D){const _=new Map;return Object.keys(D).forEach(E=>{_.set(E,D[E])}),_}function Ne(D,_=new Map,E){if(E)for(let[M,q]of E)_.set(M,q);for(let[M,q]of D)_.set(M,q);return _}function pe(D,_,E){_.forEach((M,q)=>{const oe=ni(q);E&&!E.has(q)&&E.set(q,D.style[oe]),D.style[oe]=M})}function ot(D,_){_.forEach((E,M)=>{const q=ni(M);D.style[q]=""})}function $t(D){return Array.isArray(D)?1==D.length?D[0]:(0,xe.vP)(D):D}const Xn=new RegExp("{{\\s*(.+?)\\s*}}","g");function Wn(D){let _=[];if("string"==typeof D){let E;for(;E=Xn.exec(D);)_.push(E[1]);Xn.lastIndex=0}return _}function hr(D,_,E){const M=D.toString(),q=M.replace(Xn,(oe,ge)=>{let Oe=_[ge];return null==Oe&&(E.push(function vt(D){return new b.vHH(3003,!1)}()),Oe=""),Oe.toString()});return q==M?D:q}function vr(D){const _=[];let E=D.next();for(;!E.done;)_.push(E.value),E=D.next();return _}const Wr=/-+([a-z0-9])/g;function ni(D){return D.replace(Wr,(..._)=>_[1].toUpperCase())}function Tt(D,_,E){switch(_.type){case 7:return D.visitTrigger(_,E);case 0:return D.visitState(_,E);case 1:return D.visitTransition(_,E);case 2:return D.visitSequence(_,E);case 3:return D.visitGroup(_,E);case 4:return D.visitAnimate(_,E);case 5:return D.visitKeyframes(_,E);case 6:return D.visitStyle(_,E);case 8:return D.visitReference(_,E);case 9:return D.visitAnimateChild(_,E);case 10:return D.visitAnimateRef(_,E);case 11:return D.visitQuery(_,E);case 12:return D.visitStagger(_,E);default:throw function _t(D){return new b.vHH(3004,!1)}()}}function Dn(D,_){return window.getComputedStyle(D)[_]}const Qr="*";function ui(D,_){const E=[];return"string"==typeof D?D.split(/\s*,\s*/).forEach(M=>function qr(D,_,E){if(":"==D[0]){const Pt=function Es(D,_){switch(D){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(E,M)=>parseFloat(M)>parseFloat(E);case":decrement":return(E,M)=>parseFloat(M)<parseFloat(E);default:return _.push(function Yn(D){return new b.vHH(3016,!1)}()),"* => *"}}(D,E);if("function"==typeof Pt)return void _.push(Pt);D=Pt}const M=D.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==M||M.length<4)return E.push(function Ht(D){return new b.vHH(3015,!1)}()),_;const q=M[1],oe=M[2],ge=M[3];_.push(wi(q,ge));"<"==oe[0]&&!(q==Qr&&ge==Qr)&&_.push(wi(ge,q))}(M,E,_)):E.push(D),E}const cn=new Set(["true","1"]),io=new Set(["false","0"]);function wi(D,_){const E=cn.has(D)||io.has(D),M=cn.has(_)||io.has(_);return(q,oe)=>{let ge=D==Qr||D==q,Oe=_==Qr||_==oe;return!ge&&E&&"boolean"==typeof q&&(ge=q?cn.has(D):io.has(D)),!Oe&&M&&"boolean"==typeof oe&&(Oe=oe?cn.has(_):io.has(_)),ge&&Oe}}const Yo=new RegExp("s*:selfs*,?","g");function Vi(D,_,E,M){return new Po(D).build(_,E,M)}class Po{constructor(_){this._driver=_}build(_,E,M){const q=new Cr(E);return this._resetContextStyleTimingState(q),Tt(this,$t(_),q)}_resetContextStyleTimingState(_){_.currentQuerySelector="",_.collectedStyles=new Map,_.collectedStyles.set("",new Map),_.currentTime=0}visitTrigger(_,E){let M=E.queryCount=0,q=E.depCount=0;const oe=[],ge=[];return"@"==_.name.charAt(0)&&E.errors.push(function Bt(){return new b.vHH(3006,!1)}()),_.definitions.forEach(Oe=>{if(this._resetContextStyleTimingState(E),0==Oe.type){const Pt=Oe,Jt=Pt.name;Jt.toString().split(/\s*,\s*/).forEach(sr=>{Pt.name=sr,oe.push(this.visitState(Pt,E))}),Pt.name=Jt}else if(1==Oe.type){const Pt=this.visitTransition(Oe,E);M+=Pt.queryCount,q+=Pt.depCount,ge.push(Pt)}else E.errors.push(function Ft(){return new b.vHH(3007,!1)}())}),{type:7,name:_.name,states:oe,transitions:ge,queryCount:M,depCount:q,options:null}}visitState(_,E){const M=this.visitStyle(_.styles,E),q=_.options&&_.options.params||null;if(M.containsDynamicStyles){const oe=new Set,ge=q||{};M.styles.forEach(Oe=>{Oe instanceof Map&&Oe.forEach(Pt=>{Wn(Pt).forEach(Jt=>{ge.hasOwnProperty(Jt)||oe.add(Jt)})})}),oe.size&&(vr(oe.values()),E.errors.push(function Se(D,_){return new b.vHH(3008,!1)}()))}return{type:0,name:_.name,style:M,options:q?{params:q}:null}}visitTransition(_,E){E.queryCount=0,E.depCount=0;const M=Tt(this,$t(_.animation),E);return{type:1,matchers:ui(_.expr,E.errors),animation:M,queryCount:E.queryCount,depCount:E.depCount,options:Ce(_.options)}}visitSequence(_,E){return{type:2,steps:_.steps.map(M=>Tt(this,M,E)),options:Ce(_.options)}}visitGroup(_,E){const M=E.currentTime;let q=0;const oe=_.steps.map(ge=>{E.currentTime=M;const Oe=Tt(this,ge,E);return q=Math.max(q,E.currentTime),Oe});return E.currentTime=q,{type:3,steps:oe,options:Ce(_.options)}}visitAnimate(_,E){const M=function je(D,_){if(D.hasOwnProperty("duration"))return D;if("number"==typeof D)return Ve(xt(D,_).duration,0,"");const E=D;if(E.split(/\s+/).some(oe=>"{"==oe.charAt(0)&&"{"==oe.charAt(1))){const oe=Ve(0,0,"");return oe.dynamic=!0,oe.strValue=E,oe}const q=xt(E,_);return Ve(q.duration,q.delay,q.easing)}(_.timings,E.errors);E.currentAnimateTimings=M;let q,oe=_.styles?_.styles:(0,xe.oB)({});if(5==oe.type)q=this.visitKeyframes(oe,E);else{let ge=_.styles,Oe=!1;if(!ge){Oe=!0;const Jt={};M.easing&&(Jt.easing=M.easing),ge=(0,xe.oB)(Jt)}E.currentTime+=M.duration+M.delay;const Pt=this.visitStyle(ge,E);Pt.isEmptyStep=Oe,q=Pt}return E.currentAnimateTimings=null,{type:4,timings:M,style:q,options:null}}visitStyle(_,E){const M=this._makeStyleAst(_,E);return this._validateStyleAst(M,E),M}_makeStyleAst(_,E){const M=[],q=Array.isArray(_.styles)?_.styles:[_.styles];for(let Oe of q)"string"==typeof Oe?Oe===xe.l3?M.push(Oe):E.errors.push(new b.vHH(3002,!1)):M.push(Be(Oe));let oe=!1,ge=null;return M.forEach(Oe=>{if(Oe instanceof Map&&(Oe.has("easing")&&(ge=Oe.get("easing"),Oe.delete("easing")),!oe))for(let Pt of Oe.values())if(Pt.toString().indexOf("{{")>=0){oe=!0;break}}),{type:6,styles:M,easing:ge,offset:_.offset,containsDynamicStyles:oe,options:null}}_validateStyleAst(_,E){const M=E.currentAnimateTimings;let q=E.currentTime,oe=E.currentTime;M&&oe>0&&(oe-=M.duration+M.delay),_.styles.forEach(ge=>{"string"!=typeof ge&&ge.forEach((Oe,Pt)=>{const Jt=E.collectedStyles.get(E.currentQuerySelector),sr=Jt.get(Pt);let Qn=!0;sr&&(oe!=q&&oe>=sr.startTime&&q<=sr.endTime&&(E.errors.push(function It(D,_,E,M,q){return new b.vHH(3010,!1)}()),Qn=!1),oe=sr.startTime),Qn&&Jt.set(Pt,{startTime:oe,endTime:q}),E.options&&function vn(D,_,E){const M=_.params||{},q=Wn(D);q.length&&q.forEach(oe=>{M.hasOwnProperty(oe)||E.push(function pt(D){return new b.vHH(3001,!1)}())})}(Oe,E.options,E.errors)})})}visitKeyframes(_,E){const M={type:5,styles:[],options:null};if(!E.currentAnimateTimings)return E.errors.push(function Je(){return new b.vHH(3011,!1)}()),M;let oe=0;const ge=[];let Oe=!1,Pt=!1,Jt=0;const sr=_.steps.map(ai=>{const zi=this._makeStyleAst(ai,E);let h=null!=zi.offset?zi.offset:function fe(D){if("string"==typeof D)return null;let _=null;if(Array.isArray(D))D.forEach(E=>{if(E instanceof Map&&E.has("offset")){const M=E;_=parseFloat(M.get("offset")),M.delete("offset")}});else if(D instanceof Map&&D.has("offset")){const E=D;_=parseFloat(E.get("offset")),E.delete("offset")}return _}(zi.styles),i=0;return null!=h&&(oe++,i=zi.offset=h),Pt=Pt||i<0||i>1,Oe=Oe||i<Jt,Jt=i,ge.push(i),zi});Pt&&E.errors.push(function mt(){return new b.vHH(3012,!1)}()),Oe&&E.errors.push(function Kt(){return new b.vHH(3200,!1)}());const Qn=_.steps.length;let Vr=0;oe>0&&oe<Qn?E.errors.push(function Ut(){return new b.vHH(3202,!1)}()):0==oe&&(Vr=1/(Qn-1));const Hr=Qn-1,Nr=E.currentTime,zr=E.currentAnimateTimings,ti=zr.duration;return sr.forEach((ai,zi)=>{const h=Vr>0?zi==Hr?1:Vr*zi:ge[zi],i=h*ti;E.currentTime=Nr+zr.delay+i,zr.duration=i,this._validateStyleAst(ai,E),ai.offset=h,M.styles.push(ai)}),M}visitReference(_,E){return{type:8,animation:Tt(this,$t(_.animation),E),options:Ce(_.options)}}visitAnimateChild(_,E){return E.depCount++,{type:9,options:Ce(_.options)}}visitAnimateRef(_,E){return{type:10,animation:this.visitReference(_.animation,E),options:Ce(_.options)}}visitQuery(_,E){const M=E.currentQuerySelector,q=_.options||{};E.queryCount++,E.currentQuery=_;const[oe,ge]=function No(D){const _=!!D.split(/\s*,\s*/).find(E=>":self"==E);return _&&(D=D.replace(Yo,"")),D=D.replace(/@\*/g,qe).replace(/@\w+/g,E=>qe+"-"+E.slice(1)).replace(/:animating/g,wt),[D,_]}(_.selector);E.currentQuerySelector=M.length?M+" "+oe:oe,Lr(E.collectedStyles,E.currentQuerySelector,new Map);const Oe=Tt(this,$t(_.animation),E);return E.currentQuery=null,E.currentQuerySelector=M,{type:11,selector:oe,limit:q.limit||0,optional:!!q.optional,includeSelf:ge,animation:Oe,originalSelector:_.selector,options:Ce(_.options)}}visitStagger(_,E){E.currentQuery||E.errors.push(function dn(){return new b.vHH(3013,!1)}());const M="full"===_.timings?{duration:0,delay:0,easing:"full"}:xt(_.timings,E.errors,!0);return{type:12,animation:Tt(this,$t(_.animation),E),timings:M,options:null}}}class Cr{constructor(_){this.errors=_,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ce(D){return D?(D=yn(D)).params&&(D.params=function qn(D){return D?yn(D):null}(D.params)):D={},D}function Ve(D,_,E){return{duration:D,delay:_,easing:E}}function St(D,_,E,M,q,oe,ge=null,Oe=!1){return{type:1,element:D,keyframes:_,preStyleProps:E,postStyleProps:M,duration:q,delay:oe,totalTime:q+oe,easing:ge,subTimeline:Oe}}class zt{constructor(){this._map=new Map}get(_){return this._map.get(_)||[]}append(_,E){let M=this._map.get(_);M||this._map.set(_,M=[]),M.push(...E)}has(_){return this._map.has(_)}clear(){this._map.clear()}}const pn=new RegExp(":enter","g"),cr=new RegExp(":leave","g");function Tr(D,_,E,M,q,oe=new Map,ge=new Map,Oe,Pt,Jt=[]){return(new kr).buildKeyframes(D,_,E,M,q,oe,ge,Oe,Pt,Jt)}class kr{buildKeyframes(_,E,M,q,oe,ge,Oe,Pt,Jt,sr=[]){Jt=Jt||new zt;const Qn=new oo(_,E,Jt,q,oe,sr,[]);Qn.options=Pt;const Vr=Pt.delay?Ot(Pt.delay):0;Qn.currentTimeline.delayNextStep(Vr),Qn.currentTimeline.setStyles([ge],null,Qn.errors,Pt),Tt(this,M,Qn);const Hr=Qn.timelines.filter(Nr=>Nr.containsAnimation());if(Hr.length&&Oe.size){let Nr;for(let zr=Hr.length-1;zr>=0;zr--){const ti=Hr[zr];if(ti.element===E){Nr=ti;break}}Nr&&!Nr.allowOnlyTimelineStyles()&&Nr.setStyles([Oe],null,Qn.errors,Pt)}return Hr.length?Hr.map(Nr=>Nr.buildKeyframes()):[St(E,[],[],[],0,Vr,"",!1)]}visitTrigger(_,E){}visitState(_,E){}visitTransition(_,E){}visitAnimateChild(_,E){const M=E.subInstructions.get(E.element);if(M){const q=E.createSubContext(_.options),oe=E.currentTimeline.currentTime,ge=this._visitSubInstructions(M,q,q.options);oe!=ge&&E.transformIntoNewTimeline(ge)}E.previousNode=_}visitAnimateRef(_,E){const M=E.createSubContext(_.options);M.transformIntoNewTimeline(),this._applyAnimationRefDelays([_.options,_.animation.options],E,M),this.visitReference(_.animation,M),E.transformIntoNewTimeline(M.currentTimeline.currentTime),E.previousNode=_}_applyAnimationRefDelays(_,E,M){for(const q of _){const oe=q?.delay;if(oe){const ge="number"==typeof oe?oe:Ot(hr(oe,q?.params??{},E.errors));M.delayNextStep(ge)}}}_visitSubInstructions(_,E,M){let oe=E.currentTimeline.currentTime;const ge=null!=M.duration?Ot(M.duration):null,Oe=null!=M.delay?Ot(M.delay):null;return 0!==ge&&_.forEach(Pt=>{const Jt=E.appendInstructionToTimeline(Pt,ge,Oe);oe=Math.max(oe,Jt.duration+Jt.delay)}),oe}visitReference(_,E){E.updateOptions(_.options,!0),Tt(this,_.animation,E),E.previousNode=_}visitSequence(_,E){const M=E.subContextCount;let q=E;const oe=_.options;if(oe&&(oe.params||oe.delay)&&(q=E.createSubContext(oe),q.transformIntoNewTimeline(),null!=oe.delay)){6==q.previousNode.type&&(q.currentTimeline.snapshotCurrentStyles(),q.previousNode=Ei);const ge=Ot(oe.delay);q.delayNextStep(ge)}_.steps.length&&(_.steps.forEach(ge=>Tt(this,ge,q)),q.currentTimeline.applyStylesToKeyframe(),q.subContextCount>M&&q.transformIntoNewTimeline()),E.previousNode=_}visitGroup(_,E){const M=[];let q=E.currentTimeline.currentTime;const oe=_.options&&_.options.delay?Ot(_.options.delay):0;_.steps.forEach(ge=>{const Oe=E.createSubContext(_.options);oe&&Oe.delayNextStep(oe),Tt(this,ge,Oe),q=Math.max(q,Oe.currentTimeline.currentTime),M.push(Oe.currentTimeline)}),M.forEach(ge=>E.currentTimeline.mergeTimelineCollectedStyles(ge)),E.transformIntoNewTimeline(q),E.previousNode=_}_visitTiming(_,E){if(_.dynamic){const M=_.strValue;return xt(E.params?hr(M,E.params,E.errors):M,E.errors)}return{duration:_.duration,delay:_.delay,easing:_.easing}}visitAnimate(_,E){const M=E.currentAnimateTimings=this._visitTiming(_.timings,E),q=E.currentTimeline;M.delay&&(E.incrementTime(M.delay),q.snapshotCurrentStyles());const oe=_.style;5==oe.type?this.visitKeyframes(oe,E):(E.incrementTime(M.duration),this.visitStyle(oe,E),q.applyStylesToKeyframe()),E.currentAnimateTimings=null,E.previousNode=_}visitStyle(_,E){const M=E.currentTimeline,q=E.currentAnimateTimings;!q&&M.hasCurrentStyleProperties()&&M.forwardFrame();const oe=q&&q.easing||_.easing;_.isEmptyStep?M.applyEmptyStep(oe):M.setStyles(_.styles,oe,E.errors,E.options),E.previousNode=_}visitKeyframes(_,E){const M=E.currentAnimateTimings,q=E.currentTimeline.duration,oe=M.duration,Oe=E.createSubContext().currentTimeline;Oe.easing=M.easing,_.styles.forEach(Pt=>{Oe.forwardTime((Pt.offset||0)*oe),Oe.setStyles(Pt.styles,Pt.easing,E.errors,E.options),Oe.applyStylesToKeyframe()}),E.currentTimeline.mergeTimelineCollectedStyles(Oe),E.transformIntoNewTimeline(q+oe),E.previousNode=_}visitQuery(_,E){const M=E.currentTimeline.currentTime,q=_.options||{},oe=q.delay?Ot(q.delay):0;oe&&(6===E.previousNode.type||0==M&&E.currentTimeline.hasCurrentStyleProperties())&&(E.currentTimeline.snapshotCurrentStyles(),E.previousNode=Ei);let ge=M;const Oe=E.invokeQuery(_.selector,_.originalSelector,_.limit,_.includeSelf,!!q.optional,E.errors);E.currentQueryTotal=Oe.length;let Pt=null;Oe.forEach((Jt,sr)=>{E.currentQueryIndex=sr;const Qn=E.createSubContext(_.options,Jt);oe&&Qn.delayNextStep(oe),Jt===E.element&&(Pt=Qn.currentTimeline),Tt(this,_.animation,Qn),Qn.currentTimeline.applyStylesToKeyframe(),ge=Math.max(ge,Qn.currentTimeline.currentTime)}),E.currentQueryIndex=0,E.currentQueryTotal=0,E.transformIntoNewTimeline(ge),Pt&&(E.currentTimeline.mergeTimelineCollectedStyles(Pt),E.currentTimeline.snapshotCurrentStyles()),E.previousNode=_}visitStagger(_,E){const M=E.parentContext,q=E.currentTimeline,oe=_.timings,ge=Math.abs(oe.duration),Oe=ge*(E.currentQueryTotal-1);let Pt=ge*E.currentQueryIndex;switch(oe.duration<0?"reverse":oe.easing){case"reverse":Pt=Oe-Pt;break;case"full":Pt=M.currentStaggerTime}const sr=E.currentTimeline;Pt&&sr.delayNextStep(Pt);const Qn=sr.currentTime;Tt(this,_.animation,E),E.previousNode=_,M.currentStaggerTime=q.currentTime-Qn+(q.startTime-M.currentTimeline.startTime)}}const Ei={};class oo{constructor(_,E,M,q,oe,ge,Oe,Pt){this._driver=_,this.element=E,this.subInstructions=M,this._enterClassName=q,this._leaveClassName=oe,this.errors=ge,this.timelines=Oe,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ei,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=Pt||new Wi(this._driver,E,0),Oe.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(_,E){if(!_)return;const M=_;let q=this.options;null!=M.duration&&(q.duration=Ot(M.duration)),null!=M.delay&&(q.delay=Ot(M.delay));const oe=M.params;if(oe){let ge=q.params;ge||(ge=this.options.params={}),Object.keys(oe).forEach(Oe=>{(!E||!ge.hasOwnProperty(Oe))&&(ge[Oe]=hr(oe[Oe],ge,this.errors))})}}_copyOptions(){const _={};if(this.options){const E=this.options.params;if(E){const M=_.params={};Object.keys(E).forEach(q=>{M[q]=E[q]})}}return _}createSubContext(_=null,E,M){const q=E||this.element,oe=new oo(this._driver,q,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(q,M||0));return oe.previousNode=this.previousNode,oe.currentAnimateTimings=this.currentAnimateTimings,oe.options=this._copyOptions(),oe.updateOptions(_),oe.currentQueryIndex=this.currentQueryIndex,oe.currentQueryTotal=this.currentQueryTotal,oe.parentContext=this,this.subContextCount++,oe}transformIntoNewTimeline(_){return this.previousNode=Ei,this.currentTimeline=this.currentTimeline.fork(this.element,_),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(_,E,M){const q={duration:E??_.duration,delay:this.currentTimeline.currentTime+(M??0)+_.delay,easing:""},oe=new Ji(this._driver,_.element,_.keyframes,_.preStyleProps,_.postStyleProps,q,_.stretchStartingKeyframe);return this.timelines.push(oe),q}incrementTime(_){this.currentTimeline.forwardTime(this.currentTimeline.duration+_)}delayNextStep(_){_>0&&this.currentTimeline.delayNextStep(_)}invokeQuery(_,E,M,q,oe,ge){let Oe=[];if(q&&Oe.push(this.element),_.length>0){_=(_=_.replace(pn,"."+this._enterClassName)).replace(cr,"."+this._leaveClassName);let Jt=this._driver.query(this.element,_,1!=M);0!==M&&(Jt=M<0?Jt.slice(Jt.length+M,Jt.length):Jt.slice(0,M)),Oe.push(...Jt)}return!oe&&0==Oe.length&&ge.push(function on(D){return new b.vHH(3014,!1)}()),Oe}}class Wi{constructor(_,E,M,q){this._driver=_,this.element=E,this.startTime=M,this._elementTimelineStylesLookup=q,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(E),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(E,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(_){const E=1===this._keyframes.size&&this._pendingStyles.size;this.duration||E?(this.forwardTime(this.currentTime+_),E&&this.snapshotCurrentStyles()):this.startTime+=_}fork(_,E){return this.applyStylesToKeyframe(),new Wi(this._driver,_,E||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(_){this.applyStylesToKeyframe(),this.duration=_,this._loadKeyframe()}_updateStyle(_,E){this._localTimelineStyles.set(_,E),this._globalTimelineStyles.set(_,E),this._styleSummary.set(_,{time:this.currentTime,value:E})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(_){_&&this._previousKeyframe.set("easing",_);for(let[E,M]of this._globalTimelineStyles)this._backFill.set(E,M||xe.l3),this._currentKeyframe.set(E,xe.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(_,E,M,q){E&&this._previousKeyframe.set("easing",E);const oe=q&&q.params||{},ge=function To(D,_){const E=new Map;let M;return D.forEach(q=>{if("*"===q){M=M||_.keys();for(let oe of M)E.set(oe,xe.l3)}else Ne(q,E)}),E}(_,this._globalTimelineStyles);for(let[Oe,Pt]of ge){const Jt=hr(Pt,oe,M);this._pendingStyles.set(Oe,Jt),this._localTimelineStyles.has(Oe)||this._backFill.set(Oe,this._globalTimelineStyles.get(Oe)??xe.l3),this._updateStyle(Oe,Jt)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((_,E)=>{this._currentKeyframe.set(E,_)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((_,E)=>{this._currentKeyframe.has(E)||this._currentKeyframe.set(E,_)}))}snapshotCurrentStyles(){for(let[_,E]of this._localTimelineStyles)this._pendingStyles.set(_,E),this._updateStyle(_,E)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const _=[];for(let E in this._currentKeyframe)_.push(E);return _}mergeTimelineCollectedStyles(_){_._styleSummary.forEach((E,M)=>{const q=this._styleSummary.get(M);(!q||E.time>q.time)&&this._updateStyle(M,E.value)})}buildKeyframes(){this.applyStylesToKeyframe();const _=new Set,E=new Set,M=1===this._keyframes.size&&0===this.duration;let q=[];this._keyframes.forEach((Oe,Pt)=>{const Jt=Ne(Oe,new Map,this._backFill);Jt.forEach((sr,Qn)=>{sr===xe.k1?_.add(Qn):sr===xe.l3&&E.add(Qn)}),M||Jt.set("offset",Pt/this.duration),q.push(Jt)});const oe=_.size?vr(_.values()):[],ge=E.size?vr(E.values()):[];if(M){const Oe=q[0],Pt=new Map(Oe);Oe.set("offset",0),Pt.set("offset",1),q=[Oe,Pt]}return St(this.element,q,oe,ge,this.duration,this.startTime,this.easing,!1)}}class Ji extends Wi{constructor(_,E,M,q,oe,ge,Oe=!1){super(_,E,ge.delay),this.keyframes=M,this.preStyleProps=q,this.postStyleProps=oe,this._stretchStartingKeyframe=Oe,this.timings={duration:ge.duration,delay:ge.delay,easing:ge.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let _=this.keyframes,{delay:E,duration:M,easing:q}=this.timings;if(this._stretchStartingKeyframe&&E){const oe=[],ge=M+E,Oe=E/ge,Pt=Ne(_[0]);Pt.set("offset",0),oe.push(Pt);const Jt=Ne(_[0]);Jt.set("offset",Ri(Oe)),oe.push(Jt);const sr=_.length-1;for(let Qn=1;Qn<=sr;Qn++){let Vr=Ne(_[Qn]);const Hr=Vr.get("offset");Vr.set("offset",Ri((E+Hr*M)/ge)),oe.push(Vr)}M=ge,E=0,q="",_=oe}return St(this.element,_,this.preStyleProps,this.postStyleProps,M,E,q,!0)}}function Ri(D,_=3){const E=Math.pow(10,_-1);return Math.round(D*E)/E}class Zr{}const ps=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Pi extends Zr{normalizePropertyName(_,E){return ni(_)}normalizeStyleValue(_,E,M,q){let oe="";const ge=M.toString().trim();if(ps.has(E)&&0!==M&&"0"!==M)if("number"==typeof M)oe="px";else{const Oe=M.match(/^[+-]?[\d\.]+([a-z]*)$/);Oe&&0==Oe[1].length&&q.push(function nt(D,_){return new b.vHH(3005,!1)}())}return ge+oe}}function So(D,_,E,M,q,oe,ge,Oe,Pt,Jt,sr,Qn,Vr){return{type:0,element:D,triggerName:_,isRemovalTransition:q,fromState:E,fromStyles:oe,toState:M,toStyles:ge,timelines:Oe,queriedElements:Pt,preStyleProps:Jt,postStyleProps:sr,totalTime:Qn,errors:Vr}}const Ks={};class as{constructor(_,E,M){this._triggerName=_,this.ast=E,this._stateStyles=M}match(_,E,M,q){return function Os(D,_,E,M,q){return D.some(oe=>oe(_,E,M,q))}(this.ast.matchers,_,E,M,q)}buildStyles(_,E,M){let q=this._stateStyles.get("*");return void 0!==_&&(q=this._stateStyles.get(_?.toString())||q),q?q.buildStyles(E,M):new Map}build(_,E,M,q,oe,ge,Oe,Pt,Jt,sr){const Qn=[],Vr=this.ast.options&&this.ast.options.params||Ks,Nr=this.buildStyles(M,Oe&&Oe.params||Ks,Qn),zr=Pt&&Pt.params||Ks,ti=this.buildStyles(q,zr,Qn),ai=new Set,zi=new Map,h=new Map,i="void"===q,c={params:Oi(zr,Vr),delay:this.ast.options?.delay},p=sr?[]:Tr(_,E,this.ast.animation,oe,ge,Nr,ti,c,Jt,Qn);let y=0;if(p.forEach(A=>{y=Math.max(A.duration+A.delay,y)}),Qn.length)return So(E,this._triggerName,M,q,i,Nr,ti,[],[],zi,h,y,Qn);p.forEach(A=>{const O=A.element,$=Lr(zi,O,new Set);A.preStyleProps.forEach(G=>$.add(G));const W=Lr(h,O,new Set);A.postStyleProps.forEach(G=>W.add(G)),O!==E&&ai.add(O)});const w=vr(ai.values());return So(E,this._triggerName,M,q,i,Nr,ti,p,w,zi,h,y)}}function Oi(D,_){const E=yn(_);for(const M in D)D.hasOwnProperty(M)&&null!=D[M]&&(E[M]=D[M]);return E}class rr{constructor(_,E,M){this.styles=_,this.defaultParams=E,this.normalizer=M}buildStyles(_,E){const M=new Map,q=yn(this.defaultParams);return Object.keys(_).forEach(oe=>{const ge=_[oe];null!==ge&&(q[oe]=ge)}),this.styles.styles.forEach(oe=>{"string"!=typeof oe&&oe.forEach((ge,Oe)=>{ge&&(ge=hr(ge,q,E));const Pt=this.normalizer.normalizePropertyName(Oe,E);ge=this.normalizer.normalizeStyleValue(Oe,Pt,ge,E),M.set(Oe,ge)})}),M}}class Si{constructor(_,E,M){this.name=_,this.ast=E,this._normalizer=M,this.transitionFactories=[],this.states=new Map,E.states.forEach(q=>{this.states.set(q.name,new rr(q.style,q.options&&q.options.params||{},M))}),zo(this.states,"true","1"),zo(this.states,"false","0"),E.transitions.forEach(q=>{this.transitionFactories.push(new as(_,q,this.states))}),this.fallbackTransition=function Io(D,_,E){return new as(D,{type:1,animation:{type:2,steps:[],options:null},matchers:[(ge,Oe)=>!0],options:null,queryCount:0,depCount:0},_)}(_,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(_,E,M,q){return this.transitionFactories.find(ge=>ge.match(_,E,M,q))||null}matchStyles(_,E,M){return this.fallbackTransition.buildStyles(_,E,M)}}function zo(D,_,E){D.has(_)?D.has(E)||D.set(E,D.get(_)):D.has(E)&&D.set(_,D.get(E))}const Ii=new zt;class Ms{constructor(_,E,M){this.bodyNode=_,this._driver=E,this._normalizer=M,this._animations=new Map,this._playersById=new Map,this.players=[]}register(_,E){const M=[],oe=Vi(this._driver,E,M,[]);if(M.length)throw function me(D){return new b.vHH(3503,!1)}();this._animations.set(_,oe)}_buildPlayer(_,E,M){const q=_.element,oe=mr(this._normalizer,_.keyframes,E,M);return this._driver.animate(q,oe,_.duration,_.delay,_.easing,[],!0)}create(_,E,M={}){const q=[],oe=this._animations.get(_);let ge;const Oe=new Map;if(oe?(ge=Tr(this._driver,E,oe,Qe,he,new Map,new Map,M,Ii,q),ge.forEach(sr=>{const Qn=Lr(Oe,sr.element,new Map);sr.postStyleProps.forEach(Vr=>Qn.set(Vr,null))})):(q.push(function ze(){return new b.vHH(3300,!1)}()),ge=[]),q.length)throw function ct(D){return new b.vHH(3504,!1)}();Oe.forEach((sr,Qn)=>{sr.forEach((Vr,Hr)=>{sr.set(Hr,this._driver.computeStyle(Qn,Hr,xe.l3))})});const Jt=Bn(ge.map(sr=>{const Qn=Oe.get(sr.element);return this._buildPlayer(sr,new Map,Qn)}));return this._playersById.set(_,Jt),Jt.onDestroy(()=>this.destroy(_)),this.players.push(Jt),Jt}destroy(_){const E=this._getPlayer(_);E.destroy(),this._playersById.delete(_);const M=this.players.indexOf(E);M>=0&&this.players.splice(M,1)}_getPlayer(_){const E=this._playersById.get(_);if(!E)throw function Lt(D){return new b.vHH(3301,!1)}();return E}listen(_,E,M,q){const oe=Kn(E,"","","");return nr(this._getPlayer(_),M,oe,q),()=>{}}command(_,E,M,q){if("register"==M)return void this.register(_,q[0]);if("create"==M)return void this.create(_,E,q[0]||{});const oe=this._getPlayer(_);switch(M){case"play":oe.play();break;case"pause":oe.pause();break;case"reset":oe.reset();break;case"restart":oe.restart();break;case"finish":oe.finish();break;case"init":oe.init();break;case"setPosition":oe.setPosition(parseFloat(q[0]));break;case"destroy":this.destroy(_)}}}const eo="ng-animate-queued",Vo="ng-animate-disabled",_o=[],Ui={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},es={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ro="__ng_removed";class Uo{get params(){return this.options.params}constructor(_,E=""){this.namespaceId=E;const M=_&&_.hasOwnProperty("value");if(this.value=function er(D){return D??null}(M?_.value:_),M){const oe=yn(_);delete oe.value,this.options=oe}else this.options={};this.options.params||(this.options.params={})}absorbOptions(_){const E=_.params;if(E){const M=this.options.params;Object.keys(E).forEach(q=>{null==M[q]&&(M[q]=E[q])})}}}const jo="void",oa=new Uo(jo);class ms{constructor(_,E,M){this.id=_,this.hostElement=E,this._engine=M,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+_,uo(E,this._hostClassName)}listen(_,E,M,q){if(!this._triggers.has(E))throw function Gt(D,_){return new b.vHH(3302,!1)}();if(null==M||0==M.length)throw function Yt(D){return new b.vHH(3303,!1)}();if(!function As(D){return"start"==D||"done"==D}(M))throw function hn(D,_){return new b.vHH(3400,!1)}();const oe=Lr(this._elementListeners,_,[]),ge={name:E,phase:M,callback:q};oe.push(ge);const Oe=Lr(this._engine.statesByElement,_,new Map);return Oe.has(E)||(uo(_,_e),uo(_,_e+"-"+E),Oe.set(E,oa)),()=>{this._engine.afterFlush(()=>{const Pt=oe.indexOf(ge);Pt>=0&&oe.splice(Pt,1),this._triggers.has(E)||Oe.delete(E)})}}register(_,E){return!this._triggers.has(_)&&(this._triggers.set(_,E),!0)}_getTrigger(_){const E=this._triggers.get(_);if(!E)throw function sn(D){return new b.vHH(3401,!1)}();return E}trigger(_,E,M,q=!0){const oe=this._getTrigger(E),ge=new ts(this.id,E,_);let Oe=this._engine.statesByElement.get(_);Oe||(uo(_,_e),uo(_,_e+"-"+E),this._engine.statesByElement.set(_,Oe=new Map));let Pt=Oe.get(E);const Jt=new Uo(M,this.id);if(!(M&&M.hasOwnProperty("value"))&&Pt&&Jt.absorbOptions(Pt.options),Oe.set(E,Jt),Pt||(Pt=oa),Jt.value!==jo&&Pt.value===Jt.value){if(!function Zi(D,_){const E=Object.keys(D),M=Object.keys(_);if(E.length!=M.length)return!1;for(let q=0;q<E.length;q++){const oe=E[q];if(!_.hasOwnProperty(oe)||D[oe]!==_[oe])return!1}return!0}(Pt.params,Jt.params)){const zr=[],ti=oe.matchStyles(Pt.value,Pt.params,zr),ai=oe.matchStyles(Jt.value,Jt.params,zr);zr.length?this._engine.reportError(zr):this._engine.afterFlush(()=>{ot(_,ti),pe(_,ai)})}return}const Vr=Lr(this._engine.playersByElement,_,[]);Vr.forEach(zr=>{zr.namespaceId==this.id&&zr.triggerName==E&&zr.queued&&zr.destroy()});let Hr=oe.matchTransition(Pt.value,Jt.value,_,Jt.params),Nr=!1;if(!Hr){if(!q)return;Hr=oe.fallbackTransition,Nr=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:_,triggerName:E,transition:Hr,fromState:Pt,toState:Jt,player:ge,isFallbackTransition:Nr}),Nr||(uo(_,eo),ge.onStart(()=>{Mo(_,eo)})),ge.onDone(()=>{let zr=this.players.indexOf(ge);zr>=0&&this.players.splice(zr,1);const ti=this._engine.playersByElement.get(_);if(ti){let ai=ti.indexOf(ge);ai>=0&&ti.splice(ai,1)}}),this.players.push(ge),Vr.push(ge),ge}deregister(_){this._triggers.delete(_),this._engine.statesByElement.forEach(E=>E.delete(_)),this._elementListeners.forEach((E,M)=>{this._elementListeners.set(M,E.filter(q=>q.name!=_))})}clearElementCache(_){this._engine.statesByElement.delete(_),this._elementListeners.delete(_);const E=this._engine.playersByElement.get(_);E&&(E.forEach(M=>M.destroy()),this._engine.playersByElement.delete(_))}_signalRemovalForInnerTriggers(_,E){const M=this._engine.driver.query(_,qe,!0);M.forEach(q=>{if(q[Ro])return;const oe=this._engine.fetchNamespacesByElement(q);oe.size?oe.forEach(ge=>ge.triggerLeaveAnimation(q,E,!1,!0)):this.clearElementCache(q)}),this._engine.afterFlushAnimationsDone(()=>M.forEach(q=>this.clearElementCache(q)))}triggerLeaveAnimation(_,E,M,q){const oe=this._engine.statesByElement.get(_),ge=new Map;if(oe){const Oe=[];if(oe.forEach((Pt,Jt)=>{if(ge.set(Jt,Pt.value),this._triggers.has(Jt)){const sr=this.trigger(_,Jt,jo,q);sr&&Oe.push(sr)}}),Oe.length)return this._engine.markElementAsRemoved(this.id,_,!0,E,ge),M&&Bn(Oe).onDone(()=>this._engine.processLeaveNode(_)),!0}return!1}prepareLeaveAnimationListeners(_){const E=this._elementListeners.get(_),M=this._engine.statesByElement.get(_);if(E&&M){const q=new Set;E.forEach(oe=>{const ge=oe.name;if(q.has(ge))return;q.add(ge);const Pt=this._triggers.get(ge).fallbackTransition,Jt=M.get(ge)||oa,sr=new Uo(jo),Qn=new ts(this.id,ge,_);this._engine.totalQueuedPlayers++,this._queue.push({element:_,triggerName:ge,transition:Pt,fromState:Jt,toState:sr,player:Qn,isFallbackTransition:!0})})}}removeNode(_,E){const M=this._engine;if(_.childElementCount&&this._signalRemovalForInnerTriggers(_,E),this.triggerLeaveAnimation(_,E,!0))return;let q=!1;if(M.totalAnimations){const oe=M.players.length?M.playersByQueriedElement.get(_):[];if(oe&&oe.length)q=!0;else{let ge=_;for(;ge=ge.parentNode;)if(M.statesByElement.get(ge)){q=!0;break}}}if(this.prepareLeaveAnimationListeners(_),q)M.markElementAsRemoved(this.id,_,!1,E);else{const oe=_[Ro];(!oe||oe===Ui)&&(M.afterFlush(()=>this.clearElementCache(_)),M.destroyInnerAnimations(_),M._onRemovalComplete(_,E))}}insertNode(_,E){uo(_,this._hostClassName)}drainQueuedTransitions(_){const E=[];return this._queue.forEach(M=>{const q=M.player;if(q.destroyed)return;const oe=M.element,ge=this._elementListeners.get(oe);ge&&ge.forEach(Oe=>{if(Oe.name==M.triggerName){const Pt=Kn(oe,M.triggerName,M.fromState.value,M.toState.value);Pt._data=_,nr(M.player,Oe.phase,Pt,Oe.callback)}}),q.markedForDestroy?this._engine.afterFlush(()=>{q.destroy()}):E.push(M)}),this._queue=[],E.sort((M,q)=>{const oe=M.transition.ast.depCount,ge=q.transition.ast.depCount;return 0==oe||0==ge?oe-ge:this._engine.driver.containsElement(M.element,q.element)?1:-1})}destroy(_){this.players.forEach(E=>E.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,_)}}class cs{_onRemovalComplete(_,E){this.onRemovalComplete(_,E)}constructor(_,E,M){this.bodyNode=_,this.driver=E,this._normalizer=M,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(q,oe)=>{}}get queuedPlayers(){const _=[];return this._namespaceList.forEach(E=>{E.players.forEach(M=>{M.queued&&_.push(M)})}),_}createNamespace(_,E){const M=new ms(_,E,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,E)?this._balanceNamespaceList(M,E):(this.newHostElements.set(E,M),this.collectEnterElement(E)),this._namespaceLookup[_]=M}_balanceNamespaceList(_,E){const M=this._namespaceList,q=this.namespacesByHostElement;if(M.length-1>=0){let ge=!1,Oe=this.driver.getParentElement(E);for(;Oe;){const Pt=q.get(Oe);if(Pt){const Jt=M.indexOf(Pt);M.splice(Jt+1,0,_),ge=!0;break}Oe=this.driver.getParentElement(Oe)}ge||M.unshift(_)}else M.push(_);return q.set(E,_),_}register(_,E){let M=this._namespaceLookup[_];return M||(M=this.createNamespace(_,E)),M}registerTrigger(_,E,M){let q=this._namespaceLookup[_];q&&q.register(E,M)&&this.totalAnimations++}destroy(_,E){_&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const M=this._fetchNamespace(_);this.namespacesByHostElement.delete(M.hostElement);const q=this._namespaceList.indexOf(M);q>=0&&this._namespaceList.splice(q,1),M.destroy(E),delete this._namespaceLookup[_]}))}_fetchNamespace(_){return this._namespaceLookup[_]}fetchNamespacesByElement(_){const E=new Set,M=this.statesByElement.get(_);if(M)for(let q of M.values())if(q.namespaceId){const oe=this._fetchNamespace(q.namespaceId);oe&&E.add(oe)}return E}trigger(_,E,M,q){if(ka(E)){const oe=this._fetchNamespace(_);if(oe)return oe.trigger(E,M,q),!0}return!1}insertNode(_,E,M,q){if(!ka(E))return;const oe=E[Ro];if(oe&&oe.setForRemoval){oe.setForRemoval=!1,oe.setForMove=!0;const ge=this.collectedLeaveElements.indexOf(E);ge>=0&&this.collectedLeaveElements.splice(ge,1)}if(_){const ge=this._fetchNamespace(_);ge&&ge.insertNode(E,M)}q&&this.collectEnterElement(E)}collectEnterElement(_){this.collectedEnterElements.push(_)}markElementAsDisabled(_,E){E?this.disabledNodes.has(_)||(this.disabledNodes.add(_),uo(_,Vo)):this.disabledNodes.has(_)&&(this.disabledNodes.delete(_),Mo(_,Vo))}removeNode(_,E,M){if(ka(E)){const q=_?this._fetchNamespace(_):null;q?q.removeNode(E,M):this.markElementAsRemoved(_,E,!1,M);const oe=this.namespacesByHostElement.get(E);oe&&oe.id!==_&&oe.removeNode(E,M)}else this._onRemovalComplete(E,M)}markElementAsRemoved(_,E,M,q,oe){this.collectedLeaveElements.push(E),E[Ro]={namespaceId:_,setForRemoval:q,hasAnimation:M,removedBeforeQueried:!1,previousTriggersValues:oe}}listen(_,E,M,q,oe){return ka(E)?this._fetchNamespace(_).listen(E,M,q,oe):()=>{}}_buildInstruction(_,E,M,q,oe){return _.transition.build(this.driver,_.element,_.fromState.value,_.toState.value,M,q,_.fromState.options,_.toState.options,E,oe)}destroyInnerAnimations(_){let E=this.driver.query(_,qe,!0);E.forEach(M=>this.destroyActiveAnimationsForElement(M)),0!=this.playersByQueriedElement.size&&(E=this.driver.query(_,wt,!0),E.forEach(M=>this.finishActiveQueriedAnimationOnElement(M)))}destroyActiveAnimationsForElement(_){const E=this.playersByElement.get(_);E&&E.forEach(M=>{M.queued?M.markedForDestroy=!0:M.destroy()})}finishActiveQueriedAnimationOnElement(_){const E=this.playersByQueriedElement.get(_);E&&E.forEach(M=>M.finish())}whenRenderingDone(){return new Promise(_=>{if(this.players.length)return Bn(this.players).onDone(()=>_());_()})}processLeaveNode(_){const E=_[Ro];if(E&&E.setForRemoval){if(_[Ro]=Ui,E.namespaceId){this.destroyInnerAnimations(_);const M=this._fetchNamespace(E.namespaceId);M&&M.clearElementCache(_)}this._onRemovalComplete(_,E.setForRemoval)}_.classList?.contains(Vo)&&this.markElementAsDisabled(_,!1),this.driver.query(_,".ng-animate-disabled",!0).forEach(M=>{this.markElementAsDisabled(M,!1)})}flush(_=-1){let E=[];if(this.newHostElements.size&&(this.newHostElements.forEach((M,q)=>this._balanceNamespaceList(M,q)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let M=0;M<this.collectedEnterElements.length;M++)uo(this.collectedEnterElements[M],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const M=[];try{E=this._flushAnimations(M,_)}finally{for(let q=0;q<M.length;q++)M[q]()}}else for(let M=0;M<this.collectedLeaveElements.length;M++)this.processLeaveNode(this.collectedLeaveElements[M]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(M=>M()),this._flushFns=[],this._whenQuietFns.length){const M=this._whenQuietFns;this._whenQuietFns=[],E.length?Bn(E).onDone(()=>{M.forEach(q=>q())}):M.forEach(q=>q())}}reportError(_){throw function jt(D){return new b.vHH(3402,!1)}()}_flushAnimations(_,E){const M=new zt,q=[],oe=new Map,ge=[],Oe=new Map,Pt=new Map,Jt=new Map,sr=new Set;this.disabledNodes.forEach(ye=>{sr.add(ye);const Ee=this.driver.query(ye,".ng-animate-queued",!0);for(let be=0;be<Ee.length;be++)sr.add(Ee[be])});const Qn=this.bodyNode,Vr=Array.from(this.statesByElement.keys()),Hr=js(Vr,this.collectedEnterElements),Nr=new Map;let zr=0;Hr.forEach((ye,Ee)=>{const be=Qe+zr++;Nr.set(Ee,be),ye.forEach(Pe=>uo(Pe,be))});const ti=[],ai=new Set,zi=new Set;for(let ye=0;ye<this.collectedLeaveElements.length;ye++){const Ee=this.collectedLeaveElements[ye],be=Ee[Ro];be&&be.setForRemoval&&(ti.push(Ee),ai.add(Ee),be.hasAnimation?this.driver.query(Ee,".ng-star-inserted",!0).forEach(Pe=>ai.add(Pe)):zi.add(Ee))}const h=new Map,i=js(Vr,Array.from(ai));i.forEach((ye,Ee)=>{const be=he+zr++;h.set(Ee,be),ye.forEach(Pe=>uo(Pe,be))}),_.push(()=>{Hr.forEach((ye,Ee)=>{const be=Nr.get(Ee);ye.forEach(Pe=>Mo(Pe,be))}),i.forEach((ye,Ee)=>{const be=h.get(Ee);ye.forEach(Pe=>Mo(Pe,be))}),ti.forEach(ye=>{this.processLeaveNode(ye)})});const c=[],p=[];for(let ye=this._namespaceList.length-1;ye>=0;ye--)this._namespaceList[ye].drainQueuedTransitions(E).forEach(be=>{const Pe=be.player,se=be.element;if(c.push(Pe),this.collectedEnterElements.length){const Rt=se[Ro];if(Rt&&Rt.setForMove){if(Rt.previousTriggersValues&&Rt.previousTriggersValues.has(be.triggerName)){const Mt=Rt.previousTriggersValues.get(be.triggerName),Wt=this.statesByElement.get(be.element);if(Wt&&Wt.has(be.triggerName)){const On=Wt.get(be.triggerName);On.value=Mt,Wt.set(be.triggerName,On)}}return void Pe.destroy()}}const Ie=!Qn||!this.driver.containsElement(Qn,se),We=h.get(se),Xe=Nr.get(se),ft=this._buildInstruction(be,M,Xe,We,Ie);if(ft.errors&&ft.errors.length)return void p.push(ft);if(Ie)return Pe.onStart(()=>ot(se,ft.fromStyles)),Pe.onDestroy(()=>pe(se,ft.toStyles)),void q.push(Pe);if(be.isFallbackTransition)return Pe.onStart(()=>ot(se,ft.fromStyles)),Pe.onDestroy(()=>pe(se,ft.toStyles)),void q.push(Pe);const Ct=[];ft.timelines.forEach(Rt=>{Rt.stretchStartingKeyframe=!0,this.disabledNodes.has(Rt.element)||Ct.push(Rt)}),ft.timelines=Ct,M.append(se,ft.timelines),ge.push({instruction:ft,player:Pe,element:se}),ft.queriedElements.forEach(Rt=>Lr(Oe,Rt,[]).push(Pe)),ft.preStyleProps.forEach((Rt,Mt)=>{if(Rt.size){let Wt=Pt.get(Mt);Wt||Pt.set(Mt,Wt=new Set),Rt.forEach((On,qt)=>Wt.add(qt))}}),ft.postStyleProps.forEach((Rt,Mt)=>{let Wt=Jt.get(Mt);Wt||Jt.set(Mt,Wt=new Set),Rt.forEach((On,qt)=>Wt.add(qt))})});if(p.length){const ye=[];p.forEach(Ee=>{ye.push(function an(D,_){return new b.vHH(3505,!1)}())}),c.forEach(Ee=>Ee.destroy()),this.reportError(ye)}const y=new Map,w=new Map;ge.forEach(ye=>{const Ee=ye.element;M.has(Ee)&&(w.set(Ee,Ee),this._beforeAnimationBuild(ye.player.namespaceId,ye.instruction,y))}),q.forEach(ye=>{const Ee=ye.element;this._getPreviousPlayers(Ee,!1,ye.namespaceId,ye.triggerName,null).forEach(Pe=>{Lr(y,Ee,[]).push(Pe),Pe.destroy()})});const A=ti.filter(ye=>Hs(ye,Pt,Jt)),O=new Map;Ho(O,this.driver,zi,Jt,xe.l3).forEach(ye=>{Hs(ye,Pt,Jt)&&A.push(ye)});const W=new Map;Hr.forEach((ye,Ee)=>{Ho(W,this.driver,new Set(ye),Pt,xe.k1)}),A.forEach(ye=>{const Ee=O.get(ye),be=W.get(ye);O.set(ye,new Map([...Ee?.entries()??[],...be?.entries()??[]]))});const G=[],ae=[],De={};ge.forEach(ye=>{const{element:Ee,player:be,instruction:Pe}=ye;if(M.has(Ee)){if(sr.has(Ee))return be.onDestroy(()=>pe(Ee,Pe.toStyles)),be.disabled=!0,be.overrideTotalTime(Pe.totalTime),void q.push(be);let se=De;if(w.size>1){let We=Ee;const Xe=[];for(;We=We.parentNode;){const ft=w.get(We);if(ft){se=ft;break}Xe.push(We)}Xe.forEach(ft=>w.set(ft,se))}const Ie=this._buildAnimation(be.namespaceId,Pe,y,oe,W,O);if(be.setRealPlayer(Ie),se===De)G.push(be);else{const We=this.playersByElement.get(se);We&&We.length&&(be.parentPlayer=Bn(We)),q.push(be)}}else ot(Ee,Pe.fromStyles),be.onDestroy(()=>pe(Ee,Pe.toStyles)),ae.push(be),sr.has(Ee)&&q.push(be)}),ae.forEach(ye=>{const Ee=oe.get(ye.element);if(Ee&&Ee.length){const be=Bn(Ee);ye.setRealPlayer(be)}}),q.forEach(ye=>{ye.parentPlayer?ye.syncPlayerEvents(ye.parentPlayer):ye.destroy()});for(let ye=0;ye<ti.length;ye++){const Ee=ti[ye],be=Ee[Ro];if(Mo(Ee,he),be&&be.hasAnimation)continue;let Pe=[];if(Oe.size){let Ie=Oe.get(Ee);Ie&&Ie.length&&Pe.push(...Ie);let We=this.driver.query(Ee,wt,!0);for(let Xe=0;Xe<We.length;Xe++){let ft=Oe.get(We[Xe]);ft&&ft.length&&Pe.push(...ft)}}const se=Pe.filter(Ie=>!Ie.destroyed);se.length?so(this,Ee,se):this.processLeaveNode(Ee)}return ti.length=0,G.forEach(ye=>{this.players.push(ye),ye.onDone(()=>{ye.destroy();const Ee=this.players.indexOf(ye);this.players.splice(Ee,1)}),ye.play()}),G}afterFlush(_){this._flushFns.push(_)}afterFlushAnimationsDone(_){this._whenQuietFns.push(_)}_getPreviousPlayers(_,E,M,q,oe){let ge=[];if(E){const Oe=this.playersByQueriedElement.get(_);Oe&&(ge=Oe)}else{const Oe=this.playersByElement.get(_);if(Oe){const Pt=!oe||oe==jo;Oe.forEach(Jt=>{Jt.queued||!Pt&&Jt.triggerName!=q||ge.push(Jt)})}}return(M||q)&&(ge=ge.filter(Oe=>!(M&&M!=Oe.namespaceId||q&&q!=Oe.triggerName))),ge}_beforeAnimationBuild(_,E,M){const oe=E.element,ge=E.isRemovalTransition?void 0:_,Oe=E.isRemovalTransition?void 0:E.triggerName;for(const Pt of E.timelines){const Jt=Pt.element,sr=Jt!==oe,Qn=Lr(M,Jt,[]);this._getPreviousPlayers(Jt,sr,ge,Oe,E.toState).forEach(Hr=>{const Nr=Hr.getRealPlayer();Nr.beforeDestroy&&Nr.beforeDestroy(),Hr.destroy(),Qn.push(Hr)})}ot(oe,E.fromStyles)}_buildAnimation(_,E,M,q,oe,ge){const Oe=E.triggerName,Pt=E.element,Jt=[],sr=new Set,Qn=new Set,Vr=E.timelines.map(Nr=>{const zr=Nr.element;sr.add(zr);const ti=zr[Ro];if(ti&&ti.removedBeforeQueried)return new xe.ZN(Nr.duration,Nr.delay);const ai=zr!==Pt,zi=function xa(D){const _=[];return Bi(D,_),_}((M.get(zr)||_o).map(y=>y.getRealPlayer())).filter(y=>!!y.element&&y.element===zr),h=oe.get(zr),i=ge.get(zr),c=mr(this._normalizer,Nr.keyframes,h,i),p=this._buildPlayer(Nr,c,zi);if(Nr.subTimeline&&q&&Qn.add(zr),ai){const y=new ts(_,Oe,zr);y.setRealPlayer(p),Jt.push(y)}return p});Jt.forEach(Nr=>{Lr(this.playersByQueriedElement,Nr.element,[]).push(Nr),Nr.onDone(()=>function ns(D,_,E){let M=D.get(_);if(M){if(M.length){const q=M.indexOf(E);M.splice(q,1)}0==M.length&&D.delete(_)}return M}(this.playersByQueriedElement,Nr.element,Nr))}),sr.forEach(Nr=>uo(Nr,ut));const Hr=Bn(Vr);return Hr.onDestroy(()=>{sr.forEach(Nr=>Mo(Nr,ut)),pe(Pt,E.toStyles)}),Qn.forEach(Nr=>{Lr(q,Nr,[]).push(Hr)}),Hr}_buildPlayer(_,E,M){return E.length>0?this.driver.animate(_.element,E,_.duration,_.delay,_.easing,M):new xe.ZN(_.duration,_.delay)}}class ts{constructor(_,E,M){this.namespaceId=_,this.triggerName=E,this.element=M,this._player=new xe.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(_){this._containsRealPlayer||(this._player=_,this._queuedCallbacks.forEach((E,M)=>{E.forEach(q=>nr(_,M,void 0,q))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(_.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(_){this.totalTime=_}syncPlayerEvents(_){const E=this._player;E.triggerCallback&&_.onStart(()=>E.triggerCallback("start")),_.onDone(()=>this.finish()),_.onDestroy(()=>this.destroy())}_queueEvent(_,E){Lr(this._queuedCallbacks,_,[]).push(E)}onDone(_){this.queued&&this._queueEvent("done",_),this._player.onDone(_)}onStart(_){this.queued&&this._queueEvent("start",_),this._player.onStart(_)}onDestroy(_){this.queued&&this._queueEvent("destroy",_),this._player.onDestroy(_)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(_){this.queued||this._player.setPosition(_)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(_){const E=this._player;E.triggerCallback&&E.triggerCallback(_)}}function ka(D){return D&&1===D.nodeType}function va(D,_){const E=D.style.display;return D.style.display=_??"none",E}function Ho(D,_,E,M,q){const oe=[];E.forEach(Pt=>oe.push(va(Pt)));const ge=[];M.forEach((Pt,Jt)=>{const sr=new Map;Pt.forEach(Qn=>{const Vr=_.computeStyle(Jt,Qn,q);sr.set(Qn,Vr),(!Vr||0==Vr.length)&&(Jt[Ro]=es,ge.push(Jt))}),D.set(Jt,sr)});let Oe=0;return E.forEach(Pt=>va(Pt,oe[Oe++])),ge}function js(D,_){const E=new Map;if(D.forEach(Oe=>E.set(Oe,[])),0==_.length)return E;const q=new Set(_),oe=new Map;function ge(Oe){if(!Oe)return 1;let Pt=oe.get(Oe);if(Pt)return Pt;const Jt=Oe.parentNode;return Pt=E.has(Jt)?Jt:q.has(Jt)?1:ge(Jt),oe.set(Oe,Pt),Pt}return _.forEach(Oe=>{const Pt=ge(Oe);1!==Pt&&E.get(Pt).push(Oe)}),E}function uo(D,_){D.classList?.add(_)}function Mo(D,_){D.classList?.remove(_)}function so(D,_,E){Bn(E).onDone(()=>D.processLeaveNode(_))}function Bi(D,_){for(let E=0;E<D.length;E++){const M=D[E];M instanceof xe.ZE?Bi(M.players,_):_.push(M)}}function Hs(D,_,E){const M=E.get(D);if(!M)return!1;let q=_.get(D);return q?M.forEach(oe=>q.add(oe)):_.set(D,M),E.delete(D),!0}class gs{constructor(_,E,M){this.bodyNode=_,this._driver=E,this._normalizer=M,this._triggerCache={},this.onRemovalComplete=(q,oe)=>{},this._transitionEngine=new cs(_,E,M),this._timelineEngine=new Ms(_,E,M),this._transitionEngine.onRemovalComplete=(q,oe)=>this.onRemovalComplete(q,oe)}registerTrigger(_,E,M,q,oe){const ge=_+"-"+q;let Oe=this._triggerCache[ge];if(!Oe){const Pt=[],sr=Vi(this._driver,oe,Pt,[]);if(Pt.length)throw function $e(D,_){return new b.vHH(3404,!1)}();Oe=function xr(D,_,E){return new Si(D,_,E)}(q,sr,this._normalizer),this._triggerCache[ge]=Oe}this._transitionEngine.registerTrigger(E,q,Oe)}register(_,E){this._transitionEngine.register(_,E)}destroy(_,E){this._transitionEngine.destroy(_,E)}onInsert(_,E,M,q){this._transitionEngine.insertNode(_,E,M,q)}onRemove(_,E,M){this._transitionEngine.removeNode(_,E,M)}disableAnimations(_,E){this._transitionEngine.markElementAsDisabled(_,E)}process(_,E,M,q){if("@"==M.charAt(0)){const[oe,ge]=bn(M);this._timelineEngine.command(oe,E,ge,q)}else this._transitionEngine.trigger(_,E,M,q)}listen(_,E,M,q,oe){if("@"==M.charAt(0)){const[ge,Oe]=bn(M);return this._timelineEngine.listen(ge,E,Oe,oe)}return this._transitionEngine.listen(_,E,M,q,oe)}flush(_=-1){this._transitionEngine.flush(_)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(_){this._transitionEngine.afterFlushAnimationsDone(_)}}let Xo=(()=>{class _{constructor(M,q,oe){this._element=M,this._startStyles=q,this._endStyles=oe,this._state=0;let ge=_.initialStylesByElement.get(M);ge||_.initialStylesByElement.set(M,ge=new Map),this._initialStyles=ge}start(){this._state<1&&(this._startStyles&&pe(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(pe(this._element,this._initialStyles),this._endStyles&&(pe(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(_.initialStylesByElement.delete(this._element),this._startStyles&&(ot(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ot(this._element,this._endStyles),this._endStyles=null),pe(this._element,this._initialStyles),this._state=3)}}return _.initialStylesByElement=new WeakMap,_})();function sa(D){let _=null;return D.forEach((E,M)=>{(function ba(D){return"display"===D||"position"===D})(M)&&(_=_||new Map,_.set(M,E))}),_}class Js{constructor(_,E,M,q){this.element=_,this.keyframes=E,this.options=M,this._specialStyles=q,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=M.duration,this._delay=M.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(_=>_()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const _=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,_,this.options),this._finalKeyframe=_.length?_[_.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(_){const E=[];return _.forEach(M=>{E.push(Object.fromEntries(M))}),E}_triggerWebAnimation(_,E,M){return _.animate(this._convertKeyframesToObject(E),M)}onStart(_){this._originalOnStartFns.push(_),this._onStartFns.push(_)}onDone(_){this._originalOnDoneFns.push(_),this._onDoneFns.push(_)}onDestroy(_){this._onDestroyFns.push(_)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(_=>_()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(_=>_()),this._onDestroyFns=[])}setPosition(_){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=_*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const _=new Map;this.hasStarted()&&this._finalKeyframe.forEach((M,q)=>{"offset"!==q&&_.set(q,this._finished?M:Dn(this.element,q))}),this.currentSnapshot=_}triggerCallback(_){const E="start"===_?this._onStartFns:this._onDoneFns;E.forEach(M=>M()),E.length=0}}class P{validateStyleProperty(_){return!0}validateAnimatableStyleProperty(_){return!0}matchesElement(_,E){return!1}containsElement(_,E){return qi(_,E)}getParentElement(_){return Fi(_)}query(_,E,M){return Sr(_,E,M)}computeStyle(_,E,M){return window.getComputedStyle(_)[E]}animate(_,E,M,q,oe,ge=[]){const Pt={duration:M,delay:q,fill:0==q?"both":"forwards"};oe&&(Pt.easing=oe);const Jt=new Map,sr=ge.filter(Hr=>Hr instanceof Js);(function Bo(D,_){return 0===D||0===_})(M,q)&&sr.forEach(Hr=>{Hr.currentSnapshot.forEach((Nr,zr)=>Jt.set(zr,Nr))});let Qn=function le(D){return D.length?D[0]instanceof Map?D:D.map(_=>Be(_)):[]}(E).map(Hr=>Ne(Hr));Qn=function rn(D,_,E){if(E.size&&_.length){let M=_[0],q=[];if(E.forEach((oe,ge)=>{M.has(ge)||q.push(ge),M.set(ge,oe)}),q.length)for(let oe=1;oe<_.length;oe++){let ge=_[oe];q.forEach(Oe=>ge.set(Oe,Dn(D,Oe)))}}return _}(_,Qn,Jt);const Vr=function us(D,_){let E=null,M=null;return Array.isArray(_)&&_.length?(E=sa(_[0]),_.length>1&&(M=sa(_[_.length-1]))):_ instanceof Map&&(E=sa(_)),E||M?new Xo(D,E,M):null}(_,Qn);return new Js(_,Qn,Pt,Vr)}}var J=K(6814);let R=(()=>{var D;class _ extends xe._j{constructor(M,q){super(),this._nextAnimationId=0,this._renderer=M.createRenderer(q.body,{id:"0",encapsulation:b.ifc.None,styles:[],data:{animation:[]}})}build(M){const q=this._nextAnimationId.toString();this._nextAnimationId++;const oe=Array.isArray(M)?(0,xe.vP)(M):M;return Cn(this._renderer,null,q,"register",[oe]),new ne(q,this._renderer)}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(b.FYo),b.LFG(J.K0))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})();class ne extends xe.LC{constructor(_,E){super(),this._id=_,this._renderer=E}create(_,E){return new ke(this._id,_,E||{},this._renderer)}}class ke{constructor(_,E,M,q){this.id=_,this.element=E,this._renderer=q,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",M)}_listen(_,E){return this._renderer.listen(this.element,`@@${this.id}:${_}`,E)}_command(_,...E){return Cn(this._renderer,this.element,this.id,_,E)}onDone(_){this._listen("done",_)}onStart(_){this._listen("start",_)}onDestroy(_){this._listen("destroy",_)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(_){this._command("setPosition",_)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function Cn(D,_,E,M,q){return D.setProperty(_,`@@${E}:${M}`,q)}const ir="@.disabled";let ki=(()=>{var D;class _{constructor(M,q,oe){this.delegate=M,this.engine=q,this._zone=oe,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,q.onRemovalComplete=(ge,Oe)=>{const Pt=Oe?.parentNode(ge);Pt&&Oe.removeChild(Pt,ge)}}createRenderer(M,q){const ge=this.delegate.createRenderer(M,q);if(!(M&&q&&q.data&&q.data.animation)){let Qn=this._rendererCache.get(ge);return Qn||(Qn=new ao("",ge,this.engine,()=>this._rendererCache.delete(ge)),this._rendererCache.set(ge,Qn)),Qn}const Oe=q.id,Pt=q.id+"-"+this._currentId;this._currentId++,this.engine.register(Pt,M);const Jt=Qn=>{Array.isArray(Qn)?Qn.forEach(Jt):this.engine.registerTrigger(Oe,Pt,M,Qn.name,Qn)};return q.data.animation.forEach(Jt),new te(this,Pt,ge,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(M,q,oe){M>=0&&M<this._microtaskId?this._zone.run(()=>q(oe)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(ge=>{const[Oe,Pt]=ge;Oe(Pt)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([q,oe]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(b.FYo),b.LFG(gs),b.LFG(b.R0b))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})();class ao{constructor(_,E,M,q){this.namespaceId=_,this.delegate=E,this.engine=M,this._onDestroy=q}get data(){return this.delegate.data}destroyNode(_){this.delegate.destroyNode?.(_)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(_,E){return this.delegate.createElement(_,E)}createComment(_){return this.delegate.createComment(_)}createText(_){return this.delegate.createText(_)}appendChild(_,E){this.delegate.appendChild(_,E),this.engine.onInsert(this.namespaceId,E,_,!1)}insertBefore(_,E,M,q=!0){this.delegate.insertBefore(_,E,M),this.engine.onInsert(this.namespaceId,E,_,q)}removeChild(_,E,M){this.engine.onRemove(this.namespaceId,E,this.delegate)}selectRootElement(_,E){return this.delegate.selectRootElement(_,E)}parentNode(_){return this.delegate.parentNode(_)}nextSibling(_){return this.delegate.nextSibling(_)}setAttribute(_,E,M,q){this.delegate.setAttribute(_,E,M,q)}removeAttribute(_,E,M){this.delegate.removeAttribute(_,E,M)}addClass(_,E){this.delegate.addClass(_,E)}removeClass(_,E){this.delegate.removeClass(_,E)}setStyle(_,E,M,q){this.delegate.setStyle(_,E,M,q)}removeStyle(_,E,M){this.delegate.removeStyle(_,E,M)}setProperty(_,E,M){"@"==E.charAt(0)&&E==ir?this.disableAnimations(_,!!M):this.delegate.setProperty(_,E,M)}setValue(_,E){this.delegate.setValue(_,E)}listen(_,E,M){return this.delegate.listen(_,E,M)}disableAnimations(_,E){this.engine.disableAnimations(_,E)}}class te extends ao{constructor(_,E,M,q,oe){super(E,M,q,oe),this.factory=_,this.namespaceId=E}setProperty(_,E,M){"@"==E.charAt(0)?"."==E.charAt(1)&&E==ir?this.disableAnimations(_,M=void 0===M||!!M):this.engine.process(this.namespaceId,_,E.slice(1),M):this.delegate.setProperty(_,E,M)}listen(_,E,M){if("@"==E.charAt(0)){const q=function X(D){switch(D){case"body":return document.body;case"document":return document;case"window":return window;default:return D}}(_);let oe=E.slice(1),ge="";return"@"!=oe.charAt(0)&&([oe,ge]=function Ae(D){const _=D.indexOf(".");return[D.substring(0,_),D.slice(_+1)]}(oe)),this.engine.listen(this.namespaceId,q,oe,ge,Oe=>{this.factory.scheduleListenerCallback(Oe._data||-1,M,Oe)})}return this.delegate.listen(_,E,M)}}const $r=[{provide:xe._j,useClass:R},{provide:Zr,useFactory:function Ye(){return new Pi}},{provide:gs,useClass:(()=>{var D;class _ extends gs{constructor(M,q,oe,ge){super(M.body,q,oe)}ngOnDestroy(){this.flush()}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(J.K0),b.LFG(Yr),b.LFG(Zr),b.LFG(b.z2F))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})()},{provide:b.FYo,useFactory:function $n(D,_,E){return new ki(D,_,E)},deps:[I.se,gs,b.R0b]}],Oo=[{provide:Yr,useFactory:()=>new P},{provide:b.QbO,useValue:"BrowserAnimations"},...$r],rs=[{provide:Yr,useClass:vi},{provide:b.QbO,useValue:"NoopAnimations"},...$r];let is=(()=>{var D;class _{static withConfig(M){return{ngModule:_,providers:M.disableAnimations?rs:Oo}}}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275mod=b.oAB({type:D}),D.\u0275inj=b.cJS({providers:Oo,imports:[I.b2]}),_})();var Jo=K(2096),il=K(2459),Vl=K(5592),wa=K(6328),xl=K(2181),Fa=K(7398),Ul=K(4716),Ls=K(4664);class Gs{}class ho{}class Fs{constructor(_){this.normalizedNames=new Map,this.lazyUpdate=null,_?"string"==typeof _?this.lazyInit=()=>{this.headers=new Map,_.split("\n").forEach(E=>{const M=E.indexOf(":");if(M>0){const q=E.slice(0,M),oe=q.toLowerCase(),ge=E.slice(M+1).trim();this.maybeSetNormalizedName(q,oe),this.headers.has(oe)?this.headers.get(oe).push(ge):this.headers.set(oe,[ge])}})}:typeof Headers<"u"&&_ instanceof Headers?(this.headers=new Map,_.forEach((E,M)=>{this.setHeaderEntries(M,E)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(_).forEach(([E,M])=>{this.setHeaderEntries(E,M)})}:this.headers=new Map}has(_){return this.init(),this.headers.has(_.toLowerCase())}get(_){this.init();const E=this.headers.get(_.toLowerCase());return E&&E.length>0?E[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(_){return this.init(),this.headers.get(_.toLowerCase())||null}append(_,E){return this.clone({name:_,value:E,op:"a"})}set(_,E){return this.clone({name:_,value:E,op:"s"})}delete(_,E){return this.clone({name:_,value:E,op:"d"})}maybeSetNormalizedName(_,E){this.normalizedNames.has(E)||this.normalizedNames.set(E,_)}init(){this.lazyInit&&(this.lazyInit instanceof Fs?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(_=>this.applyUpdate(_)),this.lazyUpdate=null))}copyFrom(_){_.init(),Array.from(_.headers.keys()).forEach(E=>{this.headers.set(E,_.headers.get(E)),this.normalizedNames.set(E,_.normalizedNames.get(E))})}clone(_){const E=new Fs;return E.lazyInit=this.lazyInit&&this.lazyInit instanceof Fs?this.lazyInit:this,E.lazyUpdate=(this.lazyUpdate||[]).concat([_]),E}applyUpdate(_){const E=_.name.toLowerCase();switch(_.op){case"a":case"s":let M=_.value;if("string"==typeof M&&(M=[M]),0===M.length)return;this.maybeSetNormalizedName(_.name,E);const q=("a"===_.op?this.headers.get(E):void 0)||[];q.push(...M),this.headers.set(E,q);break;case"d":const oe=_.value;if(oe){let ge=this.headers.get(E);if(!ge)return;ge=ge.filter(Oe=>-1===oe.indexOf(Oe)),0===ge.length?(this.headers.delete(E),this.normalizedNames.delete(E)):this.headers.set(E,ge)}else this.headers.delete(E),this.normalizedNames.delete(E)}}setHeaderEntries(_,E){const M=(Array.isArray(E)?E:[E]).map(oe=>oe.toString()),q=_.toLowerCase();this.headers.set(q,M),this.maybeSetNormalizedName(_,q)}forEach(_){this.init(),Array.from(this.normalizedNames.keys()).forEach(E=>_(this.normalizedNames.get(E),this.headers.get(E)))}}class jl{encodeKey(_){return dc(_)}encodeValue(_){return dc(_)}decodeKey(_){return decodeURIComponent(_)}decodeValue(_){return decodeURIComponent(_)}}const sl=/%(\d[a-f0-9])/gi,al={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function dc(D){return encodeURIComponent(D).replace(sl,(_,E)=>al[E]??_)}function fa(D){return`${D}`}class Ws{constructor(_={}){if(this.updates=null,this.cloneFrom=null,this.encoder=_.encoder||new jl,_.fromString){if(_.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function ol(D,_){const E=new Map;return D.length>0&&D.replace(/^\?/,"").split("&").forEach(q=>{const oe=q.indexOf("="),[ge,Oe]=-1==oe?[_.decodeKey(q),""]:[_.decodeKey(q.slice(0,oe)),_.decodeValue(q.slice(oe+1))],Pt=E.get(ge)||[];Pt.push(Oe),E.set(ge,Pt)}),E}(_.fromString,this.encoder)}else _.fromObject?(this.map=new Map,Object.keys(_.fromObject).forEach(E=>{const M=_.fromObject[E],q=Array.isArray(M)?M.map(fa):[fa(M)];this.map.set(E,q)})):this.map=null}has(_){return this.init(),this.map.has(_)}get(_){this.init();const E=this.map.get(_);return E?E[0]:null}getAll(_){return this.init(),this.map.get(_)||null}keys(){return this.init(),Array.from(this.map.keys())}append(_,E){return this.clone({param:_,value:E,op:"a"})}appendAll(_){const E=[];return Object.keys(_).forEach(M=>{const q=_[M];Array.isArray(q)?q.forEach(oe=>{E.push({param:M,value:oe,op:"a"})}):E.push({param:M,value:q,op:"a"})}),this.clone(E)}set(_,E){return this.clone({param:_,value:E,op:"s"})}delete(_,E){return this.clone({param:_,value:E,op:"d"})}toString(){return this.init(),this.keys().map(_=>{const E=this.encoder.encodeKey(_);return this.map.get(_).map(M=>E+"="+this.encoder.encodeValue(M)).join("&")}).filter(_=>""!==_).join("&")}clone(_){const E=new Ws({encoder:this.encoder});return E.cloneFrom=this.cloneFrom||this,E.updates=(this.updates||[]).concat(_),E}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(_=>this.map.set(_,this.cloneFrom.map.get(_))),this.updates.forEach(_=>{switch(_.op){case"a":case"s":const E=("a"===_.op?this.map.get(_.param):void 0)||[];E.push(fa(_.value)),this.map.set(_.param,E);break;case"d":if(void 0===_.value){this.map.delete(_.param);break}{let M=this.map.get(_.param)||[];const q=M.indexOf(fa(_.value));-1!==q&&M.splice(q,1),M.length>0?this.map.set(_.param,M):this.map.delete(_.param)}}}),this.cloneFrom=this.updates=null)}}class qa{constructor(){this.map=new Map}set(_,E){return this.map.set(_,E),this}get(_){return this.map.has(_)||this.map.set(_,_.defaultValue()),this.map.get(_)}delete(_){return this.map.delete(_),this}has(_){return this.map.has(_)}keys(){return this.map.keys()}}function Ic(D){return typeof ArrayBuffer<"u"&&D instanceof ArrayBuffer}function Mc(D){return typeof Blob<"u"&&D instanceof Blob}function fc(D){return typeof FormData<"u"&&D instanceof FormData}class Ea{constructor(_,E,M,q){let oe;if(this.url=E,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=_.toUpperCase(),function hc(D){switch(D){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||q?(this.body=void 0!==M?M:null,oe=q):oe=M,oe&&(this.reportProgress=!!oe.reportProgress,this.withCredentials=!!oe.withCredentials,oe.responseType&&(this.responseType=oe.responseType),oe.headers&&(this.headers=oe.headers),oe.context&&(this.context=oe.context),oe.params&&(this.params=oe.params)),this.headers||(this.headers=new Fs),this.context||(this.context=new qa),this.params){const ge=this.params.toString();if(0===ge.length)this.urlWithParams=E;else{const Oe=E.indexOf("?");this.urlWithParams=E+(-1===Oe?"?":Oe<E.length-1?"&":"")+ge}}else this.params=new Ws,this.urlWithParams=E}serializeBody(){return null===this.body?null:Ic(this.body)||Mc(this.body)||fc(this.body)||function Hl(D){return typeof URLSearchParams<"u"&&D instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ws?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||fc(this.body)?null:Mc(this.body)?this.body.type||null:Ic(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ws?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(_={}){const E=_.method||this.method,M=_.url||this.url,q=_.responseType||this.responseType,oe=void 0!==_.body?_.body:this.body,ge=void 0!==_.withCredentials?_.withCredentials:this.withCredentials,Oe=void 0!==_.reportProgress?_.reportProgress:this.reportProgress;let Pt=_.headers||this.headers,Jt=_.params||this.params;const sr=_.context??this.context;return void 0!==_.setHeaders&&(Pt=Object.keys(_.setHeaders).reduce((Qn,Vr)=>Qn.set(Vr,_.setHeaders[Vr]),Pt)),_.setParams&&(Jt=Object.keys(_.setParams).reduce((Qn,Vr)=>Qn.set(Vr,_.setParams[Vr]),Jt)),new Ea(E,M,oe,{params:Jt,headers:Pt,context:sr,reportProgress:Oe,responseType:q,withCredentials:ge})}}var Qs=function(D){return D[D.Sent=0]="Sent",D[D.UploadProgress=1]="UploadProgress",D[D.ResponseHeader=2]="ResponseHeader",D[D.DownloadProgress=3]="DownloadProgress",D[D.Response=4]="Response",D[D.User=5]="User",D}(Qs||{});class Ba{constructor(_,E=200,M="OK"){this.headers=_.headers||new Fs,this.status=void 0!==_.status?_.status:E,this.statusText=_.statusText||M,this.url=_.url||null,this.ok=this.status>=200&&this.status<300}}class Na extends Ba{constructor(_={}){super(_),this.type=Qs.ResponseHeader}clone(_={}){return new Na({headers:_.headers||this.headers,status:void 0!==_.status?_.status:this.status,statusText:_.statusText||this.statusText,url:_.url||this.url||void 0})}}class Qo extends Ba{constructor(_={}){super(_),this.type=Qs.Response,this.body=void 0!==_.body?_.body:null}clone(_={}){return new Qo({body:void 0!==_.body?_.body:this.body,headers:_.headers||this.headers,status:void 0!==_.status?_.status:this.status,statusText:_.statusText||this.statusText,url:_.url||this.url||void 0})}}class ea extends Ba{constructor(_){super(_,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${_.url||"(unknown url)"}`:`Http failure response for ${_.url||"(unknown url)"}: ${_.status} ${_.statusText}`,this.error=_.error||null}}function N(D,_){return{body:_,headers:D.headers,context:D.context,observe:D.observe,params:D.params,reportProgress:D.reportProgress,responseType:D.responseType,withCredentials:D.withCredentials}}let ee=(()=>{var D;class _{constructor(M){this.handler=M}request(M,q,oe={}){let ge;if(M instanceof Ea)ge=M;else{let Jt,sr;Jt=oe.headers instanceof Fs?oe.headers:new Fs(oe.headers),oe.params&&(sr=oe.params instanceof Ws?oe.params:new Ws({fromObject:oe.params})),ge=new Ea(M,q,void 0!==oe.body?oe.body:null,{headers:Jt,context:oe.context,params:sr,reportProgress:oe.reportProgress,responseType:oe.responseType||"json",withCredentials:oe.withCredentials})}const Oe=(0,Jo.of)(ge).pipe((0,wa.b)(Jt=>this.handler.handle(Jt)));if(M instanceof Ea||"events"===oe.observe)return Oe;const Pt=Oe.pipe((0,xl.h)(Jt=>Jt instanceof Qo));switch(oe.observe||"body"){case"body":switch(ge.responseType){case"arraybuffer":return Pt.pipe((0,Fa.U)(Jt=>{if(null!==Jt.body&&!(Jt.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Jt.body}));case"blob":return Pt.pipe((0,Fa.U)(Jt=>{if(null!==Jt.body&&!(Jt.body instanceof Blob))throw new Error("Response is not a Blob.");return Jt.body}));case"text":return Pt.pipe((0,Fa.U)(Jt=>{if(null!==Jt.body&&"string"!=typeof Jt.body)throw new Error("Response is not a string.");return Jt.body}));default:return Pt.pipe((0,Fa.U)(Jt=>Jt.body))}case"response":return Pt;default:throw new Error(`Unreachable: unhandled observe type ${oe.observe}}`)}}delete(M,q={}){return this.request("DELETE",M,q)}get(M,q={}){return this.request("GET",M,q)}head(M,q={}){return this.request("HEAD",M,q)}jsonp(M,q){return this.request("JSONP",M,{params:(new Ws).append(q,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(M,q={}){return this.request("OPTIONS",M,q)}patch(M,q,oe={}){return this.request("PATCH",M,N(oe,q))}post(M,q,oe={}){return this.request("POST",M,N(oe,q))}put(M,q,oe={}){return this.request("PUT",M,N(oe,q))}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(Gs))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})();function xi(D,_){return _(D)}function bi(D,_){return(E,M)=>_.intercept(E,{handle:q=>D(q,M)})}const to=new b.OlP(""),Di=new b.OlP(""),Li=new b.OlP("");function ko(){let D=null;return(_,E)=>{null===D&&(D=((0,b.f3M)(to,{optional:!0})??[]).reduceRight(bi,xi));const M=(0,b.f3M)(b.HDt),q=M.add();return D(_,E).pipe((0,Ul.x)(()=>M.remove(q)))}}let Ps=(()=>{var D;class _ extends Gs{constructor(M,q){super(),this.backend=M,this.injector=q,this.chain=null,this.pendingTasks=(0,b.f3M)(b.HDt)}handle(M){if(null===this.chain){const oe=Array.from(new Set([...this.injector.get(Di),...this.injector.get(Li,[])]));this.chain=oe.reduceRight((ge,Oe)=>function Br(D,_,E){return(M,q)=>E.runInContext(()=>_(M,oe=>D(oe,q)))}(ge,Oe,this.injector),xi)}const q=this.pendingTasks.add();return this.chain(M,oe=>this.backend.handle(oe)).pipe((0,Ul.x)(()=>this.pendingTasks.remove(q)))}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(ho),b.LFG(b.lqb))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})();const wl=/^\)\]\}',?\n/;let Ya=(()=>{var D;class _{constructor(M){this.xhrFactory=M}handle(M){if("JSONP"===M.method)throw new b.vHH(-2800,!1);const q=this.xhrFactory;return(q.\u0275loadImpl?(0,il.D)(q.\u0275loadImpl()):(0,Jo.of)(null)).pipe((0,Ls.w)(()=>new Vl.y(ge=>{const Oe=q.build();if(Oe.open(M.method,M.urlWithParams),M.withCredentials&&(Oe.withCredentials=!0),M.headers.forEach((ti,ai)=>Oe.setRequestHeader(ti,ai.join(","))),M.headers.has("Accept")||Oe.setRequestHeader("Accept","application/json, text/plain, */*"),!M.headers.has("Content-Type")){const ti=M.detectContentTypeHeader();null!==ti&&Oe.setRequestHeader("Content-Type",ti)}if(M.responseType){const ti=M.responseType.toLowerCase();Oe.responseType="json"!==ti?ti:"text"}const Pt=M.serializeBody();let Jt=null;const sr=()=>{if(null!==Jt)return Jt;const ti=Oe.statusText||"OK",ai=new Fs(Oe.getAllResponseHeaders()),zi=function ys(D){return"responseURL"in D&&D.responseURL?D.responseURL:/^X-Request-URL:/m.test(D.getAllResponseHeaders())?D.getResponseHeader("X-Request-URL"):null}(Oe)||M.url;return Jt=new Na({headers:ai,status:Oe.status,statusText:ti,url:zi}),Jt},Qn=()=>{let{headers:ti,status:ai,statusText:zi,url:h}=sr(),i=null;204!==ai&&(i=typeof Oe.response>"u"?Oe.responseText:Oe.response),0===ai&&(ai=i?200:0);let c=ai>=200&&ai<300;if("json"===M.responseType&&"string"==typeof i){const p=i;i=i.replace(wl,"");try{i=""!==i?JSON.parse(i):null}catch(y){i=p,c&&(c=!1,i={error:y,text:i})}}c?(ge.next(new Qo({body:i,headers:ti,status:ai,statusText:zi,url:h||void 0})),ge.complete()):ge.error(new ea({error:i,headers:ti,status:ai,statusText:zi,url:h||void 0}))},Vr=ti=>{const{url:ai}=sr(),zi=new ea({error:ti,status:Oe.status||0,statusText:Oe.statusText||"Unknown Error",url:ai||void 0});ge.error(zi)};let Hr=!1;const Nr=ti=>{Hr||(ge.next(sr()),Hr=!0);let ai={type:Qs.DownloadProgress,loaded:ti.loaded};ti.lengthComputable&&(ai.total=ti.total),"text"===M.responseType&&Oe.responseText&&(ai.partialText=Oe.responseText),ge.next(ai)},zr=ti=>{let ai={type:Qs.UploadProgress,loaded:ti.loaded};ti.lengthComputable&&(ai.total=ti.total),ge.next(ai)};return Oe.addEventListener("load",Qn),Oe.addEventListener("error",Vr),Oe.addEventListener("timeout",Vr),Oe.addEventListener("abort",Vr),M.reportProgress&&(Oe.addEventListener("progress",Nr),null!==Pt&&Oe.upload&&Oe.upload.addEventListener("progress",zr)),Oe.send(Pt),ge.next({type:Qs.Sent}),()=>{Oe.removeEventListener("error",Vr),Oe.removeEventListener("abort",Vr),Oe.removeEventListener("load",Qn),Oe.removeEventListener("timeout",Vr),M.reportProgress&&(Oe.removeEventListener("progress",Nr),null!==Pt&&Oe.upload&&Oe.upload.removeEventListener("progress",zr)),Oe.readyState!==Oe.DONE&&Oe.abort()}})))}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(J.JF))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})();const Bs=new b.OlP("XSRF_ENABLED"),Da=new b.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),ql=new b.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class za{}let Zl=(()=>{var D;class _{constructor(M,q,oe){this.doc=M,this.platform=q,this.cookieName=oe,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const M=this.doc.cookie||"";return M!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,J.Mx)(M,this.cookieName),this.lastCookieString=M),this.lastToken}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(J.K0),b.LFG(b.Lbi),b.LFG(Da))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac}),_})();function pc(D,_){const E=D.url.toLowerCase();if(!(0,b.f3M)(Bs)||"GET"===D.method||"HEAD"===D.method||E.startsWith("http://")||E.startsWith("https://"))return _(D);const M=(0,b.f3M)(za).getToken(),q=(0,b.f3M)(ql);return null!=M&&!D.headers.has(q)&&(D=D.clone({headers:D.headers.set(q,M)})),_(D)}var ri=function(D){return D[D.Interceptors=0]="Interceptors",D[D.LegacyInterceptors=1]="LegacyInterceptors",D[D.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",D[D.NoXsrfProtection=3]="NoXsrfProtection",D[D.JsonpSupport=4]="JsonpSupport",D[D.RequestsMadeViaParent=5]="RequestsMadeViaParent",D[D.Fetch=6]="Fetch",D}(ri||{});function Ca(D,_){return{\u0275kind:D,\u0275providers:_}}function El(...D){const _=[ee,Ya,Ps,{provide:Gs,useExisting:Ps},{provide:ho,useExisting:Ya},{provide:Di,useValue:pc,multi:!0},{provide:Bs,useValue:!0},{provide:za,useClass:Zl}];for(const E of D)_.push(...E.\u0275providers);return(0,b.MR2)(_)}const Dl=new b.OlP("LEGACY_INTERCEPTOR_FN");let Ts=(()=>{var D;class _{}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275mod=b.oAB({type:D}),D.\u0275inj=b.cJS({providers:[El(Ca(ri.LegacyInterceptors,[{provide:Dl,useFactory:ko},{provide:Di,useExisting:Dl,multi:!0}]))]}),_})();var Kl=K(9397),gc=K(6306);let lu=(()=>{var D;class _{constructor(M){this.http=M,this.URL="https://nancyb3a.github.io/Test_/usuarios_PGY4121_08.json",this.httpHeader={headers:new Fs({"Content-Type":"application/json","Access-Control-Allow-Origin":"*"})}}getUser(M){return this.http.get(`${this.URL}`+M).pipe((0,Kl.b)(q=>console.log(`User fetched: ${M}`)),(0,gc.K)(this.handleError(`Get user id=${M}`)))}getUserList(){return this.http.get(`${this.URL}`).pipe((0,Kl.b)(M=>console.log("User fetched!")),(0,gc.K)(this.handleError("Get user",[])))}handleError(M="operation",q){return oe=>(console.error(oe),console.log(`${M} failed: ${oe.message}`),(0,Jo.of)(q))}}return(D=_).\u0275fac=function(M){return new(M||D)(b.LFG(ee))},D.\u0275prov=b.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),_})();var qs=K(7217);const Rc_firebaseConfig={apiKey:"AIzaSyC_vVuvLOV4sbVPrFPvzCuIU7lKHeU4zLU",authDomain:"hospit-app-8ea71.firebaseapp.com",projectId:"hospit-app-8ea71",storageBucket:"hospit-app-8ea71.appspot.com",messagingSenderId:"336867522127",appId:"1:336867522127:web:2870db3c2bdc1f512b5c3a"};var L=K(5984);let z=(()=>{var D;class _{}return(D=_).\u0275fac=function(M){return new(M||D)},D.\u0275mod=b.oAB({type:D,bootstrap:[ve]}),D.\u0275inj=b.cJS({providers:[{provide:dt.wN,useClass:l.r4},L.w,lu],imports:[I.b2,l.Pc.forRoot(),et,is,Ts,qs.hO.initializeApp(Rc_firebaseConfig)]}),_})();var H=K(2574);K.n(H)().accessToken="pk.eyJ1IjoicGF0MWhubyIsImEiOiJjbG5naWgyOXIwYnF2Mm1vOXhueWFtbXM4In0.zfLtRF__vmCcRycCOuJbPw",(0,b.G48)(),I.q6().bootstrapModule(z).catch(D=>console.log(D))},2574:function(Gn){Gn.exports=function(){"use strict";var At,K,I;function b(l,ve){if(At)if(K){var Ue="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+At+")(sharedChunk); ("+K+")(sharedChunk); self.onerror = null;",Le={};At(Le),I=ve(Le),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(I.workerUrl=window.URL.createObjectURL(new Blob([Ue],{type:"text/javascript"})))}else K=ve;else At=ve}return b(0,function(l){var ve=typeof self<"u"?self:{},Ue="2.15.0";let Le;const it={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Le){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Le=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):n}catch{Le=n}}return Le},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!it.API_URL)return null;try{const n=new URL(it.API_URL);return"api.mapbox.cn"===n.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===n.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},et={supported:!1,testSupport:function(n){!Ze&&Re&&(tt?lt(n):xe=n)}};let xe,Re,Ze=!1,tt=!1;function lt(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,Re),n.isContextLost())return;et.supported=!0}catch{}n.deleteTexture(e),Ze=!0}ve.document&&(Re=ve.document.createElement("img"),Re.onload=function(){xe&&lt(xe),xe=null,tt=!0},Re.onerror=function(){Ze=!0,xe=null},Re.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const pt="01";function vt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var _t=nt;function nt(n,e,r,s){this.cx=3*n,this.bx=3*(r-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=r,this.p2y=s}nt.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(void 0===e&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var r=n,s=0;s<8;s++){var u=this.sampleCurveX(r)-n;if(Math.abs(u)<e)return r;var f=this.sampleCurveDerivativeX(r);if(Math.abs(f)<1e-6)break;r-=u/f}var g=0,v=1;for(r=n,s=0;s<20&&(u=this.sampleCurveX(r),!(Math.abs(u-n)<e));s++)n>u?g=r:v=r,r=.5*(v-g)+g;return r},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Bt=vt(_t),Ft=Se;function Se(n,e){this.x=n,this.y=e}Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,r=n.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),r=Math.sin(n),s=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=s,this},_rotateAround:function(n,e){var r=Math.cos(n),s=Math.sin(n),u=e.y+s*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Se.convert=function(n){return n instanceof Se?n:Array.isArray(n)?new Se(n[0],n[1]):n};var Me=vt(Ft);const ht=Math.PI/180,It=180/Math.PI;function Je(n){return n*ht}function mt(n){return n*It}const Kt=[[0,0],[1,0],[1,1],[0,1]];function Ut(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,r=e*n;return 4*(n<.5?r:3*(n-e)+r-.75)}function dn(n,e,r,s){const u=new Bt(n,e,r,s);return function(f){return u.solve(f)}}const on=dn(.25,.1,.25,1);function Ht(n,e,r){return Math.min(r,Math.max(e,n))}function Yn(n,e,r){return(r=Ht((r-n)/(e-n),0,1))*r*(3-2*r)}function en(n,e,r){const s=r-e,u=((n-e)%s+s)%s+e;return u===e?r:u}function bt(n,e,r){if(!n.length)return r(null,[]);let s=n.length;const u=new Array(n.length);let f=null;n.forEach((g,v)=>{e(g,(C,T)=>{C&&(f=C),u[v]=T,0==--s&&r(f,u)})})}function $e(n){const e=[];for(const r in n)e.push(n[r]);return e}function ue(n,...e){for(const r of e)for(const s in r)n[s]=r[s];return n}let me=1;function ze(){return me++}function ct(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function Lt(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Gt(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function Yt(n,e){n.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function hn(n,e){return-1!==n.indexOf(e,n.length-e.length)}function sn(n,e,r){const s={};for(const u in n)s[u]=e.call(r||this,n[u],u,n);return s}function jt(n,e,r){const s={};for(const u in n)e.call(r||this,n[u],u,n)&&(s[u]=n[u]);return s}function Xt(n){return Array.isArray(n)?n.map(Xt):"object"==typeof n&&n?sn(n,Xt):n}const an={};function mn(n){an[n]||(typeof console<"u"&&console.warn(n),an[n]=!0)}function Bn(n,e,r){return(r.y-n.y)*(e.x-n.x)>(e.y-n.y)*(r.x-n.x)}function mr(n){let e=0;for(let r,s,u=0,f=n.length,g=f-1;u<f;g=u++)r=n[u],s=n[g],e+=(s.x-r.x)*(r.y+s.y);return e}function nr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function _r(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,s,u,f)=>{const g=u||f;return e[s]=!g||g.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let Kn=null;function Lr(n){if(null==Kn){const e=n.navigator?n.navigator.userAgent:null;Kn=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Kn}function bn(n){try{const e=ve[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Jr(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const Fi="mapbox-tiles";let Er,yr,hi=500,fr=50;function gr(){try{return ve.caches}catch{}}function Ci(){gr()&&!Er&&(Er=ve.caches.open(Fi))}function qi(n){const e=n.indexOf("?");if(e<0)return n;const s=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(n).filter(u=>{const f=u.split("=");return"language"===f[0]||"worldview"===f[0]});return s.length?`${n.slice(0,e)}?${s.join("&")}`:n.slice(0,e)}let Sr=1/0;const Ai={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Ai);class vi extends Error{constructor(e,r,s){401===r&&Ot(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Yr=nr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===ve.location.protocol?ve.parent:ve).location.href,Do=function(n,e){if(!(/^file:/.test(r=n.url)||/^file:/.test(Yr())&&!/^\w+:/.test(r))){if(ve.fetch&&ve.Request&&ve.AbortController&&ve.Request.prototype.hasOwnProperty("signal"))return function(s,u){const f=new ve.AbortController,g=new ve.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Yr(),referrerPolicy:s.referrerPolicy,signal:f.signal});let v=!1,C=!1;const T=(F=g.url).indexOf("sku=")>0&&Ot(F);var F;"json"===s.type&&g.headers.set("Accept","application/json");const V=(Z,Q,ce)=>{if(C)return;if(Z&&"SecurityError"!==Z.message&&mn(Z.toString()),Q&&ce)return j(Q);const Te=Date.now();ve.fetch(g).then(He=>{if(He.ok){const st=T?He.clone():null;return j(He,st,Te)}return u(new vi(He.statusText,He.status,s.url))}).catch(He=>{"AbortError"!==He.name&&u(new Error(`${He.message} ${s.url}`))})},j=(Z,Q,ce)=>{("arrayBuffer"===s.type?Z.arrayBuffer():"json"===s.type?Z.json():Z.text()).then(Te=>{C||(Q&&ce&&function(He,st,Ge){if(Ci(),!Er)return;const at={status:st.status,statusText:st.statusText,headers:new ve.Headers};st.headers.forEach((tn,Zt)=>at.headers.set(Zt,tn));const yt=_r(st.headers.get("Cache-Control")||"");if(yt["no-store"])return;yt["max-age"]&&at.headers.set("Expires",new Date(Ge+1e3*yt["max-age"]).toUTCString());const gt=at.headers.get("Expires");gt&&(new Date(gt).getTime()-Ge<42e4||function(tn,Zt){if(void 0===yr)try{new Response(new ReadableStream),yr=!0}catch{yr=!1}yr?Zt(tn.body):tn.blob().then(Zt)}(st,tn=>{const Zt=new ve.Response(tn,at);Ci(),Er&&Er.then(gn=>gn.put(qi(He.url),Zt)).catch(gn=>mn(gn.message))}))}(g,Q,ce),v=!0,u(null,Te,Z.headers.get("Cache-Control"),Z.headers.get("Expires")))}).catch(Te=>{C||u(new Error(Te.message))})};return T?function(Z,Q){if(Ci(),!Er)return Q(null);const ce=qi(Z.url);Er.then(Te=>{Te.match(ce).then(He=>{const st=function(Ge){if(!Ge)return!1;const at=new Date(Ge.headers.get("Expires")||0),yt=_r(Ge.headers.get("Cache-Control")||"");return at>Date.now()&&!yt["no-cache"]}(He);Te.delete(ce),st&&Te.put(ce,He.clone()),Q(null,He,st)}).catch(Q)}).catch(Q)}(g,V):V(null,null),{cancel:()=>{C=!0,v||f.abort()}}}(n,e);if(nr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var r;return function(s,u){const f=new ve.XMLHttpRequest;f.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(f.responseType="arraybuffer");for(const g in s.headers)f.setRequestHeader(g,s.headers[g]);return"json"===s.type&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials="include"===s.credentials,f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||0===f.status)&&null!==f.response){let g=f.response;if("json"===s.type)try{g=JSON.parse(f.response)}catch(v){return u(v)}u(null,g,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new vi(f.statusText,f.status,s.url))},f.send(s.body),{cancel:()=>f.abort()}}(n,e)},Or=function(n,e){return Do(ue(n,{type:"arrayBuffer"}),e)};function Co(n){const e=ve.document.createElement("a");return e.href=n,e.protocol===ve.document.location.protocol&&e.host===ve.document.location.host}const Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let he,_e;he=[],_e=0;const qe=function(n,e){if(et.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),_e>=it.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return he.push(f),f}_e++;let r=!1;const s=()=>{if(!r)for(r=!0,_e--;he.length&&_e<it.MAX_PARALLEL_IMAGE_REQUESTS;){const f=he.shift(),{requestParameters:g,callback:v,cancelled:C}=f;C||(f.cancel=qe(g,v).cancel)}},u=Or(n,(f,g,v,C)=>{s(),f?e(f):g&&(ve.createImageBitmap?function(T,F){const V=new ve.Blob([new Uint8Array(T)],{type:"image/png"});ve.createImageBitmap(V).then(j=>{F(null,j)}).catch(j=>{F(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(T,F)=>e(T,F,v,C)):function(T,F){const V=new ve.Image,j=ve.URL;V.onload=()=>{F(null,V),j.revokeObjectURL(V.src),V.onload=null,ve.requestAnimationFrame(()=>{V.src=Qe})},V.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Z=new ve.Blob([new Uint8Array(T)],{type:"image/png"});V.src=T.byteLength?j.createObjectURL(Z):Qe}(g,(T,F)=>e(T,F,v,C)))});return{cancel:()=>{u.cancel(),s()}}},ut="NO_ACCESS_TOKEN";function wt(n){return 0===n.indexOf("mapbox:")}function Ot(n){return it.API_URL_REGEX.test(n)}function kt(n){return it.API_CDN_URL_REGEX.test(n)}function xt(n){return it.API_STYLE_REGEX.test(n)&&!Vt(n)}function Vt(n){return it.API_SPRITE_REGEX.test(n)}const yn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Be(n){const e=n.match(yn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function le(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}const de="mapbox.eventData";function Ne(n){if(!n)return null;const e=n.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(ve.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class pe{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=Ne(it.ACCESS_TOKEN);let s="";return s=r&&r.u?ve.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(+("0x"+f)))):it.ACCESS_TOKEN||"",e?`${de}.${e}:${s}`:`${de}:${s}`}fetchEventData(){const e=bn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const u=ve.localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));const f=ve.localStorage.getItem(s);f&&(this.anonId=f)}catch{mn("Unable to read from LocalStorage")}}saveEventData(){const e=bn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{ve.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&ve.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{mn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,s,u){if(!it.EVENTS_URL)return;const f=Be(it.EVENTS_URL);f.params.push(`access_token=${u||it.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(e).toISOString()},v=r?ue(g,r):g,C={url:le(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};var F;this.pendingRequest=(F=T=>{this.pendingRequest=null,s(T),this.saveEventData(),this.processRequests(u)},Do(ue(C,{method:"POST"}),F))}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const ot=new class extends pe{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){it.EVENTS_URL&&it.ACCESS_TOKEN&&Array.isArray(n)&&n.some(r=>wt(r)||Ot(r))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Ne(it.ACCESS_TOKEN),r=e?e.u:it.ACCESS_TOKEN;let s=r!==this.eventData.tokenU;Gt(this.anonId)||(this.anonId=ct(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),g=new Date(u),v=(u-this.eventData.lastSuccess)/864e5;s=s||v>=1||v<-1||f.getDate()!==g.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ue,skuId:pt,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},n):this.processRequests()}},$t=ot.postTurnstileEvent.bind(ot),vn=new class extends pe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,r,s){this.skuToken=e,this.errorCb=s,it.EVENTS_URL&&(r||it.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},r):this.errorCb(new Error(ut)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Gt(this.anonId)||(this.anonId=ct()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ue,skuId:pt,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n))}},Xn=vn.postMapLoadEvent.bind(vn),Wn=new class extends pe{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){it.EVENTS_URL&&(n||it.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:r}=this.queue.shift(),s=function(u){const f=ve.performance.getEntriesByType("resource"),g=ve.performance.getEntriesByType("mark"),v=function(j){const Z={};if(j)for(const Q in j)if("other"!==Q)for(const ce of j[Q]){const Te=`${Q}ResolveRangeMin`,He=`${Q}ResolveRangeMax`,st=`${Q}RequestCount`,Ge=`${Q}RequestCachedCount`;Z[Te]=Math.min(Z[Te]||1/0,ce.startTime),Z[He]=Math.max(Z[He]||-1/0,ce.responseEnd);const at=yt=>{void 0===Z[yt]&&(Z[yt]=0),++Z[yt]};void 0!==ce.transferSize&&0===ce.transferSize&&at(Ge),at(st)}return Z}(function(j,Z){const Q={};if(j)for(const ce of j){const Te=Z(ce);void 0===Q[Te]&&(Q[Te]=[]),Q[Te].push(ce)}return Q}(f,rn)),C=ve.devicePixelRatio,T=ve.navigator.connection||ve.navigator.mozConnection||ve.navigator.webkitConnection,F={counters:[],metadata:[],attributes:[]},V=(j,Z,Q)=>{null!=Q&&j.push({name:Z,value:Q.toString()})};for(const j in v)V(F.counters,j,v[j]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(V(F.counters,"interactionRangeMin",u.interactionRange[0]),V(F.counters,"interactionRangeMax",u.interactionRange[1])),g)for(const j of Object.keys(ro)){const Z=ro[j],Q=g.find(ce=>ce.name===Z);Q&&V(F.counters,Z,Q.startTime)}return V(F.counters,"visibilityHidden",u.visibilityHidden),V(F.attributes,"style",function(j){if(j)for(const Z of j){const Q=Z.name.split("?")[0];if(xt(Q)){const ce=Q.split("/").slice(-2);if(2===ce.length)return`mapbox://styles/${ce[0]}/${ce[1]}`}}}(f)),V(F.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),V(F.attributes,"fogEnabled",u.fogEnabled?"true":"false"),V(F.attributes,"projection",u.projection),V(F.attributes,"zoom",u.zoom),V(F.metadata,"devicePixelRatio",C),V(F.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),V(F.metadata,"navigatorUserAgent",ve.navigator.userAgent),V(F.metadata,"screenWidth",ve.screen.width),V(F.metadata,"screenHeight",ve.screen.height),V(F.metadata,"windowWidth",ve.innerWidth),V(F.metadata,"windowHeight",ve.innerHeight),V(F.metadata,"mapWidth",u.width/C),V(F.metadata,"mapHeight",u.height/C),V(F.metadata,"webglRenderer",u.renderer),V(F.metadata,"webglVendor",u.vendor),V(F.metadata,"sdkVersion",Ue),V(F.metadata,"sdkIdentifier","mapbox-gl-js"),F}(r);for(const u of s.metadata);for(const u of s.counters);for(const u of s.attributes);this.postEvent(e,s,()=>{},n)}},hr=Wn.postPerformanceEvent.bind(Wn),vr=new class extends pe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,r,s){if(!it.API_URL||!it.SESSION_PATH)return;const u=Be(it.API_URL+it.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||it.ACCESS_TOKEN||""}`);const f={url:le(u),headers:{"Content-Type":"text/plain"}};var v;this.pendingRequest=(v=g=>{this.pendingRequest=null,r(g),this.saveEventData(),this.processRequests(s)},Do(ue(f,{method:"GET"}),v))}getSessionAPI(n,e,r,s){this.skuToken=e,this.errorCb=s,it.SESSION_PATH&&it.API_URL&&(r||it.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},r):this.errorCb(new Error(ut)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n)}},Wr=vr.getSessionAPI.bind(vr),ni=new Set,ro={create:"create",load:"load",fullLoad:"fullLoad"},Bo={mark(n){ve.performance.mark(n)},measure(n,e,r){ve.performance.measure(n,e,r)}};function rn(n){const e=n.name.split("?")[0];return kt(e)&&e.includes("mapbox-gl.js")?"javascript":kt(e)&&e.includes("mapbox-gl.css")?"css":it.API_FONTS_REGEX.test(e)?"fontRange":Vt(e)?"sprite":xt(e)?"style":it.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const Tt=ve.performance;function Dn(n){const e=n?n.url.toString():void 0;return Tt.getEntriesByName(e)}let ur,Zn,Rr,Fr;const fi={now:()=>void 0!==Rr?Rr:ve.performance.now(),setNow(n){Rr=n},restoreNow(){Rr=void 0},frame(n){const e=ve.requestAnimationFrame(n);return{cancel:()=>ve.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:r,height:s}=n;Fr||(Fr=ve.document.createElement("canvas"));const u=Fr.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>Fr.width||s>Fr.height)&&(Fr.width=r,Fr.height=s),u.clearRect(-e,-e,r+2*e,s+2*e),u.drawImage(n,0,0,r,s),u.getImageData(-e,-e,r+2*e,s+2*e)},resolveURL:n=>(ur||(ur=ve.document.createElement("a")),ur.href=n,ur.href),get devicePixelRatio(){return ve.devicePixelRatio},get prefersReducedMotion(){return!!ve.matchMedia&&(null==Zn&&(Zn=ve.matchMedia("(prefers-reduced-motion: reduce)")),Zn.matches)}};function Ti(n,e,r){r[n]&&-1!==r[n].indexOf(e)||(r[n]=r[n]||[],r[n].push(e))}function Qr(n,e,r){if(r&&r[n]){const s=r[n].indexOf(e);-1!==s&&r[n].splice(s,1)}}class ui{constructor(e,r={}){ue(this,r),this.type=e}}class qr extends ui{constructor(e,r={}){super("error",ue({error:e},r))}}class Es{on(e,r){return this._listeners=this._listeners||{},Ti(e,r,this._listeners),this}off(e,r){return Qr(e,r,this._listeners),Qr(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ti(e,r,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,r){"string"==typeof e&&(e=new ui(e,r||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of u)v.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of f)Qr(s,v,this._oneTimeListeners),v.call(this,e);const g=this._eventedParent;g&&(ue(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof qr&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var cn=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function io(n,...e){for(const r of e)for(const s in r)n[s]=r[s];return n}function wi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function oi(n){if(Array.isArray(n))return n.map(oi);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const r in n)e[r]=oi(n[r]);return e}return wi(n)}class Yo extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var Vi=Yo;class ss{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[s,u]of r)this.bindings[s]=u}concat(e){return new ss(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Po=ss;const No={kind:"null"},qn={kind:"number"},Cr={kind:"string"},fe={kind:"boolean"},je={kind:"color"},Ce={kind:"object"},Ve={kind:"value"},St={kind:"collator"},zt={kind:"formatted"},fn={kind:"resolvedImage"};function xn(n,e){return{kind:"array",itemType:n,N:e}}function pn(n){if("array"===n.kind){const e=pn(n.itemType);return"number"==typeof n.N?`array<${e}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${e}>`}return n.kind}const An=[No,qn,Cr,fe,je,zt,Ce,xn(Ve),fn];function cr(n,e){if("error"===e.kind)return null;if("array"===n.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!cr(n.itemType,e.itemType))&&("number"!=typeof n.N||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if("value"===n.kind)for(const r of An)if(!cr(r,e))return null}return`Expected ${pn(n)} but found ${pn(e)} instead.`}function Tr(n,e){return e.some(r=>r.kind===n.kind)}function kr(n,e){return e.some(r=>"null"===r?null===n:"array"===r?Array.isArray(n):"object"===r?n&&!Array.isArray(n)&&"object"==typeof n:r===typeof n)}var Ei,oo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Wi(n){return(n=Math.round(n))<0?0:n>255?255:n}function Ji(n){return Wi("%"===n[n.length-1]?parseFloat(n)/100*255:parseInt(n))}function Ri(n){return(e="%"===n[n.length-1]?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function To(n,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?n+(e-n)*r*6:2*r<1?e:3*r<2?n+(e-n)*(2/3-r)*6:n}try{Ei={}.parseCSSColor=function(n){var e,r=n.replace(/ /g,"").toLowerCase();if(r in oo)return oo[r].slice();if("#"===r[0])return 4===r.length?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===r.length&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=r.indexOf("("),u=r.indexOf(")");if(-1!==s&&u+1===r.length){var f=r.substr(0,s),g=r.substr(s+1,u-(s+1)).split(","),v=1;switch(f){case"rgba":if(4!==g.length)return null;v=Ri(g.pop());case"rgb":return 3!==g.length?null:[Ji(g[0]),Ji(g[1]),Ji(g[2]),v];case"hsla":if(4!==g.length)return null;v=Ri(g.pop());case"hsl":if(3!==g.length)return null;var C=(parseFloat(g[0])%360+360)%360/360,T=Ri(g[1]),F=Ri(g[2]),V=F<=.5?F*(T+1):F+T-F*T,j=2*F-V;return[Wi(255*To(j,V,C+1/3)),Wi(255*To(j,V,C)),Wi(255*To(j,V,C-1/3)),v];default:return null}}return null}}catch{}class jr{constructor(e,r,s,u=1){this.r=e,this.g=r,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof jr)return e;if("string"!=typeof e)return;const r=Ei(e);return r?new jr(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,s,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(s)},${u})`}toArray(){const{r:e,g:r,b:s,a:u}=this;return 0===u?[0,0,0,0]:[255*e/u,255*r/u,255*s/u,u]}toArray01(){const{r:e,g:r,b:s,a:u}=this;return 0===u?[0,0,0,0]:[e/u,r/u,s/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:s,a:u}=this;return[e,r,s,u]}}jr.black=new jr(0,0,0,1),jr.white=new jr(1,1,1,1),jr.transparent=new jr(0,0,0,0),jr.red=new jr(1,0,0,1),jr.blue=new jr(0,0,1,1);var Zr=jr;class Qi{constructor(e,r,s){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ps{constructor(e,r,s,u,f){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=s,this.fontStack=u,this.textColor=f}}class Pi{constructor(e){this.sections=e}static fromString(e){return new Pi([new ps(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Pi?e:Pi.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(s)}return e}}class So{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new So({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ks(n,e,r,s){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[n,e,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[n,e,r,s]:[n,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function as(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof Zr||n instanceof Qi||n instanceof Pi||n instanceof So)return!0;if(Array.isArray(n)){for(const e of n)if(!as(e))return!1;return!0}if("object"==typeof n){for(const e in n)if(!as(n[e]))return!1;return!0}return!1}function Ni(n){if(null===n)return No;if("string"==typeof n)return Cr;if("boolean"==typeof n)return fe;if("number"==typeof n)return qn;if(n instanceof Zr)return je;if(n instanceof Qi)return St;if(n instanceof Pi)return zt;if(n instanceof So)return fn;if(Array.isArray(n)){const e=n.length;let r;for(const s of n){const u=Ni(s);if(r){if(r===u)continue;r=Ve;break}r=u}return xn(r||Ve,e)}return Ce}function Os(n){const e=typeof n;return null===n?"":"string"===e||"number"===e||"boolean"===e?String(n):n instanceof Zr||n instanceof Pi||n instanceof So?n.toString():JSON.stringify(n)}class Oi{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(2!==e.length)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!as(e[1]))return r.error("invalid value");const s=e[1];let u=Ni(s);const f=r.expectedType;return"array"!==u.kind||0!==u.N||!f||"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(u=f),new Oi(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Zr?["rgba"].concat(this.value.toArray()):this.value instanceof Pi?this.value.serialize():this.value}}var rr=Oi,xr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Si={string:Cr,number:qn,boolean:fe,object:Ce};class Io{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let s,u=1;const f=e[0];if("array"===f){let v,C;if(e.length>2){const T=e[1];if("string"!=typeof T||!(T in Si)||"object"===T)return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=Si[T],u++}else v=Ve;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);C=e[2],u++}s=xn(v,C)}else s=Si[f];const g=[];for(;u<e.length;u++){const v=r.parse(e[u],u,Ve);if(!v)return null;g.push(v)}return new Io(s,g)}evaluate(e){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(e);if(!cr(this.type,Ni(s)))return s;if(r===this.args.length-1)throw new xr(`Expected value to be of type ${pn(this.type)}, but found ${pn(Ni(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){r.push(s.kind);const u=e.N;("number"==typeof u||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(s=>s.serialize()))}}var zo=Io;class Ii{constructor(e){this.type=zt,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return r.error("First argument must be an image or text section.");const u=[];let f=!1;for(let g=1;g<=e.length-1;++g){const v=e[g];if(f&&"object"==typeof v&&!Array.isArray(v)){f=!1;let C=null;if(v["font-scale"]&&(C=r.parse(v["font-scale"],1,qn),!C))return null;let T=null;if(v["text-font"]&&(T=r.parse(v["text-font"],1,xn(Cr)),!T))return null;let F=null;if(v["text-color"]&&(F=r.parse(v["text-color"],1,je),!F))return null;const V=u[u.length-1];V.scale=C,V.font=T,V.textColor=F}else{const C=r.parse(e[g],1,Ve);if(!C)return null;const T=C.type.kind;if("string"!==T&&"value"!==T&&"null"!==T&&"resolvedImage"!==T)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:C,scale:null,font:null,textColor:null})}}return new Ii(u)}evaluate(e){return new Pi(this.sections.map(r=>{const s=r.content.evaluate(e);return Ni(s)===fn?new ps("",s,null,null,null):new ps(Os(s),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),e.push(s)}return e}}class Ms{constructor(e){this.type=fn,this.input=e}static parse(e,r){if(2!==e.length)return r.error("Expected two arguments.");const s=r.parse(e[1],1,Cr);return s?new Ms(s):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),s=So.fromString(r);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(r)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const eo={"to-boolean":fe,"to-color":je,"to-number":qn,"to-string":Cr};class $o{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return r.error("Expected one argument.");const u=eo[s],f=[];for(let g=1;g<e.length;g++){const v=r.parse(e[g],g,Ve);if(!v)return null;f.push(v)}return new $o(u,f)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let r,s;for(const u of this.args){if(r=u.evaluate(e),s=null,r instanceof Zr)return r;if("string"==typeof r){const f=e.parseColor(r);if(f)return f}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Ks(r[0],r[1],r[2],r[3]),!s))return new Zr(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new xr(s||`Could not parse color from value '${"string"==typeof r?r:String(JSON.stringify(r))}'`)}if("number"===this.type.kind){let r=null;for(const s of this.args){if(r=s.evaluate(e),null===r)return 0;const u=Number(r);if(!isNaN(u))return u}throw new xr(`Could not convert ${JSON.stringify(r)} to number.`)}return"formatted"===this.type.kind?Pi.fromString(Os(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?So.fromString(Os(this.args[0].evaluate(e))):Os(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ii([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ms(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Vo=$o;const Mr=["Unknown","Point","LineString","Polygon"];var ks=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Mr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-n[0])+this.featureDistanceData.bearing[1]*(s*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=Zr.parse(n)),e}};class ls{constructor(e,r,s,u){this.name=e,this.type=r,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const s=e[0],u=ls.definitions[s];if(!u)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,g=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=g.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let C=null;for(const[T,F]of v){C=new Xo(r.registry,r.path,null,r.scope);const V=[];let j=!1;for(let Z=1;Z<e.length;Z++){const Q=e[Z],ce=Array.isArray(T)?T[Z-1]:T.type,Te=C.parse(Q,1+V.length,ce);if(!Te){j=!0;break}V.push(Te)}if(!j)if(Array.isArray(T)&&T.length!==V.length)C.error(`Expected ${T.length} arguments, but found ${V.length} instead.`);else{for(let Z=0;Z<V.length;Z++){const Q=Array.isArray(T)?T[Z]:T.type,ce=V[Z];C.concat(Z+1).checkSubtype(Q,ce.type)}if(0===C.errors.length)return new ls(s,f,F,V)}}if(1===v.length)r.errors.push(...C.errors);else{const T=(v.length?v:g).map(([V])=>{return j=V,Array.isArray(j)?`(${j.map(pn).join(", ")})`:`(${pn(j.type)}...)`;var j}).join(" | "),F=[];for(let V=1;V<e.length;V++){const j=r.parse(e[V],1+F.length);if(!j)return null;F.push(pn(j.type))}r.error(`Expected arguments of type ${T}, but found (${F.join(", ")}) instead.`)}return null}static register(e,r){ls.definitions=r;for(const s in r)e[s]=ls}}var _o=ls;class Ui{constructor(e,r,s){this.type=St,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(2!==e.length)return r.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return r.error("Collator options argument must be an object.");const u=r.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,fe);if(!u)return null;const f=r.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,fe);if(!f)return null;let g=null;return s.locale&&(g=r.parse(s.locale,1,Cr),!g)?null:new Ui(u,f,g)}evaluate(e){return new Qi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const es=8192;function Ro(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Uo(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function jo(n,e){const r=(180+n[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(r*u*es),Math.round(s*u*es)]}function oa(n,e,r){const s=n[0]-e[0],u=n[1]-e[1],f=n[0]-r[0],g=n[1]-r[1];return s*g-f*u==0&&s*f<=0&&u*g<=0}function ms(n,e){let r=!1;for(let g=0,v=e.length;g<v;g++){const C=e[g];for(let T=0,F=C.length;T<F-1;T++){if(oa(n,C[T],C[T+1]))return!1;(u=C[T])[1]>(s=n)[1]!=(f=C[T+1])[1]>s[1]&&s[0]<(f[0]-u[0])*(s[1]-u[1])/(f[1]-u[1])+u[0]&&(r=!r)}}var s,u,f;return r}function cs(n,e){for(let r=0;r<e.length;r++)if(ms(n,e[r]))return!0;return!1}function ts(n,e,r,s){const u=s[0]-r[0],f=s[1]-r[1],g=(n[0]-r[0])*f-u*(n[1]-r[1]),v=(e[0]-r[0])*f-u*(e[1]-r[1]);return g>0&&v<0||g<0&&v>0}function ns(n,e,r){for(const T of r)for(let F=0;F<T.length-1;++F)if((v=[(g=T[F+1])[0]-(f=T[F])[0],g[1]-f[1]])[0]*(C=[(u=e)[0]-(s=n)[0],u[1]-s[1]])[1]-v[1]*C[0]!=0&&ts(s,u,f,g)&&ts(f,g,s,u))return!0;var s,u,f,g,v,C;return!1}function er(n,e){for(let r=0;r<n.length;++r)if(!ms(n[r],e))return!1;for(let r=0;r<n.length-1;++r)if(ns(n[r],n[r+1],e))return!1;return!0}function ka(n,e){for(let r=0;r<e.length;r++)if(er(n,e[r]))return!0;return!1}function As(n,e,r){const s=[];for(let u=0;u<n.length;u++){const f=[];for(let g=0;g<n[u].length;g++){const v=jo(n[u][g],r);Ro(e,v),f.push(v)}s.push(f)}return s}function va(n,e,r){const s=[];for(let u=0;u<n.length;u++){const f=As(n[u],e,r);s.push(f)}return s}function Ho(n,e,r,s){if(n[0]<r[0]||n[0]>r[2]){const u=.5*s;let f=n[0]-r[0]>u?-s:r[0]-n[0]>u?s:0;0===f&&(f=n[0]-r[2]>u?-s:r[2]-n[0]>u?s:0),n[0]+=f}Ro(e,n)}function js(n,e,r,s){const u=Math.pow(2,s.z)*es,f=[s.x*es,s.y*es],g=[];if(!n)return g;for(const v of n)for(const C of v){const T=[C.x+f[0],C.y+f[1]];Ho(T,e,r,u),g.push(T)}return g}function uo(n,e,r,s){const u=Math.pow(2,s.z)*es,f=[s.x*es,s.y*es],g=[];if(!n)return g;for(const C of n){const T=[];for(const F of C){const V=[F.x+f[0],F.y+f[1]];Ro(e,V),T.push(V)}g.push(T)}if(e[2]-e[0]<=u/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const C of g)for(const T of C)Ho(T,e,r,u)}var v;return g}class Mo{constructor(e,r){this.type=fe,this.geojson=e,this.geometries=r}static parse(e,r){if(2!==e.length)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(as(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let u=0;u<s.features.length;++u){const f=s.features[u].geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new Mo(s,s.features[u].geometry)}else if("Feature"===s.type){const u=s.geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new Mo(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new Mo(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(r,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(!g)return!1;if("Polygon"===s.type){const v=As(s.coordinates,f,g),C=js(r.geometry(),u,f,g);if(!Uo(u,f))return!1;for(const T of C)if(!ms(T,v))return!1}if("MultiPolygon"===s.type){const v=va(s.coordinates,f,g),C=js(r.geometry(),u,f,g);if(!Uo(u,f))return!1;for(const T of C)if(!cs(T,v))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(r,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(!g)return!1;if("Polygon"===s.type){const v=As(s.coordinates,f,g),C=uo(r.geometry(),u,f,g);if(!Uo(u,f))return!1;for(const T of C)if(!er(T,v))return!1}if("MultiPolygon"===s.type){const v=va(s.coordinates,f,g),C=uo(r.geometry(),u,f,g);if(!Uo(u,f))return!1;for(const T of C)if(!ka(T,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var so=Mo;function xa(n){if(n instanceof _o&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof so)return!1;let e=!0;return n.eachChild(r=>{e&&!xa(r)&&(e=!1)}),e}function Bi(n){if(n instanceof _o&&"feature-state"===n.name)return!1;let e=!0;return n.eachChild(r=>{e&&!Bi(r)&&(e=!1)}),e}function Zi(n,e){if(n instanceof _o&&e.indexOf(n.name)>=0)return!1;let r=!0;return n.eachChild(s=>{r&&!Zi(s,e)&&(r=!1)}),r}class Hs{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(2!==e.length||"string"!=typeof e[1])return r.error("'var' expression requires exactly one string literal argument.");const s=e[1];return r.scope.has(s)?new Hs(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var gs=Hs;class us{constructor(e,r=[],s,u=new Po,f=[]){this.registry=e,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=f,this.expectedType=s}parse(e,r,s,u,f={}){return r?this.concat(r,s,u)._parse(e,f):this._parse(e,f)}_parse(e,r){function s(u,f,g){return"assert"===g?new zo(f,[u]):"coerce"===g?new Vo(f,[u]):u}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if("string"!=typeof u)return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let g=f.parse(e,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,C=g.type;if("string"!==v.kind&&"number"!==v.kind&&"boolean"!==v.kind&&"object"!==v.kind&&"array"!==v.kind||"value"!==C.kind)if("color"!==v.kind&&"formatted"!==v.kind&&"resolvedImage"!==v.kind||"value"!==C.kind&&"string"!==C.kind){if(this.checkSubtype(v,C))return null}else g=s(g,v,r.typeAnnotation||"coerce");else g=s(g,v,r.typeAnnotation||"assert")}if(!(g instanceof rr)&&"resolvedImage"!==g.type.kind&&sa(g)){const v=new ks;try{g=new rr(g.type,g.evaluate(v))}catch(C){return this.error(C.message),null}}return g}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,s){const u="number"==typeof e?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new us(this.registry,u,r||null,f,this.errors)}error(e,...r){const s=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new Vi(s,e))}checkSubtype(e,r){const s=cr(e,r);return s&&this.error(s),s}}var Xo=us;function sa(n){if(n instanceof gs)return sa(n.boundExpression);if(n instanceof _o&&"error"===n.name||n instanceof Ui||n instanceof so)return!1;const e=n instanceof Vo||n instanceof zo;let r=!0;return n.eachChild(s=>{r=e?r&&sa(s):r&&s instanceof rr}),!!r&&xa(n)&&Zi(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ba(n,e){const r=n.length-1;let s,u,f=0,g=r,v=0;for(;f<=g;)if(v=Math.floor((f+g)/2),s=n[v],u=n[v+1],s<=e){if(v===r||e<u)return v;f=v+1}else{if(!(s>e))throw new xr("Input is not a number.");g=v-1}return 0}class Js{constructor(e,r,s){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[u,f]of s)this.labels.push(u),this.outputs.push(f)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(e[1],1,qn);if(!s)return null;const u=[];let f=null;r.expectedType&&"value"!==r.expectedType.kind&&(f=r.expectedType);for(let g=1;g<e.length;g+=2){const v=1===g?-1/0:e[g],C=e[g+1],T=g,F=g+1;if("number"!=typeof v)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(u.length&&u[u.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const V=r.parse(C,F,f);if(!V)return null;f=f||V.type,u.push([v,V])}return new Js(f,s,u)}evaluate(e){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);const f=r.length;return u>=r[f-1]?s[f-1].evaluate(e):s[ba(r,u)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var P=Js;function J(n,e,r){return n*(1-r)+e*r}var R=Object.freeze({__proto__:null,array:function(n,e,r){return n.map((s,u)=>J(s,e[u],r))},color:function(n,e,r){return new Zr(J(n.r,e.r,r),J(n.g,e.g,r),J(n.b,e.b,r),J(n.a,e.a,r))},number:J});const Cn=4/29,lr=6/29,ir=3*lr*lr,ki=lr*lr*lr,ao=Math.PI/180,te=180/Math.PI;function X(n){return n>ki?Math.pow(n,1/3):n/ir+Cn}function Ae(n){return n>lr?n*n*n:ir*(n-Cn)}function re(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function Ye(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function $n(n){const e=Ye(n.r),r=Ye(n.g),s=Ye(n.b),u=X((.4124564*e+.3575761*r+.1804375*s)/.95047),f=X((.2126729*e+.7151522*r+.072175*s)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-X((.0193339*e+.119192*r+.9503041*s)/1.08883)),alpha:n.a}}function $r(n){let e=(n.l+16)/116,r=isNaN(n.a)?e:e+n.a/500,s=isNaN(n.b)?e:e-n.b/200;return e=1*Ae(e),r=.95047*Ae(r),s=1.08883*Ae(s),new Zr(re(3.2404542*r-1.5371385*e-.4985314*s),re(-.969266*r+1.8760108*e+.041556*s),re(.0556434*r-.2040259*e+1.0572252*s),n.alpha)}function Oo(n,e,r){const s=e-n;return n+r*(s>180||s<-180?s-360*Math.round(s/360):s)}const rs={forward:$n,reverse:$r,interpolate:function(n,e,r){return{l:J(n.l,e.l,r),a:J(n.a,e.a,r),b:J(n.b,e.b,r),alpha:J(n.alpha,e.alpha,r)}}},is={forward:function(n){const{l:e,a:r,b:s}=$n(n),u=Math.atan2(s,r)*te;return{h:u<0?u+360:u,c:Math.sqrt(r*r+s*s),l:e,alpha:n.a}},reverse:function(n){const e=n.h*ao,r=n.c;return $r({l:n.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:n.alpha})},interpolate:function(n,e,r){return{h:Oo(n.h,e.h,r),c:J(n.c,e.c,r),l:J(n.l,e.l,r),alpha:J(n.alpha,e.alpha,r)}}};var Ko=Object.freeze({__proto__:null,hcl:is,lab:rs});class Ds{constructor(e,r,s,u,f){this.type=e,this.operator=r,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,v]of f)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(e,r,s,u){let f=0;if("exponential"===e.name)f=La(r,e.base,s,u);else if("linear"===e.name)f=La(r,1,s,u);else if("cubic-bezier"===e.name){const g=e.controlPoints;f=new Bt(g[0],g[1],g[2],g[3]).solve(La(r,1,s,u))}return f}static parse(e,r){let[s,u,f,...g]=e;if(!Array.isArray(u)||0===u.length)return r.error("Expected an interpolation type expression.",1);if("linear"===u[0])u={name:"linear"};else if("exponential"===u[0]){const T=u[1];if("number"!=typeof T)return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:T}}else{if("cubic-bezier"!==u[0])return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const T=u.slice(1);if(4!==T.length||T.some(F=>"number"!=typeof F||F<0||F>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(f=r.parse(f,2,qn),!f)return null;const v=[];let C=null;"interpolate-hcl"===s||"interpolate-lab"===s?C=je:r.expectedType&&"value"!==r.expectedType.kind&&(C=r.expectedType);for(let T=0;T<g.length;T+=2){const F=g[T],V=g[T+1],j=T+3,Z=T+4;if("number"!=typeof F)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(v.length&&v[v.length-1][0]>=F)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const Q=r.parse(V,Z,C);if(!Q)return null;C=C||Q.type,v.push([F,Q])}return"number"===C.kind||"color"===C.kind||"array"===C.kind&&"number"===C.itemType.kind&&"number"==typeof C.N?new Ds(C,s,u,f,v):r.error(`Type ${pn(C)} is not interpolatable.`)}evaluate(e){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);const f=r.length;if(u>=r[f-1])return s[f-1].evaluate(e);const g=ba(r,u),v=Ds.interpolationFactor(this.interpolation,u,r[g],r[g+1]),C=s[g].evaluate(e),T=s[g+1].evaluate(e);return"interpolate"===this.operator?R[this.type.kind.toLowerCase()](C,T,v):"interpolate-hcl"===this.operator?is.reverse(is.interpolate(is.forward(C),is.forward(T),v)):rs.reverse(rs.interpolate(rs.forward(C),rs.forward(T),v))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r}}function La(n,e,r,s){const u=s-r,f=n-r;return 0===u?0:1===e?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var Jo=Ds;class il{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let s=null;const u=r.expectedType;u&&"value"!==u.kind&&(s=u);const f=[];for(const v of e.slice(1)){const C=r.parse(v,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!C)return null;s=s||C.type,f.push(C)}const g=u&&f.some(v=>cr(u,v.type));return new il(g?Ve:s,f)}evaluate(e){let r,s=null,u=0;for(const f of this.args){if(u++,s=f.evaluate(e),s&&s instanceof So&&!s.available&&(r||(r=s),s=null,u===this.args.length))return r;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Vl=il;class wa{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const g=e[f];if("string"!=typeof g)return r.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return r.error("Variable names must contain only alphanumeric characters or '_'.",f);const v=r.parse(e[f+1],f+1);if(!v)return null;s.push([g,v])}const u=r.parse(e[e.length-1],e.length-1,r.expectedType,s);return u?new wa(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,s]of this.bindings)e.push(r,s.serialize());return e.push(this.result.serialize()),e}}var xl=wa;class Fa{constructor(e,r,s){this.type=e,this.index=r,this.input=s}static parse(e,r){if(3!==e.length)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,qn),u=r.parse(e[2],2,xn(r.expectedType||Ve));return s&&u?new Fa(u.type.itemType,s,u):null}evaluate(e){const r=this.index.evaluate(e),s=this.input.evaluate(e);if(r<0)throw new xr(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new xr(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new xr(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Ul=Fa;class Ls{constructor(e,r){this.type=fe,this.needle=e,this.haystack=r}static parse(e,r){if(3!==e.length)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Ve),u=r.parse(e[2],2,Ve);return s&&u?Tr(s.type,[fe,Cr,qn,No,Ve])?new Ls(s,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${pn(s.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!kr(r,["boolean","string","number","null"]))throw new xr(`Expected first argument to be of type boolean, string, number or null, but found ${pn(Ni(r))} instead.`);if(!kr(s,["string","array"]))throw new xr(`Expected second argument to be of type array or string, but found ${pn(Ni(s))} instead.`);return s.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Gs=Ls;class ho{constructor(e,r,s){this.type=qn,this.needle=e,this.haystack=r,this.fromIndex=s}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Ve),u=r.parse(e[2],2,Ve);if(!s||!u)return null;if(!Tr(s.type,[fe,Cr,qn,No,Ve]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${pn(s.type)} instead`);if(4===e.length){const f=r.parse(e[3],3,qn);return f?new ho(s,u,f):null}return new ho(s,u)}evaluate(e){const r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!kr(r,["boolean","string","number","null"]))throw new xr(`Expected first argument to be of type boolean, string, number or null, but found ${pn(Ni(r))} instead.`);if(!kr(s,["string","array"]))throw new xr(`Expected second argument to be of type array or string, but found ${pn(Ni(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return s.indexOf(r,u)}return s.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Fs=ho;class bl{constructor(e,r,s,u,f,g){this.inputType=e,this.type=r,this.input=s,this.cases=u,this.outputs=f,this.otherwise=g}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let s,u;r.expectedType&&"value"!==r.expectedType.kind&&(u=r.expectedType);const f={},g=[];for(let T=2;T<e.length-1;T+=2){let F=e[T];const V=e[T+1];Array.isArray(F)||(F=[F]);const j=r.concat(T);if(0===F.length)return j.error("Expected at least one branch label.");for(const Q of F){if("number"!=typeof Q&&"string"!=typeof Q)return j.error("Branch labels must be numbers or strings.");if("number"==typeof Q&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Q&&Math.floor(Q)!==Q)return j.error("Numeric branch labels must be integer values.");if(s){if(j.checkSubtype(s,Ni(Q)))return null}else s=Ni(Q);if(void 0!==f[String(Q)])return j.error("Branch labels must be unique.");f[String(Q)]=g.length}const Z=r.parse(V,T,u);if(!Z)return null;u=u||Z.type,g.push(Z)}const v=r.parse(e[1],1,Ve);if(!v)return null;const C=r.parse(e[e.length-1],e.length-1,u);return C?"value"!==v.type.kind&&r.concat(1).checkSubtype(s,v.type)?null:new bl(s,u,v,f,g,C):null}evaluate(e){const r=this.input.evaluate(e);return(Ni(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),s=[],u={};for(const g of r){const v=u[this.cases[g]];void 0===v?(u[this.cases[g]]=s.length,s.push([this.cases[g],[g]])):s[v][1].push(g)}const f=g=>"number"===this.inputType.kind?Number(g):g;for(const[g,v]of s)e.push(1===v.length?f(v[0]):v.map(f)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}var jl=bl;class ol{constructor(e,r,s){this.type=e,this.branches=r,this.otherwise=s}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&"value"!==r.expectedType.kind&&(s=r.expectedType);const u=[];for(let g=1;g<e.length-1;g+=2){const v=r.parse(e[g],g,fe);if(!v)return null;const C=r.parse(e[g+1],g+1,s);if(!C)return null;u.push([v,C]),s=s||C.type}const f=r.parse(e[e.length-1],e.length-1,s);return f?new ol(s,u,f):null}evaluate(e){for(const[r,s]of this.branches)if(r.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,s]of this.branches)e(r),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var sl=ol;class al{constructor(e,r,s,u){this.type=e,this.input=r,this.beginIndex=s,this.endIndex=u}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Ve),u=r.parse(e[2],2,qn);if(!s||!u)return null;if(!Tr(s.type,[xn(Ve),Cr,Ve]))return r.error(`Expected first argument to be of type array or string, but found ${pn(s.type)} instead`);if(4===e.length){const f=r.parse(e[3],3,qn);return f?new al(s.type,s,u,f):null}return new al(s.type,s,u)}evaluate(e){const r=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!kr(r,["string","array"]))throw new xr(`Expected first argument to be of type array or string, but found ${pn(Ni(r))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return r.slice(s,u)}return r.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var dc=al;function fa(n,e){return"=="===n||"!="===n?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ws(n,e,r,s){return 0===s.compare(e,r)}function ll(n,e,r){const s="=="!==n&&"!="!==n;return class qb{constructor(f,g,v){this.type=fe,this.lhs=f,this.rhs=g,this.collator=v,this.hasUntypedArgument="value"===f.type.kind||"value"===g.type.kind}static parse(f,g){if(3!==f.length&&4!==f.length)return g.error("Expected two or three arguments.");const v=f[0];let C=g.parse(f[1],1,Ve);if(!C)return null;if(!fa(v,C.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${pn(C.type)}'.`);let T=g.parse(f[2],2,Ve);if(!T)return null;if(!fa(v,T.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${pn(T.type)}'.`);if(C.type.kind!==T.type.kind&&"value"!==C.type.kind&&"value"!==T.type.kind)return g.error(`Cannot compare types '${pn(C.type)}' and '${pn(T.type)}'.`);s&&("value"===C.type.kind&&"value"!==T.type.kind?C=new zo(T.type,[C]):"value"!==C.type.kind&&"value"===T.type.kind&&(T=new zo(C.type,[T])));let F=null;if(4===f.length){if("string"!==C.type.kind&&"string"!==T.type.kind&&"value"!==C.type.kind&&"value"!==T.type.kind)return g.error("Cannot use collator to compare non-string types.");if(F=g.parse(f[3],3,St),!F)return null}return new qb(C,T,F)}evaluate(f){const g=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const C=Ni(g),T=Ni(v);if(C.kind!==T.kind||"string"!==C.kind&&"number"!==C.kind)throw new xr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${C.kind}, ${T.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const C=Ni(g),T=Ni(v);if("string"!==C.kind||"string"!==T.kind)return e(f,g,v)}return this.collator?r(f,g,v,this.collator.evaluate(f)):e(f,g,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[n];return this.eachChild(g=>{f.push(g.serialize())}),f}}}const qa=ll("==",function(n,e,r){return e===r},Ws),hc=ll("!=",function(n,e,r){return e!==r},function(n,e,r,s){return!Ws(0,e,r,s)}),Ic=ll("<",function(n,e,r){return e<r},function(n,e,r,s){return s.compare(e,r)<0}),Mc=ll(">",function(n,e,r){return e>r},function(n,e,r,s){return s.compare(e,r)>0}),fc=ll("<=",function(n,e,r){return e<=r},function(n,e,r,s){return s.compare(e,r)<=0}),Hl=ll(">=",function(n,e,r){return e>=r},function(n,e,r,s){return s.compare(e,r)>=0});class Ea{constructor(e,r,s,u,f,g){this.type=Cr,this.number=e,this.locale=r,this.currency=s,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(e,r){if(3!==e.length)return r.error("Expected two arguments.");const s=r.parse(e[1],1,qn);if(!s)return null;const u=e[2];if("object"!=typeof u||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=r.parse(u.locale,1,Cr),!f))return null;let g=null;if(u.currency&&(g=r.parse(u.currency,1,Cr),!g))return null;let v=null;if(u.unit&&(v=r.parse(u.unit,1,Cr),!v))return null;let C=null;if(u["min-fraction-digits"]&&(C=r.parse(u["min-fraction-digits"],1,qn),!C))return null;let T=null;return u["max-fraction-digits"]&&(T=r.parse(u["max-fraction-digits"],1,qn),!T)?null:new Ea(s,f,g,v,C,T)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Qs{constructor(e){this.type=qn,this.input=e}static parse(e,r){if(2!==e.length)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=r.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?r.error(`Expected argument of type string or array, but found ${pn(s.type)} instead.`):new Qs(s):null}evaluate(e){const r=this.input.evaluate(e);if("string"==typeof r||Array.isArray(r))return r.length;throw new xr(`Expected value to be of type string or array, but found ${pn(Ni(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const Ba={"==":qa,"!=":hc,">":Mc,"<":Ic,">=":Hl,"<=":fc,array:zo,at:Ul,boolean:zo,case:sl,coalesce:Vl,collator:Ui,format:Ii,image:Ms,in:Gs,"index-of":Fs,interpolate:Jo,"interpolate-hcl":Jo,"interpolate-lab":Jo,length:Qs,let:xl,literal:rr,match:jl,number:zo,"number-format":Ea,object:zo,slice:dc,step:P,string:zo,"to-boolean":Vo,"to-color":Vo,"to-number":Vo,"to-string":Vo,var:gs,within:so};function Na(n,[e,r,s,u]){e=e.evaluate(n),r=r.evaluate(n),s=s.evaluate(n);const f=u?u.evaluate(n):1,g=Ks(e,r,s,f);if(g)throw new xr(g);return new Zr(e/255*f,r/255*f,s/255*f,f)}function Qo(n,e){return n in e}function ea(n,e){const r=e[n];return void 0===r?null:r}function N(n){return{type:n}}_o.register(Ba,{error:[{kind:"error"},[Cr],(n,[e])=>{throw new xr(e.evaluate(n))}],typeof:[Cr,[Ve],(n,[e])=>pn(Ni(e.evaluate(n)))],"to-rgba":[xn(qn,4),[je],(n,[e])=>e.evaluate(n).toArray()],rgb:[je,[qn,qn,qn],Na],rgba:[je,[qn,qn,qn,qn],Na],has:{type:fe,overloads:[[[Cr],(n,[e])=>Qo(e.evaluate(n),n.properties())],[[Cr,Ce],(n,[e,r])=>Qo(e.evaluate(n),r.evaluate(n))]]},get:{type:Ve,overloads:[[[Cr],(n,[e])=>ea(e.evaluate(n),n.properties())],[[Cr,Ce],(n,[e,r])=>ea(e.evaluate(n),r.evaluate(n))]]},"feature-state":[Ve,[Cr],(n,[e])=>ea(e.evaluate(n),n.featureState||{})],properties:[Ce,[],n=>n.properties()],"geometry-type":[Cr,[],n=>n.geometryType()],id:[Ve,[],n=>n.id()],zoom:[qn,[],n=>n.globals.zoom],pitch:[qn,[],n=>n.globals.pitch||0],"distance-from-center":[qn,[],n=>n.distanceFromCenter()],"heatmap-density":[qn,[],n=>n.globals.heatmapDensity||0],"line-progress":[qn,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[qn,[],n=>n.globals.skyRadialProgress||0],accumulated:[Ve,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[qn,N(qn),(n,e)=>{let r=0;for(const s of e)r+=s.evaluate(n);return r}],"*":[qn,N(qn),(n,e)=>{let r=1;for(const s of e)r*=s.evaluate(n);return r}],"-":{type:qn,overloads:[[[qn,qn],(n,[e,r])=>e.evaluate(n)-r.evaluate(n)],[[qn],(n,[e])=>-e.evaluate(n)]]},"/":[qn,[qn,qn],(n,[e,r])=>e.evaluate(n)/r.evaluate(n)],"%":[qn,[qn,qn],(n,[e,r])=>e.evaluate(n)%r.evaluate(n)],ln2:[qn,[],()=>Math.LN2],pi:[qn,[],()=>Math.PI],e:[qn,[],()=>Math.E],"^":[qn,[qn,qn],(n,[e,r])=>Math.pow(e.evaluate(n),r.evaluate(n))],sqrt:[qn,[qn],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[qn,[qn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[qn,[qn],(n,[e])=>Math.log(e.evaluate(n))],log2:[qn,[qn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[qn,[qn],(n,[e])=>Math.sin(e.evaluate(n))],cos:[qn,[qn],(n,[e])=>Math.cos(e.evaluate(n))],tan:[qn,[qn],(n,[e])=>Math.tan(e.evaluate(n))],asin:[qn,[qn],(n,[e])=>Math.asin(e.evaluate(n))],acos:[qn,[qn],(n,[e])=>Math.acos(e.evaluate(n))],atan:[qn,[qn],(n,[e])=>Math.atan(e.evaluate(n))],min:[qn,N(qn),(n,e)=>Math.min(...e.map(r=>r.evaluate(n)))],max:[qn,N(qn),(n,e)=>Math.max(...e.map(r=>r.evaluate(n)))],abs:[qn,[qn],(n,[e])=>Math.abs(e.evaluate(n))],round:[qn,[qn],(n,[e])=>{const r=e.evaluate(n);return r<0?-Math.round(-r):Math.round(r)}],floor:[qn,[qn],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[qn,[qn],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[fe,[Cr,Ve],(n,[e,r])=>n.properties()[e.value]===r.value],"filter-id-==":[fe,[Ve],(n,[e])=>n.id()===e.value],"filter-type-==":[fe,[Cr],(n,[e])=>n.geometryType()===e.value],"filter-<":[fe,[Cr,Ve],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s<u}],"filter-id-<":[fe,[Ve],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r<s}],"filter->":[fe,[Cr,Ve],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s>u}],"filter-id->":[fe,[Ve],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r>s}],"filter-<=":[fe,[Cr,Ve],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[fe,[Ve],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r<=s}],"filter->=":[fe,[Cr,Ve],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[fe,[Ve],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r>=s}],"filter-has":[fe,[Ve],(n,[e])=>e.value in n.properties()],"filter-has-id":[fe,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[fe,[xn(Cr)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[fe,[xn(Ve)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[fe,[Cr,xn(Ve)],(n,[e,r])=>r.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[fe,[Cr,xn(Ve)],(n,[e,r])=>function(s,u,f,g){for(;f<=g;){const v=f+g>>1;if(u[v]===s)return!0;u[v]>s?g=v-1:f=v+1}return!1}(n.properties()[e.value],r.value,0,r.value.length-1)],all:{type:fe,overloads:[[[fe,fe],(n,[e,r])=>e.evaluate(n)&&r.evaluate(n)],[N(fe),(n,e)=>{for(const r of e)if(!r.evaluate(n))return!1;return!0}]]},any:{type:fe,overloads:[[[fe,fe],(n,[e,r])=>e.evaluate(n)||r.evaluate(n)],[N(fe),(n,e)=>{for(const r of e)if(r.evaluate(n))return!0;return!1}]]},"!":[fe,[fe],(n,[e])=>!e.evaluate(n)],"is-supported-script":[fe,[Cr],(n,[e])=>{const r=n.globals&&n.globals.isSupportedScript;return!r||r(e.evaluate(n))}],upcase:[Cr,[Cr],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Cr,[Cr],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Cr,N(Ve),(n,e)=>e.map(r=>Os(r.evaluate(n))).join("")],"resolved-locale":[Cr,[St],(n,[e])=>e.evaluate(n).resolvedLocale()]});var ee=Ba;function Ke(n){return{result:"success",value:n}}function Y(n){return{result:"error",value:n}}function Fe(n){return"data-driven"===n["property-type"]}function Et(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function wn(n){return!!n.expression&&n.expression.interpolated}function Mn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}function Dr(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}function xi(n){return n}function bi(n,e){const r="color"===e.type,s=n.stops&&"object"==typeof n.stops[0][0],u=s||!(s||void 0!==n.property),f=n.type||(wn(e)?"exponential":"interval");if(r&&((n=io({},n)).stops&&(n.stops=n.stops.map(T=>[T[0],Zr.parse(T[1])])),n.default=Zr.parse(n.default?n.default:e.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!Ko[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let g,v,C;if("exponential"===f)g=Li;else if("interval"===f)g=Di;else if("categorical"===f){g=to,v=Object.create(null);for(const T of n.stops)v[T[0]]=T[1];C=typeof n.stops[0][0]}else{if("identity"!==f)throw new Error(`Unknown function type "${f}"`);g=ko}if(s){const T={},F=[];for(let Z=0;Z<n.stops.length;Z++){const Q=n.stops[Z],ce=Q[0].zoom;void 0===T[ce]&&(T[ce]={zoom:ce,type:n.type,property:n.property,default:n.default,stops:[]},F.push(ce)),T[ce].stops.push([Q[0].value,Q[1]])}const V=[];for(const Z of F)V.push([T[Z].zoom,bi(T[Z],e)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Jo.interpolationFactor.bind(void 0,j),zoomStops:V.map(Z=>Z[0]),evaluate:({zoom:Z},Q)=>Li({stops:V,base:n.base},e,Z).evaluate(Z,Q)}}if(u){const T="exponential"===f?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Jo.interpolationFactor.bind(void 0,T),zoomStops:n.stops.map(F=>F[0]),evaluate:({zoom:F})=>g(n,e,F,v,C)}}return{kind:"source",evaluate(T,F){const V=F&&F.properties?F.properties[n.property]:void 0;return void 0===V?Br(n.default,e.default):g(n,e,V,v,C)}}}function Br(n,e,r){return void 0!==n?n:void 0!==e?e:void 0!==r?r:void 0}function to(n,e,r,s,u){return Br(typeof r===u?s[r]:void 0,n.default,e.default)}function Di(n,e,r){if("number"!==Mn(r))return Br(n.default,e.default);const s=n.stops.length;if(1===s||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[s-1][0])return n.stops[s-1][1];const u=ba(n.stops.map(f=>f[0]),r);return n.stops[u][1]}function Li(n,e,r){const s=void 0!==n.base?n.base:1;if("number"!==Mn(r))return Br(n.default,e.default);const u=n.stops.length;if(1===u||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[u-1][0])return n.stops[u-1][1];const f=ba(n.stops.map(F=>F[0]),r),g=function(F,V,j,Z){const Q=Z-j,ce=F-j;return 0===Q?0:1===V?ce/Q:(Math.pow(V,ce)-1)/(Math.pow(V,Q)-1)}(r,s,n.stops[f][0],n.stops[f+1][0]),v=n.stops[f][1],C=n.stops[f+1][1];let T=R[e.type]||xi;if(n.colorSpace&&"rgb"!==n.colorSpace){const F=Ko[n.colorSpace];T=(V,j)=>F.reverse(F.interpolate(F.forward(V),F.forward(j),g))}return"function"==typeof v.evaluate?{evaluate(...F){const V=v.evaluate.apply(void 0,F),j=C.evaluate.apply(void 0,F);if(void 0!==V&&void 0!==j)return T(V,j,g)}}:T(v,C,g)}function ko(n,e,r){return"color"===e.type?r=Zr.parse(r):"formatted"===e.type?r=Pi.fromString(r.toString()):"resolvedImage"===e.type?r=So.fromString(r.toString()):Mn(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Br(r,n.default,e.default)}class Ps{constructor(e,r){var s;this.expression=e,this._warningHistory={},this._evaluator=new ks,this._defaultValue=r?"color"===(s=r).type&&(Dr(s.default)||Array.isArray(s.default))?new Zr(0,0,0,0):"color"===s.type?Zr.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=r&&"enum"===r.type?r.values:null}evaluateWithoutErrorHandling(e,r,s,u,f,g,v,C){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,s,u,f,g,v,C){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=C||null;try{const T=this.expression.evaluate(this._evaluator);if(null==T||"number"==typeof T&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new xr(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function ta(n){return Array.isArray(n)&&n.length>0&&"string"==typeof n[0]&&n[0]in ee}function Yi(n,e){const r=new Xo(ee,[],e?function(u){const f={color:je,string:Cr,number:qn,enum:Cr,boolean:fe,formatted:zt,resolvedImage:fn};return"array"===u.type?xn(f[u.value]||Ve,u.length):f[u.type]}(e):void 0),s=r.parse(n,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?Ke(new Ps(s,e)):Y(r.errors)}class _s{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent="constant"!==e&&!Bi(r.expression)}evaluateWithoutErrorHandling(e,r,s,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,f,g)}evaluate(e,r,s,u,f,g){return this._styleExpression.evaluate(e,r,s,u,f,g)}}class Cs{constructor(e,r,s,u){this.kind=e,this.zoomStops=s,this._styleExpression=r,this.isStateDependent="camera"!==e&&!Bi(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,r,s,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,f,g)}evaluate(e,r,s,u,f,g){return this._styleExpression.evaluate(e,r,s,u,f,g)}interpolationFactor(e,r,s){return this.interpolationType?Jo.interpolationFactor(this.interpolationType,e,r,s):0}}function aa(n,e){if("error"===(n=Yi(n,e)).result)return n;const r=n.value.expression,s=xa(r);if(!s&&!Fe(e))return Y([new Vi("","data expressions not supported")]);const u=Zi(r,["zoom","pitch","distance-from-center"]);if(!u&&!Et(e))return Y([new Vi("","zoom expressions not supported")]);const f=cl(r);return f||u?f instanceof Vi?Y([f]):f instanceof Jo&&!wn(e)?Y([new Vi("",'"interpolate" expressions cannot be used with this property')]):Ke(f?new Cs(s?"camera":"composite",n.value,f.labels,f instanceof Jo?f.interpolation:void 0):new _s(s?"constant":"source",n.value)):Y([new Vi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Gl{constructor(e,r){this._parameters=e,this._specification=r,io(this,bi(this._parameters,this._specification))}static deserialize(e){return new Gl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function cl(n){let e=null;if(n instanceof xl)e=cl(n.result);else if(n instanceof Vl){for(const r of n.args)if(e=cl(r),e)break}else(n instanceof P||n instanceof Jo)&&n.input instanceof _o&&"zoom"===n.input.name&&(e=n);return e instanceof Vi||n.eachChild(r=>{const s=cl(r);s instanceof Vi?e=s:!e&&s?e=new Vi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Vi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class or{constructor(e,r,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),null!=r&&r.__line__&&(this.line=r.__line__)}}function la(n){const e=n.key,r=n.value,s=n.valueSpec||{},u=n.objectElementValidators||{},f=n.style,g=n.styleSpec;let v=[];const C=Mn(r);if("object"!==C)return[new or(e,r,`object expected, ${C} found`)];for(const T in r){const F=T.split(".")[0];let V;u[F]?V=u[F]:s[F]?V=Ss:u["*"]?V=u["*"]:s["*"]&&(V=Ss),V?v=v.concat(V({key:(e&&`${e}.`)+T,value:r[T],valueSpec:s[F]||s["*"],style:f,styleSpec:g,object:r,objectKey:T},r)):v.push(new or(e,r[T],`unknown property "${T}"`))}for(const T in s)u[T]||s[T].required&&void 0===s[T].default&&void 0===r[T]&&v.push(new or(e,r,`missing required property "${T}"`));return v}function ei(n){const e=n.value,r=n.valueSpec,s=n.style,u=n.styleSpec,f=n.key,g=n.arrayElementValidator||Ss;if("array"!==Mn(e))return[new or(f,e,`array expected, ${Mn(e)} found`)];if(r.length&&e.length!==r.length)return[new or(f,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new or(f,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let v={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};u.$version<7&&(v.function=r.function),"object"===Mn(r.value)&&(v=r.value);let C=[];for(let T=0;T<e.length;T++)C=C.concat(g({array:e,arrayIndex:T,value:e[T],valueSpec:v,style:s,styleSpec:u,key:`${f}[${T}]`}));return C}function Za(n){const e=n.key,r=n.value,s=n.valueSpec;let u=Mn(r);if("number"===u&&r!=r&&(u="NaN"),"number"!==u)return[new or(e,r,`number expected, ${u} found`)];if("minimum"in s){let f=s.minimum;if("array"===Mn(s.minimum)&&(f=s.minimum[n.arrayIndex]),r<f)return[new or(e,r,`${r} is less than the minimum value ${f}`)]}if("maximum"in s){let f=s.maximum;if("array"===Mn(s.maximum)&&(f=s.maximum[n.arrayIndex]),r>f)return[new or(e,r,`${r} is greater than the maximum value ${f}`)]}return[]}function wl(n){const e=n.valueSpec,r=wi(n.value.type);let s,u,f,g={};const v="categorical"!==r&&void 0===n.value.property,C=!v,T="array"===Mn(n.value.stops)&&"array"===Mn(n.value.stops[0])&&"object"===Mn(n.value.stops[0][0]),F=la({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(Z){if("identity"===r)return[new or(Z.key,Z.value,'identity function may not have a "stops" property')];let Q=[];const ce=Z.value;return Q=Q.concat(ei({key:Z.key,value:ce,valueSpec:Z.valueSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:V})),"array"===Mn(ce)&&0===ce.length&&Q.push(new or(Z.key,ce,"array must have at least one stop")),Q},default:function(Z){return Ss({key:Z.key,value:Z.value,valueSpec:e,style:Z.style,styleSpec:Z.styleSpec})}}});return"identity"===r&&v&&F.push(new or(n.key,n.value,'missing required property "property"')),"identity"===r||n.value.stops||F.push(new or(n.key,n.value,'missing required property "stops"')),"exponential"===r&&n.valueSpec.expression&&!wn(n.valueSpec)&&F.push(new or(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(C&&!Fe(n.valueSpec)?F.push(new or(n.key,n.value,"property functions not supported")):v&&!Et(n.valueSpec)&&F.push(new or(n.key,n.value,"zoom functions not supported"))),"categorical"!==r&&!T||void 0!==n.value.property||F.push(new or(n.key,n.value,'"property" property is required')),F;function V(Z){let Q=[];const ce=Z.value,Te=Z.key;if("array"!==Mn(ce))return[new or(Te,ce,`array expected, ${Mn(ce)} found`)];if(2!==ce.length)return[new or(Te,ce,`array length 2 expected, length ${ce.length} found`)];if(T){if("object"!==Mn(ce[0]))return[new or(Te,ce,`object expected, ${Mn(ce[0])} found`)];if(void 0===ce[0].zoom)return[new or(Te,ce,"object stop key must have zoom")];if(void 0===ce[0].value)return[new or(Te,ce,"object stop key must have value")];const He=wi(ce[0].zoom);if("number"!=typeof He)return[new or(Te,ce[0].zoom,"stop zoom values must be numbers")];if(f&&f>He)return[new or(Te,ce[0].zoom,"stop zoom values must appear in ascending order")];He!==f&&(f=He,u=void 0,g={}),Q=Q.concat(la({key:`${Te}[0]`,value:ce[0],valueSpec:{zoom:{}},style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:Za,value:j}}))}else Q=Q.concat(j({key:`${Te}[0]`,value:ce[0],valueSpec:{},style:Z.style,styleSpec:Z.styleSpec},ce));return ta(oi(ce[1]))?Q.concat([new or(`${Te}[1]`,ce[1],"expressions are not allowed in function stops.")]):Q.concat(Ss({key:`${Te}[1]`,value:ce[1],valueSpec:e,style:Z.style,styleSpec:Z.styleSpec}))}function j(Z,Q){const ce=Mn(Z.value),Te=wi(Z.value),He=null!==Z.value?Z.value:Q;if(s){if(ce!==s)return[new or(Z.key,He,`${ce} stop domain type must match previous stop domain type ${s}`)]}else s=ce;if("number"!==ce&&"string"!==ce&&"boolean"!==ce&&"number"!=typeof Te&&"string"!=typeof Te&&"boolean"!=typeof Te)return[new or(Z.key,He,"stop domain value must be a number, string, or boolean")];if("number"!==ce&&"categorical"!==r){let st=`number expected, ${ce} found`;return Fe(e)&&void 0===r&&(st+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new or(Z.key,He,st)]}return"categorical"!==r||"number"!==ce||"number"==typeof Te&&isFinite(Te)&&Math.floor(Te)===Te?"categorical"!==r&&"number"===ce&&"number"==typeof Te&&"number"==typeof u&&void 0!==u&&Te<u?[new or(Z.key,He,"stop domain values must appear in ascending order")]:(u=Te,"categorical"===r&&Te in g?[new or(Z.key,He,"stop domain values must be unique")]:(g[Te]=!0,[])):[new or(Z.key,He,`integer expected, found ${String(Te)}`)]}}function ys(n){const e=("property"===n.expressionContext?aa:Yi)(oi(n.value),n.valueSpec);if("error"===e.result)return e.value.map(s=>new or(`${n.key}${s.key}`,n.value,s.message));const r=e.value.expression||e.value._styleExpression.expression;if("property"===n.expressionContext&&"text-font"===n.propertyKey&&!r.outputDefined())return[new or(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===n.expressionContext&&"layout"===n.propertyType&&!Bi(r))return[new or(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===n.expressionContext)return Ya(r,n);if(n.expressionContext&&0===n.expressionContext.indexOf("cluster")){if(!Zi(r,["zoom","feature-state"]))return[new or(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===n.expressionContext&&!xa(r))return[new or(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ya(n,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)r.delete(u);if(0===r.size)return[];const s=[];return n instanceof _o&&r.has(n.name)?[new or(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(u=>{s.push(...Ya(u,e))}),s)}function Bs(n){const e=n.key,r=n.value,s=n.valueSpec,u=[];return Array.isArray(s.values)?-1===s.values.indexOf(wi(r))&&u.push(new or(e,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(s.values).indexOf(wi(r))&&u.push(new or(e,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function Wl(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!Wl(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Da(n,e="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Wl(n)||(n=ri(n));const r=n;let s=!0;try{s=function(T){if(!za(T))return T;let F=oi(T);return ql(F),F=au(F),F}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const u=cn[`filter_${e}`],f=Yi(s,u);let g=null;if("error"===f.result)throw new Error(f.value.map(T=>`${T.key}: ${T.message}`).join(", "));g=(T,F,V)=>f.value.evaluate(T,F,{},V);let v=null,C=null;if(s!==r){const T=Yi(r,u);if("error"===T.result)throw new Error(T.value.map(F=>`${F.key}: ${F.message}`).join(", "));v=(F,V,j,Z,Q)=>T.value.evaluate(F,V,{},j,void 0,void 0,Z,Q),C=!xa(T.value.expression)}return{filter:g,dynamicFilter:v||void 0,needGeometry:Nn(s),needFeature:!!C}}function au(n){if(!Array.isArray(n))return n;const e=function(r){if(Zl.has(r[0]))for(let s=1;s<r.length;s++)if(za(r[s]))return!0;return r}(n);return!0===e?e:e.map(r=>au(r))}function ql(n){let e=!1;const r=[];if("case"===n[0]){for(let s=1;s<n.length-1;s+=2)e=e||za(n[s]),r.push(n[s+1]);r.push(n[n.length-1])}else if("match"===n[0]){e=e||za(n[1]);for(let s=2;s<n.length-1;s+=2)r.push(n[s+1]);r.push(n[n.length-1])}else if("step"===n[0]){e=e||za(n[1]);for(let s=1;s<n.length-1;s+=2)r.push(n[s+1])}e&&(n.length=0,n.push("any",...r));for(let s=1;s<n.length;s++)ql(n[s])}function za(n){if(!Array.isArray(n))return!1;if("pitch"===(e=n[0])||"distance-from-center"===e)return!0;var e;for(let r=1;r<n.length;r++)if(za(n[r]))return!0;return!1}const Zl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function pc(n,e){return n<e?-1:n>e?1:0}function Nn(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let e=1;e<n.length;e++)if(Nn(n[e]))return!0;return!1}function ri(n){if(!n)return!0;const e=n[0];return n.length<=1?"any"!==e:"=="===e?Ca(n[1],n[2],"=="):"!="===e?Dl(Ca(n[1],n[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Ca(n[1],n[2],e):"any"===e?(r=n.slice(1),["any"].concat(r.map(ri))):"all"===e?["all"].concat(n.slice(1).map(ri)):"none"===e?["all"].concat(n.slice(1).map(ri).map(Dl)):"in"===e?El(n[1],n.slice(2)):"!in"===e?Dl(El(n[1],n.slice(2))):"has"===e?ds(n[1]):"!has"===e?Dl(ds(n[1])):"within"!==e||n;var r}function Ca(n,e,r){switch(n){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,n,e]}}function El(n,e){if(0===e.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",n,["literal",e.sort(pc)]]:["filter-in-small",n,["literal",e]]}}function ds(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Dl(n){return["!",n]}function $a(n){return Wl(oi(n.value))?ys(io({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):na(n)}function na(n){const e=n.value,r=n.key;if("array"!==Mn(e))return[new or(r,e,`array expected, ${Mn(e)} found`)];const s=n.styleSpec;let u,f=[];if(e.length<1)return[new or(r,e,"filter array must have at least 1 element")];switch(f=f.concat(Bs({key:`${r}[0]`,value:e[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),wi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===wi(e[1])&&f.push(new or(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&f.push(new or(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Mn(e[1]),"string"!==u&&f.push(new or(`${r}[1]`,e[1],`string expected, ${u} found`)));for(let g=2;g<e.length;g++)u=Mn(e[g]),"$type"===wi(e[1])?f=f.concat(Bs({key:`${r}[${g}]`,value:e[g],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==u&&"number"!==u&&"boolean"!==u&&f.push(new or(`${r}[${g}]`,e[g],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)f=f.concat(na({key:`${r}[${g}]`,value:e[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Mn(e[1]),2!==e.length?f.push(new or(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==u&&f.push(new or(`${r}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Mn(e[1]),2!==e.length?f.push(new or(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==u&&f.push(new or(`${r}[1]`,e[1],`object expected, ${u} found`))}return f}function Yl(n,e){const r=n.key,s=n.style,u=n.styleSpec,f=n.value,g=n.objectKey,v=u[`${e}_${n.layerType}`];if(!v)return[];const C=g.match(/^(.*)-transition$/);if("paint"===e&&C&&v[C[1]]&&v[C[1]].transition)return Ss({key:r,value:f,valueSpec:u.transition,style:s,styleSpec:u});const T=n.valueSpec||v[g];if(!T)return[new or(r,f,`unknown property "${g}"`)];let F;if("string"===Mn(f)&&Fe(T)&&!T.tokens&&(F=/^{([^}]+)}$/.exec(f))){const j=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new or(r,f,`"${g}" does not support interpolation syntax\nUse an identity property function instead: ${j}.`)]}const V=[];return"symbol"===n.layerType&&("text-field"===g&&s&&!s.glyphs&&V.push(new or(r,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&Dr(oi(f))&&"identity"===wi(f.type)&&V.push(new or(r,f,'"text-font" does not support identity functions'))),V.concat(Ss({key:n.key,value:f,valueSpec:T,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:g}))}function Ac(n){return Yl(n,"paint")}function mc(n){return Yl(n,"layout")}function zu(n){let e=[];const r=n.value,s=n.key,u=n.style,f=n.styleSpec;r.type||r.ref||e.push(new or(s,r,'either "type" or "ref" is required'));let g=wi(r.type);const v=wi(r.ref);if(r.id){const C=wi(r.id);for(let T=0;T<n.arrayIndex;T++){const F=u.layers[T];wi(F.id)===C&&e.push(new or(s,r.id,`duplicate layer id "${r.id}", previously used at line ${F.id.__line__}`))}}if("ref"in r){let C;["type","source","source-layer","filter","layout"].forEach(T=>{T in r&&e.push(new or(s,r[T],`"${T}" is prohibited for ref layers`))}),u.layers.forEach(T=>{wi(T.id)===v&&(C=T)}),C?C.ref?e.push(new or(s,r.ref,"ref cannot reference another ref layer")):g=wi(C.type):"string"==typeof v&&e.push(new or(s,r.ref,`ref layer "${v}" not found`))}else if("background"!==g&&"sky"!==g)if(r.source){const C=u.sources&&u.sources[r.source],T=C&&wi(C.type);C?"vector"===T&&"raster"===g?e.push(new or(s,r.source,`layer "${r.id}" requires a raster source`)):"raster"===T&&"raster"!==g?e.push(new or(s,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==T||r["source-layer"]?"raster-dem"===T&&"hillshade"!==g?e.push(new or(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==g||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===T&&C.lineMetrics||e.push(new or(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new or(s,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new or(s,r.source,`source "${r.source}" not found`))}else e.push(new or(s,r,'missing required property "source"'));return e=e.concat(la({key:s,value:r,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ss({key:`${s}.type`,value:r.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,object:r,objectKey:"type"}),filter:C=>$a(io({layerType:g},C)),layout:C=>la({layer:r,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":T=>mc(io({layerType:g},T))}}),paint:C=>la({layer:r,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":T=>Ac(io({layerType:g},T))}})}})),e}function Va(n){const e=n.value,r=n.key,s=Mn(e);return"string"!==s?[new or(r,e,`string expected, ${s} found`)]:[]}const Ts={promoteId:function({key:n,value:e}){if("string"===Mn(e))return Va({key:n,value:e});{const r=[];for(const s in e)r.push(...Va({key:`${n}.${s}`,value:e[s]}));return r}}};function Ta(n){const e=n.value,r=n.key,s=n.styleSpec,u=n.style;if(!e.type)return[new or(r,e,'"type" is required')];const f=wi(e.type);let g;switch(f){case"vector":case"raster":case"raster-dem":return g=la({key:r,value:e,valueSpec:s[`source_${f.replace("-","_")}`],style:n.style,styleSpec:s,objectElementValidators:Ts}),g;case"geojson":if(g=la({key:r,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:Ts}),e.cluster)for(const v in e.clusterProperties){const[C,T]=e.clusterProperties[v],F="string"==typeof C?[C,["accumulated"],["get",v]]:C;g.push(...ys({key:`${r}.${v}.map`,value:T,expressionContext:"cluster-map"})),g.push(...ys({key:`${r}.${v}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return g;case"video":return la({key:r,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return la({key:r,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new or(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bs({key:`${r}.type`,value:e.type,valueSpec:{values:Cl(s)},style:u,styleSpec:s})}}function Cl(n){return n.source.reduce((e,r)=>{const s=n[r];return"enum"===s.type.type&&(e=e.concat(Object.keys(s.type.values))),e},[])}function Xa(n){const e=n.value,r=n.styleSpec,s=r.light,u=n.style;let f=[];const g=Mn(e);if(void 0===e)return f;if("object"!==g)return f=f.concat([new or("light",e,`object expected, ${g} found`)]),f;for(const v in e){const C=v.match(/^(.*)-transition$/);f=f.concat(C&&s[C[1]]&&s[C[1]].transition?Ss({key:v,value:e[v],valueSpec:r.transition,style:u,styleSpec:r}):s[v]?Ss({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:r}):[new or(v,e[v],`unknown property "${v}"`)])}return f}function ca(n){const e=n.value,r=n.key,s=n.style,u=n.styleSpec,f=u.terrain;let g=[];const v=Mn(e);if(void 0===e)return g;if("object"!==v)return g=g.concat([new or("terrain",e,`object expected, ${v} found`)]),g;for(const C in e){const T=C.match(/^(.*)-transition$/);g=g.concat(T&&f[T[1]]&&f[T[1]].transition?Ss({key:C,value:e[C],valueSpec:u.transition,style:s,styleSpec:u}):f[C]?Ss({key:C,value:e[C],valueSpec:f[C],style:s,styleSpec:u}):[new or(C,e[C],`unknown property "${C}"`)])}if(e.source){const C=s.sources&&s.sources[e.source],T=C&&wi(C.type);C?"raster-dem"!==T&&g.push(new or(r,e.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):g.push(new or(r,e.source,`source "${e.source}" not found`))}else g.push(new or(r,e,'terrain is missing required property "source"'));return g}function Pc(n){const e=n.value,r=n.style,s=n.styleSpec,u=s.fog;let f=[];const g=Mn(e);if(void 0===e)return f;if("object"!==g)return f=f.concat([new or("fog",e,`object expected, ${g} found`)]),f;for(const v in e){const C=v.match(/^(.*)-transition$/);f=f.concat(C&&u[C[1]]&&u[C[1]].transition?Ss({key:v,value:e[v],valueSpec:s.transition,style:r,styleSpec:s}):u[v]?Ss({key:v,value:e[v],valueSpec:u[v],style:r,styleSpec:s}):[new or(v,e[v],`unknown property "${v}"`)])}return f}const Xl={"*":()=>[],array:ei,boolean:function(n){const e=n.value,r=n.key,s=Mn(e);return"boolean"!==s?[new or(r,e,`boolean expected, ${s} found`)]:[]},number:Za,color:function(n){const e=n.key,r=n.value,s=Mn(r);return"string"!==s?[new or(e,r,`color expected, ${s} found`)]:null===Ei(r)?[new or(e,r,`color expected, "${r}" found`)]:[]},enum:Bs,filter:$a,function:wl,layer:zu,object:la,source:Ta,light:Xa,terrain:ca,fog:Pc,string:Va,formatted:function(n){return 0===Va(n).length?[]:ys(n)},resolvedImage:function(n){return 0===Va(n).length?[]:ys(n)},projection:function(n){const e=n.value,r=n.styleSpec,s=r.projection,u=n.style;let f=[];const g=Mn(e);if("object"===g)for(const v in e)f=f.concat(Ss({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:r}));else"string"!==g&&(f=f.concat([new or("projection",e,`object or string expected, ${g} found`)]));return f}};function Ss(n){const e=n.value,r=n.valueSpec,s=n.styleSpec;return r.expression&&Dr(wi(e))?wl(n):r.expression&&ta(oi(e))?ys(n):r.type&&Xl[r.type]?Xl[r.type](n):la(io({},n,{valueSpec:r.type?s[r.type]:r}))}function md(n){const e=n.value,r=n.key,s=Va(n);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new or(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new or(r,e,'"glyphs" url must include a "{range}" token'))),s}function Kl(n,e=cn){return qs(Ss({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:md,"*":()=>[]}}))}const gc=n=>qs(Ac(n)),lu=n=>qs(mc(n));function qs(n){return n.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function Rc(n,e){let r=!1;if(e&&e.length)for(const s of e)n.fire(new qr(new Error(s.message))),r=!0;return r}var L=H,z=3;function H(n,e,r){var s=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var u=new Int32Array(this.arrayBuffer);n=u[0],this.d=(e=u[1])+2*(r=u[2]);for(var f=0;f<this.d*this.d;f++){var g=u[z+f],v=u[z+f+1];s.push(g===v?null:u.subarray(g,v))}var C=u[z+s.length+1];this.keys=u.subarray(u[z+s.length],C),this.bboxes=u.subarray(C),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var T=0;T<this.d*this.d;T++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=r,this.scale=e/n,this.uid=0;var F=r/e*n;this.min=-F,this.max=n+F}H.prototype.insert=function(n,e,r,s,u){this._forEachCell(e,r,s,u,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(u)},H.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},H.prototype._insertCell=function(n,e,r,s,u,f){this.cells[u].push(f)},H.prototype.query=function(n,e,r,s,u){var f=this.min,g=this.max;if(n<=f&&e<=f&&g<=r&&g<=s&&!u)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(n,e,r,s,this._queryCell,v,{},u),v},H.prototype._queryCell=function(n,e,r,s,u,f,g,v){var C=this.cells[u];if(null!==C)for(var T=this.keys,F=this.bboxes,V=0;V<C.length;V++){var j=C[V];if(void 0===g[j]){var Z=4*j;(v?v(F[Z+0],F[Z+1],F[Z+2],F[Z+3]):n<=F[Z+2]&&e<=F[Z+3]&&r>=F[Z+0]&&s>=F[Z+1])?(g[j]=!0,f.push(T[j])):g[j]=!1}}},H.prototype._forEachCell=function(n,e,r,s,u,f,g,v){for(var C=this._convertToCellCoord(n),T=this._convertToCellCoord(e),F=this._convertToCellCoord(r),V=this._convertToCellCoord(s),j=C;j<=F;j++)for(var Z=T;Z<=V;Z++){var Q=this.d*Z+j;if((!v||v(this._convertFromCellCoord(j),this._convertFromCellCoord(Z),this._convertFromCellCoord(j+1),this._convertFromCellCoord(Z+1)))&&u.call(this,n,e,r,s,Q,f,g,v))return}},H.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},H.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},H.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=z+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var u=new Int32Array(e+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,g=0;g<n.length;g++){var v=n[g];u[z+g]=f,u.set(v,f),f+=v.length}return u[z+n.length]=f,u.set(this.keys,f),u[z+n.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};var B=vt(L);const D={};function _(n,e,r={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),D[e]={klass:n,omit:r.omit||[]}}_(Object,"Object"),B.serialize=function(n,e){const r=n.toArrayBuffer();return e&&e.push(r),{buffer:r}},B.deserialize=function(n){return new B(n.buffer)},Object.defineProperty(B,"name",{value:"Grid"}),_(B,"Grid"),_(Zr,"Color"),_(Error,"Error"),_(vi,"AJAXError"),_(So,"ResolvedImage"),_(Gl,"StylePropertyFunction"),_(Ps,"StyleExpression",{omit:["_evaluator"]}),_(Cs,"ZoomDependentExpression"),_(_s,"ZoomConstantExpression"),_(_o,"CompoundExpression",{omit:["_evaluate"]});for(const n in ee)D[ee[n]._classRegistryKey]||_(ee[n],`Expression${n}`);function E(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function M(n){return ve.ImageBitmap&&n instanceof ve.ImageBitmap}function q(n,e){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(E(n)||M(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const r=n;return e&&e.push(r.buffer),r}if(n instanceof ve.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const r=[];for(const s of n)r.push(q(s,e));return r}if("object"==typeof n){const r=n.constructor,s=r._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const u=r.serialize?r.serialize(n,e):{};if(!r.serialize){for(const f in n)n.hasOwnProperty(f)&&(D[s].omit.indexOf(f)>=0||(u[f]=q(n[f],e)));n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof n)}function oe(n){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||E(n)||M(n)||ArrayBuffer.isView(n)||n instanceof ve.ImageData)return n;if(Array.isArray(n))return n.map(oe);if("object"==typeof n){const e=n.$name||"Object",{klass:r}=D[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(n);const s=Object.create(r.prototype);for(const u of Object.keys(n))"$name"!==u&&(s[u]=oe(n[u]));return s}throw new Error("can't deserialize object of type "+typeof n)}const ge={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function Oe(n){for(const e of n)if(sr(e.charCodeAt(0)))return!0;return!1}function Pt(n){for(const e of n)if(!Jt(e.charCodeAt(0)))return!1;return!0}function Jt(n){return!(ge.Arabic(n)||ge["Arabic Supplement"](n)||ge["Arabic Extended-A"](n)||ge["Arabic Presentation Forms-A"](n)||ge["Arabic Presentation Forms-B"](n))}function sr(n){return!(746!==n&&747!==n&&(n<4352||!(ge["Bopomofo Extended"](n)||ge.Bopomofo(n)||ge["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||ge["CJK Compatibility Ideographs"](n)||ge["CJK Compatibility"](n)||ge["CJK Radicals Supplement"](n)||ge["CJK Strokes"](n)||!(!ge["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||ge["CJK Unified Ideographs Extension A"](n)||ge["CJK Unified Ideographs"](n)||ge["Enclosed CJK Letters and Months"](n)||ge["Hangul Compatibility Jamo"](n)||ge["Hangul Jamo Extended-A"](n)||ge["Hangul Jamo Extended-B"](n)||ge["Hangul Jamo"](n)||ge["Hangul Syllables"](n)||ge.Hiragana(n)||ge["Ideographic Description Characters"](n)||ge.Kanbun(n)||ge["Kangxi Radicals"](n)||ge["Katakana Phonetic Extensions"](n)||ge.Katakana(n)&&12540!==n||!(!ge["Halfwidth and Fullwidth Forms"](n)||65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||!(!ge["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||ge["Unified Canadian Aboriginal Syllabics"](n)||ge["Unified Canadian Aboriginal Syllabics Extended"](n)||ge["Vertical Forms"](n)||ge["Yijing Hexagram Symbols"](n)||ge["Yi Syllables"](n)||ge["Yi Radicals"](n))))}function Qn(n){return!(sr(n)||(e=n,ge["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||ge["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||ge["Letterlike Symbols"](e)||ge["Number Forms"](e)||ge["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||ge["Control Pictures"](e)&&9251!==e||ge["Optical Character Recognition"](e)||ge["Enclosed Alphanumerics"](e)||ge["Geometric Shapes"](e)||ge["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ge["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ge["CJK Symbols and Punctuation"](e)||ge.Katakana(e)||ge["Private Use Area"](e)||ge["CJK Compatibility Forms"](e)||ge["Small Form Variants"](e)||ge["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Vr(n){return n>=1424&&n<=2303||ge["Arabic Presentation Forms-A"](n)||ge["Arabic Presentation Forms-B"](n)}function Hr(n,e){return!(!e&&Vr(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||ge.Khmer(n))}function Nr(n){for(const e of n)if(Vr(e.charCodeAt(0)))return!0;return!1}const zr="deferred",ti="loading",ai="loaded";let zi=null,h="unavailable",i=null;const c=function(n){n&&"string"==typeof n&&n.indexOf("NetworkError")>-1&&(h="error"),zi&&zi(n)};function p(){y.fire(new ui("pluginStateChange",{pluginStatus:h,pluginURL:i}))}const y=new Es,w=function(){return h},A=function(){if(h!==zr||!i)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");h=ti,p(),i&&Or({url:i},n=>{n?c(n):(h=ai,p())})},O={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>h===ai||null!=O.applyArabicShaping,isLoading:()=>h===ti,setState(n){h=n.pluginStatus,i=n.pluginURL},isParsed:()=>null!=O.applyArabicShaping&&null!=O.processBidirectionalText&&null!=O.processStyledBidirectionalText,getPluginURL:()=>i};class ${constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,s){for(const u of r)if(!Hr(u.charCodeAt(0),s))return!1;return!0}(e,O.isLoaded())}}class W{constructor(e,r){this.property=e,this.value=r,this.expression=function(s,u){if(Dr(s))return new Gl(s,u);if(ta(s)){const f=aa(s,u);if("error"===f.result)throw new Error(f.value.map(g=>`${g.key}: ${g.message}`).join(", "));return f.value}{let f=s;return"string"==typeof s&&"color"===u.type&&(f=Zr.parse(s)),{kind:"constant",evaluate:()=>f}}}(void 0===r?e.specification.default:r,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,r,s){return this.property.possiblyEvaluate(this,e,r,s)}}class G{constructor(e){this.property=e,this.value=new W(e,void 0)}transitioned(e,r){return new De(this.property,this.value,r,ue({},e.transition,this.transition),e.now)}untransitioned(){return new De(this.property,this.value,null,{},0)}}class ae{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Xt(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new G(this._values[e].property)),this._values[e].value=new W(this._values[e].property,null===r?void 0:Xt(r))}getTransition(e){return Xt(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new G(this._values[e].property)),this._values[e].transition=Xt(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(e[r]=s);const u=this.getTransition(r);void 0!==u&&(e[`${r}-transition`]=u)}return e}transitioned(e,r){const s=new ye(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,r._values[u]);return s}untransitioned(){const e=new ye(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class De{constructor(e,r,s,u,f){const g=u.delay||0,v=u.duration||0;f=f||0,this.property=e,this.value=r,this.begin=f+g,this.end=this.begin+v,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,r,s){const u=e.now||0,f=this.value.possiblyEvaluate(e,r,s),g=this.prior;if(g){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return g.possiblyEvaluate(e,r,s);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,r,s),f,Ut(v))}}return f}}class ye{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,s){const u=new Pe(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,r,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ee{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Xt(this._values[e].value)}setValue(e,r){this._values[e]=new W(this._values[e].property,null===r?void 0:Xt(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(e[r]=s)}return e}possiblyEvaluate(e,r,s){const u=new Pe(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,r,s);return u}}class be{constructor(e,r,s){this.property=e,this.value=r,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,r,s,u){return this.property.evaluate(this.value,this.parameters,e,r,s,u)}}class Pe{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class se{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,s){const u=R[this.specification.type];return u?u(e,r,s):e}}class Ie{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,s,u){return new be(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(r,null,{},s,u)}:e.expression,r)}interpolate(e,r,s){if("constant"!==e.value.kind||"constant"!==r.value.kind)return e;if(void 0===e.value.value||void 0===r.value.value)return new be(this,{kind:"constant",value:void 0},e.parameters);const u=R[this.specification.type];return u?new be(this,{kind:"constant",value:u(e.value.value,r.value.value,s)},e.parameters):e}evaluate(e,r,s,u,f,g){return"constant"===e.kind?e.value:e.evaluate(r,s,u,f,g)}}class We{constructor(e){this.specification=e}possiblyEvaluate(e,r,s,u){return!!e.expression.evaluate(r,null,{},s,u)}interpolate(){return!1}}class Xe{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new $(0,{});for(const s in e){const u=e[s];u.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new W(u,void 0),g=this.defaultTransitionablePropertyValues[s]=new G(u);this.defaultTransitioningPropertyValues[s]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate(r)}}}function ft(n,e){return 256*(n=Ht(Math.floor(n),0,255))+Ht(Math.floor(e),0,255)}_(Ie,"DataDrivenProperty"),_(se,"DataConstantProperty"),_(We,"ColorRampProperty");const Ct={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Dt{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Rt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Mt(n,e=1){let r=0,s=0;return{members:n.map(u=>{const f=Ct[u.type].BYTES_PER_ELEMENT,g=r=Wt(r,Math.max(e,f)),v=u.components||1;return s=Math.max(s,f),r+=f*v,{name:u.name,type:u.type,components:v,offset:g}}),size:Wt(r,Math.max(s,e)),alignment:e}}function Wt(n,e){return Math.ceil(n/e)*e}class On extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.int16[u+0]=r,this.int16[u+1]=s,e}}On.prototype.bytesPerElement=4,_(On,"StructArrayLayout2i4");class qt extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.int16[f+0]=r,this.int16[f+1]=s,this.int16[f+2]=u,e}}qt.prototype.bytesPerElement=6,_(qt,"StructArrayLayout3i6");class Tn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=4*e;return this.int16[g+0]=r,this.int16[g+1]=s,this.int16[g+2]=u,this.int16[g+3]=f,e}}Tn.prototype.bytesPerElement=8,_(Tn,"StructArrayLayout4i8");class un extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,v){const C=this.length;return this.resize(C+1),this.emplace(C,e,r,s,u,f,g,v)}emplace(e,r,s,u,f,g,v,C){const T=6*e,F=12*e,V=3*e;return this.int16[T+0]=r,this.int16[T+1]=s,this.uint8[F+4]=u,this.uint8[F+5]=f,this.uint8[F+6]=g,this.uint8[F+7]=v,this.float32[V+2]=C,e}}un.prototype.bytesPerElement=12,_(un,"StructArrayLayout2i4ub1f12");class Fn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=4*e;return this.float32[g+0]=r,this.float32[g+1]=s,this.float32[g+2]=u,this.float32[g+3]=f,e}}Fn.prototype.bytesPerElement=16,_(Fn,"StructArrayLayout4f16");class nn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,s,u,f)}emplace(e,r,s,u,f,g){const v=6*e,C=3*e;return this.uint16[v+0]=r,this.uint16[v+1]=s,this.uint16[v+2]=u,this.uint16[v+3]=f,this.float32[C+2]=g,e}}nn.prototype.bytesPerElement=12,_(nn,"StructArrayLayout4ui1f12");class En extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=4*e;return this.uint16[g+0]=r,this.uint16[g+1]=s,this.uint16[g+2]=u,this.uint16[g+3]=f,e}}En.prototype.bytesPerElement=8,_(En,"StructArrayLayout4ui8");class zn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,s,u,f,g)}emplace(e,r,s,u,f,g,v){const C=6*e;return this.int16[C+0]=r,this.int16[C+1]=s,this.int16[C+2]=u,this.int16[C+3]=f,this.int16[C+4]=g,this.int16[C+5]=v,e}}zn.prototype.bytesPerElement=12,_(zn,"StructArrayLayout6i12");class Rn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,v,C,T,F,V,j){const Z=this.length;return this.resize(Z+1),this.emplace(Z,e,r,s,u,f,g,v,C,T,F,V,j)}emplace(e,r,s,u,f,g,v,C,T,F,V,j,Z){const Q=12*e;return this.int16[Q+0]=r,this.int16[Q+1]=s,this.int16[Q+2]=u,this.int16[Q+3]=f,this.uint16[Q+4]=g,this.uint16[Q+5]=v,this.uint16[Q+6]=C,this.uint16[Q+7]=T,this.int16[Q+8]=F,this.int16[Q+9]=V,this.int16[Q+10]=j,this.int16[Q+11]=Z,e}}Rn.prototype.bytesPerElement=24,_(Rn,"StructArrayLayout4i4ui4i24");class Vn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,s,u,f,g)}emplace(e,r,s,u,f,g,v){const C=10*e,T=5*e;return this.int16[C+0]=r,this.int16[C+1]=s,this.int16[C+2]=u,this.float32[T+2]=f,this.float32[T+3]=g,this.float32[T+4]=v,e}}Vn.prototype.bytesPerElement=20,_(Vn,"StructArrayLayout3i3f20");class Ar extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Ar.prototype.bytesPerElement=4,_(Ar,"StructArrayLayout1ul4");class Xr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,v,C,T,F,V,j,Z){const Q=this.length;return this.resize(Q+1),this.emplace(Q,e,r,s,u,f,g,v,C,T,F,V,j,Z)}emplace(e,r,s,u,f,g,v,C,T,F,V,j,Z,Q){const ce=20*e,Te=10*e;return this.int16[ce+0]=r,this.int16[ce+1]=s,this.int16[ce+2]=u,this.int16[ce+3]=f,this.int16[ce+4]=g,this.float32[Te+3]=v,this.float32[Te+4]=C,this.float32[Te+5]=T,this.float32[Te+6]=F,this.int16[ce+14]=V,this.uint32[Te+8]=j,this.uint16[ce+18]=Z,this.uint16[ce+19]=Q,e}}Xr.prototype.bytesPerElement=40,_(Xr,"StructArrayLayout5i4f1i1ul2ui40");class dr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,v){const C=this.length;return this.resize(C+1),this.emplace(C,e,r,s,u,f,g,v)}emplace(e,r,s,u,f,g,v,C){const T=8*e;return this.int16[T+0]=r,this.int16[T+1]=s,this.int16[T+2]=u,this.int16[T+4]=f,this.int16[T+5]=g,this.int16[T+6]=v,this.int16[T+7]=C,e}}dr.prototype.bytesPerElement=16,_(dr,"StructArrayLayout3i2i2i16");class Ur extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,s,u,f)}emplace(e,r,s,u,f,g){const v=4*e,C=8*e;return this.float32[v+0]=r,this.float32[v+1]=s,this.float32[v+2]=u,this.int16[C+6]=f,this.int16[C+7]=g,e}}Ur.prototype.bytesPerElement=16,_(Ur,"StructArrayLayout2f1f2i16");class gi extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=12*e,v=3*e;return this.uint8[g+0]=r,this.uint8[g+1]=s,this.float32[v+1]=u,this.float32[v+2]=f,e}}gi.prototype.bytesPerElement=12,_(gi,"StructArrayLayout2ub2f12");class pi extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.float32[f+0]=r,this.float32[f+1]=s,this.float32[f+2]=u,e}}pi.prototype.bytesPerElement=12,_(pi,"StructArrayLayout3f12");class br extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.uint16[f+0]=r,this.uint16[f+1]=s,this.uint16[f+2]=u,e}}br.prototype.bytesPerElement=6,_(br,"StructArrayLayout3ui6");class Xi extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te,He,st,Ge,at,yt){const gt=this.length;return this.resize(gt+1),this.emplace(gt,e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te,He,st,Ge,at,yt)}emplace(e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te,He,st,Ge,at,yt,gt){const tn=30*e,Zt=15*e,gn=60*e;return this.int16[tn+0]=r,this.int16[tn+1]=s,this.int16[tn+2]=u,this.float32[Zt+2]=f,this.float32[Zt+3]=g,this.uint16[tn+8]=v,this.uint16[tn+9]=C,this.uint32[Zt+5]=T,this.uint32[Zt+6]=F,this.uint32[Zt+7]=V,this.uint16[tn+16]=j,this.uint16[tn+17]=Z,this.uint16[tn+18]=Q,this.float32[Zt+10]=ce,this.float32[Zt+11]=Te,this.uint8[gn+48]=He,this.uint8[gn+49]=st,this.uint8[gn+50]=Ge,this.uint32[Zt+13]=at,this.int16[tn+28]=yt,this.uint8[gn+58]=gt,e}}Xi.prototype.bytesPerElement=60,_(Xi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class _i extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te,He,st,Ge,at,yt,gt,tn,Zt,gn,Ln,ln,Sn,In,kn){const Un=this.length;return this.resize(Un+1),this.emplace(Un,e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te,He,st,Ge,at,yt,gt,tn,Zt,gn,Ln,ln,Sn,In,kn)}emplace(e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te,He,st,Ge,at,yt,gt,tn,Zt,gn,Ln,ln,Sn,In,kn,Un){const _n=38*e,tr=19*e;return this.int16[_n+0]=r,this.int16[_n+1]=s,this.int16[_n+2]=u,this.float32[tr+2]=f,this.float32[tr+3]=g,this.int16[_n+8]=v,this.int16[_n+9]=C,this.int16[_n+10]=T,this.int16[_n+11]=F,this.int16[_n+12]=V,this.int16[_n+13]=j,this.uint16[_n+14]=Z,this.uint16[_n+15]=Q,this.uint16[_n+16]=ce,this.uint16[_n+17]=Te,this.uint16[_n+18]=He,this.uint16[_n+19]=st,this.uint16[_n+20]=Ge,this.uint16[_n+21]=at,this.uint16[_n+22]=yt,this.uint16[_n+23]=gt,this.uint16[_n+24]=tn,this.uint16[_n+25]=Zt,this.uint16[_n+26]=gn,this.uint16[_n+27]=Ln,this.uint16[_n+28]=ln,this.uint32[tr+15]=Sn,this.float32[tr+16]=In,this.float32[tr+17]=kn,this.float32[tr+18]=Un,e}}_i.prototype.bytesPerElement=76,_(_i,"StructArrayLayout3i2f6i15ui1ul3f76");class fo extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}fo.prototype.bytesPerElement=4,_(fo,"StructArrayLayout1f4");class lo extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,s,u,f)}emplace(e,r,s,u,f,g){const v=5*e;return this.float32[v+0]=r,this.float32[v+1]=s,this.float32[v+2]=u,this.float32[v+3]=f,this.float32[v+4]=g,e}}lo.prototype.bytesPerElement=20,_(lo,"StructArrayLayout5f20");class Ns extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=6*e;return this.uint32[3*e+0]=r,this.uint16[g+2]=s,this.uint16[g+3]=u,this.uint16[g+4]=f,e}}Ns.prototype.bytesPerElement=12,_(Ns,"StructArrayLayout1ul3ui12");class zs extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.uint16[u+0]=r,this.uint16[u+1]=s,e}}zs.prototype.bytesPerElement=4,_(zs,"StructArrayLayout2ui4");class Sa extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}Sa.prototype.bytesPerElement=2,_(Sa,"StructArrayLayout1ui2");class Ua extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.float32[u+0]=r,this.float32[u+1]=s,e}}Ua.prototype.bytesPerElement=8,_(Ua,"StructArrayLayout2f8");class co extends Dt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}co.prototype.size=40;class ji extends Xr{get(e){return new co(this,e)}}_(ji,"CollisionBoxArray");class Mi extends Dt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Mi.prototype.size=60;class hs extends Xi{get(e){return new Mi(this,e)}}_(hs,"PlacedSymbolArray");class Zs extends Dt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Zs.prototype.size=76;class no extends _i{get(e){return new Zs(this,e)}}_(no,"SymbolInstanceArray");class Ia extends fo{getoffsetX(e){return this.float32[1*e+0]}}_(Ia,"GlyphOffsetArray");class $u extends On{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}_($u,"SymbolLineVertexArray");class Oc extends Dt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Oc.prototype.size=12;class Vu extends Ns{get(e){return new Oc(this,e)}}_(Vu,"FeatureIndexArray");class Jl extends zs{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}_(Jl,"FillExtrusionCentroidArray");const _c=Mt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),kc=Mt([{name:"a_dash",components:4,type:"Uint16"}]);var gd={exports:{}},$s=function(n,e){var r,s,u,f,g,v,C,T;for(s=n.length-(r=3&n.length),u=e,g=3432918353,v=461845907,T=0;T<s;)C=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24,++T,u=27492+(65535&(f=5*(65535&(u=(u^=C=(65535&(C=(C=(65535&C)*g+(((C>>>16)*g&65535)<<16)&4294967295)<<15|C>>>17))*v+(((C>>>16)*v&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(C=0,r){case 3:C^=(255&n.charCodeAt(T+2))<<16;case 2:C^=(255&n.charCodeAt(T+1))<<8;case 1:u^=C=(65535&(C=(C=(65535&(C^=255&n.charCodeAt(T)))*g+(((C>>>16)*g&65535)<<16)&4294967295)<<15|C>>>17))*v+(((C>>>16)*v&65535)<<16)&4294967295}return u^=n.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0},b_=function(n,e){for(var r,s=n.length,u=e^s,f=0;s>=4;)r=1540483477*(65535&(r=255&n.charCodeAt(f)|(255&n.charCodeAt(++f))<<8|(255&n.charCodeAt(++f))<<16|(255&n.charCodeAt(++f))<<24))+((1540483477*(r>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:u^=(255&n.charCodeAt(f+2))<<16;case 2:u^=(255&n.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&n.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};gd.exports=$s,gd.exports.murmur3=$s,gd.exports.murmur2=b_;var cu=vt(gd.exports);class Eh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,s,u){this.ids.push(Ka(e)),this.positions.push(r,s,u)}getPositions(e){const r=Ka(e);let s=0,u=this.ids.length-1;for(;s<u;){const g=s+u>>1;this.ids[g]>=r?u=g:s=g+1}const f=[];for(;this.ids[s]===r;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,r){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Lc(s,u,0,s.length-1),r&&r.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const r=new Eh;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Ka(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:cu(String(n))}function Lc(n,e,r,s){for(;r<s;){const u=n[r+s>>1];let f=r-1,g=s+1;for(;;){do{f++}while(n[f]<u);do{g--}while(n[g]>u);if(f>=g)break;yd(n,f,g),yd(e,3*f,3*g),yd(e,3*f+1,3*g+1),yd(e,3*f+2,3*g+2)}g-r<s-g?(Lc(n,e,r,g),r=g+1):(Lc(n,e,g+1,s),s=g)}}function yd(n,e,r){const s=n[e];n[e]=n[r],n[r]=s}_(Eh,"FeaturePositionMap");class dl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}}class Fc extends dl{constructor(e){super(e),this.current=0}set(e,r,s){this.fetchUniformLocation(e,r)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class hm extends dl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,s){this.fetchUniformLocation(e,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class w_ extends dl{constructor(e){super(e),this.current=Zr.transparent}set(e,r,s){this.fetchUniformLocation(e,r)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const E_=new Float32Array(16),bv=new Float32Array(9),Ja=new Float32Array(4);function vd(n){return[ft(255*n.r,255*n.g),ft(255*n.b,255*n.a)]}class Ql{constructor(e,r,s){this.value=e,this.uniformNames=r.map(u=>`u_${u}`),this.type=s}setUniform(e,r,s,u,f){r.set(e,f,u.constantOr(this.value))}getBinding(e,r){return"color"===this.type?new w_(e):new Fc(e)}}class xd{constructor(e,r){this.uniformNames=r.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,s,u,f){const g="u_pattern"===f||"u_dash"===f?this.pattern:"u_pixel_ratio"===f?this.pixelRatio:null;g&&r.set(e,f,g)}getBinding(e,r){return"u_pattern"===r||"u_dash"===r?new hm(e):new Fc(e)}}class ec{constructor(e,r,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(f=>({name:`a_${f}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,r,s,u,f,g){const v=this.paintVertexArray.length,C=this.expression.evaluate(new $(0),r,{},f,u,g);this.paintVertexArray.resize(e),this._setPaintValue(v,e,C)}updatePaintArray(e,r,s,u,f){const g=this.expression.evaluate({zoom:0},s,u,void 0,f);this._setPaintValue(e,r,g)}_setPaintValue(e,r,s){if("color"===this.type){const u=vd(s);for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<r;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Tl{constructor(e,r,s,u,f,g){this.expression=e,this.uniformNames=r.map(v=>`u_${v}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=r.map(v=>({name:`a_${v}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,r,s,u,f,g){const v=this.expression.evaluate(new $(this.zoom),r,{},f,u,g),C=this.expression.evaluate(new $(this.zoom+1),r,{},f,u,g),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,v,C)}updatePaintArray(e,r,s,u,f){const g=this.expression.evaluate({zoom:this.zoom},s,u,void 0,f),v=this.expression.evaluate({zoom:this.zoom+1},s,u,void 0,f);this._setPaintValue(e,r,g,v)}_setPaintValue(e,r,s,u){if("color"===this.type){const f=vd(s),g=vd(u);for(let v=e;v<r;v++)this.paintVertexArray.emplace(v,f[0],f[1],g[0],g[1])}else{for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,s,u,f){const g=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,v=Ht(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);r.set(e,f,v)}getBinding(e,r){return new Fc(e)}}class Bc{constructor(e,r,s,u,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=("array"===s?kc:_c).members;for(let g=0;g<r.length;++g);this.paintVertexArray=new u}populatePaintArray(e,r,s){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,r.patterns&&r.patterns[this.layerId],s)}updatePaintArray(e,r,s,u,f,g){this._setPaintValues(e,r,s.patterns&&s.patterns[this.layerId],g)}_setPaintValues(e,r,s,u){if(!u||!s)return;const f=u[s];if(!f)return;const{tl:g,br:v,pixelRatio:C}=f;for(let T=e;T<r;T++)this.paintVertexArray.emplace(T,g[0],g[1],v[0],v[1],C)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Nc{constructor(e,r,s=(()=>!0)){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!s(f))continue;const g=e.paint.get(f);if(!(g instanceof be&&Fe(g.property.specification)))continue;const v=C_(f,e.type),C=g.value,T=g.property.specification.type,F=!!g.property.useIntegerZoom,V="line-dasharray"===f||f.endsWith("pattern"),j="line-dasharray"===f&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==C.kind||j)if("source"===C.kind||j||V){const Z=Lf(f,T,"source");this.binders[f]=V?new Bc(C,v,T,Z,e.id):new ec(C,v,T,Z),u.push(`/a_${f}`)}else{const Z=Lf(f,T,"composite");this.binders[f]=new Tl(C,v,T,F,r,Z),u.push(`/z_${f}`)}else this.binders[f]=V?new xd(C.value,v):new Ql(C.value,v,T),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof ec||r instanceof Tl?r.maxValue:0}populatePaintArrays(e,r,s,u,f,g){for(const v in this.binders){const C=this.binders[v];(C instanceof ec||C instanceof Tl||C instanceof Bc)&&C.populatePaintArray(e,r,s,u,f,g)}}setConstantPatternPositions(e){for(const r in this.binders){const s=this.binders[r];s instanceof xd&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,r,s,u,f,g){let v=!1;for(const C in e){const T=r.getPositions(C);for(const F of T){const V=s.feature(F.index);for(const j in this.binders){const Z=this.binders[j];if((Z instanceof ec||Z instanceof Tl||Z instanceof Bc)&&!0===Z.expression.isStateDependent){const Q=u.paint.get(j);Z.expression=Q.value,Z.updatePaintArray(F.start,F.end,V,e[C],f,g),v=!0}}}}return v}defines(){const e=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Ql||s instanceof xd)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof ec||s instanceof Tl||s instanceof Bc)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Ql||s instanceof xd||s instanceof Tl)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const r=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Ql||u instanceof xd||u instanceof Tl)for(const f of u.uniformNames)r.push({name:f,property:s,binding:u.getBinding(e,f)})}return r}setUniforms(e,r,s,u,f){for(const{name:g,property:v,binding:C}of s)this.binders[v].setUniform(e,C,f,u.get(v),g)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const r=this.binders[e];(r instanceof ec||r instanceof Tl||r instanceof Bc)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){const s=this.binders[r];(s instanceof ec||s instanceof Tl||s instanceof Bc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof ec||r instanceof Tl||r instanceof Bc)&&r.destroy()}}}class uu{constructor(e,r,s=(()=>!0)){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Nc(u,r,s);this.needsUpload=!1,this._featureMap=new Eh,this._bufferOffset=0}populatePaintArrays(e,r,s,u,f,g,v){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(e,r,u,f,g,v);void 0!==r.id&&this._featureMap.add(r.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,s,u,f){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,r,g,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const D_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function C_(n,e){return D_[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const kf={"line-pattern":{source:nn,composite:nn},"fill-pattern":{source:nn,composite:nn},"fill-extrusion-pattern":{source:nn,composite:nn},"line-dasharray":{source:En,composite:En}},Dh={color:{source:Ua,composite:Fn},number:{source:fo,composite:Ua}};function Lf(n,e,r){const s=kf[n];return s&&s[r]||Dh[e][r]}_(Ql,"ConstantBinder"),_(xd,"PatternConstantBinder"),_(ec,"SourceExpressionBinder"),_(Bc,"PatternCompositeBinder"),_(Tl,"CompositeExpressionBinder"),_(Nc,"ProgramConfiguration",{omit:["_buffers"]}),_(uu,"ProgramConfigurationSet");const bd="-transition";class Sl extends Es{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Ee(r.layout)),r.paint)){this._transitionablePaint=new ae(r.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Pe(r.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,s={}){null!=r&&this._validate(lu,`layers.${this.id}.layout.${e}`,e,r,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return hn(e,bd)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,s={}){if(null!=r&&this._validate(gc,`layers.${this.id}.paint.${e}`,e,r,s))return!1;if(hn(e,bd))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.value.isDataDriven(),g=u.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const v=this._transitionablePaint._values[e].value,C=v.isDataDriven(),T=hn(e,"pattern")||"line-dasharray"===e;return C||f||T||this._handleOverridablePaintPropertyUpdate(e,g,v)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),jt(e,(r,s)=>!(void 0===r||"layout"===s&&!Object.keys(r).length||"paint"===s&&!Object.keys(r).length))}_validate(e,r,s,u,f={}){return(!f||!1!==f.validate)&&Rc(this,e.call(Kl,{key:r,layerType:this.type,objectKey:s,value:u,styleSpec:cn,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof be&&Fe(r.property.specification)&&("source"===r.value.kind||"composite"===r.value.kind)&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Da(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Ch=Mt([{name:"a_pos",components:2,type:"Int16"}],4),T_=Mt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class fs{constructor(e=[]){this.segments=e}prepareSegment(e,r,s,u){let f=this.segments[this.segments.length-1];return e>fs.MAX_VERTEX_ARRAY_LENGTH&&mn(`Max vertices per segment is ${fs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>fs.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==u&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,s,u){return new fs([{vertexOffset:e,primitiveOffset:r,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}fs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_(fs,"SegmentVector");var Pr=8192;class Il{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof po?new po(e.lng,e.lat):po.convert(e),this}setSouthWest(e){return this._sw=e instanceof po?new po(e.lng,e.lat):po.convert(e),this}extend(e){const r=this._sw,s=this._ne;let u,f;if(e instanceof po)u=e,f=e;else{if(!(e instanceof Il))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Il.convert(e)):this.extend(po.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(po.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return r||s?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),s.lng=Math.max(f.lng,s.lng),s.lat=Math.max(f.lat,s.lat)):(this._sw=new po(u.lng,u.lat),this._ne=new po(f.lng,f.lat)),this}getCenter(){return new po((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new po(this.getWest(),this.getNorth())}getSouthEast(){return new po(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:s}=po.convert(e);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof Il?e:new Il(e)}}var wd=1e-6,ja=typeof Float32Array<"u"?Float32Array:Array;function fm(){var n=new ja(9);return ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function du(n,e,r){var s=e[0],u=e[1],f=e[2],g=e[3],v=e[4],C=e[5],T=e[6],F=e[7],V=e[8],j=r[0],Z=r[1],Q=r[2],ce=r[3],Te=r[4],He=r[5],st=r[6],Ge=r[7],at=r[8];return n[0]=j*s+Z*g+Q*T,n[1]=j*u+Z*v+Q*F,n[2]=j*f+Z*C+Q*V,n[3]=ce*s+Te*g+He*T,n[4]=ce*u+Te*v+He*F,n[5]=ce*f+Te*C+He*V,n[6]=st*s+Ge*g+at*T,n[7]=st*u+Ge*v+at*F,n[8]=st*f+Ge*C+at*V,n}function Ma(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ff(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=e[4],v=e[5],C=e[6],T=e[7],F=e[8],V=e[9],j=e[10],Z=e[11],Q=e[12],ce=e[13],Te=e[14],He=e[15],st=r*v-s*g,Ge=r*C-u*g,at=r*T-f*g,yt=s*C-u*v,gt=s*T-f*v,tn=u*T-f*C,Zt=F*ce-V*Q,gn=F*Te-j*Q,Ln=F*He-Z*Q,ln=V*Te-j*ce,Sn=V*He-Z*ce,In=j*He-Z*Te,kn=st*In-Ge*Sn+at*ln+yt*Ln-gt*gn+tn*Zt;return kn?(n[0]=(v*In-C*Sn+T*ln)*(kn=1/kn),n[1]=(u*Sn-s*In-f*ln)*kn,n[2]=(ce*tn-Te*gt+He*yt)*kn,n[3]=(j*gt-V*tn-Z*yt)*kn,n[4]=(C*Ln-g*In-T*gn)*kn,n[5]=(r*In-u*Ln+f*gn)*kn,n[6]=(Te*at-Q*tn-He*Ge)*kn,n[7]=(F*tn-j*at+Z*Ge)*kn,n[8]=(g*Sn-v*Ln+T*Zt)*kn,n[9]=(s*Ln-r*Sn-f*Zt)*kn,n[10]=(Q*gt-ce*at+He*st)*kn,n[11]=(V*at-F*gt-Z*st)*kn,n[12]=(v*gn-g*ln-C*Zt)*kn,n[13]=(r*ln-s*gn+u*Zt)*kn,n[14]=(ce*Ge-Q*yt-Te*st)*kn,n[15]=(F*yt-V*Ge+j*st)*kn,n):null}function Uu(n,e,r){var s=e[0],u=e[1],f=e[2],g=e[3],v=e[4],C=e[5],T=e[6],F=e[7],V=e[8],j=e[9],Z=e[10],Q=e[11],ce=e[12],Te=e[13],He=e[14],st=e[15],Ge=r[0],at=r[1],yt=r[2],gt=r[3];return n[0]=Ge*s+at*v+yt*V+gt*ce,n[1]=Ge*u+at*C+yt*j+gt*Te,n[2]=Ge*f+at*T+yt*Z+gt*He,n[3]=Ge*g+at*F+yt*Q+gt*st,n[4]=(Ge=r[4])*s+(at=r[5])*v+(yt=r[6])*V+(gt=r[7])*ce,n[5]=Ge*u+at*C+yt*j+gt*Te,n[6]=Ge*f+at*T+yt*Z+gt*He,n[7]=Ge*g+at*F+yt*Q+gt*st,n[8]=(Ge=r[8])*s+(at=r[9])*v+(yt=r[10])*V+(gt=r[11])*ce,n[9]=Ge*u+at*C+yt*j+gt*Te,n[10]=Ge*f+at*T+yt*Z+gt*He,n[11]=Ge*g+at*F+yt*Q+gt*st,n[12]=(Ge=r[12])*s+(at=r[13])*v+(yt=r[14])*V+(gt=r[15])*ce,n[13]=Ge*u+at*C+yt*j+gt*Te,n[14]=Ge*f+at*T+yt*Z+gt*He,n[15]=Ge*g+at*F+yt*Q+gt*st,n}function ju(n,e,r){var s,u,f,g,v,C,T,F,V,j,Z,Q,ce=r[0],Te=r[1],He=r[2];return e===n?(n[12]=e[0]*ce+e[4]*Te+e[8]*He+e[12],n[13]=e[1]*ce+e[5]*Te+e[9]*He+e[13],n[14]=e[2]*ce+e[6]*Te+e[10]*He+e[14],n[15]=e[3]*ce+e[7]*Te+e[11]*He+e[15]):(u=e[1],f=e[2],g=e[3],v=e[4],C=e[5],T=e[6],F=e[7],V=e[8],j=e[9],Z=e[10],Q=e[11],n[0]=s=e[0],n[1]=u,n[2]=f,n[3]=g,n[4]=v,n[5]=C,n[6]=T,n[7]=F,n[8]=V,n[9]=j,n[10]=Z,n[11]=Q,n[12]=s*ce+v*Te+V*He+e[12],n[13]=u*ce+C*Te+j*He+e[13],n[14]=f*ce+T*Te+Z*He+e[14],n[15]=g*ce+F*Te+Q*He+e[15]),n}function hu(n,e,r){var s=r[0],u=r[1],f=r[2];return n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n[3]=e[3]*s,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function pm(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[4],g=e[5],v=e[6],C=e[7],T=e[8],F=e[9],V=e[10],j=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*u+T*s,n[5]=g*u+F*s,n[6]=v*u+V*s,n[7]=C*u+j*s,n[8]=T*u-f*s,n[9]=F*u-g*s,n[10]=V*u-v*s,n[11]=j*u-C*s,n}function Th(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[0],g=e[1],v=e[2],C=e[3],T=e[8],F=e[9],V=e[10],j=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u-T*s,n[1]=g*u-F*s,n[2]=v*u-V*s,n[3]=C*u-j*s,n[8]=f*s+T*u,n[9]=g*s+F*u,n[10]=v*s+V*u,n[11]=C*s+j*u,n}function mm(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function gm(n,e,r){var s,u,f,g=r[0],v=r[1],C=r[2],T=Math.hypot(g,v,C);return T<wd?null:(g*=T=1/T,v*=T,C*=T,s=Math.sin(e),u=Math.cos(e),n[0]=g*g*(f=1-u)+u,n[1]=v*g*f+C*s,n[2]=C*g*f-v*s,n[3]=0,n[4]=g*v*f-C*s,n[5]=v*v*f+u,n[6]=C*v*f+g*s,n[7]=0,n[8]=g*C*f+v*s,n[9]=v*C*f-g*s,n[10]=C*C*f+u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Sh=Uu;function Ih(){var n=new ja(3);return ja!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function _m(n){var e=new ja(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Hu(n){return Math.hypot(n[0],n[1],n[2])}function Ed(n,e,r){var s=new ja(3);return s[0]=n,s[1]=e,s[2]=r,s}function tc(n,e,r){return n[0]=e[0]+r[0],n[1]=e[1]+r[1],n[2]=e[2]+r[2],n}function ym(n,e,r){return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],n}function vm(n,e,r){return n[0]=e[0]*r[0],n[1]=e[1]*r[1],n[2]=e[2]*r[2],n}function Dd(n,e,r){return n[0]=Math.min(e[0],r[0]),n[1]=Math.min(e[1],r[1]),n[2]=Math.min(e[2],r[2]),n}function fu(n,e,r){return n[0]=Math.max(e[0],r[0]),n[1]=Math.max(e[1],r[1]),n[2]=Math.max(e[2],r[2]),n}function hl(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n}function Mh(n,e,r,s){return n[0]=e[0]+r[0]*s,n[1]=e[1]+r[1]*s,n[2]=e[2]+r[2]*s,n}function ra(n,e){var r=e[0],s=e[1],u=e[2],f=r*r+s*s+u*u;return f>0&&(f=1/Math.sqrt(f)),n[0]=e[0]*f,n[1]=e[1]*f,n[2]=e[2]*f,n}function Ml(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function xm(n,e,r){var s=e[0],u=e[1],f=e[2],g=r[0],v=r[1],C=r[2];return n[0]=u*C-f*v,n[1]=f*g-s*C,n[2]=s*v-u*g,n}function vs(n,e,r){var s=e[0],u=e[1],f=e[2],g=r[3]*s+r[7]*u+r[11]*f+r[15];return n[0]=(r[0]*s+r[4]*u+r[8]*f+r[12])/(g=g||1),n[1]=(r[1]*s+r[5]*u+r[9]*f+r[13])/g,n[2]=(r[2]*s+r[6]*u+r[10]*f+r[14])/g,n}function S_(n,e,r){var s=r[0],u=r[1],f=r[2],g=e[0],v=e[1],C=e[2],T=u*C-f*v,F=f*g-s*C,V=s*v-u*g,j=u*V-f*F,Z=f*T-s*V,Q=s*F-u*T,ce=2*r[3];return F*=ce,V*=ce,Z*=2,Q*=2,n[0]=g+(T*=ce)+(j*=2),n[1]=v+F+Z,n[2]=C+V+Q,n}var Ah,Al=ym,Ph=vm,Rh=Hu;function Bf(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n}function Nf(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=r*r+s*s+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),n[0]=r*g,n[1]=s*g,n[2]=u*g,n[3]=f*g,n}function zc(n,e,r){var s=e[0],u=e[1],f=e[2],g=e[3];return n[0]=r[0]*s+r[4]*u+r[8]*f+r[12]*g,n[1]=r[1]*s+r[5]*u+r[9]*f+r[13]*g,n[2]=r[2]*s+r[6]*u+r[10]*f+r[14]*g,n[3]=r[3]*s+r[7]*u+r[11]*f+r[15]*g,n}function pu(){var n=new ja(4);return ja!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function zf(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function $f(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],v=Math.sin(r),C=Math.cos(r);return n[0]=s*C+g*v,n[1]=u*C+f*v,n[2]=f*C-u*v,n[3]=g*C-s*v,n}function Cd(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],v=Math.sin(r),C=Math.cos(r);return n[0]=s*C-f*v,n[1]=u*C+g*v,n[2]=f*C+s*v,n[3]=g*C-u*v,n}Ih(),Ah=new ja(4),ja!=Float32Array&&(Ah[0]=0,Ah[1]=0,Ah[2]=0,Ah[3]=0);var Oh=Nf;Ih(),Ed(1,0,0),Ed(0,1,0),pu(),pu(),fm();const kh=Mt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:bm}=kh,wm=Mt([{name:"a_pos_3",components:3,type:"Int16"}]);var Td=Mt([{name:"a_pos",type:"Int16",components:2}]);class Lh{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,s){const u=Ml(r,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/u;return s[0]=this.pos[0]+this.dir[0]*f,s[1]=this.pos[1]+this.dir[1]*f,s[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,r,s){if(ce=(Z=this.pos)[0],Te=Z[1],He=Z[2],st=(Q=e)[0],Ge=Q[1],at=Q[2],Math.abs(ce-st)<=wd*Math.max(1,Math.abs(ce),Math.abs(st))&&Math.abs(Te-Ge)<=wd*Math.max(1,Math.abs(Te),Math.abs(Ge))&&Math.abs(He-at)<=wd*Math.max(1,Math.abs(He),Math.abs(at))||0===r)return s[0]=s[1]=s[2]=0,!1;var Z,Q,ce,Te,He,st,Ge,at;const[u,f,g]=this.dir,v=this.pos[0]-e[0],C=this.pos[1]-e[1],T=this.pos[2]-e[2],F=u*u+f*f+g*g,V=2*(v*u+C*f+T*g),j=V*V-4*F*(v*v+C*C+T*T-r*r);if(j<0){const Z=Math.max(-V/2,0),Q=v+u*Z,ce=C+f*Z,Te=T+g*Z,He=Math.hypot(Q,ce,Te);return s[0]=Q*r/He,s[1]=ce*r/He,s[2]=Te*r/He,!1}{const Z=(-V-Math.sqrt(j))/(2*F);if(Z<0){const Q=Math.hypot(v,C,T);return s[0]=v*r/Q,s[1]=C*r/Q,s[2]=T*r/Q,!1}return s[0]=v+u*Z,s[1]=C+f*Z,s[2]=T+g*Z,!0}}}class Sd{constructor(e,r,s,u,f){this.TL=e,this.TR=r,this.BR=s,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,r,s){const u=[-1,1,1],f=[1,1,1],g=[1,-1,1],v=[-1,-1,1],C=vs(u,u,e),T=vs(f,f,e),F=vs(g,g,e),V=vs(v,v,e);return new Sd(C,T,F,V,r/s)}}class Vf{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,s,u){const f=Math.pow(2,s),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const T=zc([],C,e),F=1/T[3]/r*f;return(V=T)[0]=(j=T)[0]*(Z=[F,F,u?1/T[3]:F,F])[0],V[1]=j[1]*Z[1],V[2]=j[2]*Z[2],V[3]=j[3]*Z[3],V;var V,j,Z}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const T=ra([],xm([],Al([],g[C[0]],g[C[1]]),Al([],g[C[2]],g[C[1]]))),F=-Ml(T,g[C[1]]);return T.concat(F)});return new Vf(g,v)}}class pa{static fromPoints(e){const r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const u of e)Dd(r,r,u),fu(s,s,u);return new pa(r,s)}static applyTransform(e,r){const s=e.getCorners();for(let u=0;u<s.length;++u)vs(s[u],s[u],r);return pa.fromPoints(s)}constructor(e,r){this.min=e,this.max=r,this.center=hl([],tc([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],s=_m(this.min),u=_m(this.max);for(let f=0;f<r.length;f++)s[f]=r[f]?this.min[f]:this.center[f],u[f]=r[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new pa(s,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let s=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let g=0;for(let v=0;v<r.length;v++)g+=Ml(f,r[v])+f[3]>=0;if(0===g)return 0;g!==r.length&&(s=!1)}if(s)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let v=0;v<e.points.length;v++){const C=e.points[v][u]-this.min[u];f=Math.min(f,C),g=Math.max(g,C)}if(g<0||f>this.max[u]-this.min[u])return 0}return 1}}const Uf=5,jf=6,nc=Pr/Math.PI/2,I_=16383,mu=[64,32,16],Qa=-nc,Ha=nc,ma=[new pa([Qa,Qa,Qa],[Ha,Ha,Ha]),new pa([Qa,Qa,Qa],[0,0,Ha]),new pa([0,Qa,Qa],[Ha,0,Ha]),new pa([Qa,0,Qa],[0,Ha,Ha]),new pa([0,0,Qa],[Ha,Ha,Ha])];function $c(n){return n*nc/Ad}function Hf(n,e,r,s=!0){const u=hl([],n._camera.position,n.worldSize),f=[e,r,1,1];zc(f,f,n.pixelMatrixInverse),Bf(f,f,1/f[3]);const g=ra([],Al([],f,u)),v=n.globeMatrix,C=[v[12],v[13],v[14]],T=Al([],C,u),F=Hu(T),V=ra([],T),j=n.worldSize/(2*Math.PI),Z=Ml(V,g),Q=Math.asin(j/F);if(Q<Math.acos(Z)){if(!s)return null;const Ln=[],ln=[];hl(Ln,g,F/Z),ra(ln,Al(ln,Ln,T)),ra(g,tc(g,T,hl(g,ln,Math.tan(Q)*F)))}const ce=[];new Lh(u,g).closestPointOnSphere(C,j,ce);const Te=ra([],Jr(v,0)),He=ra([],Jr(v,1)),st=ra([],Jr(v,2)),Ge=Ml(Te,ce),at=Ml(He,ce),yt=Ml(st,ce),gt=mt(Math.asin(-at/j));let tn=mt(Math.atan2(Ge,yt));tn=n.center.lng+function(Ln,ln){const Sn=(ln-Ln+180)%360-180;return Sn<-180?Sn+360:Sn}(n.center.lng,tn);const Zt=rc(tn),gn=Ht(Rl(gt),0,1);return new vu(Zt,gn)}class Em{constructor(e,r,s){this.a=Al([],e,s),this.b=Al([],r,s),this.center=s;const u=ra([],this.a),f=ra([],this.b);this.angle=Math.acos(Ml(u,f))}}function Gf(n,e){if(0===n.angle)return null;let r;return r=0===n.a[e]?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),r<0||r>1?null:function(s,u,f,g){const v=Math.sin(f);return s*(Math.sin((1-g)*f)/v)+u*(Math.sin(g*f)/v)}(n.a[e],n.b[e],n.angle,Ht(r,0,1))+n.center[e]}function Pl(n){if(n.z<=1)return ma[n.z+2*n.y+n.x];const e=qf(Fh(n));return pa.fromPoints(e)}function gu(n,e,r){return hl(n,n,1-r),Mh(n,n,e,r)}function Wf(n,e){const r=_u(e.zoom);if(0===r)return Pl(n);const s=Fh(n),u=qf(s),f=rc(s.getWest())*e.worldSize,g=rc(s.getEast())*e.worldSize,v=Rl(s.getNorth())*e.worldSize,C=Rl(s.getSouth())*e.worldSize,T=[f,v,0],F=[g,v,0],V=[f,C,0],j=[g,C,0],Z=Ff([],e.globeMatrix);return vs(T,T,Z),vs(F,F,Z),vs(V,V,Z),vs(j,j,Z),u[0]=gu(u[0],V,r),u[1]=gu(u[1],j,r),u[2]=gu(u[2],F,r),u[3]=gu(u[3],T,r),pa.fromPoints(u)}function Dm(n,e,r){for(const s of n)vs(s,s,e),hl(s,s,r)}function Fh({x:n,y:e,z:r}){const s=1/(1<<r),u=new po(Aa(n*s),Us((e+1)*s)),f=new po(Aa((n+1)*s),Us(e*s));return new Il(u,f)}function qf(n){const e=Je(n.getNorth()),r=Je(n.getSouth()),s=Math.cos(e),u=Math.cos(r),f=Math.sin(e),g=Math.sin(r),v=n.getWest(),C=n.getEast();return[Vc(u,g,v),Vc(u,g,C),Vc(s,f,C),Vc(s,f,v)]}function Vc(n,e,r,s=nc){return r=Je(r),[n*Math.sin(r)*s,-e*s,n*Math.cos(r)*s]}function Uc(n,e,r){return Vc(Math.cos(Je(n)),Math.sin(Je(n)),e,r)}function Id(n,e,r,s){const u=1<<r.z,f=(n/Pr+r.x)/u;return Uc(Us((e/Pr+r.y)/u),Aa(f),s)}function jc({min:n,max:e}){return I_/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const Tm=new Float64Array(16);function Md(n){const e=jc(n),r=mm(Tm,[e,e,e]);return ju(r,r,((s=[])[0]=-(u=n.min)[0],s[1]=-u[1],s[2]=-u[2],s));var s,u}function Bh(n){const e=(s=n.min,(r=Tm)[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=s[0],r[13]=s[1],r[14]=s[2],r[15]=1,r);var r,s;const u=1/jc(n);return hu(e,e,[u,u,u])}function Zf(n,e,r,s,u){const f=function(C){const T=Pr/(2*Math.PI);return C/(2*Math.PI)/T}(r),g=[n,e,-r/(2*Math.PI)],v=Ma(new Float64Array(16));return ju(v,v,g),hu(v,v,[f,f,f]),pm(v,v,Je(-u)),Th(v,v,Je(-s)),v}function _u(n){return Yn(Uf,jf,n)}function yu(n,e){const r=Uc(e.lat,e.lng);return g=(u=ym([],function(Q){const ce=Uc(Q._center.lat,Q._center.lng);let Te=xm([],Ed(0,1,0),ce);const He=gm([],-Q.angle,ce);Te=vs(Te,Te,He),gm(He,-Q._pitch,Te);const st=ra([],ce);return hl(st,st,$c(Q.cameraToCenterDistance/Q.pixelsPerMeter)),vs(st,st,He),tc([],ce,st)}(n),r))[0],v=u[1],C=u[2],T=(f=r)[0],F=f[1],V=f[2],Z=(j=Math.sqrt(g*g+v*v+C*C)*Math.sqrt(T*T+F*F+V*V))&&Ml(u,f)/j,Math.acos(Math.min(Math.max(Z,-1),1));var u,f,g,v,C,T,F,V,j,Z}function Gu(n,e){return yu(n,e)>Math.PI/2*1.01}const Yf=Je(85),Xf=Math.cos(Yf),Nh=Math.sin(Yf),Ad=6371008.8,Sm=2*Math.PI*Ad;class Hc{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Hc(en(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,s=this.lat*r,u=e.lat*r,f=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*r);return Ad*Math.acos(Math.min(f,1))}toBounds(e=0){const r=360*e/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new Il(new Hc(this.lng-s,this.lat-r),new Hc(this.lng+s,this.lat+r))}toEcef(e){const r=$c(e);return Uc(this.lat,this.lng,nc+r)}static convert(e){if(e instanceof Hc)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Hc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Hc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var po=Hc;function Kf(n){return Sm*Math.cos(n*Math.PI/180)}function rc(n){return(180+n)/360}function Rl(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Ga(n,e){return n/Kf(e)}function Aa(n){return 360*n-180}function Us(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function Im(n,e){return n*Kf(Us(e))}const ia=85.051129;function zh(n){return 1/Math.cos(n*Math.PI/180)}class vu{constructor(e,r,s=0){this.x=+e,this.y=+r,this.z=+s}static fromLngLat(e,r=0){const s=po.convert(e);return new vu(rc(s.lng),Rl(s.lat),Ga(r,s.lat))}toLngLat(){return new po(Aa(this.x),Us(this.y))}toAltitude(){return Im(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Sm*zh(Us(this.y))}}function yc(n,e,r,s,u,f,g,v,C){const T=(e+s)/2,F=(r+u)/2,V=new Me(T,F);v(V),function(j,Z,Q,ce,Te,He){const st=Q-Te,Ge=ce-He;return Math.abs((ce-Z)*st-(Q-j)*Ge)/Math.hypot(st,Ge)}(V.x,V.y,f.x,f.y,g.x,g.y)>=C?(yc(n,e,r,T,F,f,V,v,C),yc(n,T,F,s,u,V,g,v,C)):n.push(g)}function Jf(n,e,r){let s=n[0],u=s.x,f=s.y;e(s);const g=[s];for(let v=1;v<n.length;v++){const C=n[v],{x:T,y:F}=C;e(C),yc(g,u,f,T,F,s,C,e,r),u=T,f=F,s=C}return g}function $h(n,e,r,s){if(s(e,r)){const u=e.add(r)._mult(.5);$h(n,e,u,s),$h(n,u,r,s)}else n.push(r)}function M_(n,e){let r=n[0];const s=[r];for(let u=1;u<n.length;u++){const f=n[u];$h(s,r,f,e),r=f}return s}const Mm=Math.pow(2,14)-1,Pd=-Mm-1;function A_(n,e){const r=Math.round(n.x*e),s=Math.round(n.y*e);return n.x=Ht(r,Pd,Mm),n.y=Ht(s,Pd,Mm),(r<n.x||r>n.x+1||s<n.y||s>n.y+1)&&mn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function ic(n,e,r){const s=n.loadGeometry(),u=n.extent,f=Pr/u;if(e&&r&&r.projection.isReprojectedInTileSpace){const g=1<<e.z,{scale:v,x:C,y:T,projection:F}=r,V=j=>{const Z=Aa((e.x+j.x/u)/g),Q=Us((e.y+j.y/u)/g),ce=F.project(Z,Q);j.x=(ce.x*v-C)*u,j.y=(ce.y*v-T)*u};for(let j=0;j<s.length;j++)if(1!==n.type)s[j]=Jf(s[j],V,1);else{const Z=[];for(const Q of s[j])Q.x<0||Q.x>=u||Q.y<0||Q.y>=u||(V(Q),Z.push(Q));s[j]=Z}}for(const g of s)for(const v of g)A_(v,f);return s}function Gc(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?ic(n):[]}}function Rd(n,e,r,s,u){n.emplaceBack(2*e+(s+1)/2,2*r+(u+1)/2)}function Wu(n,e,r){n.emplaceBack(e.x,e.y,e.z,16384*r[0],16384*r[1],16384*r[2])}class Vh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new On,this.indexArray=new br,this.segments=new fs,this.programConfigurations=new uu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,s,u){const f=this.layers[0],g=[];let v=null;"circle"===f.type&&(v=f.layout.get("circle-sort-key"));for(const{feature:T,id:F,index:V,sourceLayerIndex:j}of e){const Z=this.layers[0]._featureFilter.needGeometry,Q=Gc(T,Z);if(!this.layers[0]._featureFilter.filter(new $(this.zoom),Q,s))continue;const ce=v?v.evaluate(Q,{},s):void 0,Te={id:F,properties:T.properties,type:T.type,sourceLayerIndex:j,index:V,geometry:Z?Q.geometry:ic(T,s,u),patterns:{},sortKey:ce};g.push(Te)}v&&g.sort((T,F)=>T.sortKey-F.sortKey);let C=null;"globe"===u.projection.name&&(this.globeExtVertexArray=new zn,C=u.projection);for(const T of g){const{geometry:F,index:V,sourceLayerIndex:j}=T,Z=e[V].feature;this.addFeature(T,F,V,r.availableImages,s,C),r.featureIndex.insert(Z,F,V,j,this.index)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ch.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,T_.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,s,u,f,g){for(const v of r)for(const C of v){const T=C.x,F=C.y;if(T<0||T>=Pr||F<0||F>=Pr)continue;if(g){const Z=g.projectTilePoint(T,F,f),Q=g.upVector(f,T,F),ce=this.globeExtVertexArray;Wu(ce,Z,Q),Wu(ce,Z,Q),Wu(ce,Z,Q),Wu(ce,Z,Q)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),j=V.vertexLength;Rd(this.layoutVertexArray,T,F,-1,-1),Rd(this.layoutVertexArray,T,F,1,-1),Rd(this.layoutVertexArray,T,F,1,1),Rd(this.layoutVertexArray,T,F,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u,f)}}function Od(n,e){for(let r=0;r<n.length;r++)if(Wc(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(Wc(n,e[r]))return!0;return!!qu(n,e)}function kd(n,e,r){return!!Wc(n,e)||!!Ld(e,n,r)}function Qf(n,e){if(1===n.length)return Pm(e,n[0]);for(let r=0;r<e.length;r++){const s=e[r];for(let u=0;u<s.length;u++)if(Wc(n,s[u]))return!0}for(let r=0;r<n.length;r++)if(Pm(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(qu(n,e[r]))return!0;return!1}function ep(n,e,r){if(n.length>1){if(qu(n,e))return!0;for(let s=0;s<e.length;s++)if(Ld(e[s],n,r))return!0}for(let s=0;s<n.length;s++)if(Ld(n[s],e,r))return!0;return!1}function qu(n,e){if(0===n.length||0===e.length)return!1;for(let r=0;r<n.length-1;r++){const s=n[r],u=n[r+1];for(let f=0;f<e.length-1;f++)if(Am(s,u,e[f],e[f+1]))return!0}return!1}function Am(n,e,r,s){return Bn(n,r,s)!==Bn(e,r,s)&&Bn(n,e,r)!==Bn(n,e,s)}function Ld(n,e,r){const s=r*r;if(1===e.length)return n.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(Zu(n,e[u-1],e[u])<s)return!0;return!1}function Zu(n,e,r){const s=e.distSqr(r);if(0===s)return n.distSqr(e);const u=((n.x-e.x)*(r.x-e.x)+(n.y-e.y)*(r.y-e.y))/s;return n.distSqr(u<0?e:u>1?r:r.sub(e)._mult(u)._add(e))}function Pm(n,e){let r,s,u,f=!1;for(let g=0;g<n.length;g++){r=n[g];for(let v=0,C=r.length-1;v<r.length;C=v++)s=r[v],u=r[C],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(f=!f)}return f}function Wc(n,e){let r=!1;for(let s=0,u=n.length-1;s<n.length;u=s++){const f=n[s],g=n[u];f.y>e.y!=g.y>e.y&&e.x<(g.x-f.x)*(e.y-f.y)/(g.y-f.y)+f.x&&(r=!r)}return r}function Rm(n,e,r,s,u){for(const g of n)if(e<=g.x&&r<=g.y&&s>=g.x&&u>=g.y)return!0;const f=[new Me(e,r),new Me(e,u),new Me(s,u),new Me(s,r)];if(n.length>2)for(const g of f)if(Wc(n,g))return!0;for(let g=0;g<n.length-1;g++)if(P_(n[g],n[g+1],f))return!0;return!1}function P_(n,e,r){const s=r[0],u=r[2];if(n.x<s.x&&e.x<s.x||n.x>u.x&&e.x>u.x||n.y<s.y&&e.y<s.y||n.y>u.y&&e.y>u.y)return!1;const f=Bn(n,e,r[0]);return f!==Bn(n,e,r[1])||f!==Bn(n,e,r[2])||f!==Bn(n,e,r[3])}function Yu(n,e,r){const s=e.paint.get(n).value;return"constant"===s.kind?s.value:r.programConfigurations.get(e.id).getMaxValue(n)}function Fd(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function tp(n,e,r,s,u){if(!e[0]&&!e[1])return n;const f=Me.convert(e)._mult(u);"viewport"===r&&f._rotate(-s);const g=[];for(let v=0;v<n.length;v++)g.push(n[v].sub(f));return g}function Bd(n,e,r,s){const u=Me.convert(n)._mult(s);return"viewport"===e&&u._rotate(-r),u}_(Vh,"CircleBucket",{omit:["layers"]});const np=new Xe({"circle-sort-key":new Ie(cn.layout_circle["circle-sort-key"])});var Xu={paint:new Xe({"circle-radius":new Ie(cn.paint_circle["circle-radius"]),"circle-color":new Ie(cn.paint_circle["circle-color"]),"circle-blur":new Ie(cn.paint_circle["circle-blur"]),"circle-opacity":new Ie(cn.paint_circle["circle-opacity"]),"circle-translate":new se(cn.paint_circle["circle-translate"]),"circle-translate-anchor":new se(cn.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new se(cn.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new se(cn.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ie(cn.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ie(cn.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ie(cn.paint_circle["circle-stroke-opacity"])}),layout:np};function Om(n,e,r,s,u,f,g,v,C){if(f&&n.queryGeometry.isAboveHorizon)return!1;f&&(C*=n.pixelToTileUnitsFactor);const T=n.tileID.canonical,F=r.projection.upVectorScale(T,r.center.lat,r.worldSize).metersToTile;for(const V of e)for(const j of V){const Z=j.add(v),Q=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(Z.x,Z.y,!0):0,ce=r.projection.projectTilePoint(Z.x,Z.y,T);if(Q>0){const Ge=r.projection.upVector(T,Z.x,Z.y);ce.x+=Ge[0]*F*Q,ce.y+=Ge[1]*F*Q,ce.z+=Ge[2]*F*Q}const Te=f?Z:R_(ce.x,ce.y,ce.z,s),He=f?n.tilespaceRays.map(Ge=>rp(Ge,Q)):n.queryGeometry.screenGeometry,st=zc([],[ce.x,ce.y,ce.z,1],s);if(!g&&f?C*=st[3]/r.cameraToCenterDistance:g&&!f&&(C*=r.cameraToCenterDistance/st[3]),f){const Ge=Us((j.y/Pr+T.y)/(1<<T.z));C/=r.projection.pixelsPerMeter(Ge,1)/Ga(1,Ge)}if(kd(He,Te,C))return!0}return!1}function R_(n,e,r,s){const u=zc([],[n,e,r,1],s);return new Me(u[0]/u[3],u[1]/u[3])}const O_=Ed(0,0,0),k_=Ed(0,0,1);function rp(n,e){const r=Ih();return O_[2]=e,n.intersectsPlane(O_,k_,r),new Me(r[0],r[1])}class km extends Vh{}function xu(n,{width:e,height:r},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*r*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*r*s);return n.width=e,n.height=r,n.data=u,n}function Nd(n,e,r){const{width:s,height:u}=e;s===n.width&&u===n.height||(zd(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,s),height:Math.min(n.height,u)},r),n.width=s,n.height=u,n.data=e.data)}function zd(n,e,r,s,u,f){if(0===u.width||0===u.height)return e;if(u.width>n.width||u.height>n.height||r.x>n.width-u.width||r.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,v=e.data;for(let C=0;C<u.height;C++){const T=((r.y+C)*n.width+r.x)*f,F=((s.y+C)*e.width+s.x)*f;for(let V=0;V<u.width*f;V++)v[F+V]=g[T+V]}return e}_(km,"HeatmapBucket",{omit:["layers"]});class oc{constructor(e,r){xu(this,e,1,r)}resize(e){Nd(this,new oc(e),1)}clone(){return new oc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,f){zd(e,r,s,u,f,1)}}class Pa{constructor(e,r){xu(this,e,4,r)}resize(e){Nd(this,new Pa(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Pa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,f){zd(e,r,s,u,f,4)}}_(oc,"AlphaImage"),_(Pa,"RGBAImage");var Lm={paint:new Xe({"heatmap-radius":new Ie(cn.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ie(cn.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new se(cn.paint_heatmap["heatmap-intensity"]),"heatmap-color":new We(cn.paint_heatmap["heatmap-color"]),"heatmap-opacity":new se(cn.paint_heatmap["heatmap-opacity"])})};function Uh(n){const e={},r=n.resolution||256,s=n.clips?n.clips.length:1,u=n.image||new Pa({width:r,height:s}),f=(g,v,C)=>{e[n.evaluationKey]=C;const T=n.expression.evaluate(e);u.data[g+v+0]=Math.floor(255*T.r/T.a),u.data[g+v+1]=Math.floor(255*T.g/T.a),u.data[g+v+2]=Math.floor(255*T.b/T.a),u.data[g+v+3]=Math.floor(255*T.a)};if(n.clips)for(let g=0,v=0;g<s;++g,v+=4*r)for(let C=0,T=0;C<r;C++,T+=4){const F=C/(r-1),{start:V,end:j}=n.clips[g];f(v,T,V*(1-F)+j*F)}else for(let g=0,v=0;g<r;g++,v+=4)f(0,v,g/(r-1));return u}var L_={paint:new Xe({"hillshade-illumination-direction":new se(cn.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new se(cn.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new se(cn.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new se(cn.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new se(cn.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new se(cn.paint_hillshade["hillshade-accent-color"])})};const F_=Mt([{name:"a_pos",components:2,type:"Int16"}],4),{members:B_}=F_;var ip={exports:{}};function jh(n,e,r){r=r||2;var s,u,f,g,v,C,T,F=e&&e.length,V=F?e[0]*r:n.length,j=vc(n,0,V,r,!0),Z=[];if(!j||j.next===j.prev)return Z;if(F&&(j=function(ce,Te,He,st){var Ge,at,yt,gt=[];for(Ge=0,at=Te.length;Ge<at;Ge++)(yt=vc(ce,Te[Ge]*st,Ge<at-1?Te[Ge+1]*st:ce.length,st,!1))===yt.next&&(yt.steiner=!0),gt.push(z_(yt));for(gt.sort(Tv),Ge=0;Ge<gt.length;Ge++)He=Fm(gt[Ge],He);return He}(n,e,j,r)),n.length>80*r){s=f=n[0],u=g=n[1];for(var Q=r;Q<V;Q+=r)(v=n[Q])<s&&(s=v),(C=n[Q+1])<u&&(u=C),v>f&&(f=v),C>g&&(g=C);T=0!==(T=Math.max(f-s,g-u))?32767/T:0}return $d(j,Z,r,s,u,T,0),Z}function vc(n,e,r,s,u){var f,g;if(u===Bm(n,e,r,s)>0)for(f=e;f<r;f+=s)g=V_(f,n[f],n[f+1],g);else for(f=r-s;f>=e;f-=s)g=V_(f,n[f],n[f+1],g);return g&&qc(g,g.next)&&(bu(g),g=g.next),g}function Ol(n,e){if(!n)return n;e||(e=n);var r,s=n;do{if(r=!1,s.steiner||!qc(s,s.next)&&0!==yo(s.prev,s,s.next))s=s.next;else{if(bu(s),(s=e=s.prev)===s.next)break;r=!0}}while(r||s!==e);return e}function $d(n,e,r,s,u,f,g){if(n){!g&&f&&function(F,V,j,Z){var Q=F;do{0===Q.z&&(Q.z=op(Q.x,Q.y,V,j,Z)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next}while(Q!==F);Q.prevZ.nextZ=null,Q.prevZ=null,function(ce){var Te,He,st,Ge,at,yt,gt,tn,Zt=1;do{for(He=ce,ce=null,at=null,yt=0;He;){for(yt++,st=He,gt=0,Te=0;Te<Zt&&(gt++,st=st.nextZ);Te++);for(tn=Zt;gt>0||tn>0&&st;)0!==gt&&(0===tn||!st||He.z<=st.z)?(Ge=He,He=He.nextZ,gt--):(Ge=st,st=st.nextZ,tn--),at?at.nextZ=Ge:ce=Ge,Ge.prevZ=at,at=Ge;He=st}at.nextZ=null,Zt*=2}while(yt>1)}(Q)}(n,s,u,f);for(var v,C,T=n;n.prev!==n.next;)if(v=n.prev,C=n.next,f?Ev(n,s,u,f):wv(n))e.push(v.i/r|0),e.push(n.i/r|0),e.push(C.i/r|0),bu(n),n=C.next,T=C.next;else if((n=C)===T){g?1===g?$d(n=Dv(Ol(n),e,r),e,r,s,u,f,2):2===g&&Cv(n,e,r,s,u,f):$d(Ol(n),e,r,s,u,f,1);break}}}function wv(n){var e=n.prev,r=n,s=n.next;if(yo(e,r,s)>=0)return!1;for(var u=e.x,f=r.x,g=s.x,v=e.y,C=r.y,T=s.y,F=u<f?u<g?u:g:f<g?f:g,V=v<C?v<T?v:T:C<T?C:T,j=u>f?u>g?u:g:f>g?f:g,Z=v>C?v>T?v:T:C>T?C:T,Q=s.next;Q!==e;){if(Q.x>=F&&Q.x<=j&&Q.y>=V&&Q.y<=Z&&Ku(u,v,f,C,g,T,Q.x,Q.y)&&yo(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function Ev(n,e,r,s){var u=n.prev,f=n,g=n.next;if(yo(u,f,g)>=0)return!1;for(var v=u.x,C=f.x,T=g.x,F=u.y,V=f.y,j=g.y,Z=v<C?v<T?v:T:C<T?C:T,Q=F<V?F<j?F:j:V<j?V:j,ce=v>C?v>T?v:T:C>T?C:T,Te=F>V?F>j?F:j:V>j?V:j,He=op(Z,Q,e,r,s),st=op(ce,Te,e,r,s),Ge=n.prevZ,at=n.nextZ;Ge&&Ge.z>=He&&at&&at.z<=st;){if(Ge.x>=Z&&Ge.x<=ce&&Ge.y>=Q&&Ge.y<=Te&&Ge!==u&&Ge!==g&&Ku(v,F,C,V,T,j,Ge.x,Ge.y)&&yo(Ge.prev,Ge,Ge.next)>=0||(Ge=Ge.prevZ,at.x>=Z&&at.x<=ce&&at.y>=Q&&at.y<=Te&&at!==u&&at!==g&&Ku(v,F,C,V,T,j,at.x,at.y)&&yo(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;Ge&&Ge.z>=He;){if(Ge.x>=Z&&Ge.x<=ce&&Ge.y>=Q&&Ge.y<=Te&&Ge!==u&&Ge!==g&&Ku(v,F,C,V,T,j,Ge.x,Ge.y)&&yo(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.prevZ}for(;at&&at.z<=st;){if(at.x>=Z&&at.x<=ce&&at.y>=Q&&at.y<=Te&&at!==u&&at!==g&&Ku(v,F,C,V,T,j,at.x,at.y)&&yo(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function Dv(n,e,r){var s=n;do{var u=s.prev,f=s.next.next;!qc(u,f)&&ap(u,s,s.next,f)&&Hh(u,f)&&Hh(f,u)&&(e.push(u.i/r|0),e.push(s.i/r|0),e.push(f.i/r|0),bu(s),bu(s.next),s=n=f),s=s.next}while(s!==n);return Ol(s)}function Cv(n,e,r,s,u,f){var g=n;do{for(var v=g.next.next;v!==g.prev;){if(g.i!==v.i&&sp(g,v)){var C=$_(g,v);return g=Ol(g,g.next),C=Ol(C,C.next),$d(g,e,r,s,u,f,0),void $d(C,e,r,s,u,f,0)}v=v.next}g=g.next}while(g!==n)}function Tv(n,e){return n.x-e.x}function Fm(n,e){var r=function(u,f){var g,v=f,C=u.x,T=u.y,F=-1/0;do{if(T<=v.y&&T>=v.next.y&&v.next.y!==v.y){var V=v.x+(T-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(V<=C&&V>F&&(F=V,g=v.x<v.next.x?v:v.next,V===C))return g}v=v.next}while(v!==f);if(!g)return null;var j,Z=g,Q=g.x,ce=g.y,Te=1/0;v=g;do{C>=v.x&&v.x>=Q&&C!==v.x&&Ku(T<ce?C:F,T,Q,ce,T<ce?F:C,T,v.x,v.y)&&(j=Math.abs(T-v.y)/(C-v.x),Hh(v,u)&&(j<Te||j===Te&&(v.x>g.x||v.x===g.x&&N_(g,v)))&&(g=v,Te=j)),v=v.next}while(v!==Z);return g}(n,e);if(!r)return e;var s=$_(r,n);return Ol(s,s.next),Ol(r,r.next)}function N_(n,e){return yo(n.prev,n,e.prev)<0&&yo(e.next,n,n.next)<0}function op(n,e,r,s,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function z_(n){var e=n,r=n;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==n);return r}function Ku(n,e,r,s,u,f,g,v){return(u-g)*(e-v)>=(n-g)*(f-v)&&(n-g)*(s-v)>=(r-g)*(e-v)&&(r-g)*(f-v)>=(u-g)*(s-v)}function sp(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(r,s){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==s.i&&u.next.i!==s.i&&ap(u,u.next,r,s))return!0;u=u.next}while(u!==r);return!1}(n,e)&&(Hh(n,e)&&Hh(e,n)&&function(r,s){var u=r,f=!1,g=(r.x+s.x)/2,v=(r.y+s.y)/2;do{u.y>v!=u.next.y>v&&u.next.y!==u.y&&g<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next}while(u!==r);return f}(n,e)&&(yo(n.prev,n,e.prev)||yo(n,e.prev,e))||qc(n,e)&&yo(n.prev,n,n.next)>0&&yo(e.prev,e,e.next)>0)}function yo(n,e,r){return(e.y-n.y)*(r.x-e.x)-(e.x-n.x)*(r.y-e.y)}function qc(n,e){return n.x===e.x&&n.y===e.y}function ap(n,e,r,s){var u=Ud(yo(n,e,r)),f=Ud(yo(n,e,s)),g=Ud(yo(r,s,n)),v=Ud(yo(r,s,e));return u!==f&&g!==v||!(0!==u||!Vd(n,r,e))||!(0!==f||!Vd(n,s,e))||!(0!==g||!Vd(r,n,s))||!(0!==v||!Vd(r,e,s))}function Vd(n,e,r){return e.x<=Math.max(n.x,r.x)&&e.x>=Math.min(n.x,r.x)&&e.y<=Math.max(n.y,r.y)&&e.y>=Math.min(n.y,r.y)}function Ud(n){return n>0?1:n<0?-1:0}function Hh(n,e){return yo(n.prev,n,n.next)<0?yo(n,e,n.next)>=0&&yo(n,n.prev,e)>=0:yo(n,e,n.prev)<0||yo(n,n.next,e)<0}function $_(n,e){var r=new jd(n.i,n.x,n.y),s=new jd(e.i,e.x,e.y),u=n.next,f=e.prev;return n.next=e,e.prev=n,r.next=u,u.prev=r,s.next=r,r.prev=s,f.next=s,s.prev=f,s}function V_(n,e,r,s){var u=new jd(n,e,r);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function bu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function jd(n,e,r){this.i=n,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bm(n,e,r,s){for(var u=0,f=e,g=r-s;f<r;f+=s)u+=(n[g]-n[f])*(n[f+1]+n[g+1]),g=f;return u}ip.exports=jh,ip.exports.default=jh,jh.deviation=function(n,e,r,s){var u=e&&e.length,f=Math.abs(Bm(n,0,u?e[0]*r:n.length,r));if(u)for(var g=0,v=e.length;g<v;g++)f-=Math.abs(Bm(n,e[g]*r,g<v-1?e[g+1]*r:n.length,r));var C=0;for(g=0;g<s.length;g+=3){var T=s[g]*r,F=s[g+1]*r,V=s[g+2]*r;C+=Math.abs((n[T]-n[V])*(n[F+1]-n[T+1])-(n[T]-n[F])*(n[V+1]-n[T+1]))}return 0===f&&0===C?0:Math.abs((C-f)/f)},jh.flatten=function(n){for(var e=n[0][0].length,r={vertices:[],holes:[],dimensions:e},s=0,u=0;u<n.length;u++){for(var f=0;f<n[u].length;f++)for(var g=0;g<e;g++)r.vertices.push(n[u][f][g]);u>0&&r.holes.push(s+=n[u-1].length)}return r};var Nm=vt(ip.exports);function zm(n,e,r,s,u){$m(n,e,r||0,s||n.length-1,u||U_)}function $m(n,e,r,s,u){for(;s>r;){if(s-r>600){var f=s-r+1,g=e-r+1,v=Math.log(f),C=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*C*(f-C)/f)*(g-f/2<0?-1:1);$m(n,e,Math.max(r,Math.floor(e-g*C/f+T)),Math.min(s,Math.floor(e+(f-g)*C/f+T)),u)}var F=n[e],V=r,j=s;for(Hd(n,r,e),u(n[s],F)>0&&Hd(n,r,s);V<j;){for(Hd(n,V,j),V++,j--;u(n[V],F)<0;)V++;for(;u(n[j],F)>0;)j--}0===u(n[r],F)?Hd(n,r,j):Hd(n,++j,s),j<=e&&(r=j+1),e<=j&&(s=j-1)}}function Hd(n,e,r){var s=n[e];n[e]=n[r],n[r]=s}function U_(n,e){return n<e?-1:n>e?1:0}function lp(n,e){const r=n.length;if(r<=1)return[n];const s=[];let u,f;for(let g=0;g<r;g++){const v=mr(n[g]);0!==v&&(n[g].area=Math.abs(v),void 0===f&&(f=v<0),f===v<0?(u&&s.push(u),u=[n[g]]):u.push(n[g]))}if(u&&s.push(u),e>1)for(let g=0;g<s.length;g++)s[g].length<=e||(zm(s[g],e,1,s[g].length-1,Vm),s[g]=s[g].slice(0,e));return s}function Vm(n,e){return e.area-n.area}function Ju(n,e,r){const s=r.patternDependencies;let u=!1;for(const f of e){const g=f.paint.get(`${n}-pattern`);g.isConstant()||(u=!0);const v=g.constantOr(null);v&&(u=!0,s[v]=!0)}return u}function cp(n,e,r,s,u){const f=u.patternDependencies;for(const g of e){const v=g.paint.get(`${n}-pattern`).value;if("constant"!==v.kind){let C=v.evaluate({zoom:s},r,{},u.availableImages);C=C&&C.name?C.name:C,f[C]=!0,r.patterns[g.id]=C}}return r}class Qu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new On,this.indexArray=new br,this.indexArray2=new zs,this.programConfigurations=new uu(e.layers,e.zoom),this.segments=new fs,this.segments2=new fs,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,s,u){this.hasPattern=Ju("fill",this.layers,r);const f=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:v,id:C,index:T,sourceLayerIndex:F}of e){const V=this.layers[0]._featureFilter.needGeometry,j=Gc(v,V);if(!this.layers[0]._featureFilter.filter(new $(this.zoom),j,s))continue;const Z=f?f.evaluate(j,{},s,r.availableImages):void 0,Q={id:C,properties:v.properties,type:v.type,sourceLayerIndex:F,index:T,geometry:V?j.geometry:ic(v,s,u),patterns:{},sortKey:Z};g.push(Q)}f&&g.sort((v,C)=>v.sortKey-C.sortKey);for(const v of g){const{geometry:C,index:T,sourceLayerIndex:F}=v;if(this.hasPattern){const V=cp("fill",this.layers,v,this.zoom,r);this.patternFeatures.push(V)}else this.addFeature(v,C,T,s,{},r.availableImages);r.featureIndex.insert(e[T].feature,C,T,F,this.index)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}addFeatures(e,r,s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,B_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,s,u,f,g=[]){for(const v of lp(r,500)){let C=0;for(const Q of v)C+=Q.length;const T=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),F=T.vertexLength,V=[],j=[];for(const Q of v){if(0===Q.length)continue;Q!==v[0]&&j.push(V.length/2);const ce=this.segments2.prepareSegment(Q.length,this.layoutVertexArray,this.indexArray2),Te=ce.vertexLength;this.layoutVertexArray.emplaceBack(Q[0].x,Q[0].y),this.indexArray2.emplaceBack(Te+Q.length-1,Te),V.push(Q[0].x),V.push(Q[0].y);for(let He=1;He<Q.length;He++)this.layoutVertexArray.emplaceBack(Q[He].x,Q[He].y),this.indexArray2.emplaceBack(Te+He-1,Te+He),V.push(Q[He].x),V.push(Q[He].y);ce.vertexLength+=Q.length,ce.primitiveLength+=Q.length}const Z=Nm(V,j);for(let Q=0;Q<Z.length;Q+=3)this.indexArray.emplaceBack(F+Z[Q],F+Z[Q+1],F+Z[Q+2]);T.vertexLength+=C,T.primitiveLength+=Z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}}_(Qu,"FillBucket",{omit:["layers","patternFeatures"]});const j_=new Xe({"fill-sort-key":new Ie(cn.layout_fill["fill-sort-key"])});var ed={paint:new Xe({"fill-antialias":new se(cn.paint_fill["fill-antialias"]),"fill-opacity":new Ie(cn.paint_fill["fill-opacity"]),"fill-color":new Ie(cn.paint_fill["fill-color"]),"fill-outline-color":new Ie(cn.paint_fill["fill-outline-color"]),"fill-translate":new se(cn.paint_fill["fill-translate"]),"fill-translate-anchor":new se(cn.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ie(cn.paint_fill["fill-pattern"])}),layout:j_};const H_=Mt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),G_=Mt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Um=Mt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:jm}=H_;var Gh={},W_=Ft,Hm=td;function td(n,e,r,s,u){this.properties={},this.extent=r,this.type=0,this._pbf=n,this._geometry=-1,this._keys=s,this._values=u,n.readFields(Gm,this,e)}function Gm(n,e,r){1==n?e.id=r.readVarint():2==n?function(s,u){for(var f=s.readVarint()+s.pos;s.pos<f;){var g=u._keys[s.readVarint()],v=u._values[s.readVarint()];u.properties[g]=v}}(r,e):3==n?e.type=r.readVarint():4==n&&(e._geometry=r.pos)}function Sv(n){for(var e,r,s=0,u=0,f=n.length,g=f-1;u<f;g=u++)s+=((r=n[g]).x-(e=n[u]).x)*(e.y+r.y);return s}td.types=["Unknown","Point","LineString","Polygon"],td.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,r=n.readVarint()+n.pos,s=1,u=0,f=0,g=0,v=[];n.pos<r;){if(u<=0){var C=n.readVarint();s=7&C,u=C>>3}if(u--,1===s||2===s)f+=n.readSVarint(),g+=n.readSVarint(),1===s&&(e&&v.push(e),e=[]),e.push(new W_(f,g));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},td.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,r=1,s=0,u=0,f=0,g=1/0,v=-1/0,C=1/0,T=-1/0;n.pos<e;){if(s<=0){var F=n.readVarint();r=7&F,s=F>>3}if(s--,1===r||2===r)(u+=n.readSVarint())<g&&(g=u),u>v&&(v=u),(f+=n.readSVarint())<C&&(C=f),f>T&&(T=f);else if(7!==r)throw new Error("unknown command "+r)}return[g,C,v,T]},td.prototype.toGeoJSON=function(n,e,r){var s,u,f=this.extent*Math.pow(2,r),g=this.extent*n,v=this.extent*e,C=this.loadGeometry(),T=td.types[this.type];function F(Z){for(var Q=0;Q<Z.length;Q++){var ce=Z[Q];Z[Q]=[360*(ce.x+g)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(ce.y+v)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(s=0;s<C.length;s++)V[s]=C[s][0];F(C=V);break;case 2:for(s=0;s<C.length;s++)F(C[s]);break;case 3:for(C=function(Z){var Q=Z.length;if(Q<=1)return[Z];for(var ce,Te,He=[],st=0;st<Q;st++){var Ge=Sv(Z[st]);0!==Ge&&(void 0===Te&&(Te=Ge<0),Te===Ge<0?(ce&&He.push(ce),ce=[Z[st]]):ce.push(Z[st]))}return ce&&He.push(ce),He}(C),s=0;s<C.length;s++)for(u=0;u<C[s].length;u++)F(C[s][u])}1===C.length?C=C[0]:T="Multi"+T;var j={type:"Feature",geometry:{type:T,coordinates:C},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Iv=Hm,nd=mo;function mo(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(Gd,this,e),this.length=this._features.length}function Gd(n,e,r){15===n?e.version=r.readVarint():1===n?e.name=r.readString():5===n?e.extent=r.readVarint():2===n?e._features.push(r.pos):3===n?e._keys.push(r.readString()):4===n&&e._values.push(function(s){for(var u=null,f=s.readVarint()+s.pos;s.pos<f;){var g=s.readVarint()>>3;u=1===g?s.readString():2===g?s.readFloat():3===g?s.readDouble():4===g?s.readVarint64():5===g?s.readVarint():6===g?s.readSVarint():7===g?s.readBoolean():null}return u}(r))}mo.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new Iv(this._pbf,e,this.extent,this._keys,this._values)};var Wm=nd;function qm(n,e,r){if(3===n){var s=new Wm(r,r.readVarint()+r.pos);s.length&&(e[s.name]=s)}}var Wd=Gh.VectorTile=function(n,e){this.layers=n.readFields(qm,{},e)},rd=Gh.VectorTileFeature=Hm;function Wh(n,e,r,s){const u=[],f=0===s?(g,v,C,T,F,V)=>{g.push(new Me(V,C+(V-v)/(T-v)*(F-C)))}:(g,v,C,T,F,V)=>{g.push(new Me(v+(V-C)/(F-C)*(T-v),V))};for(const g of n){const v=[];for(const C of g){if(C.length<=2)continue;const T=[];for(let j=0;j<C.length-1;j++){const Z=C[j].x,Q=C[j].y,ce=C[j+1].x,Te=C[j+1].y,He=0===s?Z:Q,st=0===s?ce:Te;He<e?st>e&&f(T,Z,Q,ce,Te,e):He>r?st<r&&f(T,Z,Q,ce,Te,r):T.push(C[j]),st<e&&He>=e&&f(T,Z,Q,ce,Te,e),st>r&&He<=r&&f(T,Z,Q,ce,Te,r)}let F=C[C.length-1];const V=0===s?F.x:F.y;V>=e&&V<=r&&T.push(F),T.length&&(F=T[T.length-1],T[0].x===F.x&&T[0].y===F.y||T.push(T[0]),v.push(T))}v.length&&u.push(v)}return u}Gh.VectorTileLayer=nd;const Zm=rd.types,Ym=Math.pow(2,13);function Zc(n,e,r,s,u,f,g,v){n.emplaceBack((e<<1)+g,(r<<1)+f,(Math.floor(s*Ym)<<1)+u,Math.round(v))}function qh(n,e,r){n.emplaceBack(e.x,e.y,e.z,16384*r[0],16384*r[1],16384*r[2])}class Zh{constructor(){this.acc=new Me(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Me(e.x,e.y),this.max=new Me(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,u=this.max;e.x<s.x?s.x=e.x:e.x>u.x&&(u.x=e.x),e.y<s.y?s.y=e.y:e.y>u.y&&(u.y=e.y),((0===e.x||e.x===Pr)&&e.x===r.x)!=((0===e.y||e.y===Pr)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,J(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>Pr!=e.x>Pr&&this.addBorderIntersection(1,J(r.y,e.y,(Pr-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,J(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>Pr!=e.y>Pr&&this.addBorderIntersection(3,J(r.x,e.x,(Pr-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];r<s[0]&&(s[0]=r),r>s[1]&&(s[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,r.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,r.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((r,s)=>r+s.edges,0);return 0!==e?this.acc.div(e)._round():new Me(0,0)}span(){return new Me(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class qd{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Tn,this.centroidVertexArray=new Jl,this.indexArray=new br,this.programConfigurations=new uu(e.layers,e.zoom),this.segments=new fs,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,s,u){this.features=[],this.hasPattern=Ju("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const g=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*g/(g*g+1)/Pr/(1<<f.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:g,index:v,sourceLayerIndex:C}of e){const T=this.layers[0]._featureFilter.needGeometry,F=Gc(f,T);if(!this.layers[0]._featureFilter.filter(new $(this.zoom),F,s))continue;const V={id:g,sourceLayerIndex:C,index:v,geometry:T?F.geometry:ic(f,s,u),properties:f.properties,type:f.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(cp("fill-extrusion",this.layers,V,this.zoom,r)):this.addFeature(V,V.geometry,v,s,{},r.availableImages,u),r.featureIndex.insert(f,V.geometry,v,C,this.index,j)}this.sortBorders()}addFeatures(e,r,s,u,f){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,r,s,u,f)}this.sortBorders()}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Um.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,G_.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,s,u,f,g,v){const C=[new Me(0,0),new Me(Pr,Pr)],T=v.projection,F="globe"===T.name,V=this.enableTerrain&&!F?new Zh:null,j="Polygon"===Zm[e.type];F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new zn);const Z=lp(r,500);for(let He=Z.length-1;He>=0;He--){const st=Z[He];(0===st.length||(Q=st[0]).every(Ge=>Ge.x<=0)||Q.every(Ge=>Ge.x>=Pr)||Q.every(Ge=>Ge.y<=0)||Q.every(Ge=>Ge.y>=Pr))&&Z.splice(He,1)}var Q;let ce;if(F)ce=Jm(Z,C,u);else{ce=[];for(const He of Z)ce.push({polygon:He,bounds:C})}const Te=j?this.edgeRadius:0;for(const{polygon:He,bounds:st}of ce){let Ge=0,at=0;for(const gt of He)j&&!gt[0].equals(gt[gt.length-1])&&gt.push(gt[0]),at+=j?gt.length-1:gt.length;const yt=this.segments.prepareSegment((j?5:4)*at,this.layoutVertexArray,this.indexArray);if(j){const gt=[],tn=[];Ge=yt.vertexLength;for(const gn of He){let Ln,ln;gn.length&&gn!==He[0]&&tn.push(gt.length/2),Ln=gn[1].sub(gn[0])._perp()._unit();for(let Sn=1;Sn<gn.length;Sn++){const In=gn[Sn],kn=gn[Sn===gn.length-1?1:Sn+1];let{x:Un,y:_n}=In;if(Te){ln=kn.sub(In)._perp()._unit();const tr=Ln.add(ln)._unit(),pr=Te*Math.min(4,1/(Ln.x*tr.x+Ln.y*tr.y));Un+=pr*tr.x,_n+=pr*tr.y,Ln=ln}Zc(this.layoutVertexArray,Un,_n,0,0,1,1,0),yt.vertexLength++,gt.push(In.x,In.y),F&&qh(this.layoutVertexExtArray,T.projectTilePoint(Un,_n,u),T.upVector(u,Un,_n))}}const Zt=Nm(gt,tn);for(let gn=0;gn<Zt.length;gn+=3)this.indexArray.emplaceBack(Ge+Zt[gn],Ge+Zt[gn+2],Ge+Zt[gn+1]),yt.primitiveLength++}for(const gt of He){V&&gt.length&&V.startRing(gt[0]);let tn,Zt,gn,Ln=gt.length>4&&Km(gt[gt.length-2],gt[0],gt[1]),ln=Te?Xm(gt[gt.length-2],gt[0],gt[1],Te):0;Zt=gt[1].sub(gt[0])._perp()._unit();let Sn=!0;for(let In=1,kn=0;In<gt.length;In++){let Un=gt[In-1],_n=gt[In];const tr=gt[In===gt.length-1?1:In+1];if(V&&j&&V.currentPolyCount.top++,Yc(_n,Un,st)){Te&&(Zt=tr.sub(_n)._perp()._unit(),Sn=!Sn);continue}V&&V.append(_n,Un);const pr=_n.sub(Un)._perp(),ar=pr.x/(Math.abs(pr.x)+Math.abs(pr.y)),ii=pr.y>0?1:0,jn=Un.dist(_n);if(kn+jn>32768&&(kn=0),Te){gn=tr.sub(_n)._perp()._unit();let li=up(Un,_n,tr,Yh(Zt,gn),Te);isNaN(li)&&(li=0);const Gr=_n.sub(Un)._unit();Un=Un.add(Gr.mult(ln))._round(),_n=_n.add(Gr.mult(-li))._round(),ln=li,Zt=gn}const Ir=yt.vertexLength,si=gt.length>4&&Km(Un,_n,tr);let Hi=Xh(kn,Ln,Sn);if(Zc(this.layoutVertexArray,Un.x,Un.y,ar,ii,0,0,Hi),Zc(this.layoutVertexArray,Un.x,Un.y,ar,ii,0,1,Hi),kn+=jn,Hi=Xh(kn,si,!Sn),Ln=si,Zc(this.layoutVertexArray,_n.x,_n.y,ar,ii,0,0,Hi),Zc(this.layoutVertexArray,_n.x,_n.y,ar,ii,0,1,Hi),yt.vertexLength+=4,this.indexArray.emplaceBack(Ir+0,Ir+1,Ir+2),this.indexArray.emplaceBack(Ir+1,Ir+3,Ir+2),yt.primitiveLength+=2,Te){const li=Ge+(1===In?gt.length-2:In-2),Gr=1===In?Ge:li+1;if(this.indexArray.emplaceBack(Ir+1,li,Ir+3),this.indexArray.emplaceBack(li,Gr,Ir+3),yt.primitiveLength+=2,void 0===tn&&(tn=Ir),!Yc(tr,gt[In],st)){const Ao=In===gt.length-1?tn:yt.vertexLength;this.indexArray.emplaceBack(Ir+2,Ir+3,Ao),this.indexArray.emplaceBack(Ir+3,Ao+1,Ao),this.indexArray.emplaceBack(Ir+3,Gr,Ao+1),yt.primitiveLength+=3}Sn=!Sn}if(F){const li=this.layoutVertexExtArray,Gr=T.projectTilePoint(Un.x,Un.y,u),Ao=T.projectTilePoint(_n.x,_n.y,u),di=T.upVector(u,Un.x,Un.y),ci=T.upVector(u,_n.x,_n.y);qh(li,Gr,di),qh(li,Gr,di),qh(li,Ao,ci),qh(li,Ao,ci)}}j&&(Ge+=gt.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const He=V.borders,st=this.featuresOnBorder.push(V)-1;for(let Ge=0;Ge<4;Ge++)He[Ge][0]!==Number.MAX_VALUE&&this.borders[Ge].push(st)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,s)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,r,s=!0){let u,f;if(e)if(0!==e.y){const v=r.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(v.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+s;let g=s?this.centroidVertexArray.length:r.vertexArrayOffset;for(const v of r.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let C=0;C<v.top;C++)this.centroidVertexArray.emplace(g++,u,f);for(let C=0;C<2*v.edges;C++)this.centroidVertexArray.emplace(g++,0,f),this.centroidVertexArray.emplace(g++,u,f)}}}function Yh(n,e){const r=n.add(e)._unit();return n.x*r.x+n.y*r.y}function Xm(n,e,r,s){const u=e.sub(n)._perp()._unit(),f=r.sub(e)._perp()._unit();return up(n,e,r,Yh(u,f),s)}function up(n,e,r,s,u){const f=Math.sqrt(1-s*s);return Math.min(n.dist(e)/3,e.dist(r)/3,u*f/s)}function Yc(n,e,r){return n.x<r[0].x&&e.x<r[0].x||n.x>r[1].x&&e.x>r[1].x||n.y<r[0].y&&e.y<r[0].y||n.y>r[1].y&&e.y>r[1].y}function Km(n,e,r){if(n.x<0||n.x>=Pr||e.x<0||e.x>=Pr||r.x<0||r.x>=Pr)return!1;const s=r.sub(e),u=s.perp(),f=n.sub(e);return(s.x*f.x+s.y*f.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function Xh(n,e,r){const s=e?2|n:-3&n;return r?1|s:-2&s}function Zd(){const n=Math.PI/32,e=Math.tan(n),r=Ad;return r*Math.sqrt(1+2*e*e)-r}function Jm(n,e,r){const s=1<<r.z,u=Aa(r.x/s),f=Aa((r.x+1)/s),g=Us(r.y/s),v=Us((r.y+1)/s);return function(C,T,F,V,j=0,Z){const Q=[];if(!C.length||!F||!V)return Q;const ce=(gt,tn)=>{for(const Zt of gt)Q.push({polygon:Zt,bounds:tn})},Te=Math.ceil(Math.log2(F)),He=Math.ceil(Math.log2(V)),st=Te-He,Ge=[];for(let gt=0;gt<Math.abs(st);gt++)Ge.push(st>0?0:1);for(let gt=0;gt<Math.min(Te,He);gt++)Ge.push(0),Ge.push(1);let at=C;if(at=Wh(at,T[0].y-j,T[1].y+j,1),at=Wh(at,T[0].x-j,T[1].x+j,0),!at.length)return Q;const yt=[];for(Ge.length?yt.push({polygons:at,bounds:T,depth:0}):ce(at,T);yt.length;){const gt=yt.pop(),tn=gt.depth,Zt=Ge[tn],gn=gt.bounds[0],Ln=gt.bounds[1],ln=0===Zt?gn.x:gn.y,Sn=0===Zt?Ln.x:Ln.y,In=Z?Z(Zt,ln,Sn):.5*(ln+Sn),kn=Wh(gt.polygons,ln-j,In+j,Zt),Un=Wh(gt.polygons,In-j,Sn+j,Zt);if(kn.length){const _n=[gn,new Me(0===Zt?In:Ln.x,1===Zt?In:Ln.y)];Ge.length>tn+1?yt.push({polygons:kn,bounds:_n,depth:tn+1}):ce(kn,_n)}if(Un.length){const _n=[new Me(0===Zt?In:gn.x,1===Zt?In:gn.y),Ln];Ge.length>tn+1?yt.push({polygons:Un,bounds:_n,depth:tn+1}):ce(Un,_n)}}return Q}(n,e,Math.ceil((f-u)/11.25),Math.ceil((g-v)/11.25),1,(C,T,F)=>{if(0===C)return.5*(T+F);{const V=Us((r.y+T/Pr)/s);return(Rl(.5*(Us((r.y+F/Pr)/s)+V))*s-r.y)*Pr}})}_(qd,"FillExtrusionBucket",{omit:["layers","features"]}),_(Zh,"PartMetadata");const dp=new Xe({"fill-extrusion-edge-radius":new se(cn["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Kh={paint:new Xe({"fill-extrusion-opacity":new se(cn["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ie(cn["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new se(cn["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new se(cn["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ie(cn["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ie(cn["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ie(cn["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new se(cn["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new se(cn["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new se(cn["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new se(cn["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:dp};function kl(n,e,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[n*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class wu{constructor(e,r,s){this.z=e,this.x=r,this.y=s,this.key=Yd(0,e,e,r,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const s=(g=this.y,v=this.z,C=kl(256*(f=this.x),256*(g=Math.pow(2,v)-g-1),v),T=kl(256*(f+1),256*(g+1),v),C[0]+","+C[1]+","+T[0]+","+T[1]),u=function(f,g,v){let C,T="";for(let F=f;F>0;F--)C=1<<F-1,T+=(g&C?1:0)+(v&C?2:0);return T}(this.z,this.x,this.y);var f,g,v,C,T;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Jh{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Yd(e,r.z,r.z,r.x,r.y)}}class ga{constructor(e,r,s,u,f){this.overscaledZ=e,this.wrap=r,this.canonical=new wu(s,+u,+f),this.key=0===r&&e===s?this.canonical.key:Yd(r,e,s,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new ga(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ga(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return Yd(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return Yd(this.wrap*+r,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new ga(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new ga(r,this.wrap,r,s,u),new ga(r,this.wrap,r,s+1,u),new ga(r,this.wrap,r,s,u+1),new ga(r,this.wrap,r,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ga(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ga(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Jh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Yd(n,e,r,s,u){const f=1<<Math.min(r,22);let g=f*(u%f)+s%f;return n&&r<22&&(g+=f*f*((n<0?-2*n-1:2*n)%(1<<2*(22-r)))),16*(32*g+r)+(e-r)}_(wu,"CanonicalTileID"),_(ga,"OverscaledTileID",{omit:["projMatrix"]});class Eu extends Me{constructor(e,r,s){super(e,r),this.z=s}}function sc(n,e){return n.x*e.x+n.y*e.y}function Qm(n,e){if(1===n.length){let r=0;const s=e[r++];let u;for(;!u||s.equals(u);)if(u=e[r++],!u)return 1/0;for(;r<e.length;r++){const f=e[r],g=n[0],v=u.sub(s),C=f.sub(s),T=g.sub(s),F=sc(v,v),V=sc(v,C),j=sc(C,C),Z=sc(T,v),Q=sc(T,C),ce=F*j-V*V,Te=(j*Z-V*Q)/ce,He=(F*Q-V*Z)/ce,st=s.z*(1-Te-He)+u.z*Te+f.z*He;if(isFinite(st))return st}return 1/0}{let r=1/0;for(const s of e)r=Math.min(r,s.z);return r}}function eg(n,e,r,s,u,f,g,v){const C=g*u.getElevationAt(n,e,!0,!0),T=0!==f[0],F=T?0===f[1]?g*(f[0]/7-450):g*function(V,j,Z){const Q=Math.floor(j[0]/8),ce=Math.floor(j[1]/8),Te=10*(j[0]-8*Q),He=10*(j[1]-8*ce),st=V.getElevationAt(Q,ce,!0,!0),Ge=V.getMeterToDEM(Z),at=Math.floor(.5*(Te*Ge-1)),yt=Math.floor(.5*(He*Ge-1)),gt=V.tileCoordToPixel(Q,ce),tn=2*at+1,Zt=2*yt+1,gn=(pr=tn,ar=Zt,[(Un=V).getElevationAtPixel(_n=gt.x-at,tr=gt.y-yt,!0),Un.getElevationAtPixel(_n+ar,tr,!0),Un.getElevationAtPixel(_n,tr+ar,!0),Un.getElevationAtPixel(_n+pr,tr+ar,!0)]),Ln=Math.abs(gn[0]-gn[1]),ln=Math.abs(gn[2]-gn[3]),Sn=Math.abs(gn[0]-gn[2])+Math.abs(gn[1]-gn[3]),In=Math.min(.25,.5*Ge*(Ln+ln)/tn),kn=Math.min(.25,.5*Ge*Sn/Zt);var Un,_n,tr,pr,ar;return st+Math.max(In*Te,kn*He)}(u,f,v):C;return{base:C+(0===r)?-1:r,top:T?Math.max(F+s,C+r+2):C+s}}const q_=Mt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:hp}=q_,tg=Mt([{name:"a_packed",components:4,type:"Float32"}]),{members:Z_}=tg,ng=rd.types,fp=Math.cos(Math.PI/180*37.5);class pp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new un,this.layoutVertexArray2=new Fn,this.indexArray=new br,this.programConfigurations=new uu(e.layers,e.zoom),this.segments=new fs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,s,u){this.hasPattern=Ju("line",this.layers,r);const f=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:F,id:V,index:j,sourceLayerIndex:Z}of e){const Q=this.layers[0]._featureFilter.needGeometry,ce=Gc(F,Q);if(!this.layers[0]._featureFilter.filter(new $(this.zoom),ce,s))continue;const Te=f?f.evaluate(ce,{},s):void 0,He={id:V,properties:F.properties,type:F.type,sourceLayerIndex:Z,index:j,geometry:Q?ce.geometry:ic(F,s,u),patterns:{},sortKey:Te};g.push(He)}f&&g.sort((F,V)=>F.sortKey-V.sortKey);const{lineAtlas:v,featureIndex:C}=r,T=this.addConstantDashes(v);for(const F of g){const{geometry:V,index:j,sourceLayerIndex:Z}=F;if(T&&this.addFeatureDashes(F,v),this.hasPattern){const Q=cp("line",this.layers,F,this.zoom,r);this.patternFeatures.push(Q)}else this.addFeature(F,V,j,s,v.positions,r.availableImages);C.insert(e[j].feature,V,j,Z,this.index)}}addConstantDashes(e){let r=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,f=s.layout.get("line-cap").value;if("constant"!==u.kind||"constant"!==f.kind)r=!0;else{const g=f.value,v=u.value;if(!v)continue;e.addDash(v,g)}}return r}addFeatureDashes(e,r){const s=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if("constant"===f.kind&&"constant"===g.kind)continue;let v,C;if("constant"===f.kind){if(v=f.value,!v)continue}else v=f.evaluate({zoom:s},e);C="constant"===g.kind?g.value:g.evaluate({zoom:s},e),r.addDash(v,C),e.patterns[u.id]=r.getKey(v,C)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}addFeatures(e,r,s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Z_)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,s,u,f,g){const v=this.layers[0].layout,C=v.get("line-join").evaluate(e,{}),T=v.get("line-cap").evaluate(e,{}),F=v.get("line-miter-limit"),V=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const j of r)this.addLine(j,e,C,T,F,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}addLine(e,r,s,u,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let He=0;He<e.length-1;He++)this.totalDistance+=e[He].dist(e[He+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v="Polygon"===ng[r.type];let C=e.length;for(;C>=2&&e[C-1].equals(e[C-2]);)C--;let T=0;for(;T<C-1&&e[T].equals(e[T+1]);)T++;if(C<(v?3:2))return;"bevel"===s&&(f=1.05);const F=this.overscaling<=16?15*Pr/(512*this.overscaling):0,V=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let j,Z,Q,ce,Te;this.e1=this.e2=-1,v&&(j=e[C-2],Te=e[T].sub(j)._unit()._perp());for(let He=T;He<C;He++){if(Q=He===C-1?v?e[T+1]:void 0:e[He+1],Q&&e[He].equals(Q))continue;Te&&(ce=Te),j&&(Z=j),j=e[He],Te=Q?Q.sub(j)._unit()._perp():ce,ce=ce||Te;let st=ce.add(Te);0===st.x&&0===st.y||st._unit();const Ge=ce.x*Te.x+ce.y*Te.y,at=st.x*Te.x+st.y*Te.y,yt=0!==at?1/at:1/0,gt=2*Math.sqrt(2-2*at),tn=at<fp&&Z&&Q,Zt=ce.x*Te.y-ce.y*Te.x>0;if(tn&&He>T){const ln=j.dist(Z);if(ln>2*F){const Sn=j.sub(j.sub(Z)._mult(F/ln)._round());this.updateDistance(Z,Sn),this.addCurrentVertex(Sn,ce,0,0,V),Z=Sn}}const gn=Z&&Q;let Ln=gn?s:v?"butt":u;if(gn&&"round"===Ln&&(yt<g?Ln="miter":yt<=2&&(Ln="fakeround")),"miter"===Ln&&yt>f&&(Ln="bevel"),"bevel"===Ln&&(yt>2&&(Ln="flipbevel"),yt<f&&(Ln="miter")),Z&&this.updateDistance(Z,j),"miter"===Ln)st._mult(yt),this.addCurrentVertex(j,st,0,0,V);else if("flipbevel"===Ln){if(yt>100)st=Te.mult(-1);else{const ln=yt*ce.add(Te).mag()/ce.sub(Te).mag();st._perp()._mult(ln*(Zt?-1:1))}this.addCurrentVertex(j,st,0,0,V),this.addCurrentVertex(j,st.mult(-1),0,0,V)}else if("bevel"===Ln||"fakeround"===Ln){const ln=-Math.sqrt(yt*yt-1),Sn=Zt?ln:0,In=Zt?0:ln;if(Z&&this.addCurrentVertex(j,ce,Sn,In,V),"fakeround"===Ln){const kn=Math.round(180*gt/Math.PI/20);for(let Un=1;Un<kn;Un++){let _n=Un/kn;if(.5!==_n){const pr=_n-.5;_n+=_n*pr*(_n-1)*((1.0904+Ge*(Ge*(3.55645-1.43519*Ge)-3.2452))*pr*pr+(.848013+Ge*(.215638*Ge-1.06021)))}const tr=Te.sub(ce)._mult(_n)._add(ce)._unit()._mult(Zt?-1:1);this.addHalfVertex(j,tr.x,tr.y,!1,Zt,0,V)}}Q&&this.addCurrentVertex(j,Te,-Sn,-In,V)}else if("butt"===Ln)this.addCurrentVertex(j,st,0,0,V);else if("square"===Ln){const ln=Z?1:-1;Z||this.addCurrentVertex(j,st,ln,ln,V),this.addCurrentVertex(j,st,0,0,V),Z&&this.addCurrentVertex(j,st,ln,ln,V)}else"round"===Ln&&(Z&&(this.addCurrentVertex(j,ce,0,0,V),this.addCurrentVertex(j,ce,1,1,V,!0)),Q&&(this.addCurrentVertex(j,Te,-1,-1,V,!0),this.addCurrentVertex(j,Te,0,0,V)));if(tn&&He<C-1){const ln=j.dist(Q);if(ln>2*F){const Sn=j.add(Q.sub(j)._mult(F/ln)._round());this.updateDistance(j,Sn),this.addCurrentVertex(Sn,Te,0,0,V),j=Sn}}}}addCurrentVertex(e,r,s,u,f,g=!1){const v=r.y*u-r.x,C=-r.y-r.x*u;this.addHalfVertex(e,r.x+r.y*s,r.y-r.x*s,g,!1,s,f),this.addHalfVertex(e,v,C,g,!0,-u,f)}addHalfVertex({x:e,y:r},s,u,f,g,v,C){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(r<<1)+(g?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(0===v?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),C.primitiveLength++),g?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}_(pp,"LineBucket",{omit:["layers","patternFeatures"]});const Y_=new Xe({"line-cap":new Ie(cn.layout_line["line-cap"]),"line-join":new Ie(cn.layout_line["line-join"]),"line-miter-limit":new se(cn.layout_line["line-miter-limit"]),"line-round-limit":new se(cn.layout_line["line-round-limit"]),"line-sort-key":new Ie(cn.layout_line["line-sort-key"])});var rg={paint:new Xe({"line-opacity":new Ie(cn.paint_line["line-opacity"]),"line-color":new Ie(cn.paint_line["line-color"]),"line-translate":new se(cn.paint_line["line-translate"]),"line-translate-anchor":new se(cn.paint_line["line-translate-anchor"]),"line-width":new Ie(cn.paint_line["line-width"]),"line-gap-width":new Ie(cn.paint_line["line-gap-width"]),"line-offset":new Ie(cn.paint_line["line-offset"]),"line-blur":new Ie(cn.paint_line["line-blur"]),"line-dasharray":new Ie(cn.paint_line["line-dasharray"]),"line-pattern":new Ie(cn.paint_line["line-pattern"]),"line-gradient":new We(cn.paint_line["line-gradient"]),"line-trim-offset":new se(cn.paint_line["line-trim-offset"])}),layout:Y_};const ig=new class extends Ie{possiblyEvaluate(n,e){return e=new $(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,r,s){return e=ue({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,r,s)}}(rg.paint.properties["line-width"].specification);function X_(n,e){return e>0?e+2*n:n}ig.useIntegerZoom=!0;const Mv=Mt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Qh=Mt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),K_=Mt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Mt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mp=Mt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),gp=Mt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Mt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Du=Mt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_p=Mt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Mt([{name:"triangle",components:3,type:"Uint16"}]),Mt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Mt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Mt([{type:"Float32",name:"offsetX"}]),Mt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Rs=24;const Ra=128;function id(n,e){const{expression:r}=e;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new $(n+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:u}=r;let f=0;for(;f<s.length&&s[f]<=n;)f++;f=Math.max(0,f-1);let g=f;for(;g<s.length&&s[g]<n+1;)g++;g=Math.min(s.length-1,g);const v=s[f],C=s[g];return"composite"===r.kind?{kind:"composite",minZoom:v,maxZoom:C,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:C,minSize:r.evaluate(new $(v)),maxSize:r.evaluate(new $(C)),interpolationType:u}}}function Xc(n,{uSize:e,uSizeT:r},{lowerSize:s,upperSize:u}){return"source"===n.kind?s/Ra:"composite"===n.kind?J(s/Ra,u/Ra,r):e}function Cu(n,e){let r=0,s=0;if("constant"===n.kind)s=n.layoutSize;else if("source"!==n.kind){const{interpolationType:u,minZoom:f,maxZoom:g}=n,v=u?Ht(Jo.interpolationFactor(u,e,f,g),0,1):0;"camera"===n.kind?s=J(n.minSize,n.maxSize,v):r=v}return{uSizeT:r,uSize:s}}var yp=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ra,evaluateSizeForFeature:Xc,evaluateSizeForZoom:Cu,getSizeData:id});function ef(n,e,r){return n.sections.forEach(s=>{s.text=function(u,f,g){const v=f.layout.get("text-transform").evaluate(g,{});return"uppercase"===v?u=u.toLocaleUpperCase():"lowercase"===v&&(u=u.toLocaleLowerCase()),O.applyArabicShaping&&(u=O.applyArabicShaping(u)),u}(s.text,e,r)}),n}const tf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function vp(n){return"\ufe36"===n||"\ufe48"===n||"\ufe38"===n||"\ufe44"===n||"\ufe42"===n||"\ufe3e"===n||"\ufe3c"===n||"\ufe3a"===n||"\ufe18"===n||"\ufe40"===n||"\ufe10"===n||"\ufe13"===n||"\ufe14"===n||"\uff40"===n||"\uffe3"===n||"\ufe11"===n||"\ufe12"===n}function Xd(n){return"\ufe35"===n||"\ufe47"===n||"\ufe37"===n||"\ufe43"===n||"\ufe41"===n||"\ufe3d"===n||"\ufe3b"===n||"\ufe39"===n||"\ufe17"===n||"\ufe3f"===n}var og=vo,xp=function(n,e,r,s,u){var f,g,v=8*u-s-1,C=(1<<v)-1,T=C>>1,F=-7,V=r?u-1:0,j=r?-1:1,Z=n[e+V];for(V+=j,f=Z&(1<<-F)-1,Z>>=-F,F+=v;F>0;f=256*f+n[e+V],V+=j,F-=8);for(g=f&(1<<-F)-1,f>>=-F,F+=s;F>0;g=256*g+n[e+V],V+=j,F-=8);if(0===f)f=1-T;else{if(f===C)return g?NaN:1/0*(Z?-1:1);g+=Math.pow(2,s),f-=T}return(Z?-1:1)*g*Math.pow(2,f-s)},sg=function(n,e,r,s,u,f){var g,v,C,T=8*f-u-1,F=(1<<T)-1,V=F>>1,j=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,Z=s?0:f-1,Q=s?1:-1,ce=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,g=F):(g=Math.floor(Math.log(e)/Math.LN2),e*(C=Math.pow(2,-g))<1&&(g--,C*=2),(e+=g+V>=1?j/C:j*Math.pow(2,1-V))*C>=2&&(g++,C/=2),g+V>=F?(v=0,g=F):g+V>=1?(v=(e*C-1)*Math.pow(2,u),g+=V):(v=e*Math.pow(2,V-1)*Math.pow(2,u),g=0));u>=8;n[r+Z]=255&v,Z+=Q,v/=256,u-=8);for(g=g<<u|v,T+=u;T>0;n[r+Z]=255&g,Z+=Q,g/=256,T-=8);n[r+Z-Q]|=128*ce};function vo(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}vo.Varint=0,vo.Fixed64=1,vo.Bytes=2,vo.Fixed32=5;var Kd=4294967296,bp=1/Kd,ag=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function xc(n){return n.type===vo.Bytes?n.readVarint()+n.pos:n.pos+1}function lg(n,e,r){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(s);for(var u=r.pos-1;u>=n;u--)r.buf[u+s]=r.buf[u]}function nf(n,e){for(var r=0;r<n.length;r++)e.writeVarint(n[r])}function wp(n,e){for(var r=0;r<n.length;r++)e.writeSVarint(n[r])}function J_(n,e){for(var r=0;r<n.length;r++)e.writeFloat(n[r])}function cg(n,e){for(var r=0;r<n.length;r++)e.writeDouble(n[r])}function Ep(n,e){for(var r=0;r<n.length;r++)e.writeBoolean(n[r])}function rf(n,e){for(var r=0;r<n.length;r++)e.writeFixed32(n[r])}function Q_(n,e){for(var r=0;r<n.length;r++)e.writeSFixed32(n[r])}function ug(n,e){for(var r=0;r<n.length;r++)e.writeFixed64(n[r])}function ey(n,e){for(var r=0;r<n.length;r++)e.writeSFixed64(n[r])}function Qd(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function eh(n,e,r){n[r]=e,n[r+1]=e>>>8,n[r+2]=e>>>16,n[r+3]=e>>>24}function dg(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}vo.prototype={destroy:function(){this.buf=null},readFields:function(n,e,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),u=s>>3,f=this.pos;this.type=7&s,n(u,e,this),this.pos===f&&this.skip(s)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Qd(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=dg(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Qd(this.buf,this.pos)+Qd(this.buf,this.pos+4)*Kd;return this.pos+=8,n},readSFixed64:function(){var n=Qd(this.buf,this.pos)+dg(this.buf,this.pos+4)*Kd;return this.pos+=8,n},readFloat:function(){var n=xp(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=xp(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,r,s=this.buf;return e=127&(r=s[this.pos++]),r<128?e:(e|=(127&(r=s[this.pos++]))<<7,r<128?e:(e|=(127&(r=s[this.pos++]))<<14,r<128?e:(e|=(127&(r=s[this.pos++]))<<21,r<128?e:function(u,f,g){var v,C,T=g.buf;if(v=(112&(C=T[g.pos++]))>>4,C<128||(v|=(127&(C=T[g.pos++]))<<3,C<128)||(v|=(127&(C=T[g.pos++]))<<10,C<128)||(v|=(127&(C=T[g.pos++]))<<17,C<128)||(v|=(127&(C=T[g.pos++]))<<24,C<128)||(v|=(1&(C=T[g.pos++]))<<31,C<128))return function Jd(n,e,r){return r?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}(u,v,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=s[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&ag?ag.decode(this.buf.subarray(e,n)):function(r,s,u){for(var f="",g=s;g<u;){var v,C,T,F=r[g],V=null,j=F>239?4:F>223?3:F>191?2:1;if(g+j>u)break;1===j?F<128&&(V=F):2===j?128==(192&(v=r[g+1]))&&(V=(31&F)<<6|63&v)<=127&&(V=null):3===j?(C=r[g+2],128==(192&(v=r[g+1]))&&128==(192&C)&&((V=(15&F)<<12|(63&v)<<6|63&C)<=2047||V>=55296&&V<=57343)&&(V=null)):4===j&&(C=r[g+2],T=r[g+3],128==(192&(v=r[g+1]))&&128==(192&C)&&128==(192&T)&&((V=(15&F)<<18|(63&v)<<12|(63&C)<<6|63&T)<=65535||V>=1114112)&&(V=null)),null===V?(V=65533,j=1):V>65535&&(V-=65536,f+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),f+=String.fromCharCode(V),g+=j}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==vo.Bytes)return n.push(this.readVarint(e));var r=xc(this);for(n=n||[];this.pos<r;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==vo.Bytes)return n.push(this.readSVarint());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==vo.Bytes)return n.push(this.readBoolean());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==vo.Bytes)return n.push(this.readFloat());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==vo.Bytes)return n.push(this.readDouble());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==vo.Bytes)return n.push(this.readFixed32());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==vo.Bytes)return n.push(this.readSFixed32());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==vo.Bytes)return n.push(this.readFixed64());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==vo.Bytes)return n.push(this.readSFixed64());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===vo.Varint)for(;this.buf[this.pos++]>127;);else if(e===vo.Bytes)this.pos=this.readVarint()+this.pos;else if(e===vo.Fixed32)this.pos+=4;else{if(e!==vo.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),eh(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),eh(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),eh(this.buf,-1&n,this.pos),eh(this.buf,Math.floor(n*bp),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),eh(this.buf,-1&n,this.pos),eh(this.buf,Math.floor(n*bp),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,r){var s,u,f,v;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),f=s,(v=r).buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,v.buf[v.pos]=127&(f>>>=7),function(f,g){var v=(7&f)<<4;g.buf[g.pos++]|=v|((f>>>=3)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f)))))}(u,r)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(s,u,f){for(var g,v,C=0;C<u.length;C++){if((g=u.charCodeAt(C))>55295&&g<57344){if(!v){g>56319||C+1===u.length?(s[f++]=239,s[f++]=191,s[f++]=189):v=g;continue}if(g<56320){s[f++]=239,s[f++]=191,s[f++]=189,v=g;continue}g=v-55296<<10|g-56320|65536,v=null}else v&&(s[f++]=239,s[f++]=191,s[f++]=189,v=null);g<128?s[f++]=g:(g<2048?s[f++]=g>>6|192:(g<65536?s[f++]=g>>12|224:(s[f++]=g>>18|240,s[f++]=g>>12&63|128),s[f++]=g>>6&63|128),s[f++]=63&g|128)}return f}(this.buf,n,this.pos);var r=this.pos-e;r>=128&&lg(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(n){this.realloc(4),sg(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),sg(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=n[r]},writeRawMessage:function(n,e){this.pos++;var r=this.pos;n(e,this);var s=this.pos-r;s>=128&&lg(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(n,e,r){this.writeTag(n,vo.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,nf,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,wp,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,Ep,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,J_,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,cg,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,rf,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,Q_,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,ug,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,ey,e)},writeBytesField:function(n,e){this.writeTag(n,vo.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,vo.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,vo.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,vo.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,vo.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,vo.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,vo.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,vo.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,vo.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,vo.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};var Kc=vt(og);const Dp=3;function od(n,e,r){e.glyphs=[],1===n&&r.readMessage(th,e)}function th(n,e,r){if(3===n){const{id:s,bitmap:u,width:f,height:g,left:v,top:C,advance:T}=r.readMessage(ty,{});e.glyphs.push({id:s,bitmap:new oc({width:f+2*Dp,height:g+2*Dp},u),metrics:{width:f,height:g,left:v,top:C,advance:T}})}else 4===n?e.ascender=r.readSVarint():5===n&&(e.descender=r.readSVarint())}function ty(n,e,r){1===n?e.id=r.readVarint():2===n?e.bitmap=r.readBytes():3===n?e.width=r.readVarint():4===n?e.height=r.readVarint():5===n?e.left=r.readSVarint():6===n?e.top=r.readSVarint():7===n&&(e.advance=r.readVarint())}const Cp=Dp;function Tp(n){let e=0,r=0;for(const g of n)e+=g.w*g.h,r=Math.max(r,g.w);n.sort((g,v)=>v.h-g.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let u=0,f=0;for(const g of n)for(let v=s.length-1;v>=0;v--){const C=s[v];if(!(g.w>C.w||g.h>C.h)){if(g.x=C.x,g.y=C.y,f=Math.max(f,g.y+g.h),u=Math.max(u,g.x+g.w),g.w===C.w&&g.h===C.h){const T=s.pop();v<s.length&&(s[v]=T)}else g.h===C.h?(C.x+=g.w,C.w-=g.w):g.w===C.w?(C.y+=g.h,C.h-=g.h):(s.push({x:C.x+g.w,y:C.y,w:C.w-g.w,h:g.h}),C.y+=g.h,C.h-=g.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}const Oa=1;class Sp{constructor(e,{pixelRatio:r,version:s,stretchX:u,stretchY:f,content:g}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=u,this.stretchY=f,this.content=g,this.version=s}get tl(){return[this.paddedRect.x+Oa,this.paddedRect.y+Oa]}get br(){return[this.paddedRect.x+this.paddedRect.w-Oa,this.paddedRect.y+this.paddedRect.h-Oa]}get displaySize(){return[(this.paddedRect.w-2*Oa)/this.pixelRatio,(this.paddedRect.h-2*Oa)/this.pixelRatio]}}class Ip{constructor(e,r){const s={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(r,u,f);const{w:g,h:v}=Tp(f),C=new Pa({width:g||1,height:v||1});for(const T in e){const F=e[T],V=s[T].paddedRect;Pa.copy(F.data,C,{x:0,y:0},{x:V.x+Oa,y:V.y+Oa},F.data)}for(const T in r){const F=r[T],V=u[T].paddedRect,j=V.x+Oa,Z=V.y+Oa,Q=F.data.width,ce=F.data.height;Pa.copy(F.data,C,{x:0,y:0},{x:j,y:Z},F.data),Pa.copy(F.data,C,{x:0,y:ce-1},{x:j,y:Z-1},{width:Q,height:1}),Pa.copy(F.data,C,{x:0,y:0},{x:j,y:Z+ce},{width:Q,height:1}),Pa.copy(F.data,C,{x:Q-1,y:0},{x:j-1,y:Z},{width:1,height:ce}),Pa.copy(F.data,C,{x:0,y:0},{x:j+Q,y:Z},{width:1,height:ce})}this.image=C,this.iconPositions=s,this.patternPositions=u}addImages(e,r,s){for(const u in e){const f=e[u],g={x:0,y:0,w:f.data.width+2*Oa,h:f.data.height+2*Oa};s.push(g),r[u]=new Sp(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),r)}patchUpdatedImage(e,r,s){if(!e||!r||e.version===r.version)return;e.version=r.version;const[u,f]=e.tl;s.update(r.data,void 0,{x:u,y:f})}}_(Sp,"ImagePosition"),_(Ip,"ImageAtlas");const Wa={horizontal:1,vertical:2,horizontalOnly:3},sf=-17;class af{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const s=new af;return s.scale=e||1,s.fontStack=r,s}static forImage(e){const r=new af;return r.imageName=e,r}}class Jc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const s=new Jc;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?s.addImageSection(f):s.addTextSection(f,r)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,s){let u="";for(let f=0;f<r.length;f++){const g=r.charCodeAt(f+1)||null,v=r.charCodeAt(f-1)||null;u+=!s&&(g&&Qn(g)&&!tf[r[f+1]]||v&&Qn(v)&&!tf[r[f-1]])||!tf[r[f]]?r[f]:tf[r[f]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&cf[this.text.charCodeAt(s)];s++)e++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&cf[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const s=new Jc;return s.text=this.text.substring(e,r),s.sectionIndex=this.sectionIndex.slice(e,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(af.forText(e.scale,e.fontStack||r));const s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){const r=e.image?e.image.name:"";if(0===r.length)return void mn("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(af.forImage(r)),this.sectionIndex.push(this.sections.length-1)):mn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lf(n,e,r,s,u,f,g,v,C,T,F,V,j,Z,Q){const ce=Jc.fromFeature(n,u);V===Wa.vertical&&ce.verticalizePunctuation(j);let Te=[];const He=function(gt,tn,Zt,gn,Ln,ln){if(!gt)return[];const Sn=[],In=function(tr,pr,ar,ii,jn,Ir){let si=0;for(let Hi=0;Hi<tr.length();Hi++){const li=tr.getSection(Hi);si+=Mp(tr.getCharCode(Hi),li,ii,jn,pr,Ir)}return si/Math.max(1,Math.ceil(si/ar))}(gt,tn,Zt,gn,Ln,ln),kn=gt.text.indexOf("\u200b")>=0;let Un=0;for(let tr=0;tr<gt.length();tr++){const pr=gt.getSection(tr),ar=gt.getCharCode(tr);if(cf[ar]||(Un+=Mp(ar,pr,gn,Ln,tn,ln)),tr<gt.length()-1){const ii=!((_n=ar)<11904||!(ge["Bopomofo Extended"](_n)||ge.Bopomofo(_n)||ge["CJK Compatibility Forms"](_n)||ge["CJK Compatibility Ideographs"](_n)||ge["CJK Compatibility"](_n)||ge["CJK Radicals Supplement"](_n)||ge["CJK Strokes"](_n)||ge["CJK Symbols and Punctuation"](_n)||ge["CJK Unified Ideographs Extension A"](_n)||ge["CJK Unified Ideographs"](_n)||ge["Enclosed CJK Letters and Months"](_n)||ge["Halfwidth and Fullwidth Forms"](_n)||ge.Hiragana(_n)||ge["Ideographic Description Characters"](_n)||ge["Kangxi Radicals"](_n)||ge["Katakana Phonetic Extensions"](_n)||ge.Katakana(_n)||ge["Vertical Forms"](_n)||ge["Yi Radicals"](_n)||ge["Yi Syllables"](_n)));(ny[ar]||ii||pr.imageName)&&Sn.push(pg(tr+1,Un,In,Sn,fg(ar,gt.getCharCode(tr+1),ii&&kn),!1))}}var _n;return mg(pg(gt.length(),Un,In,Sn,0,!0))}(ce,T,f,e,s,Z),{processBidirectionalText:st,processStyledBidirectionalText:Ge}=O;if(st&&1===ce.sections.length){const gt=st(ce.toString(),He);for(const tn of gt){const Zt=new Jc;Zt.text=tn,Zt.sections=ce.sections;for(let gn=0;gn<tn.length;gn++)Zt.sectionIndex.push(0);Te.push(Zt)}}else if(Ge){const gt=Ge(ce.text,ce.sectionIndex,He);for(const tn of gt){const Zt=new Jc;Zt.text=tn[0],Zt.sectionIndex=tn[1],Zt.sections=ce.sections,Te.push(Zt)}}else Te=function(gt,tn){const Zt=[],gn=gt.text;let Ln=0;for(const ln of tn)Zt.push(gt.substring(Ln,ln)),Ln=ln;return Ln<gn.length&&Zt.push(gt.substring(Ln,gn.length)),Zt}(ce,He);const at=[],yt={positionedLines:at,text:ce.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(gt,tn,Zt,gn,Ln,ln,Sn,In,kn,Un,_n,tr){let pr=0,ar=0,ii=0;const jn="right"===In?1:"left"===In?0:.5;let Ir=!1;for(const di of Ln){const ci=di.getSections();for(const xo of ci){if(xo.imageName)continue;const bo=tn[xo.fontStack];if(bo&&(Ir=void 0!==bo.ascender&&void 0!==bo.descender,!Ir))break}if(!Ir)break}let si=0;for(const di of Ln){di.trim();const ci=di.getMaxScale(),xo=(ci-1)*Rs,bo={positionedGlyphs:[],lineOffset:0};gt.positionedLines[si]=bo;const wo=bo.positionedGlyphs;let go=0;if(!di.length()){ar+=ln,++si;continue}let Lo=0,Fo=0;for(let Ki=0;Ki<di.length();Ki++){const xs=di.getSection(Ki),Go=di.getSectionIndex(Ki),Wo=di.getCharCode(Ki);let Gi=xs.scale,qo=null,Eo=null,ya=null,bs=Rs,Ys=0;const Is=!(kn===Wa.horizontal||!_n&&!sr(Wo)||_n&&(cf[Wo]||(Hi=Wo,ge.Arabic(Hi)||ge["Arabic Supplement"](Hi)||ge["Arabic Extended-A"](Hi)||ge["Arabic Presentation Forms-A"](Hi)||ge["Arabic Presentation Forms-B"](Hi))));if(xs.imageName){const Xs=gn[xs.imageName];if(!Xs)continue;ya=xs.imageName,gt.iconsInText=gt.iconsInText||!0,Eo=Xs.paddedRect;const ws=Xs.displaySize;Gi=Gi*Rs/tr,qo={width:ws[0],height:ws[1],left:Oa,top:-Cp,advance:Is?ws[1]:ws[0],localGlyph:!1},Ys=Ir?-qo.height*Gi:sf+ci*Rs-ws[1]*Gi,bs=qo.advance;const cc=(Is?ws[0]:ws[1])*Gi-Rs*ci;cc>0&&cc>go&&(go=cc)}else{const Xs=Zt[xs.fontStack];if(!Xs)continue;Xs[Wo]&&(Eo=Xs[Wo]);const ws=tn[xs.fontStack];if(!ws)continue;const cc=ws.glyphs[Wo];if(!cc)continue;if(qo=cc.metrics,bs=8203!==Wo?Rs:0,Ir){const hd=void 0!==ws.ascender?Math.abs(ws.ascender):0,_h=void 0!==ws.descender?Math.abs(ws.descender):0,ku=(hd+_h)*Gi;Lo<ku&&(Lo=ku,Fo=(hd-_h)/2*Gi),Ys=-hd*Gi}else Ys=sf+(ci-Gi)*Rs}Is?(gt.verticalizable=!0,wo.push({glyph:Wo,imageName:ya,x:pr,y:ar+Ys,vertical:Is,scale:Gi,localGlyph:qo.localGlyph,fontStack:xs.fontStack,sectionIndex:Go,metrics:qo,rect:Eo}),pr+=bs*Gi+Un):(wo.push({glyph:Wo,imageName:ya,x:pr,y:ar+Ys,vertical:Is,scale:Gi,localGlyph:qo.localGlyph,fontStack:xs.fontStack,sectionIndex:Go,metrics:qo,rect:Eo}),pr+=qo.advance*Gi+Un)}0!==wo.length&&(ii=Math.max(pr-Un,ii),Ir?Ap(wo,jn,go,Fo,ln*ci/2):Ap(wo,jn,go,0,ln/2)),pr=0;const os=ln*ci+go;bo.lineOffset=Math.max(go,xo),ar+=os,++si}var Hi;const li=ar,{horizontalAlign:Gr,verticalAlign:Ao}=gg(Sn);(function(di,ci,xo,bo,wo,go){const Lo=(ci-xo)*wo,Fo=-go*bo;for(const os of di)for(const Ki of os.positionedGlyphs)Ki.x+=Lo,Ki.y+=Fo})(gt.positionedLines,jn,Gr,Ao,ii,li),gt.top+=-Ao*li,gt.bottom=gt.top+li,gt.left+=-Gr*ii,gt.right=gt.left+ii,gt.hasBaseline=Ir}(yt,e,r,s,Te,g,v,C,V,T,j,Q),!function(gt){for(const tn of gt)if(0!==tn.positionedGlyphs.length)return!1;return!0}(at)&&yt}const cf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ny={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mp(n,e,r,s,u,f){if(e.imageName){const g=s[e.imageName];return g?g.displaySize[0]*e.scale*Rs/f+u:0}{const g=r[e.fontStack],v=g&&g.glyphs[n];return v?v.metrics.advance*e.scale+u:0}}function hg(n,e,r,s){const u=Math.pow(n-e,2);return s?n<e?u/2:2*u:u+Math.abs(r)*r}function fg(n,e,r){let s=0;return 10===n&&(s-=1e4),r&&(s+=150),40!==n&&65288!==n||(s+=50),41!==e&&65289!==e||(s+=50),s}function pg(n,e,r,s,u,f){let g=null,v=hg(e,r,u,f);for(const C of s){const T=hg(e-C.x,r,u,f)+C.badness;T<=v&&(g=C,v=T)}return{index:n,x:e,priorBreak:g,badness:v}}function mg(n){return n?mg(n.priorBreak).concat(n.index):[]}function gg(n){let e=.5,r=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Ap(n,e,r,s,u){if(!(e||r||s||u))return;const f=n.length-1,g=n[f],v=(g.x+g.metrics.advance*g.scale)*e;for(let C=0;C<=f;C++)n[C].x-=v,n[C].y+=r+s+u}function _g(n,e,r){const{horizontalAlign:s,verticalAlign:u}=gg(r),f=e[0]-n.displaySize[0]*s,g=e[1]-n.displaySize[1]*u;return{image:n,top:g,bottom:g+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function fl(n,e,r,s,u,f){const g=n.image;let v;if(g.content){const Te=g.content,He=g.pixelRatio||1;v=[Te[0]/He,Te[1]/He,g.displaySize[0]-Te[2]/He,g.displaySize[1]-Te[3]/He]}const C=e.left*f,T=e.right*f;let F,V,j,Z;"width"===r||"both"===r?(Z=u[0]+C-s[3],V=u[0]+T+s[1]):(Z=u[0]+(C+T-g.displaySize[0])/2,V=Z+g.displaySize[0]);const Q=e.top*f,ce=e.bottom*f;return"height"===r||"both"===r?(F=u[1]+Q-s[0],j=u[1]+ce+s[2]):(F=u[1]+(Q+ce-g.displaySize[1])/2,j=F+g.displaySize[1]),{image:g,top:F,right:V,bottom:j,left:Z,collisionPadding:v}}class Ll extends Me{constructor(e,r,s,u,f){super(e,r),this.angle=u,this.z=s,void 0!==f&&(this.segment=f)}clone(){return new Ll(this.x,this.y,this.z,this.angle,this.segment)}}function yg(n,e,r,s,u){if(void 0===e.segment)return!0;let f=e,g=e.segment+1,v=0;for(;v>-r/2;){if(g--,g<0)return!1;v-=n[g].dist(f),f=n[g]}v+=n[g].dist(n[g+1]),g++;const C=[];let T=0;for(;v<r/2;){const F=n[g],V=n[g+1];if(!V)return!1;let j=n[g-1].angleTo(F)-F.angleTo(V);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:v,angleDelta:j}),T+=j;v-C[0].distance>s;)T-=C.shift().angleDelta;if(T>u)return!1;g++,v+=F.dist(V)}return!0}function ry(n){let e=0;for(let r=0;r<n.length-1;r++)e+=n[r].dist(n[r+1]);return e}function vg(n,e,r){return n?.6*e*r:0}function xg(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function bg(n,e,r,s,u,f){const g=vg(r,u,f),v=xg(r,s)*f;let C=0;const T=ry(n)/2;for(let F=0;F<n.length-1;F++){const V=n[F],j=n[F+1],Z=V.dist(j);if(C+Z>T){const Q=(T-C)/Z,ce=J(V.x,j.x,Q),Te=J(V.y,j.y,Q),He=new Ll(ce,Te,0,j.angleTo(V),F);return!g||yg(n,He,v,g,e)?He:void 0}C+=Z}}function sd(n,e,r,s,u,f,g,v,C){const T=vg(s,f,g),F=xg(s,u),V=F*g,j=0===n[0].x||n[0].x===C||0===n[0].y||n[0].y===C;return e-V<e/4&&(e=V+e/4),ac(n,j?e/2*v%e:(F/2+2*f)*g*v%e,e,T,r,V,j,!1,C)}function ac(n,e,r,s,u,f,g,v,C){const T=f/2,F=ry(n);let V=0,j=e-r,Z=[];for(let Q=0;Q<n.length-1;Q++){const ce=n[Q],Te=n[Q+1],He=ce.dist(Te),st=Te.angleTo(ce);for(;j+r<V+He;){j+=r;const Ge=(j-V)/He,at=J(ce.x,Te.x,Ge),yt=J(ce.y,Te.y,Ge);if(at>=0&&at<C&&yt>=0&&yt<C&&j-T>=0&&j+T<=F){const gt=new Ll(at,yt,0,st,Q);gt._round(),s&&!yg(n,gt,f,s,u)||Z.push(gt)}}V+=He}return v||Z.length||g||(Z=ac(n,V/2,r,s,u,f,g,!0,C)),Z}function Tu(n,e,r,s,u){const f=[];for(let g=0;g<n.length;g++){const v=n[g];let C;for(let T=0;T<v.length-1;T++){let F=v[T],V=v[T+1];F.x<e&&V.x<e||(F.x<e?F=new Me(e,F.y+(e-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x<e&&(V=new Me(e,F.y+(e-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y<r&&V.y<r||(F.y<r?F=new Me(F.x+(r-F.y)/(V.y-F.y)*(V.x-F.x),r)._round():V.y<r&&(V=new Me(F.x+(r-F.y)/(V.y-F.y)*(V.x-F.x),r)._round()),F.x>=s&&V.x>=s||(F.x>=s?F=new Me(s,F.y+(s-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x>=s&&(V=new Me(s,F.y+(s-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y>=u&&V.y>=u||(F.y>=u?F=new Me(F.x+(u-F.y)/(V.y-F.y)*(V.x-F.x),u)._round():V.y>=u&&(V=new Me(F.x+(u-F.y)/(V.y-F.y)*(V.x-F.x),u)._round()),C&&F.equals(C[C.length-1])||(C=[F],f.push(C)),C.push(V)))))}}return f}_(Ll,"Anchor");const nh=1e20;function wg(n,e,r,s,u,f,g,v,C){for(let T=e;T<e+s;T++)Pp(n,r*f+T,f,u,g,v,C);for(let T=r;T<r+u;T++)Pp(n,T*f+e,1,s,g,v,C)}function Pp(n,e,r,s,u,f,g){f[0]=0,g[0]=-nh,g[1]=nh,u[0]=n[e];for(let v=1,C=0,T=0;v<s;v++){u[v]=n[e+v*r];const F=v*v;do{const V=f[C];T=(u[v]-u[V]+F-V*V)/(v-V)/2}while(T<=g[C]&&--C>-1);C++,f[C]=v,g[C]=T,g[C+1]=nh}for(let v=0,C=0;v<s;v++){for(;g[C+1]<v;)C++;const T=f[C],F=v-T;n[e+v*r]=u[T]+F*F}}const el=2,Su={none:0,ideographs:1,all:2};class Iu{constructor(e,r,s){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const s=[];for(const u in e)for(const f of e[u])s.push({stack:u,id:f});bt(s,({stack:u,id:f},g)=>{let v=this.entries[u];v||(v=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=v.glyphs[f];if(void 0!==C)return void g(null,{stack:u,id:f,glyph:C});if(C=this._tinySDF(v,u,f),C)return v.glyphs[f]=C,void g(null,{stack:u,id:f,glyph:C});const T=Math.floor(f/256);if(256*T>65535)return void g(new Error("glyphs > 65535 not supported"));if(v.ranges[T])return void g(null,{stack:u,id:f,glyph:C});let F=v.requests[T];F||(F=v.requests[T]=[],Iu.loadGlyphRange(u,T,this.url,this.requestManager,(V,j)=>{if(j){v.ascender=j.ascender,v.descender=j.descender;for(const Z in j.glyphs)this._doesCharSupportLocalGlyph(+Z)||(v.glyphs[+Z]=j.glyphs[+Z]);v.ranges[T]=!0}for(const Z of F)Z(V,j);delete v.requests[T]})),F.push((V,j)=>{V?g(V):j&&g(null,{stack:u,id:f,glyph:j.glyphs[f]||null})})},(u,f)=>{if(u)r(u);else if(f){const g={};for(const{stack:v,id:C,glyph:T}of f)void 0===g[v]&&(g[v]={}),void 0===g[v].glyphs&&(g[v].glyphs={}),g[v].glyphs[C]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},g[v].ascender=this.entries[v].ascender,g[v].descender=this.entries[v].descender;r(null,g)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Su.none&&(this.localGlyphMode===Su.all?!!this.localFontFamily:!!this.localFontFamily&&(ge["CJK Unified Ideographs"](e)||ge["Hangul Syllables"](e)||ge.Hiragana(e)||ge.Katakana(e)||ge["CJK Symbols and Punctuation"](e)))}_tinySDF(e,r,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let f=e.tinySDF;if(!f){let ce="400";/bold/i.test(r)?ce="900":/medium/i.test(r)?ce="500":/light/i.test(r)&&(ce="200"),f=e.tinySDF=new Iu.TinySDF({fontFamily:u,fontWeight:ce,fontSize:24*el,buffer:3*el,radius:8*el}),f.fontWeight=ce}if(this.localGlyphs[f.fontWeight][s])return this.localGlyphs[f.fontWeight][s];const g=String.fromCharCode(s),{data:v,width:C,height:T,glyphWidth:F,glyphHeight:V,glyphLeft:j,glyphTop:Z,glyphAdvance:Q}=f.draw(g);return this.localGlyphs[f.fontWeight][s]={id:s,bitmap:new oc({width:C,height:T},v),metrics:{width:F/el,height:V/el,left:j/el,top:Z/el-27,advance:Q/el,localGlyph:!0}}}}Iu.loadGlyphRange=function(n,e,r,s,u){const f=256*e,g=f+255,v=s.transformRequest(s.normalizeGlyphsURL(r).replace("{fontstack}",n).replace("{range}",`${f}-${g}`),Ai.Glyphs);Or(v,(C,T)=>{if(C)u(C);else if(T){const F={},V=new Kc(T).readFields(od,{});for(const j of V.glyphs)F[j.id]=j;u(null,{glyphs:F,ascender:V.ascender,descender:V.descender})}})},Iu.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:r=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:g="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=r;const v=this.size=n+4*e,C=this._createCanvas(v),T=this.ctx=C.getContext("2d",{willReadFrequently:!0});T.font=`${g} ${f} ${n}px ${u}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(n),g=Math.ceil(r),v=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),C=Math.min(this.size-this.buffer,g+Math.ceil(s)),T=v+2*this.buffer,F=C+2*this.buffer,V=Math.max(T*F,0),j=new Uint8ClampedArray(V),Z={data:j,width:T,height:F,glyphWidth:v,glyphHeight:C,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(0===v||0===C)return Z;const{ctx:Q,buffer:ce,gridInner:Te,gridOuter:He}=this;Q.clearRect(ce,ce,v,C),Q.fillText(n,ce,ce+g);const st=Q.getImageData(ce,ce,v,C);He.fill(nh,0,V),Te.fill(0,0,V);for(let Ge=0;Ge<C;Ge++)for(let at=0;at<v;at++){const yt=st.data[4*(Ge*v+at)+3]/255;if(0===yt)continue;const gt=(Ge+ce)*T+at+ce;if(1===yt)He[gt]=0,Te[gt]=nh;else{const tn=.5-yt;He[gt]=tn>0?tn*tn:0,Te[gt]=tn<0?tn*tn:0}}wg(He,0,0,T,F,T,this.f,this.v,this.z),wg(Te,ce,ce,v,C,T,this.f,this.v,this.z);for(let Ge=0;Ge<V;Ge++){const at=Math.sqrt(He[Ge])-Math.sqrt(Te[Ge]);j[Ge]=Math.round(255-255*(at/this.radius+this.cutoff))}return Z}};const rh=Oa;function uf(n,e,r,s){const u=[],f=n.image,g=f.pixelRatio,v=f.paddedRect.w-2*rh,C=f.paddedRect.h-2*rh,T=n.right-n.left,F=n.bottom-n.top,V=f.stretchX||[[0,v]],j=f.stretchY||[[0,C]],Z=(ln,Sn)=>ln+Sn[1]-Sn[0],Q=V.reduce(Z,0),ce=j.reduce(Z,0),Te=v-Q,He=C-ce;let st=0,Ge=Q,at=0,yt=ce,gt=0,tn=Te,Zt=0,gn=He;if(f.content&&s){const ln=f.content;st=bc(V,0,ln[0]),at=bc(j,0,ln[1]),Ge=bc(V,ln[0],ln[2]),yt=bc(j,ln[1],ln[3]),gt=ln[0]-st,Zt=ln[1]-at,tn=ln[2]-ln[0]-Ge,gn=ln[3]-ln[1]-yt}const Ln=(ln,Sn,In,kn)=>{const Un=oh(ln.stretch-st,Ge,T,n.left),_n=sh(ln.fixed-gt,tn,ln.stretch,Q),tr=oh(Sn.stretch-at,yt,F,n.top),pr=sh(Sn.fixed-Zt,gn,Sn.stretch,ce),ar=oh(In.stretch-st,Ge,T,n.left),ii=sh(In.fixed-gt,tn,In.stretch,Q),jn=oh(kn.stretch-at,yt,F,n.top),Ir=sh(kn.fixed-Zt,gn,kn.stretch,ce),si=new Me(Un,tr),Hi=new Me(ar,tr),li=new Me(ar,jn),Gr=new Me(Un,jn),Ao=new Me(_n/g,pr/g),di=new Me(ii/g,Ir/g),ci=e*Math.PI/180;if(ci){const wo=Math.sin(ci),go=Math.cos(ci),Lo=[go,-wo,wo,go];si._matMult(Lo),Hi._matMult(Lo),Gr._matMult(Lo),li._matMult(Lo)}const xo=ln.stretch+ln.fixed,bo=Sn.stretch+Sn.fixed;return{tl:si,tr:Hi,bl:Gr,br:li,tex:{x:f.paddedRect.x+rh+xo,y:f.paddedRect.y+rh+bo,w:In.stretch+In.fixed-xo,h:kn.stretch+kn.fixed-bo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ao,pixelOffsetBR:di,minFontScaleX:tn/g/T,minFontScaleY:gn/g/F,isSDF:r}};if(s&&(f.stretchX||f.stretchY)){const ln=ih(V,Te,Q),Sn=ih(j,He,ce);for(let In=0;In<ln.length-1;In++){const kn=ln[In],Un=ln[In+1];for(let _n=0;_n<Sn.length-1;_n++)u.push(Ln(kn,Sn[_n],Un,Sn[_n+1]))}}else u.push(Ln({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:C+1}));return u}function bc(n,e,r){let s=0;for(const u of n)s+=Math.max(e,Math.min(r,u[1]))-Math.max(e,Math.min(r,u[0]));return s}function ih(n,e,r){const s=[{fixed:-rh,stretch:0}];for(const[u,f]of n){const g=s[s.length-1];s.push({fixed:u-g.stretch,stretch:g.stretch}),s.push({fixed:u-g.stretch,stretch:g.stretch+(f-u)})}return s.push({fixed:e+rh,stretch:r}),s}function oh(n,e,r,s){return n/e*r+s}function sh(n,e,r,s){return n-e*r/s}function iy(n,e,r,s){const u=e+n.positionedLines[s].lineOffset;return 0===s?r+u/2:r+(u+(e+n.positionedLines[s-1].lineOffset))/2}class oy{constructor(e=[],r=sy){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:s}=this,u=r[e];for(;e>0;){const f=e-1>>1,g=r[f];if(s(u,g)>=0)break;r[e]=g,e=f}r[e]=u}_down(e){const{data:r,compare:s}=this,u=this.length>>1,f=r[e];for(;e<u;){let g=1+(e<<1),v=r[g];const C=g+1;if(C<this.length&&s(r[C],v)<0&&(g=C,v=r[C]),s(v,f)>=0)break;r[e]=v,e=g}r[e]=f}}function sy(n,e){return n<e?-1:n>e?1:0}function ay(n,e=1,r=!1){let s=1/0,u=1/0,f=-1/0,g=-1/0;const v=n[0];for(let Z=0;Z<v.length;Z++){const Q=v[Z];(!Z||Q.x<s)&&(s=Q.x),(!Z||Q.y<u)&&(u=Q.y),(!Z||Q.x>f)&&(f=Q.x),(!Z||Q.y>g)&&(g=Q.y)}const C=Math.min(f-s,g-u);let T=C/2;const F=new oy([],Eg);if(0===C)return new Me(s,u);for(let Z=s;Z<f;Z+=C)for(let Q=u;Q<g;Q+=C)F.push(new ah(Z+T,Q+T,T,n));let V=function(Z){let Q=0,ce=0,Te=0;const He=Z[0];for(let st=0,Ge=He.length,at=Ge-1;st<Ge;at=st++){const yt=He[st],gt=He[at],tn=yt.x*gt.y-gt.x*yt.y;ce+=(yt.x+gt.x)*tn,Te+=(yt.y+gt.y)*tn,Q+=3*tn}return new ah(ce/Q,Te/Q,0,Z)}(n),j=F.length;for(;F.length;){const Z=F.pop();(Z.d>V.d||!V.d)&&(V=Z,r&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,j)),Z.max-V.d<=e||(T=Z.h/2,F.push(new ah(Z.p.x-T,Z.p.y-T,T,n)),F.push(new ah(Z.p.x+T,Z.p.y-T,T,n)),F.push(new ah(Z.p.x-T,Z.p.y+T,T,n)),F.push(new ah(Z.p.x+T,Z.p.y+T,T,n)),j+=4)}return r&&(console.log(`num probes: ${j}`),console.log(`best distance: ${V.d}`)),V.p}function Eg(n,e){return e.max-n.max}class ah{constructor(e,r,s,u){this.p=new Me(e,r),this.h=s,this.d=function(f,g){let v=!1,C=1/0;for(let T=0;T<g.length;T++){const F=g[T];for(let V=0,j=F.length,Z=j-1;V<j;Z=V++){const Q=F[V],ce=F[Z];Q.y>f.y!=ce.y>f.y&&f.x<(ce.x-Q.x)*(f.y-Q.y)/(ce.y-Q.y)+Q.x&&(v=!v),C=Math.min(C,Zu(f,Q,ce))}}return(v?1:-1)*Math.sqrt(C)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const ad=7,Dg=Number.POSITIVE_INFINITY,Av=Math.sqrt(2);function Rp(n,[e,r]){let s=0,u=0;if(r===Dg){e<0&&(e=0);const f=e/Av;switch(n){case"top-right":case"top-left":u=f-ad;break;case"bottom-right":case"bottom-left":u=-f+ad;break;case"bottom":u=-e+ad;break;case"top":u=e-ad}switch(n){case"top-right":case"bottom-right":s=-f;break;case"top-left":case"bottom-left":s=f;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),n){case"top-right":case"top-left":case"top":u=r-ad;break;case"bottom-right":case"bottom-left":case"bottom":u=-r+ad}switch(n){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,u]}function Cg(n,e,r,s,u,f,g,v,C,T){n.createArrays(),n.tilePixelRatio=Pr/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const F=n.layers[0].layout,V=n.layers[0]._unevaluatedLayout._values,j={};if("composite"===n.textSizeData.kind){const{minZoom:ce,maxZoom:Te}=n.textSizeData;j.compositeTextSizes=[V["text-size"].possiblyEvaluate(new $(ce),v),V["text-size"].possiblyEvaluate(new $(Te),v)]}if("composite"===n.iconSizeData.kind){const{minZoom:ce,maxZoom:Te}=n.iconSizeData;j.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new $(ce),v),V["icon-size"].possiblyEvaluate(new $(Te),v)]}j.layoutTextSize=V["text-size"].possiblyEvaluate(new $(C+1),v),j.layoutIconSize=V["icon-size"].possiblyEvaluate(new $(C+1),v),j.textMaxSize=V["text-size"].possiblyEvaluate(new $(18),v);const Z="map"===F.get("text-rotation-alignment")&&"point"!==F.get("symbol-placement"),Q=F.get("text-size");for(const ce of n.features){const Te=F.get("text-font").evaluate(ce,{},v).join(","),He=Q.evaluate(ce,{},v),st=j.layoutTextSize.evaluate(ce,{},v),Ge=(j.layoutIconSize.evaluate(ce,{},v),{horizontal:{},vertical:void 0}),at=ce.text;let yt,gt=[0,0];if(at){const gn=at.toString(),Ln=F.get("text-letter-spacing").evaluate(ce,{},v)*Rs,ln=F.get("text-line-height").evaluate(ce,{},v)*Rs,Sn=Pt(gn)?Ln:0,In=F.get("text-anchor").evaluate(ce,{},v),kn=F.get("text-variable-anchor");if(!kn){const ar=F.get("text-radial-offset").evaluate(ce,{},v);gt=ar?Rp(In,[ar*Rs,Dg]):F.get("text-offset").evaluate(ce,{},v).map(ii=>ii*Rs)}let Un=Z?"center":F.get("text-justify").evaluate(ce,{},v);const _n="point"===F.get("symbol-placement"),tr=_n?F.get("text-max-width").evaluate(ce,{},v)*Rs:1/0,pr=ar=>{n.allowVerticalPlacement&&Oe(gn)&&(Ge.vertical=lf(at,e,r,u,Te,tr,ln,In,ar,Sn,gt,Wa.vertical,!0,st,He))};if(!Z&&kn){const ar="auto"===Un?kn.map(jn=>Tg(jn)):[Un];let ii=!1;for(let jn=0;jn<ar.length;jn++){const Ir=ar[jn];if(!Ge.horizontal[Ir])if(ii)Ge.horizontal[Ir]=Ge.horizontal[0];else{const si=lf(at,e,r,u,Te,tr,ln,"center",Ir,Sn,gt,Wa.horizontal,!1,st,He);si&&(Ge.horizontal[Ir]=si,ii=1===si.positionedLines.length)}}pr("left")}else{if("auto"===Un&&(Un=Tg(In)),_n||F.get("text-writing-mode").indexOf("horizontal")>=0||!Oe(gn)){const ar=lf(at,e,r,u,Te,tr,ln,In,Un,Sn,gt,Wa.horizontal,!1,st,He);ar&&(Ge.horizontal[Un]=ar)}pr(_n?"left":Un)}}let tn=!1;if(ce.icon&&ce.icon.name){const gn=s[ce.icon.name];gn&&(yt=_g(u[ce.icon.name],F.get("icon-offset").evaluate(ce,{},v),F.get("icon-anchor").evaluate(ce,{},v)),tn=gn.sdf,void 0===n.sdfIcons?n.sdfIcons=gn.sdf:n.sdfIcons!==gn.sdf&&mn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(gn.pixelRatio!==n.pixelRatio||0!==F.get("icon-rotate").constantOr(1))&&(n.iconsNeedLinear=!0))}const Zt=kp(Ge.horizontal)||Ge.vertical;n.iconsInText||(n.iconsInText=!!Zt&&Zt.iconsInText),(Zt||yt)&&Sg(n,ce,Ge,yt,s,j,st,0,gt,tn,g,v,T)}f&&n.generateCollisionDebugBuffers(C,n.collisionBoxArray)}function Tg(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sg(n,e,r,s,u,f,g,v,C,T,F,V,j){let Z=f.textMaxSize.evaluate(e,{},V);void 0===Z&&(Z=g);const Q=n.layers[0].layout,ce=Q.get("icon-offset").evaluate(e,{},V),Te=kp(r.horizontal)||r.vertical,He="globe"===j.name,st=Rs,Ge=g/st,at=n.tilePixelRatio*Z/st,yt=(In=n.overscaling,n.zoom>18&&In>2&&(In>>=1),Math.max(Pr/(512*In),1)*Q.get("symbol-spacing")),gt=Q.get("text-padding")*n.tilePixelRatio,tn=Q.get("icon-padding")*n.tilePixelRatio,Zt=Je(Q.get("text-max-angle")),gn="map"===Q.get("text-rotation-alignment")&&"point"!==Q.get("symbol-placement"),Ln="map"===Q.get("icon-rotation-alignment")&&"point"!==Q.get("symbol-placement"),ln=Q.get("symbol-placement"),Sn=yt/2;var In;const kn=Q.get("icon-text-fit");let Un;s&&"none"!==kn&&(n.allowVerticalPlacement&&r.vertical&&(Un=fl(s,r.vertical,kn,Q.get("icon-text-fit-padding"),ce,Ge)),Te&&(s=fl(s,Te,kn,Q.get("icon-text-fit-padding"),ce,Ge)));const _n=(tr,pr,ar)=>{if(pr.x<0||pr.x>=Pr||pr.y<0||pr.y>=Pr)return;let ii=null;if(He){const{x:jn,y:Ir,z:si}=j.projectTilePoint(pr.x,pr.y,ar);ii={anchor:new Ll(jn,Ir,si,0,void 0),up:j.upVector(ar,pr.x,pr.y)}}!function(jn,Ir,si,Hi,li,Gr,Ao,di,ci,xo,bo,wo,go,Lo,Fo,os,Ki,xs,Go,Wo,Gi,qo,Eo,ya,bs){const Ys=jn.addToLineVertexArray(Ir,Hi);let Is,Xs,ws,cc,hd,_h,ku,Jg=0,Jp=0,Qg=0,e_=0,wf=-1,Ef=-1;const $l={};let t_=cu("");const Lu=si?si.anchor:Ir;let Qp=0,Df=0;if(void 0===ci._unevaluatedLayout.getValue("text-radial-offset")?[Qp,Df]=ci.layout.get("text-offset").evaluate(Gi,{},bs).map(ua=>ua*Rs):(Qp=ci.layout.get("text-radial-offset").evaluate(Gi,{},bs)*Rs,Df=Dg),jn.allowVerticalPlacement&&li.vertical){const ua=li.vertical;if(Fo)_h=df(ua),di&&(ku=df(di));else{const da=ci.layout.get("text-rotate").evaluate(Gi,{},bs)+90;ws=mi(xo,Lu,Ir,bo,wo,go,ua,Lo,da,os),di&&(cc=mi(xo,Lu,Ir,bo,wo,go,di,xs,da))}}if(Gr){const ua=ci.layout.get("icon-rotate").evaluate(Gi,{},bs),da="none"!==ci.layout.get("icon-text-fit"),Fu=uf(Gr,ua,Eo,da),Cf=di?uf(di,ua,Eo,da):void 0;Xs=mi(xo,Lu,Ir,bo,wo,go,Gr,xs,ua),Jg=4*Fu.length;const n_=jn.iconSizeData;let Bu=null;"source"===n_.kind?(Bu=[Ra*ci.layout.get("icon-size").evaluate(Gi,{},bs)],Bu[0]>wc&&mn(`${jn.layerIds[0]}: Value for "icon-size" is >= ${Qc}. Reduce your "icon-size".`)):"composite"===n_.kind&&(Bu=[Ra*qo.compositeIconSizes[0].evaluate(Gi,{},bs),Ra*qo.compositeIconSizes[1].evaluate(Gi,{},bs)],(Bu[0]>wc||Bu[1]>wc)&&mn(`${jn.layerIds[0]}: Value for "icon-size" is >= ${Qc}. Reduce your "icon-size".`)),jn.addSymbols(jn.icon,Fu,Bu,Wo,Go,Gi,!1,si,Ir,Ys.lineStartIndex,Ys.lineLength,-1,ya,bs),wf=jn.icon.placedSymbolArray.length-1,Cf&&(Jp=4*Cf.length,jn.addSymbols(jn.icon,Cf,Bu,Wo,Go,Gi,Wa.vertical,si,Ir,Ys.lineStartIndex,Ys.lineLength,-1,ya,bs),Ef=jn.icon.placedSymbolArray.length-1)}for(const ua in li.horizontal){const da=li.horizontal[ua];Is||(t_=cu(da.text),Fo?hd=df(da):Is=mi(xo,Lu,Ir,bo,wo,go,da,Lo,ci.layout.get("text-rotate").evaluate(Gi,{},bs),os));const Fu=1===da.positionedLines.length;if(Qg+=Op(jn,si,Ir,da,Ao,ci,Fo,Gi,os,Ys,li.vertical?Wa.horizontal:Wa.horizontalOnly,Fu?Object.keys(li.horizontal):[ua],$l,wf,qo,ya,bs),Fu)break}li.vertical&&(e_+=Op(jn,si,Ir,li.vertical,Ao,ci,Fo,Gi,os,Ys,Wa.vertical,["vertical"],$l,Ef,qo,ya,bs));let uc=-1;const yh=(ua,da)=>ua?Math.max(ua,da):da;uc=yh(hd,uc),uc=yh(_h,uc),uc=yh(ku,uc);const wy=uc>-1?1:0;jn.glyphOffsetArray.length>=nu.MAX_GLYPHS&&mn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Gi.sortKey&&jn.addToSortKeyRanges(jn.symbolInstances.length,Gi.sortKey),jn.symbolInstances.emplaceBack(Lu.x,Lu.y,Lu.z,Ir.x,Ir.y,$l.right>=0?$l.right:-1,$l.center>=0?$l.center:-1,$l.left>=0?$l.left:-1,$l.vertical>=0?$l.vertical:-1,wf,Ef,t_,void 0!==Is?Is:jn.collisionBoxArray.length,void 0!==Is?Is+1:jn.collisionBoxArray.length,void 0!==ws?ws:jn.collisionBoxArray.length,void 0!==ws?ws+1:jn.collisionBoxArray.length,void 0!==Xs?Xs:jn.collisionBoxArray.length,void 0!==Xs?Xs+1:jn.collisionBoxArray.length,cc||jn.collisionBoxArray.length,cc?cc+1:jn.collisionBoxArray.length,bo,Qg,e_,Jg,Jp,wy,0,Qp,Df,uc)}(n,pr,ii,tr,r,s,u,Un,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,gt,gn,C,0,tn,Ln,ce,e,f,T,F,V)};if("line"===ln)for(const tr of Tu(e.geometry,0,0,Pr,Pr)){const pr=sd(tr,yt,Zt,r.vertical||Te,s,st,at,n.overscaling,Pr);for(const ar of pr)Te&&Ig(n,Te.text,Sn,ar)||_n(tr,ar,V)}else if("line-center"===ln){for(const tr of e.geometry)if(tr.length>1){const pr=bg(tr,Zt,r.vertical||Te,s,st,at);pr&&_n(tr,pr,V)}}else if("Polygon"===e.type)for(const tr of lp(e.geometry,0)){const pr=ay(tr,16);_n(tr[0],new Ll(pr.x,pr.y,0,0,void 0),V)}else if("LineString"===e.type)for(const tr of e.geometry)_n(tr,new Ll(tr[0].x,tr[0].y,0,0,void 0),V);else if("Point"===e.type)for(const tr of e.geometry)for(const pr of tr)_n([pr],new Ll(pr.x,pr.y,0,0,void 0),V)}const Qc=255,wc=Qc*Ra;function Op(n,e,r,s,u,f,g,v,C,T,F,V,j,Z,Q,ce,Te){const He=function(at,yt,gt,tn,Zt,gn,Ln,ln){const Sn=[];if(0===yt.positionedLines.length)return Sn;const In=tn.layout.get("text-rotate").evaluate(gn,{})*Math.PI/180,kn=function(ar){const ii=ar[0],jn=ar[1],Ir=ii*jn;return Ir>0?[ii,-jn]:Ir<0?[-ii,jn]:0===ii?[jn,ii]:[jn,-ii]}(gt);let Un=Math.abs(yt.top-yt.bottom);for(const ar of yt.positionedLines)Un-=ar.lineOffset;const _n=yt.positionedLines.length,tr=Un/_n;let pr=yt.top-gt[1];for(let ar=0;ar<_n;++ar){const ii=yt.positionedLines[ar];pr=iy(yt,tr,pr,ar);for(const jn of ii.positionedGlyphs){if(!jn.rect)continue;const Ir=jn.rect||{};let si=Cp+1,Hi=!0,li=1,Gr=0;if(jn.imageName){const Eo=Ln[jn.imageName];if(!Eo)continue;if(Eo.sdf){mn("SDF images are not supported in formatted text and will be ignored.");continue}Hi=!1,li=Eo.pixelRatio,si=Oa/li}const Ao=(Zt||ln)&&jn.vertical,di=jn.metrics.advance*jn.scale/2,ci=jn.metrics,xo=jn.rect;if(null===xo)continue;ln&&yt.verticalizable&&(Gr=jn.imageName?di-jn.metrics.width*jn.scale/2:0);const bo=Zt?[jn.x+di,jn.y]:[0,0];let wo=[0,0],go=[0,0],Lo=!1;Zt||(Ao?(go=[jn.x+di+kn[0],jn.y+kn[1]-Gr],Lo=!0):wo=[jn.x+di+gt[0],jn.y+gt[1]-Gr]);const Fo=xo.w*jn.scale/(li*(jn.localGlyph?el:1)),os=xo.h*jn.scale/(li*(jn.localGlyph?el:1));let Ki,xs,Go,Wo;if(Ao){const Eo=jn.y-pr,ya=new Me(-di,di-Eo),bs=-Math.PI/2,Ys=new Me(...go);Ki=new Me(-di+wo[0],wo[1]),Ki._rotateAround(bs,ya)._add(Ys),Ki.x+=-Eo+di,Ki.y-=(ci.left-si)*jn.scale;const Is=jn.imageName?ci.advance*jn.scale:Rs*jn.scale,Xs=String.fromCharCode(jn.glyph);vp(Xs)?Ki.x+=(1-si)*jn.scale:Xd(Xs)?Ki.x+=Is-ci.height*jn.scale+(-si-1)*jn.scale:Ki.x+=jn.imageName||ci.width+2*si===xo.w&&ci.height+2*si===xo.h?(Is-os)/2:(Is-(ci.height+2*si)*jn.scale)/2,xs=new Me(Ki.x,Ki.y-Fo),Go=new Me(Ki.x+os,Ki.y),Wo=new Me(Ki.x+os,Ki.y-Fo)}else{const Eo=(ci.left-si)*jn.scale-di+wo[0],ya=(-ci.top-si)*jn.scale+wo[1],bs=Eo+Fo,Ys=ya+os;Ki=new Me(Eo,ya),xs=new Me(bs,ya),Go=new Me(Eo,Ys),Wo=new Me(bs,Ys)}if(In){let Eo;Eo=Zt?new Me(0,0):Lo?new Me(kn[0],kn[1]):new Me(gt[0],gt[1]),Ki._rotateAround(In,Eo),xs._rotateAround(In,Eo),Go._rotateAround(In,Eo),Wo._rotateAround(In,Eo)}const Gi=new Me(0,0),qo=new Me(0,0);Sn.push({tl:Ki,tr:xs,bl:Go,br:Wo,tex:Ir,writingMode:yt.writingMode,glyphOffset:bo,sectionIndex:jn.sectionIndex,isSDF:Hi,pixelOffsetTL:Gi,pixelOffsetBR:qo,minFontScaleX:0,minFontScaleY:0})}}return Sn}(0,s,C,f,g,v,u,n.allowVerticalPlacement),st=n.textSizeData;let Ge=null;"source"===st.kind?(Ge=[Ra*f.layout.get("text-size").evaluate(v,{},Te)],Ge[0]>wc&&mn(`${n.layerIds[0]}: Value for "text-size" is >= ${Qc}. Reduce your "text-size".`)):"composite"===st.kind&&(Ge=[Ra*Q.compositeTextSizes[0].evaluate(v,{},Te),Ra*Q.compositeTextSizes[1].evaluate(v,{},Te)],(Ge[0]>wc||Ge[1]>wc)&&mn(`${n.layerIds[0]}: Value for "text-size" is >= ${Qc}. Reduce your "text-size".`)),n.addSymbols(n.text,He,Ge,C,g,v,F,e,r,T.lineStartIndex,T.lineLength,Z,ce,Te);for(const at of V)j[at]=n.text.placedSymbolArray.length-1;return 4*He.length}function kp(n){for(const e in n)return n[e];return null}function mi(n,e,r,s,u,f,g,v,C,T){let F=g.top,V=g.bottom,j=g.left,Z=g.right;const Q=g.collisionPadding;if(Q&&(j-=Q[0],F-=Q[1],Z+=Q[2],V+=Q[3]),C){const ce=new Me(j,F),Te=new Me(Z,F),He=new Me(j,V),st=new Me(Z,V),Ge=Je(C);let at=new Me(0,0);T&&(at=new Me(T[0],T[1])),ce._rotateAround(Ge,at),Te._rotateAround(Ge,at),He._rotateAround(Ge,at),st._rotateAround(Ge,at),j=Math.min(ce.x,Te.x,He.x,st.x),Z=Math.max(ce.x,Te.x,He.x,st.x),F=Math.min(ce.y,Te.y,He.y,st.y),V=Math.max(ce.y,Te.y,He.y,st.y)}return n.emplaceBack(e.x,e.y,e.z,r.x,r.y,j,F,Z,V,v,s,u,f),n.length-1}function df(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function Ig(n,e,r,s){const u=n.compareText;if(e in u){const f=u[e];for(let g=f.length-1;g>=0;g--)if(s.dist(f[g])<r)return!0}else u[e]=[];return u[e].push(s),!1}function Mu(n,e){const r=n.fovAboveCenter,s=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,u=(n._camera.position[2]*n.worldSize-s)/Math.cos(n._pitch),f=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-n._pitch-r,.01)),g=Math.sin(n._pitch)*f+u;return Math.min(1.01*g,u*(1/n._horizonShift))}function eu(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const r=Math.pow(2,-n.z),s=n.x*r,u=(n.x+1)*r,f=n.y*r,g=(n.y+1)*r,v=Aa(s),C=Aa(u),T=Us(f),F=Us(g),V=e.project(v,T),j=e.project(C,T),Z=e.project(C,F),Q=e.project(v,F);let ce=Math.min(V.x,j.x,Z.x,Q.x),Te=Math.min(V.y,j.y,Z.y,Q.y),He=Math.max(V.x,j.x,Z.x,Q.x),st=Math.max(V.y,j.y,Z.y,Q.y);const Ge=r/16;function at(gt,tn,Zt,gn,Ln,ln){const Sn=(Zt+Ln)/2,In=(gn+ln)/2,kn=e.project(Aa(Sn),Us(In)),Un=Math.max(0,ce-kn.x,Te-kn.y,kn.x-He,kn.y-st);ce=Math.min(ce,kn.x),He=Math.max(He,kn.x),Te=Math.min(Te,kn.y),st=Math.max(st,kn.y),Un>Ge&&(at(gt,kn,Zt,gn,Sn,In),at(kn,tn,Sn,In,Ln,ln))}at(V,j,s,f,u,f),at(j,Z,u,f,u,g),at(Z,Q,u,g,s,g),at(Q,V,s,g,s,f),ce-=Ge,Te-=Ge,He+=Ge,st+=Ge;const yt=1/Math.max(He-ce,st-Te);return{scale:yt,x:ce*yt,y:Te*yt,x2:He*yt,y2:st*yt,projection:e}}const ly=Ma(new Float32Array(16));class Fl{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new po(0,0)}projectTilePoint(e,r,s){return{x:e,y:r,z:0}}locationPoint(e,r,s=!0){return e._coordinatePoint(e.locationCoordinate(r),s)}pixelsPerMeter(e,r){return Ga(1,e)*r}pixelSpaceConversion(e,r,s){return 1}farthestPixelDistance(e){return Mu(e,e.pixelsPerMeter)}pointCoordinate(e,r,s,u){const f=e.horizonLineFromTop(!1),g=new Me(r,Math.max(f,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(g,u))}pointCoordinate3D(e,r,s){const u=new Me(r,s);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const s=e.horizonLineFromTop();return r.y<s}createInversionMatrix(e,r){return ly}createTileMatrix(e,r,s){let u,f,g;const v=s.canonical,C=Ma(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=eu(v,this);u=1,f=T.x+s.wrap*T.scale,g=T.y,hu(C,C,[u/T.scale,u/T.scale,e.pixelsPerMeter/r])}else u=r/e.zoomScale(v.z),f=(v.x+Math.pow(2,v.z)*s.wrap)*u,g=v.y*u;return ju(C,C,[f,g,0]),hu(C,C,[u/Pr,u/Pr,1]),C}upVector(e,r,s){return[0,0,1]}upVectorScale(e,r,s){return{metersToTile:1}}}class ld extends Fl{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,s]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Je(r));this.n=(u+Math.sin(Je(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n:s,c:u,r0:f}=this,g=Je(e-this.center[0]),v=Je(r),C=Math.sqrt(u-2*s*Math.sin(v))/s;return{x:C*Math.sin(g*s),y:C*Math.cos(g*s)-f,z:0}}unproject(e,r){const{n:s,c:u,r0:f}=this,g=f+r;let v=Math.atan2(e,Math.abs(g))*Math.sign(g);g*s<0&&(v-=Math.PI*Math.sign(e)*Math.sign(g));const C=Je(this.center[0])*s;v=en(v,-Math.PI-C,Math.PI-C);const T=Ht(mt(v/s)+this.center[0],-180,180),F=Math.asin(Ht((u-(e*e+g*g)*s*s)/(2*s),-1,1)),V=Ht(mt(F),-ia,ia);return new po(T,V)}}const Au=1.340264,Ec=-.081106,cd=893e-6,Pu=.003796,ud=Math.sqrt(3)/2;class Lp extends Fl{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(ud*Math.sin(r)),u=s*s,f=u*u*u;return{x:.5*(e*Math.cos(s)/(ud*(Au+3*Ec*u+f*(7*cd+9*Pu*u)))/Math.PI+.5),y:1-.5*(s*(Au+Ec*u+f*(cd+Pu*u))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=s*s,f=u*u*u;for(let F,V,j,Z=0;Z<12&&(V=s*(Au+Ec*u+f*(cd+Pu*u))-r,j=Au+3*Ec*u+f*(7*cd+9*Pu*u),F=V/j,s=Ht(s-F,-Math.PI/3,Math.PI/3),u=s*s,f=u*u*u,!(Math.abs(F)<1e-12));++Z);const g=ud*e*(Au+3*Ec*u+f*(7*cd+9*Pu*u))/Math.cos(s),v=Math.asin(Math.sin(s)/ud),C=Ht(180*g/Math.PI,-180,180),T=Ht(180*v/Math.PI,-ia,ia);return new po(C,T)}}class Mg extends Fl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const s=360*(e-.5),u=Ht(360*(.5-r),-ia,ia);return new po(s,u)}}const tu=Math.PI/2;function hf(n){return Math.tan((tu+n)/2)}class cy extends Fl{constructor(e){super(e),this.center=e.center||[0,30];const[r,s]=this.parallels=e.parallels||[30,30];let u=Je(r),f=Je(s);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const g=Math.cos(u),v=hf(u);this.n=u===f?Math.sin(u):Math.log(g/Math.cos(f))/Math.log(hf(f)/v),this.f=g*Math.pow(hf(u),this.n)/this.n}project(e,r){r=Je(r),this.southernCenter&&(r=-r),e=Je(e-this.center[0]);const s=1e-6,{n:u,f}=this;f>0?r<-tu+s&&(r=-tu+s):r>tu-s&&(r=tu-s);const g=f/Math.pow(hf(r),u);let v=g*Math.sin(u*e),C=f-g*Math.cos(u*e);return v=.5*(v/Math.PI+.5),C=.5*(C/Math.PI+.5),{x:v,y:this.southernCenter?C:1-C,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:s,f:u}=this,f=u-r,g=Math.sign(f),v=Math.sign(s)*Math.sqrt(e*e+f*f);let C=Math.atan2(e,Math.abs(f))*g;f*s<0&&(C-=Math.PI*Math.sign(e)*g);const T=Ht(mt(C/s)+this.center[0],-180,180),F=Ht(mt(2*Math.atan(Math.pow(u/v,1/s))-tu),-ia,ia);return new po(T,this.southernCenter?-F:F)}}class Ag extends Fl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:rc(e),y:Rl(r),z:0}}unproject(e,r){const s=Aa(e),u=Us(r);return new po(s,u)}}const Fp=Je(ia);class uy extends Fl{project(e,r){const s=(r=Je(r))*r,u=s*s;return{x:.5*((e=Je(e))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=25,f=0,g=s*s;do{g=s*s;const T=g*g;f=(s*(1.007226+g*(.015085+T*(.028874*g-.044475-.005916*T)))-r)/(1.007226+g*(.045255+T*(.259866*g-.311325-.005916*11*T))),s=Ht(s-f,-Fp,Fp)}while(Math.abs(f)>1e-6&&--u>0);g=s*s;const v=Ht(mt(e/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),C=mt(s);return new po(v,C)}}const Pg=Je(ia);class dy extends Fl{project(e,r){r=Je(r),e=Je(e);const s=Math.cos(r),u=2/Math.PI,f=Math.acos(s*Math.cos(e/2)),g=Math.sin(f)/f,v=.5*(e*u+2*s*Math.sin(e/2)/g)||0,C=.5*(r+Math.sin(r)/g)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(e,r){let s=e=(2*e-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,f=25;const g=1e-6;let v=0,C=0;do{const T=Math.cos(u),F=Math.sin(u),V=2*F*T,j=F*F,Z=T*T,Q=Math.cos(s/2),ce=Math.sin(s/2),Te=2*Q*ce,He=ce*ce,st=1-Z*Q*Q,Ge=st?1/st:0,at=st?Math.acos(T*Q)*Math.sqrt(1/st):0,yt=.5*(2*at*T*ce+2*s/Math.PI)-e,gt=.5*(at*F+u)-r,tn=.5*Ge*(Z*He+at*T*Q*j)+1/Math.PI,Zt=Ge*(Te*V/4-at*F*ce),gn=.125*Ge*(V*ce-at*F*Z*Te),Ln=.5*Ge*(j*Q+at*He*T)+.5,ln=Zt*gn-Ln*tn;v=(gt*Zt-yt*Ln)/ln,C=(yt*gn-gt*tn)/ln,s=Ht(s-v,-Math.PI,Math.PI),u=Ht(u-C,-Pg,Pg)}while((Math.abs(v)>g||Math.abs(C)>g)&&--f>0);return new po(mt(s),mt(u))}}class Rg extends Fl{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Je(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:s,cosPhi:u}=this;return{x:Je(e)*u*s+.5,y:-Math.sin(Je(r))/u*s+.5,z:0}}unproject(e,r){const{scale:s,cosPhi:u}=this,f=-(r-.5)/s,g=Ht(mt((e-.5)/s)/u,-180,180),v=Math.asin(Ht(f*u,-1,1)),C=Ht(mt(v),-ia,ia);return new po(g,C)}}class Og extends Ag{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,s){const u=Id(e,r,s);return vs(u,u,Md(Pl(s))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,r){const s=Uc(r.lat,r.lng),u=ra([],s),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude;Mh(s,s,u,Ga(1,0)*Pr*f);const g=Ma(new Float64Array(16));return Uu(g,e.pixelMatrix,e.globeMatrix),vs(s,s,g),new Me(s[0],s[1])}pixelsPerMeter(e,r){return Ga(1,0)*r}pixelSpaceConversion(e,r,s){const u=Ga(1,e)*r,f=J(Ga(1,45)*r,u,s);return this.pixelsPerMeter(e,r)/f}createTileMatrix(e,r,s){const u=Bh(Pl(s.canonical));return Uu(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,r){const{center:s}=e,u=Md(Pl(r));return Th(u,u,Je(s.lng)),pm(u,u,Je(s.lat)),hu(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,r,s,u){return Hf(e,r,s,!0)||new vu(0,0)}pointCoordinate3D(e,r,s){const u=this.pointCoordinate(e,r,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,r){return!Hf(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(u,f){const g=u.cameraToCenterDistance,v=u._centerAltitude*f,C=u._camera,T=u._camera.forward(),F=tc([],hl([],T,-g),[0,0,v]),V=u.worldSize/(2*Math.PI),j=[0,0,-V],Z=u.width/u.height,Q=Math.tan(u.fovAboveCenter),ce=hl([],C.up(),Q),Te=hl([],C.right(),Q*Z),He=ra([],tc([],tc([],T,ce),Te)),st=[];let Ge;if(new Lh(F,He).closestPointOnSphere(j,V,st)){const at=tc([],st,j),yt=Al([],at,F);Ge=Math.cos(u.fovAboveCenter)*Hu(yt)}else{const at=Al([],F,j),yt=Al([],j,F);ra(yt,yt);const gt=Hu(at)-V;Ge=Math.sqrt(gt*(gt+2*V));const tn=Math.acos(Ge/(V+gt))-Math.acos(Ml(T,yt));Ge*=Math.cos(tn)}return 1.01*Ge}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=_u(e.zoom);if(s>0){const u=Mu(e,Ga(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),g=Math.max(e.width,e.height)/e.worldSize*Math.PI;return J(r,u+f*(1-Math.cos(g)),Math.pow(s,10))}return r}upVector(e,r,s){return Id(r,s,e,1)}upVectorScale(e){return{metersToTile:$c(jc(Pl(e)))}}}function Bp(n){const e=n.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new Ag(n);case"equirectangular":return new Mg(n);case"naturalEarth":return new uy(n);case"equalEarth":return new Lp(n);case"winkelTripel":return new dy(n);case"albers":return r?new Rg(n):new ld(n);case"lambertConformalConic":return r?new Rg(n):new cy(n);case"globe":return new Og(n)}throw new Error(`Invalid projection name: ${n.name}`)}const hy=rd.types,fy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function _a(n,e,r,s,u,f,g,v,C,T,F,V,j){const Z=v?Math.min(wc,Math.round(v[0])):0,Q=v?Math.min(wc,Math.round(v[1])):0;n.emplaceBack(e,r,Math.round(32*s),Math.round(32*u),f,g,(Z<<1)+(C?1:0),Q,16*T,16*F,256*V,256*j)}function ff(n,e,r,s,u,f,g){n.emplaceBack(e,r,s,u,f,g)}function pf(n,e,r,s,u){n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u)}function Pv(n){for(const e of n.sections)if(Nr(e.text))return!0;return!1}class lh{constructor(e){this.layoutVertexArray=new Rn,this.indexArray=new br,this.programConfigurations=e,this.segments=new fs,this.dynamicLayoutVertexArray=new Fn,this.opacityVertexArray=new Ar,this.placedSymbolArray=new hs,this.globeExtVertexArray=new Vn}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,r,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mv.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,K_.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,fy,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Qh.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}_(lh,"SymbolBuffers");class mf{constructor(e,r,s){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new s,this.segments=new fs,this.collisionVertexArray=new gi,this.collisionVertexArrayExt=new pi}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,mp.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,gp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}_(mf,"CollisionBuffers");class nu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ma([]),this.placementViewportMatrix=Ma([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=id(this.zoom,r["text-size"]),this.iconSizeData=id(this.zoom,r["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==f&&void 0!==u.constantOr(1),this.sortFeaturesByY=("viewport-y"===f||"auto"===f&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(g=>Wa[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new lh(new uu(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new lh(new uu(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ia,this.lineVertexArray=new $u,this.symbolInstances=new no}calculateGlyphDependencies(e,r,s,u,f){for(let g=0;g<e.length;g++)if(r[e.charCodeAt(g)]=!0,u&&f){const v=tf[e.charAt(g)];v&&(r[v.charCodeAt(0)]=!0)}}populate(e,r,s,u){const f=this.layers[0],g=f.layout,v="globe"===this.projection.name,C=g.get("text-font"),T=g.get("text-field"),F=g.get("icon-image"),V=("constant"!==T.value.kind||T.value.value instanceof Pi&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&("constant"!==C.value.kind||C.value.value.length>0),j="constant"!==F.value.kind||!!F.value.value||Object.keys(F.parameters).length>0,Z=g.get("symbol-sort-key");if(this.features=[],!V&&!j)return;const Q=r.iconDependencies,ce=r.glyphDependencies,Te=r.availableImages,He=new $(this.zoom);for(const{feature:st,id:Ge,index:at,sourceLayerIndex:yt}of e){const gt=f._featureFilter.needGeometry,tn=Gc(st,gt);if(!f._featureFilter.filter(He,tn,s))continue;if(gt||(tn.geometry=ic(st,s,u)),v&&1!==st.type&&s.z<=5){const ln=tn.geometry,Sn=.98078528056,In=(kn,Un)=>Ml(Id(kn.x,kn.y,s,1),Id(Un.x,Un.y,s,1))<Sn;for(let kn=0;kn<ln.length;kn++)ln[kn]=M_(ln[kn],In)}let Zt,gn;if(V){const ln=f.getValueAndResolveTokens("text-field",tn,s,Te),Sn=Pi.factory(ln);Pv(Sn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===w()||this.hasRTLText&&O.isParsed())&&(Zt=ef(Sn,f,tn))}if(j){const ln=f.getValueAndResolveTokens("icon-image",tn,s,Te);gn=ln instanceof So?ln:So.fromString(ln)}if(!Zt&&!gn)continue;const Ln=this.sortFeaturesByKey?Z.evaluate(tn,{},s):void 0;if(this.features.push({id:Ge,text:Zt,icon:gn,index:at,sourceLayerIndex:yt,geometry:tn.geometry,properties:st.properties,type:hy[st.type],sortKey:Ln}),gn&&(Q[gn.name]=!0),Zt){const ln=C.evaluate(tn,{},s).join(","),Sn="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Wa.vertical)>=0;for(const In of Zt.sections)if(In.image)Q[In.image.name]=!0;else{const kn=Oe(Zt.toString()),Un=In.fontStack||ln,_n=ce[Un]=ce[Un]||{};this.calculateGlyphDependencies(In.text,_n,Sn,this.allowVerticalPlacement,kn)}}}"line"===g.get("symbol-placement")&&(this.features=function(st){const Ge={},at={},yt=[];let gt=0;function tn(ln){yt.push(st[ln]),gt++}function Zt(ln,Sn,In){const kn=at[ln];return delete at[ln],at[Sn]=kn,yt[kn].geometry[0].pop(),yt[kn].geometry[0]=yt[kn].geometry[0].concat(In[0]),kn}function gn(ln,Sn,In){const kn=Ge[Sn];return delete Ge[Sn],Ge[ln]=kn,yt[kn].geometry[0].shift(),yt[kn].geometry[0]=In[0].concat(yt[kn].geometry[0]),kn}function Ln(ln,Sn,In){const kn=In?Sn[0][Sn[0].length-1]:Sn[0][0];return`${ln}:${kn.x}:${kn.y}`}for(let ln=0;ln<st.length;ln++){const Sn=st[ln],In=Sn.geometry,kn=Sn.text?Sn.text.toString():null;if(!kn){tn(ln);continue}const Un=Ln(kn,In),_n=Ln(kn,In,!0);if(Un in at&&_n in Ge&&at[Un]!==Ge[_n]){const tr=gn(Un,_n,In),pr=Zt(Un,_n,yt[tr].geometry);delete Ge[Un],delete at[_n],at[Ln(kn,yt[pr].geometry,!0)]=pr,yt[tr].geometry=null}else Un in at?Zt(Un,_n,In):_n in Ge?gn(Un,_n,In):(tn(ln),Ge[Un]=gt-1,at[_n]=gt-1)}return yt.filter(ln=>ln.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((st,Ge)=>st.sortKey-Ge.sortKey)}update(e,r,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,s,u),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,s,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Bp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const s=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:u,y:f}of r)this.lineVertexArray.emplaceBack(u,f);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,r,s,u,f,g,v,C,T,F,V,j,Z,Q){const ce=e.indexArray,Te=e.layoutVertexArray,He=e.globeExtVertexArray,st=e.segments.prepareSegment(4*r.length,Te,ce,this.canOverlap?g.sortKey:void 0),Ge=this.glyphOffsetArray.length,at=st.vertexLength,yt=this.allowVerticalPlacement&&v===Wa.vertical?Math.PI/2:0,gt=g.text&&g.text.sections;for(let Zt=0;Zt<r.length;Zt++){const{tl:gn,tr:Ln,bl:ln,br:Sn,tex:In,pixelOffsetTL:kn,pixelOffsetBR:Un,minFontScaleX:_n,minFontScaleY:tr,glyphOffset:pr,isSDF:ar,sectionIndex:ii}=r[Zt],jn=st.vertexLength,Ir=pr[1];if(_a(Te,T.x,T.y,gn.x,Ir+gn.y,In.x,In.y,s,ar,kn.x,kn.y,_n,tr),_a(Te,T.x,T.y,Ln.x,Ir+Ln.y,In.x+In.w,In.y,s,ar,Un.x,kn.y,_n,tr),_a(Te,T.x,T.y,ln.x,Ir+ln.y,In.x,In.y+In.h,s,ar,kn.x,Un.y,_n,tr),_a(Te,T.x,T.y,Sn.x,Ir+Sn.y,In.x+In.w,In.y+In.h,s,ar,Un.x,Un.y,_n,tr),C){const{x:si,y:Hi,z:li}=C.anchor,[Gr,Ao,di]=C.up;ff(He,si,Hi,li,Gr,Ao,di),ff(He,si,Hi,li,Gr,Ao,di),ff(He,si,Hi,li,Gr,Ao,di),ff(He,si,Hi,li,Gr,Ao,di),pf(e.dynamicLayoutVertexArray,si,Hi,li,yt)}else pf(e.dynamicLayoutVertexArray,T.x,T.y,T.z,yt);ce.emplaceBack(jn,jn+1,jn+2),ce.emplaceBack(jn+1,jn+2,jn+3),st.vertexLength+=4,st.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pr[0]),Zt!==r.length-1&&ii===r[Zt+1].sectionIndex||e.programConfigurations.populatePaintArrays(Te.length,g,g.index,{},Z,Q,gt&&gt[ii])}const tn=C?C.anchor:T;e.placedSymbolArray.emplaceBack(tn.x,tn.y,tn.z,T.x,T.y,Ge,this.glyphOffsetArray.length-Ge,at,F,V,T.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],v,0,!1,0,j,0)}_commitLayoutVertex(e,r,s,u,f,g,v){e.emplaceBack(r,s,u,f,g,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,r,s,u,f,g,v){const C=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),T=C.vertexLength,F=v.tileAnchorX,V=v.tileAnchorY;for(let Z=0;Z<4;Z++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,F,V,new Me(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,F,V,new Me(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,F,V,new Me(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,F,V,new Me(e.x1,e.y2)),C.vertexLength+=4;const j=s.indexArray;j.emplaceBack(T,T+1),j.emplaceBack(T+1,T+2),j.emplaceBack(T+2,T+3),j.emplaceBack(T+3,T),C.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,s,u,f,g){for(let v=u;v<f;v++){const C=s.get(v),T=this.getSymbolInstanceTextSize(e,g,r,v);this._addCollisionDebugVertices(C,T,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,r,s,u,f,g){for(let v=u;v<f;v++){const C=s.get(v),T=this.getSymbolInstanceIconSize(e,r,g.placedIconSymbolIndex);this._addCollisionDebugVertices(C,T,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mf(dr,Du.members,zs),this.iconCollisionBox=new mf(dr,Du.members,zs);const s=Cu(this.iconSizeData,e),u=Cu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,r,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(u,e,r,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(s,e,r,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(s,e,r,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(e,r,s,u){const f=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),g=Xc(this.textSizeData,e,f)/Rs;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,r,s){const u=this.icon.placedSymbolArray.get(s),f=Xc(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,r,s){e.emplaceBack(r,-s,-s),e.emplaceBack(r,s,-s),e.emplaceBack(r,s,s),e.emplaceBack(r,-s,s)}_updateTextDebugCollisionBoxes(e,r,s,u,f,g){for(let v=u;v<f;v++){const C=s.get(v),T=this.getSymbolInstanceTextSize(e,g,r,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,C.padding)}}_updateIconDebugCollisionBoxes(e,r,s,u,f,g){for(let v=u;v<f;v++){const C=s.get(v),T=this.getSymbolInstanceIconSize(e,r,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,C.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Cu(this.iconSizeData,e),u=Cu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,r,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(u,e,r,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(s,e,r,g.iconBoxStartIndex,g.iconBoxEndIndex,g.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,r,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,s,u,f,g,v,C,T){const F={};if(r<s){const{x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at,featureIndex:yt}=e.get(r);F.textBox={x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at},F.textFeatureIndex=yt}if(u<f){const{x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at,featureIndex:yt}=e.get(u);F.verticalTextBox={x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at},F.verticalTextFeatureIndex=yt}if(g<v){const{x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at,featureIndex:yt}=e.get(g);F.iconBox={x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at},F.iconFeatureIndex=yt}if(C<T){const{x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at,featureIndex:yt}=e.get(C);F.verticalIconBox={x1:V,y1:j,x2:Z,y2:Q,padding:ce,projectedAnchorX:Te,projectedAnchorY:He,projectedAnchorZ:st,tileAnchorX:Ge,tileAnchorY:at},F.verticalIconFeatureIndex=yt}return F}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const s=e.placedSymbolArray.get(r),u=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const r=Math.sin(e),s=Math.cos(e),u=[],f=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const C=this.symbolInstances.get(v);u.push(0|Math.round(r*C.tileAnchorX+s*C.tileAnchorY)),f.push(C.featureIndex)}return g.sort((v,C)=>u[v]-u[C]||f[C]-f[v]),g}addToSortKeyRanges(e,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:v,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:T}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),f>=0&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&g!==u&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.text,v),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}_(nu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nu.MAX_GLYPHS=65535,nu.addDynamicAttributes=pf;const py=new Xe({"symbol-placement":new se(cn.layout_symbol["symbol-placement"]),"symbol-spacing":new se(cn.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new se(cn.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ie(cn.layout_symbol["symbol-sort-key"]),"symbol-z-order":new se(cn.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new se(cn.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new se(cn.layout_symbol["icon-ignore-placement"]),"icon-optional":new se(cn.layout_symbol["icon-optional"]),"icon-rotation-alignment":new se(cn.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ie(cn.layout_symbol["icon-size"]),"icon-text-fit":new se(cn.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new se(cn.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ie(cn.layout_symbol["icon-image"]),"icon-rotate":new Ie(cn.layout_symbol["icon-rotate"]),"icon-padding":new se(cn.layout_symbol["icon-padding"]),"icon-keep-upright":new se(cn.layout_symbol["icon-keep-upright"]),"icon-offset":new Ie(cn.layout_symbol["icon-offset"]),"icon-anchor":new Ie(cn.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new se(cn.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new se(cn.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new se(cn.layout_symbol["text-rotation-alignment"]),"text-field":new Ie(cn.layout_symbol["text-field"]),"text-font":new Ie(cn.layout_symbol["text-font"]),"text-size":new Ie(cn.layout_symbol["text-size"]),"text-max-width":new Ie(cn.layout_symbol["text-max-width"]),"text-line-height":new Ie(cn.layout_symbol["text-line-height"]),"text-letter-spacing":new Ie(cn.layout_symbol["text-letter-spacing"]),"text-justify":new Ie(cn.layout_symbol["text-justify"]),"text-radial-offset":new Ie(cn.layout_symbol["text-radial-offset"]),"text-variable-anchor":new se(cn.layout_symbol["text-variable-anchor"]),"text-anchor":new Ie(cn.layout_symbol["text-anchor"]),"text-max-angle":new se(cn.layout_symbol["text-max-angle"]),"text-writing-mode":new se(cn.layout_symbol["text-writing-mode"]),"text-rotate":new Ie(cn.layout_symbol["text-rotate"]),"text-padding":new se(cn.layout_symbol["text-padding"]),"text-keep-upright":new se(cn.layout_symbol["text-keep-upright"]),"text-transform":new Ie(cn.layout_symbol["text-transform"]),"text-offset":new Ie(cn.layout_symbol["text-offset"]),"text-allow-overlap":new se(cn.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new se(cn.layout_symbol["text-ignore-placement"]),"text-optional":new se(cn.layout_symbol["text-optional"])});var Np={paint:new Xe({"icon-opacity":new Ie(cn.paint_symbol["icon-opacity"]),"icon-color":new Ie(cn.paint_symbol["icon-color"]),"icon-halo-color":new Ie(cn.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ie(cn.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ie(cn.paint_symbol["icon-halo-blur"]),"icon-translate":new se(cn.paint_symbol["icon-translate"]),"icon-translate-anchor":new se(cn.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ie(cn.paint_symbol["text-opacity"]),"text-color":new Ie(cn.paint_symbol["text-color"],{runtimeType:je,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Ie(cn.paint_symbol["text-halo-color"]),"text-halo-width":new Ie(cn.paint_symbol["text-halo-width"]),"text-halo-blur":new Ie(cn.paint_symbol["text-halo-blur"]),"text-translate":new se(cn.paint_symbol["text-translate"]),"text-translate-anchor":new se(cn.paint_symbol["text-translate-anchor"])}),layout:py};class zp{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:No,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_(zp,"FormatSectionOverride",{omit:["defaultValue"]});class gf extends Sl{constructor(e){super(e,Np)}recalculate(e,r){super.recalculate(e,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const f of s)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,s,u){const f=this.layout.get(e).evaluate(r,{},s,u),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||ta(g.value)||!f?f:(v=r.properties,f.replace(/{([^{}]+)}/g,(T,F)=>F in v?String(v[F]):""));var v}createBucket(e){return new nu(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Np.paint.overridableProperties){if(!gf.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),s=new zp(r),u=new Ps(s,r.property.specification);let f=null;f="constant"===r.value.kind||"source"===r.value.kind?new _s("source",u):new Cs("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new be(r.property,f,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&gf.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const s=e.get("text-field"),u=Np.paint.properties[r];let f=!1;const g=v=>{for(const C of v)if(u.overrides&&u.overrides.hasOverride(C))return void(f=!0)};if("constant"===s.value.kind&&s.value.value instanceof Pi)g(s.value.value.sections);else if("source"===s.value.kind){const v=T=>{f||(T instanceof rr&&Ni(T.value)===zt?g(T.value.sections):T instanceof Ii?g(T.sections):T.eachChild(v))},C=s.value;C._styleExpression&&v(C._styleExpression.expression)}return f}getProgramConfiguration(e){return new Nc(this,e)}}var my={paint:new Xe({"background-color":new se(cn.paint_background["background-color"]),"background-pattern":new se(cn.paint_background["background-pattern"]),"background-opacity":new se(cn.paint_background["background-opacity"])})},$p={paint:new Xe({"raster-opacity":new se(cn.paint_raster["raster-opacity"]),"raster-hue-rotate":new se(cn.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new se(cn.paint_raster["raster-brightness-min"]),"raster-brightness-max":new se(cn.paint_raster["raster-brightness-max"]),"raster-saturation":new se(cn.paint_raster["raster-saturation"]),"raster-contrast":new se(cn.paint_raster["raster-contrast"]),"raster-resampling":new se(cn.paint_raster["raster-resampling"]),"raster-fade-duration":new se(cn.paint_raster["raster-fade-duration"])})};class gy extends Sl{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var _y={paint:new Xe({"sky-type":new se(cn.paint_sky["sky-type"]),"sky-atmosphere-sun":new se(cn.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new se(cn.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new se(cn.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new se(cn.paint_sky["sky-gradient-radius"]),"sky-gradient":new We(cn.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new se(cn.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new se(cn.paint_sky["sky-atmosphere-color"]),"sky-opacity":new se(cn.paint_sky["sky-opacity"])})};function Vp(n,e,r){const s=[0,0,1],u=zf([]);return Cd(u,u,r?-Je(n)+Math.PI:Je(n)),$f(u,u,-Je(e)),S_(s,s,u),ra(s,s)}const yy={circle:class extends Sl{constructor(n){super(n,Xu)}createBucket(n){return new Vh(n)}queryRadius(n){const e=n;return Yu("circle-radius",this,e)+Yu("circle-stroke-width",this,e)+Fd(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,r,s,u,f,g,v){const C=Bd(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return Om(n,s,f,g,v,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),C,T)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Nc(this,n)}},heatmap:class extends Sl{createBucket(n){return new km(n)}constructor(n){super(n,Lm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"heatmap-color"===n&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Uh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Yu("heatmap-radius",this,n)}queryIntersectsFeature(n,e,r,s,u,f,g,v){const C=this.paint.get("heatmap-radius").evaluate(e,r);return Om(n,s,f,g,v,!0,!0,new Me(0,0),C)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Nc(this,n)}},hillshade:class extends Sl{constructor(n){super(n,L_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Sl{constructor(n){super(n,ed)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(n){return new Nc(this,n)}recalculate(n,e){super.recalculate(n,e);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Qu(n)}queryRadius(){return Fd(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,r,s,u,f){return!n.queryGeometry.isAboveHorizon&&Qf(tp(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Sl{constructor(n){super(n,Kh)}createBucket(n){return new qd(n)}queryRadius(){return Fd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Nc(this,n)}queryIntersectsFeature(n,e,r,s,u,f,g,v,C){const T=Bd(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(e,r),V=this.paint.get("fill-extrusion-base").evaluate(e,r),j=[0,0],Z=v&&f.elevation,Q=f.elevation?f.elevation.exaggeration():1,ce=n.tile.getBucket(this);if(Z&&ce instanceof qd){const at=ce.centroidVertexArray,yt=C+1;yt<at.length&&(j[0]=at.geta_centroid_pos0(yt),j[1]=at.geta_centroid_pos1(yt))}if(0===j[0]&&1===j[1])return!1;"globe"===f.projection.name&&(s=Jm([s],[new Me(0,0),new Me(Pr,Pr)],n.tileID.canonical).map(at=>at.polygon).flat());const Te=Z?v:null,[He,st]=(yt=s,gt=V,tn=F,Zt=T,gn=g,Ln=Te,ln=j,Sn=Q,In=f.center.lat,"globe"===(at=f).projection.name?function(Un,_n,tr,pr,ar,ii,jn,Ir,si,Hi,li){const Gr=[],Ao=[],di=Un.projection.upVectorScale(li,Un.center.lat,Un.worldSize).metersToTile,ci=[0,0,0,1],xo=[0,0,0,1],bo=(go,Lo,Fo,os)=>{go[0]=Lo,go[1]=Fo,go[2]=os,go[3]=1},wo=Zd();tr>0&&(tr+=wo),pr+=wo;for(const go of _n){const Lo=[],Fo=[];for(const os of go){const Ki=os.x+ar.x,xs=os.y+ar.y,Go=Un.projection.projectTilePoint(Ki,xs,li),Wo=Un.projection.upVector(li,os.x,os.y);let Gi=tr,qo=pr;if(jn){const Eo=eg(Ki,xs,tr,pr,jn,Ir,si,Hi);Gi+=Eo.base,qo+=Eo.top}0!==tr?bo(ci,Go.x+Wo[0]*di*Gi,Go.y+Wo[1]*di*Gi,Go.z+Wo[2]*di*Gi):bo(ci,Go.x,Go.y,Go.z),bo(xo,Go.x+Wo[0]*di*qo,Go.y+Wo[1]*di*qo,Go.z+Wo[2]*di*qo),vs(ci,ci,ii),vs(xo,xo,ii),Lo.push(new Eu(ci[0],ci[1],ci[2])),Fo.push(new Eu(xo[0],xo[1],xo[2]))}Gr.push(Lo),Ao.push(Fo)}return[Gr,Ao]}(at,yt,gt,tn,Zt,gn,Ln,ln,Sn,In,n.tileID.canonical):Ln?function(Un,_n,tr,pr,ar,ii,jn,Ir,si){const Hi=[],li=[],Gr=[0,0,0,1];for(const Ao of Un){const di=[],ci=[];for(const xo of Ao){const bo=xo.x+pr.x,wo=xo.y+pr.y,go=eg(bo,wo,_n,tr,ii,jn,Ir,si);Gr[0]=bo,Gr[1]=wo,Gr[2]=go.base,Gr[3]=1,zc(Gr,Gr,ar),Gr[3]=Math.max(Gr[3],1e-5);const Lo=new Eu(Gr[0]/Gr[3],Gr[1]/Gr[3],Gr[2]/Gr[3]);Gr[0]=bo,Gr[1]=wo,Gr[2]=go.top,Gr[3]=1,zc(Gr,Gr,ar),Gr[3]=Math.max(Gr[3],1e-5);const Fo=new Eu(Gr[0]/Gr[3],Gr[1]/Gr[3],Gr[2]/Gr[3]);di.push(Lo),ci.push(Fo)}Hi.push(di),li.push(ci)}return[Hi,li]}(yt,gt,tn,Zt,gn,Ln,ln,Sn,In):function(Un,_n,tr,pr,ar){const ii=[],jn=[],Ir=ar[8]*_n,si=ar[9]*_n,Hi=ar[10]*_n,li=ar[11]*_n,Gr=ar[8]*tr,Ao=ar[9]*tr,di=ar[10]*tr,ci=ar[11]*tr;for(const xo of Un){const bo=[],wo=[];for(const go of xo){const Lo=go.x+pr.x,Fo=go.y+pr.y,os=ar[0]*Lo+ar[4]*Fo+ar[12],Ki=ar[1]*Lo+ar[5]*Fo+ar[13],xs=ar[2]*Lo+ar[6]*Fo+ar[14],Go=ar[3]*Lo+ar[7]*Fo+ar[15],Wo=os+Ir,Gi=Ki+si,qo=xs+Hi,Eo=Math.max(Go+li,1e-5),ya=os+Gr,bs=Ki+Ao,Ys=xs+di,Is=Math.max(Go+ci,1e-5);bo.push(new Eu(Wo/Eo,Gi/Eo,qo/Eo)),wo.push(new Eu(ya/Is,bs/Is,Ys/Is))}ii.push(bo),jn.push(wo)}return[ii,jn]}(yt,gt,tn,Zt,gn)),Ge=n.queryGeometry;var at,yt,gt,tn,Zt,gn,Ln,ln,Sn,In;return function(at,yt,gt){let tn=1/0;Qf(gt,yt)&&(tn=Qm(gt,yt[0]));for(let Zt=0;Zt<yt.length;Zt++){const gn=yt[Zt],Ln=at[Zt];for(let ln=0;ln<gn.length-1;ln++){const Sn=gn[ln],In=[Sn,gn[ln+1],Ln[ln+1],Ln[ln],Sn];Od(gt,In)&&(tn=Math.min(tn,Qm(gt,In)))}}return tn!==1/0&&tn}(He,st,Ge.isPointQuery()?Ge.screenBounds:Ge.screenGeometry)}},line:class extends Sl{constructor(n){super(n,rg),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if("line-gradient"===n){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof P,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=ig.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new pp(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Nc(this,n)}queryRadius(n){const e=n,r=X_(Yu("line-width",this,e),Yu("line-gap-width",this,e)),s=Yu("line-offset",this,e);return r/2+Math.abs(s)+Fd(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,r,s,u,f){if(n.queryGeometry.isAboveHorizon)return!1;const g=tp(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),v=n.pixelToTileUnitsFactor/2*X_(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),C=this.paint.get("line-offset").evaluate(e,r);return C&&(s=function(T,F){const V=[],j=new Me(0,0);for(let Z=0;Z<T.length;Z++){const Q=T[Z],ce=[];for(let Te=0;Te<Q.length;Te++){const He=Q[Te],st=Q[Te+1],Ge=0===Te?j:He.sub(Q[Te-1])._unit()._perp(),at=Te===Q.length-1?j:st.sub(He)._unit()._perp(),yt=Ge._add(at)._unit();yt._mult(1/(yt.x*at.x+yt.y*at.y)),ce.push(yt._mult(F)._add(He))}V.push(ce)}return V}(s,C*n.pixelToTileUnitsFactor)),function(T,F,V){for(let j=0;j<F.length;j++){const Z=F[j];if(T.length>=3)for(let Q=0;Q<Z.length;Q++)if(Wc(T,Z[Q]))return!0;if(ep(T,Z,V))return!0}return!1}(g,s,v)}isTileClipped(){return!0}},symbol:gf,background:class extends Sl{constructor(n){super(n,my)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Sl{constructor(n){super(n,$p)}getProgramIds(){return["raster"]}},sky:class extends Sl{constructor(n){super(n,_y),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"sky-gradient"===n?this._updateColorRamp():"sky-atmosphere-sun"!==n&&"sky-atmosphere-halo-color"!==n&&"sky-atmosphere-color"!==n&&"sky-atmosphere-sun-intensity"!==n||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Uh({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),u=!s,f=n.style.light,g=f.properties.get("position");return u&&"viewport"===f.properties.get("anchor")&&mn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Vp(g.azimuthal,90-g.polar,e):Vp(s[0],90-s[1],e)}const r=this.paint.get("sky-gradient-center");return Vp(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return"atmosphere"===n?["skyboxCapture","skybox"]:"gradient"===n?["skyboxGradient"]:null}}};class ch{constructor(e,r,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,s){const{width:u,height:f}=e,{context:g}=this,{gl:v}=g,{HTMLImageElement:C,HTMLCanvasElement:T,HTMLVideoElement:F,ImageData:V,ImageBitmap:j}=ve;if(v.bindTexture(v.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!r||!1!==r.premultiply)),s||this.size&&this.size[0]===u&&this.size[1]===f){const{x:Z,y:Q}=s||{x:0,y:0};e instanceof C||e instanceof T||e instanceof F||e instanceof V||j&&e instanceof j?v.texSubImage2D(v.TEXTURE_2D,0,Z,Q,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,Z,Q,u,f,v.RGBA,v.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof C||e instanceof T||e instanceof F||e instanceof V||j&&e instanceof j?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,u,f,0,this.format,v.UNSIGNED_BYTE,e.data);this.useMipmap=!!(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,r){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class lc{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Up{constructor(){this.tasks={},this.taskQueue=[],Yt(["process"],this),this.invoker=new lc(this.process),this.nextId=0}add(e,r){const s=this.nextId++,u=function({type:f,isSymbolTile:g,zoom:v}){return v=v||0,"message"===f?0:"maybePrepare"!==f||g?"parseTile"!==f||g?"parseTile"===f&&g?300-v:"maybePrepare"===f&&g?400-v:500:200-v:100-v}(r);if(0===u){nr();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:r,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){nr();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<r&&(r=f.priority,e=u)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class kg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const s=e[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Lg=["tile","layer","source","sourceLayer","state"];class Fg{constructor(e,r,s,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=s,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const r of Lg)void 0!==this[r]&&(e[r]=this[r]);return e}}const Nl=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,r=0,s=0,u=0,f=0,g=0,v=0;for(1&e?u=f=g=32:r=s=v=32;(e>>=1)>1;){const T=r+u>>1,F=s+f>>1;1&e?(u=r,f=s,r=g,s=v):(r=u,s=f,u=g,f=v),g=T,v=F}const C=4*n;Nl[C+0]=r,Nl[C+1]=s,Nl[C+2]=u,Nl[C+3]=f}const pl=new Uint16Array(2178),Ru=new Uint8Array(1089),uh=new Uint16Array(1089);function jp(n){return 0===n?-.03125:32===n?.03125:0}var Hp=Mt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Gp={type:2,extent:Pr,loadGeometry:()=>[[new Me(0,0),new Me(Pr+1,0),new Me(Pr+1,Pr+1),new Me(0,Pr+1),new Me(0,0)]]};class dh{constructor(e,r,s,u,f){this.tileID=e,this.uid=ze(),this.uses=0,this.tileSize=r,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<fi.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=eu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const g={};if(!f)return g;for(const v of u){const C=v.layerIds.map(T=>f.getLayer(T)).filter(Boolean);if(0!==C.length){v.layers=C,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(T=>C.filter(F=>F.id===T)[0]));for(const T of C)g[T.id]=v}}return g}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof nu){if(this.hasSymbolBuckets=!0,!s)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof nu&&f.hasRTLText){this.hasRTLText=!0,O.isLoading()||O.isLoaded()||"deferred"!==w()||A();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ji}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const u=this.buckets[s];u.uploadPending()&&u.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ch(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ch(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ch(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,s,u,f,g,v,C){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:v,transform:g,params:f,tileTransform:this.tileTransform},e,r,s):{}}querySourceFeatures(e,r){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),f=r?r.sourceLayer:"",g=u._geojsonTileLayer||u[f];if(!g)return;const v=Da(r&&r.filter),{z:C,x:T,y:F}=this.tileID.canonical,V={z:C,x:T,y:F};for(let j=0;j<g.length;j++){const Z=g.feature(j);if(v.needGeometry){const Te=Gc(Z,!0);if(!v.filter(new $(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!v.filter(new $(this.tileID.overscaledZ),Z))continue;const Q=s.getId(Z,f),ce=new Fg(Z,C,T,F,Q);ce.tile=V,e.push(ce)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const s=_r(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const f=this.expirationTime-r;f?this.expirationTime=s+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!r)return;const s=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const g=this.buckets[f],v=g.layers[0].sourceLayer||"_geojsonTileLayer",C=s[v],T=e[v];if(!C||!T||0===Object.keys(T).length)continue;if(g.update(T,C,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof pp||g instanceof Qu){const V=r.style._getSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&V&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(V.id,this.tileID)}const F=r&&r.style&&r.style.getLayer(f);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(g)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<fi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=fi.now()+e}setTexture(e,r){const s=r.context,u=s.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new ch(s,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,r){const s={};for(const u of r)s[u]=!0;this.dependencies[e]=s}hasDependency(e,r){for(const s of e){const u=this.dependencies[s];if(u)for(const f of r)if(u[f])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||"mercator"===r.name||this._tileDebugBuffer)return;const s=ic(Gp,this.tileID.canonical,this.tileTransform)[0],u=new On,f=new Sa;for(let g=0;g<s.length;g++){const{x:v,y:C}=s[g];u.emplaceBack(v,C),f.emplaceBack(g)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,Td.members),this._tileDebugSegments=fs.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||"mercator"===r.name)return;const s=ic(Gp,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const g=function(v,C){const T=eu(v,C),F=Math.pow(2,v.z);for(let Te=0;Te<33;Te++)for(let He=0;He<33;He++){const st=Aa((v.x+(He+jp(He))/32)/F),Ge=Us((v.y+(Te+jp(Te))/32)/F),at=C.project(st,Ge),yt=33*Te+He;pl[2*yt+0]=Math.round((at.x*T.scale-T.x)*Pr),pl[2*yt+1]=Math.round((at.y*T.scale-T.y)*Pr)}Ru.fill(0),uh.fill(0);for(let Te=2045;Te>=0;Te--){const He=4*Te,st=Nl[He+0],Ge=Nl[He+1],at=Nl[He+2],yt=Nl[He+3],gt=st+at>>1,tn=Ge+yt>>1,Zt=gt+tn-Ge,gn=tn+st-gt,Ln=33*Ge+st,ln=33*yt+at,Sn=33*tn+gt,In=Math.hypot((pl[2*Ln+0]+pl[2*ln+0])/2-pl[2*Sn+0],(pl[2*Ln+1]+pl[2*ln+1])/2-pl[2*Sn+1])>=16;Ru[Sn]=Ru[Sn]||(In?1:0),Te<1022&&(Ru[Sn]=Ru[Sn]||Ru[33*(Ge+gn>>1)+(st+Zt>>1)]||Ru[33*(yt+gn>>1)+(at+Zt>>1)])}const V=new Tn,j=new br;let Z=0;function Q(Te,He){const st=33*He+Te;return 0===uh[st]&&(V.emplaceBack(pl[2*st+0],pl[2*st+1],Te*Pr/32,He*Pr/32),uh[st]=++Z),uh[st]-1}function ce(Te,He,st,Ge,at,yt){const gt=Te+st>>1,tn=He+Ge>>1;if(Math.abs(Te-at)+Math.abs(He-yt)>1&&Ru[33*tn+gt])ce(at,yt,Te,He,gt,tn),ce(st,Ge,at,yt,gt,tn);else{const Zt=Q(Te,He),gn=Q(st,Ge),Ln=Q(at,yt);j.emplaceBack(Zt,gn,Ln)}}return ce(0,0,32,32,32,0),ce(32,32,0,0,0,32),{vertices:V,indices:j}}(this.tileID.canonical,r);u=g.vertices,f=g.indices}else{u=new Tn,f=new br;for(const{x:v,y:C}of s)u.emplaceBack(v,C,0,0);const g=Nm(u.int16,void 0,4);for(let v=0;v<g.length;v+=3)f.emplaceBack(g[v],g[v+1],g[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,Hp.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=fs.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,r){const s=r.projection;if(!s||"globe"!==s.name||r.freezeTileCoverage)return;const u=this.tileID.canonical,f=Md(Wf(u,r)),g=_u(r.zoom);let v;g>0&&(v=Ff(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,r,f,v,g),this._makeGlobeTileDebugTextBuffer(e,u,r,f,v,g)}_globePoint(e,r,s,u,f,g,v){let C=Id(e,r,s);if(g){const T=1<<s.z,F=rc(u.center.lng),V=Rl(u.center.lat),j=(s.x+.5)/T-F;let Z=0;j>.5?Z=-1:j<-.5&&(Z=1);let Q=(e/Pr+s.x)/T+Z,ce=(r/Pr+s.y)/T;Q=(Q-F)*u._pixelsPerMercatorPixel+F,ce=(ce-V)*u._pixelsPerMercatorPixel+V;const Te=[Q*u.worldSize,ce*u.worldSize,0];vs(Te,Te,g),C=gu(C,Te,v)}return vs(C,C,f)}_makeGlobeTileDebugBorderBuffer(e,r,s,u,f,g){const v=new On,C=new Sa,T=new qt,F=(j,Z,Q,ce,Te)=>{const He=(Q-j)/(Te-1),st=(ce-Z)/(Te-1),Ge=v.length;for(let at=0;at<Te;at++){const yt=j+at*He,gt=Z+at*st;v.emplaceBack(yt,gt);const tn=this._globePoint(yt,gt,r,s,u,f,g);T.emplaceBack(tn[0],tn[1],tn[2]),C.emplaceBack(Ge+at)}},V=Pr;F(0,0,V,0,16),F(V,0,V,V,16),F(V,V,0,V,16),F(0,V,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(C),this._tileDebugBuffer=e.createVertexBuffer(v,Td.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(T,wm.members),this._tileDebugSegments=fs.simpleSegment(0,0,v.length,C.length)}_makeGlobeTileDebugTextBuffer(e,r,s,u,f,g){const v=Pr/4,C=new On,T=new br,F=new qt,V=25;T.reserve(32),C.reserve(V),F.reserve(V);const j=(Z,Q)=>V*Z+Q;for(let Z=0;Z<V;Z++){const Q=Z*v;for(let ce=0;ce<V;ce++){const Te=ce*v;C.emplaceBack(Te,Q);const He=this._globePoint(Te,Q,r,s,u,f,g);F.emplaceBack(He[0],He[1],He[2])}}for(let Z=0;Z<4;Z++)for(let Q=0;Q<4;Q++){const ce=j(Z,Q),Te=j(Z,Q+1),He=j(Z+1,Q),st=j(Z+1,Q+1);T.emplaceBack(ce,Te,He),T.emplaceBack(He,Te,st)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(T),this._tileDebugTextBuffer=e.createVertexBuffer(C,Td.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(F,wm.members),this._tileDebugTextSegments=fs.simpleSegment(0,0,V,32)}}class Dc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,s){const u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ue(this.stateChanges[e][u],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][u]){this.deletedStates[e][u]={};for(const f in this.state[e][u])s[f]||(this.deletedStates[e][u][f]=null)}else for(const f in s)this.deletedStates[e]&&this.deletedStates[e][u]&&null===this.deletedStates[e][u][f]&&delete this.deletedStates[e][u][f]}removeFeatureState(e,r,s){if(null===this.deletedStates[e])return;const u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==r)null!==this.deletedStates[e][u]&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(void 0!==r)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){const s=String(r),u=ue({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const f=this.deletedStates[e][r];if(null===f)return{};for(const g in f)delete u[g]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),ue(this.state[u][g],this.stateChanges[u][g]),f[g]=this.state[u][g];s[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(null===this.deletedStates[u])for(const g in this.state[u])f[g]={},this.state[u][g]={};else for(const g in this.deletedStates[u]){if(null===this.deletedStates[u][g])this.state[u][g]={};else if(this.state[u][g])for(const v of Object.keys(this.deletedStates[u][g]))delete this.state[u][g][v];f[g]=this.state[u][g]}s[u]=s[u]||{},ue(s[u],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const u in e)e[u].setFeatureState(s,r)}}class Bg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const s=this.toIdx(e,r);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function Ng(n,e,r,s){let u=0,f=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(s[g])<1e-15){if(r[g]<n[g]||r[g]>e[g])return null}else{const v=1/s[g];let C=(n[g]-r[g])*v,T=(e[g]-r[g])*v;if(C>T){const F=C;C=T,T=F}if(C>u&&(u=C),T<f&&(f=T),u>f)return null}return u}function _f(n,e,r,s,u,f,g,v,C,T,F){const V=s-n,j=u-e,Z=f-r,Q=g-n,ce=v-e,Te=C-r,He=F[1]*Te-F[2]*ce,st=F[2]*Q-F[0]*Te,Ge=F[0]*ce-F[1]*Q,at=V*He+j*st+Z*Ge;if(Math.abs(at)<1e-15)return null;const yt=1/at,gt=T[0]-n,tn=T[1]-e,Zt=T[2]-r,gn=(gt*He+tn*st+Zt*Ge)*yt;if(gn<0||gn>1)return null;const Ln=tn*Z-Zt*j,ln=Zt*V-gt*Z,Sn=gt*j-tn*V,In=(F[0]*Ln+F[1]*ln+F[2]*Sn)*yt;return In<0||gn+In>1?null:(Q*Ln+ce*ln+Te*Sn)*yt}function zg(n,e,r){return(n-e)/(r-e)}function Wp(n,e,r,s,u,f,g,v,C){const T=1<<r,F=f-s,V=g-u,j=(n+1)/T*F+s,Z=(e+0)/T*V+u,Q=(e+1)/T*V+u;v[0]=(n+0)/T*F+s,v[1]=Z,C[0]=j,C[1]=Q}class $g{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(f){const g=Math.ceil(Math.log2(f.dim/8)),v=[];let C=Math.ceil(Math.pow(2,g));const T=1/C,F=(Z,Q,ce,Te,He)=>{const st=Te?1:0,Ge=(Z+1)*ce-st,at=Q*ce,yt=(Q+1)*ce-st;He[0]=Z*ce,He[1]=at,He[2]=Ge,He[3]=yt};let V=new Bg(C);const j=[];for(let Z=0;Z<C*C;Z++){F(Z%C,Math.floor(Z/C),T,!1,j);const Q=ml(j[0],j[1],f),ce=ml(j[2],j[1],f),Te=ml(j[2],j[3],f),He=ml(j[0],j[3],f);V.minimums.push(Math.min(Q,ce,Te,He)),V.maximums.push(Math.max(Q,ce,Te,He)),V.leaves.push(1)}for(v.push(V),C/=2;C>=1;C/=2){const Z=v[v.length-1];V=new Bg(C);for(let Q=0;Q<C*C;Q++){F(Q%C,Math.floor(Q/C),2,!0,j);const ce=Z.getElevation(j[0],j[1]),Te=Z.getElevation(j[2],j[1]),He=Z.getElevation(j[2],j[3]),st=Z.getElevation(j[0],j[3]),Ge=Z.isLeaf(j[0],j[1]),at=Z.isLeaf(j[2],j[1]),yt=Z.isLeaf(j[2],j[3]),gt=Z.isLeaf(j[0],j[3]),tn=Math.min(ce.min,Te.min,He.min,st.min),Zt=Math.max(ce.max,Te.max,He.max,st.max),gn=Ge&&at&&yt&&gt;V.maximums.push(Zt),V.minimums.push(tn),V.leaves.push(Zt-tn<=5&&gn?1:0)}v.push(V)}return v}(this.dem),s=r.length-1,u=r[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,s,0)}raycastRoot(e,r,s,u,f,g,v=1){return Ng([e,r,-100],[s,u,this.maximums[0]*v],f,g)}raycast(e,r,s,u,f,g,v=1){if(!this.nodeCount)return null;const C=this.raycastRoot(e,r,s,u,f,g,v);if(null==C)return null;const T=[],F=[],V=[],j=[],Z=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;Z.length>0;){const{idx:Q,t:ce,nodex:Te,nodey:He,depth:st}=Z.pop();if(this.leaves[Q]){Wp(Te,He,st,e,r,s,u,V,j);const at=1<<st,yt=(Te+0)/at,gt=(Te+1)/at,tn=(He+0)/at,Zt=(He+1)/at,gn=ml(yt,tn,this.dem)*v,Ln=ml(gt,tn,this.dem)*v,ln=ml(gt,Zt,this.dem)*v,Sn=ml(yt,Zt,this.dem)*v,In=_f(V[0],V[1],gn,j[0],V[1],Ln,j[0],j[1],ln,f,g),kn=_f(j[0],j[1],ln,V[0],j[1],Sn,V[0],V[1],gn,f,g),Un=Math.min(null!==In?In:Number.MAX_VALUE,null!==kn?kn:Number.MAX_VALUE);if(Un!==Number.MAX_VALUE)return Un;{const _n=Mh([],f,g,ce);if(hh(gn,Ln,Sn,ln,zg(_n[0],V[0],j[0]),zg(_n[1],V[1],j[1]))>=_n[2])return ce}continue}let Ge=0;for(let at=0;at<this._siblingOffset.length;at++){Wp((Te<<1)+this._siblingOffset[at][0],(He<<1)+this._siblingOffset[at][1],st+1,e,r,s,u,V,j),V[2]=-100,j[2]=this.maximums[this.childOffsets[Q]+at]*v;const yt=Ng(V,j,f,g);if(null!=yt){const gt=yt;T[at]=gt;let tn=!1;for(let Zt=0;Zt<Ge&&!tn;Zt++)gt>=T[F[Zt]]&&(F.splice(Zt,0,at),tn=!0);tn||(F[Ge]=at),Ge++}}for(let at=0;at<Ge;at++){const yt=F[at];Z.push({idx:this.childOffsets[Q]+yt,t:T[yt],nodex:(Te<<1)+this._siblingOffset[yt][0],nodey:(He<<1)+this._siblingOffset[yt][1],depth:st+1})}}return null}_addNode(e,r,s){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,s,u,f){if(1===e[u].isLeaf(r,s))return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const g=u-1,v=e[g];let C=0,T=0;for(let F=0;F<this._siblingOffset.length;F++){const V=2*r+this._siblingOffset[F][0],j=2*s+this._siblingOffset[F][1],Z=v.getElevation(V,j),Q=v.isLeaf(V,j),ce=this._addNode(Z.min,Z.max,Q);Q&&(C|=1<<F),T||(T=ce)}for(let F=0;F<this._siblingOffset.length;F++)C&1<<F||this._construct(e,2*r+this._siblingOffset[F][0],2*s+this._siblingOffset[F][1],g,T+F)}}function hh(n,e,r,s,u,f){return J(J(n,r,f),J(e,s,f),u)}function ml(n,e,r){const s=r.dim,u=Ht(n*s-.5,0,s-1),f=Ht(e*s-.5,0,s-1),g=Math.floor(u),v=Math.floor(f),C=Math.min(g+1,s-1),T=Math.min(v+1,s-1);return hh(r.get(g,v),r.get(C,v),r.get(g,T),r.get(C,T),u-g,f-v)}const fh={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Rv(n,e,r){return(256*n*256+256*e+r)/10-1e4}function vy(n,e,r){return 256*n+e+r/256-32768}class ph{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,s,u=!1,f=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return mn(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const g=this.dim=r.height-2,v=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=s||"mapbox",this.borderReady=u,!u){for(let C=0;C<g;C++)v[this._idx(-1,C)]=v[this._idx(0,C)],v[this._idx(g,C)]=v[this._idx(g-1,C)],v[this._idx(C,-1)]=v[this._idx(C,0)],v[this._idx(C,g)]=v[this._idx(C,g-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(g,-1)]=v[this._idx(g-1,0)],v[this._idx(-1,g)]=v[this._idx(0,g-1)],v[this._idx(g,g)]=v[this._idx(g-1,g-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new $g(this)}get(e,r,s=!1){s&&(e=Ht(e,-1,this.dim),r=Ht(r,-1,this.dim));const u=4*this._idx(e,r);return("terrarium"===this.encoding?vy:Rv)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return fh[e]}get unpackVector(){return fh[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}static pack(e,r){const s=[0,0,0,0],u=ph.getUnpackVector(r);let f=Math.floor((e+u[3])/u[2]);return s[2]=f%256,f=Math.floor(f/256),s[1]=f%256,f=Math.floor(f/256),s[0]=f,s}getPixels(){return new Pa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,f=r*this.dim+this.dim,g=s*this.dim,v=s*this.dim+this.dim;switch(r){case-1:u=f-1;break;case 1:f=u+1}switch(s){case-1:g=v-1;break;case 1:v=g+1}const C=-r*this.dim,T=-s*this.dim;for(let F=g;F<v;F++)for(let V=u;V<f;V++){const j=4*this._idx(V,F),Z=4*this._idx(V+C,F+T);this.pixels[j+0]=e.pixels[Z+0],this.pixels[j+1]=e.pixels[Z+1],this.pixels[j+2]=e.pixels[Z+2],this.pixels[j+3]=e.pixels[Z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}_(ph,"DEMData"),_($g,"DemMinMaxQuadTree",{omit:["dem"]});class Vg{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,s){const u=e.wrapped().key;void 0===this.data[u]&&(this.data[u]=[]);const f={value:r,timeout:void 0};if(void 0!==s&&(f.timeout=setTimeout(()=>{this.remove(e,f)},s)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const s=e.wrapped().key,u=void 0===r?0:this.data[s].indexOf(r),f=this.data[s][u];return this.data[s].splice(u,1),f.timeout&&clearTimeout(f.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(f.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const s in this.data)for(const u of this.data[s])e(u.value)||r.push(u);for(const s of r)this.remove(s.value.tileID,s)}}class dd{constructor(e,r,s){this.func=e,this.mask=r,this.range=s}}dd.ReadOnly=!1,dd.ReadWrite=!0,dd.disabled=new dd(519,dd.ReadOnly,[0,1]);class yf{constructor(e,r,s,u,f,g){this.test=e,this.ref=r,this.mask=s,this.fail=u,this.depthFail=f,this.pass=g}}yf.disabled=new yf({func:519,mask:0},0,0,7680,7680,7680);class zl{constructor(e,r,s){this.blendFunction=e,this.blendColor=r,this.mask=s}}zl.Replace=[1,0],zl.disabled=new zl(zl.Replace,Zr.transparent,[!1,!1,!1,!1]),zl.unblended=new zl(zl.Replace,Zr.transparent,[!0,!0,!0,!0]),zl.alphaBlended=new zl([1,771],Zr.transparent,[!0,!0,!0,!0]);class gl{constructor(e,r,s){this.enable=e,this.mode=r,this.frontFace=s}}gl.disabled=new gl(!1,1029,2305),gl.backCCW=new gl(!0,1029,2305),gl.backCW=new gl(!0,1029,2304),gl.frontCW=new gl(!0,1028,2304),gl.frontCCW=new gl(!0,1028,2305);class ru extends Es{constructor(e,r,s){super(),this.id=e,this._onlySymbols=s,r.on("data",u=>{"source"===u.dataType&&"metadata"===u.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===u.dataType&&"content"===u.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new Vg(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Dc,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if("loaded"!==r.state&&"errored"!==r.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const s=this._tiles[r];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return $e(this._tiles).map(e=>e.tileID).sort(Ug).map(e=>e.key)}getRenderableIds(e){const r=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&r.push(this._tiles[s]);return e?r.sort((s,u)=>{const f=s.tileID,g=u.tileID,v=new Me(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),C=new Me(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||C.y-v.y||C.x-v.x}).map(s=>s.tileID.key):r.map(s=>s.tileID).sort(Ug).map(s=>s.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=r),this._loadTile(s,this._tileLoaded.bind(this,s,e,r)))}_tileLoaded(e,r,s,u){if(u)if(e.state="errored",404!==u.status)this._source.fire(new qr(u,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=fi.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new ui("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const f=r[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const g=this.getTileByID(f);s(e,g),s(g,e)}}function s(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let g=f.tileID.canonical.x-u.tileID.canonical.x;const v=f.tileID.canonical.y-u.tileID.canonical.y,C=Math.pow(2,u.tileID.canonical.z),T=f.tileID.key;0===g&&0===v||Math.abs(v)>1||(Math.abs(g)>1&&(1===Math.abs(g+C)?g+=C:1===Math.abs(g-C)&&(g-=C)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,g,v),u.neighboringTiles&&u.neighboringTiles[T]&&(u.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,s,u){for(const f in this._tiles){let g=this._tiles[f];if(u[f]||!g.hasData()||g.tileID.overscaledZ<=r||g.tileID.overscaledZ>s)continue;let v=g.tileID;for(;g&&g.tileID.overscaledZ>r+1;){const T=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[T.key],g&&g.hasData()&&(v=T)}let C=v;for(;C.overscaledZ>r;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]){u[v.key]=v;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=r?s:null}for(let s=e.overscaledZ-1;s>=r;s--){const u=e.scaledTo(s),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const s=Math.ceil(e.width/r)+1,u=Math.ceil(e.height/r)+1,f=Math.floor(s*u*5),g="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,f):f,v="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(v)}handleWrapJump(e){const r=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,r){const s={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+r),s[f.tileID.key]=f}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,r,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let u;this.updateCacheSize(e,r),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new ga(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(u=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(v=>this._source.hasTile(v)))):u=[];const f=this._updateRetainedTiles(u);if(jg(this._source.type)&&0!==u.length){const v={},C={},T=Object.keys(f);for(const V of T){const j=f[V],Z=this._tiles[V];if(!Z||Z.fadeEndTime&&Z.fadeEndTime<=fi.now())continue;const Q=this.findLoadedParent(j,Math.max(j.overscaledZ-ru.maxOverzooming,this._source.minzoom));Q&&(this._addTile(Q.tileID),v[Q.tileID.key]=Q.tileID),C[V]=j}const F=u[u.length-1].overscaledZ;for(const V in this._tiles){const j=this._tiles[V];if(f[V]||!j.hasData())continue;let Z=j.tileID;for(;Z.overscaledZ>F;){Z=Z.scaledTo(Z.overscaledZ-1);const Q=this._tiles[Z.key];if(Q&&Q.hasData()&&C[Z.key]){f[V]=j.tileID;break}}}for(const V in v)f[V]||(this._coveredTiles[V]=!0,f[V]=v[V])}for(const v in f)this._tiles[v].clearFadeHold();const g=function(v,C){const T=[];for(const F in v)F in C||T.push(F);return T}(this._tiles,f);for(const v of g){const C=this._tiles[v];C.hasSymbolBuckets&&!C.holdingForFade()?C.setHoldDuration(this.map._fadeDuration):C.hasSymbolBuckets&&!C.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(0===e.length)return r;const s={},u=e.reduce((T,F)=>Math.min(T,F.overscaledZ),1/0),f=e[0].overscaledZ,g=Math.max(f-ru.maxOverzooming,this._source.minzoom),v=Math.max(f+ru.maxUnderzooming,this._source.minzoom),C={};for(const T of e){const F=this._addTile(T);r[T.key]=T,F.hasData()||u<this._source.maxzoom&&(C[T.key]=T)}this._retainLoadedChildren(C,u,v,r);for(const T of e){let F=this._tiles[T.key];if(F.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const j=T.children(this._source.maxzoom)[0],Z=this.getTile(j);if(Z&&Z.hasData()){r[j.key]=j;continue}}else{const j=T.children(this._source.maxzoom);if(r[j[0].key]&&r[j[1].key]&&r[j[2].key]&&r[j[3].key])continue}let V=F.wasRequested();for(let j=T.overscaledZ-1;j>=g;--j){const Z=T.scaledTo(j);if(s[Z.key]||(s[Z.key]=!0,F=this.getTile(Z),!F&&V&&(F=this._addTile(Z)),F&&(r[Z.key]=Z,V=F.wasRequested(),F.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}r.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(f),s)break;u=f}for(const f of r)this._loadedParentTiles[f]=s}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const s=!!r;if(!s){const u=this.map?this.map.painter:null;r=new dh(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,s||this._source.fire(new ui("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=r.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&"reloading"!==r.state?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,s){const u=[],f=this.transform;if(!f)return u;const g="globe"===f.projection.name,v=rc(f.center.lng);for(const C in this._tiles){const T=this._tiles[C];if(s&&T.clearQueryDebugViz(),T.holdingForFade())continue;let F;if(g){const V=T.tileID.canonical;if(0===V.z){const j=[Math.abs(Ht(v,...Cc(V,-1))-v),Math.abs(Ht(v,...Cc(V,1))-v)];F=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(Ht(v,...Cc(V,-1))-v),Math.abs(Ht(v,...Cc(V,0))-v),Math.abs(Ht(v,...Cc(V,1))-v)];F=[j.indexOf(Math.min(...j))-1]}}else F=[0];for(const V of F){const j=e.containsTile(T,f,r,V);j&&u.push(j)}}return u}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of r)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(jg(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=fi.now())return!0}return!1}setFeatureState(e,r,s){this._state.updateState(e=e||"_geojsonTileLayer",r,s)}removeFeatureState(e,r,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,s)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,s){const u=this._tiles[e];u&&u.setDependencies(r,s)}reloadTilesForDependencies(e,r){for(const s in this._tiles)this._tiles[s].hasDependency(e,r)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){const v=()=>{this._sourceLoaded&&(this._source.off("data",v),this._preloadTiles(e,r))};return void this._source.on("data",v)}const s=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,g=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const v of u){const C=v.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of C)s.set(T.key,T);this.usedForTerrain&&v.updateElevation(!1)}bt(Array.from(s.values()),(v,C)=>{const T=new dh(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,F=>{"raster-dem"===this._source.type&&T.dem&&this._backfillDEM(T),C(F,T)})},r)}}function Ug(n,e){const r=Math.abs(2*n.wrap)-+(n.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||s-r||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function jg(n){return"raster"===n||"image"===n||"video"===n||"custom"===n}function Cc(n,e){const r=1<<n.z;return[n.x/r+e,(n.x+1)/r+e]}ru.maxOverzooming=10,ru.maxUnderzooming=3;class vf{constructor(e,r,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=s}static create(e,r,s){const u=s||e.findDEMTileFor(r);if(!u||!u.dem)return;const f=u.dem,g=u.tileID,v=1<<r.canonical.z-g.canonical.z;return new vf(u,u.tileSize/Pr/v,[(r.canonical.x/v-g.canonical.x)*f.dim,(r.canonical.y/v-g.canonical.y)*f.dim])}tileCoordToPixel(e,r){const s=r*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(s);return new Me(u,f)}getElevationAt(e,r,s,u){const f=e*this._scale+this._offset[0],g=r*this._scale+this._offset[1],v=Math.floor(f),C=Math.floor(g),T=this._dem;return u=!!u,s?J(J(T.get(v,C,u),T.get(v,C+1,u),g-C),J(T.get(v+1,C,u),T.get(v+1,C+1,u),g-C),f-v):T.get(v,C,u)}getElevationAtPixel(e,r,s){return this._dem.get(e,r,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Ga(1,e)*this._dem.stride}}class Hg{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new B(Pr,16,0),this.featureIndexArray=new Vu,this.promoteId=r}insert(e,r,s,u,f,g=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,f,g);const C=this.grid;for(let T=0;T<r.length;T++){const F=r[T],V=[1/0,1/0,-1/0,-1/0];for(let j=0;j<F.length;j++){const Z=F[j];V[0]=Math.min(V[0],Z.x),V[1]=Math.min(V[1],Z.y),V[2]=Math.max(V[2],Z.x),V[3]=Math.max(V[3],Z.y)}V[0]<Pr&&V[1]<Pr&&V[2]>=0&&V[3]>=0&&C.insert(v,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Wd(new Kc(this.rawTileData)).layers,this.sourceLayerCoder=new kg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,s,u){this.loadVTLayers();const f=e.params||{},g=Da(f.filter),v=e.tileResult,C=e.transform,T=v.bufferedTilespaceBounds,F=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(Q,ce,Te,He)=>Rm(v.bufferedTilespaceGeometry,Q,ce,Te,He));F.sort(xy);let V=null;C.elevation&&F.length>0&&(V=vf.create(C.elevation,this.tileID));const j={};let Z;for(let Q=0;Q<F.length;Q++){const ce=F[Q];if(ce===Z)continue;Z=ce;const Te=this.featureIndexArray.get(ce);let He=null;this.loadMatchingFeature(j,Te,g,f.layers,f.availableImages,r,s,u,(st,Ge,at,yt=0)=>(He||(He=ic(st,this.tileID.canonical,e.tileTransform)),Ge.queryIntersectsFeature(v,st,at,He,this.z,e.transform,e.pixelPosMatrix,V,yt)))}return j}loadMatchingFeature(e,r,s,u,f,g,v,C,T){const{featureIndex:F,bucketIndex:V,sourceLayerIndex:j,layoutVertexArrayOffset:Z}=r,Q=this.bucketLayerIDs[V];if(u&&!function(st,Ge){for(let at=0;at<st.length;at++)if(Ge.indexOf(st[at])>=0)return!0;return!1}(u,Q))return;const ce=this.sourceLayerCoder.decode(j),Te=this.vtLayers[ce].feature(F);if(s.needGeometry){const st=Gc(Te,!0);if(!s.filter(new $(this.tileID.overscaledZ),st,this.tileID.canonical))return}else if(!s.filter(new $(this.tileID.overscaledZ),Te))return;const He=this.getId(Te,ce);for(let st=0;st<Q.length;st++){const Ge=Q[st];if(u&&u.indexOf(Ge)<0)continue;const at=g[Ge];if(!at)continue;let yt={};void 0!==He&&C&&(yt=C.getState(at.sourceLayer||"_geojsonTileLayer",He));const gt=ue({},v[Ge]);gt.paint=Gg(gt.paint,at.paint,Te,yt,f),gt.layout=Gg(gt.layout,at.layout,Te,yt,f);const tn=!T||T(Te,at,yt,Z);if(!tn)continue;const Zt=new Fg(Te,this.z,this.x,this.y,He);Zt.layer=gt;let gn=e[Ge];void 0===gn&&(gn=e[Ge]=[]),gn.push({featureIndex:F,feature:Zt,intersectionZ:tn})}}lookupSymbolFeatures(e,r,s,u,f,g,v,C){const T={};this.loadVTLayers();const F=Da(f);for(const V of e)this.loadMatchingFeature(T,{bucketIndex:s,sourceLayerIndex:u,featureIndex:V,layoutVertexArrayOffset:0},F,g,v,C,r);return T}loadFeature(e){const{featureIndex:r,sourceLayerIndex:s}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(s),f=this.vtFeatures[u];if(f[r])return f[r];const g=this.vtLayers[u].feature(r);return f[r]=g,g}hasLayer(e){for(const r of this.bucketLayerIDs)for(const s of r)if(e===s)return!0;return!1}getId(e,r){let s=e.id;if(this.promoteId){const u="string"==typeof this.promoteId?this.promoteId:this.promoteId[r];null!=u&&(s=e.properties[u]),"boolean"==typeof s&&(s=Number(s))}return s}}function Gg(n,e,r,s,u){return sn(n,(f,g)=>{const v=e instanceof Pe?e.get(g):null;return v&&v.evaluate?v.evaluate(r,s,u):v})}function xy(n,e){return e-n}_(Hg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Wg{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new oc({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const s=this.getKey(e,r);return this.positions[s]}trim(){const e=this.width,r=this.height=Lt(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,s){const u=[];let f=e.length%2==1?-e[e.length-1]*s:0,g=e[0]*s,v=!0;u.push({left:f,right:g,isDash:v,zeroLength:0===e[0]});let C=e[0];for(let T=1;T<e.length;T++){v=!v;const F=e[T];f=C*s,C+=F,g=C*s,u.push({left:f,right:g,isDash:v,zeroLength:0===F})}return u}addRoundDash(e,r,s){const u=r/2;for(let f=-s;f<=s;f++){const g=this.width*(this.nextRow+s+f);let v=0,C=e[v];for(let T=0;T<this.width;T++){T/C.right>1&&(C=e[++v]);const F=Math.abs(T-C.left),V=Math.abs(T-C.right),j=Math.min(F,V);let Z;const Q=f/s*(u+1);if(C.isDash){const ce=u-Math.abs(Q);Z=Math.sqrt(j*j+ce*ce)}else Z=u-Math.sqrt(j*j+Q*Q);this.image.data[g+T]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(e,r){for(let C=e.length-1;C>=0;--C){const T=e[C],F=e[C+1];T.zeroLength?e.splice(C,1):F&&F.isDash===T.isDash&&(F.left=T.left,e.splice(C,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const f=this.width*this.nextRow;let g=0,v=e[g];for(let C=0;C<this.width;C++){C/v.right>1&&(v=e[++g]);const T=Math.abs(C-v.left),F=Math.abs(C-v.right),V=Math.min(T,F);this.image.data[f+C]=Math.max(0,Math.min(255,(v.isDash?V:-V)+r+128))}}addDash(e,r){const s=this.getKey(e,r);if(this.positions[s])return this.positions[s];const u="round"===r,f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return mn("LineAtlas out of space"),null;0===e.length&&e.push(1);let v=0;for(let F=0;F<e.length;F++)e[F]<0&&(mn("Negative value is found in line dasharray, replacing values with 0"),e[F]=0),v+=e[F];if(0!==v){const F=this.width/v,V=this.getDashRanges(e,this.width,F);u?this.addRoundDash(V,F,f):this.addRegularDash(V,"square"===r?.5*F:0)}const C=this.nextRow+f;this.nextRow+=g;const T={tl:[C,f],br:[v,0]};return this.positions[s]=T,T}}_(Wg,"LineAtlas");const qg=1*el;class Zg{constructor(e){const r={},s=[];for(const v in e){const C=e[v],T=r[v]={};for(const F in C.glyphs){const V=C.glyphs[+F];if(!V||0===V.bitmap.width||0===V.bitmap.height)continue;const j=V.metrics.localGlyph?qg:1,Z={x:0,y:0,w:V.bitmap.width+2*j,h:V.bitmap.height+2*j};s.push(Z),T[F]=Z}}const{w:u,h:f}=Tp(s),g=new oc({width:u||1,height:f||1});for(const v in e){const C=e[v];for(const T in C.glyphs){const F=C.glyphs[+T];if(!F||0===F.bitmap.width||0===F.bitmap.height)continue;const V=r[v][T],j=F.metrics.localGlyph?qg:1;oc.copy(F.bitmap,g,{x:0,y:0},{x:V.x+j,y:V.y+j},F.bitmap)}}this.image=g,this.positions=r}}_(Zg,"GlyphAtlas");class by{constructor(e){this.tileID=new ga(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=eu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,s,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new ji;const g=new kg(Object.keys(e.layers).sort()),v=new Hg(this.tileID,this.promoteId);v.bucketLayerIDs=[];const C={},T=new Wg(256,256),F={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:s},V=r.familiesBySource[this.source];for(const yt in V){const gt=e.layers[yt];if(!gt)continue;let tn=!1,Zt=!1;for(const ln of V[yt])"symbol"===ln[0].type?tn=!0:Zt=!0;if(!0===this.isSymbolTile&&!tn||!1===this.isSymbolTile&&!Zt)continue;1===gt.version&&mn(`Vector tile source "${this.source}" layer "${yt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const gn=g.encode(yt),Ln=[];for(let ln=0;ln<gt.length;ln++){const Sn=gt.feature(ln),In=v.getId(Sn,yt);Ln.push({feature:Sn,id:In,index:ln,sourceLayerIndex:gn})}for(const ln of V[yt]){const Sn=ln[0];void 0!==this.isSymbolTile&&"symbol"===Sn.type!==this.isSymbolTile||Sn.minzoom&&this.zoom<Math.floor(Sn.minzoom)||Sn.maxzoom&&this.zoom>=Sn.maxzoom||"none"!==Sn.visibility&&(xf(ln,this.zoom,s),(C[Sn.id]=Sn.createBucket({index:v.bucketLayerIDs.length,layers:ln,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:gn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(Ln,F,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(ln.map(In=>In.id)))}}let j,Z,Q,ce;T.trim();const Te={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},He=()=>{if(j)return f(j);if(Z&&Q&&ce){const yt=new Zg(Z),gt=new Ip(Q,ce);for(const tn in C){const Zt=C[tn];Zt instanceof nu?(xf(Zt.layers,this.zoom,s),Cg(Zt,Z,yt.positions,Q,gt.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):Zt.hasPattern&&(Zt instanceof pp||Zt instanceof Qu||Zt instanceof qd)&&(xf(Zt.layers,this.zoom,s),Zt.addFeatures(F,this.tileID.canonical,gt.patternPositions,s,this.tileTransform))}this.status="done",f(null,{buckets:$e(C).filter(tn=>!tn.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yt.image,lineAtlas:T,imageAtlas:gt,glyphMap:this.returnDependencies?Z:null,iconMap:this.returnDependencies?Q:null,glyphPositions:this.returnDependencies?yt.positions:null})}},st=sn(F.glyphDependencies,yt=>Object.keys(yt).map(Number));Object.keys(st).length?u.send("getGlyphs",{uid:this.uid,stacks:st},(yt,gt)=>{j||(j=yt,Z=gt,He())},void 0,!1,Te):Z={};const Ge=Object.keys(F.iconDependencies);Ge.length?u.send("getImages",{icons:Ge,source:this.source,tileID:this.tileID,type:"icons"},(yt,gt)=>{j||(j=yt,Q=gt,He())},void 0,!1,Te):Q={};const at=Object.keys(F.patternDependencies);at.length?u.send("getImages",{icons:at,source:this.source,tileID:this.tileID,type:"patterns"},(yt,gt)=>{j||(j=yt,ce=gt,He())},void 0,!1,Te):ce={},He()}}function xf(n,e,r){const s=new $(e);for(const u of n)u.recalculate(s,r)}class bf{constructor(e){this.entries={},this.scheduler=e}request(e,r,s,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[g,v]=f.result;return this.scheduler?this.scheduler.add(()=>{u(g,v)},r):u(g,v),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=s((g,v)=>{f.result=[g,v];for(const C of f.callbacks)this.scheduler?this.scheduler.add(()=>{C(g,v)},r):C(g,v);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(g=>g!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function Yg(n,e,r){const s=JSON.stringify(n.request);return n.data&&(this.deduped.entries[s]={result:[null,n.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},u=>{const f=Or(n.request,(g,v,C,T)=>{g?u(g):v&&u(null,{vectorTile:r?void 0:new Wd(new Kc(v)),rawData:v,cacheControl:C,expires:T})});return()=>{f.cancel(),u()}},e)}const mh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Yp{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(e,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");const u=s>>4;if(1!==u)throw new Error(`Got v${u} data when expected v1.`);const f=mh[15&s];if(!f)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new Yp(v,g,f,e)}constructor(e,r=64,s=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=mh.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-v%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+C,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+C),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+C,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=r,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Xp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:v}=this,C=[0,f.length-1,0],T=[];for(;C.length;){const F=C.pop()||0,V=C.pop()||0,j=C.pop()||0;if(V-j<=v){for(let Te=j;Te<=V;Te++){const He=g[2*Te],st=g[2*Te+1];He>=e&&He<=s&&st>=r&&st<=u&&T.push(f[Te])}continue}const Z=j+V>>1,Q=g[2*Z],ce=g[2*Z+1];Q>=e&&Q<=s&&ce>=r&&ce<=u&&T.push(f[Z]),(0===F?e<=Q:r<=ce)&&(C.push(j),C.push(Z-1),C.push(1-F)),(0===F?s>=Q:u>=ce)&&(C.push(Z+1),C.push(V),C.push(1-F))}return T}within(e,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:f,nodeSize:g}=this,v=[0,u.length-1,0],C=[],T=s*s;for(;v.length;){const F=v.pop()||0,V=v.pop()||0,j=v.pop()||0;if(V-j<=g){for(let Te=j;Te<=V;Te++)Kg(f[2*Te],f[2*Te+1],e,r)<=T&&C.push(u[Te]);continue}const Z=j+V>>1,Q=f[2*Z],ce=f[2*Z+1];Kg(Q,ce,e,r)<=T&&C.push(u[Z]),(0===F?e-s<=Q:r-s<=ce)&&(v.push(j),v.push(Z-1),v.push(1-F)),(0===F?e+s>=Q:r+s>=ce)&&(v.push(Z+1),v.push(V),v.push(1-F))}return C}}function Xp(n,e,r,s,u,f){if(u-s<=r)return;const g=s+u>>1;Xg(n,e,g,s,u,f),Xp(n,e,r,s,g-1,1-f),Xp(n,e,r,g+1,u,1-f)}function Xg(n,e,r,s,u,f){for(;u>s;){if(u-s>600){const T=u-s+1,F=r-s+1,V=Math.log(T),j=.5*Math.exp(2*V/3),Z=.5*Math.sqrt(V*j*(T-j)/T)*(F-T/2<0?-1:1);Xg(n,e,r,Math.max(s,Math.floor(r-F*j/T+Z)),Math.min(u,Math.floor(r+(T-F)*j/T+Z)),f)}const g=e[2*r+f];let v=s,C=u;for(gh(n,e,s,r),e[2*u+f]>g&&gh(n,e,s,u);v<C;){for(gh(n,e,v,C),v++,C--;e[2*v+f]<g;)v++;for(;e[2*C+f]>g;)C--}e[2*s+f]===g?gh(n,e,s,C):(C++,gh(n,e,C,u)),C<=r&&(s=C+1),r<=C&&(u=C-1)}}function gh(n,e,r,s){Kp(n,r,s),Kp(e,2*r,2*s),Kp(e,2*r+1,2*s+1)}function Kp(n,e,r){const s=n[e];n[e]=n[r],n[r]=s}function Kg(n,e,r,s){const u=n-r,f=e-s;return u*u+f*f}l.ARRAY_TYPE=ja,l.AUTH_ERR_MSG=ut,l.Aabb=pa,l.Actor=class{constructor(n,e,r){this.target=n,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},Yt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=nr()?n:ve,this.scheduler=new Up}send(n,e,r,s,u=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=f,this.callbacks[g]=r);const v=Lr(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:n,hasCallback:!!r,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:q(e,v)},v),{cancel:()=>{r&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(n){const e=n.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[r];delete this.cancelCallbacks[r],s&&s.cancel()}else if(e.mustQueue||nr()){const s=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),s&&s.metadata||{type:"message"})}else this.processTask(r,e)}processTask(n,e){if("<response>"===e.type){const r=this.callbacks[n];delete this.callbacks[n],r&&(e.error?r(oe(e.error)):r(null,oe(e.data)))}else{const r=Lr(this.globalScope)?void 0:[],s=e.hasCallback?(f,g)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:f?q(f):null,data:q(g,r)},r)}:f=>{},u=oe(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,s);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=wu,l.Color=Zr,l.ColorMode=zl,l.CullFaceMode=gl,l.DEMData=ph,l.DataConstantProperty=se,l.DedupedRequest=bf,l.DepthMode=dd,l.EXTENT=Pr,l.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const r=e.getSource().maxzoom,s=1<<r,u=Math.floor(n.x),f=Math.floor((n.x-u)*s),g=Math.floor(n.y*s),v=this.findDEMTileFor(new ga(r,u,r,f,g));return!(!v||!v.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,r=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const s=this._source();if(!s||n.y<0||n.y>1)return e;const u=s.getSource().maxzoom,f=1<<u,g=Math.floor(n.x),v=n.x-g,C=new ga(u,g,u,Math.floor(v*f),Math.floor(n.y*f)),T=this.findDEMTileFor(C);if(!T||!T.dem)return e;const F=T.dem,V=1<<T.tileID.canonical.z,j=(v*V-T.tileID.canonical.x)*F.dim,Z=(n.y*V-T.tileID.canonical.y)*F.dim,Q=Math.floor(j),ce=Math.floor(Z);return(r?this.exaggeration():1)*J(J(F.get(Q,ce),F.get(Q,ce+1),Z-ce),J(F.get(Q+1,ce),F.get(Q+1,ce+1),Z-ce),j-Q)}getAtTileOffset(n,e,r){const s=1<<n.canonical.z;return this.getAtPointOrZero(new vu(n.wrap+(n.canonical.x+e/Pr)/s,(n.canonical.y+r/Pr)/s))}getAtTileOffsetFunc(n,e,r,s){return u=>{const f=this.getAtTileOffset(n,u.x,u.y),g=s.upVector(n.canonical,u.x,u.y);return hl(g,g,f*s.upVectorScale(n.canonical,e,r).metersToTile),g}}getForTilePoints(n,e,r,s){if(this.isUsingMockSource())return!1;const u=vf.create(this,n,s);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],r)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const r=e.dem.tree,s=e.tileID,u=1<<n.canonical.z-s.canonical.z;let f=n.canonical.x/u-s.canonical.x,g=n.canonical.y/u-s.canonical.y,v=0;for(let C=0;C<n.canonical.z-s.canonical.z&&!r.leaves[v];C++){f*=2,g*=2;const T=2*Math.floor(g)+Math.floor(f);v=r.childOffsets[v]+T,f%=1,g%=1}return{min:this.exaggeration()*r.minimums[v],max:this.exaggeration()*r.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=qr,l.EvaluationParameters=$,l.Event=ui,l.Evented=Es,l.FillExtrusionBucket=qd,l.Frustum=Vf,l.FrustumCorners=Sd,l.GLOBE_RADIUS=nc,l.GLOBE_SCALE_MATCH_LATITUDE=45,l.GLOBE_ZOOM_THRESHOLD_MAX=jf,l.GLOBE_ZOOM_THRESHOLD_MIN=Uf,l.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,e){const r=new On,s=new br,u=[],f=n+1+2,g=e[0]+1,v=e[0]+1+(1+e.length),C=(T,F,V)=>{let j=T===f-1?T-2:0===T?T:T-1;return j+=V?24575:0,[j,F]};for(let T=0;T<f;++T)r.emplaceBack(...C(T,0,!0));for(let T=0;T<g;++T)for(let F=0;F<f;++F)r.emplaceBack(...C(F,T,(0===F||F===f-1)&&!0));for(let T=0;T<e.length;++T){const F=e[T];for(let V=0;V<f;++V)r.emplaceBack(...C(V,F,!0))}for(let T=0;T<e.length;++T){const F=s.length,V=e[T]+1+2,j=new br;for(let ce=0;ce<V-1;ce++){const Te=ce===V-2,He=Te?f*(v-e.length+T-ce):f;for(let st=0;st<f-1;st++){const Ge=ce*f+st;0===ce||Te||0===st||st===f-2?(j.emplaceBack(Ge+1,Ge,Ge+He),j.emplaceBack(Ge+He,Ge+He+1,Ge+1)):(s.emplaceBack(Ge+1,Ge,Ge+He),s.emplaceBack(Ge+He,Ge+He+1,Ge+1))}}const Z=fs.simpleSegment(0,F,r.length,s.length-F);for(let ce=0;ce<j.uint16.length;ce+=3)s.emplaceBack(j.uint16[ce],j.uint16[ce+1],j.uint16[ce+2]);const Q=fs.simpleSegment(0,F,r.length,s.length-F);u.push({withoutSkirts:Z,withSkirts:Q})}return{vertices:r,indices:s,segments:u}}_createGrid(n){const e=this._fillGridMeshWithLods(64,mu);this._gridSegments=e.segments,this._gridBuffer=n.createVertexBuffer(e.vertices,Td.members),this._gridIndexBuffer=n.createIndexBuffer(e.indices,!0)}_createPoles(n){const e=new br;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const r=new lo,s=new lo;this._poleSegments=[];for(let u=0,f=0;u<Uf;u++){const g=360/(1<<u);r.emplaceBack(0,-nc,0,.5,0),s.emplaceBack(0,-nc,0,.5,1);for(let v=0;v<=64;v++){const C=v/64,T=J(0,g,C),[F,V,j]=Vc(Xf,Nh,T,nc);r.emplaceBack(F,V,j,C,0),s.emplaceBack(F,V,j,C,1)}this._poleSegments.push(fs.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(r,bm,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(s,bm,!1)}getGridBuffers(n,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const r=new zs,s=64,u=s+1+2,f=1;this._wireframeSegments=[];for(let g=0,v=0;g<mu.length;g++){const C=mu[g];for(let F=f;F<C+f;F++)for(let V=f;V<s+f;V++){const j=F*u+V;r.emplaceBack(j,j+1),r.emplaceBack(j,j+u),r.emplaceBack(j,j+u+1)}const T=C*s*3;this._wireframeSegments.push(fs.simpleSegment(0,v,(C+1)*u,T)),v+=T}this._wireframeIndexBuffer=n.createIndexBuffer(r)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},l.GlyphManager=Iu,l.ImagePosition=Sp,l.KDBush=Yp,l.LivePerformanceUtils=Bo,l.LngLat=po,l.LngLatBounds=Il,l.LocalGlyphMode=Su,l.MAX_MERCATOR_LATITUDE=ia,l.MercatorCoordinate=vu,l.ONE_EM=Rs,l.OverscaledTileID=ga,l.PerformanceMarkers=ro,l.Point=Me,l.Properties=Xe,l.RGBAImage=Pa,l.Ray=Lh,l.RequestManager=class{constructor(n,e,r){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",pt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!wt(n))return n;const r=Be(n);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!wt(n))return n;const r=Be(n);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(n,e,r,s){if(!wt(n))return n;const u=Be(n);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),r&&u.params.push(`language=${r}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(n,e,r,s){const u=Be(n);return wt(n)?(u.path=`/styles/v1${u.path}/sprite${e}${r}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${r}`,le(u))}normalizeTileURL(n,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!wt(n))return n;const s=Be(n);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&"raster"!==s.authority&&512===r?"@2x":""}${et.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${it.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${it.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(f){for(const g of f){const v=g.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(s.params)||it.ACCESS_TOKEN;return it.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(n,e){const r=Be(n);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return n;let s="mapbox://";r.path.match(/^\/raster\/v1\//)?s+=`raster/${r.path.replace(`/${it.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${r.path.replace(`/${it.TILE_URL_VERSION}/`,"")}`;let u=r.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(n,e){const r=!!e&&wt(e),s=[];for(const u of n.tiles||[])Ot(u)?s.push(this.canonicalizeTileURL(u,r)):s.push(u);return s}_makeAPIURL(n,e){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Be(it.API_URL);if(n.protocol=s.protocol,n.authority=s.authority,"http"===n.protocol){const u=n.params.indexOf("secure");u>=0&&n.params.splice(u,1)}if("/"!==s.path&&(n.path=`${s.path}${n.path}`),!it.REQUIRE_ACCESS_TOKEN)return le(n);if(e=e||it.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return n.params=n.params.filter(u=>-1===u.indexOf("access_token")),n.params.push(`access_token=${e||""}`),le(n)}},l.ResourceType=Ai,l.SegmentVector=fs,l.SourceCache=ru,l.StencilMode=yf,l.StructArrayLayout1ui2=Sa,l.StructArrayLayout2f1f2i16=Ur,l.StructArrayLayout2i4=On,l.StructArrayLayout2ui4=zs,l.StructArrayLayout3f12=pi,l.StructArrayLayout3ui6=br,l.StructArrayLayout4i8=Tn,l.StructArrayLayout5f20=lo,l.Texture=ch,l.Tile=dh,l.Transitionable=ae,l.Uniform1f=Fc,l.Uniform1i=class extends dl{constructor(n){super(n),this.current=0}set(n,e,r){this.fetchUniformLocation(n,e)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},l.Uniform2f=class extends dl{constructor(n){super(n),this.current=[0,0]}set(n,e,r){this.fetchUniformLocation(n,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}},l.Uniform3f=class extends dl{constructor(n){super(n),this.current=[0,0,0]}set(n,e,r){this.fetchUniformLocation(n,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}},l.Uniform4f=hm,l.UniformColor=w_,l.UniformMatrix2f=class extends dl{constructor(n){super(n),this.current=Ja}set(n,e,r){if(this.fetchUniformLocation(n,e))for(let s=0;s<4;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}},l.UniformMatrix3f=class extends dl{constructor(n){super(n),this.current=bv}set(n,e,r){if(this.fetchUniformLocation(n,e))for(let s=0;s<9;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},l.UniformMatrix4f=class extends dl{constructor(n){super(n),this.current=E_}set(n,e,r){if(this.fetchUniformLocation(n,e)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let s=1;s<16;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}},l.UnwrappedTileID=Jh,l.ValidationError=or,l.VectorTileFeature=rd,l.VectorTileWorkerSource=class extends Es{constructor(n,e,r,s,u){super(),this.actor=n,this.layerIndex=e,this.availableImages=r,this.loadVectorData=u||Yg,this.loading={},this.loaded={},this.deduped=new bf(n.scheduler),this.isSpriteLoaded=s,this.scheduler=n.scheduler}loadTile(n,e){const r=n.uid,s=n&&n.request,u=s&&s.collectResourceTiming,f=this.loading[r]=new by(n);f.abort=this.loadVectorData(n,(g,v)=>{const C=!this.loading[r];if(delete this.loading[r],C||g||!v)return f.status="done",C||(this.loaded[r]=f),e(g);const T=v.rawData,F={};v.expires&&(F.expires=v.expires),v.cacheControl&&(F.cacheControl=v.cacheControl),f.vectorTile=v.vectorTile||new Wd(new Kc(T));const V=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,Z)=>{if(j||!Z)return e(j);const Q={};if(u){const ce=Dn(s);ce.length>0&&(Q.resourceTiming=JSON.parse(JSON.stringify(ce)))}e(null,ue({rawTileData:T.slice(0)},Z,F,Q))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[r]=f})}reloadTile(n,e){const r=this.loaded,s=n.uid,u=this;if(r&&r[s]){const f=r[s];f.showCollisionBoxes=n.showCollisionBoxes,f.enableTerrain=!!n.enableTerrain,f.projection=n.projection,f.tileTransform=eu(n.tileID.canonical,n.projection);const g=(v,C)=>{const T=f.reloadCallback;T&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,T)),e(v,C)};"parsing"===f.status?f.reloadCallback=g:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(n,e){const r=n.uid,s=this.loading[r];s&&(s.abort&&s.abort(),delete this.loading[r]),e()}removeTile(n,e){const r=this.loaded,s=n.uid;r&&r[s]&&delete r[s],e()}},l.WritingMode=Wa,l.ZoomDependentExpression=Cs,l.add=tc,l.addDynamicAttributes=pf,l.adjoint=function(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=e[4],v=e[5],C=e[6],T=e[7],F=e[8];return n[0]=g*F-v*T,n[1]=u*T-s*F,n[2]=s*v-u*g,n[3]=v*C-f*F,n[4]=r*F-u*C,n[5]=u*f-r*v,n[6]=f*T-g*C,n[7]=s*C-r*T,n[8]=r*g-s*f,n},l.asyncAll=bt,l.bezier=dn,l.bindAll=Yt,l.boundsAttributes=Hp,l.bufferConvexPolygon=function(n,e){const r=[];for(let s=0;s<n.length;s++){const u=en(s-1,-1,n.length-1),f=en(s+1,-1,n.length-1),g=n[s],v=n[f],C=n[u].sub(g).unit(),T=v.sub(g).unit(),F=T.angleWithSep(C.x,C.y),V=C.add(T).unit().mult(-1*e/Math.sin(F/2));r.push(g.add(V))}return r},l.cacheEntryPossiblyAdded=function(n){Sr++,Sr>fr&&(n.getActor().send("enforceCacheSizeLimit",hi),Sr=0)},l.calculateGlobeLabelMatrix=function(n,e){const{x:r,y:s}=n.point,u=Zf(r,s,n.worldSize/n._pixelsPerMercatorPixel,0,0);return Uu(u,u,Bh(Pl(e)))},l.calculateGlobeMatrix=function(n){const{x:e,y:r}=n.point,{lng:s,lat:u}=n._center;return Zf(e,r,n.worldSize,s,u)},l.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,r=e/Ga(1,n.center.lat),s=Ma(new Float64Array(16));return ju(s,s,[n.point.x,n.point.y,0]),hu(s,s,[r,r,e]),Float32Array.from(s)},l.circumferenceAtLatitude=Kf,l.clamp=Ht,l.clearTileCache=function(n){if(!gr())return;const e=ve.caches.delete(Fi);n&&e.catch(n).then(()=>n())},l.clipLine=Tu,l.clone=function(n){var e=new ja(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},l.clone$1=Xt,l.collisionCircleLayout=_p,l.config=it,l.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},l.create=function(){var n=new ja(16);return ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},l.create$1=fm,l.createExpression=Yi,l.createLayout=Mt,l.createStyleLayer=function(n){return"custom"===n.type?new gy(n):new yy[n.type](n)},l.cross=xm,l.degToRad=Je,l.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},l.div=function(n,e,r){return n[0]=e[0]/r[0],n[1]=e[1]/r[1],n[2]=e[2]/r[2],n},l.dot=Ml,l.earthRadius=Ad,l.ease=on,l.easeCubicInOut=Ut,l.ecefToLatLng=function([n,e,r]){const s=Math.hypot(n,e,r),u=Math.atan2(n,r),f=.5*Math.PI-Math.acos(-e/s);return new po(mt(u),mt(f))},l.emitValidationErrors=Rc,l.endsWith=hn,l.enforceCacheSizeLimit=function(n){Ci(),Er&&Er.then(e=>{e.keys().then(r=>{for(let s=0;s<r.length-n;s++)e.delete(r[s])})})},l.evaluateSizeForFeature=Xc,l.evaluateSizeForZoom=Cu,l.evaluateVariableOffset=Rp,l.evented=y,l.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},l.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},l.exported=fi,l.exported$1=et,l.extend=ue,l.extend$1=io,l.fillExtrusionHeightLift=Zd,l.filterObject=jt,l.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},l.fromQuat=function(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=r+r,v=s+s,C=u+u,T=r*g,F=s*g,V=s*v,j=u*g,Z=u*v,Q=u*C,ce=f*g,Te=f*v,He=f*C;return n[0]=1-V-Q,n[1]=F+He,n[2]=j-Te,n[3]=0,n[4]=F-He,n[5]=1-T-Q,n[6]=Z+ce,n[7]=0,n[8]=j+Te,n[9]=Z-ce,n[10]=1-T-V,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},l.fromRotation=function(n,e){var r=Math.sin(e),s=Math.cos(e);return n[0]=s,n[1]=r,n[2]=0,n[3]=-r,n[4]=s,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},l.fromScaling=mm,l.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return Kt[e]},l.getAABBPointSquareDist=function(n,e,r){let s=0;for(let u=0;u<2;++u){const f=r?r[u]:0;n[u]>f&&(s+=(n[u]-f)*(n[u]-f)),e[u]<f&&(s+=(f-e[u])*(f-e[u]))}return s},l.getAnchorAlignment=gg,l.getAnchorJustification=Tg,l.getBounds=function(n){let e=1/0,r=1/0,s=-1/0,u=-1/0;for(const f of n)e=Math.min(e,f.x),r=Math.min(r,f.y),s=Math.max(s,f.x),u=Math.max(u,f.y);return{min:new Me(e,r),max:new Me(s,u)}},l.getColumn=Jr,l.getDefaultExportFromCjs=vt,l.getGridMatrix=function(n,e,r,s){const u=e.getNorth(),f=e.getSouth(),g=e.getWest(),v=e.getEast(),C=1<<n.z,T=v-g,F=u-f,V=T/64,j=-F/mu[r],Z=[0,V,0,j,0,0,u,g,0];if(n.z>0){const Q=180/s;du(Z,Z,[Q/T+1,0,0,0,Q/F+1,0,-.5*Q/V,.5*Q/j,1])}return Z[2]=C,Z[5]=n.x,Z[8]=n.y,Z},l.getImage=qe,l.getJSON=function(n,e){return Do(ue(n,{type:"json"}),e)},l.getLatitudinalLod=function(n){const e=ia-5;n=Ht(n,-e,e)/e*90;const r=Math.pow(Math.abs(Math.sin(Je(n))),3);return Math.round(r*(mu.length-1))},l.getMapSessionAPI=Wr,l.getPerformanceMeasurement=Dn,l.getProjection=Bp,l.getRTLTextPluginStatus=w,l.getReferrer=Yr,l.getTilePoint=function(n,{x:e,y:r},s=0){return new Me(((e-s)*n.scale-n.x)*Pr,(r*n.scale-n.y)*Pr)},l.getTileVec3=function(n,e,r=0){return Ed(((e.x-r)*n.scale-n.x)*Pr,(e.y*n.scale-n.y)*Pr,Im(e.z,e.y))},l.getVideo=function(n,e){const r=ve.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let s=0;s<n.length;s++){const u=ve.document.createElement("source");Co(n[s])||(r.crossOrigin="Anonymous"),u.src=n[s],r.appendChild(u)}return{cancel:()=>{}}},l.globeCenterToScreenPoint=function(n){const e=[0,0,0],r=Ma(new Float64Array(16));return Uu(r,n.pixelMatrix,n.globeMatrix),vs(e,e,r),new Me(e[0],e[1])},l.globeDenormalizeECEF=Bh,l.globeECEFOrigin=function(n,e){const r=[0,0,0];return vs(r,r,Md(Pl(e.canonical))),vs(r,r,n),r},l.globeMetersToEcef=$c,l.globeNormalizeECEF=Md,l.globePixelsToTileUnits=function(n,e){return Pr/(512*Math.pow(2,n))*jc(Pl(e))},l.globePoleMatrixForTile=function(n,e,r){const s=Ma(new Float64Array(16)),u=(e/(1<<n)-.5)*Math.PI*2;return Th(s,r.globeMatrix,u),Float32Array.from(s)},l.globeTileBounds=Pl,l.globeTiltAtLngLat=yu,l.globeToMercatorTransition=_u,l.globeUseCustomAntiAliasing=function(n,e,r){const s=_u(r.zoom),u=n.style.map._antialias,f=!!e.extStandardDerivatives,g=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return 0===s&&!u&&!g&&f},l.identity=Ma,l.identity$1=zf,l.invert=Ff,l.isFullscreen=function(){return!!ve.document.fullscreenElement||!!ve.document.webkitFullscreenElement},l.isLngLatBehindGlobe=Gu,l.isMapAuthenticated=function(n){return ni.has(n)},l.isMapboxURL=wt,l.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!Lr(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},l.latFromMercatorY=Us,l.latLngToECEF=Uc,l.len=Rh,l.length=Hu,l.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},l.lngFromMercatorX=Aa,l.loadVectorTile=Yg,l.makeRequest=Do,l.mapValue=function(n,e,r,s,u){return Ht((n-e)/(r-e)*(u-s)+s,s,u)},l.mercatorScale=zh,l.mercatorXfromLng=rc,l.mercatorYfromLat=Rl,l.mercatorZfromAltitude=Ga,l.mul=Sh,l.mul$1=Ph,l.multiply=Uu,l.multiply$1=du,l.multiply$2=vm,l.nextPowerOfTwo=Lt,l.normalize=ra,l.normalize$1=Oh,l.normalize$2=Nf,l.number=J,l.ortho=function(n,e,r,s,u,f,g){var v=1/(e-r),C=1/(s-u),T=1/(f-g);return n[0]=-2*v,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*C,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*T,n[11]=0,n[12]=(e+r)*v,n[13]=(u+s)*C,n[14]=(g+f)*T,n[15]=1,n},l.pbf=og,l.perspective=function(n,e,r,s,u){var f,g=1/Math.tan(e/2);return n[0]=g/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=u&&u!==1/0?(n[10]=(u+s)*(f=1/(s-u)),n[14]=2*u*s*f):(n[10]=-1,n[14]=-2*s),n},l.pick=function(n,e){const r={};for(let s=0;s<e.length;s++){const u=e[s];u in n&&(r[u]=n[u])}return r},l.plugin=O,l.pointGeometry=Ft,l.polesInViewport=function(n){const e=Ma(new Float64Array(16));Uu(e,n.pixelMatrix,n.globeMatrix);const r=[0,Qa,0],s=[0,Ha,0];return vs(r,r,e),vs(s,s,e),[r[0]>0&&r[0]<=n.width&&r[1]>0&&r[1]<=n.height&&!Gu(n,new po(n.center.lat,90)),s[0]>0&&s[0]<=n.width&&s[1]>0&&s[1]<=n.height&&!Gu(n,new po(n.center.lat,-90))]},l.polygonContainsPoint=Wc,l.polygonIntersectsBox=Rm,l.polygonIntersectsPolygon=Od,l.polygonizeBounds=function(n,e,r=0,s=!0){const u=new Me(r,r),f=n.sub(u),g=e.add(u),v=[f,new Me(g.x,f.y),g,new Me(f.x,g.y)];return s&&v.push(f.clone()),v},l.posAttributes=Td,l.postMapLoadEvent=Xn,l.postPerformanceEvent=hr,l.postTurnstileEvent=$t,l.potpack=Tp,l.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},l.radToDeg=mt,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(n){return n({pluginStatus:h,pluginURL:i}),y.on("pluginStateChange",n),n},l.removeAuthState=function(n){ni.delete(n)},l.renderColorRamp=Uh,l.resample=Jf,l.rotateX=pm,l.rotateX$1=$f,l.rotateY=Th,l.rotateY$1=Cd,l.rotateZ=function(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[0],g=e[1],v=e[2],C=e[3],T=e[4],F=e[5],V=e[6],j=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u+T*s,n[1]=g*u+F*s,n[2]=v*u+V*s,n[3]=C*u+j*s,n[4]=T*u-f*s,n[5]=F*u-g*s,n[6]=V*u-v*s,n[7]=j*u-C*s,n},l.rotateZ$1=function(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],v=Math.sin(r),C=Math.cos(r);return n[0]=s*C+u*v,n[1]=u*C-s*v,n[2]=f*C+g*v,n[3]=g*C-f*v,n},l.scale=hu,l.scale$1=Bf,l.scale$2=hl,l.scaleAndAdd=Mh,l.set=function(n,e,r,s){return n[0]=e,n[1]=r,n[2]=s,n},l.setCacheLimits=function(n,e){hi=n,fr=e},l.setColumn=function(n,e,r){n[4*e+0]=r[0],n[4*e+1]=r[1],n[4*e+2]=r[2],n[4*e+3]=r[3]},l.setRTLTextPlugin=function(n,e,r=!1){if(h===zr||h===ti||h===ai)throw new Error("setRTLTextPlugin cannot be called multiple times.");i=fi.resolveURL(n),h=zr,zi=e,p(),r||A()},l.smoothstep=Yn,l.spec=cn,l.squaredLength=function(n){var e=n[0],r=n[1],s=n[2];return e*e+r*r+s*s},l.storeAuthState=function(n,e){e?ni.add(n):ni.delete(n)},l.sub=Al,l.subtract=ym,l.symbolSize=yp,l.tileAABB=function(n,e,r,s,u,f,g,v,C){if("globe"===C.name)return function Cm(n,e,r){const s=e/n.worldSize,u=n.globeMatrix;if(r.z<=1){const Zt=Pl(r).getCorners();return Dm(Zt,u,s),pa.fromPoints(Zt)}const f=Fh(r),g=qf(f);Dm(g,u,s);const v=Number.MAX_VALUE,C=[-v,-v,-v],T=[v,v,v];if(f.contains(n.center)){for(const Ln of g)Dd(T,T,Ln),fu(C,C,Ln);C[2]=0;const Zt=n.point,gn=[Zt.x*s,Zt.y*s,0];return Dd(T,T,gn),fu(C,C,gn),new pa(T,C)}const F=[u[12]*s,u[13]*s,u[14]*s],V=f.getCenter(),j=Ht(n.center.lat,-ia,ia),Z=Ht(V.lat,-ia,ia),Q=rc(n.center.lng),ce=Rl(j);let Te=Q-rc(V.lng);const He=ce-Rl(Z);Te>.5?Te-=1:Te<-.5&&(Te+=1);let st=0;Math.abs(Te)>Math.abs(He)?st=Te>=0?1:3:(st=He>=0?0:2,Mh(F,F,[u[4]*s,u[5]*s,u[6]*s],-Math.sin(Je(He>=0?f.getSouth():f.getNorth()))*nc));const Ge=g[st],at=g[(st+1)%4],yt=new Em(Ge,at,F),gt=[Gf(yt,0)||Ge[0],Gf(yt,1)||Ge[1],Gf(yt,2)||Ge[2]],tn=_u(n.zoom);if(tn>0){const Zt=function({x:Ln,y:ln,z:Sn},In,kn,Un,_n){const tr=1/(1<<Sn);let pr=Ln*tr,ar=pr+tr,ii=ln*tr,jn=ii+tr,Ir=0;const si=(pr+ar)/2-Un;return si>.5?Ir=-1:si<-.5&&(Ir=1),pr=((pr+Ir)*In-(Un*=In))*kn+Un,ar=((ar+Ir)*In-Un)*kn+Un,ii=(ii*In-(_n*=In))*kn+_n,jn=(jn*In-_n)*kn+_n,[[pr,jn,0],[ar,jn,0],[ar,ii,0],[pr,ii,0]]}(r,e,n._pixelsPerMercatorPixel,Q,ce);for(let Ln=0;Ln<g.length;Ln++)gu(g[Ln],Zt[Ln],tn);const gn=tc([],Zt[st],Zt[(st+1)%4]);hl(gn,gn,.5),gu(gt,gn,tn)}for(const Zt of g)Dd(T,T,Zt),fu(C,C,Zt);return T[2]=Math.min(Ge[2],at[2]),Dd(T,T,gt),fu(C,C,gt),new pa(T,C)}(n,e,new wu(r,s,u));const T=eu({z:r,x:s,y:u},C);return new pa([(f+T.x/T.scale)*e,e*(T.y/T.scale),g],[(f+T.x2/T.scale)*e,e*(T.y2/T.scale),v])},l.tileCornersToBounds=Fh,l.tileTransform=eu,l.transformMat3=function(n,e,r){var s=e[0],u=e[1],f=e[2];return n[0]=s*r[0]+u*r[3]+f*r[6],n[1]=s*r[1]+u*r[4]+f*r[7],n[2]=s*r[2]+u*r[5]+f*r[8],n},l.transformMat4=vs,l.transformMat4$1=zc,l.transformQuat=S_,l.transitionTileAABBinECEF=Wf,l.translate=ju,l.transpose=function(n,e){if(n===e){var r=e[1],s=e[2],u=e[5];n[1]=e[3],n[2]=e[6],n[3]=r,n[5]=e[7],n[6]=s,n[7]=u}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},l.triggerPluginCompletionEvent=c,l.uniqueId=ze,l.updateGlobeVertexNormal=function(n,e,r,s,u){const f=5*e+2;n.float32[f+0]=r,n.float32[f+1]=s,n.float32[f+2]=u},l.validateCustomStyleLayer=function(n){const e=[],r=n.id;return void 0===r&&e.push({message:`layers.${r}: missing required property "id"`}),void 0===n.render&&e.push({message:`layers.${r}: missing required method "render"`}),n.renderingMode&&"2d"!==n.renderingMode&&"3d"!==n.renderingMode&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateFilter=n=>qs($a(n)),l.validateFog=n=>qs(Pc(n)),l.validateLayer=n=>qs(zu(n)),l.validateLight=n=>qs(Xa(n)),l.validateSource=n=>qs(Ta(n)),l.validateStyle=Kl,l.validateTerrain=n=>qs(ca(n)),l.values=$e,l.vectorTile=Gh,l.version=Ue,l.warnOnce=mn,l.window=ve,l.wrap=en}),b(0,function(l){function ve(Qe){if("number"==typeof Qe||"boolean"==typeof Qe||"string"==typeof Qe||null==Qe)return JSON.stringify(Qe);if(Array.isArray(Qe)){let _e="[";for(const qe of Qe)_e+=`${ve(qe)},`;return`${_e}]`}let he="{";for(const _e of Object.keys(Qe).sort())he+=`${_e}:${ve(Qe[_e])},`;return`${he}}`}function Ue(Qe){let he="";for(const _e of l.refProperties)he+=`/${ve(Qe[_e])}`;return he}class Le{constructor(he){this.keyCache={},he&&this.replace(he)}replace(he){this._layerConfigs={},this._layers={},this.update(he,[])}update(he,_e){for(const ut of he)this._layerConfigs[ut.id]=ut,(this._layers[ut.id]=l.createStyleLayer(ut)).compileFilter(),this.keyCache[ut.id]&&delete this.keyCache[ut.id];for(const ut of _e)delete this.keyCache[ut],delete this._layerConfigs[ut],delete this._layers[ut];this.familiesBySource={};const qe=function(ut,wt){const Ot={};for(let xt=0;xt<ut.length;xt++){const Vt=wt&&wt[ut[xt].id]||Ue(ut[xt]);wt&&(wt[ut[xt].id]=Vt);let yn=Ot[Vt];yn||(yn=Ot[Vt]=[]),yn.push(ut[xt])}const kt=[];for(const xt in Ot)kt.push(Ot[xt]);return kt}(l.values(this._layerConfigs),this.keyCache);for(const ut of qe){const wt=ut.map(Be=>this._layers[Be.id]),Ot=wt[0];if("none"===Ot.visibility)continue;const kt=Ot.source||"";let xt=this.familiesBySource[kt];xt||(xt=this.familiesBySource[kt]={});const Vt=Ot.sourceLayer||"_geojsonTileLayer";let yn=xt[Vt];yn||(yn=xt[Vt]=[]),yn.push(wt)}}}class it{loadTile(he,_e){const{uid:qe,encoding:ut,rawImageData:wt,padding:Ot,buildQuadTree:kt}=he,xt=l.window.ImageBitmap&&wt instanceof l.window.ImageBitmap?this.getImageData(wt,Ot):wt;_e(null,new l.DEMData(qe,xt,ut,Ot<1,kt))}getImageData(he,_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(he.width,he.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=he.width,this.offscreenCanvas.height=he.height,this.offscreenCanvasContext.drawImage(he,0,0,he.width,he.height);const qe=this.offscreenCanvasContext.getImageData(-_e,-_e,he.width+2*_e,he.height+2*_e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),qe}}function et(Qe,he){if(0!==Qe.length){xe(Qe[0],he);for(var _e=1;_e<Qe.length;_e++)xe(Qe[_e],!he)}}function xe(Qe,he){for(var _e=0,qe=0,ut=0,wt=Qe.length,Ot=wt-1;ut<wt;Ot=ut++){var kt=(Qe[ut][0]-Qe[Ot][0])*(Qe[Ot][1]+Qe[ut][1]),xt=_e+kt;qe+=Math.abs(_e)>=Math.abs(kt)?_e-xt+kt:kt-xt+_e,_e=xt}_e+qe>=0!=!!he&&Qe.reverse()}var Re=l.getDefaultExportFromCjs(function Qe(he,_e){var qe,ut=he&&he.type;if("FeatureCollection"===ut)for(qe=0;qe<he.features.length;qe++)Qe(he.features[qe],_e);else if("GeometryCollection"===ut)for(qe=0;qe<he.geometries.length;qe++)Qe(he.geometries[qe],_e);else if("Feature"===ut)Qe(he.geometry,_e);else if("Polygon"===ut)et(he.coordinates,_e);else if("MultiPolygon"===ut)for(qe=0;qe<he.coordinates.length;qe++)et(he.coordinates[qe],_e);return he});const Ze=l.VectorTileFeature.prototype.toGeoJSON;var tt={exports:{}},lt=l.pointGeometry,pt=l.vectorTile.VectorTileFeature,vt=_t;function _t(Qe,he){this.options=he||{},this.features=Qe,this.length=Qe.length}function nt(Qe,he){this.id="number"==typeof Qe.id?Qe.id:void 0,this.type=Qe.type,this.rawGeometry=1===Qe.type?[Qe.geometry]:Qe.geometry,this.properties=Qe.tags,this.extent=he||4096}_t.prototype.feature=function(Qe){return new nt(this.features[Qe],this.options.extent)},nt.prototype.loadGeometry=function(){var Qe=this.rawGeometry;this.geometry=[];for(var he=0;he<Qe.length;he++){for(var _e=Qe[he],qe=[],ut=0;ut<_e.length;ut++)qe.push(new lt(_e[ut][0],_e[ut][1]));this.geometry.push(qe)}return this.geometry},nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qe=this.geometry,he=1/0,_e=-1/0,qe=1/0,ut=-1/0,wt=0;wt<Qe.length;wt++)for(var Ot=Qe[wt],kt=0;kt<Ot.length;kt++){var xt=Ot[kt];he=Math.min(he,xt.x),_e=Math.max(_e,xt.x),qe=Math.min(qe,xt.y),ut=Math.max(ut,xt.y)}return[he,qe,_e,ut]},nt.prototype.toGeoJSON=pt.prototype.toGeoJSON;var Bt=l.pbf,Ft=vt;function Se(Qe){var he=new Bt;return function(_e,qe){for(var ut in _e.layers)qe.writeMessage(3,Me,_e.layers[ut])}(Qe,he),he.finish()}function Me(Qe,he){var _e;he.writeVarintField(15,Qe.version||1),he.writeStringField(1,Qe.name||""),he.writeVarintField(5,Qe.extent||4096);var qe={keys:[],values:[],keycache:{},valuecache:{}};for(_e=0;_e<Qe.length;_e++)qe.feature=Qe.feature(_e),he.writeMessage(2,ht,qe);var ut=qe.keys;for(_e=0;_e<ut.length;_e++)he.writeStringField(3,ut[_e]);var wt=qe.values;for(_e=0;_e<wt.length;_e++)he.writeMessage(4,Ut,wt[_e])}function ht(Qe,he){var _e=Qe.feature;void 0!==_e.id&&he.writeVarintField(1,_e.id),he.writeMessage(2,It,Qe),he.writeVarintField(3,_e.type),he.writeMessage(4,Kt,_e)}function It(Qe,he){var _e=Qe.feature,qe=Qe.keys,ut=Qe.values,wt=Qe.keycache,Ot=Qe.valuecache;for(var kt in _e.properties){var xt=_e.properties[kt],Vt=wt[kt];if(null!==xt){void 0===Vt&&(qe.push(kt),wt[kt]=Vt=qe.length-1),he.writeVarint(Vt);var yn=typeof xt;"string"!==yn&&"boolean"!==yn&&"number"!==yn&&(xt=JSON.stringify(xt));var Be=yn+":"+xt,le=Ot[Be];void 0===le&&(ut.push(xt),Ot[Be]=le=ut.length-1),he.writeVarint(le)}}}function Je(Qe,he){return(he<<3)+(7&Qe)}function mt(Qe){return Qe<<1^Qe>>31}function Kt(Qe,he){for(var _e=Qe.loadGeometry(),qe=Qe.type,ut=0,wt=0,Ot=_e.length,kt=0;kt<Ot;kt++){var xt=_e[kt],Vt=1;1===qe&&(Vt=xt.length),he.writeVarint(Je(1,Vt));for(var yn=3===qe?xt.length-1:xt.length,Be=0;Be<yn;Be++){1===Be&&1!==qe&&he.writeVarint(Je(2,yn-1));var le=xt[Be].x-ut,de=xt[Be].y-wt;he.writeVarint(mt(le)),he.writeVarint(mt(de)),ut+=le,wt+=de}3===qe&&he.writeVarint(Je(7,1))}}function Ut(Qe,he){var _e=typeof Qe;"string"===_e?he.writeStringField(1,Qe):"boolean"===_e?he.writeBooleanField(7,Qe):"number"===_e&&(Qe%1!=0?he.writeDoubleField(3,Qe):Qe<0?he.writeSVarintField(6,Qe):he.writeVarintField(5,Qe))}tt.exports=Se,tt.exports.fromVectorTileJs=Se,tt.exports.fromGeojsonVt=function(Qe,he){he=he||{};var _e={};for(var qe in Qe)_e[qe]=new Ft(Qe[qe].features,he),_e[qe].name=qe,_e[qe].version=he.version,_e[qe].extent=he.extent;return Se({layers:_e})},tt.exports.GeoJSONWrapper=Ft;var dn=l.getDefaultExportFromCjs(tt.exports);const on={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Qe=>Qe},Ht=Math.fround||(Yn=new Float32Array(1),Qe=>(Yn[0]=+Qe,Yn[0]));var Yn;const en=3,bt=5,$e=6;class ue{constructor(he){this.options=Object.assign(Object.create(on),he),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(he){const{log:_e,minZoom:qe,maxZoom:ut}=this.options;_e&&console.time("total time");const wt=`prepare ${he.length} points`;_e&&console.time(wt),this.points=he;const Ot=[];for(let xt=0;xt<he.length;xt++){const Vt=he[xt];if(!Vt.geometry)continue;const[yn,Be]=Vt.geometry.coordinates,le=Ht(ct(yn)),de=Ht(Lt(Be));Ot.push(le,de,1/0,xt,-1,1),this.options.reduce&&Ot.push(0)}let kt=this.trees[ut+1]=this._createTree(Ot);_e&&console.timeEnd(wt);for(let xt=ut;xt>=qe;xt--){const Vt=+Date.now();kt=this.trees[xt]=this._createTree(this._cluster(kt,xt)),_e&&console.log("z%d: %d clusters in %dms",xt,kt.numItems,+Date.now()-Vt)}return _e&&console.timeEnd("total time"),this}getClusters(he,_e){let qe=((he[0]+180)%360+360)%360-180;const ut=Math.max(-90,Math.min(90,he[1]));let wt=180===he[2]?180:((he[2]+180)%360+360)%360-180;const Ot=Math.max(-90,Math.min(90,he[3]));if(he[2]-he[0]>=360)qe=-180,wt=180;else if(qe>wt){const Be=this.getClusters([qe,ut,180,Ot],_e),le=this.getClusters([-180,ut,wt,Ot],_e);return Be.concat(le)}const kt=this.trees[this._limitZoom(_e)],xt=kt.range(ct(qe),Lt(Ot),ct(wt),Lt(ut)),Vt=kt.data,yn=[];for(const Be of xt){const le=this.stride*Be;yn.push(Vt[le+bt]>1?me(Vt,le,this.clusterProps):this.points[Vt[le+en]])}return yn}getChildren(he){const _e=this._getOriginId(he),qe=this._getOriginZoom(he),ut="No cluster with the specified id.",wt=this.trees[qe];if(!wt)throw new Error(ut);const Ot=wt.data;if(_e*this.stride>=Ot.length)throw new Error(ut);const kt=this.options.radius/(this.options.extent*Math.pow(2,qe-1)),xt=wt.within(Ot[_e*this.stride],Ot[_e*this.stride+1],kt),Vt=[];for(const yn of xt){const Be=yn*this.stride;Ot[Be+4]===he&&Vt.push(Ot[Be+bt]>1?me(Ot,Be,this.clusterProps):this.points[Ot[Be+en]])}if(0===Vt.length)throw new Error(ut);return Vt}getLeaves(he,_e,qe){const ut=[];return this._appendLeaves(ut,he,_e=_e||10,qe=qe||0,0),ut}getTile(he,_e,qe){const ut=this.trees[this._limitZoom(he)],wt=Math.pow(2,he),{extent:Ot,radius:kt}=this.options,xt=kt/Ot,Vt=(qe-xt)/wt,yn=(qe+1+xt)/wt,Be={features:[]};return this._addTileFeatures(ut.range((_e-xt)/wt,Vt,(_e+1+xt)/wt,yn),ut.data,_e,qe,wt,Be),0===_e&&this._addTileFeatures(ut.range(1-xt/wt,Vt,1,yn),ut.data,wt,qe,wt,Be),_e===wt-1&&this._addTileFeatures(ut.range(0,Vt,xt/wt,yn),ut.data,-1,qe,wt,Be),Be.features.length?Be:null}getClusterExpansionZoom(he){let _e=this._getOriginZoom(he)-1;for(;_e<=this.options.maxZoom;){const qe=this.getChildren(he);if(_e++,1!==qe.length)break;he=qe[0].properties.cluster_id}return _e}_appendLeaves(he,_e,qe,ut,wt){const Ot=this.getChildren(_e);for(const kt of Ot){const xt=kt.properties;if(xt&&xt.cluster?wt+xt.point_count<=ut?wt+=xt.point_count:wt=this._appendLeaves(he,xt.cluster_id,qe,ut,wt):wt<ut?wt++:he.push(kt),he.length===qe)break}return wt}_createTree(he){const _e=new l.KDBush(he.length/this.stride|0,this.options.nodeSize,Float32Array);for(let qe=0;qe<he.length;qe+=this.stride)_e.add(he[qe],he[qe+1]);return _e.finish(),_e.data=he,_e}_addTileFeatures(he,_e,qe,ut,wt,Ot){for(const kt of he){const xt=kt*this.stride,Vt=_e[xt+bt]>1;let yn,Be,le;if(Vt)yn=ze(_e,xt,this.clusterProps),Be=_e[xt],le=_e[xt+1];else{const pe=this.points[_e[xt+en]];yn=pe.properties;const[ot,$t]=pe.geometry.coordinates;Be=ct(ot),le=Lt($t)}const de={type:1,geometry:[[Math.round(this.options.extent*(Be*wt-qe)),Math.round(this.options.extent*(le*wt-ut))]],tags:yn};let Ne;Ne=Vt||this.options.generateId?_e[xt+en]:this.points[_e[xt+en]].id,void 0!==Ne&&(de.id=Ne),Ot.features.push(de)}}_limitZoom(he){return Math.max(this.options.minZoom,Math.min(Math.floor(+he),this.options.maxZoom+1))}_cluster(he,_e){const{radius:qe,extent:ut,reduce:wt,minPoints:Ot}=this.options,kt=qe/(ut*Math.pow(2,_e)),xt=he.data,Vt=[],yn=this.stride;for(let Be=0;Be<xt.length;Be+=yn){if(xt[Be+2]<=_e)continue;xt[Be+2]=_e;const le=xt[Be],de=xt[Be+1],Ne=he.within(xt[Be],xt[Be+1],kt),pe=xt[Be+bt];let ot=pe;for(const $t of Ne){const vn=$t*yn;xt[vn+2]>_e&&(ot+=xt[vn+bt])}if(ot>pe&&ot>=Ot){let $t,vn=le*pe,Xn=de*pe,Wn=-1;const hr=((Be/yn|0)<<5)+(_e+1)+this.points.length;for(const vr of Ne){const Wr=vr*yn;if(xt[Wr+2]<=_e)continue;xt[Wr+2]=_e;const ni=xt[Wr+bt];vn+=xt[Wr]*ni,Xn+=xt[Wr+1]*ni,xt[Wr+4]=hr,wt&&($t||($t=this._map(xt,Be,!0),Wn=this.clusterProps.length,this.clusterProps.push($t)),wt($t,this._map(xt,Wr)))}xt[Be+4]=hr,Vt.push(vn/ot,Xn/ot,1/0,hr,-1,ot),wt&&Vt.push(Wn)}else{for(let $t=0;$t<yn;$t++)Vt.push(xt[Be+$t]);if(ot>1)for(const $t of Ne){const vn=$t*yn;if(!(xt[vn+2]<=_e)){xt[vn+2]=_e;for(let Xn=0;Xn<yn;Xn++)Vt.push(xt[vn+Xn])}}}}return Vt}_getOriginId(he){return he-this.points.length>>5}_getOriginZoom(he){return(he-this.points.length)%32}_map(he,_e,qe){if(he[_e+bt]>1){const Ot=this.clusterProps[he[_e+$e]];return qe?Object.assign({},Ot):Ot}const ut=this.points[he[_e+en]].properties,wt=this.options.map(ut);return qe&&wt===ut?Object.assign({},wt):wt}}function me(Qe,he,_e){return{type:"Feature",id:Qe[he+en],properties:ze(Qe,he,_e),geometry:{type:"Point",coordinates:[(qe=Qe[he],360*(qe-.5)),Gt(Qe[he+1])]}};var qe}function ze(Qe,he,_e){const qe=Qe[he+bt],ut=qe>=1e4?`${Math.round(qe/1e3)}k`:qe>=1e3?Math.round(qe/100)/10+"k":qe,wt=Qe[he+$e],Ot=-1===wt?{}:Object.assign({},_e[wt]);return Object.assign(Ot,{cluster:!0,cluster_id:Qe[he+en],point_count:qe,point_count_abbreviated:ut})}function ct(Qe){return Qe/360+.5}function Lt(Qe){const he=Math.sin(Qe*Math.PI/180),_e=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return _e<0?0:_e>1?1:_e}function Gt(Qe){const he=(180-360*Qe)*Math.PI/180;return 360*Math.atan(Math.exp(he))/Math.PI-90}function Yt(Qe,he,_e,qe){for(var ut,wt=qe,Ot=_e-he>>1,kt=_e-he,xt=Qe[he],Vt=Qe[he+1],yn=Qe[_e],Be=Qe[_e+1],le=he+3;le<_e;le+=3){var de=hn(Qe[le],Qe[le+1],xt,Vt,yn,Be);if(de>wt)ut=le,wt=de;else if(de===wt){var Ne=Math.abs(le-Ot);Ne<kt&&(ut=le,kt=Ne)}}wt>qe&&(ut-he>3&&Yt(Qe,he,ut,qe),Qe[ut+2]=wt,_e-ut>3&&Yt(Qe,ut,_e,qe))}function hn(Qe,he,_e,qe,ut,wt){var Ot=ut-_e,kt=wt-qe;if(0!==Ot||0!==kt){var xt=((Qe-_e)*Ot+(he-qe)*kt)/(Ot*Ot+kt*kt);xt>1?(_e=ut,qe=wt):xt>0&&(_e+=Ot*xt,qe+=kt*xt)}return(Ot=Qe-_e)*Ot+(kt=he-qe)*kt}function sn(Qe,he,_e,qe){var ut={id:void 0===Qe?null:Qe,type:he,geometry:_e,tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(wt){var Ot=wt.geometry,kt=wt.type;if("Point"===kt||"MultiPoint"===kt||"LineString"===kt)jt(wt,Ot);else if("Polygon"===kt||"MultiLineString"===kt)for(var xt=0;xt<Ot.length;xt++)jt(wt,Ot[xt]);else if("MultiPolygon"===kt)for(xt=0;xt<Ot.length;xt++)for(var Vt=0;Vt<Ot[xt].length;Vt++)jt(wt,Ot[xt][Vt])}(ut),ut}function jt(Qe,he){for(var _e=0;_e<he.length;_e+=3)Qe.minX=Math.min(Qe.minX,he[_e]),Qe.minY=Math.min(Qe.minY,he[_e+1]),Qe.maxX=Math.max(Qe.maxX,he[_e]),Qe.maxY=Math.max(Qe.maxY,he[_e+1])}function Xt(Qe,he,_e,qe){if(he.geometry){var ut=he.geometry.coordinates,wt=he.geometry.type,Ot=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2),kt=[],xt=he.id;if(_e.promoteId?xt=he.properties[_e.promoteId]:_e.generateId&&(xt=qe||0),"Point"===wt)an(ut,kt);else if("MultiPoint"===wt)for(var Vt=0;Vt<ut.length;Vt++)an(ut[Vt],kt);else if("LineString"===wt)mn(ut,kt,Ot,!1);else if("MultiLineString"===wt){if(_e.lineMetrics){for(Vt=0;Vt<ut.length;Vt++)mn(ut[Vt],kt=[],Ot,!1),Qe.push(sn(xt,"LineString",kt,he.properties));return}Bn(ut,kt,Ot,!1)}else if("Polygon"===wt)Bn(ut,kt,Ot,!0);else{if("MultiPolygon"!==wt){if("GeometryCollection"===wt){for(Vt=0;Vt<he.geometry.geometries.length;Vt++)Xt(Qe,{id:xt,geometry:he.geometry.geometries[Vt],properties:he.properties},_e,qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Vt=0;Vt<ut.length;Vt++){var yn=[];Bn(ut[Vt],yn,Ot,!0),kt.push(yn)}}Qe.push(sn(xt,wt,kt,he.properties))}}function an(Qe,he){he.push(mr(Qe[0])),he.push(nr(Qe[1])),he.push(0)}function mn(Qe,he,_e,qe){for(var ut,wt,Ot=0,kt=0;kt<Qe.length;kt++){var xt=mr(Qe[kt][0]),Vt=nr(Qe[kt][1]);he.push(xt),he.push(Vt),he.push(0),kt>0&&(Ot+=qe?(ut*Vt-xt*wt)/2:Math.sqrt(Math.pow(xt-ut,2)+Math.pow(Vt-wt,2))),ut=xt,wt=Vt}var yn=he.length-3;he[2]=1,Yt(he,0,yn,_e),he[yn+2]=1,he.size=Math.abs(Ot),he.start=0,he.end=he.size}function Bn(Qe,he,_e,qe){for(var ut=0;ut<Qe.length;ut++){var wt=[];mn(Qe[ut],wt,_e,qe),he.push(wt)}}function mr(Qe){return Qe/360+.5}function nr(Qe){var he=Math.sin(Qe*Math.PI/180),_e=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return _e<0?0:_e>1?1:_e}function _r(Qe,he,_e,qe,ut,wt,Ot,kt){if(qe/=he,wt>=(_e/=he)&&Ot<qe)return Qe;if(Ot<_e||wt>=qe)return null;for(var xt=[],Vt=0;Vt<Qe.length;Vt++){var yn=Qe[Vt],Be=yn.geometry,le=yn.type,de=0===ut?yn.minX:yn.minY,Ne=0===ut?yn.maxX:yn.maxY;if(de>=_e&&Ne<qe)xt.push(yn);else if(!(Ne<_e||de>=qe)){var pe=[];if("Point"===le||"MultiPoint"===le)Kn(Be,pe,_e,qe,ut);else if("LineString"===le)Lr(Be,pe,_e,qe,ut,!1,kt.lineMetrics);else if("MultiLineString"===le)Jr(Be,pe,_e,qe,ut,!1);else if("Polygon"===le)Jr(Be,pe,_e,qe,ut,!0);else if("MultiPolygon"===le)for(var ot=0;ot<Be.length;ot++){var $t=[];Jr(Be[ot],$t,_e,qe,ut,!0),$t.length&&pe.push($t)}if(pe.length){if(kt.lineMetrics&&"LineString"===le){for(ot=0;ot<pe.length;ot++)xt.push(sn(yn.id,le,pe[ot],yn.tags));continue}"LineString"!==le&&"MultiLineString"!==le||(1===pe.length?(le="LineString",pe=pe[0]):le="MultiLineString"),"Point"!==le&&"MultiPoint"!==le||(le=3===pe.length?"Point":"MultiPoint"),xt.push(sn(yn.id,le,pe,yn.tags))}}}return xt.length?xt:null}function Kn(Qe,he,_e,qe,ut){for(var wt=0;wt<Qe.length;wt+=3){var Ot=Qe[wt+ut];Ot>=_e&&Ot<=qe&&(he.push(Qe[wt]),he.push(Qe[wt+1]),he.push(Qe[wt+2]))}}function Lr(Qe,he,_e,qe,ut,wt,Ot){for(var kt,xt,Vt=bn(Qe),yn=0===ut?hi:fr,Be=Qe.start,le=0;le<Qe.length-3;le+=3){var de=Qe[le],Ne=Qe[le+1],pe=Qe[le+2],ot=Qe[le+3],$t=Qe[le+4],vn=0===ut?de:Ne,Xn=0===ut?ot:$t,Wn=!1;Ot&&(kt=Math.sqrt(Math.pow(de-ot,2)+Math.pow(Ne-$t,2))),vn<_e?Xn>_e&&(xt=yn(Vt,de,Ne,ot,$t,_e),Ot&&(Vt.start=Be+kt*xt)):vn>qe?Xn<qe&&(xt=yn(Vt,de,Ne,ot,$t,qe),Ot&&(Vt.start=Be+kt*xt)):Fi(Vt,de,Ne,pe),Xn<_e&&vn>=_e&&(xt=yn(Vt,de,Ne,ot,$t,_e),Wn=!0),Xn>qe&&vn<=qe&&(xt=yn(Vt,de,Ne,ot,$t,qe),Wn=!0),!wt&&Wn&&(Ot&&(Vt.end=Be+kt*xt),he.push(Vt),Vt=bn(Qe)),Ot&&(Be+=kt)}var hr=Qe.length-3;de=Qe[hr],Ne=Qe[hr+1],pe=Qe[hr+2],(vn=0===ut?de:Ne)>=_e&&vn<=qe&&Fi(Vt,de,Ne,pe),hr=Vt.length-3,wt&&hr>=3&&(Vt[hr]!==Vt[0]||Vt[hr+1]!==Vt[1])&&Fi(Vt,Vt[0],Vt[1],Vt[2]),Vt.length&&he.push(Vt)}function bn(Qe){var he=[];return he.size=Qe.size,he.start=Qe.start,he.end=Qe.end,he}function Jr(Qe,he,_e,qe,ut,wt){for(var Ot=0;Ot<Qe.length;Ot++)Lr(Qe[Ot],he,_e,qe,ut,wt,!1)}function Fi(Qe,he,_e,qe){Qe.push(he),Qe.push(_e),Qe.push(qe)}function hi(Qe,he,_e,qe,ut,wt){var Ot=(wt-he)/(qe-he);return Qe.push(wt),Qe.push(_e+(ut-_e)*Ot),Qe.push(1),Ot}function fr(Qe,he,_e,qe,ut,wt){var Ot=(wt-_e)/(ut-_e);return Qe.push(he+(qe-he)*Ot),Qe.push(wt),Qe.push(1),Ot}function Er(Qe,he){for(var _e=[],qe=0;qe<Qe.length;qe++){var ut,wt=Qe[qe],Ot=wt.type;if("Point"===Ot||"MultiPoint"===Ot||"LineString"===Ot)ut=yr(wt.geometry,he);else if("MultiLineString"===Ot||"Polygon"===Ot){ut=[];for(var kt=0;kt<wt.geometry.length;kt++)ut.push(yr(wt.geometry[kt],he))}else if("MultiPolygon"===Ot)for(ut=[],kt=0;kt<wt.geometry.length;kt++){for(var xt=[],Vt=0;Vt<wt.geometry[kt].length;Vt++)xt.push(yr(wt.geometry[kt][Vt],he));ut.push(xt)}_e.push(sn(wt.id,Ot,ut,wt.tags))}return _e}function yr(Qe,he){var _e=[];_e.size=Qe.size,void 0!==Qe.start&&(_e.start=Qe.start,_e.end=Qe.end);for(var qe=0;qe<Qe.length;qe+=3)_e.push(Qe[qe]+he,Qe[qe+1],Qe[qe+2]);return _e}function gr(Qe,he){if(Qe.transformed)return Qe;var _e,qe,ut,wt=1<<Qe.z,Ot=Qe.x,kt=Qe.y;for(_e=0;_e<Qe.features.length;_e++){var xt=Qe.features[_e],Vt=xt.geometry,yn=xt.type;if(xt.geometry=[],1===yn)for(qe=0;qe<Vt.length;qe+=2)xt.geometry.push(Ci(Vt[qe],Vt[qe+1],he,wt,Ot,kt));else for(qe=0;qe<Vt.length;qe++){var Be=[];for(ut=0;ut<Vt[qe].length;ut+=2)Be.push(Ci(Vt[qe][ut],Vt[qe][ut+1],he,wt,Ot,kt));xt.geometry.push(Be)}}return Qe.transformed=!0,Qe}function Ci(Qe,he,_e,qe,ut,wt){return[Math.round(_e*(Qe*qe-ut)),Math.round(_e*(he*qe-wt))]}function qi(Qe,he,_e,qe,ut){for(var wt=he===ut.maxZoom?0:ut.tolerance/((1<<he)*ut.extent),Ot={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:_e,y:qe,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},kt=0;kt<Qe.length;kt++){Ot.numFeatures++,Sr(Ot,Qe[kt],wt,ut);var xt=Qe[kt].minX,Vt=Qe[kt].minY,yn=Qe[kt].maxX,Be=Qe[kt].maxY;xt<Ot.minX&&(Ot.minX=xt),Vt<Ot.minY&&(Ot.minY=Vt),yn>Ot.maxX&&(Ot.maxX=yn),Be>Ot.maxY&&(Ot.maxY=Be)}return Ot}function Sr(Qe,he,_e,qe){var ut=he.geometry,wt=he.type,Ot=[];if("Point"===wt||"MultiPoint"===wt)for(var kt=0;kt<ut.length;kt+=3)Ot.push(ut[kt]),Ot.push(ut[kt+1]),Qe.numPoints++,Qe.numSimplified++;else if("LineString"===wt)Ai(Ot,ut,Qe,_e,!1,!1);else if("MultiLineString"===wt||"Polygon"===wt)for(kt=0;kt<ut.length;kt++)Ai(Ot,ut[kt],Qe,_e,"Polygon"===wt,0===kt);else if("MultiPolygon"===wt)for(var xt=0;xt<ut.length;xt++){var Vt=ut[xt];for(kt=0;kt<Vt.length;kt++)Ai(Ot,Vt[kt],Qe,_e,!0,0===kt)}if(Ot.length){var yn=he.tags||null;if("LineString"===wt&&qe.lineMetrics){for(var Be in yn={},he.tags)yn[Be]=he.tags[Be];yn.mapbox_clip_start=ut.start/ut.size,yn.mapbox_clip_end=ut.end/ut.size}var le={geometry:Ot,type:"Polygon"===wt||"MultiPolygon"===wt?3:"LineString"===wt||"MultiLineString"===wt?2:1,tags:yn};null!==he.id&&(le.id=he.id),Qe.features.push(le)}}function Ai(Qe,he,_e,qe,ut,wt){var Ot=qe*qe;if(qe>0&&he.size<(ut?Ot:qe))_e.numPoints+=he.length/3;else{for(var kt=[],xt=0;xt<he.length;xt+=3)(0===qe||he[xt+2]>Ot)&&(_e.numSimplified++,kt.push(he[xt]),kt.push(he[xt+1])),_e.numPoints++;ut&&function(Vt,yn){for(var Be=0,le=0,de=Vt.length,Ne=de-2;le<de;Ne=le,le+=2)Be+=(Vt[le]-Vt[Ne])*(Vt[le+1]+Vt[Ne+1]);if(Be>0===yn)for(le=0,de=Vt.length;le<de/2;le+=2){var pe=Vt[le],ot=Vt[le+1];Vt[le]=Vt[de-2-le],Vt[le+1]=Vt[de-1-le],Vt[de-2-le]=pe,Vt[de-1-le]=ot}}(kt,wt),Qe.push(kt)}}function vi(Qe,he){var _e=(he=this.options=function(ut,wt){for(var Ot in wt)ut[Ot]=wt[Ot];return ut}(Object.create(this.options),he)).debug;if(_e&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");var ut,wt,Ot,kt,xt,Vt,qe=function(ut,wt){var Ot=[];if("FeatureCollection"===ut.type)for(var kt=0;kt<ut.features.length;kt++)Xt(Ot,ut.features[kt],wt,kt);else Xt(Ot,"Feature"===ut.type?ut:{geometry:ut},wt);return Ot}(Qe,he);this.tiles={},this.tileCoords=[],_e&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),kt=ut=qe,xt=_r(ut,1,-1-(Ot=(wt=he).buffer/wt.extent),Ot,0,-1,2,wt),Vt=_r(ut,1,1-Ot,2+Ot,0,-1,2,wt),(xt||Vt)&&(kt=_r(ut,1,-Ot,1+Ot,0,-1,2,wt)||[],xt&&(kt=Er(xt,1).concat(kt)),Vt&&(kt=kt.concat(Er(Vt,-1)))),(qe=kt).length&&this.splitTile(qe,0,0,0),_e&&(qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yr(Qe,he,_e){return 32*((1<<Qe)*_e+he)+Qe}function Do(Qe,he){const _e=Qe.tileID.canonical;if(!this._geoJSONIndex)return he(null,null);const qe=this._geoJSONIndex.getTile(_e.z,_e.x,_e.y);if(!qe)return he(null,null);const ut=new class{constructor(Ot){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Ot.length,this._features=Ot}feature(Ot){return new class{constructor(kt){this._feature=kt,this.extent=l.EXTENT,this.type=kt.type,this.properties=kt.tags,"id"in kt&&!isNaN(kt.id)&&(this.id=parseInt(kt.id,10))}loadGeometry(){if(1===this._feature.type){const kt=[];for(const xt of this._feature.geometry)kt.push([new l.Point(xt[0],xt[1])]);return kt}{const kt=[];for(const xt of this._feature.geometry){const Vt=[];for(const yn of xt)Vt.push(new l.Point(yn[0],yn[1]));kt.push(Vt)}return kt}}toGeoJSON(kt,xt,Vt){return Ze.call(this,kt,xt,Vt)}}(this._features[Ot])}}(qe.features);let wt=dn(ut);0===wt.byteOffset&&wt.byteLength===wt.buffer.byteLength||(wt=new Uint8Array(wt)),he(null,{vectorTile:ut,rawData:wt.buffer})}vi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vi.prototype.splitTile=function(Qe,he,_e,qe,ut,wt,Ot){for(var kt=[Qe,he,_e,qe],xt=this.options,Vt=xt.debug;kt.length;){qe=kt.pop(),_e=kt.pop(),he=kt.pop(),Qe=kt.pop();var yn=1<<he,Be=Yr(he,_e,qe),le=this.tiles[Be];if(!le&&(Vt>1&&console.time("creation"),le=this.tiles[Be]=qi(Qe,he,_e,qe,xt),this.tileCoords.push({z:he,x:_e,y:qe}),Vt)){Vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,_e,qe,le.numFeatures,le.numPoints,le.numSimplified),console.timeEnd("creation"));var de="z"+he;this.stats[de]=(this.stats[de]||0)+1,this.total++}if(le.source=Qe,ut){if(he===xt.maxZoom||he===ut)continue;var Ne=1<<ut-he;if(_e!==Math.floor(wt/Ne)||qe!==Math.floor(Ot/Ne))continue}else if(he===xt.indexMaxZoom||le.numPoints<=xt.indexMaxPoints)continue;if(le.source=null,0!==Qe.length){Vt>1&&console.time("clipping");var pe,ot,$t,vn,Xn,Wn,hr=.5*xt.buffer/xt.extent,vr=.5-hr,Wr=.5+hr,ni=1+hr;pe=ot=$t=vn=null,Xn=_r(Qe,yn,_e-hr,_e+Wr,0,le.minX,le.maxX,xt),Wn=_r(Qe,yn,_e+vr,_e+ni,0,le.minX,le.maxX,xt),Qe=null,Xn&&(pe=_r(Xn,yn,qe-hr,qe+Wr,1,le.minY,le.maxY,xt),ot=_r(Xn,yn,qe+vr,qe+ni,1,le.minY,le.maxY,xt),Xn=null),Wn&&($t=_r(Wn,yn,qe-hr,qe+Wr,1,le.minY,le.maxY,xt),vn=_r(Wn,yn,qe+vr,qe+ni,1,le.minY,le.maxY,xt),Wn=null),Vt>1&&console.timeEnd("clipping"),kt.push(pe||[],he+1,2*_e,2*qe),kt.push(ot||[],he+1,2*_e,2*qe+1),kt.push($t||[],he+1,2*_e+1,2*qe),kt.push(vn||[],he+1,2*_e+1,2*qe+1)}}},vi.prototype.getTile=function(Qe,he,_e){var qe=this.options,ut=qe.extent,wt=qe.debug;if(Qe<0||Qe>24)return null;var Ot=1<<Qe,kt=Yr(Qe,he=(he%Ot+Ot)%Ot,_e);if(this.tiles[kt])return gr(this.tiles[kt],ut);wt>1&&console.log("drilling down to z%d-%d-%d",Qe,he,_e);for(var xt,Vt=Qe,yn=he,Be=_e;!xt&&Vt>0;)Vt--,yn=Math.floor(yn/2),Be=Math.floor(Be/2),xt=this.tiles[Yr(Vt,yn,Be)];return xt&&xt.source?(wt>1&&console.log("found parent tile z%d-%d-%d",Vt,yn,Be),wt>1&&console.time("drilling down"),this.splitTile(xt.source,Vt,yn,Be,Qe,he,_e),wt>1&&console.timeEnd("drilling down"),this.tiles[kt]?gr(this.tiles[kt],ut):null):null};class Or extends l.VectorTileWorkerSource{constructor(he,_e,qe,ut,wt){super(he,_e,qe,ut,Do),wt&&(this.loadGeoJSON=wt)}loadData(he,_e){const qe=he&&he.request,ut=qe&&qe.collectResourceTiming;this.loadGeoJSON(he,(wt,Ot)=>{if(wt||!Ot)return _e(wt);if("object"!=typeof Ot)return _e(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));{Re(Ot,!0);try{if(he.filter){const xt=l.createExpression(he.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===xt.result)throw new Error(xt.value.map(yn=>`${yn.key}: ${yn.message}`).join(", "));Ot={type:"FeatureCollection",features:Ot.features.filter(yn=>xt.value.evaluate({zoom:0},yn))}}this._geoJSONIndex=he.cluster?new ue(function({superclusterOptions:xt,clusterProperties:Vt}){if(!Vt||!xt)return xt;const yn={},Be={},le={accumulated:null,zoom:0},de={properties:null},Ne=Object.keys(Vt);for(const pe of Ne){const[ot,$t]=Vt[pe],vn=l.createExpression($t),Xn=l.createExpression("string"==typeof ot?[ot,["accumulated"],["get",pe]]:ot);yn[pe]=vn.value,Be[pe]=Xn.value}return xt.map=pe=>{de.properties=pe;const ot={};for(const $t of Ne)ot[$t]=yn[$t].evaluate(le,de);return ot},xt.reduce=(pe,ot)=>{de.properties=ot;for(const $t of Ne)le.accumulated=pe[$t],pe[$t]=Be[$t].evaluate(le,de)},xt}(he)).load(Ot.features):new vi(xt=Ot,he.geojsonVtOptions)}catch(xt){return _e(xt)}this.loaded={};const kt={};if(ut){const xt=l.getPerformanceMeasurement(qe);xt&&(kt.resourceTiming={},kt.resourceTiming[he.source]=JSON.parse(JSON.stringify(xt)))}_e(null,kt)}var xt})}reloadTile(he,_e){const qe=this.loaded;return qe&&qe[he.uid]?super.reloadTile(he,_e):this.loadTile(he,_e)}loadGeoJSON(he,_e){if(he.request)l.getJSON(he.request,_e);else{if("string"!=typeof he.data)return _e(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));try{return _e(null,JSON.parse(he.data))}catch{return _e(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(he,_e){try{_e(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(qe){_e(qe)}}getClusterChildren(he,_e){try{_e(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(qe){_e(qe)}}getClusterLeaves(he,_e){try{_e(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(qe){_e(qe)}}}class Co{constructor(he){this.self=he,this.actor=new l.Actor(he,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=l.getProjection({name:"mercator"}),this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:Or},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(_e,qe)=>{if(this.workerSourceTypes[_e])throw new Error(`Worker source with name "${_e}" already registered.`);this.workerSourceTypes[_e]=qe},this.self.registerRTLTextPlugin=_e=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=_e.applyArabicShaping,l.plugin.processBidirectionalText=_e.processBidirectionalText,l.plugin.processStyledBidirectionalText=_e.processStyledBidirectionalText}}clearCaches(he,_e,qe){delete this.layerIndexes[he],delete this.availableImages[he],delete this.workerSources[he],delete this.demWorkerSources[he],qe()}checkIfReady(he,_e,qe){qe()}setReferrer(he,_e){this.referrer=_e}spriteLoaded(he,_e){this.isSpriteLoaded[he]=_e;for(const qe in this.workerSources[he]){const ut=this.workerSources[he][qe];for(const wt in ut)ut[wt]instanceof l.VectorTileWorkerSource&&(ut[wt].isSpriteLoaded=_e,ut[wt].fire(new l.Event("isSpriteLoaded")))}}setImages(he,_e,qe){this.availableImages[he]=_e;for(const ut in this.workerSources[he]){const wt=this.workerSources[he][ut];for(const Ot in wt)wt[Ot].availableImages=_e}qe()}enableTerrain(he,_e,qe){this.terrain=_e,qe()}setProjection(he,_e){this.projections[he]=l.getProjection(_e)}setLayers(he,_e,qe){this.getLayerIndex(he).replace(_e),qe()}updateLayers(he,_e,qe){this.getLayerIndex(he).update(_e.layers,_e.removedIds),qe()}loadTile(he,_e,qe){const ut=this.enableTerrain?l.extend({enableTerrain:this.terrain},_e):_e;ut.projection=this.projections[he]||this.defaultProjection,this.getWorkerSource(he,_e.type,_e.source).loadTile(ut,qe)}loadDEMTile(he,_e,qe){const ut=this.enableTerrain?l.extend({buildQuadTree:this.terrain},_e):_e;this.getDEMWorkerSource(he,_e.source).loadTile(ut,qe)}reloadTile(he,_e,qe){const ut=this.enableTerrain?l.extend({enableTerrain:this.terrain},_e):_e;ut.projection=this.projections[he]||this.defaultProjection,this.getWorkerSource(he,_e.type,_e.source).reloadTile(ut,qe)}abortTile(he,_e,qe){this.getWorkerSource(he,_e.type,_e.source).abortTile(_e,qe)}removeTile(he,_e,qe){this.getWorkerSource(he,_e.type,_e.source).removeTile(_e,qe)}removeSource(he,_e,qe){if(!this.workerSources[he]||!this.workerSources[he][_e.type]||!this.workerSources[he][_e.type][_e.source])return;const ut=this.workerSources[he][_e.type][_e.source];delete this.workerSources[he][_e.type][_e.source],void 0!==ut.removeSource?ut.removeSource(_e,qe):qe()}loadWorkerSource(he,_e,qe){try{this.self.importScripts(_e.url),qe()}catch(ut){qe(ut.toString())}}syncRTLPluginState(he,_e,qe){try{l.plugin.setState(_e);const ut=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=ut){this.self.importScripts(ut);const wt=l.plugin.isParsed();qe(wt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ut}`),wt)}}catch(ut){qe(ut.toString())}}getAvailableImages(he){let _e=this.availableImages[he];return _e||(_e=[]),_e}getLayerIndex(he){let _e=this.layerIndexes[he];return _e||(_e=this.layerIndexes[he]=new Le),_e}getWorkerSource(he,_e,qe){return this.workerSources[he]||(this.workerSources[he]={}),this.workerSources[he][_e]||(this.workerSources[he][_e]={}),this.workerSources[he][_e][qe]||(this.workerSources[he][_e][qe]=new this.workerSourceTypes[_e]({send:(wt,Ot,kt,xt,Vt,yn)=>{this.actor.send(wt,Ot,kt,he,Vt,yn)},scheduler:this.actor.scheduler},this.getLayerIndex(he),this.getAvailableImages(he),this.isSpriteLoaded[he])),this.workerSources[he][_e][qe]}getDEMWorkerSource(he,_e){return this.demWorkerSources[he]||(this.demWorkerSources[he]={}),this.demWorkerSources[he][_e]||(this.demWorkerSources[he][_e]=new it),this.demWorkerSources[he][_e]}enforceCacheSizeLimit(he,_e){l.enforceCacheSizeLimit(_e)}getWorkerPerformanceMetrics(he,_e,qe){qe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Co(self)),Co}),b(0,function(l){function ve(h,i){if(Array.isArray(h)){if(!Array.isArray(i)||h.length!==i.length)return!1;for(let c=0;c<h.length;c++)if(!ve(h[c],i[c]))return!1;return!0}if("object"==typeof h&&null!==h&&null!==i){if("object"!=typeof i||Object.keys(h).length!==Object.keys(i).length)return!1;for(const c in h)if(!ve(h[c],i[c]))return!1;return!0}return h===i}var Ue=Le;function Le(h){return i=h,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,y,w=new Blob([""],{type:"text/javascript"}),A=URL.createObjectURL(w);try{y=new Worker(A),p=!0}catch{p=!1}return y&&y.terminate(),URL.revokeObjectURL(A),p}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var p=document.createElement("canvas");p.width=p.height=1;var y=p.getContext("2d");if(!y)return!1;var w=y.getImageData(0,0,1,1);return w&&w.width===p.width}()||(void 0===it[c=i&&i.failIfMajorPerformanceCaveat]&&(it[c]=function(p){var y,A,O,$,w=(A=p,O=document.createElement("canvas"),($=Object.create(Le.webGLContextAttributes)).failIfMajorPerformanceCaveat=A,O.getContext("webgl",$)||O.getContext("experimental-webgl",$));if(!w)return!1;try{y=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!y||w.isContextLost())&&(w.shaderSource(y,"void main() {}"),w.compileShader(y),!0===w.getShaderParameter(y,w.COMPILE_STATUS))}(c)),!it[c]||document.documentMode));var i,c}var it={};function et(h,i,c){const p=l.window.document.createElement(h);return void 0!==i&&(p.className=i),c&&c.appendChild(p),p}function xe(h,i,c){const p=l.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const y of Object.keys(i))p.setAttributeNS(null,y,i[y]);return c&&c.appendChild(p),p}Le.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Re=l.window.document&&l.window.document.documentElement.style,Ze=Re&&void 0!==Re.userSelect?"userSelect":"WebkitUserSelect";let tt;function lt(){Re&&Ze&&(tt=Re[Ze],Re[Ze]="none")}function pt(){Re&&Ze&&(Re[Ze]=tt)}function vt(h){h.preventDefault(),h.stopPropagation(),l.window.removeEventListener("click",vt,!0)}function _t(){l.window.addEventListener("click",vt,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",vt,!0)},0)}function nt(h,i){const c=h.getBoundingClientRect();return Se(h,c,i)}function Bt(h,i){const c=h.getBoundingClientRect(),p=[];for(let y=0;y<i.length;y++)p.push(Se(h,c,i[y]));return p}function Ft(h){return void 0!==l.window.InstallTrigger&&2===h.button&&h.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function Se(h,i,c){const p=h.offsetWidth===i.width?1:h.offsetWidth/i.width;return new l.Point((c.clientX-i.left)*p,(c.clientY-i.top)*p)}function Me(h,i){var c=i[0],p=i[1],y=i[2],w=i[3],A=c*w-y*p;return A?(h[0]=w*(A=1/A),h[1]=-p*A,h[2]=-y*A,h[3]=c*A,h):null}function ht(h){const{userImage:i}=h;return!!(i&&i.render&&i.render())&&(h.data.replace(new Uint8Array(i.data.buffer)),!0)}class It extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,c){this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),p=!1),p}_validateStretch(i,c){if(!i)return!0;let p=0;for(const y of i){if(y[0]<p||y[1]<y[0]||c<y[1])return!1;p=y[1]}return!0}_validateContent(i,c){return!(i&&(4!==i.length||i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,c){c.version=this.images[i].version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){const c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,c){let p=!0;if(!this.isLoaded())for(const y of i)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(i,c):this.requestors.push({ids:i,callback:c})}_notify(i,c){const p={};for(const y of i){this.images[y]||this.fire(new l.Event("styleimagemissing",{id:y}));const w=this.images[y];w?p[y]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!(!w.userImage||!w.userImage.render)}:l.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){const c=this.patterns[i],p=this.getImage(i);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},w=new l.ImagePosition(y,p);this.patterns[i]={bin:y,position:w}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(i,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const w in this.patterns)i.push(this.patterns[w].bin);const{w:c,h:p}=l.potpack(i),y=this.atlasImage;y.resize({width:c||1,height:p||1});for(const w in this.patterns){const{bin:A}=this.patterns[w],O=A.x+1,$=A.y+1,W=this.images[w].data,G=W.width,ae=W.height;l.RGBAImage.copy(W,y,{x:0,y:0},{x:O,y:$},{width:G,height:ae}),l.RGBAImage.copy(W,y,{x:0,y:ae-1},{x:O,y:$-1},{width:G,height:1}),l.RGBAImage.copy(W,y,{x:0,y:0},{x:O,y:$+ae},{width:G,height:1}),l.RGBAImage.copy(W,y,{x:G-1,y:0},{x:O-1,y:$},{width:1,height:ae}),l.RGBAImage.copy(W,y,{x:0,y:0},{x:O+G,y:$},{width:1,height:ae})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];ht(p)&&this.updateImage(c,p)}}}const Je=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(h,i){return function([c,p,y]){const w=l.degToRad(p+90),A=l.degToRad(y);return{x:c*Math.cos(w)*Math.sin(A),y:c*Math.sin(w)*Math.sin(A),z:c*Math.cos(A),azimuthal:p,polar:y}}(h.expression.evaluate(i))}interpolate(h,i,c){return{x:l.number(h.x,i.x,c),y:l.number(h.y,i.y,c),z:l.number(h.z,i.z,c),azimuthal:l.number(h.azimuthal,i.azimuthal,c),polar:l.number(h.polar,i.polar,c)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)});class mt extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(Je),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(l.validateLight,i,c))for(const p in i){const y=i[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const Kt=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)});let Ut=class extends l.Evented{constructor(h,i){super(),this._transitionable=new l.Transitionable(Kt),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(h){for(const i in h){const c=h[i];l.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),c):this._transitionable.setValue(i,c)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}};function dn(h,i,c,p){const y=l.smoothstep(45,65,c),[w,A]=on(h,p),O=l.length(i);let $=1-Math.min(1,Math.exp((O-w)/(A-w)*-6));return $*=$*$,$=Math.min(1,1.00747*$),$*y*h.alpha}function on(h,i){const c=.5/Math.tan(.5*i);return[h.range[0]+c,h.range[1]+c]}const Ht=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"high-color":new l.DataConstantProperty(l.spec.fog["high-color"]),"space-color":new l.DataConstantProperty(l.spec.fog["space-color"]),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"]),"star-intensity":new l.DataConstantProperty(l.spec.fog["star-intensity"])});class Yn extends l.Evented{constructor(i,c){super(),this._transitionable=new l.Transitionable(Ht),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const i=this._transform,c="globe"===i.projection.name,p=l.globeToMercatorTransition(i.zoom),y=this.properties.get("range"),w=[.5,3];return{range:c?[l.number(w[0],y[0],p),l.number(w[1],y[1],p)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c={}){if(!this._validate(l.validateFog,i,c)){for(const p of Object.keys(l.spec.fog))i&&void 0===i[p]&&(i[p]=l.spec.fog[p].default);for(const p in i){const y=i[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:l.smoothstep(45,65,i))*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?function(p,y,w){const A=l.MercatorCoordinate.fromLngLat(y),O=w.elevation?w.elevation.getAtPointOrZero(A):0,$=[A.x,A.y,O];return l.transformMat4($,$,w.mercatorFogMatrix),dn(p,$,w.pitch,w._fov)}(this.state,i,c):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?on(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class en{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const p=this.workerPool.acquire(this.id);for(let y=0;y<p.length;y++){const w=new en.Actor(p[y],c,this.id);w.name=`Worker ${y}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,c,p){l.asyncAll(this.actors,(y,w)=>{y.send(i,c,w)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function bt(h,i,c){return i*(l.EXTENT/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}en.Actor=l.Actor;class $e{constructor(i,c,p,y){this.screenBounds=i,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(i,c){let p,y;if(i instanceof l.Point||"number"==typeof i[0]){const w=l.Point.convert(i);p=[w],y=c.isPointAboveHorizon(w)}else{const w=l.Point.convert(i[0]),A=l.Point.convert(i[1]);p=[w,A],y=l.polygonizeBounds(w,A).every(O=>c.isPointAboveHorizon(O))}return new $e(p,c.getCameraPoint(),y,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return l.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],y=l.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),l.bufferConvexPolygon(y,i)}bufferedCameraGeometryGlobe(i){const c=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],y=l.polygonizeBounds(c,p,i),w=this.cameraPoint.clone();switch(3*((w.y>c.y)+(w.y>p.y))+((w.x>c.x)+(w.x>p.x))){case 0:y[0]=w,y[4]=w.clone();break;case 1:y.splice(1,0,w);break;case 2:y[1]=w;break;case 3:y.splice(4,0,w);break;case 5:y.splice(2,0,w);break;case 6:y[3]=w;break;case 7:y.splice(3,0,w);break;case 8:y[2]=w}return y}containsTile(i,c,p,y=0){const w=i.queryPadding/c._pixelsPerMercatorPixel+1,A=p?this._bufferedCameraMercator(w,c):this._bufferedScreenMercator(w,c);let O=i.tileID.wrap+(A.unwrapped?y:0);const $=A.polygon.map(Pe=>l.getTilePoint(i.tileTransform,Pe,O));if(!l.polygonIntersectsBox($,0,0,l.EXTENT,l.EXTENT))return;O=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const W=this.screenGeometryMercator.polygon.map(Pe=>l.getTileVec3(i.tileTransform,Pe,O)),G=W.map(Pe=>new l.Point(Pe[0],Pe[1])),ae=c.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),De=l.getTileVec3(i.tileTransform,ae,O),ye=W.map(Pe=>{const se=l.sub(Pe,Pe,De);return l.normalize(se,se),new l.Ray(De,se)}),Ee=bt(i,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:G,tilespaceRays:ye,bufferedTilespaceGeometry:$,bufferedTilespaceBounds:(be=l.getBounds($),be.min.x=l.clamp(be.min.x,0,l.EXTENT),be.min.y=l.clamp(be.min.y,0,l.EXTENT),be.max.x=l.clamp(be.max.x,0,l.EXTENT),be.max.y=l.clamp(be.max.y,0,l.EXTENT),be),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:Ee};var be}_bufferedScreenMercator(i,c){const p=ze(i);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let y;return y="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),c):{polygon:this.bufferedScreenGeometry(i).map(w=>c.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(i,c){const p=ze(i);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let y;return y="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),c):{polygon:this.bufferedCameraGeometry(i).map(w=>c.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[p]=y,y}}_projectAndResample(i,c){const p=function(w,A){const O=l.multiply([],A.pixelMatrix,A.globeMatrix),$=[0,-l.GLOBE_RADIUS,0,1],W=[0,l.GLOBE_RADIUS,0,1],G=[0,0,0,1];l.transformMat4$1($,$,O),l.transformMat4$1(W,W,O),l.transformMat4$1(G,G,O);const ae=new l.Point($[0]/$[3],$[1]/$[3]),De=new l.Point(W[0]/W[3],W[1]/W[3]),ye=l.polygonContainsPoint(w,ae)&&$[3]<G[3],Ee=l.polygonContainsPoint(w,De)&&W[3]<G[3];if(!ye&&!Ee)return null;const be=function(Dt,Rt,Mt){for(let Wt=1;Wt<Dt.length;Wt++){const On=me(Rt.pointCoordinate3D(Dt[Wt-1]).x),qt=me(Rt.pointCoordinate3D(Dt[Wt]).x);if(Mt<0){if(On<qt)return{idx:Wt,t:-On/(qt-1-On)}}else if(qt<On)return{idx:Wt,t:(1-On)/(qt+1-On)}}return null}(w,A,ye?-1:1);if(!be)return null;const{idx:Pe,t:se}=be;let Ie=Pe>1?ue(w.slice(0,Pe),A):[],We=Pe<w.length?ue(w.slice(Pe),A):[];Ie=Ie.map(Dt=>new l.Point(me(Dt.x),Dt.y)),We=We.map(Dt=>new l.Point(me(Dt.x),Dt.y));const Xe=[...Ie];0===Xe.length&&Xe.push(We[We.length-1]);const ft=l.number(Xe[Xe.length-1].y,(0===We.length?Ie[0]:We[0]).y,se);let Ct;return Ct=ye?[new l.Point(0,ft),new l.Point(0,0),new l.Point(1,0),new l.Point(1,ft)]:[new l.Point(1,ft),new l.Point(1,1),new l.Point(0,1),new l.Point(0,ft)],Xe.push(...Ct),0===We.length?Xe.push(Ie[0]):Xe.push(...We),{polygon:Xe.map(Dt=>new l.MercatorCoordinate(Dt.x,Dt.y)),unwrapped:!1}}(i,c);if(p)return p;const y=function(w,A){let O=!1,$=-1/0,W=0;for(let ae=0;ae<w.length-1;ae++)w[ae].x>$&&($=w[ae].x,W=ae);for(let ae=0;ae<w.length-1;ae++){const De=(W+ae)%(w.length-1),ye=w[De],Ee=w[De+1];Math.abs(ye.x-Ee.x)>.5&&(ye.x<Ee.x?(ye.x+=1,0===De&&(w[w.length-1].x+=1)):(Ee.x+=1,De+1===w.length-1&&(w[0].x+=1)),O=!0)}const G=l.mercatorXfromLng(A.center.lng);return O&&G<Math.abs(G-1)&&w.forEach(ae=>{ae.x-=1}),{polygon:w,unwrapped:O}}(ue(i,c).map(w=>new l.Point(me(w.x),w.y)),c);return{polygon:y.polygon.map(w=>new l.MercatorCoordinate(w.x,w.y)),unwrapped:y.unwrapped}}}function ue(h,i){return l.resample(h,c=>{const p=i.pointCoordinate3D(c);c.x=p.x,c.y=p.y},1/256)}function me(h){return h<0?1+h%1:h%1}function ze(h){return 100*h|0}function ct(h,i,c,p,y){const w=function(A,O){if(A)return y(A);if(O){h.url&&O.tiles&&h.tiles&&delete h.tiles;const $=l.pick(l.extend(O,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&($.vectorLayers=O.vector_layers,$.vectorLayerIds=$.vectorLayers.map(W=>W.id)),$.tiles=i.canonicalizeTileset($,h.url),y(null,$)}};return h.url?l.getJSON(i.transformRequest(i.normalizeSourceURL(h.url,null,c,p),l.ResourceType.Source),w):l.exported.frame(()=>w(null,h))}class Lt{constructor(i,c,p){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const c=Math.pow(2,i.z),p=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*c),y=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*c),w=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*c),A=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*c);return i.x>=p&&i.x<w&&i.y>=y&&i.y<A}}class Gt{constructor(i,c,p){this.context=i;const y=i.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class hn{constructor(i,c,p,y){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.context=i;const w=i.gl;this.buffer=w.createBuffer(),i.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let p=0;p<this.attributes.length;p++){const y=c.attributes[this.attributes[p].name];void 0!==y&&i.enableVertexAttribArray(y)}}setVertexAttribPointers(i,c,p){for(let y=0;y<this.attributes.length;y++){const w=this.attributes[y],A=c.attributes[w.name];void 0!==A&&i.vertexAttribPointer(A,w.components,i[Yt[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class sn{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jt extends sn{getDefault(){return l.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Xt extends sn{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class an extends sn{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class mn extends sn{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Bn extends sn{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class mr extends sn{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class nr extends sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class _r extends sn{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Kn extends sn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class Lr extends sn{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class bn extends sn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class Jr extends sn{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Fi extends sn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class hi extends sn{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class fr extends sn{getDefault(){return l.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Er extends sn{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class yr extends sn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class gr extends sn{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Ci extends sn{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}let qi,Sr=class extends sn{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class Ai extends sn{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class vi extends sn{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Yr extends sn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Do extends sn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Or extends sn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Co extends sn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Qe extends sn{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class he extends sn{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class _e extends sn{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class qe extends sn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class ut extends sn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class wt extends sn{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Ot extends wt{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class kt extends wt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class xt extends kt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Vt{constructor(i,c,p,y){this.context=i,this.width=c,this.height=p;const w=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Ot(i,w),y&&(this.depthAttachment=new kt(i,w))}destroy(){const i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&i.deleteRenderbuffer(p)}i.deleteFramebuffer(this.framebuffer)}}class yn{constructor(i,c=!1){if(this.gl=i,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const p=i;this.extVertexArrayObject={createVertexArrayOES:p.createVertexArray.bind(i),deleteVertexArrayOES:p.deleteVertexArray.bind(i),bindVertexArrayOES:p.bindVertexArray.bind(i)}}this.clearColor=new jt(this),this.clearDepth=new Xt(this),this.clearStencil=new an(this),this.colorMask=new mn(this),this.depthMask=new Bn(this),this.stencilMask=new mr(this),this.stencilFunc=new nr(this),this.stencilOp=new _r(this),this.stencilTest=new Kn(this),this.depthRange=new Lr(this),this.depthTest=new bn(this),this.depthFunc=new Jr(this),this.blend=new Fi(this),this.blendFunc=new hi(this),this.blendColor=new fr(this),this.blendEquation=new Er(this),this.cullFace=new yr(this),this.cullFaceSide=new gr(this),this.frontFace=new Ci(this),this.program=new Sr(this),this.activeTexture=new Ai(this),this.viewport=new vi(this),this.bindFramebuffer=new Yr(this),this.bindRenderbuffer=new Do(this),this.bindTexture=new Or(this),this.bindVertexBuffer=new Co(this),this.bindElementBuffer=new Qe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new he(this),this.pixelStoreUnpack=new _e(this),this.pixelStoreUnpackPremultiplyAlpha=new qe(this),this.pixelStoreUnpackFlipY=new ut(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=i.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&i.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||i.getExtension("OES_standard_derivatives"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new Gt(this,i,c)}createVertexBuffer(i,c,p){return new hn(this,i,c,p)}createRenderbuffer(i,c,p){const y=this.gl,w=y.createRenderbuffer();return this.bindRenderbuffer.set(w),y.renderbufferStorage(y.RENDERBUFFER,i,c,p),this.bindRenderbuffer.set(null),w}createFramebuffer(i,c,p){return new Vt(this,i,c,p)}clear({color:i,depth:c,stencil:p}){const y=this.gl;let w=0;i&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==p&&(w|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(w)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){ve(i.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Be extends l.Evented{constructor(i,c,p,y){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(c,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(i){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=ct(this._options,this.map._requestManager,c,p,(y,w)=>{this._tileJSONRequest=null,this._loaded=!0,y?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),p&&2!==p.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new l.ErrorEvent(y))):w&&(l.extend(this,w),w.bounds&&(this.tileBounds=new Lt(w.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(y)})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}loadTile(i,c){const p=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(p,l.ResourceType.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,i.actor&&"expired"!==i.state)"loading"===i.state?i.reloadCallback=c:i.request=i.actor.send("reloadTile",y,w.bind(this));else if(i.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",y,w.bind(this),void 0,!0);else{const A=l.loadVectorTile.call({deduped:this._deduped},y,(O,$)=>{O||!$?w.call(this,O):(y.data={cacheControl:$.cacheControl,expires:$.expires,rawData:$.rawData.slice(0)},i.actor&&i.actor.send("loadTile",y,w.bind(this),void 0,!0))},!0);i.request={cancel:A}}function w(A,O){return delete i.request,i.aborted?c(null):A&&404!==A.status?c(A):(O&&O.resourceTiming&&(i.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&i.setExpiryData(O),i.loadVectorData(O,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id})}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class le extends l.Evented{constructor(i,c,p,y){super(),this.id=i,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},c),l.extend(this,l.pick(c,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,null,null,(c,p)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):p&&(l.extend(this,p),p.bounds&&(this.tileBounds=new Lt(p.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(p.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(c)})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const p=l.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);i.request=l.getImage(this.map._requestManager.transformRequest(y,l.ResourceType.Tile),(w,A,O,$)=>(delete i.request,i.aborted?(i.state="unloaded",c(null)):w?(i.state="errored",c(w)):A?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:O,expires:$}),i.setTexture(A,this.map.painter),i.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(i,c,p){i.setTexture(c,p)}static unloadTileData(i,c){i.texture&&c.saveTileTexture(i.texture)}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c()}unloadTile(i,c){i.texture&&this.map.painter.saveTileTexture(i.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function de(h,i,c,p,y,w,A,O){const $=[h,c,y,i,p,w,1,1,1],W=[A,O,1],G=l.adjoint([],$),[ae,De,ye]=l.transformMat3(W,W,l.transpose(G,G));return l.multiply$1($,[ae,0,0,0,De,0,0,0,ye],$)}class Ne extends l.Evented{constructor(i,c,p,y){super(),this.id=i,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=c,this._dirty=!1}load(i,c){this._loaded=c||!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(p,y)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new l.ErrorEvent(p));else if(y){const{HTMLImageElement:w}=l.window;this.image=y instanceof w?l.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const c=i.map(l.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let y=1/0,w=1/0,A=-1/0,O=-1/0;for(const ae of p)y=Math.min(y,ae.x),w=Math.min(w,ae.y),A=Math.max(A,ae.x),O=Math.max(O,ae.y);const $=Math.max(A-y,O-w),W=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),G=Math.pow(2,W);return new l.CanonicalTileID(W,Math.floor((y+A)/2*G),Math.floor((w+O)/2*G))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const $ in this.tiles){const W=this.tiles[$];"loaded"!==W.state&&(W.state="loaded",W.texture=this.texture)}if(this._boundsArray)return;const c=l.tileTransform(this.tileID,this.map.transform.projection),[p,y,w,A]=this.coordinates.map($=>{const W=c.projection.project($[0],$[1]);return l.getTilePoint(c,W)._round()});this.perspectiveTransform=function($,W,G,ae,De,ye,Ee,be,Pe,se){const Ie=de(0,0,$,0,0,W,$,W),We=de(G,ae,De,ye,Ee,be,Pe,se);return l.multiply$1(We,l.adjoint(Ie,Ie),We),[We[6]/We[8]*$/l.EXTENT,We[7]/We[8]*W/l.EXTENT]}(this.width,this.height,p.x,p.y,y.x,y.y,A.x,A.y,w.x,w.y);const O=this._boundsArray=new l.StructArrayLayout4i8;O.emplaceBack(p.x,p.y,0,0),O.emplaceBack(y.x,y.y,l.EXTENT,0),O.emplaceBack(A.x,A.y,0,l.EXTENT),O.emplaceBack(w.x,w.y,l.EXTENT,l.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(O,l.boundsAttributes.members),this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,c=i.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new l.Texture(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(i)}loadTile(i,c){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},c(null)):(i.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const pe={vector:Be,raster:le,"raster-dem":class extends le{constructor(h,i,c,p){super(h,i,c,p),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(h,i){const c=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,w){y&&(h.state="errored",i(y)),w&&(h.dem=w,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",i(null))}h.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),function(y,w,A,O){if(delete h.request,h.aborted)h.state="unloaded",i(null);else if(y)h.state="errored",i(y);else if(w){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:A,expires:O});const $=l.window.ImageBitmap&&w instanceof l.window.ImageBitmap&&(null==qi&&(qi=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof l.window.createImageBitmap),qi),W=1-(w.width-l.prevPowerOfTwo(w.width))/2;W<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const G=$?w:l.exported.getImageData(w,W),ae={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:G,encoding:this.encoding,padding:W};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",ae,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const i=h.canonical,c=Math.pow(2,i.z),p=(i.x-1+c)%c,y=0===i.x?h.wrap-1:h.wrap,w=(i.x+1+c)%c,A=i.x+1===c?h.wrap+1:h.wrap,O={};return O[new l.OverscaledTileID(h.overscaledZ,y,i.z,p,i.y).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,A,i.z,w,i.y).key]={backfilled:!1},i.y>0&&(O[new l.OverscaledTileID(h.overscaledZ,y,i.z,p,i.y-1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,h.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,A,i.z,w,i.y-1).key]={backfilled:!1}),i.y+1<c&&(O[new l.OverscaledTileID(h.overscaledZ,y,i.z,p,i.y+1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,h.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,A,i.z,w,i.y+1).key]={backfilled:!1}),O}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends l.Evented{constructor(h,i,c,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=i.data,this._options=l.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const y=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*y,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*y,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:l.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*y,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},i),this}getClusterChildren(h,i){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},i),this}getClusterLeaves(h,i,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:i,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=l.extend({},this.workerOptions),i=this._data;"string"==typeof i?(h.request=this.map._requestManager.transformRequest(l.exported.resolveURL(i),l.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new l.ErrorEvent(c));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y.resourceTiming=p.resourceTiming[this.id]),this.fire(new l.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,i){const c=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(c,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,y)=>(delete h.request,h.unloadVectorData(),h.aborted?i(null):p?i(p):(h.loadVectorData(y,this.map.painter,"reloadTile"===c),i(null))),void 0,"loadTile"===c)}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ne{constructor(h,i,c,p){super(h,i,c,p),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const i of h.urls)this.urls.push(this.map._requestManager.transformRequest(i,l.ResourceType.Source).url);l.getVideo(this.urls,(i,c)=>{this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const i=this.video.seekable;h<i.start(0)||h>i.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const h=this.map.painter.context,i=h.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(h,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ne,canvas:class extends Ne{constructor(h,i,c,p){super(h,i,c,p),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(y=>!Array.isArray(y)||2!==y.length||y.some(w=>"number"!=typeof w))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends l.Evented{constructor(h,i,c,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=i,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new l.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new l.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Lt(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),l.extend(this,l.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return l.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:i,y:c,z:p}=h.canonical;return this._implementation.hasTile({x:i,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,i){const{x:c,y:p,z:y}=h.tileID.canonical,w=new l.window.AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:c,y:p,z:y},{signal:w.signal})).then(function(A){return delete h.request,h.aborted?(h.state="unloaded",i(null)):void 0===A?(h.state="errored",i(null)):null===A?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",i(null)):(O=A)instanceof l.window.ImageData||O instanceof l.window.HTMLCanvasElement||O instanceof l.window.ImageBitmap||O instanceof l.window.HTMLImageElement?(this.loadTileData(h,A),h.state="loaded",void i(null)):(h.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(A=>{20!==A.code&&(h.state="errored",i(A))}),h.request.cancel=()=>w.abort()}loadTileData(h,i){le.loadTileData(h,i,this._map.painter)}unloadTileData(h){le.unloadTileData(h,this._map.painter)}unloadTile(h,i){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:c,y:p,z:y}=h.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:y})}i()}abortTile(h,i){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ot=function(h,i,c,p){const y=new pe[i.type](h,i,c,p);if(y.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${y.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],y),y};function $t(h,i){const c=l.identity([]);return l.scale(c,c,[.5*h.width,.5*-h.height,1]),l.translate(c,c,[1,-1,0]),l.multiply(c,c,h.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(c)}function vn(h,i,c,p,y,w,A,O=!1){const $=h.tilesIn(p,A,O);$.sort(Wn);const W=[];for(const ae of $)W.push({wrappedTileID:ae.tile.tileID.wrapped().key,queryResults:ae.tile.queryRenderedFeatures(i,c,h._state,ae,y,w,$t(h.transform,ae.tile.tileID),O)});const G=function(ae){const De={},ye={};for(const Ee of ae){const be=Ee.queryResults,Pe=Ee.wrappedTileID,se=ye[Pe]=ye[Pe]||{};for(const Ie in be){const We=be[Ie],Xe=se[Ie]=se[Ie]||{},ft=De[Ie]=De[Ie]||[];for(const Ct of We)Xe[Ct.featureIndex]||(Xe[Ct.featureIndex]=!0,ft.push(Ct))}}return De}(W);for(const ae in G)G[ae].forEach(De=>{const ye=De.feature,Ee=ye.layer;Ee&&"background"!==Ee.type&&"sky"!==Ee.type&&(ye.source=Ee.source,Ee["source-layer"]&&(ye.sourceLayer=Ee["source-layer"]),ye.state=void 0!==ye.id?h.getFeatureState(Ee["source-layer"],ye.id):{})});return G}function Xn(h,i){const c=h.getRenderableIds().map(w=>h.getTileByID(w)),p=[],y={};for(let w=0;w<c.length;w++){const A=c[w],O=A.tileID.canonical.key;y[O]||(y[O]=!0,A.querySourceFeatures(p,i))}return p}function Wn(h,i){const c=h.tileID,p=i.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function hr(){return null!=zi.workerClass?new zi.workerClass:new l.window.Worker(zi.workerUrl)}const vr="mapboxgl_preloaded_worker_pool";class Wr{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Wr.workerCount;)this.workers.push(new hr);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[vr]}numActive(){return Object.keys(this.active).length}}let ni;function ro(){return ni||(ni=new Wr),ni}function Bo(h,i){const c={};for(const p in h)"ref"!==p&&(c[p]=h[p]);return l.refProperties.forEach(p=>{p in i&&(c[p]=i[p])}),c}function rn(h){h=h.slice();const i=Object.create(null);for(let c=0;c<h.length;c++)i[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=Bo(h[c],i[h[c].ref]));return h}Wr.workerCount=2;const Tt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Dn(h,i,c){c.push({command:Tt.addSource,args:[h,i[h]]})}function ur(h,i,c){i.push({command:Tt.removeSource,args:[h]}),c[h]=!0}function Zn(h,i,c,p){ur(h,c,p),Dn(h,i,c)}function Rr(h,i,c){let p;for(p in h[c])if(h[c].hasOwnProperty(p)&&"data"!==p&&!ve(h[c][p],i[c][p]))return!1;for(p in i[c])if(i[c].hasOwnProperty(p)&&"data"!==p&&!ve(h[c][p],i[c][p]))return!1;return!0}function Fr(h,i,c,p,y,w){let A;for(A in i=i||{},h=h||{})h.hasOwnProperty(A)&&(ve(h[A],i[A])||c.push({command:w,args:[p,A,i[A],y]}));for(A in i)i.hasOwnProperty(A)&&!h.hasOwnProperty(A)&&(ve(h[A],i[A])||c.push({command:w,args:[p,A,i[A],y]}))}function fi(h){return h.id}function Ti(h,i){return h[i.id]=i,h}class Qr{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=l.clamp(i,0,1);let c=1,p=this._distances[c];const y=i*this.paddedLength+this.padding;for(;p<y&&c<this._distances.length;)p=this._distances[++c];const w=c-1,A=this._distances[w],O=p-A,$=O>0?(y-A)/O:0;return this.points[w].mult(1-$).add(this.points[c].mult($))}}class ui{constructor(i,c,p){const y=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(c/p);for(let A=0;A<this.xCellCount*this.yCellCount;A++)y.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,p,y,w){this._forEachCell(c,p,y,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(w)}insertCircle(i,c,p,y){this._forEachCell(c-y,p-y,c+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(p),this.circles.push(y)}_insertBoxCell(i,c,p,y,w,A){this.boxCells[w].push(A)}_insertCircleCell(i,c,p,y,w,A){this.circleCells[w].push(A)}_query(i,c,p,y,w,A){if(p<0||i>this.width||y<0||c>this.height)return!w&&[];const O=[];if(i<=0&&c<=0&&this.width<=p&&this.height<=y){if(w)return!0;for(let $=0;$<this.boxKeys.length;$++)O.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const W=this.circles[3*$],G=this.circles[3*$+1],ae=this.circles[3*$+2];O.push({key:this.circleKeys[$],x1:W-ae,y1:G-ae,x2:W+ae,y2:G+ae})}return A?O.filter(A):O}return this._forEachCell(i,c,p,y,this._queryCell,O,{hitTest:w,seenUids:{box:{},circle:{}}},A),w?O.length>0:O}_queryCircle(i,c,p,y,w){const A=i-p,O=i+p,$=c-p,W=c+p;if(O<0||A>this.width||W<0||$>this.height)return!y&&[];const G=[];return this._forEachCell(A,$,O,W,this._queryCellCircle,G,{hitTest:y,circle:{x:i,y:c,radius:p},seenUids:{box:{},circle:{}}},w),y?G.length>0:G}query(i,c,p,y,w){return this._query(i,c,p,y,!1,w)}hitTest(i,c,p,y,w){return this._query(i,c,p,y,!0,w)}hitTestCircle(i,c,p,y){return this._queryCircle(i,c,p,!0,y)}_queryCell(i,c,p,y,w,A,O,$){const W=O.seenUids,G=this.boxCells[w];if(null!==G){const De=this.bboxes;for(const ye of G)if(!W.box[ye]){W.box[ye]=!0;const Ee=4*ye;if(i<=De[Ee+2]&&c<=De[Ee+3]&&p>=De[Ee+0]&&y>=De[Ee+1]&&(!$||$(this.boxKeys[ye]))){if(O.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[ye],x1:De[Ee],y1:De[Ee+1],x2:De[Ee+2],y2:De[Ee+3]})}}}const ae=this.circleCells[w];if(null!==ae){const De=this.circles;for(const ye of ae)if(!W.circle[ye]){W.circle[ye]=!0;const Ee=3*ye;if(this._circleAndRectCollide(De[Ee],De[Ee+1],De[Ee+2],i,c,p,y)&&(!$||$(this.circleKeys[ye]))){if(O.hitTest)return A.push(!0),!0;{const be=De[Ee],Pe=De[Ee+1],se=De[Ee+2];A.push({key:this.circleKeys[ye],x1:be-se,y1:Pe-se,x2:be+se,y2:Pe+se})}}}}}_queryCellCircle(i,c,p,y,w,A,O,$){const W=O.circle,G=O.seenUids,ae=this.boxCells[w];if(null!==ae){const ye=this.bboxes;for(const Ee of ae)if(!G.box[Ee]){G.box[Ee]=!0;const be=4*Ee;if(this._circleAndRectCollide(W.x,W.y,W.radius,ye[be+0],ye[be+1],ye[be+2],ye[be+3])&&(!$||$(this.boxKeys[Ee])))return A.push(!0),!0}}const De=this.circleCells[w];if(null!==De){const ye=this.circles;for(const Ee of De)if(!G.circle[Ee]){G.circle[Ee]=!0;const be=3*Ee;if(this._circlesCollide(ye[be],ye[be+1],ye[be+2],W.x,W.y,W.radius)&&(!$||$(this.circleKeys[Ee])))return A.push(!0),!0}}}_forEachCell(i,c,p,y,w,A,O,$){const W=this._convertToXCellCoord(i),G=this._convertToYCellCoord(c),ae=this._convertToXCellCoord(p),De=this._convertToYCellCoord(y);for(let ye=W;ye<=ae;ye++)for(let Ee=G;Ee<=De;Ee++)if(w.call(this,i,c,p,y,this.xCellCount*Ee+ye,A,O,$))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,p,y,w,A){const O=y-i,$=w-c,W=p+A;return W*W>O*O+$*$}_circleAndRectCollide(i,c,p,y,w,A,O){const $=(A-y)/2,W=Math.abs(i-(y+$));if(W>$+p)return!1;const G=(O-w)/2,ae=Math.abs(c-(w+G));if(ae>G+p)return!1;if(W<=$||ae<=G)return!0;const De=W-$,ye=ae-G;return De*De+ye*ye<=p*p}}const qr={unknown:0,flipRequired:1,flipNotRequired:2},Es=Math.tan(85*Math.PI/180);function cn(h,i,c,p,y,w,A){const O=l.create();if(c)if("globe"===w.name){const $=l.calculateGlobeLabelMatrix(y,i);l.multiply(O,O,$)}else{const $=Me([],A);O[0]=$[0],O[1]=$[1],O[4]=$[2],O[5]=$[3],p||l.rotateZ(O,O,y.angle)}else l.multiply(O,y.labelPlaneMatrix,h);return O}function io(h,i,c,p,y,w,A){const O=cn(h,i,c,p,y,w,A);return"globe"===w.name&&c||(O[2]=O[6]=O[10]=O[14]=0),O}function wi(h,i,c,p,y,w,A){if(c){if("globe"===w.name){const O=cn(h,i,c,p,y,w,A);return l.invert(O,O),l.multiply(O,h,O),O}{const O=l.clone(h),$=l.identity([]);return $[0]=A[0],$[1]=A[1],$[4]=A[2],$[5]=A[3],l.multiply(O,O,$),p||l.rotateZ(O,O,-y.angle),O}}return y.glCoordMatrix}function oi(h,i,c,p){const y=[h,i,c,1];c?l.transformMat4$1(y,y,p):Ve(y,y,p);const w=y[3];return y[0]/=w,y[1]/=w,y[2]/=w,y}function Yo(h,i){return Math.min(.5+h/i*.5,1.5)}function Vi(h,i){const c=h[0]/h[3],p=h[1]/h[3];return c>=-i[0]&&c<=i[0]&&p>=-i[1]&&p<=i[1]}function ss(h,i,c,p,y,w,A,O,$,W){const G=c.transform,ae=p?h.textSizeData:h.iconSizeData,De=l.evaluateSizeForZoom(ae,c.transform.zoom),ye="globe"===G.projection.name,Ee=[256/c.width*2+1,256/c.height*2+1],be=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;be.clear();let Pe=null;ye&&(Pe=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const se=h.lineVertexArray,Ie=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,We=c.transform.width/c.transform.height;let Xe,ft=!1;for(let Ct=0;Ct<Ie.length;Ct++){const Dt=Ie.get(Ct),{numGlyphs:Rt,writingMode:Mt}=Dt;if(Mt!==l.WritingMode.vertical||ft||Xe===l.WritingMode.horizontal||(ft=!0),Xe=Mt,(Dt.hidden||Mt===l.WritingMode.vertical)&&!ft){Ce(Rt,be);continue}ft=!1;const Wt=new l.Point(Dt.tileAnchorX,Dt.tileAnchorY);let{x:On,y:qt,z:Tn}=G.projection.projectTilePoint(Wt.x,Wt.y,W.canonical);if($){const[Xr,dr,Ur]=$(Wt);On+=Xr,qt+=dr,Tn+=Ur}const un=[On,qt,Tn,1];if(l.transformMat4$1(un,un,i),!Vi(un,Ee)){Ce(Rt,be);continue}const Fn=Yo(c.transform.cameraToCenterDistance,un[3]),nn=l.evaluateSizeForFeature(ae,De,Dt),En=A?nn/Fn:nn*Fn,zn=oi(On,qt,Tn,y);if(zn[3]<=0){Ce(Rt,be);continue}let Rn={};const Vn=A?null:$,Ar=qn(Dt,En,!1,O,i,y,w,h.glyphOffsetArray,se,be,Pe,zn,Wt,Rn,We,Vn,G.projection,W,A);ft=Ar.useVertical,Vn&&Ar.needsFlipping&&(Rn={}),(Ar.notEnoughRoom||ft||Ar.needsFlipping&&qn(Dt,En,!0,O,i,y,w,h.glyphOffsetArray,se,be,Pe,zn,Wt,Rn,We,Vn,G.projection,W,A).notEnoughRoom)&&Ce(Rt,be)}p?(h.text.dynamicLayoutVertexBuffer.updateData(be),Pe&&h.text.globeExtVertexBuffer.updateData(Pe)):(h.icon.dynamicLayoutVertexBuffer.updateData(be),Pe&&h.icon.globeExtVertexBuffer.updateData(Pe))}function Po(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be){const{lineStartIndex:Pe,glyphStartIndex:se,segment:Ie}=O,We=se+O.numGlyphs,Xe=Pe+O.lineLength,ft=i.getoffsetX(se),Ct=i.getoffsetX(We-1),Dt=je(h*ft,c,p,y,w,A,Ie,Pe,Xe,$,W,G,ae,De,!0,ye,Ee,be);if(!Dt)return null;const Rt=je(h*Ct,c,p,y,w,A,Ie,Pe,Xe,$,W,G,ae,De,!0,ye,Ee,be);return Rt?{first:Dt,last:Rt}:null}function No(h,i,c,p){return h===l.WritingMode.horizontal&&Math.abs(p)>Math.abs(c)?{useVertical:!0}:h===l.WritingMode.vertical?p>0?{needsFlipping:!0}:null:i!==qr.unknown&&(0===(y=c)||Math.abs(p/y)>Es)?i===qr.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var y}function qn(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be,Pe,se,Ie){const We=i/24,Xe=h.lineOffsetX*We,ft=h.lineOffsetY*We,{lineStartIndex:Ct,glyphStartIndex:Dt,numGlyphs:Rt,segment:Mt,writingMode:Wt,flipState:On}=h,qt=Ct+h.lineLength,Tn=un=>{if(G){const[zn,Rn,Vn]=un.up,Ar=W.length;l.updateGlobeVertexNormal(G,Ar+0,zn,Rn,Vn),l.updateGlobeVertexNormal(G,Ar+1,zn,Rn,Vn),l.updateGlobeVertexNormal(G,Ar+2,zn,Rn,Vn),l.updateGlobeVertexNormal(G,Ar+3,zn,Rn,Vn)}const[Fn,nn,En]=un.point;l.addDynamicAttributes(W,Fn,nn,En,un.angle)};if(Rt>1){const un=Po(We,O,Xe,ft,c,ae,De,h,$,w,ye,be,!1,Pe,se,Ie);if(!un)return{notEnoughRoom:!0};if(p&&!c){let[Fn,nn,En]=un.first.point,[zn,Rn,Vn]=un.last.point;[Fn,nn]=oi(Fn,nn,En,A),[zn,Rn]=oi(zn,Rn,Vn,A);const Ar=No(Wt,On,(zn-Fn)*Ee,Rn-nn);if(h.flipState=Ar&&Ar.needsFlipping?qr.flipRequired:qr.flipNotRequired,Ar)return Ar}Tn(un.first);for(let Fn=Dt+1;Fn<Dt+Rt-1;Fn++){const nn=je(We*O.getoffsetX(Fn),Xe,ft,c,ae,De,Mt,Ct,qt,$,w,ye,be,!1,!1,Pe,se,Ie);if(!nn)return W.length-=4*(Fn-Dt),{notEnoughRoom:!0};Tn(nn)}Tn(un.last)}else{if(p&&!c){const Fn=oi(De.x,De.y,0,y),nn=Ct+Mt+1,En=new l.Point($.getx(nn),$.gety(nn)),zn=oi(En.x,En.y,0,y),Rn=zn[3]>0?zn:fe(De,En,Fn,1,y,void 0,Pe,se.canonical),Vn=No(Wt,On,(Rn[0]-Fn[0])*Ee,Rn[1]-Fn[1]);if(h.flipState=Vn&&Vn.needsFlipping?qr.flipRequired:qr.flipNotRequired,Vn)return Vn}const un=je(We*O.getoffsetX(Dt),Xe,ft,c,ae,De,Mt,Ct,qt,$,w,ye,be,!1,!1,Pe,se,Ie);if(!un)return{notEnoughRoom:!0};Tn(un)}return{}}function Cr(h,i,c,p,y){const{x:w,y:A,z:O}=p.projectTilePoint(h.x,h.y,i);if(!y)return oi(w,A,O,c);const[$,W,G]=y(h);return oi(w+$,A+W,O+G,c)}function fe(h,i,c,p,y,w,A,O){const $=Cr(h.sub(i)._unit()._add(h),O,y,A,w);return l.sub($,c,$),l.normalize($,$),l.scaleAndAdd($,c,$,p)}function je(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be,Pe,se){const Ie=p?h-i:h+i;let We=Ie>0?1:-1,Xe=0;p&&(We*=-1,Xe=Math.PI),We<0&&(Xe+=Math.PI);let ft=O+A+(We>0?0:1)|0,Ct=y,Dt=y,Rt=0,Mt=0;const Wt=Math.abs(Ie),On=[],qt=[];let Tn=w,un=Tn;const Fn=()=>fe(un,Tn,Dt,Wt-Rt+1,G,De,be,Pe.canonical);for(;Rt+Mt<=Wt;){if(ft+=We,ft<O||ft>=$)return null;if(Dt=Ct,un=Tn,On.push(Dt),ye&&qt.push(un),Tn=new l.Point(W.getx(ft),W.gety(ft)),Ct=ae[ft],!Ct){const Ur=Cr(Tn,Pe.canonical,G,be,De);Ct=Ur[3]>0?ae[ft]=Ur:Fn()}Rt+=Mt,Mt=l.distance(Dt,Ct)}Ee&&De&&(ae[ft]&&(Ct=Fn(),Mt=l.distance(Dt,Ct)),ae[ft]=Ct);const nn=(Wt-Rt)/Mt,En=Tn.sub(un)._mult(nn)._add(un),zn=l.sub([],Ct,Dt),Rn=l.scaleAndAdd([],Dt,zn,nn);let Vn=[0,0,1],Ar=zn[0],Xr=zn[1];if(se&&(Vn=be.upVector(Pe.canonical,En.x,En.y),0!==Vn[0]||0!==Vn[1]||1!==Vn[2])){const Ur=[Vn[2],0,-Vn[0]],gi=l.cross([],Vn,Ur);l.normalize(Ur,Ur),l.normalize(gi,gi),Ar=l.dot(zn,Ur),Xr=l.dot(zn,gi)}if(c){const Ur=l.cross([],Vn,zn);l.normalize(Ur,Ur),l.scaleAndAdd(Rn,Rn,Ur,c*We)}const dr=Xe+Math.atan2(Xr,Ar);return On.push(Rn),ye&&qt.push(En),{point:Rn,angle:dr,path:On,tilePath:qt,up:Vn}}function Ce(h,i){const c=i.length,p=c+4*h;i.resize(p),i.float32.fill(-1/0,4*c,4*p)}function Ve(h,i,c){const p=i[0],y=i[1];return h[0]=c[0]*p+c[4]*y+c[12],h[1]=c[1]*p+c[5]*y+c[13],h[3]=c[3]*p+c[7]*y+c[15],h}const St=100;class zt{constructor(i,c,p=new ui(i.width+200,i.height+200,25),y=new ui(i.width+200,i.height+200,25)){this.transform=i,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+St,this.screenBottomBoundary=i.height+St,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,p,y,w,A,O,$){let W=p.projectedAnchorX,G=p.projectedAnchorY,ae=p.projectedAnchorZ;const De=p.elevation,ye=p.tileID,Ee=i.getProjection();if(De&&ye){const[Ct,Dt,Rt]=Ee.upVector(ye.canonical,p.tileAnchorX,p.tileAnchorY),Mt=Ee.upVectorScale(ye.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=Ct*De*Mt,G+=Dt*De*Mt,ae+=Rt*De*Mt}const be=this.projectAndGetPerspectiveRatio(O,W,G,ae,p.tileID,"globe"===Ee.name||!!De||this.transform.pitch>0,Ee),Pe=A*be.perspectiveRatio,se=(p.x1*c+y.x-p.padding)*Pe+be.point.x,Ie=(p.y1*c+y.y-p.padding)*Pe+be.point.y,We=(p.x2*c+y.x+p.padding)*Pe+be.point.x,Xe=(p.y2*c+y.y+p.padding)*Pe+be.point.y,ft=be.perspectiveRatio<=.55||be.occluded;return!this.isInsideGrid(se,Ie,We,Xe)||!w&&this.grid.hitTest(se,Ie,We,Xe,$)||ft?{box:[],offscreen:!1,occluded:be.occluded}:{box:[se,Ie,We,Xe],offscreen:this.isOffscreen(se,Ie,We,Xe),occluded:!1}}placeCollisionCircles(i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be){const Pe=[],se=this.transform.elevation,Ie=i.getProjection(),We=se?se.getAtTileOffsetFunc(be,this.transform.center.lat,this.transform.worldSize,Ie):null,Xe=new l.Point(p.tileAnchorX,p.tileAnchorY);let{x:ft,y:Ct,z:Dt}=Ie.projectTilePoint(Xe.x,Xe.y,be.canonical);if(We){const[En,zn,Rn]=We(Xe);ft+=En,Ct+=zn,Dt+=Rn}const Rt="globe"===Ie.name,Mt=this.projectAndGetPerspectiveRatio(O,ft,Ct,Dt,be,Rt||!!se||this.transform.pitch>0,Ie),{perspectiveRatio:Wt}=Mt,On=(ae?A/Wt:A*Wt)/l.ONE_EM,qt=oi(ft,Ct,Dt,$),Tn=Mt.signedDistanceFromCamera>0?Po(On,w,p.lineOffsetX*On,p.lineOffsetY*On,!1,qt,Xe,p,y,$,{},se&&!ae?We:null,ae&&!!se,Ie,be,ae):null;let un=!1,Fn=!1,nn=!0;if(Tn&&!Mt.occluded){const En=.5*ye*Wt+Ee,zn=new l.Point(-100,-100),Rn=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),Vn=new Qr,{first:Ar,last:Xr}=Tn,dr=Ar.path.length;let Ur=[];for(let br=dr-1;br>=1;br--)Ur.push(Ar.path[br]);for(let br=1;br<Xr.path.length;br++)Ur.push(Xr.path[br]);const gi=2.5*En;W&&(Ur=Ur.map(([br,Xi,_i],fo)=>(We&&!Rt&&(_i=We(fo<dr-1?Ar.tilePath[dr-1-fo]:Xr.tilePath[fo-dr+2])[2]),oi(br,Xi,_i,W))),Ur.some(br=>br[3]<=0)&&(Ur=[]));let pi=[];if(Ur.length>0){let br=1/0,Xi=-1/0,_i=1/0,fo=-1/0;for(const lo of Ur)br=Math.min(br,lo[0]),_i=Math.min(_i,lo[1]),Xi=Math.max(Xi,lo[0]),fo=Math.max(fo,lo[1]);Xi>=zn.x&&br<=Rn.x&&fo>=zn.y&&_i<=Rn.y&&(pi=[Ur.map(lo=>new l.Point(lo[0],lo[1]))],(br<zn.x||Xi>Rn.x||_i<zn.y||fo>Rn.y)&&(pi=l.clipLine(pi,zn.x,zn.y,Rn.x,Rn.y)))}for(const br of pi){Vn.reset(br,.25*En);let Xi=0;Xi=Vn.length<=.5*En?1:Math.ceil(Vn.paddedLength/gi)+1;for(let _i=0;_i<Xi;_i++){const fo=_i/Math.max(Xi-1,1),lo=Vn.lerp(fo),Ns=lo.x+St,zs=lo.y+St;Pe.push(Ns,zs,En,0);const Sa=Ns-En,Ua=zs-En,co=Ns+En,ji=zs+En;if(nn=nn&&this.isOffscreen(Sa,Ua,co,ji),Fn=Fn||this.isInsideGrid(Sa,Ua,co,ji),!c&&this.grid.hitTestCircle(Ns,zs,En,De)&&(un=!0,!G))return{circles:[],offscreen:!1,collisionDetected:un,occluded:!1}}}}return{circles:!G&&un||!Fn?[]:Pe,offscreen:nn,collisionDetected:un,occluded:Mt.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let p=1/0,y=1/0,w=-1/0,A=-1/0;for(const G of i){const ae=new l.Point(G.x+St,G.y+St);p=Math.min(p,ae.x),y=Math.min(y,ae.y),w=Math.max(w,ae.x),A=Math.max(A,ae.y),c.push(ae)}const O=this.grid.query(p,y,w,A).concat(this.ignoredGrid.query(p,y,w,A)),$={},W={};for(const G of O){const ae=G.key;if(void 0===$[ae.bucketInstanceId]&&($[ae.bucketInstanceId]={}),$[ae.bucketInstanceId][ae.featureIndex])continue;const De=[new l.Point(G.x1,G.y1),new l.Point(G.x2,G.y1),new l.Point(G.x2,G.y2),new l.Point(G.x1,G.y2)];l.polygonIntersectsPolygon(c,De)&&($[ae.bucketInstanceId][ae.featureIndex]=!0,void 0===W[ae.bucketInstanceId]&&(W[ae.bucketInstanceId]=[]),W[ae.bucketInstanceId].push(ae.featureIndex))}return W}insertCollisionBox(i,c,p,y,w){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:w},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,p,y,w){const A=c?this.ignoredGrid:this.grid,O={bucketInstanceId:p,featureIndex:y,collisionGroupID:w};for(let $=0;$<i.length;$+=4)A.insertCircle(O,i[$],i[$+1],i[$+2])}projectAndGetPerspectiveRatio(i,c,p,y,w,A,O){const $=[c,p,y,1];let W=!1;y||this.transform.pitch>0?(l.transformMat4$1($,$,i),this.fogState&&w&&"globe"!==O.name&&(W=function(De,ye,Ee,be,Pe,se){const Ie=se.calculateFogTileMatrix(Pe),We=[ye,Ee,be];return l.transformMat4(We,We,Ie),dn(De,We,se.pitch,se._fov)}(this.fogState,c,p,y,w.toUnwrapped(),this.transform)>.9)):Ve($,$,i);const G=$[3];return{point:new l.Point(($[0]/G+1)/2*this.transform.width+St,(-$[1]/G+1)/2*this.transform.height+St),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/G*.5,1.5),signedDistanceFromCamera:G,occluded:A&&$[2]>G||W}}isOffscreen(i,c,p,y){return p<St||i>=this.screenRightBoundary||y<St||c>this.screenBottomBoundary}isInsideGrid(i,c,p,y){return p>=0&&i<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i}}function fn(h,i,c){const p=i.createTileMatrix(h,h.worldSize,c.toUnwrapped());return l.multiply(new Float32Array(16),h.projMatrix,p)}function xn(h,i,c){if(i.projection.name===c.projection.name)return h.projMatrix;const p=c.clone();return p.setProjection(i.projection),fn(p,i.getProjection(),h)}function pn(h,i,c){return i.name===c.projection.name?h.projMatrix:fn(c,i,h)}class An{constructor(i,c,p,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):y&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class cr{constructor(i,c,p,y,w,A=!1){this.text=new An(i?i.text:null,c,p,w),this.icon=new An(i?i.icon:null,c,y,w),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Tr{constructor(i,c,p,y=!1){this.text=i,this.icon=c,this.skipFade=p,this.clipped=y}}class kr{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class Ei{constructor(i,c,p,y,w){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=w}}class oo{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[i]}}function Wi(h,i,c,p,y){const{horizontalAlign:w,verticalAlign:A}=l.getAnchorAlignment(h),O=-(w-.5)*i,$=-(A-.5)*c,W=l.evaluateVariableOffset(h,p);return new l.Point(O+W[0]*y,$+W[1]*y)}function Ji(h,i,c,p,y){const w=new l.Point(h,i);return c&&w._rotate(p?y:-y),w}class Ri{constructor(i,c,p,y,w){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new zt(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new oo(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,p,y){const w=p.getBucket(c),A=p.latestFeatureIndex;if(!w||!A||c.id!==w.layerIds[0])return;const O=w.layers[0].layout,$=p.collisionBoxArray,W=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),G=p.tileSize/l.EXTENT,ae=p.tileID.toUnwrapped();this.transform.setProjection(w.projection);const De=(ye=p.tileID,Ee=w.getProjection(),be=this.transform,Ee.name===this.projection?be.calculateProjMatrix(ye.toUnwrapped()):fn(be,Ee,ye));var ye,Ee,be;const Pe="map"===O.get("text-pitch-alignment"),se="map"===O.get("text-rotation-alignment");c.compileFilter();const Ie=c.dynamicFilter(),We=c.dynamicFilterNeedsFeature(),Xe=this.transform.calculatePixelsToTileUnitsMatrix(p),ft=io(De,p.tileID.canonical,Pe,se,this.transform,w.getProjection(),Xe);let Ct=null;if(Pe){const Mt=wi(De,p.tileID.canonical,Pe,se,this.transform,w.getProjection(),Xe);Ct=l.multiply([],this.transform.labelPlaneMatrix,Mt)}let Dt=null;Ie&&p.latestFeatureIndex&&(Dt={unwrappedTileID:ae,dynamicFilter:Ie,dynamicFilterNeedsFeature:We,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[w.bucketInstanceId]=new Ei(w.bucketInstanceId,A,w.sourceLayerIndex,w.index,p.tileID);const Rt={bucket:w,layout:O,posMatrix:De,textLabelPlaneMatrix:ft,labelToScreenMatrix:Ct,clippingData:Dt,scale:W,textPixelRatio:G,holdingForFade:p.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(y)for(const Mt of w.sortKeyRanges){const{sortKey:Wt,symbolInstanceStart:On,symbolInstanceEnd:qt}=Mt;i.push({sortKey:Wt,symbolInstanceStart:On,symbolInstanceEnd:qt,parameters:Rt})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Rt})}attemptAnchorPlacement(i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be,Pe,se,Ie){const{textOffset0:We,textOffset1:Xe,crossTileID:ft}=De,Ct=[We,Xe],Dt=Wi(i,p,y,Ct,w),Rt=this.collisionIndex.placeCollisionBox(Ee,w,c,Ji(Dt.x,Dt.y,A,O,this.transform.angle),ae,$,W,G.predicate);if(Pe){const Mt=Ee.getSymbolInstanceIconSize(Ie,this.transform.zoom,De.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Ee,Mt,Pe,Ji(Dt.x,Dt.y,A,O,this.transform.angle),ae,$,W,G.predicate).box.length)return}if(Rt.box.length>0){let Mt;return this.prevPlacement&&this.prevPlacement.variableOffsets[ft]&&this.prevPlacement.placements[ft]&&this.prevPlacement.placements[ft].text&&(Mt=this.prevPlacement.variableOffsets[ft].anchor),this.variableOffsets[ft]={textOffset:Ct,width:p,height:y,anchor:i,textScale:w,prevAnchor:Mt},this.markUsedJustification(Ee,i,De,be),Ee.allowVerticalPlacement&&(this.markUsedOrientation(Ee,be,De),this.placedOrientations[ft]=be),{shift:Dt,placedGlyphBoxes:Rt}}}placeLayerBucketPart(i,c,p,y){const{bucket:w,layout:A,posMatrix:O,textLabelPlaneMatrix:$,labelToScreenMatrix:W,clippingData:G,textPixelRatio:ae,holdingForFade:De,collisionBoxArray:ye,partiallyEvaluatedTextSize:Ee,partiallyEvaluatedIconSize:be,collisionGroup:Pe}=i.parameters,se=A.get("text-optional"),Ie=A.get("icon-optional"),We=A.get("text-allow-overlap"),Xe=A.get("icon-allow-overlap"),ft="map"===A.get("text-rotation-alignment"),Ct="map"===A.get("text-pitch-alignment"),Dt="none"!==A.get("icon-text-fit"),Rt="viewport-y"===A.get("symbol-z-order");this.transform.setProjection(w.projection);let Mt=We&&(Xe||!w.hasIconData()||Ie),Wt=Xe&&(We||!w.hasTextData()||se);!w.collisionArrays&&ye&&w.deserializeCollisionBoxes(ye),p&&y&&w.updateCollisionDebugBuffers(this.transform.zoom,ye);const On=(qt,Tn,un)=>{const{crossTileID:Fn,numVerticalGlyphVertices:nn}=qt;if(G){const co={zoom:this.transform.zoom,pitch:this.transform.pitch};let ji=null;if(G.dynamicFilterNeedsFeature){const Mi=this.retainedQueryData[w.bucketInstanceId];ji=G.featureIndex.loadFeature({featureIndex:qt.featureIndex,bucketIndex:Mi.bucketIndex,sourceLayerIndex:Mi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,G.dynamicFilter)(co,ji,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new l.Point(qt.tileAnchorX,qt.tileAnchorY),this.transform.calculateDistanceTileData(G.unwrappedTileID)))return this.placements[Fn]=new Tr(!1,!1,!1,!0),void c.add(Fn)}if(c.has(Fn))return;if(De)return void(this.placements[Fn]=new Tr(!1,!1,!1));let En=!1,zn=!1,Rn=!0,Vn=!1,Ar=!1,Xr=null,dr={box:null,offscreen:null,occluded:null},Ur={box:null,offscreen:null,occluded:null},gi=null,pi=null,br=null,Xi=0,_i=0,fo=0;un.textFeatureIndex?Xi=un.textFeatureIndex:qt.useRuntimeCollisionCircles&&(Xi=qt.featureIndex),un.verticalTextFeatureIndex&&(_i=un.verticalTextFeatureIndex);const lo=co=>{co.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const ji=this.transform.elevation;(ji||co.elevation)&&(co.elevation=ji?ji.getAtTileOffset(co.tileID,co.tileAnchorX,co.tileAnchorY):0)},Ns=un.textBox;if(Ns){lo(Ns);const co=Mi=>{let hs=l.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Mi&&this.prevPlacement){const Zs=this.prevPlacement.placedOrientations[Fn];Zs&&(this.placedOrientations[Fn]=Zs,hs=Zs,this.markUsedOrientation(w,hs,qt))}return hs},ji=(Mi,hs)=>{if(w.allowVerticalPlacement&&nn>0&&un.verticalTextBox){for(const Zs of w.writingModes)if(Zs===l.WritingMode.vertical?(dr=hs(),Ur=dr):dr=Mi(),dr&&dr.box&&dr.box.length)break}else dr=Mi()};if(A.get("text-variable-anchor")){let Mi=A.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Fn]){const no=this.prevPlacement.variableOffsets[Fn];Mi.indexOf(no.anchor)>0&&(Mi=Mi.filter(Ia=>Ia!==no.anchor),Mi.unshift(no.anchor))}const hs=(no,Ia,$u)=>{const Oc=w.getSymbolInstanceTextSize(Ee,qt,this.transform.zoom,Tn),Vu=(no.x2-no.x1)*Oc+2*no.padding,Jl=(no.y2-no.y1)*Oc+2*no.padding,_c=Dt&&!Xe?Ia:null;_c&&lo(_c);let kc={box:[],offscreen:!1,occluded:!1};const gd=We?2*Mi.length:Mi.length;for(let ul=0;ul<gd;++ul){const _d=this.attemptAnchorPlacement(Mi[ul%Mi.length],no,Vu,Jl,Oc,ft,Ct,ae,O,Pe,ul>=Mi.length,qt,Tn,w,$u,_c,Ee,be);if(_d&&(kc=_d.placedGlyphBoxes,kc&&kc.box&&kc.box.length)){En=!0,Xr=_d.shift;break}}return kc};ji(()=>hs(Ns,un.iconBox,l.WritingMode.horizontal),()=>{const no=un.verticalTextBox;return no&&lo(no),w.allowVerticalPlacement&&!(dr&&dr.box&&dr.box.length)&&nn>0&&no?hs(no,un.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),dr&&(En=dr.box,Rn=dr.offscreen,Vn=dr.occluded);const Zs=co(!(!dr||!dr.box));if(!En&&this.prevPlacement){const no=this.prevPlacement.variableOffsets[Fn];no&&(this.variableOffsets[Fn]=no,this.markUsedJustification(w,no.anchor,qt,Zs))}}else{const Mi=(hs,Zs)=>{const no=w.getSymbolInstanceTextSize(Ee,qt,this.transform.zoom,Tn),Ia=this.collisionIndex.placeCollisionBox(w,no,hs,new l.Point(0,0),We,ae,O,Pe.predicate);return Ia&&Ia.box&&Ia.box.length&&(this.markUsedOrientation(w,Zs,qt),this.placedOrientations[Fn]=Zs),Ia};ji(()=>Mi(Ns,l.WritingMode.horizontal),()=>{const hs=un.verticalTextBox;return w.allowVerticalPlacement&&nn>0&&hs?(lo(hs),Mi(hs,l.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),co(!!(dr&&dr.box&&dr.box.length))}}if(gi=dr,En=gi&&gi.box&&gi.box.length>0,Rn=gi&&gi.offscreen,Vn=gi&&gi.occluded,qt.useRuntimeCollisionCircles){const co=w.text.placedSymbolArray.get(qt.centerJustifiedTextSymbolIndex>=0?qt.centerJustifiedTextSymbolIndex:qt.verticalPlacedTextSymbolIndex),ji=l.evaluateSizeForFeature(w.textSizeData,Ee,co),Mi=A.get("text-padding");pi=this.collisionIndex.placeCollisionCircles(w,We,co,w.lineVertexArray,w.glyphOffsetArray,ji,O,$,W,p,Ct,Pe.predicate,qt.collisionCircleDiameter*ji/l.ONE_EM,Mi,this.retainedQueryData[w.bucketInstanceId].tileID),En=We||pi.circles.length>0&&!pi.collisionDetected,Rn=Rn&&pi.offscreen,Vn=pi.occluded}if(un.iconFeatureIndex&&(fo=un.iconFeatureIndex),un.iconBox){const co=ji=>{lo(ji);const Mi=Dt&&Xr?Ji(Xr.x,Xr.y,ft,Ct,this.transform.angle):new l.Point(0,0),hs=w.getSymbolInstanceIconSize(be,this.transform.zoom,qt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,hs,ji,Mi,Xe,ae,O,Pe.predicate)};Ur&&Ur.box&&Ur.box.length&&un.verticalIconBox?(br=co(un.verticalIconBox),zn=br.box.length>0):(br=co(un.iconBox),zn=br.box.length>0),Rn=Rn&&br.offscreen,Ar=br.occluded}const zs=se||0===qt.numHorizontalGlyphVertices&&0===nn,Sa=Ie||0===qt.numIconVertices;if(zs||Sa?Sa?zs||(zn=zn&&En):En=zn&&En:zn=En=zn&&En,En&&gi&&gi.box&&this.collisionIndex.insertCollisionBox(gi.box,A.get("text-ignore-placement"),w.bucketInstanceId,Ur&&Ur.box&&_i?_i:Xi,Pe.ID),zn&&br&&this.collisionIndex.insertCollisionBox(br.box,A.get("icon-ignore-placement"),w.bucketInstanceId,fo,Pe.ID),pi&&(En&&this.collisionIndex.insertCollisionCircles(pi.circles,A.get("text-ignore-placement"),w.bucketInstanceId,Xi,Pe.ID),p)){const co=w.bucketInstanceId;let ji=this.collisionCircleArrays[co];void 0===ji&&(ji=this.collisionCircleArrays[co]=new kr);for(let Mi=0;Mi<pi.circles.length;Mi+=4)ji.circles.push(pi.circles[Mi+0]),ji.circles.push(pi.circles[Mi+1]),ji.circles.push(pi.circles[Mi+2]),ji.circles.push(pi.collisionDetected?1:0)}const Ua="globe"!==w.projection.name;Mt=Mt&&(Ua||!Vn),Wt=Wt&&(Ua||!Ar),this.placements[Fn]=new Tr(En||Mt,zn||Wt,Rn||w.justReloaded),c.add(Fn)};if(Rt){const qt=w.getSortedSymbolIndexes(this.transform.angle);for(let Tn=qt.length-1;Tn>=0;--Tn){const un=qt[Tn];On(w.symbolInstances.get(un),un,w.collisionArrays[un])}}else for(let qt=i.symbolInstanceStart;qt<i.symbolInstanceEnd;qt++)On(w.symbolInstances.get(qt),qt,w.collisionArrays[qt]);if(p&&w.bucketInstanceId in this.collisionCircleArrays){const qt=this.collisionCircleArrays[w.bucketInstanceId];l.invert(qt.invProjMatrix,O),qt.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(i,c,p,y){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:$,crossTileID:W}=p,G=l.getAnchorJustification(c),ae=y===l.WritingMode.vertical?$:"left"===G?w:"center"===G?A:"right"===G?O:-1;w>=0&&(i.text.placedSymbolArray.get(w).crossTileID=ae>=0&&w!==ae?0:W),A>=0&&(i.text.placedSymbolArray.get(A).crossTileID=ae>=0&&A!==ae?0:W),O>=0&&(i.text.placedSymbolArray.get(O).crossTileID=ae>=0&&O!==ae?0:W),$>=0&&(i.text.placedSymbolArray.get($).crossTileID=ae>=0&&$!==ae?0:W)}markUsedOrientation(i,c,p){const y=c===l.WritingMode.horizontal||c===l.WritingMode.horizontalOnly?c:0,w=c===l.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:$,verticalPlacedTextSymbolIndex:W}=p,G=i.text.placedSymbolArray;A>=0&&(G.get(A).placedOrientation=y),O>=0&&(G.get(O).placedOrientation=y),$>=0&&(G.get($).placedOrientation=y),W>=0&&(G.get(W).placedOrientation=w)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const y=c?c.symbolFadeChange(i):1,w=c?c.opacities:{},A=c?c.variableOffsets:{},O=c?c.placedOrientations:{};for(const $ in this.placements){const W=this.placements[$],G=w[$];G?(this.opacities[$]=new cr(G,y,W.text,W.icon,null,W.clipped),p=p||W.text!==G.text.placed||W.icon!==G.icon.placed):(this.opacities[$]=new cr(null,y,W.text,W.icon,W.skipFade,W.clipped),p=p||W.text||W.icon)}for(const $ in w){const W=w[$];if(!this.opacities[$]){const G=new cr(W,y,!1,!1);G.isHidden()||(this.opacities[$]=G,p=p||W.text.placed||W.icon.placed)}}for(const $ in A)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=A[$]);for(const $ in O)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=O[$]);p?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){const p=new Set;for(const y of c){const w=y.getBucket(i);w&&y.latestFeatureIndex&&i.id===w.layerIds[0]&&this.updateBucketOpacities(w,p,y.collisionBoxArray)}}updateBucketOpacities(i,c,p){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const y=i.layers[0].layout,w=!!i.layers[0].dynamicFilter(),A=new cr(null,0,!1,!1,!0),O=y.get("text-allow-overlap"),$=y.get("icon-allow-overlap"),W=y.get("text-variable-anchor"),G="map"===y.get("text-rotation-alignment"),ae="map"===y.get("text-pitch-alignment"),De="none"!==y.get("icon-text-fit"),ye=new cr(null,0,O&&($||!i.hasIconData()||y.get("icon-optional")),$&&(O||!i.hasTextData()||y.get("text-optional")),!0);!i.collisionArrays&&p&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(p);const Ee=(Pe,se,Ie)=>{for(let We=0;We<se/4;We++)Pe.opacityVertexArray.emplaceBack(Ie)};let be=0;for(let Pe=0;Pe<i.symbolInstances.length;Pe++){const se=i.symbolInstances.get(Pe),{numHorizontalGlyphVertices:Ie,numVerticalGlyphVertices:We,crossTileID:Xe,numIconVertices:ft}=se,Ct=c.has(Xe);let Dt=this.opacities[Xe];Ct?Dt=A:Dt||(Dt=ye,this.opacities[Xe]=Dt),c.add(Xe);const Rt=Ie>0||We>0,Mt=ft>0,Wt=this.placedOrientations[Xe],On=Wt===l.WritingMode.vertical,qt=Wt===l.WritingMode.horizontal||Wt===l.WritingMode.horizontalOnly;if(!Rt&&!Mt||Dt.isHidden()||be++,Rt){const Tn=as(Dt.text);Ee(i.text,Ie,On?Ni:Tn),Ee(i.text,We,qt?Ni:Tn);const un=Dt.text.isHidden(),{leftJustifiedTextSymbolIndex:Fn,centerJustifiedTextSymbolIndex:nn,rightJustifiedTextSymbolIndex:En,verticalPlacedTextSymbolIndex:zn}=se,Rn=i.text.placedSymbolArray,Vn=un||On?1:0;Fn>=0&&(Rn.get(Fn).hidden=Vn),nn>=0&&(Rn.get(nn).hidden=Vn),En>=0&&(Rn.get(En).hidden=Vn),zn>=0&&(Rn.get(zn).hidden=un||qt?1:0);const Ar=this.variableOffsets[Xe];Ar&&this.markUsedJustification(i,Ar.anchor,se,Wt);const Xr=this.placedOrientations[Xe];Xr&&(this.markUsedJustification(i,"left",se,Xr),this.markUsedOrientation(i,Xr,se))}if(Mt){const Tn=as(Dt.icon),{placedIconSymbolIndex:un,verticalPlacedIconSymbolIndex:Fn}=se,nn=i.icon.placedSymbolArray,En=Dt.icon.isHidden()?1:0;un>=0&&(Ee(i.icon,ft,On?Ni:Tn),nn.get(un).hidden=En),Fn>=0&&(Ee(i.icon,se.numVerticalIconVertices,qt?Ni:Tn),nn.get(Fn).hidden=En)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Tn=i.collisionArrays[Pe];if(Tn){let un=new l.Point(0,0),Fn=!0;if(Tn.textBox||Tn.verticalTextBox){if(W){const En=this.variableOffsets[Xe];En?(un=Wi(En.anchor,En.width,En.height,En.textOffset,En.textScale),G&&un._rotate(ae?this.transform.angle:-this.transform.angle)):Fn=!1}w&&(Fn=!Dt.clipped),Tn.textBox&&To(i.textCollisionBox.collisionVertexArray,Dt.text.placed,!Fn||On,un.x,un.y),Tn.verticalTextBox&&To(i.textCollisionBox.collisionVertexArray,Dt.text.placed,!Fn||qt,un.x,un.y)}const nn=Fn&&!(qt||!Tn.verticalIconBox);Tn.iconBox&&To(i.iconCollisionBox.collisionVertexArray,Dt.icon.placed,nn,De?un.x:0,De?un.y:0),Tn.verticalIconBox&&To(i.iconCollisionBox.collisionVertexArray,Dt.icon.placed,!nn,De?un.x:0,De?un.y:0)}}}if(i.fullyClipped=0===be,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Pe=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Pe.invProjMatrix,i.placementViewportMatrix=Pe.viewportMatrix,i.collisionCircleArray=Pe.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function To(h,i,c,p,y){h.emplaceBack(i?1:0,c?1:0,p||0,y||0),h.emplaceBack(i?1:0,c?1:0,p||0,y||0),h.emplaceBack(i?1:0,c?1:0,p||0,y||0),h.emplaceBack(i?1:0,c?1:0,p||0,y||0)}const jr=Math.pow(2,25),Zr=Math.pow(2,24),Qi=Math.pow(2,17),ps=Math.pow(2,16),Pi=Math.pow(2,9),So=Math.pow(2,8),Ks=Math.pow(2,1);function as(h){if(0===h.opacity&&!h.placed)return 0;if(1===h.opacity&&h.placed)return 4294967295;const i=h.placed?1:0,c=Math.floor(127*h.opacity);return c*jr+i*Zr+c*Qi+i*ps+c*Pi+i*So+c*Ks+i}const Ni=0;class Os{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(i,c,p,y,w){const A=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(A,y,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((O,$)=>O.sortKey-$.sortKey));this._currentPartIndex<A.length;){const O=A[this._currentPartIndex];if(c.placeLayerBucketPart(O,this._seenCrossTileIDs,p,0===O.symbolInstanceStart),this._currentPartIndex++,w())return!0}return!1}}class Oi{constructor(i,c,p,y,w,A,O,$){this.placement=new Ri(i,w,A,O,$),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(i,c,p){const y=l.exported.now(),w=()=>{const A=l.exported.now()-y;return!this._forceFullPlacement&&A>2};for(;this._currentPlacementIndex>=0;){const A=c[i[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===A.type&&(!A.minzoom||A.minzoom<=O)&&(!A.maxzoom||A.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Os(A)),this._inProgressLayer.continuePlacement(p[A.source],this.placement,this._showCollisionBoxes,A,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const rr=512/l.EXTENT/2;class xr{constructor(i,c,p){this.tileID=i,this.bucketInstanceId=p,this.index=new l.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=i.canonical.x*l.EXTENT,w=i.canonical.y*l.EXTENT;for(let A=0;A<c.length;A++){const{key:O,crossTileID:$,tileAnchorX:W,tileAnchorY:G}=c.get(A),ae=Math.floor((y+W)*rr),De=Math.floor((w+G)*rr);this.index.add(ae,De),this.keys.push(O),this.crossTileIDs.push($)}this.index.finish()}findMatches(i,c,p){const y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),w=rr/Math.pow(2,c.canonical.z-this.tileID.canonical.z),A=c.canonical.x*l.EXTENT,O=c.canonical.y*l.EXTENT;for(let $=0;$<i.length;$++){const W=i.get($);if(W.crossTileID)continue;const{key:G,tileAnchorX:ae,tileAnchorY:De}=W,ye=Math.floor((A+ae)*w),Ee=Math.floor((O+De)*w),be=this.index.range(ye-y,Ee-y,ye+y,Ee+y);for(const Pe of be){const se=this.crossTileIDs[Pe];if(this.keys[Pe]===G&&!p.has(se)){p.add(se),W.crossTileID=se;break}}}}}class Si{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Io{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(0!==c)for(const p in this.indexes){const y=this.indexes[p],w={};for(const A in y){const O=y[A];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+c),w[O.tileID.key]=O}this.indexes[p]=w}this.lng=i}addBucket(i,c,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let w=0;w<c.symbolInstances.length;w++)c.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]=new Set);const y=this.usedCrossTileIDs[i.overscaledZ];for(const w in this.indexes){const A=this.indexes[w];if(Number(w)>i.overscaledZ)for(const O in A){const $=A[O];$.tileID.isChildOf(i)&&$.findMatches(c.symbolInstances,i,y)}else{const O=A[i.scaledTo(Number(w)).key];O&&O.findMatches(c.symbolInstances,i,y)}}for(let w=0;w<c.symbolInstances.length;w++){const A=c.symbolInstances.get(w);A.crossTileID||(A.crossTileID=p.generate(),y.add(A.crossTileID))}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new xr(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const p of c.crossTileIDs)this.usedCrossTileIDs[i].delete(p)}removeStaleBuckets(i){let c=!1;for(const p in this.indexes){const y=this.indexes[p];for(const w in y)i[y[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[w]),delete y[w],c=!0)}return c}}class zo{constructor(){this.layerIndexes={},this.crossTileIDs=new Si,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,p,y){let w=this.layerIndexes[i.id];void 0===w&&(w=this.layerIndexes[i.id]=new Io);let A=!1;const O={};"globe"!==y.name&&w.handleWrapJump(p);for(const $ of c){const W=$.getBucket(i);W&&i.id===W.layerIds[0]&&(W.bucketInstanceId||(W.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket($.tileID,W,this.crossTileIDs)&&(A=!0),O[W.bucketInstanceId]=!0)}return w.removeStaleBuckets(O)&&(A=!0),A}pruneUnusedLayers(i){const c={};i.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const Ii=(h,i)=>l.emitValidationErrors(h,i&&i.filter(c=>"source.canvas"!==c.identifier)),Ms=l.pick(Tt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),eo=l.pick(Tt,["setCenter","setZoom","setBearing","setPitch"]),$o={version:8,layers:[],sources:{}},Vo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Mr extends l.Evented{constructor(i,c={}){super(),this.map=i,this.dispatcher=new en(ro(),this),this.imageManager=new It,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(i._requestManager,c.localFontFamily?l.LocalGlyphMode.all:c.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new zo,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const p=this;this._rtlTextPluginCallback=Mr.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(w,A)=>{if(l.triggerPluginCompletionEvent(w),A&&A.every(O=>O))for(const O in p._sourceCaches){const $=p._sourceCaches[O],W=$.getSource().type;"vector"!==W&&"geojson"!==W||$.reload()}})}),this.on("data",y=>{if("source"!==y.dataType||"metadata"!==y.sourceDataType)return;const w=this.getSource(y.sourceId);if(w&&w.vectorLayerIds)for(const A in this._layers){const O=this._layers[A];O.source===w.id&&this._validateLayer(O)}})}loadURL(i,c={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const p="boolean"==typeof c.validate?c.validate:!l.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,c.accessToken);const y=this.map._requestManager.transformRequest(i,l.ResourceType.Style);this._request=l.getJSON(y,(w,A)=>{this._request=null,w?this.fire(new l.ErrorEvent(w)):A&&this._load(A,p)})}loadJSON(i,c={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(i,!1!==c.validate)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load($o,!1)}_updateLayerCount(i,c){const p=c?1:-1;i.is3D()&&(this._num3DLayers+=p),"circle"===i.type&&(this._numCircleLayers+=p),"symbol"===i.type&&(this._numSymbolLayers+=p)}_load(i,c){if(c&&Ii(this,l.validateStyle(i)))return;this._loaded=!0,this.stylesheet=l.clone$1(i),this._updateMapProjection();for(const y in i.sources)this.addSource(y,i.sources[y],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const p=rn(this.stylesheet.layers);this._order=p.map(y=>y.id),this._layers={},this._serializedLayers={};for(const y of p){const w=l.createStyleLayer(y);w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new mt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(i){this._spriteRequest=function(c,p,y){let w,A,O;const $=l.exported.devicePixelRatio>1?"@2x":"";let W=l.getJSON(p.transformRequest(p.normalizeSpriteURL(c,$,".json"),l.ResourceType.SpriteJSON),(De,ye)=>{W=null,O||(O=De,w=ye,ae())}),G=l.getImage(p.transformRequest(p.normalizeSpriteURL(c,$,".png"),l.ResourceType.SpriteImage),(De,ye)=>{G=null,O||(O=De,A=ye,ae())});function ae(){if(O)y(O);else if(w&&A){const De=l.exported.getImageData(A),ye={};for(const Ee in w){const{width:be,height:Pe,x:se,y:Ie,sdf:We,pixelRatio:Xe,stretchX:ft,stretchY:Ct,content:Dt}=w[Ee],Rt=new l.RGBAImage({width:be,height:Pe});l.RGBAImage.copy(De,Rt,{x:se,y:Ie},{x:0,y:0},{width:be,height:Pe}),ye[Ee]={data:Rt,pixelRatio:Xe,sdf:We,stretchX:ft,stretchY:Ct,content:Dt}}y(null,ye)}}return{cancel(){W&&(W.cancel(),W=null),G&&(G.cancel(),G=null)}}}(i,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new l.ErrorEvent(c));else if(p)for(const y in p)this.imageManager.addImage(y,p[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(i){const c=this.getSource(i.source);if(!c)return;const p=i.sourceLayer;p&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(p))&&this.fire(new l.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const c=[];for(const p of i){const y=this._layers[p];"custom"!==y.type&&c.push(y.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&("function"==typeof i.isLayerDraped?i.isLayerDraped():Vo[i.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const c=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(y.length||w.length)&&this._updateWorkerLayers(y,w);for(const A in this._updatedSources){const O=this._updatedSources[A];"reload"===O?this._reloadSource(A):"clear"===O&&this._clearSource(A)}this._updateTilesForChangedImages();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const p={};for(const y in this._sourceCaches){const w=this._sourceCaches[y];p[y]=w.used,w.used=!1}for(const y of this._order){const w=this._layers[y];if(w.recalculate(i,this._availableImages),!w.isHidden(i.zoom)){const O=this._getLayerSourceCache(w);O&&(O.used=!0)}const A=this.map.painter;if(A){const O=w.getProgramIds();if(!O)continue;const $=w.getProgramConfiguration(i.zoom);for(const W of O)A.useProgram(W,$)}}for(const y in p){const w=this._sourceCaches[y];p[y]!==w.used&&w.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Ii(this,l.validateStyle(i)))return!1;(i=l.clone$1(i)).layers=rn(i.layers);const c=function(y,w){if(!y)return[{command:Tt.setStyle,args:[w]}];let A=[];try{if(!ve(y.version,w.version))return[{command:Tt.setStyle,args:[w]}];ve(y.center,w.center)||A.push({command:Tt.setCenter,args:[w.center]}),ve(y.zoom,w.zoom)||A.push({command:Tt.setZoom,args:[w.zoom]}),ve(y.bearing,w.bearing)||A.push({command:Tt.setBearing,args:[w.bearing]}),ve(y.pitch,w.pitch)||A.push({command:Tt.setPitch,args:[w.pitch]}),ve(y.sprite,w.sprite)||A.push({command:Tt.setSprite,args:[w.sprite]}),ve(y.glyphs,w.glyphs)||A.push({command:Tt.setGlyphs,args:[w.glyphs]}),ve(y.transition,w.transition)||A.push({command:Tt.setTransition,args:[w.transition]}),ve(y.light,w.light)||A.push({command:Tt.setLight,args:[w.light]}),ve(y.fog,w.fog)||A.push({command:Tt.setFog,args:[w.fog]}),ve(y.projection,w.projection)||A.push({command:Tt.setProjection,args:[w.projection]});const O={},$=[];!function(ae,De,ye,Ee){let be;for(be in De=De||{},ae=ae||{})ae.hasOwnProperty(be)&&(De.hasOwnProperty(be)||ur(be,ye,Ee));for(be in De){if(!De.hasOwnProperty(be))continue;const Pe=De[be];ae.hasOwnProperty(be)?ve(ae[be],Pe)||("geojson"===ae[be].type&&"geojson"===Pe.type&&Rr(ae,De,be)?ye.push({command:Tt.setGeoJSONSourceData,args:[be,Pe.data]}):Zn(be,De,ye,Ee)):Dn(be,De,ye)}}(y.sources,w.sources,$,O);const W=[];y.layers&&y.layers.forEach(ae=>{ae.source&&O[ae.source]?A.push({command:Tt.removeLayer,args:[ae.id]}):W.push(ae)});let G=y.terrain;G&&O[G.source]&&(A.push({command:Tt.setTerrain,args:[void 0]}),G=void 0),A=A.concat($),ve(G,w.terrain)||A.push({command:Tt.setTerrain,args:[w.terrain]}),function(ae,De,ye){De=De||[];const Ee=(ae=ae||[]).map(fi),be=De.map(fi),Pe=ae.reduce(Ti,{}),se=De.reduce(Ti,{}),Ie=Ee.slice(),We=Object.create(null);let Xe,ft,Ct,Dt,Rt,Mt,Wt;for(Xe=0,ft=0;Xe<Ee.length;Xe++)Ct=Ee[Xe],se.hasOwnProperty(Ct)?ft++:(ye.push({command:Tt.removeLayer,args:[Ct]}),Ie.splice(Ie.indexOf(Ct,ft),1));for(Xe=0,ft=0;Xe<be.length;Xe++)Ct=be[be.length-1-Xe],Ie[Ie.length-1-Xe]!==Ct&&(Pe.hasOwnProperty(Ct)?(ye.push({command:Tt.removeLayer,args:[Ct]}),Ie.splice(Ie.lastIndexOf(Ct,Ie.length-ft),1)):ft++,Mt=Ie[Ie.length-Xe],ye.push({command:Tt.addLayer,args:[se[Ct],Mt]}),Ie.splice(Ie.length-Xe,0,Ct),We[Ct]=!0);for(Xe=0;Xe<be.length;Xe++)if(Ct=be[Xe],Dt=Pe[Ct],Rt=se[Ct],!We[Ct]&&!ve(Dt,Rt))if(ve(Dt.source,Rt.source)&&ve(Dt["source-layer"],Rt["source-layer"])&&ve(Dt.type,Rt.type)){for(Wt in Fr(Dt.layout,Rt.layout,ye,Ct,null,Tt.setLayoutProperty),Fr(Dt.paint,Rt.paint,ye,Ct,null,Tt.setPaintProperty),ve(Dt.filter,Rt.filter)||ye.push({command:Tt.setFilter,args:[Ct,Rt.filter]}),ve(Dt.minzoom,Rt.minzoom)&&ve(Dt.maxzoom,Rt.maxzoom)||ye.push({command:Tt.setLayerZoomRange,args:[Ct,Rt.minzoom,Rt.maxzoom]}),Dt)Dt.hasOwnProperty(Wt)&&"layout"!==Wt&&"paint"!==Wt&&"filter"!==Wt&&"metadata"!==Wt&&"minzoom"!==Wt&&"maxzoom"!==Wt&&(0===Wt.indexOf("paint.")?Fr(Dt[Wt],Rt[Wt],ye,Ct,Wt.slice(6),Tt.setPaintProperty):ve(Dt[Wt],Rt[Wt])||ye.push({command:Tt.setLayerProperty,args:[Ct,Wt,Rt[Wt]]}));for(Wt in Rt)Rt.hasOwnProperty(Wt)&&!Dt.hasOwnProperty(Wt)&&"layout"!==Wt&&"paint"!==Wt&&"filter"!==Wt&&"metadata"!==Wt&&"minzoom"!==Wt&&"maxzoom"!==Wt&&(0===Wt.indexOf("paint.")?Fr(Dt[Wt],Rt[Wt],ye,Ct,Wt.slice(6),Tt.setPaintProperty):ve(Dt[Wt],Rt[Wt])||ye.push({command:Tt.setLayerProperty,args:[Ct,Wt,Rt[Wt]]}))}else ye.push({command:Tt.removeLayer,args:[Ct]}),Mt=Ie[Ie.lastIndexOf(Ct)+1],ye.push({command:Tt.addLayer,args:[Rt,Mt]})}(W,w.layers,A)}catch(O){console.warn("Unable to compute style diff:",O),A=[{command:Tt.setStyle,args:[w]}]}return A}(this.serialize(),i).filter(y=>!(y.command in eo));if(0===c.length)return!1;const p=c.filter(y=>!(y.command in Ms));if(p.length>0)throw new Error(`Unimplemented: ${p.map(y=>y.command).join(", ")}.`);return c.forEach(y=>{"setTransition"!==y.command&&"setProjection"!==y.command&&this[y.command].apply(this,y.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,c){return this.getImage(i)?this.fire(new l.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,c),this._afterImageUpdated(i),this)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new l.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,c,p={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(l.validateSource,`sources.${i}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const y=ot(i,c,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:y.serialize(),sourceId:i}));const w=A=>{const O=(A?"symbol:":"other:")+i,$=this._sourceCaches[O]=new l.SourceCache(O,y,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[i]=$,$.style=this,$.onAdd(this.map)};w(!1),"vector"!==c.type&&"geojson"!==c.type||w(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const c=this.getSource(i);if(!c)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(i);for(const y of p)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getSource(i).setData(c),this._changed=!0}getSource(i){const c=this._getSourceCache(i);return c&&c.getSource()}_getSources(){const i=[];for(const c in this._otherSourceCaches){const p=this._getSourceCache(c);p&&i.push(p.getSource())}return i}addLayer(i,c,p={}){this._checkLoaded();const y=i.id;if(this.getLayer(y))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let w;if("custom"===i.type){if(Ii(this,l.validateCustomStyleLayer(i)))return;w=l.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(y,i.source),i=l.clone$1(i),i=l.extend(i,{source:y})),this._validate(l.validateLayer,`layers.${y}`,i,{arrayIndex:-1},p))return;w=l.createStyleLayer(i),this._validateLayer(w),w.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const A=c?this._order.indexOf(c):this._order.length;if(c&&-1===A)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(A,0,y),this._layerOrderChanged=!0,this._layers[y]=w;const O=this._getLayerSourceCache(w);if(this._removedLayers[y]&&w.source&&O&&"custom"!==w.type){const $=this._removedLayers[y];delete this._removedLayers[y],$.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",O.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;const p=this._order.indexOf(i);this._order.splice(p,1);const y=c?this._order.indexOf(c):this._order.length;c&&-1===y?this.fire(new l.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(y,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const c=this._layers[i];if(!c)return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(i);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,p){this._checkLoaded();const y=this.getLayer(i);y?y.minzoom===c&&y.maxzoom===p||(null!=c&&(y.minzoom=c),null!=p&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,c,p={}){this._checkLoaded();const y=this.getLayer(i);if(y){if(!ve(y.filter,c))return null==c?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.validateFilter,`layers.${y.id}.filter`,c,{layerType:y.type},p)||(y.filter=l.clone$1(c),this._updateLayer(y)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const c=this.getLayer(i);return c&&l.clone$1(c.filter)}setLayoutProperty(i,c,p,y={}){this._checkLoaded();const w=this.getLayer(i);w?ve(w.getLayoutProperty(c),p)||(w.setLayoutProperty(c,p,y),this._updateLayer(w)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,c){const p=this.getLayer(i);if(p)return p.getLayoutProperty(c);this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,c,p,y={}){this._checkLoaded();const w=this.getLayer(i);w?ve(w.getPaintProperty(c),p)||(w.setPaintProperty(c,p,y)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,c){const p=this.getLayer(i);return p&&p.getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();const p=i.source,y=i.sourceLayer,w=this.getSource(p);if(!w)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const A=w.type;if("geojson"===A&&y)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===A&&!y)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(p);for(const $ of O)$.setFeatureState(y,i.id,c)}removeFeatureState(i,c){this._checkLoaded();const p=i.source,y=this.getSource(p);if(!y)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const w=y.type,A="vector"===w?i.sourceLayer:void 0;if("vector"===w&&!A)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(p);for(const $ of O)$.removeFeatureState(A,i.id,c)}getFeatureState(i){this._checkLoaded();const c=i.source,p=i.sourceLayer,y=this.getSource(c);if(y){if("vector"!==y.type||p)return void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,i.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();i[p.id]||(i[p.id]=p.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(i){this._updatedLayers[i.id]=!0;const c=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[i.source]="reload",c.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=A=>"fill-extrusion"===this._layers[A].type,p={},y=[];for(let A=this._order.length-1;A>=0;A--){const O=this._order[A];if(c(O)){p[O]=A;for(const $ of i){const W=$[O];if(W)for(const G of W)y.push(G)}}}y.sort((A,O)=>O.intersectionZ-A.intersectionZ);const w=[];for(let A=this._order.length-1;A>=0;A--){const O=this._order[A];if(c(O))for(let $=y.length-1;$>=0;$--){const W=y[$].feature;if(p[W.layer.id]<A)break;w.push(W),y.pop()}else for(const $ of i){const W=$[O];if(W)for(const G of W)w.push(G.feature)}}return w}queryRenderedFeatures(i,c,p){c&&c.filter&&this._validate(l.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const y={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const $ of c.layers){const W=this._layers[$];if(!W)return this.fire(new l.ErrorEvent(new Error(`The layer '${$}' does not exist in the map's style and cannot be queried for features.`))),[];y[W.source]=!0}}const w=[];c.availableImages=this._availableImages;const A=c&&c.layers?c.layers.some($=>{const W=this.getLayer($);return W&&W.is3D()}):this.has3DLayers(),O=$e.createFromScreenPoints(i,p);for(const $ in this._sourceCaches){const W=this._sourceCaches[$].getSource().id;c.layers&&!y[W]||w.push(vn(this._sourceCaches[$],this._layers,this._serializedLayers,O,c,p,A,!!this.map._showQueryGeometry))}return this.placement&&w.push(function($,W,G,ae,De,ye,Ee){const be={},Pe=ye.queryRenderedSymbols(ae),se=[];for(const Ie of Object.keys(Pe).map(Number))se.push(Ee[Ie]);se.sort(Wn);for(const Ie of se){const We=Ie.featureIndex.lookupSymbolFeatures(Pe[Ie.bucketInstanceId],W,Ie.bucketIndex,Ie.sourceLayerIndex,De.filter,De.layers,De.availableImages,$);for(const Xe in We){const ft=be[Xe]=be[Xe]||[],Ct=We[Xe];Ct.sort((Dt,Rt)=>{const Mt=Ie.featureSortOrder;if(Mt){const Wt=Mt.indexOf(Dt.featureIndex);return Mt.indexOf(Rt.featureIndex)-Wt}return Rt.featureIndex-Dt.featureIndex});for(const Dt of Ct)ft.push(Dt)}}for(const Ie in be)be[Ie].forEach(We=>{const Xe=We.feature,ft=G($[Ie]);if(!ft)return;const Ct=ft.getFeatureState(Xe.layer["source-layer"],Xe.id);Xe.source=Xe.layer.source,Xe.layer["source-layer"]&&(Xe.sourceLayer=Xe.layer["source-layer"]),Xe.state=Ct});return be}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(i,c){c&&c.filter&&this._validate(l.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(i);let y=[];for(const w of p)y=y.concat(Xn(w,c));return y}addSourceType(i,c,p){return Mr.getSourceType(i)?p(new Error(`A source type called "${i}" already exists.`)):(Mr.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const A in i)if(!ve(i[A],p[A])){y=!0;break}if(!y)return;const w=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(i,c),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,c=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let p=i;if(1===c){if("object"==typeof p.source){const y="terrain-dem-src";this.addSource(y,p.source),p=l.clone$1(p),p=l.extend(p,{source:y})}if(this._validate(l.validateTerrain,"terrain",p))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,c)}else{const y=this.terrain,w=y.get();for(const A of Object.keys(l.spec.terrain))!p.hasOwnProperty(A)&&l.spec.terrain[A].default&&(p[A]=l.spec.terrain[A].default);for(const A in p)if(!ve(p[A],w[A])){y.set(p),this.stylesheet.terrain=p;const O=this._setTransitionParameters({duration:0});y.updateTransitions(O);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new Yn(i,this.map.transform);this.stylesheet.fog=i;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();0===Object.keys(i).length&&c.set(i);for(const y in i)if(!ve(i[y],p[y])){c.set(i),this.stylesheet.fog=i;const w=this._setTransitionParameters({duration:0});c.updateTransitions(w);break}}else this._createFog(i);this._markersNeedUpdate=!0}_setTransitionParameters(i){return{now:l.exported.now(),transition:l.extend(i,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const p=this.terrain=new Ut(i,c);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});p.updateTransitions(y)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"symbol"===c.type&&this._updateLayer(c)}}_validate(i,c,p,y,w={}){return(!w||!1!==w.validate)&&Ii(this,i.call(l.validateStyle,l.extend({key:c,style:this.serialize(),value:p,styleSpec:l.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const c=this._getSourceCaches(i);for(const p of c)p.clearTiles()}_reloadSource(i){const c=this._getSourceCaches(i);for(const p of c)p.resume(),p.reload()}_reloadSources(){for(const i of this._getSources())i.reload&&i.reload()}_updateSources(i){for(const c in this._sourceCaches)this._sourceCaches[c].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,p,y,w=!1){let A=!1,O=!1;const $={};for(const W of this._order){const G=this._layers[W];if("symbol"!==G.type)continue;if(!$[G.source]){const De=this._getLayerSourceCache(G);if(!De)continue;$[G.source]=De.getRenderableIds(!0).map(ye=>De.getTileByID(ye)).sort((ye,Ee)=>Ee.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(Ee.tileID)?-1:1))}const ae=this.crossTileSymbolIndex.addLayer(G,$[G.source],i.center.lng,i.projection);A=A||ae}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||0===p,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),i.zoom))&&(this.pauseablePlacement=new Oi(i,this._order,w,c,p,y,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,$),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),O=!0),A&&this.pauseablePlacement.placement.setStale()),O||A)for(const W of this._order){const G=this._layers[W];"symbol"===G.type&&this.placement.updateLayerOpacities(G,$[G.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const y=w=>{w&&w.setDependencies(c.tileID.key,c.type,c.icons)};y(this._otherSourceCaches[c.source]),y(this._symbolSourceCaches[c.source])}getGlyphs(i,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(i,c,p){return l.makeRequest(c,p)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}_isSourceCacheLoaded(i){const c=this._getSourceCaches(i);return 0===c.length?(this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):c.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Mr.getSourceType=function(h){return pe[h]},Mr.setSourceType=function(h,i){pe[h]=i},Mr.registerForPluginStateChange=l.registerForPluginStateChange;var ks="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",ls="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",_o="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Ui="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",es="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ro={},Uo={};const jo=[];ns(ks,jo),ns(_o,jo),ns(Ui,jo),ns(es,jo),Ro=er("",_o),Uo=er(es,Ui);const oa=er("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ms=ks,cs="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var ts={background:er("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:er("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:er("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:er("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:er("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:er("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:er("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:er("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:er("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:er("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:er("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:er("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:er("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:er("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:er("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:er("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:er("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:er("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:er("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:er("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:er("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:er("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:er("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ls),skyboxGradient:er("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ls),skyboxCapture:er("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:er("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:er("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ns(h,i){const c=h.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let p of c)if(p=p.trim(),"#"===p[0]&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=p.split(" ");for(const w of y)i.includes(w)||i.push(w)}}function er(h,i){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},w=[...jo];return ns(h,w),ns(i,w),{fragmentSource:h=h.replace(c,(A,O,$,W,G)=>(y[G]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${G}\nvarying ${$} ${W} ${G};\n#else\nuniform ${$} ${W} u_${G};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${G}\n    ${$} ${W} ${G} = u_${G};\n#endif\n`)),vertexSource:i=i.replace(c,(A,O,$,W,G)=>{const ae="float"===W?"vec2":"vec4",De=G.match(/color/)?"color":ae;return y[G]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${G}\nuniform lowp float u_${G}_t;\nattribute ${$} ${ae} a_${G};\nvarying ${$} ${W} ${G};\n#else\nuniform ${$} ${W} u_${G};\n#endif\n`:"vec4"===De?`\n#ifndef HAS_UNIFORM_u_${G}\n    ${G} = a_${G};\n#else\n    ${$} ${W} ${G} = u_${G};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${G}\n    ${G} = unpack_mix_${De}(a_${G}, u_${G}_t);\n#else\n    ${$} ${W} ${G} = u_${G};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${G}\nuniform lowp float u_${G}_t;\nattribute ${$} ${ae} a_${G};\n#else\nuniform ${$} ${W} u_${G};\n#endif\n`:"vec4"===De?`\n#ifndef HAS_UNIFORM_u_${G}\n    ${$} ${W} ${G} = a_${G};\n#else\n    ${$} ${W} ${G} = u_${G};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${G}\n    ${$} ${W} ${G} = unpack_mix_${De}(a_${G}, u_${G}_t);\n#else\n    ${$} ${W} ${G} = u_${G};\n#endif\n`}),staticAttributes:p,usedDefines:w}}class ka{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,c,p,y,w,A,O){this.context=i;let $=this.boundPaintVertexBuffers.length!==y.length;for(let G=0;!$&&G<y.length;G++)this.boundPaintVertexBuffers[G]!==y[G]&&($=!0);let W=this.boundDynamicVertexBuffers.length!==O.length;for(let G=0;!W&&G<O.length;G++)this.boundDynamicVertexBuffers[G]!==O[G]&&(W=!0);if(!i.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||$||W||this.boundIndexBuffer!==w||this.boundVertexOffset!==A)this.freshBind(c,p,y,w,A,O);else{i.bindVertexArrayOES.set(this.vao);for(const G of O)G&&G.bind();w&&w.dynamicDraw&&w.bind()}}freshBind(i,c,p,y,w,A){let O;const $=i.numAttributes,W=this.context,G=W.gl;if(W.extVertexArrayObject)this.vao&&this.destroy(),this.vao=W.extVertexArrayObject.createVertexArrayOES(),W.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=A;else{O=W.currentNumAttributes||0;for(let ae=$;ae<O;ae++)G.disableVertexAttribArray(ae)}c.enableAttributes(G,i),c.bind(),c.setVertexAttribPointers(G,i,w);for(const ae of p)ae.enableAttributes(G,i),ae.bind(),ae.setVertexAttribPointers(G,i,w);for(const ae of A)ae&&(ae.enableAttributes(G,i),ae.bind(),ae.setVertexAttribPointers(G,i,w));y&&y.bind(),W.currentNumAttributes=$}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function As(h,i){const c=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new l.MercatorCoordinate(0,p/c).toLngLat().lat,new l.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function va(h,i,c,p,y,w,A){const O=h.context,$=O.gl,W=c.fbo;if(!W)return;h.prepareDrawTile();const G=h.useProgram("hillshade");O.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,W.colorAttachment.get());const ae=((be,Pe,se,Ie)=>{const We=se.paint.get("hillshade-shadow-color"),Xe=se.paint.get("hillshade-highlight-color"),ft=se.paint.get("hillshade-accent-color");let Ct=se.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===se.paint.get("hillshade-illumination-anchor")&&(Ct-=be.transform.angle);const Dt=!be.options.moving;return{u_matrix:Ie||be.transform.calculateProjMatrix(Pe.tileID.toUnwrapped(),Dt),u_image:0,u_latrange:As(0,Pe.tileID),u_light:[se.paint.get("hillshade-exaggeration"),Ct],u_shadow:We,u_highlight:Xe,u_accent:ft}})(h,c,p,h.terrain?i.projMatrix:null);h.prepareDrawProgram(O,G,i.toUnwrapped());const{tileBoundsBuffer:De,tileBoundsIndexBuffer:ye,tileBoundsSegments:Ee}=h.getTileBoundsBuffers(c);G.draw(O,$.TRIANGLES,y,w,A,l.CullFaceMode.disabled,ae,p.id,De,ye,Ee)}function Ho(h,i,c){if(!i.needsDEMTextureUpload)return;const p=h.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||h.getTileTexture(c.stride);const w=c.getPixels();i.demTexture?i.demTexture.update(w,{premultiply:!1}):i.demTexture=new l.Texture(p,w,y.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function js(h,i,c,p,y,w){const A=h.context,O=A.gl;if(!i.dem)return;const $=i.dem;if(A.activeTexture.set(O.TEXTURE1),Ho(h,i,$),!i.demTexture)return;i.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const W=$.dim;A.activeTexture.set(O.TEXTURE0);let G=i.fbo;if(!G){const Ee=new l.Texture(A,{width:W,height:W,data:null},O.RGBA);Ee.bind(O.LINEAR,O.CLAMP_TO_EDGE),G=i.fbo=A.createFramebuffer(W,W,!0),G.colorAttachment.set(Ee.texture)}A.bindFramebuffer.set(G.framebuffer),A.viewport.set([0,0,W,W]);const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:De,tileBoundsSegments:ye}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(A,O.TRIANGLES,p,y,w,l.CullFaceMode.disabled,((Ee,be)=>{const Pe=be.stride,se=l.create();return l.ortho(se,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(se,se,[0,-l.EXTENT,0]),{u_matrix:se,u_image:1,u_dimension:[Pe,Pe],u_zoom:Ee.overscaledZ,u_unpack:be.unpackVector}})(i.tileID,$),c.id,ae,De,ye),i.needsHillshadePrepare=!1}const uo=h=>({u_matrix:new l.UniformMatrix4f(h),u_image0:new l.Uniform1i(h),u_skirt_height:new l.Uniform1f(h)}),Mo=(h,i)=>({u_matrix:h,u_image0:0,u_skirt_height:i}),so=(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:y,u_merc_center:w,u_image0:0,u_frustum_tl:A,u_frustum_tr:O,u_frustum_br:$,u_frustum_bl:W,u_globe_pos:G,u_globe_radius:ae,u_viewport:De,u_grid_matrix:Ee?Float32Array.from(Ee):new Float32Array(9),u_skirt_height:ye});function xa(h,i){return null!=h&&null!=i&&!(!h.hasData()||!i.hasData())&&null!=h.demTexture&&null!=i.demTexture&&h.tileID.key!==i.tileID.key}const Bi=new class{constructor(){this.operations={}}newMorphing(h,i,c,p,y){if(h in this.operations){const w=this.operations[h];w.to.tileID.key!==c.tileID.key&&(w.queued=c)}else this.operations[h]={startTime:p,phase:0,duration:y,from:i,to:c,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const i=this.operations[h];return{from:i.from,to:i.to,phase:i.phase}}update(h){for(const i in this.operations){const c=this.operations[i];for(c.phase=(h-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,h)){delete this.operations[i];break}}}_nextOp(h,i){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=i,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Zi={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Hs(h){return 6*Math.pow(1.5,22-h)}function gs(h,i){const c=1<<h.z;return!i&&(0===h.x||h.x===c-1)||0===h.y||h.y===c-1}const us=h=>({u_matrix:h});function Xo(h,i,c,p,y){if(y>0){const w=l.exported.now(),A=(w-h.timeAdded)/y,O=i?(w-i.timeAdded)/y:-1,$=c.getSource(),W=p.coveringZoomLevel({tileSize:$.tileSize,roundZoom:$.roundZoom}),G=!i||Math.abs(i.tileID.overscaledZ-W)>Math.abs(h.tileID.overscaledZ-W),ae=G&&h.refreshedUponExpiration?1:l.clamp(G?A:1-O,0,1);return h.refreshedUponExpiration&&A>=1&&(h.refreshedUponExpiration=!1),i?{opacity:1,mix:1-ae}:{opacity:ae,mix:0}}return{opacity:1,mix:0}}class sa extends l.SourceCache{constructor(i){const c={type:"raster-dem",maxzoom:i.transform.maxZoom},p=new en(ro(),null),y=ot("mock-dem",c,p,i.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class ba extends l.SourceCache{constructor(i){const c=ot("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new en(ro(),null),i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,p){if(i.freezeTileCoverage)return;this.transform=i;const y=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,A)=>{if(w[A.key]="",!this._tiles[A.key]){const O=new l.Tile(A,this._source.tileSize*A.overscaleFactor(),i.tileZoom);O.state="loaded",this._tiles[A.key]=O}return w},{});for(const w in this._tiles)w in y||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(i){const c=this.proxyCachedFBO[i];if(void 0!==c){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Js extends l.OverscaledTileID{constructor(i,c,p){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class P extends l.Elevation{constructor(i,c){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,w]=function($){const W=new l.StructArrayLayout2i4,G=new l.StructArrayLayout3ui6;W.reserve(17161),G.reserve(33800);const De=l.EXTENT/128,ye=l.EXTENT+De/2,Ee=ye+De;for(let Pe=-De;Pe<Ee;Pe+=De)for(let se=-De;se<Ee;se+=De){const Ie=se<0||se>ye||Pe<0||Pe>ye?24575:0,We=l.clamp(Math.round(se),0,l.EXTENT),Xe=l.clamp(Math.round(Pe),0,l.EXTENT);W.emplaceBack(We+Ie,Xe)}const be=(Pe,se)=>{const Ie=131*se+Pe;G.emplaceBack(Ie+1,Ie,Ie+131),G.emplaceBack(Ie+131,Ie+131+1,Ie+1)};for(let Pe=1;Pe<129;Pe++)for(let se=1;se<129;se++)be(se,Pe);return[0,129].forEach(Pe=>{for(let se=0;se<130;se++)be(se,Pe),be(Pe,se)}),[W,G,32768]}(),A=i.context;this.gridBuffer=A.createVertexBuffer(p,l.posAttributes.members),this.gridIndexBuffer=A.createIndexBuffer(y),this.gridSegments=l.SegmentVector.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,p.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ba(c.map),this.orthoMatrix=l.create(),l.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,l.EXTENT,0,l.EXTENT,0,1);const O=A.gl;this._overlapStencilMode=new l.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new sa(c.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(i,c,p){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const y=i.terrain.properties;this.sourceCache=0===i.terrain.drapeRenderMode?this._mockSourceCache:i._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const w=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const A=this.getScaledDemTileSize();this.sourceCache.update(c,A,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),c.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&l.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=0===p._centerAltitude&&-1===this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(p.center),-1),this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=c.getIds().map($=>{const W=c.getTileByID($).tileID;return W.projMatrix=p.calculateProjMatrix(W.toUnwrapped()),W});(function($,W){const G=W.transform.pointCoordinate(W.transform.getCameraPoint()),ae=new l.Point(G.x,G.y);$.sort((De,ye)=>{if(ye.overscaledZ-De.overscaledZ)return ye.overscaledZ-De.overscaledZ;const Ee=new l.Point(De.canonical.x+(1<<De.canonical.z)*De.wrap,De.canonical.y),be=new l.Point(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),Pe=ae.mult(1<<De.canonical.z);return Pe.x-=.5,Pe.y-=.5,Pe.distSqr(Ee)-Pe.distSqr(be)})})(y,this.painter),this._previousZoom=p.zoom;const w=this.proxyToSource||{};this.proxyToSource={},y.forEach($=>{this.proxyToSource[$.key]={}}),this.terrainTileForTile={};const A=this._style._sourceCaches;for(const $ in A){const W=A[$];if(!W.used||(W!==this.sourceCache&&this.resetTileLookupCache(W.id),this._setupProxiedCoordsForOrtho(W,i[$],w),W.usedForTerrain))continue;const G=i[$];W.getSource().reparseOverscaled&&this._assignTerrainTiles(G)}this.proxiedCoords[c.id]=y.map($=>new Js($,$.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const O={};this._visibleDemTiles=[];for(const $ of this.proxyCoords){const W=this.terrainTileForTile[$.key];if(!W)continue;const G=W.tileID.key;G in O||(this._visibleDemTiles.push(W),O[G]=G)}}_assignTerrainTiles(i){this._initializing||i.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],w=y.dem;!w||y.demTexture&&!y.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),Ho(this.painter,y,w))}}_prepareDemTileUniforms(i,c,p,y){if(!c||null==c.demTexture)return!1;const w=i.tileID.canonical,A=Math.pow(2,c.tileID.canonical.z-w.z),O=y||"";return p[`u_dem_tl${O}`]=[w.x*A%1,w.y*A%1],p[`u_dem_scale${O}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,c=i.gl;if(!this._emptyDepthBufferTexture){const p=new l.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new l.Texture(i,p,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const c=this._visibleDemTiles.reduce((p,y)=>{if(!y.dem)return p;const w=y.dem.tree.minimums[0];return w>0&&i++,p+w},0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),y=new l.RGBAImage({width:1,height:1},new Uint8Array(l.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(y,{premultiply:!1}):w=this._emptyDEMTexture=new l.Texture(i,y,c.RGBA,{premultiply:!1}),w}setupElevationDraw(i,c,p){const y=this.painter.context,w=y.gl,A=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;A.u_dem_size=this.sourceCache.getSource().tileSize,A.u_exaggeration=this.exaggeration();let $=null,W=null,G=1;if(p&&p.morphing&&this._useVertexMorphing){const ae=p.morphing.srcDemTile,De=p.morphing.dstDemTile;G=p.morphing.phase,ae&&De&&(this._prepareDemTileUniforms(i,ae,A,"_prev")&&(W=ae),this._prepareDemTileUniforms(i,De,A)&&($=De))}if(W&&$?(y.activeTexture.set(w.TEXTURE2),$.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),y.activeTexture.set(w.TEXTURE4),W.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),A.u_dem_lerp=G):($=this.terrainTileForTile[i.tileID.key],y.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(i,$,A)?$.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE)),y.activeTexture.set(w.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),this._depthFBO&&(A.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),A.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&$){const ae=(1<<$.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=ae}if(p&&p.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(y,A),"globe"===this.painter.transform.projection.name){const ae=this.globeUniformValues(this.painter.transform,i.tileID.canonical,p&&p.useDenormalizedUpVectorScale);c.setGlobeUniformValues(y,ae)}}globeUniformValues(i,c,p){const y=i.projection;return{u_tile_tl_up:y.upVector(c,0,0),u_tile_tr_up:y.upVector(c,l.EXTENT,0),u_tile_br_up:y.upVector(c,l.EXTENT,l.EXTENT),u_tile_bl_up:y.upVector(c,0,l.EXTENT),u_tile_up_scale:p?l.globeMetersToEcef(1):y.upVectorScale(c,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const c=this.painter,p=this.painter.context;0!==i.length&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,w,A,O,$){if("globe"===y.transform.projection.name)!function(W,G,ae,De,ye){const Ee=W.context,be=Ee.gl;let Pe,se;const Ie=W.options.showTerrainWireframe?2:0,We=W.transform,Xe=l.globeUseCustomAntiAliasing(W,Ee,We),ft=(Fn,nn)=>{if(se===Fn)return;const En=[Zi[Fn],"PROJECTION_GLOBE_VIEW"];Xe&&En.push("CUSTOM_ANTIALIASING"),nn&&En.push(Zi[Ie]),Pe=W.useProgram("globeRaster",null,En),se=Fn},Ct=W.colorModeForRenderPass(),Dt=new l.DepthMode(be.LEQUAL,l.DepthMode.ReadWrite,W.depthRangeFor3D);Bi.update(ye);const Rt=l.calculateGlobeMercatorMatrix(We),Mt=[l.mercatorXfromLng(We.center.lng),l.mercatorYfromLat(We.center.lat)],Wt=Ie?[!1,!0]:[!1],On=W.globeSharedBuffers,qt=[We.width*l.exported.devicePixelRatio,We.height*l.exported.devicePixelRatio],Tn=Float32Array.from(We.globeMatrix),un={useDenormalizedUpVectorScale:!0};if(Wt.forEach(Fn=>{const nn=W.transform,En=Hs(nn.zoom)*G.exaggeration();se=-1;const zn=Fn?be.LINES:be.TRIANGLES;for(const Rn of De){const Vn=ae.getTile(Rn),Ar=l.StencilMode.disabled,Xr=G.prevTerrainTileForTile[Rn.key],dr=G.terrainTileForTile[Rn.key];xa(Xr,dr)&&Bi.newMorphing(Rn.key,Xr,dr,ye,250),Ee.activeTexture.set(be.TEXTURE0),Vn.texture.bind(be.LINEAR,be.CLAMP_TO_EDGE);const Ur=Bi.getMorphValuesForProxy(Rn.key),gi=Ur?1:0;Ur&&l.extend$1(un,{morphing:{srcDemTile:Ur.from,dstDemTile:Ur.to,phase:l.easeCubicInOut(Ur.phase)}});const pi=l.tileCornersToBounds(Rn.canonical),br=l.getLatitudinalLod(pi.getCenter().lat),Xi=l.getGridMatrix(Rn.canonical,pi,br,nn.worldSize/nn._pixelsPerMercatorPixel),_i=l.globeNormalizeECEF(l.globeTileBounds(Rn.canonical)),fo=so(nn.projMatrix,Tn,Rt,_i,l.globeToMercatorTransition(nn.zoom),Mt,nn.frustumCorners.TL,nn.frustumCorners.TR,nn.frustumCorners.BR,nn.frustumCorners.BL,nn.globeCenterInViewSpace,nn.globeRadius,qt,En,Xi);if(ft(gi,Fn),G.setupElevationDraw(Vn,Pe,un),W.prepareDrawProgram(Ee,Pe,Rn.toUnwrapped()),On){const[lo,Ns,zs]=Fn?On.getWirefameBuffers(W.context,br):On.getGridBuffers(br,0!==En);Pe.draw(Ee,zn,Dt,Ar,Ct,l.CullFaceMode.backCCW,fo,"globe_raster",lo,Ns,zs)}}}),On){const Fn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Xe&&Fn.push("CUSTOM_ANTIALIASING"),Pe=W.useProgram("globeRaster",null,Fn);for(const nn of De){const{x:En,y:zn,z:Rn}=nn.canonical,Vn=0===zn,Ar=zn===(1<<Rn)-1,[Xr,dr,Ur,gi]=On.getPoleBuffers(Rn);if(gi&&(Vn||Ar)){const pi=ae.getTile(nn);Ee.activeTexture.set(be.TEXTURE0),pi.texture.bind(be.LINEAR,be.CLAMP_TO_EDGE);let br=l.globePoleMatrixForTile(Rn,En,We);const Xi=l.globeNormalizeECEF(l.globeTileBounds(nn.canonical)),_i=(fo,lo)=>fo.draw(Ee,be.TRIANGLES,Dt,l.StencilMode.disabled,Ct,l.CullFaceMode.disabled,so(We.projMatrix,br,br,Xi,0,Mt,We.frustumCorners.TL,We.frustumCorners.TR,We.frustumCorners.BR,We.frustumCorners.BL,We.globeCenterInViewSpace,We.globeRadius,qt,0),"globe_pole_raster",lo,Ur,gi);G.setupElevationDraw(pi,Pe,un),W.prepareDrawProgram(Ee,Pe,nn.toUnwrapped()),Vn&&_i(Pe,Xr),Ar&&(br=l.scale(l.create(),br,[1,-1,1]),_i(Pe,dr))}}}}(y,w,A,O,$);else{const W=y.context,G=W.gl;let ae,De;const ye=y.options.showTerrainWireframe?2:0,Ee=(We,Xe)=>{if(De===We)return;const ft=[Zi[We]];Xe&&ft.push(Zi[ye]),ae=y.useProgram("terrainRaster",null,ft),De=We},be=y.colorModeForRenderPass(),Pe=new l.DepthMode(G.LEQUAL,l.DepthMode.ReadWrite,y.depthRangeFor3D);Bi.update($);const se=y.transform,Ie=Hs(se.zoom)*w.exaggeration();(ye?[!1,!0]:[!1]).forEach(We=>{De=-1;const Xe=We?G.LINES:G.TRIANGLES,[ft,Ct]=We?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const Dt of O){const Rt=A.getTile(Dt),Mt=l.StencilMode.disabled,Wt=w.prevTerrainTileForTile[Dt.key],On=w.terrainTileForTile[Dt.key];xa(Wt,On)&&Bi.newMorphing(Dt.key,Wt,On,$,250),W.activeTexture.set(G.TEXTURE0),Rt.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST);const qt=Bi.getMorphValuesForProxy(Dt.key),Tn=qt?1:0;let un;qt&&(un={morphing:{srcDemTile:qt.from,dstDemTile:qt.to,phase:l.easeCubicInOut(qt.phase)}});const Fn=Mo(Dt.projMatrix,gs(Dt.canonical,se.renderWorldCopies)?Ie/10:Ie);Ee(Tn,We),w.setupElevationDraw(Rt,ae,un),y.prepareDrawProgram(W,ae,Dt.toUnwrapped()),ae.draw(W,Xe,Pe,Mt,be,l.CullFaceMode.backCCW,Fn,"terrain_raster",w.gridBuffer,ft,Ct)}})}}(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,y=this.proxySourceCache,w=this.proxiedCoords[y.id],A=this._drapedRenderBatches.shift(),O=[],$=c.style.order;let W=0;for(const G of w){const ae=y.getTileByID(G.proxyTileKey),De=y.proxyCachedFBO[G.key]?y.proxyCachedFBO[G.key][i]:void 0,ye=void 0!==De?y.renderCache[De]:this.pool[W++],Ee=void 0!==De;if(ae.texture=ye.tex,Ee&&!ye.dirty){O.push(ae.tileID);continue}let be;p.bindFramebuffer.set(ye.fb.framebuffer),this.renderedToTile=!1,ye.dirty&&(p.clear({color:l.Color.transparent,stencil:0}),ye.dirty=!1);for(let Pe=A.start;Pe<=A.end;++Pe){const se=c.style._layers[$[Pe]];if(se.isHidden(c.transform.zoom))continue;const Ie=c.style._getLayerSourceCache(se),We=Ie?this.proxyToSource[G.key][Ie.id]:[G];if(!We)continue;const Xe=We;p.viewport.set([0,0,ye.fb.width,ye.fb.height]),be!==(Ie?Ie.id:null)&&(this._setupStencil(ye,We,se,Ie),be=Ie?Ie.id:null),c.renderLayer(c,Ie,se,Xe)}this.renderedToTile?(ye.dirty=!0,O.push(ae.tileID)):Ee||--W,5===W&&(W=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),A.end+1}postRender(){}renderCacheEfficiency(i){const c=i.order.length;if(0===c)return{efficiency:100};let p,y=0,w=0,A=!1;for(let O=0;O<c;++O){const $=i._layers[i.order[O]];this._style.isLayerDraped($)?(A&&++y,++w):A||(A=!0,p=$.id)}return 0===w?{efficiency:100}:{efficiency:100*(1-y/w),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{i=Math.min(i,c.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,c,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const A=w.tileID,O=1<<A.overscaledZ,{x:$,y:W}=A.canonical,G=$/O,ae=($+1)/O,De=W/O,ye=(W+1)/O;return{minx:G,miny:De,maxx:ae,maxy:ye,t:w.dem.tree.raycastRoot(G,De,ae,ye,i,c,p),tile:w}});y.sort((w,A)=>(null!==w.t?w.t:Number.MAX_VALUE)-(null!==A.t?A.t:Number.MAX_VALUE));for(const w of y){if(null==w.t)return null;const A=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,i,c,p);if(null!=A)return A}return null}_createFBO(){const i=this.painter.context,c=i.gl,p=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const y=new l.Texture(i,{width:p[0],height:p[1],data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);const w=i.createFramebuffer(p[0],p[1],!1);return w.colorAttachment.set(y.texture),w.depthAttachment=new xt(i,w.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:w,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const c=this._style._layers[i],p=c.isHidden(this.painter.transform.zoom);return"custom"===c.type?!p&&c.shouldRedrape():!p&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let i=!1;for(const p of this._style._getSources())if(p instanceof Be){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const y=this._style._layers[this._style.order[p]],w=this._style._getLayerSourceCache(y);if(w&&!c[w.id]&&!y.isHidden(this.painter.transform.zoom)&&"line"===y.type&&y.widthExpression()instanceof l.ZoomDependentExpression){c[w.id]=!0;for(const A of this.proxyCoords){const O=this.proxyToSource[A.key][w.id];if(O)for(const $ of O)this._clearRenderCacheForTile(w.id,$)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const p in this._style._sourceCaches)if(this._style._sourceCaches[p]._source instanceof le){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const y=this._style._layers[this._style.order[p]],w=this._style._getLayerSourceCache(y);if(!w||c[w.id]||y.isHidden(this.painter.transform.zoom)||"raster"!==y.type)continue;const A=y.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const $=this.proxyToSource[O.key][w.id];if($)for(const W of $){const G=Xo(w.getTile(W),w.findLoadedParent(W,0),w,this.painter.transform,A);(1!==G.opacity||0!==G.mix)&&this._clearRenderCacheForTile(w.id,W)}}}}_setupDrapedRenderBatches(){const i=this._style.order,c=i.length;if(0===c)return;const p=[];let y,w=0,A=this._style._layers[i[w]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++w<c;)A=this._style._layers[i[w]];for(;w<c;++w){const O=this._style._layers[i[w]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===y&&(y=w):void 0!==y&&(p.push({start:y,end:w-1}),y=void 0))}void 0!==y&&p.push({start:y,end:w-1}),this._drapedRenderBatches=p}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const A=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let O=0;O<A.length;++O){const $=Object.values(A[O]);c.renderCachePool.push(...$)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let A=p.length-1;A>=0;A--){const O=p[A];if(c.getTileByID(O.key),void 0!==c.proxyCachedFBO[O.key]){const $=i[O.key],W=this.proxyToSource[O.key];let G=0;for(const ae in W){const De=W[ae],ye=$[ae];if(!ye||ye.length!==De.length||De.some((Ee,be)=>Ee!==ye[be]||y[ae]&&y[ae].hasOwnProperty(Ee.key))){G=-1;break}++G}for(const ae in c.proxyCachedFBO[O.key])c.renderCache[c.proxyCachedFBO[O.key][ae]].dirty=G<0||G!==Object.values($).length}}const w=[...this._drapedRenderBatches];w.sort((A,O)=>O.end-O.start-(A.end-A.start));for(const A of w)for(const O of p){if(c.proxyCachedFBO[O.key])continue;let $=c.renderCachePool.pop();void 0===$&&c.renderCache.length<50&&($=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==$&&(c.proxyCachedFBO[O.key]={},c.proxyCachedFBO[O.key][A.start]=$,c.renderCache[$].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,A=w.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let O;if(p.isTileClipped())O=c.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(i,c){const p=this.painter,y=this.painter.context,w=y.gl;p._tileClippingMaskIDs={},y.setColorMode(l.ColorMode.disabled),y.setDepthMode(l.DepthMode.disabled);const A=p.useProgram("clippingMask");for(const O of i){const $=p._tileClippingMaskIDs[O.key]=--c;A.draw(y,w.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:w.ALWAYS,mask:0},$,255,w.KEEP,w.KEEP,w.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,us(O.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const p=[i.x,i.y,1,1];l.transformMat4$1(p,p,c.pixelMatrixInverse),l.scale$1(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const y=c._camera.position,w=l.mercatorZfromAltitude(1,c.center.lat),A=[y[0],y[1],y[2]/w,0],O=l.subtract([],p.slice(0,3),A);l.normalize(O,O);const $=this.raycast(A,O,this._exaggeration);return null!==$&&$?(l.scaleAndAdd(A,A,O,$),A[3]=A[2],A[2]*=w,A):null}drawDepth(){const i=this.painter,c=i.context,p=this.proxySourceCache,y=Math.ceil(i.width),w=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===w||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const A=c.gl,O=c.createFramebuffer(y,w,!0);c.activeTexture.set(A.TEXTURE0);const $=new l.Texture(c,{width:y,height:w,data:null},A.RGBA);$.bind(A.NEAREST,A.CLAMP_TO_EDGE),O.colorAttachment.set($.texture);const W=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,y,w);O.depthAttachment.set(W),this._depthFBO=O,this._depthTexture=$}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,y,w]),function(A,O,$,W){if("globe"===A.transform.projection.name)return;const G=A.context,ae=G.gl;G.clear({depth:1});const De=A.useProgram("terrainDepth"),ye=new l.DepthMode(ae.LESS,l.DepthMode.ReadWrite,A.depthRangeFor3D);for(const Ee of W){const be=$.getTile(Ee),Pe=Mo(Ee.projMatrix,0);O.setupElevationDraw(be,De),De.draw(G,ae.TRIANGLES,ye,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,Pe,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(i,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,c,p){if(i.getSource()instanceof Ne)return this._setupProxiedCoordsForImageSource(i,c,p);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const y=this.proxiedCoords[i.id]=[],w=this.proxyCoords;for(let O=0;O<w.length;O++){const $=w[O],W=this._findTileCoveringTileID($,i);if(W){const G=this._createProxiedId($,W,p[$.key]&&p[$.key][i.id]);y.push(G),this.proxyToSource[$.key][i.id]=[G]}}let A=!1;for(let O=0;O<c.length;O++){const $=i.getTile(c[O]);if(!$||!$.hasData())continue;const W=this._findTileCoveringTileID($.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==$.tileID.canonical.z){const G=this.proxyToSource[W.tileID.key][i.id],ae=this._createProxiedId(W.tileID,$,p[W.tileID.key]&&p[W.tileID.key][i.id]);G?G.splice(G.length-1,0,ae):this.proxyToSource[W.tileID.key][i.id]=[ae],y.push(ae),A=!0}}this._sourceTilesOverlap[i.id]=A}_setupProxiedCoordsForImageSource(i,c,p){if(!i.getSource().loaded())return;const y=this.proxiedCoords[i.id]=[],w=this.proxyCoords,A=i.getSource(),O=new l.Point(A.tileID.x,A.tileID.y)._div(1<<A.tileID.z),$=A.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((G,ae)=>(G.min.x=Math.min(G.min.x,ae.x-O.x),G.min.y=Math.min(G.min.y,ae.y-O.y),G.max.x=Math.max(G.max.x,ae.x-O.x),G.max.y=Math.max(G.max.y,ae.y-O.y),G),{min:new l.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(G,ae)=>{const De=G.wrap+G.canonical.x/(1<<G.canonical.z),ye=G.canonical.y/(1<<G.canonical.z),Ee=l.EXTENT/(1<<G.canonical.z),be=ae.wrap+ae.canonical.x/(1<<ae.canonical.z),Pe=ae.canonical.y/(1<<ae.canonical.z);return De+Ee<be+$.min.x||De>be+$.max.x||ye+Ee<Pe+$.min.y||ye>Pe+$.max.y};for(let G=0;G<w.length;G++){const ae=w[G];for(let De=0;De<c.length;De++){const ye=i.getTile(c[De]);if(!ye||!ye.hasData()||W(ae,ye.tileID))continue;const Ee=this._createProxiedId(ae,ye,p[ae.key]&&p[ae.key][i.id]),be=this.proxyToSource[ae.key][i.id];be?be.push(Ee):this.proxyToSource[ae.key][i.id]=[Ee],y.push(Ee)}}}_createProxiedId(i,c,p){let y=this.orthoMatrix;if(p){const w=p.find(A=>A.key===c.tileID.key);if(w)return w}if(c.tileID.key!==i.key){const w=i.canonical.z-c.tileID.canonical.z;let A,O,$;y=l.create();const W=c.tileID.wrap-i.wrap<<i.overscaledZ;w>0?(A=l.EXTENT>>w,O=A*((c.tileID.canonical.x<<w)-i.canonical.x+W),$=A*((c.tileID.canonical.y<<w)-i.canonical.y)):(A=l.EXTENT<<-w,O=l.EXTENT*(c.tileID.canonical.x-(i.canonical.x+W<<-w)),$=l.EXTENT*(c.tileID.canonical.y-(i.canonical.y<<-w))),l.ortho(y,0,A,0,A,0,1),l.translate(y,y,[O,$,0])}return new Js(c.tileID,i.key,y)}_findTileCoveringTileID(i,c){let p=c.getTile(i);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[c.id],w=y[i.key];if(p=w?c.getTileByID(w):null,p&&p.hasData()||null===w)return p;let A=p?p.tileID:i,O=A.overscaledZ;const $=c.getSource().minzoom,W=[];if(!w){const ae=c.getSource().maxzoom;if(i.canonical.z>=ae){const De=i.canonical.z-ae;c.getSource().reparseOverscaled?(O=Math.max(i.canonical.z+2,c.transform.tileZoom),A=new l.OverscaledTileID(O,i.wrap,ae,i.canonical.x>>De,i.canonical.y>>De)):0!==De&&(O=ae,A=new l.OverscaledTileID(O,i.wrap,ae,i.canonical.x>>De,i.canonical.y>>De))}A.key!==i.key&&(W.push(A.key),p=c.getTile(A))}const G=ae=>{W.forEach(De=>{y[De]=ae}),W.length=0};for(O-=1;O>=$&&(!p||!p.hasData());O--){p&&G(p.tileID.key);const ae=A.calculateScaledKey(O);if(p=c.getTileByID(ae),p&&p.hasData())break;const De=y[ae];if(null===De)break;void 0===De?W.push(ae):p=c.getTileByID(De)}return G(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let p=this._tilesDirty[i];p||(p=this._tilesDirty[i]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(c){let p=0;const y=new l.StructArrayLayout2ui4,w=131;for(let A=1;A<129;A++){for(let O=1;O<129;O++)p=A*w+O,y.emplaceBack(p,p+1),y.emplaceBack(p,p+w),y.emplaceBack(p+1,p+w),128===A&&y.emplaceBack(p+w,p+w+1);y.emplaceBack(p+1,p+1+w)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class J{static cacheKey(i,c,p,y){let w=`${c}${y?y.cacheKey:""}`;for(const A of p)i.usedDefines.includes(A)&&(w+=`/${A}`);return w}constructor(i,c,p,y,w,A){const O=i.gl;this.program=O.createProgram();const $=function(se){const Ie=[];for(let We=0;We<se.length;We++){if(null===se[We])continue;const Xe=se[We].split(" ");Ie.push(Xe.pop())}return Ie}(p.staticAttributes),W=y?y.getBinderAttributes():[],G=$.concat(W);let ae=y?y.defines():[];ae=ae.concat(A.map(se=>`#define ${se}`));const De=i.isWebGL2?"#version 300 es\n":"",ye=De+ae.concat(i.extStandardDerivatives&&0===De.length?"#extension GL_OES_standard_derivatives : enable\n".concat(cs):cs,cs,ms,oa.fragmentSource,Uo.fragmentSource,p.fragmentSource).join("\n"),Ee=De+ae.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ms,oa.vertexSource,Uo.vertexSource,Ro.vertexSource,p.vertexSource).join("\n"),be=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(be,ye),O.compileShader(be),O.attachShader(this.program,be);const Pe=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(Pe,Ee),O.compileShader(Pe),O.attachShader(this.program,Pe),this.attributes={},this.numAttributes=G.length;for(let se=0;se<this.numAttributes;se++)G[se]&&(O.bindAttribLocation(this.program,se,G[se]),this.attributes[G[se]]=se);O.linkProgram(this.program),O.deleteShader(Pe),O.deleteShader(be),this.fixedUniforms=w(i),this.binderUniforms=y?y.getUniforms(i):[],A.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new l.Uniform1i(se=i),u_dem_prev:new l.Uniform1i(se),u_dem_unpack:new l.Uniform4f(se),u_dem_tl:new l.Uniform2f(se),u_dem_scale:new l.Uniform1f(se),u_dem_tl_prev:new l.Uniform2f(se),u_dem_scale_prev:new l.Uniform1f(se),u_dem_size:new l.Uniform1f(se),u_dem_lerp:new l.Uniform1f(se),u_exaggeration:new l.Uniform1f(se),u_depth:new l.Uniform1i(se),u_depth_size_inv:new l.Uniform2f(se),u_meter_to_dem:new l.Uniform1f(se),u_label_plane_matrix_inv:new l.UniformMatrix4f(se)}),A.includes("GLOBE")&&(this.globeUniforms=(se=>({u_tile_tl_up:new l.Uniform3f(se),u_tile_tr_up:new l.Uniform3f(se),u_tile_br_up:new l.Uniform3f(se),u_tile_bl_up:new l.Uniform3f(se),u_tile_up_scale:new l.Uniform1f(se)}))(i)),A.includes("FOG")&&(this.fogUniforms=(se=>({u_fog_matrix:new l.UniformMatrix4f(se),u_fog_range:new l.Uniform2f(se),u_fog_color:new l.Uniform4f(se),u_fog_horizon_blend:new l.Uniform1f(se),u_fog_temporal_offset:new l.Uniform1f(se),u_frustum_tl:new l.Uniform3f(se),u_frustum_tr:new l.Uniform3f(se),u_frustum_br:new l.Uniform3f(se),u_frustum_bl:new l.Uniform3f(se),u_globe_pos:new l.Uniform3f(se),u_globe_radius:new l.Uniform1f(se),u_globe_transition:new l.Uniform1f(se),u_is_globe:new l.Uniform1i(se),u_viewport:new l.Uniform2f(se)}))(i))}var se}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y]&&p[y].set(this.program,y,c[y])}}setGlobeUniformValues(i,c){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y]&&p[y].set(this.program,y,c[y])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}draw(i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be){const Pe=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(p),i.setStencilMode(y),i.setColorMode(w),i.setCullFace(A);for(const Ie of Object.keys(this.fixedUniforms))this.fixedUniforms[Ie].set(this.program,Ie,O[Ie]);Ee&&Ee.setUniforms(this.program,i,this.binderUniforms,De,{zoom:ye});const se={[Pe.LINES]:2,[Pe.TRIANGLES]:3,[Pe.LINE_STRIP]:1}[c];for(const Ie of ae.get()){const We=Ie.vaos||(Ie.vaos={});(We[$]||(We[$]=new ka)).bind(i,this,W,Ee?Ee.getPaintVertexBuffers():[],G,Ie.vertexOffset,be||[]),Pe.drawElements(c,Ie.primitiveLength*se,Pe.UNSIGNED_SHORT,Ie.primitiveOffset*se*2)}}}function R(h,i){const c=Math.pow(2,i.tileID.overscaledZ),p=i.tileSize*Math.pow(2,h.transform.tileZoom)/c,y=p*(i.tileID.canonical.x+i.tileID.wrap*c),w=p*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_tile_units_to_pixels:1/bt(i,1,h.transform.tileZoom),u_pixel_coord_upper:[y>>16,w>>16],u_pixel_coord_lower:[65535&y,65535&w]}}const ne=l.create(),ke=(h,i,c,p,y,w,A,O,$,W,G)=>{const ae=i.style.light,De=ae.properties.get("position"),ye=[De.x,De.y,De.z],Ee=l.create$1();"viewport"===ae.properties.get("anchor")&&(l.fromRotation(Ee,-i.transform.angle),l.transformMat3(ye,ye,Ee));const be=ae.properties.get("color"),Pe=i.transform,se={u_matrix:h,u_lightpos:ye,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[be.r,be.g,be.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ne,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:w};return"globe"===Pe.projection.name&&(se.u_tile_id=[A.canonical.x,A.canonical.y,1<<A.canonical.z],se.u_zoom_transition=$,se.u_inv_rot_matrix=G,se.u_merc_center=W,se.u_up_dir=Pe.projection.upVector(new l.CanonicalTileID(0,0,0),W[0]*l.EXTENT,W[1]*l.EXTENT),se.u_height_lift=O),se},Cn=(h,i,c,p,y,w,A,O,$,W,G,ae)=>{const De=ke(h,i,c,p,y,w,A,$,W,G,ae),ye={u_height_factor:-Math.pow(2,A.overscaledZ)/O.tileSize/8};return l.extend(De,R(i,O),ye)},lr=h=>({u_matrix:h}),ir=(h,i,c)=>l.extend(lr(h),R(i,c)),ki=(h,i)=>({u_matrix:h,u_world:i}),ao=(h,i,c,p)=>l.extend(ir(h,i,c),{u_world:p}),te=l.create(),X=(h,i,c,p,y,w)=>{const A=h.transform,O="globe"===A.projection.name;let $;if("map"===w.paint.get("circle-pitch-alignment"))if(O){const G=l.globePixelsToTileUnits(A.zoom,i.canonical)*A._pixelsPerMercatorPixel;$=Float32Array.from([G,0,0,G])}else $=A.calculatePixelsToTileUnitsMatrix(c);else $=new Float32Array([A.pixelsToGLUnits[0],0,0,A.pixelsToGLUnits[1]]);const W={u_camera_to_center_distance:A.cameraToCenterDistance,u_matrix:h.translatePosMatrix(i.projMatrix,c,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:$,u_inv_rot_matrix:te,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){W.u_inv_rot_matrix=p,W.u_merc_center=y,W.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],W.u_zoom_transition=l.globeToMercatorTransition(A.zoom);const G=y[0]*l.EXTENT,ae=y[1]*l.EXTENT;W.u_up_dir=A.projection.upVector(new l.CanonicalTileID(0,0,0),G,ae)}return W},Ae=h=>{const i=[];return"map"===h.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===h.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},re=(h,i,c,p)=>{const y=l.EXTENT/c.tileSize;return{u_matrix:h,u_camera_to_center_distance:i.getCameraToCenterDistance(p),u_extrude_scale:[i.pixelsToGLUnits[0]/y,i.pixelsToGLUnits[1]/y]}},Ye=(h,i,c=1)=>({u_matrix:h,u_color:i,u_overlay:0,u_overlay_scale:c}),$n=l.create(),$r=(h,i,c,p,y,w,A)=>{const O=h.transform,$="globe"===O.projection.name,W=$?l.globePixelsToTileUnits(O.zoom,i.canonical)*O._pixelsPerMercatorPixel:bt(c,1,w),G={u_matrix:i.projMatrix,u_extrude_scale:W,u_intensity:A,u_inv_rot_matrix:$n,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if($){G.u_inv_rot_matrix=p,G.u_merc_center=y,G.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],G.u_zoom_transition=l.globeToMercatorTransition(O.zoom);const ae=y[0]*l.EXTENT,De=y[1]*l.EXTENT;G.u_up_dir=O.projection.upVector(new l.CanonicalTileID(0,0,0),ae,De)}return G},Oo=(h,i,c,p,y,w,A)=>{const O=h.transform,$=O.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:Ko(h,i,c,p),u_pixels_to_tile_units:$,u_device_pixel_ratio:w,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:Ds(c)?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:is(i,h.transform),u_alpha_discard_threshold:0,u_trim_offset:A}},rs=(h,i,c,p,y)=>{const w=h.transform;return{u_matrix:Ko(h,i,c,p),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:w.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:is(i,w),u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function is(h,i){return 1/bt(h,1,i.tileZoom)}function Ko(h,i,c,p){return h.translatePosMatrix(p||i.tileID.projMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Ds(h){const i=h.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const La=(h,i,c,p,y,w)=>{return{u_matrix:h,u_tl_parent:i,u_scale_parent:c,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(O=y.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(A=y.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:Jo(y.paint.get("raster-hue-rotate")),u_perspective_transform:w};var A,O};function Jo(h){h*=Math.PI/180;const i=Math.sin(h),c=Math.cos(h);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const il=l.create(),Vl=(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be)=>{const Pe=y.transform,se={u_is_size_zoom_constant:+("constant"===h||"source"===h),u_is_size_feature_constant:+("constant"===h||"camera"===h),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:Pe.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:Pe.width/Pe.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:A,u_coord_matrix:O,u_is_text:+$,u_pitch_with_map:+p,u_texsize:W,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:il,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:il,u_up_vector:[0,-1,0]};return"globe"===be.name&&(se.u_tile_id=[G.canonical.x,G.canonical.y,1<<G.canonical.z],se.u_zoom_transition=ae,se.u_inv_rot_matrix=ye,se.u_merc_center=De,se.u_camera_forward=Pe._camera.forward(),se.u_ecef_origin=l.globeECEFOrigin(Pe.globeMatrix,G.toUnwrapped()),se.u_tile_matrix=Float32Array.from(Pe.globeMatrix),se.u_up_vector=Ee),se},wa=(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be,Pe)=>l.extend(Vl(h,i,c,p,y,w,A,O,$,W,ae,De,ye,Ee,be,Pe),{u_gamma_scale:p?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+G}),xl=(h,i,c,p,y,w,A,O,$,W,G,ae,De,ye,Ee,be)=>l.extend(wa(h,i,c,p,y,w,A,O,!0,$,!0,G,ae,De,ye,Ee,be),{u_texsize_icon:W,u_texture_icon:1}),Fa=(h,i,c)=>({u_matrix:h,u_opacity:i,u_color:c}),Ul=(h,i,c,p,y)=>l.extend(function(w,A,O){const $=A.imageManager.getPattern(w.toString()),{width:W,height:G}=A.imageManager.getPixelSize(),ae=Math.pow(2,O.tileID.overscaledZ),De=O.tileSize*Math.pow(2,A.transform.tileZoom)/ae,ye=De*(O.tileID.canonical.x+O.tileID.wrap*ae),Ee=De*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:$.tl,u_pattern_br:$.br,u_texsize:[W,G],u_pattern_size:$.displaySize,u_tile_units_to_pixels:1/bt(O,1,A.transform.tileZoom),u_pixel_coord_upper:[ye>>16,Ee>>16],u_pixel_coord_lower:[65535&ye,65535&Ee]}}(p,c,y),{u_matrix:h,u_opacity:i}),Ls={fillExtrusion:h=>({u_matrix:new l.UniformMatrix4f(h),u_lightpos:new l.Uniform3f(h),u_lightintensity:new l.Uniform1f(h),u_lightcolor:new l.Uniform3f(h),u_vertical_gradient:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_edge_radius:new l.Uniform1f(h),u_ao:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_up_dir:new l.Uniform3f(h),u_height_lift:new l.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_lightpos:new l.Uniform3f(h),u_lightintensity:new l.Uniform1f(h),u_lightcolor:new l.Uniform3f(h),u_vertical_gradient:new l.Uniform1f(h),u_height_factor:new l.Uniform1f(h),u_edge_radius:new l.Uniform1f(h),u_ao:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_up_dir:new l.Uniform3f(h),u_height_lift:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h)}),fill:h=>({u_matrix:new l.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),fillOutline:h=>({u_matrix:new l.UniformMatrix4f(h),u_world:new l.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_world:new l.Uniform2f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new l.Uniform1f(h),u_extrude_scale:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_up_dir:new l.Uniform3f(h)}),collisionBox:h=>({u_matrix:new l.UniformMatrix4f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_extrude_scale:new l.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new l.UniformMatrix4f(h),u_inv_matrix:new l.UniformMatrix4f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_viewport_size:new l.Uniform2f(h)}),debug:h=>({u_color:new l.UniformColor(h),u_matrix:new l.UniformMatrix4f(h),u_overlay:new l.Uniform1i(h),u_overlay_scale:new l.Uniform1f(h)}),clippingMask:h=>({u_matrix:new l.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new l.Uniform1f(h),u_intensity:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_up_dir:new l.Uniform3f(h)}),heatmapTexture:h=>({u_image:new l.Uniform1i(h),u_color_ramp:new l.Uniform1i(h),u_opacity:new l.Uniform1f(h)}),hillshade:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_latrange:new l.Uniform2f(h),u_light:new l.Uniform2f(h),u_shadow:new l.UniformColor(h),u_highlight:new l.UniformColor(h),u_accent:new l.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_dimension:new l.Uniform2f(h),u_zoom:new l.Uniform1f(h),u_unpack:new l.Uniform4f(h)}),line:h=>({u_matrix:new l.UniformMatrix4f(h),u_pixels_to_tile_units:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_units_to_pixels:new l.Uniform2f(h),u_dash_image:new l.Uniform1i(h),u_gradient_image:new l.Uniform1i(h),u_image_height:new l.Uniform1f(h),u_texsize:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_alpha_discard_threshold:new l.Uniform1f(h),u_trim_offset:new l.Uniform2f(h)}),linePattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_texsize:new l.Uniform2f(h),u_pixels_to_tile_units:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_units_to_pixels:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_alpha_discard_threshold:new l.Uniform1f(h)}),raster:h=>({u_matrix:new l.UniformMatrix4f(h),u_tl_parent:new l.Uniform2f(h),u_scale_parent:new l.Uniform1f(h),u_fade_t:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_image0:new l.Uniform1i(h),u_image1:new l.Uniform1i(h),u_brightness_low:new l.Uniform1f(h),u_brightness_high:new l.Uniform1f(h),u_saturation_factor:new l.Uniform1f(h),u_contrast_factor:new l.Uniform1f(h),u_spin_weights:new l.Uniform3f(h),u_perspective_transform:new l.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_camera_forward:new l.Uniform3f(h),u_tile_matrix:new l.UniformMatrix4f(h),u_up_vector:new l.Uniform3f(h),u_ecef_origin:new l.Uniform3f(h),u_texture:new l.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_texture:new l.Uniform1i(h),u_gamma_scale:new l.Uniform1f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_camera_forward:new l.Uniform3f(h),u_tile_matrix:new l.UniformMatrix4f(h),u_up_vector:new l.Uniform3f(h),u_ecef_origin:new l.Uniform3f(h),u_is_halo:new l.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_texsize_icon:new l.Uniform2f(h),u_texture:new l.Uniform1i(h),u_texture_icon:new l.Uniform1i(h),u_gamma_scale:new l.Uniform1f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_is_halo:new l.Uniform1i(h)}),background:h=>({u_matrix:new l.UniformMatrix4f(h),u_opacity:new l.Uniform1f(h),u_color:new l.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_opacity:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_pattern_tl:new l.Uniform2f(h),u_pattern_br:new l.Uniform2f(h),u_texsize:new l.Uniform2f(h),u_pattern_size:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),terrainRaster:uo,terrainDepth:uo,skybox:h=>({u_matrix:new l.UniformMatrix4f(h),u_sun_direction:new l.Uniform3f(h),u_cubemap:new l.Uniform1i(h),u_opacity:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new l.UniformMatrix4f(h),u_color_ramp:new l.Uniform1i(h),u_center_direction:new l.Uniform3f(h),u_radius:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new l.UniformMatrix3f(h),u_sun_direction:new l.Uniform3f(h),u_sun_intensity:new l.Uniform1f(h),u_color_tint_r:new l.Uniform4f(h),u_color_tint_m:new l.Uniform4f(h),u_luminance:new l.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new l.UniformMatrix4f(h),u_globe_matrix:new l.UniformMatrix4f(h),u_normalize_matrix:new l.UniformMatrix4f(h),u_merc_matrix:new l.UniformMatrix4f(h),u_zoom_transition:new l.Uniform1f(h),u_merc_center:new l.Uniform2f(h),u_image0:new l.Uniform1i(h),u_grid_matrix:new l.UniformMatrix3f(h),u_skirt_height:new l.Uniform1f(h),u_frustum_tl:new l.Uniform3f(h),u_frustum_tr:new l.Uniform3f(h),u_frustum_br:new l.Uniform3f(h),u_frustum_bl:new l.Uniform3f(h),u_globe_pos:new l.Uniform3f(h),u_globe_radius:new l.Uniform1f(h),u_viewport:new l.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new l.Uniform3f(h),u_frustum_tr:new l.Uniform3f(h),u_frustum_br:new l.Uniform3f(h),u_frustum_bl:new l.Uniform3f(h),u_horizon:new l.Uniform1f(h),u_transition:new l.Uniform1f(h),u_fadeout_range:new l.Uniform1f(h),u_color:new l.Uniform4f(h),u_high_color:new l.Uniform4f(h),u_space_color:new l.Uniform4f(h),u_star_intensity:new l.Uniform1f(h),u_star_density:new l.Uniform1f(h),u_star_size:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h),u_horizon_angle:new l.Uniform1f(h),u_rotation_matrix:new l.UniformMatrix4f(h)})};let Gs;function ho(h,i,c,p,y,w,A){const O=h.context,$=O.gl,W=h.transform,G=h.useProgram("collisionBox"),ae=[];let De=0,ye=0;for(let Xe=0;Xe<p.length;Xe++){const ft=p[Xe],Ct=i.getTile(ft),Dt=Ct.getBucket(c);if(!Dt)continue;const Rt=xn(ft,Dt,W);let Mt=Rt;0===y[0]&&0===y[1]||(Mt=h.translatePosMatrix(Rt,Ct,y,w));const Wt=A?Dt.textCollisionBox:Dt.iconCollisionBox,On=Dt.collisionCircleArray;if(On.length>0){const qt=l.create(),Tn=Mt;l.mul(qt,Dt.placementInvProjMatrix,W.glCoordMatrix),l.mul(qt,qt,Dt.placementViewportMatrix),ae.push({circleArray:On,circleOffset:ye,transform:Tn,invTransform:qt,projection:Dt.getProjection()}),De+=On.length/4,ye=De}Wt&&(h.terrain&&h.terrain.setupElevationDraw(Ct,G),G.draw(O,$.LINES,l.DepthMode.disabled,l.StencilMode.disabled,h.colorModeForRenderPass(),l.CullFaceMode.disabled,re(Mt,W,Ct,Dt.getProjection()),c.id,Wt.layoutVertexBuffer,Wt.indexBuffer,Wt.segments,null,W.zoom,null,[Wt.collisionVertexBuffer,Wt.collisionVertexBufferExt]))}if(!A||!ae.length)return;const Ee=h.useProgram("collisionCircle"),be=new l.StructArrayLayout2f1f2i16;be.resize(4*De),be._trim();let Pe=0;for(const Xe of ae)for(let ft=0;ft<Xe.circleArray.length/4;ft++){const Ct=4*ft,Dt=Xe.circleArray[Ct+0],Rt=Xe.circleArray[Ct+1],Mt=Xe.circleArray[Ct+2],Wt=Xe.circleArray[Ct+3];be.emplace(Pe++,Dt,Rt,Mt,Wt,0),be.emplace(Pe++,Dt,Rt,Mt,Wt,1),be.emplace(Pe++,Dt,Rt,Mt,Wt,2),be.emplace(Pe++,Dt,Rt,Mt,Wt,3)}(!Gs||Gs.length<2*De)&&(Gs=function(Xe){const ft=2*Xe,Ct=new l.StructArrayLayout3ui6;Ct.resize(ft),Ct._trim();for(let Dt=0;Dt<ft;Dt++){const Rt=6*Dt;Ct.uint16[Rt+0]=4*Dt+0,Ct.uint16[Rt+1]=4*Dt+1,Ct.uint16[Rt+2]=4*Dt+2,Ct.uint16[Rt+3]=4*Dt+2,Ct.uint16[Rt+4]=4*Dt+3,Ct.uint16[Rt+5]=4*Dt+0}return Ct}(De));const se=O.createIndexBuffer(Gs,!0),Ie=O.createVertexBuffer(be,l.collisionCircleLayout.members,!0);for(const Xe of ae){const ft={u_matrix:Xe.transform,u_inv_matrix:Xe.invTransform,u_camera_to_center_distance:(We=W).getCameraToCenterDistance(Xe.projection),u_viewport_size:[We.width,We.height]};Ee.draw(O,$.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,h.colorModeForRenderPass(),l.CullFaceMode.disabled,ft,c.id,Ie,se,l.SegmentVector.simpleSegment(0,2*Xe.circleOffset,Xe.circleArray.length,Xe.circleArray.length/2),null,W.zoom)}var We;Ie.destroy(),se.destroy()}const Fs=l.create();function bl({width:h,height:i,anchor:c,textOffset:p,textScale:y},w){const{horizontalAlign:A,verticalAlign:O}=l.getAnchorAlignment(c),$=-(A-.5)*h,W=-(O-.5)*i,G=l.evaluateVariableOffset(c,p);return new l.Point(($/y+G[0])*w,(W/y+G[1])*w)}function jl(h,i,c,p,y,w,A,O,$,W,G){const ae=h.text.placedSymbolArray,De=h.text.dynamicLayoutVertexArray,ye=h.icon.dynamicLayoutVertexArray,Ee={},be=h.getProjection(),Pe=pn(O,be,w),se=w.elevation,Ie=be.upVectorScale(O.canonical,w.center.lat,w.worldSize).metersToTile;De.clear();for(let We=0;We<ae.length;We++){const Xe=ae.get(We),{tileAnchorX:ft,tileAnchorY:Ct,numGlyphs:Dt}=Xe,Rt=Xe.hidden||!Xe.crossTileID||h.allowVerticalPlacement&&!Xe.placedOrientation?null:p[Xe.crossTileID];if(Rt){let Mt=0,Wt=0,On=0;if(se){const Vn=se?se.getAtTileOffset(O,ft,Ct):0,[Ar,Xr,dr]=be.upVector(O.canonical,ft,Ct);Mt=Vn*Ar*Ie,Wt=Vn*Xr*Ie,On=Vn*dr*Ie}let[qt,Tn,un,Fn]=oi(Xe.projectedAnchorX+Mt,Xe.projectedAnchorY+Wt,Xe.projectedAnchorZ+On,c?Pe:A);const nn=Yo(w.getCameraToCenterDistance(be),Fn);let En=y.evaluateSizeForFeature(h.textSizeData,W,Xe)*nn/l.ONE_EM;c&&(En*=h.tilePixelRatio/$);const zn=bl(Rt,En);c?(({x:qt,y:Tn,z:un}=be.projectTilePoint(ft+zn.x,Ct+zn.y,O.canonical)),[qt,Tn,un]=oi(qt+Mt,Tn+Wt,un+On,A)):(i&&zn._rotate(-w.angle),qt+=zn.x,Tn+=zn.y,un=0);const Rn=h.allowVerticalPlacement&&Xe.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let Vn=0;Vn<Dt;Vn++)l.addDynamicAttributes(De,qt,Tn,un,Rn);G&&Xe.associatedIconIndex>=0&&(Ee[Xe.associatedIconIndex]={x:qt,y:Tn,z:un,angle:Rn})}else Ce(Dt,De)}if(G){ye.clear();const We=h.icon.placedSymbolArray;for(let Xe=0;Xe<We.length;Xe++){const ft=We.get(Xe),{numGlyphs:Ct}=ft,Dt=Ee[Xe];if(ft.hidden||!Dt)Ce(Ct,ye);else{const{x:Rt,y:Mt,z:Wt,angle:On}=Dt;for(let qt=0;qt<Ct;qt++)l.addDynamicAttributes(ye,Rt,Mt,Wt,On)}}h.icon.dynamicLayoutVertexBuffer.updateData(ye)}h.text.dynamicLayoutVertexBuffer.updateData(De)}function ol(h,i,c){return c.iconsInText&&i?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function sl(h,i,c,p,y,w,A,O,$,W,G,ae){const De=h.context,ye=De.gl,Ee=h.transform,be="map"===O,Pe="map"===$,se=be&&"point"!==c.layout.get("symbol-placement"),Ie=be&&!Pe&&!se,We=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let Xe=!1;const ft=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),Ct=[l.mercatorXfromLng(Ee.center.lng),l.mercatorYfromLat(Ee.center.lat)],Dt=c.layout.get("text-variable-anchor"),Rt="globe"===Ee.projection.name,Mt=[],Wt=[0,-1,0];let On=Wt;!Rt&&!Ee.mercatorFromTransition||be||(On=function(qt){const Tn=qt._camera.getWorldToCamera(qt.worldSize,1),un=l.multiply([],Tn,qt.globeMatrix);l.invert(un,un);const Fn=[0,0,0],nn=[0,1,0,0];return l.transformMat4$1(nn,nn,un),Fn[0]=nn[0],Fn[1]=nn[1],Fn[2]=nn[2],l.normalize(Fn,Fn),Fn}(Ee));for(const qt of p){const Tn=i.getTile(qt),un=Tn.getBucket(c);if(!un||"mercator"===un.projection.name&&Rt)continue;const Fn=y?un.text:un.icon;if(!Fn||un.fullyClipped||!Fn.segments.get().length)continue;const nn=Fn.programConfigurations.get(c.id),En=y||un.sdfIcons,zn=y?un.textSizeData:un.iconSizeData,Rn=Pe||0!==Ee.pitch,Vn=l.evaluateSizeForZoom(zn,Ee.zoom);let Ar,Xr,dr,Ur,gi=[0,0],pi=null;if(y)Xr=Tn.glyphAtlasTexture,dr=ye.LINEAR,Ar=Tn.glyphAtlasTexture.size,un.iconsInText&&(gi=Tn.imageAtlasTexture.size,pi=Tn.imageAtlasTexture,Ur=Rn||h.options.rotating||h.options.zooming||"composite"===zn.kind||"camera"===zn.kind?ye.LINEAR:ye.NEAREST);else{const Jl=1!==c.layout.get("icon-size").constantOr(0)||un.iconsNeedLinear;Xr=Tn.imageAtlasTexture,dr=En||h.options.rotating||h.options.zooming||Jl||Rn?ye.LINEAR:ye.NEAREST,Ar=Tn.imageAtlasTexture.size}const br="globe"===un.projection.name,Xi=br?On:Wt,_i=br?l.globeToMercatorTransition(Ee.zoom):0,fo=pn(qt,un.getProjection(),Ee),lo=Ee.calculatePixelsToTileUnitsMatrix(Tn),Ns=cn(fo,Tn.tileID.canonical,Pe,be,Ee,un.getProjection(),lo),zs=h.terrain&&Pe&&se?l.invert(l.create(),Ns):Fs,Sa=wi(fo,Tn.tileID.canonical,Pe,be,Ee,un.getProjection(),lo),Ua=Dt&&un.hasTextData(),co="none"!==c.layout.get("icon-text-fit")&&Ua&&un.hasIconData();if(se){const Jl=Ee.elevation,_c=Jl?Jl.getAtTileOffsetFunc(qt,Ee.center.lat,Ee.worldSize,un.getProjection()):null,kc=io(fo,Tn.tileID.canonical,Pe,be,Ee,un.getProjection(),lo);ss(un,fo,h,y,kc,Sa,Pe,W,_c,qt)}const ji=se||y&&Dt||co,Mi=h.translatePosMatrix(fo,Tn,w,A),hs=ji?Fs:Ns,Zs=h.translatePosMatrix(Sa,Tn,w,A,!0),no=un.getProjection().createInversionMatrix(Ee,qt.canonical),Ia=[];h.terrainRenderModeElevated()&&Pe&&Ia.push("PITCH_WITH_MAP_TERRAIN"),br&&Ia.push("PROJECTION_GLOBE_VIEW"),ji&&Ia.push("PROJECTED_POS_ON_VIEWPORT");const $u=En&&0!==c.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1);let Oc;Oc=En?un.iconsInText?xl(zn.kind,Vn,Ie,Pe,h,Mi,hs,Zs,Ar,gi,qt,_i,Ct,no,Xi,un.getProjection()):wa(zn.kind,Vn,Ie,Pe,h,Mi,hs,Zs,y,Ar,!0,qt,_i,Ct,no,Xi,un.getProjection()):Vl(zn.kind,Vn,Ie,Pe,h,Mi,hs,Zs,y,Ar,qt,_i,Ct,no,Xi,un.getProjection());const Vu={program:h.useProgram(ol(En,y,un),nn,Ia),buffers:Fn,uniformValues:Oc,atlasTexture:Xr,atlasTextureIcon:pi,atlasInterpolation:dr,atlasInterpolationIcon:Ur,isSDF:En,hasHalo:$u,tile:Tn,labelPlaneMatrixInv:zs};if(We&&un.canOverlap){Xe=!0;const Jl=Fn.segments.get();for(const _c of Jl)Mt.push({segments:new l.SegmentVector([_c]),sortKey:_c.sortKey,state:Vu})}else Mt.push({segments:Fn.segments,sortKey:0,state:Vu})}Xe&&Mt.sort((qt,Tn)=>qt.sortKey-Tn.sortKey);for(const qt of Mt){const Tn=qt.state;if(h.terrain&&h.terrain.setupElevationDraw(Tn.tile,Tn.program,{useDepthForOcclusion:!Rt,labelPlaneMatrixInv:Tn.labelPlaneMatrixInv}),De.activeTexture.set(ye.TEXTURE0),Tn.atlasTexture.bind(Tn.atlasInterpolation,ye.CLAMP_TO_EDGE),Tn.atlasTextureIcon&&(De.activeTexture.set(ye.TEXTURE1),Tn.atlasTextureIcon&&Tn.atlasTextureIcon.bind(Tn.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),Tn.isSDF){const un=Tn.uniformValues;Tn.hasHalo&&(un.u_is_halo=1,al(Tn.buffers,qt.segments,c,h,Tn.program,ft,G,ae,un)),un.u_is_halo=0}al(Tn.buffers,qt.segments,c,h,Tn.program,ft,G,ae,Tn.uniformValues)}}function al(h,i,c,p,y,w,A,O,$){const W=p.context,G=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];y.draw(W,W.gl.TRIANGLES,w,A,O,l.CullFaceMode.disabled,$,c.id,h.layoutVertexBuffer,h.indexBuffer,i,c.paint,p.transform.zoom,h.programConfigurations.get(c.id),G)}function dc(h,i,c,p,y,w,A){const O=h.context.gl,$=c.paint.get("fill-pattern"),W=$&&$.constantOr(1);let G,ae,De,ye,Ee;A?(ae=W&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=O.LINES):(ae=W?"fillPattern":"fill",G=O.TRIANGLES);for(const be of p){const Pe=i.getTile(be);if(W&&!Pe.patternsLoaded())continue;const se=Pe.getBucket(c);if(!se)continue;h.prepareDrawTile();const Ie=se.programConfigurations.get(c.id),We=h.useProgram(ae,Ie);W&&(h.context.activeTexture.set(O.TEXTURE0),Pe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ie.updatePaintBuffers());const Xe=$.constantOr(null);if(Xe&&Pe.imageAtlas){const Ct=Pe.imageAtlas.patternPositions[Xe.toString()];Ct&&Ie.setConstantPatternPositions(Ct)}const ft=h.translatePosMatrix(be.projMatrix,Pe,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(A){ye=se.indexBuffer2,Ee=se.segments2;const Ct=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];De="fillOutlinePattern"===ae&&W?ao(ft,h,Pe,Ct):ki(ft,Ct)}else ye=se.indexBuffer,Ee=se.segments,De=W?ir(ft,h,Pe):lr(ft);h.prepareDrawProgram(h.context,We,be.toUnwrapped()),We.draw(h.context,G,y,h.stencilModeForClipping(be),w,l.CullFaceMode.disabled,De,c.id,se.layoutVertexBuffer,ye,Ee,c.paint,h.transform.zoom,Ie)}}function fa(h,i,c,p,y,w,A){const O=h.context,$=O.gl,W=h.transform,G=c.paint.get("fill-extrusion-pattern"),ae=G.constantOr(1),De=c.paint.get("fill-extrusion-opacity"),ye=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],Ee=c.layout.get("fill-extrusion-edge-radius"),be=Ee>0&&!c.paint.get("fill-extrusion-rounded-roof"),Pe=be?0:Ee,se="globe"===W.projection.name?l.fillExtrusionHeightLift():0,Ie="globe"===W.projection.name,We=Ie?l.globeToMercatorTransition(W.zoom):0,Xe=[l.mercatorXfromLng(W.center.lng),l.mercatorYfromLat(W.center.lat)],ft=[];Ie&&ft.push("PROJECTION_GLOBE_VIEW"),ye[0]>0&&ft.push("FAUX_AO"),be&&ft.push("ZERO_ROOF_RADIUS");for(const Ct of p){const Dt=i.getTile(Ct),Rt=Dt.getBucket(c);if(!Rt||Rt.projection.name!==W.projection.name)continue;const Mt=Rt.programConfigurations.get(c.id),Wt=h.useProgram(ae?"fillExtrusionPattern":"fillExtrusion",Mt,ft);if(h.terrain){const En=h.terrain;if(h.style.terrainSetForDrapingOnly())En.setupElevationDraw(Dt,Wt,{useMeterToDem:!0});else{if(!Rt.enableTerrain)continue;if(En.setupElevationDraw(Dt,Wt,{useMeterToDem:!0}),Ws(O,i,Ct,Rt,c,En),!Rt.centroidVertexBuffer){const zn=Wt.attributes.a_centroid_pos;void 0!==zn&&$.vertexAttrib2f(zn,0,0)}}}ae&&(h.context.activeTexture.set($.TEXTURE0),Dt.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Mt.updatePaintBuffers());const On=G.constantOr(null);if(On&&Dt.imageAtlas){const En=Dt.imageAtlas.patternPositions[On.toString()];En&&Mt.setConstantPatternPositions(En)}const qt=h.translatePosMatrix(Ct.projMatrix,Dt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Tn=W.projection.createInversionMatrix(W,Ct.canonical),un=c.paint.get("fill-extrusion-vertical-gradient"),Fn=ae?Cn(qt,h,un,De,ye,Pe,Ct,Dt,se,We,Xe,Tn):ke(qt,h,un,De,ye,Pe,Ct,se,We,Xe,Tn);h.prepareDrawProgram(O,Wt,Ct.toUnwrapped());const nn=[];h.terrain&&nn.push(Rt.centroidVertexBuffer),Ie&&nn.push(Rt.layoutVertexExtBuffer),Wt.draw(O,O.gl.TRIANGLES,y,w,A,l.CullFaceMode.backCCW,Fn,c.id,Rt.layoutVertexBuffer,Rt.indexBuffer,Rt.segments,c.paint,h.transform.zoom,Mt,nn)}}function Ws(h,i,c,p,y,w){const A=[se=>{let Ie=se.canonical.x-1,We=se.wrap;return Ie<0&&(Ie=(1<<se.canonical.z)-1,We--),new l.OverscaledTileID(se.overscaledZ,We,se.canonical.z,Ie,se.canonical.y)},se=>{let Ie=se.canonical.x+1,We=se.wrap;return Ie===1<<se.canonical.z&&(Ie=0,We++),new l.OverscaledTileID(se.overscaledZ,We,se.canonical.z,Ie,se.canonical.y)},se=>new l.OverscaledTileID(se.overscaledZ,se.wrap,se.canonical.z,se.canonical.x,(0===se.canonical.y?1<<se.canonical.z:se.canonical.y)-1),se=>new l.OverscaledTileID(se.overscaledZ,se.wrap,se.canonical.z,se.canonical.x,se.canonical.y===(1<<se.canonical.z)-1?0:se.canonical.y+1)],O=se=>{const Ie=i.getSource().minzoom,We=ft=>{const Ct=i.getTileByID(ft);if(Ct&&Ct.hasData())return Ct.getBucket(y)},Xe=[0,-1,1];for(const ft of Xe){if(se.overscaledZ+ft<Ie)continue;const Ct=We(se.calculateScaledKey(se.overscaledZ+ft));if(Ct)return Ct}},$=[0,0,0],W=(se,Ie)=>($[0]=Math.min(se.min.y,Ie.min.y),$[1]=Math.max(se.max.y,Ie.max.y),$[2]=l.EXTENT-Ie.min.x>se.max.x?Ie.min.x-l.EXTENT:se.max.x,$),G=(se,Ie)=>($[0]=Math.min(se.min.x,Ie.min.x),$[1]=Math.max(se.max.x,Ie.max.x),$[2]=l.EXTENT-Ie.min.y>se.max.y?Ie.min.y-l.EXTENT:se.max.y,$),ae=[(se,Ie)=>W(se,Ie),(se,Ie)=>W(Ie,se),(se,Ie)=>G(se,Ie),(se,Ie)=>G(Ie,se)],De=new l.Point(0,0);let ye,Ee,be;const Pe=(se,Ie,We,Xe,ft)=>{const Ct=[[Xe?We:se,Xe?se:We,0],[Xe?We:Ie,Xe?Ie:We,0]],Dt=ft<0?l.EXTENT+ft:ft,Rt=[Xe?Dt:(se+Ie)/2,Xe?(se+Ie)/2:Dt,0];return 0===We&&ft<0||0!==We&&ft>0?w.getForTilePoints(be,[Rt],!0,Ee):Ct.push(Rt),w.getForTilePoints(c,Ct,!0,ye),Math.max(Ct[0][2],Ct[1][2],Rt[2])/w.exaggeration()};for(let se=0;se<4;se++){const Ie=(se<2?1:5)-se,We=p.borders[se];if(0===We.length)continue;const Xe=be=A[se](c),ft=O(Xe);if(!(ft&&ft instanceof l.FillExtrusionBucket&&ft.enableTerrain)||p.borderDoneWithNeighborZ[se]===ft.canonical.z&&ft.borderDoneWithNeighborZ[Ie]===p.canonical.z||(Ee=w.findDEMTileFor(Xe),!Ee||!Ee.dem))continue;if(!ye){const Mt=w.findDEMTileFor(c);if(!Mt||!Mt.dem)return;ye=Mt}const Ct=ft.borders[Ie];let Dt=0;const Rt=ft.borderDoneWithNeighborZ[Ie]!==p.canonical.z;if(p.canonical.z===ft.canonical.z){for(let Mt=0;Mt<We.length;Mt++){const Wt=p.featuresOnBorder[We[Mt]],On=Wt.borders[se];let qt;for(;Dt<Ct.length&&(qt=ft.featuresOnBorder[Ct[Dt]],!(qt.borders[Ie][1]>On[0]+3));)Rt&&ft.encodeCentroid(void 0,qt,!1),Dt++;if(qt&&Dt<Ct.length){const Tn=Dt;let un=0;for(;!(qt.borders[Ie][0]>On[1]-3)&&(un++,++Dt!==Ct.length);)qt=ft.featuresOnBorder[Ct[Dt]];if(qt=ft.featuresOnBorder[Ct[Tn]],Wt.intersectsCount()>1||qt.intersectsCount()>1||1!==un){1!==un&&(Dt=Tn),p.encodeCentroid(void 0,Wt,!1),Rt&&ft.encodeCentroid(void 0,qt,!1);continue}const Fn=ae[se](Wt,qt),nn=se%2?l.EXTENT-1:0;De.x=Pe(Fn[0],Math.min(l.EXTENT-1,Fn[1]),nn,se<2,Fn[2]),De.y=0,p.encodeCentroid(De,Wt,!1),Rt&&ft.encodeCentroid(De,qt,!1)}else p.encodeCentroid(void 0,Wt,!1)}p.borderDoneWithNeighborZ[se]=ft.canonical.z,p.needsCentroidUpdate=!0,Rt&&(ft.borderDoneWithNeighborZ[Ie]=p.canonical.z,ft.needsCentroidUpdate=!0)}else{for(const Mt of We)p.encodeCentroid(void 0,p.featuresOnBorder[Mt],!1);if(Rt){for(const Mt of Ct)ft.encodeCentroid(void 0,ft.featuresOnBorder[Mt],!1);ft.borderDoneWithNeighborZ[Ie]=p.canonical.z,ft.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[se]=ft.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&0!==p.centroidVertexArray.length)&&p.uploadCentroid(h)}const ll=new l.Color(1,0,0,1),qa=new l.Color(0,1,0,1),hc=new l.Color(0,0,1,1),Ic=new l.Color(1,0,1,1),Mc=new l.Color(0,1,1,1);function fc(h,i,c){const p=h.context,y=h.transform,w=p.gl,A="globe"===y.projection.name,O=A?["PROJECTION_GLOBE_VIEW"]:null;let $=c.projMatrix;if(A&&l.globeToMercatorTransition(y.zoom)>0){const Wt=l.transitionTileAABBinECEF(c.canonical,y),On=l.globeDenormalizeECEF(Wt);$=l.multiply(new Float32Array(16),y.globeMatrix,On),l.multiply($,y.projMatrix,$)}const W=h.useProgram("debug",null,O),G=i.getTileByID(c.key);h.terrain&&h.terrain.setupElevationDraw(G,W);const ae=l.DepthMode.disabled,De=l.StencilMode.disabled,ye=h.colorModeForRenderPass();p.activeTexture.set(w.TEXTURE0),h.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),A?G._makeGlobeTileDebugBuffers(h.context,y):G._makeDebugTileBoundsBuffers(h.context,y.projection);const be=G._tileDebugBuffer||h.debugBuffer,Pe=G._tileDebugIndexBuffer||h.debugIndexBuffer,se=G._tileDebugSegments||h.debugSegments;W.draw(p,w.LINE_STRIP,ae,De,ye,l.CullFaceMode.disabled,Ye($,l.Color.red),"$debug",be,Pe,se,null,null,null,[G._globeTileDebugBorderBuffer]);const Ie=G.latestRawTileData,We=Math.floor((Ie&&Ie.byteLength||0)/1024),Xe=i.getTile(c).tileSize,ft=512/Math.min(Xe,512)*(c.overscaledZ/y.zoom)*.5;let Ct=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Ct+=` => ${c.overscaledZ}`),Ct+=` ${We}kb`,function(Wt,On){Wt.initDebugOverlayCanvas();const qt=Wt.debugOverlayCanvas,Tn=Wt.context.gl,un=Wt.debugOverlayCanvas.getContext("2d");un.clearRect(0,0,qt.width,qt.height),un.shadowColor="white",un.shadowBlur=2,un.lineWidth=1.5,un.strokeStyle="white",un.textBaseline="top",un.font="bold 36px Open Sans, sans-serif",un.fillText(On,5,5),un.strokeText(On,5,5),Wt.debugOverlayTexture.update(qt),Wt.debugOverlayTexture.bind(Tn.LINEAR,Tn.CLAMP_TO_EDGE)}(h,Ct);const Dt=G._tileDebugTextBuffer||h.debugBuffer,Rt=G._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Mt=G._tileDebugTextSegments||h.debugSegments;W.draw(p,w.TRIANGLES,ae,De,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,Ye($,l.Color.transparent,ft),"$debug",Dt,Rt,Mt,null,null,null,[G._globeTileDebugTextBuffer])}function Hl(h,i,c,p){Qs(h,0,i+c/2,h.transform.width,c,p)}function Ea(h,i,c,p){Qs(h,i-c/2,0,c,h.transform.height,p)}function Qs(h,i,c,p,y,w){const A=h.context,O=A.gl;O.enable(O.SCISSOR_TEST),O.scissor(i*l.exported.devicePixelRatio,c*l.exported.devicePixelRatio,p*l.exported.devicePixelRatio,y*l.exported.devicePixelRatio),A.clear({color:w}),O.disable(O.SCISSOR_TEST)}const Ba=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Na}=Ba;function Qo(h,i,c,p){h.emplaceBack(i,c,p)}class ea{constructor(i){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,Qo(this.vertexArray,-1,-1,1),Qo(this.vertexArray,1,-1,1),Qo(this.vertexArray,-1,1,1),Qo(this.vertexArray,1,1,1),Qo(this.vertexArray,-1,-1,-1),Qo(this.vertexArray,1,-1,-1),Qo(this.vertexArray,-1,1,-1),Qo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Na),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function N(h,i,c,p,y,w){const A=h.gl,O=i.paint.get("sky-atmosphere-color"),$=i.paint.get("sky-atmosphere-halo-color"),W=i.paint.get("sky-atmosphere-sun-intensity"),G={u_matrix_3f:l.fromMat4(l.create$1(),p),u_sun_direction:y,u_sun_intensity:W,u_color_tint_r:[(Ee=O).r,Ee.g,Ee.b,Ee.a],u_color_tint_m:[(be=$).r,be.g,be.b,be.a],u_luminance:5e-5};var Ee,be;A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+w,i.skyboxTexture,0),c.draw(h,A.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,G,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const ee=l.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ke{constructor(i){const c=new l.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new l.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(c,ee.members),this.indexBuffer=i.createIndexBuffer(p),this.segments=l.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Y={symbol:function(h,i,c,p,y){if("translucent"!==h.renderPass)return;const w=l.StencilMode.disabled,A=h.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(O,$,W,G,ae,De,ye){const Ee=$.transform,be="map"===ae,Pe="map"===De;for(const se of O){const Ie=G.getTile(se),We=Ie.getBucket(W);if(!We||!We.text||!We.text.segments.get().length)continue;const Xe=l.evaluateSizeForZoom(We.textSizeData,Ee.zoom),ft=pn(se,We.getProjection(),Ee),Ct=Ee.calculatePixelsToTileUnitsMatrix(Ie),Dt=cn(ft,Ie.tileID.canonical,Pe,be,Ee,We.getProjection(),Ct),Rt="none"!==W.layout.get("icon-text-fit")&&We.hasIconData();if(Xe){const Mt=Math.pow(2,Ee.zoom-Ie.tileID.overscaledZ);jl(We,be,Pe,ye,l.symbolSize,Ee,Dt,se,Mt,Xe,Rt)}}}(p,h,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y),0!==c.paint.get("icon-opacity").constantOr(1)&&sl(h,i,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),w,A),0!==c.paint.get("text-opacity").constantOr(1)&&sl(h,i,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),w,A),i.map.showCollisionBoxes&&(ho(h,i,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),ho(h,i,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(h,i,c,p){if("translucent"!==h.renderPass)return;const y=c.paint.get("circle-opacity"),w=c.paint.get("circle-stroke-width"),A=c.paint.get("circle-stroke-opacity"),O=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===y.constantOr(1)&&(0===w.constantOr(1)||0===A.constantOr(1)))return;const $=h.context,W=$.gl,G=h.transform,ae=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),De=l.StencilMode.disabled,ye=h.colorModeForRenderPass(),Ee="globe"===G.projection.name,be=[l.mercatorXfromLng(G.center.lng),l.mercatorYfromLat(G.center.lat)],Pe=[];for(let Ie=0;Ie<p.length;Ie++){const We=p[Ie],Xe=i.getTile(We),ft=Xe.getBucket(c);if(!ft||ft.projection.name!==G.projection.name)continue;const Ct=ft.programConfigurations.get(c.id),Dt=Ae(c);Ee&&Dt.push("PROJECTION_GLOBE_VIEW");const Rt=h.useProgram("circle",Ct,Dt),Mt=ft.layoutVertexBuffer,Wt=ft.globeExtVertexBuffer,On=ft.indexBuffer,qt=G.projection.createInversionMatrix(G,We.canonical),Tn={programConfiguration:Ct,program:Rt,layoutVertexBuffer:Mt,globeExtVertexBuffer:Wt,indexBuffer:On,uniformValues:X(h,We,Xe,qt,be,c),tile:Xe};if(O){const un=ft.segments.get();for(const Fn of un)Pe.push({segments:new l.SegmentVector([Fn]),sortKey:Fn.sortKey,state:Tn})}else Pe.push({segments:ft.segments,sortKey:0,state:Tn})}O&&Pe.sort((Ie,We)=>Ie.sortKey-We.sortKey);const se={useDepthForOcclusion:!Ee};for(const Ie of Pe){const{programConfiguration:We,program:Xe,layoutVertexBuffer:ft,globeExtVertexBuffer:Ct,indexBuffer:Dt,uniformValues:Rt,tile:Mt}=Ie.state,Wt=Ie.segments;h.terrain&&h.terrain.setupElevationDraw(Mt,Xe,se),h.prepareDrawProgram($,Xe,Mt.tileID.toUnwrapped()),Xe.draw($,W.TRIANGLES,ae,De,ye,l.CullFaceMode.disabled,Rt,c.id,ft,Dt,Wt,c.paint,G.zoom,We,[Ct])}},heatmap:function(h,i,c,p){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===h.renderPass){const y=h.context,w=y.gl,A=l.StencilMode.disabled,O=new l.ColorMode([w.ONE,w.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(ye,Ee,be,Pe){const se=ye.gl,Ie=Ee.width*Pe,We=Ee.height*Pe;ye.activeTexture.set(se.TEXTURE1),ye.viewport.set([0,0,Ie,We]);let Xe=be.heatmapFbo;if(!Xe||Xe&&(Xe.width!==Ie||Xe.height!==We)){Xe&&Xe.destroy();const ft=se.createTexture();se.bindTexture(se.TEXTURE_2D,ft),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),Xe=be.heatmapFbo=ye.createFramebuffer(Ie,We,!1),function(Ct,Dt,Rt,Mt,Wt,On){const qt=Ct.gl;qt.texImage2D(qt.TEXTURE_2D,0,Ct.isWebGL2&&Ct.extRenderToTextureHalfFloat?qt.RGBA16F:qt.RGBA,Wt,On,0,qt.RGBA,Ct.extRenderToTextureHalfFloat?Ct.isWebGL2?qt.HALF_FLOAT:Ct.extTextureHalfFloat.HALF_FLOAT_OES:qt.UNSIGNED_BYTE,null),Mt.colorAttachment.set(Rt)}(ye,0,ft,Xe,Ie,We)}else se.bindTexture(se.TEXTURE_2D,Xe.colorAttachment.get()),ye.bindFramebuffer.set(Xe.framebuffer)})(y,h,c,"globe"===h.transform.projection.name?.5:.25),y.clear({color:l.Color.transparent});const $=h.transform,W="globe"===$.projection.name,G=W?["PROJECTION_GLOBE_VIEW"]:null,ae=W?l.CullFaceMode.frontCCW:l.CullFaceMode.disabled,De=[l.mercatorXfromLng($.center.lng),l.mercatorYfromLat($.center.lat)];for(let ye=0;ye<p.length;ye++){const Ee=p[ye];if(i.hasRenderableParent(Ee))continue;const be=i.getTile(Ee),Pe=be.getBucket(c);if(!Pe||Pe.projection.name!==$.projection.name)continue;const se=Pe.programConfigurations.get(c.id),Ie=h.useProgram("heatmap",se,G),{zoom:We}=h.transform;h.terrain&&h.terrain.setupElevationDraw(be,Ie),h.prepareDrawProgram(y,Ie,Ee.toUnwrapped());const Xe=$.projection.createInversionMatrix($,Ee.canonical);Ie.draw(y,w.TRIANGLES,l.DepthMode.disabled,A,O,ae,$r(h,Ee,be,Xe,De,We,c.paint.get("heatmap-intensity")),c.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,c.paint,h.transform.zoom,se,W?[Pe.globeExtVertexBuffer]:null)}y.viewport.set([0,0,h.width,h.height])}else"translucent"===h.renderPass&&(h.context.setColorMode(h.colorModeForRenderPass()),function(y,w){const A=y.context,O=A.gl,$=w.heatmapFbo;if(!$)return;A.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,$.colorAttachment.get()),A.activeTexture.set(O.TEXTURE1);let W=w.colorRampTexture;W||(W=w.colorRampTexture=new l.Texture(A,w.colorRamp,O.RGBA)),W.bind(O.LINEAR,O.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(A,O.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,y.colorModeForRenderPass(),l.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:w.paint.get("heatmap-opacity")},w.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,w.paint,y.transform.zoom)}(h,c))},line:function(h,i,c,p){if("translucent"!==h.renderPass)return;const y=c.paint.get("line-opacity"),w=c.paint.get("line-width");if(0===y.constantOr(1)||0===w.constantOr(1))return;const A=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),O=h.colorModeForRenderPass(),$=h.terrain&&h.terrain.renderingToTexture?1:l.exported.devicePixelRatio,W=c.paint.get("line-dasharray"),G=W.constantOr(1),ae=c.layout.get("line-cap"),De=c.paint.get("line-pattern"),ye=De.constantOr(1),Ee=c.paint.get("line-gradient"),be=ye?"linePattern":"line",Pe=h.context,se=Pe.gl,Ie=(Xe=>{const ft=[];Ds(Xe)&&ft.push("RENDER_LINE_DASH"),Xe.paint.get("line-gradient")&&ft.push("RENDER_LINE_GRADIENT");const Ct=Xe.paint.get("line-trim-offset");0===Ct[0]&&0===Ct[1]||ft.push("RENDER_LINE_TRIM_OFFSET");const Dt=Xe.paint.get("line-pattern").constantOr(1),Rt=1!==Xe.paint.get("line-opacity").constantOr(1);return!Dt&&Rt&&ft.push("RENDER_LINE_ALPHA_DISCARD"),ft})(c);let We=Ie.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(We=!1);for(const Xe of p){const ft=i.getTile(Xe);if(ye&&!ft.patternsLoaded())continue;const Ct=ft.getBucket(c);if(!Ct)continue;h.prepareDrawTile();const Dt=Ct.programConfigurations.get(c.id),Rt=h.useProgram(be,Dt,Ie),Mt=De.constantOr(null);if(Mt&&ft.imageAtlas){const En=ft.imageAtlas.patternPositions[Mt.toString()];En&&Dt.setConstantPatternPositions(En)}const Wt=W.constantOr(null),On=ae.constantOr(null);if(!ye&&Wt&&On&&ft.lineAtlas){const En=ft.lineAtlas.getDash(Wt,On);En&&Dt.setConstantPatternPositions(En)}let[qt,Tn]=c.paint.get("line-trim-offset");("round"===On||"square"===On)&&qt!==Tn&&(0===qt&&(qt-=1),1===Tn&&(Tn+=1));const un=h.terrain?Xe.projMatrix:null,Fn=ye?rs(h,ft,c,un,$):Oo(h,ft,c,un,Ct.lineClipsArray.length,$,[qt,Tn]);if(Ee){const En=Ct.gradients[c.id];let zn=En.texture;if(c.gradientVersion!==En.version){let Rn=256;if(c.stepInterpolant){const Vn=i.getSource().maxzoom,Ar=Xe.canonical.z===Vn?Math.ceil(1<<h.transform.maxZoom-Xe.canonical.z):1;Rn=l.clamp(l.nextPowerOfTwo(Ct.maxLineLength/l.EXTENT*1024*Ar),256,Pe.maxTextureSize)}En.gradient=l.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Rn,image:En.gradient||void 0,clips:Ct.lineClipsArray}),En.texture?En.texture.update(En.gradient):En.texture=new l.Texture(Pe,En.gradient,se.RGBA),En.version=c.gradientVersion,zn=En.texture}Pe.activeTexture.set(se.TEXTURE1),zn.bind(c.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}G&&(Pe.activeTexture.set(se.TEXTURE0),ft.lineAtlasTexture.bind(se.LINEAR,se.REPEAT),Dt.updatePaintBuffers()),ye&&(Pe.activeTexture.set(se.TEXTURE0),ft.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Dt.updatePaintBuffers()),h.prepareDrawProgram(Pe,Rt,Xe.toUnwrapped());const nn=En=>{Rt.draw(Pe,se.TRIANGLES,A,En,O,l.CullFaceMode.disabled,Fn,c.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Ct.segments,c.paint,h.transform.zoom,Dt,[Ct.layoutVertexBuffer2])};if(We){const En=h.stencilModeForClipping(Xe).ref;0===En&&h.terrain&&Pe.clear({stencil:0});const zn={func:se.EQUAL,mask:255};Fn.u_alpha_discard_threshold=.8,nn(new l.StencilMode(zn,En,255,se.KEEP,se.KEEP,se.INVERT)),Fn.u_alpha_discard_threshold=0,nn(new l.StencilMode(zn,En,255,se.KEEP,se.KEEP,se.KEEP))}else nn(h.stencilModeForClipping(Xe))}We&&(h.resetStencilClippingMasks(),h.terrain&&Pe.clear({stencil:0}))},fill:function(h,i,c,p){const y=c.paint.get("fill-color"),w=c.paint.get("fill-opacity");if(0===w.constantOr(1))return;const A=h.colorModeForRenderPass(),O=c.paint.get("fill-pattern"),$=h.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===y.constantOr(l.Color.transparent).a&&1===w.constantOr(0)?"opaque":"translucent";if(h.renderPass===$){const W=h.depthModeForSublayer(1,"opaque"===h.renderPass?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);dc(h,i,c,p,W,A,!1)}if("translucent"===h.renderPass&&c.paint.get("fill-antialias")){const W=h.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);dc(h,i,c,p,W,A,!0)}},"fill-extrusion":function(h,i,c,p){const y=c.paint.get("fill-extrusion-opacity");if(0!==y&&"translucent"===h.renderPass){const w=new l.DepthMode(h.context.gl.LEQUAL,l.DepthMode.ReadWrite,h.depthRangeFor3D);if(1!==y||c.paint.get("fill-extrusion-pattern").constantOr(1))fa(h,i,c,p,w,l.StencilMode.disabled,l.ColorMode.disabled),fa(h,i,c,p,w,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const A=h.colorModeForRenderPass();fa(h,i,c,p,w,l.StencilMode.disabled,A)}}},hillshade:function(h,i,c,p){if("offscreen"!==h.renderPass&&"translucent"!==h.renderPass)return;const y=h.context,w=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),A=h.colorModeForRenderPass(),O=h.terrain&&h.terrain.renderingToTexture,[$,W]="translucent"!==h.renderPass||O?[{},p]:h.stencilConfigForOverlap(p);for(const G of W){const ae=i.getTile(G);if(ae.needsHillshadePrepare&&"offscreen"===h.renderPass)js(h,ae,c,w,l.StencilMode.disabled,A);else if("translucent"===h.renderPass){const De=O&&h.terrain?h.terrain.stencilModeForRTTOverlap(G):$[G.overscaledZ];va(h,G,ae,c,w,De,A)}}y.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,i,c,p,y,w){if("translucent"!==h.renderPass||0===c.paint.get("raster-opacity")||!p.length)return;const A=h.context,O=A.gl,$=i.getSource(),W=h.useProgram("raster"),G=h.colorModeForRenderPass(),ae=h.terrain&&h.terrain.renderingToTexture,[De,ye]=$ instanceof Ne||ae?[{},p]:h.stencilConfigForOverlap(p),Ee=ye[ye.length-1].overscaledZ,be=!h.options.moving;for(const Pe of ye){const se=ae?l.DepthMode.disabled:h.depthModeForSublayer(Pe.overscaledZ-Ee,1===c.paint.get("raster-opacity")?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,O.LESS),Ie=Pe.toUnwrapped(),We=i.getTile(Pe);if(ae&&(!We||!We.hasData()))continue;const Xe=ae?Pe.projMatrix:h.transform.calculateProjMatrix(Ie,be),ft=h.terrain&&ae?h.terrain.stencilModeForRTTOverlap(Pe):De[Pe.overscaledZ],Ct=w?0:c.paint.get("raster-fade-duration");We.registerFadeDuration(Ct);const Dt=i.findLoadedParent(Pe,0),Rt=Xo(We,Dt,i,h.transform,Ct);let Mt,Wt;h.terrain&&h.terrain.prepareDrawTile();const On="nearest"===c.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;A.activeTexture.set(O.TEXTURE0),We.texture.bind(On,O.CLAMP_TO_EDGE),A.activeTexture.set(O.TEXTURE1),Dt?(Dt.texture.bind(On,O.CLAMP_TO_EDGE),Mt=Math.pow(2,Dt.tileID.overscaledZ-We.tileID.overscaledZ),Wt=[We.tileID.canonical.x*Mt%1,We.tileID.canonical.y*Mt%1]):We.texture.bind(On,O.CLAMP_TO_EDGE),We.texture.useMipmap&&A.extTextureFilterAnisotropic&&h.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax);const qt=La(Xe,Wt||[0,0],Mt||1,Rt,c,$ instanceof Ne?$.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(A,W,Ie),$ instanceof Ne)$.boundsBuffer&&$.boundsSegments&&W.draw(A,O.TRIANGLES,se,l.StencilMode.disabled,G,l.CullFaceMode.disabled,qt,c.id,$.boundsBuffer,h.quadTriangleIndexBuffer,$.boundsSegments);else{const{tileBoundsBuffer:Tn,tileBoundsIndexBuffer:un,tileBoundsSegments:Fn}=h.getTileBoundsBuffers(We);W.draw(A,O.TRIANGLES,se,ft,G,l.CullFaceMode.disabled,qt,c.id,Tn,un,Fn)}}h.resetStencilClippingMasks()},background:function(h,i,c,p){const y=c.paint.get("background-color"),w=c.paint.get("background-opacity");if(0===w)return;const A=h.context,O=A.gl,$=h.transform,W=$.tileSize,G=c.paint.get("background-pattern");if(h.isPatternMissing(G))return;const ae=!G&&1===y.a&&1===w&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==ae)return;const De=l.StencilMode.disabled,ye=h.depthModeForSublayer(0,"opaque"===ae?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),Ee=h.colorModeForRenderPass(),be=h.useProgram(G?"backgroundPattern":"background");let Pe,se=p;se||(Pe=h.getBackgroundTiles(),se=Object.values(Pe).map(Ie=>Ie.tileID)),G&&(A.activeTexture.set(O.TEXTURE0),h.imageManager.bind(h.context));for(const Ie of se){const We=Ie.toUnwrapped(),Xe=p?Ie.projMatrix:h.transform.calculateProjMatrix(We);h.prepareDrawTile();const ft=i?i.getTile(Ie):Pe?Pe[Ie.key]:new l.Tile(Ie,W,$.zoom,h),Ct=G?Ul(Xe,w,h,G,{tileID:Ie,tileSize:W}):Fa(Xe,w,y);h.prepareDrawProgram(A,be,We);const{tileBoundsBuffer:Dt,tileBoundsIndexBuffer:Rt,tileBoundsSegments:Mt}=h.getTileBoundsBuffers(ft);be.draw(A,O.TRIANGLES,ye,De,Ee,l.CullFaceMode.disabled,Ct,c.id,Dt,Rt,Mt)}},sky:function(h,i,c){const p=h.transform,y="mercator"===p.projection.name||"globe"===p.projection.name?1:l.smoothstep(7,8,p.zoom),w=c.paint.get("sky-opacity")*y;if(0===w)return;const A=h.context,O=c.paint.get("sky-type"),$=new l.DepthMode(A.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),W=h.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===h.renderPass?c.needsSkyboxCapture(h)&&(function(G,ae,De,ye){const Ee=G.context,be=Ee.gl;let Pe=ae.skyboxFbo;if(!Pe){Pe=ae.skyboxFbo=Ee.createFramebuffer(32,32,!1),ae.skyboxGeometry=new ea(Ee),ae.skyboxTexture=Ee.gl.createTexture(),be.bindTexture(be.TEXTURE_CUBE_MAP,ae.skyboxTexture),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_MAG_FILTER,be.LINEAR);for(let Xe=0;Xe<6;++Xe)be.texImage2D(be.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0,be.RGBA,32,32,0,be.RGBA,be.UNSIGNED_BYTE,null)}Ee.bindFramebuffer.set(Pe.framebuffer),Ee.viewport.set([0,0,32,32]);const se=ae.getCenter(G,!0),Ie=G.useProgram("skyboxCapture"),We=new Float64Array(16);l.identity(We),l.rotateY(We,We,.5*-Math.PI),N(Ee,ae,Ie,We,se,0),l.identity(We),l.rotateY(We,We,.5*Math.PI),N(Ee,ae,Ie,We,se,1),l.identity(We),l.rotateX(We,We,.5*-Math.PI),N(Ee,ae,Ie,We,se,2),l.identity(We),l.rotateX(We,We,.5*Math.PI),N(Ee,ae,Ie,We,se,3),l.identity(We),N(Ee,ae,Ie,We,se,4),l.identity(We),l.rotateY(We,We,Math.PI),N(Ee,ae,Ie,We,se,5),Ee.viewport.set([0,0,G.width,G.height])}(h,c),c.markSkyboxValid(h)):"sky"===h.renderPass&&function(G,ae,De,ye,Ee){const be=G.context,Pe=be.gl,se=G.transform,Ie=G.useProgram("skybox");be.activeTexture.set(Pe.TEXTURE0),Pe.bindTexture(Pe.TEXTURE_CUBE_MAP,ae.skyboxTexture);const We={u_matrix:se.skyboxMatrix,u_sun_direction:ae.getCenter(G,!1),u_cubemap:0,u_opacity:ye,u_temporal_offset:Ee};G.prepareDrawProgram(be,Ie),Ie.draw(be,Pe.TRIANGLES,De,l.StencilMode.disabled,G.colorModeForRenderPass(),l.CullFaceMode.backCW,We,"skybox",ae.skyboxGeometry.vertexBuffer,ae.skyboxGeometry.indexBuffer,ae.skyboxGeometry.segment)}(h,c,$,w,W):"gradient"===O&&"sky"===h.renderPass&&function(G,ae,De,ye,Ee){const be=G.context,Pe=be.gl,se=G.transform,Ie=G.useProgram("skyboxGradient");ae.skyboxGeometry||(ae.skyboxGeometry=new ea(be)),be.activeTexture.set(Pe.TEXTURE0);let We=ae.colorRampTexture;We||(We=ae.colorRampTexture=new l.Texture(be,ae.colorRamp,Pe.RGBA)),We.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE);const Xe=(ft=se.skyboxMatrix,Ct=ae.getCenter(G,!1),Dt=ae.paint.get("sky-gradient-radius"),Rt=ye,Mt=Ee,{u_matrix:ft,u_color_ramp:0,u_center_direction:Ct,u_radius:l.degToRad(Dt),u_opacity:Rt,u_temporal_offset:Mt});var ft,Ct,Dt,Rt,Mt;G.prepareDrawProgram(be,Ie),Ie.draw(be,Pe.TRIANGLES,De,l.StencilMode.disabled,G.colorModeForRenderPass(),l.CullFaceMode.backCW,Xe,"skyboxGradient",ae.skyboxGeometry.vertexBuffer,ae.skyboxGeometry.indexBuffer,ae.skyboxGeometry.segment)}(h,c,$,w,W)},debug:function(h,i,c){for(let p=0;p<c.length;p++)fc(h,i,c[p])},custom:function(h,i,c,p){const y=h.context,w=c.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||"offscreen"===h.renderPass)&&c.isLayerDraped()){if("offscreen"===h.renderPass){const A=w.prerender;if(A){if(h.setCustomLayerDefaults(),y.setColorMode(h.colorModeForRenderPass()),"globe"===h.transform.projection.name){const O=h.transform.pointMerc;A.call(w,y.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(h.transform.zoom),[O.x,O.y],h.transform.pixelsPerMeterRatio)}else A.call(w,y.gl,h.transform.customLayerMatrix());y.setDirty(),h.setBaseState()}}else if("translucent"===h.renderPass){if(h.terrain&&h.terrain.renderingToTexture){const O=w.renderToTile;if(O){const $=p[0].canonical,W=new l.MercatorCoordinate($.x+p[0].wrap*(1<<$.z),$.y,$.z);y.setDepthMode(l.DepthMode.disabled),y.setStencilMode(l.StencilMode.disabled),y.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),O.call(w,y.gl,W),y.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),y.setColorMode(h.colorModeForRenderPass()),y.setStencilMode(l.StencilMode.disabled);const A="3d"===w.renderingMode?new l.DepthMode(h.context.gl.LEQUAL,l.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,l.DepthMode.ReadOnly);if(y.setDepthMode(A),"globe"===h.transform.projection.name){const O=h.transform.pointMerc;w.render(y.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(h.transform.zoom),[O.x,O.y],h.transform.pixelsPerMeterRatio)}else w.render(y.gl,h.transform.customLayerMatrix());y.setDirty(),h.setBaseState(),y.bindFramebuffer.set(null)}}else l.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Fe{constructor(i,c,p=!1){this.context=new yn(i,p),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,c){const p=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new P(this,i));const y=this._terrain;this.transform.elevation=p?y:null,y.update(i,this.transform,c)}_updateFog(i){const c=i.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=c.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const w=p+.78*(y-p);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,c){if(this.width=i*l.exported.devicePixelRatio,this.height=c*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const i=this.context,c=new l.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(c,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const p=new l.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(l.EXTENT,0),p.emplaceBack(0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(p,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const y=new l.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(y,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const w=new l.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(l.EXTENT,0,l.EXTENT,0),w.emplaceBack(0,l.EXTENT,0,l.EXTENT),w.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(w,l.boundsAttributes.members),this.mercatorBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const A=new l.StructArrayLayout3ui6;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(A);const O=new l.StructArrayLayout1ui2;for(const W of[0,1,3,2,0])O.emplaceBack(W);this.debugIndexBuffer=i.createIndexBuffer(O),this.emptyTexture=new l.Texture(i,new l.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=l.create();const $=this.context.gl;this.stencilClearMode=new l.StencilMode({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO),this.loadTimeStamps.push(l.window.performance.now()),this.atmosphereBuffer=new Ke(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,c.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,us(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,p){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!p||0===p.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const $ of p)if(void 0===this._tileClippingMaskIDs[$.key]){O=!0;break}if(!O)return}this.currentStencilSource=c.id;const y=this.context,w=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(l.ColorMode.disabled),y.setDepthMode(l.DepthMode.disabled);const A=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of p){const $=c.getTile(O),W=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:G,tileBoundsIndexBuffer:ae,tileBoundsSegments:De}=this.getTileBoundsBuffers($);A.draw(y,w.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:w.ALWAYS,mask:0},W,255,w.KEEP,w.KEEP,w.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,us(O.projMatrix),"$clipping",G,ae,De)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new l.StencilMode({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new l.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,p=i.sort((A,O)=>O.overscaledZ-A.overscaledZ),y=p[p.length-1].overscaledZ,w=p[0].overscaledZ-y+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const A={};for(let O=0;O<w;O++)A[O+y]=new l.StencilMode({func:c.GEQUAL,mask:255},O+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=w,[A,p]}return[{[y]:l.StencilMode.disabled},p]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new l.ColorMode([i.CONSTANT_COLOR,i.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(i,c,p){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new l.DepthMode(p||this.context.gl.LEQUAL,c,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){this.style=i,this.options=c,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const p=this.style.order,y=this.style._sourceCaches;for(const W in y){const G=y[W];G.used&&G.prepare(this.context)}const w={},A={},O={};for(const W in y){const G=y[W];w[W]=G.getVisibleCoordinates(),A[W]=w[W].slice().reverse(),O[W]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let W=0;W<p.length;W++)if(this.style._layers[p[W]].is3D()){this.opaquePassCutoff=W;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new l.GlobeSharedBuffers(this.context)),!l.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const W of p){const G=this.style._layers[W],ae=i._getLayerSourceCache(G);if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;const De=ae?A[ae.id]:void 0;("custom"===G.type||G.isSky()||De&&De.length)&&this.renderLayer(this,ae,G,De)}this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon];const $=this.terrain;if($&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&$.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const W=this.style._layers[p[this.currentLayer]],G=i._getLayerSourceCache(W);if(W.isSky())continue;const ae=G?A[G.id]:void 0;this._renderTileClippingMasks(W,G,ae),this.renderLayer(this,G,W,ae)}if(this.style.fog&&this.transform.projection.supportsFog&&function(W,G){const ae=W.context,De=ae.gl,ye=W.transform,Ee=new l.DepthMode(De.LEQUAL,l.DepthMode.ReadOnly,[0,1]),be=W.useProgram("globeAtmosphere",null,"globe"===ye.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Pe=l.globeToMercatorTransition(ye.zoom),se=G.properties.get("color").toArray01(),Ie=G.properties.get("high-color").toArray01(),We=G.properties.get("space-color").toArray01PremultipliedAlpha(),Xe=l.identity$1([]);l.rotateY$1(Xe,Xe,-l.degToRad(ye._center.lng)),l.rotateX$1(Xe,Xe,l.degToRad(ye._center.lat)),l.rotateZ$1(Xe,Xe,ye.angle),l.rotateX$1(Xe,Xe,-ye._pitch);const ft=l.fromQuat(new Float32Array(16),Xe),Ct=l.mapValue(G.properties.get("star-intensity"),0,1,0,.25),Rt=l.mapValue(G.properties.get("horizon-blend"),0,1,5e-4,.25),Mt=l.globeUseCustomAntiAliasing(W,ae,ye)&&5e-4===Rt?ye.worldSize/(2*Math.PI*1.025)-1:ye.globeRadius,Wt=W.frameCounter/1e3%1,On=l.length(ye.globeCenterInViewSpace),qt=Math.sqrt(Math.pow(On,2)-Math.pow(Mt,2)),Tn=Math.acos(qt/On),un={u_frustum_tl:ye.frustumCorners.TL,u_frustum_tr:ye.frustumCorners.TR,u_frustum_br:ye.frustumCorners.BR,u_frustum_bl:ye.frustumCorners.BL,u_horizon:ye.frustumCorners.horizon,u_transition:Pe,u_fadeout_range:Rt,u_color:se,u_high_color:Ie,u_space_color:We,u_star_intensity:Ct,u_star_size:5*l.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Wt,u_horizon_angle:Tn,u_rotation_matrix:ft};W.prepareDrawProgram(ae,be);const Fn=W.atmosphereBuffer;Fn&&be.draw(ae,De.TRIANGLES,Ee,l.StencilMode.disabled,l.ColorMode.alphaBlended,l.CullFaceMode.backCW,un,"skybox",Fn.vertexBuffer,Fn.indexBuffer,Fn.segments)}(this,this.style.fog),this.renderPass="sky",(l.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const W=this.style._layers[p[this.currentLayer]],G=i._getLayerSourceCache(W);W.isSky()&&this.renderLayer(this,G,W,G?A[G.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const W=this.style._layers[p[this.currentLayer]],G=i._getLayerSourceCache(W);if(W.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(W)){if(W.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ae=G?("symbol"===W.type?O:A)[G.id]:void 0;this._renderTileClippingMasks(W,G,G?w[G.id]:void 0),this.renderLayer(this,G,W,ae),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let W=null;l.values(this.style._layers).forEach(G=>{const ae=i._getLayerSourceCache(G);ae&&!G.isHidden(this.transform.zoom)&&(!W||W.getSource().maxzoom<ae.getSource().maxzoom)&&(W=ae)}),W&&this.options.showTileBoundaries&&Y.debug(this,W,W.getVisibleCoordinates())}this.options.showPadding&&function(W){const G=W.transform.padding;Hl(W,W.transform.height-(G.top||0),3,ll),Hl(W,G.bottom||0,3,qa),Ea(W,G.left||0,3,hc),Ea(W,W.transform.width-(G.right||0),3,Ic);const ae=W.transform.centerPoint;var De,ye,Ee,be;Qs(De=W,(ye=ae.x)-1,(Ee=W.transform.height-ae.y)-10,2,20,be=Mc),Qs(De,ye-10,Ee-1,20,2,be)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}renderLayer(i,c,p,y){p.isHidden(this.transform.zoom)||("background"===p.type||"sky"===p.type||"custom"===p.type||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes(p.type)||i.terrain&&"custom"===p.type)&&Y[p.type](i,c,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[i.id];p||(p=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,c=i.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),i.beginQueryEXT(i.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const c={};for(const p in i){const y=i[p],w=this.context.extTimerQuery,A=w.getQueryObjectEXT(y.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(y.query),c[p]=A}return c}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let p=0;for(const y of i)p+=c.getQueryObjectEXT(y,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(y);return p}translatePosMatrix(i,c,p,y,w){if(!p[0]&&!p[1])return i;const A=w?"map"===y?this.transform.angle:0:"viewport"===y?-this.transform.angle:0;if(A){const W=Math.sin(A),G=Math.cos(A);p=[p[0]*G-p[1]*W,p[0]*W+p[1]*G]}const O=[w?p[0]:bt(c,p[0],this.transform.zoom),w?p[1]:bt(c,p[1],this.transform.zoom),0],$=new Float32Array(16);return l.translate($,i,O),$}saveTileTexture(i){const c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){return null===i||void 0!==i&&!this.imageManager.getPattern(i.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),p=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),"globe"===this.transform.projection.name&&y.push("GLOBE"),c&&y.push("ZERO_EXAGGERATION"),p&&!i&&0!==p.getOpacity(this.transform.pitch)&&y.push("FOG"),i&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(i,c,p){this.cache=this.cache||{};const y=p||[],w=this.currentGlobalDefines().concat(y),A=J.cacheKey(ts[i],i,w,c);return this.cache[A]||(this.cache[A]=new J(this.context,i,ts[i],c,Ls[i],w)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const w=y.getOpacity(this.transform.pitch),A=((O,$,W,G,ae,De,ye,Ee,be,Pe,se)=>{const Ie=O.transform,We=$.properties.get("color").toArray01();We[3]=G;const Xe=O.frameCounter/1e3%1;return{u_fog_matrix:W?Ie.calculateFogTileMatrix(W):O.identityMat,u_fog_range:$.getFovAdjustedRange(Ie._fov),u_fog_color:We,u_fog_horizon_blend:$.properties.get("horizon-blend"),u_fog_temporal_offset:Xe,u_frustum_tl:ae,u_frustum_tr:De,u_frustum_br:ye,u_frustum_bl:Ee,u_globe_pos:be,u_globe_radius:Pe,u_viewport:se,u_globe_transition:l.globeToMercatorTransition(Ie.zoom),u_is_globe:+("globe"===Ie.projection.name)}})(this,y,p,w,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*l.exported.devicePixelRatio,this.transform.height*l.exported.devicePixelRatio]);c.setFogUniformValues(i,A)}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)c[y.key]=i[y.key]||new l.Tile(y,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Et{constructor(i=0,c=0,p=0,y=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=p,this.right=y}interpolate(i,c,p){return null!=c.top&&null!=i.top&&(this.top=l.number(i.top,c.top,p)),null!=c.bottom&&null!=i.bottom&&(this.bottom=l.number(i.bottom,c.bottom,p)),null!=c.left&&null!=i.left&&(this.left=l.number(i.left,c.left,p)),null!=c.right&&null!=i.right&&(this.right=l.number(i.right,c.right,p)),this}getCenter(i,c){const p=l.clamp((this.left+i-this.right)/2,0,i),y=l.clamp((this.top+c-this.bottom)/2,0,c);return new l.Point(p,y)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Et(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function wn(h,i){const c=l.getColumn(h,3);l.fromQuat(h,i),l.setColumn(h,3,c)}function Mn(h,i){const c=l.identity$1([]);return l.rotateZ$1(c,c,-i),l.rotateX$1(c,c,-h),c}function Dr(h,i){const c=[h[0],h[1],0],p=[i[0],i[1],0];if(l.length(c)>=1e-15){const A=l.normalize([],c);l.scale$2(p,A,l.dot(p,A)),i[0]=p[0],i[1]=p[1]}const y=l.cross([],i,h);if(l.len(y)<1e-15)return null;const w=Math.atan2(-y[1],y[0]);return Mn(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),w)}class xi{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){if(i){const c=i instanceof l.MercatorCoordinate?i:new l.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(c.x=l.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const p=this.position,y=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(i)):0,w=l.MercatorCoordinate.fromLngLat(i,y),A=[w.x-p.x,w.y-p.y,w.z-p.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Dr(A,c)}setPitchBearing(i,c){this.orientation=Mn(l.degToRad(i),l.degToRad(-c))}}class bi{constructor(i,c){this._transform=l.identity([]),this.orientation=c,this.position=i}get mercatorPosition(){const i=this.position;return new l.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=l.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var c;i&&l.setColumn(this._transform,3,[(c=i)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||l.identity$1([]),i&&wn(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=Mn(i,c),wn(this._transform,this._orientation)}forward(){const i=l.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=l.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=l.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const p=new Float64Array(16);return l.invert(p,this.getWorldToCamera(i,c)),p}getWorldToCameraPosition(i,c,p){const y=this.position;l.scale$2(y,y,-i);const w=new Float64Array(16);return l.fromScaling(w,[p,p,p]),l.translate(w,w,y),w[10]*=c,w}getWorldToCamera(i,c){const p=new Float64Array(16),y=new Float64Array(4),w=this.position;return l.conjugate(y,this._orientation),l.scale$2(w,w,-i),l.fromQuat(p,y),l.translate(p,p,w),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(i,c,p,y){const w=new Float64Array(16);return l.perspective(w,i,c,p,y),w}getDistanceToElevation(i,c=!1){const p=0===i?0:l.mercatorZfromAltitude(i,c?l.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(p-this.position[2])/y[2]}clone(){return new bi([...this.position],[...this.orientation])}}function Br(h,i){const c=Di(h.projection,h.zoom,h.width,h.height),p=function(w,A,O,$,W){const G=new l.LngLat(O.lng-180*Li,O.lat),ae=new l.LngLat(O.lng+180*Li,O.lat),De=w.project(G.lng,G.lat),ye=w.project(ae.lng,ae.lat),Ee=-Math.atan2(ye.y-De.y,ye.x-De.x),be=l.MercatorCoordinate.fromLngLat(O);be.y=l.clamp(be.y,-1+Li,1-Li);const Pe=be.toLngLat(),se=w.project(Pe.lng,Pe.lat),Ie=l.MercatorCoordinate.fromLngLat(Pe);Ie.x+=Li;const We=Ie.toLngLat(),Xe=w.project(We.lng,We.lat),ft=Ps(Xe.x-se.x,Xe.y-se.y,Ee),Ct=l.MercatorCoordinate.fromLngLat(Pe);Ct.y+=Li;const Dt=Ct.toLngLat(),Rt=w.project(Dt.lng,Dt.lat),Mt=Ps(Rt.x-se.x,Rt.y-se.y,Ee),Wt=Math.abs(ft.x)/Math.abs(Mt.y),On=l.identity([]);l.rotateZ(On,On,-Ee*(1-(W?0:$)));const qt=l.identity([]);return l.scale(qt,qt,[1,1-(1-Wt)*$,1]),qt[4]=-Mt.x/Mt.y*$,l.rotateZ(qt,qt,Ee),l.multiply(qt,On,qt),qt}(h.projection,0,h.center,c,i),y=to(h);return l.scale(p,p,[y,y,1]),p}function to(h){const i=h.projection,c=Di(h.projection,h.zoom,h.width,h.height),p=ko(i,h.center),y=ko(i,l.LngLat.convert(i.center));return Math.pow(2,p*c+(1-c)*y)}function Di(h,i,c,p,y=1/0){const w=h.range;if(!w)return 0;const A=Math.min(y,Math.max(c,p)),O=Math.log(A/1024)/Math.LN2;return l.smoothstep(w[0]+O,w[1]+O,i)}const Li=1/4e4;function ko(h,i){const c=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=new l.LngLat(i.lng-180*Li,c),y=new l.LngLat(i.lng+180*Li,c),w=h.project(p.lng,c),A=h.project(y.lng,c),O=l.MercatorCoordinate.fromLngLat(p),$=l.MercatorCoordinate.fromLngLat(y),W=A.x-w.x,G=A.y-w.y,ae=$.x-O.x,De=$.y-O.y,ye=Math.sqrt((ae*ae+De*De)/(W*W+G*G));return Math.log(ye)/Math.LN2}function Ps(h,i,c){const p=Math.cos(c),y=Math.sin(c);return{x:h*p-i*y,y:h*y+i*p}}class ta{constructor(i,c,p,y,w,A,O){this.tileSize=512,this._renderWorldCopies=void 0===w||w,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=y??60,this.setProjection(A),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Et,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new bi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const i=new ta(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i,c=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||p)&&this._updateCameraOnTerrain(),(i||p)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return l.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=l.getProjection(this.projectionOptions);const p=!ve(c,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=l.getProjection({name:"mercator"});const c=i!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return l.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;var p,y,w,A,O,$,W,G,ae,De;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),y=this.rotationMatrix,A=this.angle,O=(w=this.rotationMatrix)[0],$=w[1],W=w[2],G=w[3],ae=Math.sin(A),De=Math.cos(A),y[0]=O*De+W*ae,y[1]=$*De+G*ae,y[2]=O*-ae+W*De,y[3]=$*-ae+G*De)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=l.degToRad(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,w=0;for(let A=0;A<c.length;A++){const O=new l.Point(c[A][0]*this.width,p+c[A][1]*(this.height-p)),$=i.pointCoordinate(O);if(!$)continue;const W=1/Math.hypot($[0]-this._camera.position[0],$[1]-this._camera.position[1]);y+=$[3]*W,w+=W}return 0===w?NaN:y/w}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,y=this._mercatorZfromZoom(i),w=this._mercatorZfromZoom(this._maxZoom),A=Math.max(y-p,w);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let p;p=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const y=l.length(l.sub([],this._camera.position,p));return l.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!l.exactEquals(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const p=[i.position.x,i.position.y,i.position.z];l.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new xi;return c.position=new l.MercatorCoordinate(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!l.length$1(i))return!1;l.normalize$1(i,i);const c=l.transformQuat([],[0,0,-1],i),p=l.transformQuat([],[0,-1,0],i);if(p[2]<0)return!1;const y=Dr(c,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;i[2]=l.clamp(i[2],y/p,y/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,p){this._unmodified=!1,this._edgeInsets.interpolate(i,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new l.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const p=this.pointCoordinate(new l.Point(0,0)),y=this.pointCoordinate(new l.Point(this.width,0)),w=this.pointCoordinate(new l.Point(this.width,this.height)),A=this.pointCoordinate(new l.Point(0,this.height)),O=Math.floor(Math.min(p.x,y.x,w.x,A.x)),$=Math.floor(Math.max(p.x,y.x,w.x,A.x)),W=1;for(let G=O-W;G<=$+W;G++)0!==G&&c.push(new l.UnwrappedTileID(G,i))}return c}coveringTiles(i){let c=this.coveringZoomLevel(i);const p=c,y=this.elevation&&!i.isTerrainDEM,w="mercator"===this.projection.name;if(void 0!==i.minzoom&&c<i.minzoom)return[];void 0!==i.maxzoom&&c>i.maxzoom&&(c=i.maxzoom);const A=this.locationCoordinate(this.center),O=this.center.lat,$=1<<c,W=[$*A.x,$*A.y,0],G="globe"===this.projection.name,ae=!G,De=l.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,ae),ye=G?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ee=$*l.mercatorZfromAltitude(1,this.center.lat),be=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),Pe=[$*ye.x,$*ye.y,be*(ae?1:Ee)],se=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),Ie=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,We=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Xe=i.isTerrainDEM?-We:this._elevation?this._elevation.getMinElevationBelowMSL():0,ft=this.projection.isReprojectedInTileSpace?to(this):1,Ct=nn=>{const zn=new l.MercatorCoordinate(nn.x+25e-6,nn.y,nn.z),Rn=new l.MercatorCoordinate(nn.x,nn.y+25e-6,nn.z),Vn=nn.toLngLat(),Ar=zn.toLngLat(),Xr=Rn.toLngLat(),dr=this.locationCoordinate(Vn),Ur=this.locationCoordinate(Ar),gi=this.locationCoordinate(Xr),pi=Math.hypot(Ur.x-dr.x,Ur.y-dr.y),br=Math.hypot(gi.x-dr.x,gi.y-dr.y);return Math.sqrt(pi*br)*ft/25e-6},Dt=nn=>{const En=We,zn=Xe;return{aabb:l.tileAABB(this,$,0,0,0,nn,zn,En,this.projection),zoom:0,x:0,y:0,minZ:zn,maxZ:En,wrap:nn,fullyVisible:!1}},Rt=[];let Mt=[];const Wt=c,On=i.reparseOverscaled?p:c,qt=nn=>nn*nn,Tn=qt((be-this._centerAltitude)*Ee),un=nn=>{if(!this._elevation||!nn.tileID||!w)return;const En=this._elevation.getMinMaxForTile(nn.tileID),zn=nn.aabb;En?(zn.min[2]=En.min,zn.max[2]=En.max,zn.center[2]=(zn.min[2]+zn.max[2])/2):(nn.shouldSplit=Fn(nn),nn.shouldSplit||(zn.min[2]=zn.max[2]=zn.center[2]=this._centerAltitude))},Fn=nn=>{if(nn.zoom<Ie)return!0;if(nn.zoom===Wt)return!1;if(null!=nn.shouldSplit)return nn.shouldSplit;const En=nn.aabb.distanceX(Pe),zn=nn.aabb.distanceY(Pe);let Rn=Tn,Vn=1;if(G){Rn=qt(nn.aabb.distanceZ(Pe));const dr=Math.pow(2,nn.zoom),Ur=l.latFromMercatorY((nn.y+1)/dr),gi=l.latFromMercatorY(nn.y/dr),pi=Math.min(Math.max(O,Ur),gi),br=l.circumferenceAtLatitude(pi)/l.circumferenceAtLatitude(O);if(Vn=pi===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,br/this._mercatorScaleRatio),this.zoom<=l.GLOBE_ZOOM_THRESHOLD_MIN&&nn.zoom===Wt-1&&br>=.9)return!0}else if(y&&(Rn=qt(nn.aabb.distanceZ(Pe)*Ee)),this.projection.isReprojectedInTileSpace&&p<=5){const dr=Math.pow(2,nn.zoom),Ur=Ct(new l.MercatorCoordinate((nn.x+.5)/dr,(nn.y+.5)/dr));Vn=Ur>.85?1:Ur}const Ar=En*En+zn*zn+Rn;return Ar<qt((1<<Wt-nn.zoom)*se*Vn*((dr,Ur)=>{if(Ur*qt(.707)<dr)return 1;const gi=Math.sqrt(Ur/dr);return gi/(1.4144271570014144+(Math.pow(1.1,gi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Rn,Tn),Ar))};if(this.renderWorldCopies)for(let nn=1;nn<=3;nn++)Rt.push(Dt(-nn)),Rt.push(Dt(nn));for(Rt.push(Dt(0));Rt.length>0;){const nn=Rt.pop(),En=nn.x,zn=nn.y;let Rn=nn.fullyVisible;if(!Rn){const Vn=nn.aabb.intersects(De);if(0===Vn)continue;Rn=2===Vn}if(nn.zoom!==Wt&&Fn(nn))for(let Vn=0;Vn<4;Vn++){const Ar=(En<<1)+Vn%2,Xr=(zn<<1)+(Vn>>1),dr={aabb:w?nn.aabb.quadrant(Vn):l.tileAABB(this,$,nn.zoom+1,Ar,Xr,nn.wrap,nn.minZ,nn.maxZ,this.projection),zoom:nn.zoom+1,x:Ar,y:Xr,wrap:nn.wrap,fullyVisible:Rn,tileID:void 0,shouldSplit:void 0,minZ:nn.minZ,maxZ:nn.maxZ};y&&!G&&(dr.tileID=new l.OverscaledTileID(nn.zoom+1===Wt?On:nn.zoom+1,nn.wrap,nn.zoom+1,Ar,Xr),un(dr)),Rt.push(dr)}else{const Vn=nn.zoom===Wt?On:nn.zoom;if(i.minzoom&&i.minzoom>Vn)continue;const Ar=W[0]-(.5+En+(nn.wrap<<nn.zoom))*(1<<c-nn.zoom),Xr=W[1]-.5-zn,dr=nn.tileID?nn.tileID:new l.OverscaledTileID(Vn,nn.wrap,nn.zoom,En,zn);Mt.push({tileID:dr,distanceSq:Ar*Ar+Xr*Xr})}}if(this.fogCullDistSq){const nn=this.fogCullDistSq,En=this.horizonLineFromTop();Mt=Mt.filter(zn=>{const Rn=[0,0,0,1],Vn=[l.EXTENT,l.EXTENT,0,1],Ar=this.calculateFogTileMatrix(zn.tileID.toUnwrapped());l.transformMat4$1(Rn,Rn,Ar),l.transformMat4$1(Vn,Vn,Ar);const Xr=l.getAABBPointSquareDist(Rn,Vn);if(0===Xr)return!0;let dr=!1;const Ur=this._elevation;if(Ur&&Xr>nn&&0!==En){const gi=this.calculateProjMatrix(zn.tileID.toUnwrapped());let pi;i.isTerrainDEM||(pi=Ur.getMinMaxForTile(zn.tileID)),pi||(pi={min:Xe,max:We});const br=l.furthestTileCorner(this.rotation),Xi=[br[0]*l.EXTENT,br[1]*l.EXTENT,pi.max];l.transformMat4(Xi,Xi,gi),dr=(1-Xi[1])*this.height*.5<En}return Xr<nn||dr})}return Mt.sort((nn,En)=>nn.distanceSq-En.distanceSq).map(nn=>nn.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const c=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=this.projection.project(i.lng,c);return new l.Point(p.x*this.worldSize,p.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/l.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,c){let p,y;const w=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;p=(c.x-w.x)/O,y=(c.y-w.y)/O}else{const O=this.pointCoordinate(c),$=this.pointCoordinate(w);p=O.x-$.x,y=O.y-$.y}const A=this.locationCoordinate(i);this.setLocation(new l.MercatorCoordinate(A.x-p,A.y-y))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,c){const p=c?l.mercatorZfromAltitude(c,i.lat):void 0,y=this.projection.project(i.lng,i.lat);return new l.MercatorCoordinate(y.x,y.y,p)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const p=c??this._centerAltitude,y=[i.x,i.y,0,1],w=[i.x,i.y,1,1];l.transformMat4$1(y,y,this.pixelMatrixInverse),l.transformMat4$1(w,w,this.pixelMatrixInverse);const A=w[3];l.scale$1(y,y,1/y[3]),l.scale$1(w,w,1/A);const O=y[2],$=w[2];return{p0:y,p1:w,t:O===$?0:(p-O)/($-O)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],p=[i.x,i.y,1,1];return l.transformMat4$1(c,c,this.pixelMatrixInverse),l.transformMat4$1(p,p,this.pixelMatrixInverse),l.scale$1(c,c,1/c[3]),l.scale$1(p,p,1/p[3]),c[2]=l.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=l.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,l.scale$1(c,c,1/this.worldSize),l.scale$1(p,p,1/this.worldSize),new l.Ray([c[0],c[1],c[2]],l.normalize([],l.sub([],p,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:p,t:y}=i,w=l.mercatorZfromAltitude(c[2],this._center.lat),A=l.mercatorZfromAltitude(p[2],this._center.lat);return new l.MercatorCoordinate(l.number(c[0],p[0],y)/this.worldSize,l.number(c[1],p[1],y)/this.worldSize,l.number(w,A,y))}pointCoordinate(i,c=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,c)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let c=this.projection.pointCoordinate3D(this,i.x,i.y);if(c)return new l.MercatorCoordinate(c[0],c[1],c[2]);let p=0,y=this.horizonLineFromTop();if(i.y>y)return this.pointCoordinate(i);const w=.02*y,A=i.clone();for(let O=0;O<10&&y-p>w;O++){A.y=l.number(p,y,.66);const $=this.projection.pointCoordinate3D(this,A.x,A.y);$?(y=A.y,c=$):p=A.y}return c?new l.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}isPointOnSurface(i){if(i.y<0||i.y>this.height||i.x<0||i.x>this.width)return!1;if(this.elevation||this.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(i);const c=this.pointCoordinate(i);return c.y>=0&&c.y<=1}_coordinatePoint(i,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,y=[i.x*this.worldSize,i.y*this.worldSize,p+i.toAltitude(),1];return l.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new l.Point(y[0]/y[3],y[1]/y[3]):new l.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:c}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,w=this.pointLocation3D(new l.Point(c,i)),A=this.pointLocation3D(new l.Point(y,i)),O=this.pointLocation3D(new l.Point(y,p)),$=this.pointLocation3D(new l.Point(c,p));let W=Math.min(w.lng,A.lng,O.lng,$.lng),G=Math.max(w.lng,A.lng,O.lng,$.lng),ae=Math.min(w.lat,A.lat,O.lat,$.lat),De=Math.max(w.lat,A.lat,O.lat,$.lat);const ye=Math.pow(2,-this.zoom)/16*270,Ee="globe"===this.projection.name?1:4,be=(Pe,se,Ie,We,Xe)=>{const ft=(Pe+Ie)/2,Ct=(se+We)/2,Dt=new l.Point(ft,Ct),{lng:Rt,lat:Mt}=this.pointLocation3D(Dt),Wt=Math.max(0,W-Rt,ae-Mt,Rt-G,Mt-De);W=Math.min(W,Rt),G=Math.max(G,Rt),ae=Math.min(ae,Mt),De=Math.max(De,Mt),(Xe<Ee||Wt>ye)&&(be(Pe,se,ft,Ct,Xe+1),be(ft,Ct,Ie,We,Xe+1))};if(be(c,i,y,i,1),be(y,i,y,p,1),be(y,p,c,p,1),be(c,p,c,i,1),"globe"===this.projection.name){const[Pe,se]=l.polesInViewport(this);Pe?(De=90,G=180,W=-180):se&&(ae=-90,G=180,W=-180)}return new l.LngLatBounds(new l.LngLat(W,ae),new l.LngLat(G,De))}_getBoundsRectangular(i,c){const{top:p,left:y}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,O=new l.Point(y,p),$=new l.Point(A,p),W=new l.Point(A,w),G=new l.Point(y,w);let ae=this.pointCoordinate(O,i),De=this.pointCoordinate($,i);const ye=this.pointCoordinate(W,c),Ee=this.pointCoordinate(G,c),be=(Pe,se)=>(se.y-Pe.y)/(se.x-Pe.x);return ae.y>1&&De.y>=0?ae=new l.MercatorCoordinate((1-Ee.y)/be(Ee,ae)+Ee.x,1):ae.y<0&&De.y<=1&&(ae=new l.MercatorCoordinate(-Ee.y/be(Ee,ae)+Ee.x,0)),De.y>1&&ae.y>=0?De=new l.MercatorCoordinate((1-ye.y)/be(ye,De)+ye.x,1):De.y<0&&ae.y<=1&&(De=new l.MercatorCoordinate(-ye.y/be(ye,De)+ye.x,0)),(new l.LngLatBounds).extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(De)).extend(this.coordinateLocation(Ee)).extend(this.coordinateLocation(ye))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=i.visibleDemTiles.reduce((p,y)=>{if(y.dem){const w=y.dem.tree;p.min=Math.min(p.min,w.minimums[0]),p.max=Math.max(p.max,w.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-l.MAX_MERCATOR_LATITUDE,this.maxLat=l.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=l.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=l.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=l.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=l.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileMatrix(this,c,i)}calculateDistanceTileData(i){const c=i.key,p=this._distanceTileDataCache;if(p[c])return p[c];const y=i.canonical,w=1/this.height,A=this.cameraWorldSize,O=A/this.zoomScale(y.z),$=(y.x+Math.pow(2,y.z)*i.wrap)*O,W=y.y*O,G=this.point;G.x*=A/this.worldSize,G.y*=A/this.worldSize;const ae=this.angle,De=Math.sin(-ae),ye=-Math.cos(-ae);return p[c]={bearing:[De,ye],center:[(G.x-$)*w,(G.y-W)*w],scale:O/l.EXTENT*w},p[c]}calculateFogTileMatrix(i){const c=i.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return l.multiply(y,this.worldToFogMatrix,y),p[c]=new Float32Array(y),p[c]}calculateProjMatrix(i,c=!1){const p=i.key,y=c?this._alignedProjMatrixCache:this._projMatrixCache;if(y[p])return y[p];const w=this.calculatePosMatrix(i,this.worldSize);return l.multiply(w,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,w),y[p]=new Float32Array(w),y[p]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const y=function(w,A){const{scale:O}=w.tileTransform,$=O*l.EXTENT/(w.tileSize*Math.pow(2,A.zoom-w.tileID.overscaledZ+w.tileID.canonical.z));return W=new Float32Array(4),De=(G=A.inverseAdjustmentMatrix)[1],ye=G[2],Ee=G[3],Pe=(ae=[$,$])[1],W[0]=G[0]*(be=ae[0]),W[1]=De*be,W[2]=ye*Pe,W[3]=Ee*Pe,W;var W,G,ae,De,ye,Ee,be,Pe}(i,this);return p[c]=y,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const i=1/this.worldSize,c=l.fromScaling([],[i,i,i]);return l.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const c=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),y=this._camera.forward(),w=l.mercatorZfromAltitude(1,this._center.lat);p[2]/=w,y[2]/=w,l.normalize(y,y);const A=i.raycast(p,y,i.exaggeration());if(A){const O=l.scaleAndAdd([],p,y,A),$=new l.MercatorCoordinate(O[0],O[1],l.mercatorZfromAltitude(O[2],l.latFromMercatorY(O[1]))),W=($.z+l.length([$.x-p[0],$.y-p[1],$.z-p[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(W),this._centerAltitude=$.toAltitude(),this._center=this.coordinateLocation($),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const c=this._elevation,p=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(p),w=c.getAtPointOrZero(new l.MercatorCoordinate(...y)),A=this.pixelsPerMeter/this.worldSize*w,O=this._minimumHeightOverTerrain(),$=y[2]-A;if($<=O)if($<0||i){const W=this.locationCoordinate(this._center,this._centerAltitude),G=[y[0],y[1],W.z-y[2]],ae=l.length(G);G[2]-=(O-$)/this._pixelsPerMercatorPixel;const De=l.length(G);if(0===De)return;l.scale$2(G,G,ae/De*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],W.z*this._pixelsPerMercatorPixel-G[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const De=this.center;return De.lat=l.clamp(De.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(De.lng=l.clamp(De.lng,this.minLng,this.maxLng)),this.center=De,void(this._constraining=!1)}const c=this._unmodified,{x:p,y}=this.point;let w=0,A=p,O=y;const $=this.width/2,W=this.height/2,G=this.worldMinY*this.scale,ae=this.worldMaxY*this.scale;if(y-W<G&&(O=G+W),y+W>ae&&(O=ae-W),ae-G<this.height&&(w=Math.max(w,this.height/(ae-G)),O=(ae+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const De=this.worldMinX*this.scale,ye=this.worldMaxX*this.scale,Ee=this.worldSize/2-(De+ye)/2;A=(p+Ee+this.worldSize)%this.worldSize-Ee,A-$<De&&(A=De+$),A+$>ye&&(A=ye-$),ye-De<this.width&&(w=Math.max(w,this.width/(ye-De)),A=(ye+De)/2)}A===p&&O===y||(this.center=this.unproject(new l.Point(A,O))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=l.mercatorZfromAltitude(1,this.center.lat)/l.mercatorZfromAltitude(1,l.GLOBE_SCALE_MATCH_LATITUDE));const p=Di(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y="meters"===this.projection.zAxisUnit?c:1,w=this._camera.getWorldToCamera(this.worldSize,y),A=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);A[8]=2*-i.x/this.width,A[9]=2*i.y/this.height;let O=l.mul([],A,w);if(this.projection.isReprojectedInTileSpace){const Ct=this.locationCoordinate(this.center),Dt=l.identity([]);l.translate(Dt,Dt,[Ct.x*this.worldSize,Ct.y*this.worldSize,0]),l.multiply(Dt,Dt,Br(this)),l.translate(Dt,Dt,[-Ct.x*this.worldSize,-Ct.y*this.worldSize,0]),l.multiply(O,O,Dt),this.inverseAdjustmentMatrix=function(Rt){const Mt=Br(Rt,!0);return Me([],[Mt[0],Mt[1],Mt[4],Mt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=l.scale([],O,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=O,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const $=l.invert([],A);this.frustumCorners=l.FrustumCorners.fromInvProjectionMatrix($,this.horizonLineFromTop(),this.height);const W=new Float32Array(16);l.identity(W),l.scale(W,W,[1,-1,1]),l.rotateX(W,W,this._pitch),l.rotateZ(W,W,this.angle);const G=l.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ae=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;G[8]=2*-i.x/this.width,G[9]=2*(i.y+ae)/this.height,this.skyboxMatrix=l.multiply(W,G,W);const De=this.point,ye=De.x,Ee=De.y,be=this.width%2/2,Pe=this.height%2/2,se=Math.cos(this.angle),Ie=Math.sin(this.angle),We=ye-Math.round(ye)+se*be+Ie*Pe,Xe=Ee-Math.round(Ee)+se*Pe+Ie*be,ft=new Float64Array(O);if(l.translate(ft,ft,[We>.5?We-1:We,Xe>.5?Xe-1:Xe,0]),this.alignedProjMatrix=ft,O=l.create(),l.scale(O,O,[this.width/2,-this.height/2,1]),l.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=l.create(),l.scale(O,O,[1,-1,1]),l.translate(O,O,[-1,-1,0]),l.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=l.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=l.calculateGlobeMatrix(this);const Ct=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=l.transformMat4(Ct,Ct,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,w=[i,i,c];l.scale$2(w,w,y),l.scale$2(p,p,-1),l.multiply$2(p,p,w);const A=l.create();l.translate(A,A,p),l.scale(A,A,w),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,y)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),y=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-p[0]*w,y.y/this.worldSize-p[1]*w,i/this.worldSize*this._centerAltitude-p[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],y=i[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(w=Math.min((c-p)/y,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,i,w),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),w=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),O=Math.max((i[2]-w)/Math.cos(p),A),$=this._zoomFromMercatorZ(O);l.scaleAndAdd(i,i,c,O),this._pitch=l.clamp(p,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(y,-Math.PI,Math.PI),this._setZoom(l.clamp($,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new l.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){let c=0,p=l.GLOBE_ZOOM_THRESHOLD_MAX,y=0,w=1/0;for(;p-c>1e-6&&p>c;){const A=c+.5*(p-c),O=this.tileSize*Math.pow(2,A),$=this.getCameraToCenterDistance(this.projection,A,O),W=this.scaleZoom($/(i*this.tileSize)),G=Math.abs(A-W);G<w&&(w=G,y=A),A<W?c=A:p=A}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(l.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,c){const p=Math.min(i.x,c.x),y=Math.max(i.x,c.x),w=Math.min(i.y,c.y),A=Math.max(i.y,c.y);if(w<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new l.Point(p,w),new l.Point(y,A),new l.Point(p,A),new l.Point(y,w)],$=this.renderWorldCopies?-3:0,W=this.renderWorldCopies?4:1;for(const G of O){const ae=this.pointRayIntersection(G);if(ae.t<0)return!0;const De=this.rayIntersectionCoordinate(ae);if(De.x<$||De.y<0||De.x>W||De.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new l.Point(0,0),new l.Point(this.width,this.height))}zoomDeltaToMovement(i,c){const p=l.length(l.sub([],this._camera.position,i)),y=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(y)}getCameraPoint(){if("globe"===this.projection.name){const i=function([c,p,y],w){const A=[c,p,y,1];l.transformMat4$1(A,A,w);const O=A[3]=Math.max(A[3],1e-6);return A[0]/=O,A[1]/=O,A[2]/=O,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new l.Point(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,i))}}getCameraToCenterDistance(i,c=this.zoom,p=this.worldSize){const y=Di(i,c,this.width,this.height,1024),w=i.pixelSpaceConversion(this.center.lat,p,y);return.5/Math.tan(.5*this._fov)*this.height*w}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&l.multiply(i,i,this.globeMatrix),i}}function Yi(h,i){let c=!1,p=null;const y=()=>{p=null,c&&(h(),p=setTimeout(y,i),c=!1)};return()=>(c=!0,p||y(),p)}class _s{constructor(i){this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Yi(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),l.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const c=Cs(i);if(this._hashName){const p=this._hashName;let y=!1;const w=l.window.location.hash.slice(1).split("&").map(A=>{const O=A.split("=")[0];return O===p?(y=!0,`${O}=${c}`):A}).filter(A=>A);return y||w.push(`${p}=${c}`),`#${w.join("&")}`}return`#${c}`}_getCurrentHash(){const i=l.window.location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){const p=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(c[3]||0):i.getBearing();return i.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,i)}}function Cs(h,i){const c=h.getCenter(),p=Math.round(100*h.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,y),A=Math.round(c.lng*w)/w,O=Math.round(c.lat*w)/w,$=h.getBearing(),W=h.getPitch();let G=i?`/${A}/${O}/${p}`:`${p}/${O}/${A}`;return($||W)&&(G+="/"+Math.round(10*$)/10),W&&(G+=`/${Math.round(W)}`),G}const aa={linearity:.3,easing:l.bezier(0,0,.3,1)},Gl=l.extend({deceleration:2500,maxSpeed:1400},aa),cl=l.extend({deceleration:20,maxSpeed:1400},aa),or=l.extend({deceleration:1e3,maxSpeed:360},aa),la=l.extend({deceleration:1e3,maxSpeed:90},aa);class ei{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=l.exported.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)c.zoom+=w.zoomDelta||0,c.bearing+=w.bearingDelta||0,c.pitch+=w.pitchDelta||0,w.panDelta&&c.pan._add(w.panDelta),w.around&&(c.around=w.around),w.pinchAround&&(c.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){const w=wl(c.pan.mag(),p,l.extend({},Gl,i||{}));y.offset=c.pan.mult(w.amount/c.pan.mag()),y.center=this._map.transform.center,Za(y,w)}if(c.zoom){const w=wl(c.zoom,p,cl);y.zoom=this._map.transform.zoom+w.amount,Za(y,w)}if(c.bearing){const w=wl(c.bearing,p,or);y.bearing=this._map.transform.bearing+l.clamp(w.amount,-179,179),Za(y,w)}if(c.pitch){const w=wl(c.pitch,p,la);y.pitch=this._map.transform.pitch+w.amount,Za(y,w)}if(y.zoom||y.bearing){const w=void 0===c.pinchAround?c.around:c.pinchAround;y.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function Za(h,i){(!h.duration||h.duration<i.duration)&&(h.duration=i.duration,h.easing=i.easing)}function wl(h,i,c){const{maxSpeed:p,linearity:y,deceleration:w}=c,A=l.clamp(h*y/(i/1e3),-p,p),O=Math.abs(A)/(w*y);return{easing:c.easing,duration:1e3*O,amount:A*(O/2)}}class ys extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p,y={}){const w=nt(c.getCanvasContainer(),p),A=c.unproject(w);super(i,l.extend({point:w,lngLat:A,originalEvent:p},y)),this._defaultPrevented=!1,this.target=c}}class Ya extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){const y="touchend"===i?p.changedTouches:p.touches,w=Bt(c.getCanvasContainer(),y),A=w.map($=>c.unproject($)),O=w.reduce(($,W,G,ae)=>$.add(W.div(ae.length)),new l.Point(0,0));super(i,{points:w,point:O,lngLats:A,lngLat:c.unproject(O),originalEvent:p}),this._defaultPrevented=!1}}class Bs extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){super(i,{originalEvent:p}),this._defaultPrevented=!1}}class Wl{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new Bs(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new ys(i.type,this._map,i))}mouseup(i){this._map.fire(new ys(i.type,this._map,i))}preclick(i){const c=l.extend({},i);c.type="preclick",this._map.fire(new ys(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new ys(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new ys(i.type,this._map,i))}mouseover(i){this._map.fire(new ys(i.type,this._map,i))}mouseout(i){this._map.fire(new ys(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Ya(i.type,this._map,i))}touchmove(i){this._map.fire(new Ya(i.type,this._map,i))}touchend(i){this._map.fire(new Ya(i.type,this._map,i))}touchcancel(i){this._map.fire(new Ya(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Da{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new ys(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ys("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new ys(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class au{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&0===i.button&&(lt(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const p=c,y=this._startPos,w=this._lastPos;if(!y||!w||w.equals(p)||!this._box&&p.dist(y)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=et("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const A=Math.min(y.x,p.x),O=Math.max(y.x,p.x),$=Math.min(y.y,p.y),W=Math.max(y.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${$}px)`,this._box.style.width=O-A+"px",this._box.style.height=W-$+"px")})}mouseupWindow(i,c){if(!this._active)return;const p=this._startPos,y=c;if(p&&0===i.button){if(this.reset(),_t(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:w=>w.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),pt(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new l.Event(i,{originalEvent:c}))}}function ql(h,i){const c={};for(let p=0;p<h.length;p++)c[h[p].identifier]=i[p];return c}class za{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const w=new l.Point(0,0);for(const A of y)w._add(A);return w.div(y.length)}(c),this.touches=ql(p,c)))}touchmove(i,c,p){if(this.aborted||!this.centroid)return;const y=ql(p,c);for(const w in this.touches){const A=y[w];(!A||A.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(i,c,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Zl{constructor(i){this.singleTap=new za(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,c,p){this.singleTap.touchstart(i,c,p)}touchmove(i,c,p){this.singleTap.touchmove(i,c,p)}touchend(i,c,p){const y=this.singleTap.touchend(i,c,p);if(y){const w=i.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(y)<30;if(w&&A||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class pc{constructor(){this._zoomIn=new Zl({numTouches:1,numTaps:2}),this._zoomOut=new Zl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,p){this._zoomIn.touchstart(i,c,p),this._zoomOut.touchstart(i,c,p)}touchmove(i,c,p){this._zoomIn.touchmove(i,c,p),this._zoomOut.touchmove(i,c,p)}touchend(i,c,p){const y=this._zoomIn.touchend(i,c,p),w=this._zoomOut.touchend(i,c,p);return y?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(y)},{originalEvent:i})}):w?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(w)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Nn={0:1,2:2};class ri{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const p=Ft(i);this._correctButton(i,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(i,c){const p=this._lastPoint;if(p)if(i.preventDefault(),null!=this._eventButton&&function(y,w){const A=Nn[w];return void 0===y.buttons||(y.buttons&A)!==A}(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}mouseupWindow(i){this._lastPoint&&Ft(i)===this._eventButton&&(this._moved&&_t(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ca extends ri{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return 0===c&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class El extends ri{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const p=.8*(c.x-i.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(i){i.preventDefault()}}class ds extends ri{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const p=-.5*(c.y-i.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(i){i.preventDefault()}}class Dl{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),l.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)}touchstart(i,c,p){return this._calculateTransform(i,c,p)}touchmove(i,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===p.length&&!l.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,c,p)}}touchend(i,c,p){this._calculateTransform(i,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,p){p.length>0&&(this._active=!0);const y=ql(p,c),w=new l.Point(0,0),A=new l.Point(0,0);let O=0;for(const W in y){const G=y[W],ae=this._touches[W];ae&&(w._add(G),A._add(G.sub(ae)),O++,y[W]=G)}if(this._touches=y,O<this._minTouches||!A.mag())return;const $=A.div(O);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(O),panDelta:$}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=et("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class $a{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,c,p){return{}}touchstart(i,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,p){const y=this._firstTwoTouches;if(!y)return;i.preventDefault();const[w,A]=y,O=na(p,c,w),$=na(p,c,A);if(!O||!$)return;const W=this._aroundCenter?null:O.add($).div(2);return this._move([O,$],W,i)}touchend(i,c,p){if(!this._firstTwoTouches)return;const[y,w]=this._firstTwoTouches,A=na(p,c,y),O=na(p,c,w);A&&O||(this._active&&_t(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function na(h,i,c){for(let p=0;p<h.length;p++)if(h[p].identifier===c)return i[p]}function Yl(h,i){return Math.log(h/i)/Math.LN2}class Ac extends $a{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Yl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yl(this._distance,p),pinchAround:c}}}function mc(h,i){return 180*h.angleWith(i)/Math.PI}class zu extends $a{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const p=this._vector;if(this._vector=i[0].sub(i[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:mc(this._vector,p),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const y=mc(i,p);return Math.abs(y)<c}}function Va(h){return Math.abs(h.y)>Math.abs(h.x)}class Ts extends $a{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Va(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,p){const y=this._lastPoints;if(!y)return;const w=i[0].sub(y[0]),A=i[1].sub(y[1]);return this._map._cooperativeGestures&&!l.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(w,A,p.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(w.y+A.y)/2*-.5})}gestureBeginsVertically(i,c,p){if(void 0!==this._valid)return this._valid;const y=i.mag()>=2,w=c.mag()>=2;if(!y&&!w)return;if(!y||!w)return null==this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const A=i.y>0==c.y>0;return Va(i)&&Va(c)&&A}}const Ta={panStep:100,bearingStep:15,pitchStep:10};class Cl{constructor(){const i=Ta;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,p=0,y=0,w=0,A=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),w=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),w=1);break;case 38:i.shiftKey?y=1:(i.preventDefault(),A=-1);break;case 40:i.shiftKey?y=-1:(i.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:O=>{const $=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Xa,zoom:c?Math.round($)+c*(i.shiftKey?2:1):$,bearing:O.getBearing()+p*this._bearingStep,pitch:O.getPitch()+y*this._pitchStep,offset:[-w*this._panStep,-A*this._panStep],center:O.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xa(h){return h*(2-h)}const ca=4.000244140625;class Pc{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||l.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const p=l.exported.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==c&&c%ca==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=nt(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;"wheel"===this._type&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const $="wheel"===this._type&&Math.abs(this._delta)>ca?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&0!==W&&(W=1/W);const G=c(),ae=Math.pow(2,G),De="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):ae;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(De*W))),"wheel"===this._type&&(this._startZoom=G,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:c(),y=this._startZoom,w=this._easing;let A,O=!1;if("wheel"===this._type&&y&&w){const $=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),W=w($);A=l.number(y,p,W),$<1?this._frameId||(this._frameId=!0):O=!0}else A=p,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:A-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=l.ease;if(this._prevEase){const p=this._prevEase,y=(l.exported.now()-p.start)/p.duration,w=p.easing(y+.01)-p.easing(y),A=.27/Math.sqrt(w*w+1e-4)*.01,O=Math.sqrt(.0729-A*A);c=l.bezier(A,O,.25,1)}return this._prevEase={start:l.exported.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=et("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(l.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Xl{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ss{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(i.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class md{constructor(){this._tap=new Zl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,c,p){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(i,c,p))}touchmove(i,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=c[0],w=y.y-this._swipePoint.y;return this._swipePoint=y,i.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(i,c,p)}touchend(i,c,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(i,c,p)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kl{constructor(i,c,p){this._el=i,this._mousePan=c,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class gc{constructor(i,c,p){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class lu{constructor(i,c,p,y){this._el=i,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qs=h=>h.zoom||h.drag||h.pitch||h.rotate;class Rc extends l.Event{}class L{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const p=l.sub([],c,i);this.radius=l.length(p[2]<0?l.div([],p,this.constants):[p[0],p[1],0])}projectRay(i){l.div(i,i,this.constants),l.normalize(i,i),l.mul$1(i,i,this.constants);const c=l.scale$2([],i,this.radius);if(c[2]>0){const p=l.scale$2([],[0,0,1],l.dot(c,[0,0,1])),y=l.scale$2([],l.normalize([],[c[0],c[1],0]),this.radius),w=l.add([],c,l.scale$2([],l.sub([],l.add([],y,p),c),2));c[0]=w[0],c[1]=w[1]}return c}}function z(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class H{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ei(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new L,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),l.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[y,w,A]of this._listeners)y.addEventListener(w,y===l.window.document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[i,c,p]of this._listeners)i.removeEventListener(c,i===l.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(i){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new Wl(c,i));const y=c.boxZoom=new au(c,i);this._add("boxZoom",y);const w=new pc,A=new Ss;c.doubleClickZoom=new Xl(A,w),this._add("tapZoom",w),this._add("clickZoom",A);const O=new md;this._add("tapDragZoom",O);const $=c.touchPitch=new Ts(c);this._add("touchPitch",$);const W=new El(i),G=new ds(i);c.dragRotate=new gc(i,W,G),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const ae=new Ca(i),De=new Dl(c,i);c.dragPan=new Kl(p,ae,De),this._add("mousePan",ae),this._add("touchPan",De,["touchZoom","touchRotate"]);const ye=new zu,Ee=new Ac;c.touchZoomRotate=new lu(p,Ee,ye,O),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",Ee,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Da(c));const be=c.scrollZoom=new Pc(c,this);this._add("scrollZoom",be,["mousePan"]);const Pe=c.keyboard=new Cl;this._add("keyboard",Pe);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[se]&&c[se].enable(i[se])}_add(i,c,p){this._handlers.push({handlerName:i,handler:c,allowed:p}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,c,p){for(const y in i)if(y!==p&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const p of i)this._el.contains(p.target)&&c.push(p);return c}handleEvent(i,c){this._updatingCamera=!0;const p="renderFrame"===i.type,y=p?void 0:i,w={needsRenderFrame:!1},A={},O={},$=i.touches?this._getMapTouches(i.touches):void 0,W=$?Bt(this._el,$):p?void 0:nt(this._el,i);for(const{handlerName:De,handler:ye,allowed:Ee}of this._handlers){if(!ye.isEnabled())continue;let be;this._blockedByActive(O,Ee,De)?ye.reset():ye[c||i.type]&&(be=ye[c||i.type](i,W,$),this.mergeHandlerResult(w,A,be,De,y),be&&be.needsRenderFrame&&this._triggerRenderFrame()),(be||ye.isActive())&&(O[De]=ye)}const G={};for(const De in this._previousActiveHandlers)O[De]||(G[De]=y);this._previousActiveHandlers=O,(Object.keys(G).length||z(w))&&(this._changes.push([w,A,G]),this._triggerRenderFrame()),(Object.keys(O).length||z(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ae}=w;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))}mergeHandlerResult(i,c,p,y,w){if(!p)return;l.extend(i,p);const A={handlerName:y,originalEvent:p.originalEvent||w};void 0!==p.zoomDelta&&(c.zoom=A),void 0!==p.panDelta&&(c.drag=A),void 0!==p.pitchDelta&&(c.pitch=A),void 0!==p.bearingDelta&&(c.rotate=A)}_applyChanges(){const i={},c={},p={};for(const[y,w,A]of this._changes)y.panDelta&&(i.panDelta=(i.panDelta||new l.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+y.pitchDelta),void 0!==y.around&&(i.around=y.around),void 0!==y.aroundCoord&&(i.aroundCoord=y.aroundCoord),void 0!==y.pinchAround&&(i.pinchAround=y.pinchAround),y.noInertia&&(i.noInertia=y.noInertia),l.extend(c,w),l.extend(p,A);this._updateMapTransform(i,c,p),this._changes=[]}_updateMapTransform(i,c,p){const y=this._map,w=y.transform,A=Ie=>[Ie.x,Ie.y,Ie.z];if((Ie=>{const We=this._eventsInProgress.drag;return We&&!this._handlersById[We.handlerName].isActive()})()&&!z(i)){const Ie=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",Ie!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&y._stop(!0),!z(i))return void this._fireEvents(c,p,!0);let{panDelta:O,zoomDelta:$,bearingDelta:W,pitchDelta:G,around:ae,aroundCoord:De,pinchAround:ye}=i;w._isCameraConstrained&&($>0&&($=0),w._isCameraConstrained=!1),void 0!==ye&&(ae=ye),($||(Ie=>c.drag&&!this._eventsInProgress.drag)())&&ae&&(this._dragOrigin=A(w.pointCoordinate3D(ae)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",y._stop(!0),ae=ae||y.transform.centerPoint,W&&(w.bearing+=W),G&&(w.pitch+=G),w._updateCameraState();const Ee=[0,0,0];if(O)if("mercator"===w.projection.name){const Ie=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(ae).dir),We=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(ae.sub(O)).dir);Ee[0]=We[0]-Ie[0],Ee[1]=We[1]-Ie[1]}else{const Ie=w.pointCoordinate(ae);if("globe"===w.projection.name){O=O.rotate(-w.angle);const We=w._pixelsPerMercatorPixel/w.worldSize;Ee[0]=-O.x*l.mercatorScale(l.latFromMercatorY(Ie.y))*We,Ee[1]=-O.y*l.mercatorScale(w.center.lat)*We}else{const We=w.pointCoordinate(ae.sub(O));Ie&&We&&(Ee[0]=We.x-Ie.x,Ee[1]=We.y-Ie.y)}}const be=w.zoom,Pe=[0,0,0];if($){const Ie=A(De||w.pointCoordinate3D(ae)),We={dir:l.normalize([],l.sub([],Ie,w._camera.position))};if(We.dir[2]<0){const Xe=w.zoomDeltaToMovement(Ie,$);l.scale$2(Pe,We.dir,Xe)}}const se=l.add(Ee,Ee,Pe);w._translateCameraConstrained(se),$&&Math.abs(w.zoom-be)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,p,!0)}_fireEvents(i,c,p){const y=qs(this._eventsInProgress),w=qs(i),A={};for(const G in i){const{originalEvent:ae}=i[G];this._eventsInProgress[G]||(A[`${G}start`]=ae),this._eventsInProgress[G]=i[G]}!y&&w&&this._fireEvent("movestart",w.originalEvent);for(const G in A)this._fireEvent(G,A[G]);w&&this._fireEvent("move",w.originalEvent);for(const G in i){const{originalEvent:ae}=i[G];this._fireEvent(G,ae)}const O={};let $;for(const G in this._eventsInProgress){const{handlerName:ae,originalEvent:De}=this._eventsInProgress[G];this._handlersById[ae].isActive()||(delete this._eventsInProgress[G],$=c[ae]||De,O[`${G}end`]=$)}for(const G in O)this._fireEvent(G,O[G]);const W=qs(this._eventsInProgress);if(p&&(y||w)&&!W){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ae=De=>0!==De&&-this._bearingSnap<De&&De<this._bearingSnap;G?(ae(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:$})):(this._map.fire(new l.Event("moveend",{originalEvent:$})),ae(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new l.Event(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new Rc("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const B="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class D extends l.Evented{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=!1!==c.respectPrefersReducedMotion,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,p){return i=l.Point.convert(i).mult(-1),this.panTo(this.transform.center,l.extend({offset:i},c),p)}panTo(i,c,p){return this.easeTo(l.extend({center:i},c),p)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,p){return this.easeTo(l.extend({zoom:i},c),p)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,p){return this.easeTo(l.extend({bearing:i},c),p)}resetNorth(i,c){return this.rotateTo(0,l.extend({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=l.LngLatBounds.convert(i);const p=c&&c.bearing||0,y=c&&c.pitch||0,w=i.getNorthWest(),A=i.getSouthEast();return this._cameraForBounds(this.transform,w,A,p,y,c)}_extendCameraOptions(i){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=l.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const p=i.padding;i.padding={top:p,bottom:p,right:p,left:p}}return i.padding=l.extend(c,i.padding),i}_minimumAABBFrustumDistance(i,c){const p=c.max[0]-c.min[0],y=c.max[1]-c.min[1];return p/y>i.aspect?p/(2*Math.tan(.5*i.fovX)*i.aspect):y/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,c,p,y,w,A){const O=i.clone(),$=this._extendCameraOptions(A);O.bearing=y,O.pitch=w;const W=l.LngLat.convert(c),G=l.LngLat.convert(p),ae=.5*(W.lat+G.lat),De=.5*(W.lng+G.lng),ye=l.latLngToECEF(ae,De),Ee=l.normalize([],ye),be=l.normalize([],l.cross([],Ee,[0,1,0])),Pe=l.cross([],be,Ee),se=[be[0],be[1],be[2],0,Pe[0],Pe[1],Pe[2],0,Ee[0],Ee[1],Ee[2],0,0,0,0,1],Ie=[ye,l.latLngToECEF(W.lat,W.lng),l.latLngToECEF(G.lat,W.lng),l.latLngToECEF(G.lat,G.lng),l.latLngToECEF(W.lat,G.lng),l.latLngToECEF(ae,W.lng),l.latLngToECEF(ae,G.lng),l.latLngToECEF(W.lat,De),l.latLngToECEF(G.lat,De)];let We=l.Aabb.fromPoints(Ie.map(Rn=>[l.dot(be,Rn),l.dot(Pe,Rn),l.dot(Ee,Rn)]));const Xe=l.transformMat4([],We.center,se);0===l.squaredLength(Xe)&&l.set(Xe,0,0,1),l.normalize(Xe,Xe),l.scale$2(Xe,Xe,l.GLOBE_RADIUS),O.center=l.ecefToLatLng(Xe);const ft=O.getWorldToCameraMatrix(),Ct=l.invert(new Float64Array(16),ft);We=l.Aabb.applyTransform(We,l.multiply([],ft,se)),l.transformMat4(Xe,Xe,ft);const Dt=.5*(We.max[2]-We.min[2]),Rt=this._minimumAABBFrustumDistance(O,We),Mt=l.scale$2([],[0,0,1],Dt),Wt=l.add(Mt,Xe,Mt),On=Rt+(0===O.pitch?0:l.distance(Xe,Wt)),qt=O.globeCenterInViewSpace,Tn=l.sub([],Xe,[qt[0],qt[1],qt[2]]);l.normalize(Tn,Tn),l.scale$2(Tn,Tn,On);const un=l.add([],Xe,Tn);l.transformMat4(un,un,Ct);const Fn=l.earthRadius/l.GLOBE_RADIUS,nn=l.length(un),En=l.mercatorZfromAltitude(Math.max(nn*Fn-l.earthRadius,Number.EPSILON),0),zn=Math.min(O.zoomFromMercatorZAdjusted(En),$.maxZoom);return zn>.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=zn,this._cameraForBounds(O,c,p,y,w,A)):{center:O.center,zoom:zn,bearing:y,pitch:w}}queryTerrainElevation(i,c){const p=this.transform.elevation;return p?(c=l.extend({},{exaggerated:!0},c),p.getAtPoint(l.MercatorCoordinate.fromLngLat(i),null,c.exaggerated)):null}_cameraForBounds(i,c,p,y,w,A){if("globe"===i.projection.name)return this._cameraForBoundsOnGlobe(i,c,p,y,w,A);const O=i.clone(),$=this._extendCameraOptions(A),W=O.padding;O.bearing=y,O.pitch=w;const G=l.LngLat.convert(c),ae=l.LngLat.convert(p),De=new l.LngLat(G.lng,ae.lat),ye=new l.LngLat(ae.lng,G.lat),Ee=O.project(G),be=O.project(ae),Pe=this.queryTerrainElevation(G),se=this.queryTerrainElevation(ae),Ie=this.queryTerrainElevation(De),We=this.queryTerrainElevation(ye),Xe=[[Ee.x,Ee.y,Math.min(Pe||0,se||0,Ie||0,We||0)],[be.x,be.y,Math.max(Pe||0,se||0,Ie||0,We||0)]];let ft=l.Aabb.fromPoints(Xe);const Ct=O.getWorldToCameraMatrix(),Dt=l.invert(new Float64Array(16),Ct);ft=l.Aabb.applyTransform(ft,Ct);const Rt=l.sub([],ft.max,ft.min),Mt=W.left||0,Wt=W.right||0,On=W.bottom||0,qt=W.top||0,{left:Tn,right:un,top:Fn,bottom:nn}=$.padding,En=.5*(Mt+Wt),zn=.5*(qt+On),Rn=Math.min(O.scaleZoom(O.scale*Math.min((O.width-(Mt+Wt+Tn+un))/Rt[0],(O.height-(On+qt+nn+Fn))/Rt[1])),$.maxZoom),Vn=O.scale/O.zoomScale(Rn);ft=new l.Aabb([ft.min[0]-(Tn+En)*Vn,ft.min[1]-(nn+zn)*Vn,ft.min[2]],[ft.max[0]+(un+En)*Vn,ft.max[1]+(Fn+zn)*Vn,ft.max[2]]);const Ar=.5*Rt[2],Xr=this._minimumAABBFrustumDistance(O,ft),dr=[0,0,1,0];l.transformMat4$1(dr,dr,Ct),l.normalize$2(dr,dr);const Ur=l.scale$2([],dr,Xr+Ar),gi=l.add([],ft.center,Ur),pi=("number"==typeof $.offset.x&&"number"==typeof $.offset.y?new l.Point($.offset.x,$.offset.y):l.Point.convert($.offset)).rotate(-l.degToRad(y));ft.center[0]-=pi.x*Vn,ft.center[1]+=pi.y*Vn,l.transformMat4(ft.center,ft.center,Dt),l.transformMat4(gi,gi,Dt);const br=[ft.center[0],ft.center[1],gi[2]*O.pixelsPerMeter];l.scale$2(br,br,1/O.worldSize);const Xi=l.lngFromMercatorX(br[0]),_i=l.latFromMercatorY(br[1]),fo=Math.min(O._zoomFromMercatorZ(br[2]),$.maxZoom),lo=new l.LngLat(Xi,_i);return O.mercatorFromTransition&&fo<.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=fo,this._cameraForBounds(O,c,p,y,w,A)):{center:lo,zoom:fo,bearing:y,pitch:w}}fitBounds(i,c,p){const y=this.cameraForBounds(i,c);return this._fitInternal(y,c,p)}fitScreenCoordinates(i,c,p,y,w){const A=l.Point.convert(i),O=l.Point.convert(c),$=new l.Point(Math.min(A.x,O.x),Math.min(A.y,O.y)),W=new l.Point(Math.max(A.x,O.x),Math.max(A.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(A,O))return this;const G=this.transform.pointLocation3D($),ae=this.transform.pointLocation3D(W),De=this.transform.pointLocation3D(new l.Point($.x,W.y)),ye=this.transform.pointLocation3D(new l.Point(W.x,$.y)),Ee=[Math.min(G.lng,ae.lng,De.lng,ye.lng),Math.min(G.lat,ae.lat,De.lat,ye.lat)],be=[Math.max(G.lng,ae.lng,De.lng,ye.lng),Math.max(G.lat,ae.lat,De.lat,ye.lat)],Pe=y&&y.pitch?y.pitch:this.getPitch(),se=this._cameraForBounds(this.transform,Ee,be,p,Pe,y);return this._fitInternal(se,y,w)}_fitInternal(i,c,p){return i?(delete(c=l.extend(i,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(i,c){this.stop();const p=i.preloadOnly?this.transform.clone():this.transform;let y=!1,w=!1,A=!1;return"zoom"in i&&p.zoom!==+i.zoom&&(y=!0,p.zoom=+i.zoom),void 0!==i.center&&(p.center=l.LngLat.convert(i.center)),"bearing"in i&&p.bearing!==+i.bearing&&(w=!0,p.bearing=+i.bearing),"pitch"in i&&p.pitch!==+i.pitch&&(A=!0,p.pitch=+i.pitch),null==i.padding||p.isPaddingEqual(i.padding)||(p.padding=i.padding),i.preloadOnly?(this._preloadTiles(p),this):(this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),y&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),w&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),A&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||l.warnOnce(B),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return l.warnOnce(B),this;this.stop();const y=p.zoom,w=p.pitch,A=p.bearing;p.setFreeCameraOptions(i);const O=y!==p.zoom,$=w!==p.pitch,W=A!==p.bearing;return this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),O&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),W&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),$&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),(!1===(i=l.extend({offset:[0,0],duration:500,easing:l.ease},i)).animate||this._prefersReducedMotion(i))&&(i.duration=0);const p=this.transform,y=this.getZoom(),w=this.getBearing(),A=this.getPitch(),O=this.getPadding(),$="zoom"in i?+i.zoom:y,W="bearing"in i?this._normalizeBearing(i.bearing,w):w,G="pitch"in i?+i.pitch:A,ae="padding"in i?i.padding:p.padding,De=l.Point.convert(i.offset);let ye,Ee,be;if("globe"===p.projection.name){const Mt=l.MercatorCoordinate.fromLngLat(p.center),Wt=De.rotate(-p.angle);Mt.x+=Wt.x/p.worldSize,Mt.y+=Wt.y/p.worldSize;const On=Mt.toLngLat(),qt=l.LngLat.convert(i.center||On);this._normalizeCenter(qt),ye=p.centerPoint.add(Wt),Ee=new l.Point(Mt.x,Mt.y).mult(p.worldSize),be=new l.Point(l.mercatorXfromLng(qt.lng),l.mercatorYfromLat(qt.lat)).mult(p.worldSize).sub(Ee)}else{ye=p.centerPoint.add(De);const Mt=p.pointLocation(ye),Wt=l.LngLat.convert(i.center||Mt);this._normalizeCenter(Wt),Ee=p.project(Mt),be=p.project(Wt).sub(Ee)}const Pe=p.zoomScale($-y);let se,Ie;i.around&&(se=l.LngLat.convert(i.around),Ie=p.locationPoint(se));const We=this._zooming||$!==y,Xe=this._rotating||w!==W,ft=this._pitching||G!==A,Ct=!p.isPaddingEqual(ae),Dt=Mt=>Wt=>{if(We&&(Mt.zoom=l.number(y,$,Wt)),Xe&&(Mt.bearing=l.number(w,W,Wt)),ft&&(Mt.pitch=l.number(A,G,Wt)),Ct&&(Mt.interpolatePadding(O,ae,Wt),ye=Mt.centerPoint.add(De)),se)Mt.setLocationAtPoint(se,Ie);else{const On=Mt.zoomScale(Mt.zoom-y),qt=$>y?Math.min(2,Pe):Math.max(.5,Pe),Tn=Math.pow(qt,1-Wt),un=Mt.unproject(Ee.add(be.mult(Wt*Tn)).mult(On));Mt.setLocationAtPoint(Mt.renderWorldCopies?un.wrap():un,ye)}return i.preloadOnly||this._fireMoveEvents(c),Mt};if(i.preloadOnly){const Mt=this._emulate(Dt,i.duration,p);return this._preloadTiles(Mt),this}const Rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=We,this._rotating=Xe,this._pitching=ft,this._padding=Ct,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,Rt),this._ease(Dt(p),Mt=>{p.recenterOnTerrain(),this._afterEase(c,Mt)},i),this}_prepareEase(i,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new l.Event("movestart",i)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new l.Event("move",i)),this._zooming&&this.fire(new l.Event("zoom",i)),this._rotating&&this.fire(new l.Event("rotate",i)),this._pitching&&this.fire(new l.Event("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",i)),y&&this.fire(new l.Event("rotateend",i)),w&&this.fire(new l.Event("pitchend",i)),this.fire(new l.Event("moveend",i))}flyTo(i,c){if(this._prefersReducedMotion(i)){const Rn=l.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Rn,c)}this.stop(),i=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},i);const p=this.transform,y=this.getZoom(),w=this.getBearing(),A=this.getPitch(),O=this.getPadding(),$="zoom"in i?l.clamp(+i.zoom,p.minZoom,p.maxZoom):y,W="bearing"in i?this._normalizeBearing(i.bearing,w):w,G="pitch"in i?+i.pitch:A,ae="padding"in i?i.padding:p.padding,De=p.zoomScale($-y),ye=l.Point.convert(i.offset);let Ee=p.centerPoint.add(ye);const be=p.pointLocation(Ee),Pe=l.LngLat.convert(i.center||be);this._normalizeCenter(Pe);const se=p.project(be),Ie=p.project(Pe).sub(se);let We=i.curve;const Xe=Math.max(p.width,p.height),ft=Xe/De,Ct=Ie.mag();if("minZoom"in i){const Rn=l.clamp(Math.min(i.minZoom,y,$),p.minZoom,p.maxZoom),Vn=Xe/p.zoomScale(Rn-y);We=Math.sqrt(Vn/Ct*2)}const Dt=We*We;function Rt(Rn){const Vn=(ft*ft-Xe*Xe+(Rn?-1:1)*Dt*Dt*Ct*Ct)/(2*(Rn?ft:Xe)*Dt*Ct);return Math.log(Math.sqrt(Vn*Vn+1)-Vn)}function Mt(Rn){return(Math.exp(Rn)-Math.exp(-Rn))/2}function Wt(Rn){return(Math.exp(Rn)+Math.exp(-Rn))/2}const On=Rt(0);let qt=function(Rn){return Wt(On)/Wt(On+We*Rn)},Tn=function(Rn){return Xe*((Wt(On)*(Mt(Vn=On+We*Rn)/Wt(Vn))-Mt(On))/Dt)/Ct;var Vn},un=(Rt(1)-On)/We;if(Math.abs(Ct)<1e-6||!isFinite(un)){if(Math.abs(Xe-ft)<1e-6)return this.easeTo(i,c);const Rn=ft<Xe?-1:1;un=Math.abs(Math.log(ft/Xe))/We,Tn=function(){return 0},qt=function(Vn){return Math.exp(Rn*We*Vn)}}i.duration="duration"in i?+i.duration:1e3*un/("screenSpeed"in i?+i.screenSpeed/We:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Fn=w!==W,nn=G!==A,En=!p.isPaddingEqual(ae),zn=Rn=>Vn=>{const Ar=Vn*un,Xr=1/qt(Ar);Rn.zoom=1===Vn?$:y+Rn.scaleZoom(Xr),Fn&&(Rn.bearing=l.number(w,W,Vn)),nn&&(Rn.pitch=l.number(A,G,Vn)),En&&(Rn.interpolatePadding(O,ae,Vn),Ee=Rn.centerPoint.add(ye));const dr=1===Vn?Pe:Rn.unproject(se.add(Ie.mult(Tn(Ar))).mult(Xr));return Rn.setLocationAtPoint(Rn.renderWorldCopies?dr.wrap():dr,Ee),Rn._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(c),Rn};if(i.preloadOnly){const Rn=this._emulate(zn,i.duration,p);return this._preloadTiles(Rn),this}return this._zooming=!0,this._rotating=Fn,this._pitching=nn,this._padding=En,this._prepareEase(c,!1),this._ease(zn(p),()=>this._afterEase(c),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!i){const p=this.handlers;p&&p.stop(!1)}return this}_ease(i,c,p){!1===p.animate||0===p.duration?(i(1),c()):(this._easeStart=l.exported.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=l.wrap(i,-180,180);const p=Math.abs(i-c);return Math.abs(i-360-c)<p&&(i-=360),Math.abs(i+360-c)<p&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=i.lng-c.center.lng;i.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(i){return this._respectPrefersReducedMotion&&l.exported.prefersReducedMotion&&!(i&&i.essential)}_emulate(i,c,p){const y=Math.ceil(15*c/1e3),w=[],A=i(p.clone());for(let O=0;O<=y;O++){const $=A(O/y);w.push($.clone())}return w}}class _{constructor(i={}){this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact;return this._map=i,this._container=et("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=et("button","mapboxgl-ctrl-attrib-button",this._container),et("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=et("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,c){const p=this._map._getUIString(`AttributionControl.${c}`);i.setAttribute("aria-label",p),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){const p=c.reduce((y,w,A)=>(w.value&&(y+=`${w.key}=${w.value}${A<c.length-1?"&":""}`),y),"?");i.href=`${l.config.FEEDBACK_URL}/${p}#${Cs(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const c=this._map.style._sourceCaches;for(const y in c){const w=c[y];if(w.used){const A=w.getSource();A.attribution&&i.indexOf(A.attribution)<0&&i.push(A.attribution)}}i.sort((y,w)=>y.length-w.length),i=i.filter((y,w)=>{for(let A=w+1;A<i.length;A++)if(i[A].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class E{constructor(){l.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=et("div","mapboxgl-ctrl");const c=et("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const c in i){const p=i[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class M{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const y of p)if(y.id===i)return void(y.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function q(h,i,c){if(h=new l.LngLat(h.lng,h.lat),i){const p=new l.LngLat(h.lng-360,h.lat),y=new l.LngLat(h.lng+360,h.lat),w=360*Math.ceil(Math.abs(h.lng-c.center.lng)/360),A=c.locationPoint(h).distSqr(i),O=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint(p).distSqr(i)<A&&(O||Math.abs(p.lng-c.center.lng)<w)?h=p:c.locationPoint(y).distSqr(i)<A&&(O||Math.abs(y.lng-c.center.lng)<w)&&(h=y)}for(;Math.abs(h.lng-c.center.lng)>180;){const p=c.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;h.lng>c.center.lng?h.lng-=360:h.lng+=360}return h}const oe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ge extends l.Evented{constructor(i,c){if(super(),(i instanceof l.window.HTMLElement||c)&&(i=l.extend({element:i},c)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=l.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=et("div");const y=41,w=27,A=xe("svg",{display:"block",height:y*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${y}`},this._element),O=xe("radialGradient",{id:"shadowGradient"},xe("defs",{},A));xe("stop",{offset:"10%","stop-opacity":.4},O),xe("stop",{offset:"100%","stop-opacity":.05},O),xe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},A),xe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},A),xe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},A),xe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},A),this._offset=l.Point.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const p=this._element.classList;for(const y in oe)p.remove(`mapboxgl-marker-anchor-${y}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(24.6+y)],"bottom-right":[-y,-1*(24.6+y)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,p=i.charCode||i.keyCode;"Space"!==c&&"Enter"!==c&&32!==p&&13!==p||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,c=this._pos;if(!i||!c)return!1;const p=i.unproject(c),y=i.getFreeCameraOptions();if(!y.position)return!1;const w=y.position.toLngLat();return w.distanceTo(p)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const c=this._pos;if(!c||c.x<0||c.x>i.transform.width||c.y<0||c.y>i.transform.height)return void this._clearFadeTimer();const p=i.unproject(c);let y;i._showingGlobe()&&l.isLngLatBehindGlobe(i.transform,this._lngLat)?y=0:(y=1-i._queryFogOpacity(p),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${oe[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const i=this._pos,c=this._map,p=this.getPitchAlignment();if(!c||!i||"map"!==p)return"";if(!c._showingGlobe()){const $=c.getPitch();return $?`rotateX(${$}deg)`:""}const y=l.radToDeg(l.globeTiltAtLngLat(c.transform,this._lngLat)),w=i.sub(l.globeCenterToScreenPoint(c.transform)),A=Math.abs(w.x)+Math.abs(w.y);if(0===A)return"";const O=y/A;return`rotateX(${-w.y*O}deg) rotateY(${w.x*O}deg)`}_calculateZTransform(){const i=this._pos,c=this._map;if(!c||!i)return"";let p=0;const y=this.getRotationAlignment();if("map"===y)if(c._showingGlobe()){const w=c.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),A=c.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);p=l.radToDeg(Math.atan2(A.y,A.x))-90}else p=-c.getBearing();else if("horizon"===y){const w=l.smoothstep(4,6,c.getZoom()),A=l.globeCenterToScreenPoint(c.transform);A.y+=w*c.transform.height;const O=i.sub(A),$=l.radToDeg(Math.atan2(O.y,O.x));p=($>90?$-270:$+90)*(1-w)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(i){l.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=q(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===i?this._updateFrameId=l.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=l.Point.convert(i),this._update(),this}_onMove(i){const c=this._map;if(!c)return;const p=this._pointerdownPos,y=this._positionDelta;if(p&&y){if(!this._isDragging){const w=this._clickTolerance||c._clickTolerance;if(i.point.dist(p)<w)return;this._isDragging=!0}this._pos=i.point.sub(y),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(i){const c=this._map,p=this._pos;c&&p&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(p),this._pointerdownPos=i.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const c=this._map;return c&&(i?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Oe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Pt=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Jt(h=new l.Point(0,0),i="bottom"){if("number"==typeof h){const c=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(i){case"top":return new l.Point(0,h);case"top-left":return new l.Point(c,c);case"top-right":return new l.Point(-c,c);case"bottom":return new l.Point(0,-h);case"bottom-left":return new l.Point(c,-c);case"bottom-right":return new l.Point(-c,-c);case"left":return new l.Point(h,0);case"right":return new l.Point(-h,0)}return new l.Point(0,0)}return h instanceof l.Point||Array.isArray(h)?l.Point.convert(h):l.Point.convert(h[i]||[0,0])}class sr{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=l.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,p){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+p}}const Qn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Vr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Hr={showCompass:!0,showZoom:!0,visualizePitch:!1};class Nr{constructor(i,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new El({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,p&&(this.mousePitch=new ds({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),lt()}move(i,c){const p=this.map,y=this.mouseRotate.mousemoveWindow(i,c),w=y&&y.bearingDelta;if(w&&p.setBearing(p.getBearing()+w),this.mousePitch){const A=this.mousePitch.mousemoveWindow(i,c),O=A&&A.pitchDelta;O&&p.setPitch(p.getPitch()+O)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){pt(),l.window.removeEventListener("mousemove",this.mousemove),l.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),nt(this.element,i)),l.window.addEventListener("mousemove",this.mousemove),l.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,nt(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=Bt(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=Bt(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const zr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ti={maxWidth:100,unit:"metric"},ai={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},zi={version:l.version,supported:Ue,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends D{constructor(h){if(l.LivePerformanceUtils.mark(l.PerformanceMarkers.create),null!=(h=l.extend({},Vr,h)).minZoom&&null!=h.maxZoom&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=h.minPitch&&null!=h.maxPitch&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=h.minPitch&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=h.maxPitch&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&l.isSafariWithAntialiasingBug(l.window)&&(h.antialias=!1,l.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ta(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._useWebGL2=h.useWebGL2,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new M,this._domRenderTaskQueue=new M,this._controls=[],this._markers=[],this._popups=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Qn,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new sr(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new l.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,"string"==typeof h.container){if(this._container=l.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof l.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&l.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new H(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new _s("string"==typeof h.hash&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,l.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new _({customAttribution:h.customAttribution})),this._logoControl=new E,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new l.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new l.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(h,i){if(void 0===i&&(i=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[i];return-1!==i.indexOf("bottom")?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(h);return i>-1&&this._controls.splice(i,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new l.Event("movestart",h)).fire(new l.Event("move",h)),this.fire(new l.Event("resize",h)),i&&this.fire(new l.Event("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(l.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return"auto"===h?l.window.navigator.language:Array.isArray(h)?0===h.length?void 0:h.map(i=>"auto"===i?l.window.navigator.language:i):h}setLanguage(h){const i=this._parseLanguage(h);if(!this.style||i===this._language)return this;this._language=i,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(h){return this._lazyInitEmptyStyle(),h?"string"==typeof h&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const h=this.transform,i=h.projection.name;let c;"globe"===i&&h.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),c=!0):"mercator"===i&&h.zoom<l.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,i){return this._updateProjection(h||i||{name:"mercator"})}_updateProjection(h){let i;if(i="globe"===h.name&&this.transform.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(h){return this.transform.locationPoint3D(l.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(l.Point.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,i,c){if("mouseenter"===h||"mouseover"===h){let p=!1;const y=A=>{const O=i.filter(W=>this.getLayer(W)),$=O.length?this.queryRenderedFeatures(A.point,{layers:O}):[];$.length?p||(p=!0,c.call(this,new ys(h,this,A.originalEvent,{features:$}))):p=!1},w=()=>{p=!1};return{layers:new Set(i),listener:c,delegates:{mousemove:y,mouseout:w}}}if("mouseleave"===h||"mouseout"===h){let p=!1;const y=A=>{const O=i.filter($=>this.getLayer($));(O.length?this.queryRenderedFeatures(A.point,{layers:O}):[]).length?p=!0:p&&(p=!1,c.call(this,new ys(h,this,A.originalEvent)))},w=A=>{p&&(p=!1,c.call(this,new ys(h,this,A.originalEvent)))};return{layers:new Set(i),listener:c,delegates:{mousemove:y,mouseout:w}}}{const p=y=>{const w=i.filter(O=>this.getLayer(O)),A=w.length?this.queryRenderedFeatures(y.point,{layers:w}):[];A.length&&(y.features=A,c.call(this,y),delete y.features)};return{layers:new Set(i),listener:c,delegates:{[h]:p}}}}on(h,i,c){if(void 0===c)return super.on(h,i);Array.isArray(i)||(i=[i]);const p=this._createDelegatedListener(h,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(h,i,c){if(void 0===c)return super.once(h,i);Array.isArray(i)||(i=[i]);const p=this._createDelegatedListener(h,i,c);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(h,i,c){if(void 0===c)return super.off(h,i);i=new Set(Array.isArray(i)?i:[i]);const p=(w,A)=>{if(w.size!==A.size)return!1;for(const O of w)if(!A.has(O))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[h]:void 0;return y&&(w=>{for(let A=0;A<w.length;A++){const O=w[A];if(O.listener===c&&p(O.layers,i)){for(const $ in O.delegates)this.off($,O.delegates[$]);return w.splice(A,1),this}}})(y),this}queryRenderedFeatures(h,i){return this.style?(void 0!==i||void 0===h||h instanceof l.Point||Array.isArray(h)||(i=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(h,i){return this.style.querySourceFeatures(h,i)}isPointOnSurface(h){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&l.warnOnce(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(l.Point.convert(h))}setStyle(h,i){return!1!==(i=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(h,i))}_getUIString(h){const i=this._locale[h];if(null==i)throw new Error(`Missing UI string '${h}'`);return i}_updateStyle(h,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new Mr(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof h?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,i){if("string"==typeof h){const c=this._requestManager.normalizeStyleURL(h),p=this._requestManager.transformRequest(c,l.ResourceType.Style);l.getJSON(p,(y,w)=>{y?this.fire(new l.ErrorEvent(y)):w&&this._updateDiff(w,i)})}else"object"==typeof h&&this._updateDiff(h,i)}_updateDiff(h,i){try{this.style.setState(h)&&this._update(!0)}catch(c){l.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(h,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(l.warnOnce("There is no style added to the map."),!1)}addSource(h,i){return this._lazyInitEmptyStyle(),this.style.addSource(h,i),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const i in h){const c=h[i]._tiles;for(const p in c){const y=c[p];if("loaded"!==y.state&&"errored"!==y.state)return!1}}return!0}addSourceType(h,i,c){this._lazyInitEmptyStyle(),this.style.addSourceType(h,i,c)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,i,{pixelRatio:c=1,sdf:p=!1,stretchX:y,stretchY:w,content:A}={}){if(this._lazyInitEmptyStyle(),i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap){const{width:O,height:$,data:W}=l.exported.getImageData(i);this.style.addImage(h,{data:new l.RGBAImage({width:O,height:$},W),pixelRatio:c,stretchX:y,stretchY:w,content:A,sdf:p,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:$}=i,W=i;this.style.addImage(h,{data:new l.RGBAImage({width:O,height:$},new Uint8Array(W.data)),pixelRatio:c,stretchX:y,stretchY:w,content:A,sdf:p,version:0,userImage:W}),W.onAdd&&W.onAdd(this,h)}}updateImage(h,i){const c=this.style.getImage(h);if(!c)return void this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap?l.exported.getImageData(i):i,{width:y,height:w}=p;void 0!==y&&void 0!==w?y===c.data.width&&w===c.data.height?(c.data.replace(p.data,!(i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap)),this.style.updateImage(h,c)):this.fire(new l.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${w})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,i){l.getImage(this._requestManager.transformRequest(h,l.ResourceType.Image),(c,p)=>{i(c,p instanceof l.window.HTMLImageElement?l.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(h,i){return this._lazyInitEmptyStyle(),this.style.addLayer(h,i),this._update(!0)}moveLayer(h,i){return this.style.moveLayer(h,i),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,i,c){return this.style.setLayerZoomRange(h,i,c),this._update(!0)}setFilter(h,i,c={}){return this.style.setFilter(h,i,c),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,i,c,p={}){return this.style.setPaintProperty(h,i,c,p),this._update(!0)}getPaintProperty(h,i){return this.style.getPaintProperty(h,i)}setLayoutProperty(h,i,c,p={}){return this.style.setLayoutProperty(h,i,c,p),this._update(!0)}getLayoutProperty(h,i){return this.style.getLayoutProperty(h,i)}setLight(h,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(h),this.transform):0}setFeatureState(h,i){return this.style.setFeatureState(h,i),this._update()}removeFeatureState(h,i){return this.style.removeFeatureState(h,i),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,p,y,w=this._container;for(;w&&(!p||!y);){const A=l.window.getComputedStyle(w).transform;A&&"none"!==A&&(c=A.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(p=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(y=c[3])),w=w.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=y?Math.abs(i/y):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=et("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=et("div","mapboxgl-canvas-container",h);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=et("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=et("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=et("div",`mapboxgl-ctrl-${y}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,i){const c=l.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(h),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${i}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const i=this._markers.indexOf(h);-1!==i&&this._markers.splice(i,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const i=this._popups.indexOf(h);-1!==i&&this._popups.splice(i,1)}_setupPainter(){const h=l.extend({},Ue.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._useWebGL2&&this._canvas.getContext("webgl2",h),c=i||this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);c?(this._useWebGL2&&!i&&l.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),l.storeAuthState(c,!0),this.painter=new Fe(c,this.transform,!!i),this.on("data",p=>{"source"===p.dataType&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(c)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let i;const c=this.painter.context.extTimerQuery,p=l.exported.now();if(this.listens("gpu-timing-frame")&&(i=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],l.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],l.window.performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,$=this.transform.pitch,W=l.exported.now(),G=new l.EvaluationParameters(O,{now:W,fadeDuration:y,pitch:$,transition:this.style.getTransition()});this.style.update(G)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const O=l.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,i),setTimeout(()=>{const $=c.getQueryObjectEXT(i,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(i),this.fire(new l.Event("gpu-timing-frame",{cpuTime:O,gpuTime:$})),l.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:$}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const $=this.painter.queryGpuTimers(O);this.fire(new l.Event("gpu-timing-layer",{layerTimes:$}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const $=this.painter.queryGpuTimeDeferredRender(O);this.fire(new l.Event("gpu-timing-deferred-render",{gpuTime:$}))},50)}const A=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(A||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(w=this._updateAverageElevation(p,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const $=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:$})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,l.LivePerformanceUtils.mark(l.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&l.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const i of this._markers)h&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!h||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(h,i=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((i||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const p=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),w=!1;this.transform.elevation&&(w=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=h;const A=Math.abs(p-y);if(A>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(y),c(y);this._averageElevation.easeTo(y,h,300)}else if(A>1e-4)return this._averageElevation.jumpTo(y),c(y)}return!!this._averageElevation.isEasing(h)&&c(this._averageElevation.getValue(h))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===l.AUTH_ERR_MSG||401===h.status)){const i=this.painter.context.gl;l.storeAuthState(i,!1),this._logoControl instanceof E&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function y(w){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,w,0);const A=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,A),A}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(y(h),i.canvasCopies.map(y),i.timeStamps)}_canvasPixelComparison(h,i,c){let p=c[1]-c[0];const y=h.length/4;for(let w=0;w<i.length;w++){const A=i[w];let O=0;for(let $=0;$<A.length;$+=4)A[$]===h[$]&&A[$+1]===h[$+1]&&A[$+2]===h[$+2]&&A[$+3]===h[$+3]&&(O+=1);p+=(c[w+2]-c[w+1])*(1-O/y)}return p}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1),l.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=l.exported.frame(i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)}))}_preloadTiles(h){const i=this.style?Object.values(this.style._sourceCaches):[];return l.asyncAll(i,(c,p)=>c._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){"hidden"===l.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,h&&this._update())}_setCacheLimits(h,i){l.setCacheLimits(h,i)}get version(){return l.version}},NavigationControl:class{constructor(h){this.options=l.extend({},Hr,h),this._container=et("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),et("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),et("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:i}):c.resetNorth({},{originalEvent:i}))}),this._compassIcon=et("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const i=h.getZoom(),c=i===h.getMaxZoom(),p=i===h.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nr(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,i){const c=et("button",h,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(h,i){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${i}`);h.setAttribute("aria-label",c),h.firstElementChild&&h.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends l.Evented{constructor(h){super(),this.options=l.extend({geolocation:l.window.navigator.geolocation},zr,h),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Yi(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=et("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const i=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,h(c)};void 0!==this._supportsGeolocation?h(this._supportsGeolocation):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(c=>i("denied"!==c.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(h){const i=this._map.getMaxBounds(),c=h.coords;return!!i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",h)),this._finish()}}_updateCamera(h){const i=new l.LngLat(h.coords.longitude,h.coords.latitude),c=h.coords.accuracy,p=this._map.getBearing(),y=l.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),y,{geolocateSource:!0})}_updateMarker(h){if(h){const i=new l.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,i=l.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,c=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=et("button","mapboxgl-ctrl-geolocate",this._container),et("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===h){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=et("div","mapboxgl-user-location"),this._dotElement.appendChild(et("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(et("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ge({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=et("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ge({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:!0===h.absolute&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==l.window.DeviceMotionEvent&&"function"==typeof l.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientation),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:_,ScaleControl:class{constructor(h){this.options=l.extend({},ti,h),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),l.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,i=this._map,c=i._containerHeight/2,p=i._containerWidth/2-h/2,y=i.unproject([p,c]),w=i.unproject([p+h,c]),A=y.distanceTo(w);if("imperial"===this.options.unit){const O=3.2808*A;O>5280?this._setScale(h,O/5280,"mile"):this._setScale(h,O,"foot")}else"nautical"===this.options.unit?this._setScale(h,A/1852,"nautical-mile"):A>=1e3?this._setScale(h,A/1e3,"kilometer"):this._setScale(h,A,"meter")}_setScale(h,i,c){this._map._requestDomTask(()=>{const p=function(w){const A=Math.pow(10,`${Math.floor(w)}`.length-1);let O=w/A;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function($){const W=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*W)/W}(O),A*O}(i),y=p/i;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(p):`${p}&nbsp;${ai[c]}`,this._container.style.width=h*y+"px"})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=et("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof l.window.HTMLElement?this._container=h.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=et("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=et("button","mapboxgl-ctrl-fullscreen",this._controlContainer);et("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(h){super(),this.options=l.extend(Object.create(Oe),h),l.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=l.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(l.window.document.createTextNode(h))}setHTML(h){const i=l.window.document.createDocumentFragment(),c=l.window.document.createElement("body");let p;for(c.innerHTML=h;p=c.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=et("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(h),this.options.closeButton){const c=this._closeButton=et("button","mapboxgl-popup-close-button",i);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let i;return this._classList.delete(h)?i=!1:(this._classList.add(h),i=!0),this._updateClassList(),i}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const i=this._map,c=this._container,p=this._pos;if(!i||!c||!p)return"bottom";const y=c.offsetWidth,w=c.offsetHeight,A=p.x<y/2,O=p.x>i.transform.width-y/2;if(p.y+h<w)return A?"top-left":O?"top-right":"top";if(p.y>i.transform.height-w){if(A)return"bottom-left";if(O)return"bottom-right"}return A?"left":O?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),h.className=i.join(" ")}_update(h){const i=this._map,c=this._content;if(!i||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=et("div","mapboxgl-popup",i.getContainer()),this._tip=et("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=q(this._lngLat,this._pos,i.transform)),!this._trackPointer||h){const y=this._pos=this._trackPointer&&h?h:i.project(this._lngLat),w=Jt(this.options.offset),A=this._anchor=this._getAnchor(w.y),O=Jt(this.options.offset,A),$=y.add(O).round();i._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${oe[A]} translate(${$.x}px,${$.y}px)`)})}if(!this._marker&&i._showingGlobe()){const y=l.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(Pt);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:ge,Style:Mr,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:xi,Evented:l.Evented,config:l.config,prewarm:function(){ro().acquire(vr)},clearPrewarmedResources:function(){const h=ni;h&&(h.isPreloaded()&&1===h.numActive()?(h.release(vr),ni=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(h){l.config.ACCESS_TOKEN=h},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(h){l.config.API_URL=h},get workerCount(){return Wr.workerCount},set workerCount(h){Wr.workerCount=h},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){l.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){l.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return zi}),I}()},5619:(Gn,At,K)=>{"use strict";K.d(At,{X:()=>b});var I=K(8645);class b extends I.x{constructor(l){super(),this._value=l}get value(){return this.getValue()}_subscribe(l){const ve=super._subscribe(l);return!ve.closed&&l.next(this._value),ve}getValue(){const{hasError:l,thrownError:ve,_value:Ue}=this;if(l)throw ve;return this._throwIfClosed(),Ue}next(l){super.next(this._value=l)}}},5592:(Gn,At,K)=>{"use strict";K.d(At,{y:()=>it});var I=K(305),b=K(7394),dt=K(4850),l=K(8407),ve=K(2653),Ue=K(4674),Le=K(1441);let it=(()=>{class Ze{constructor(lt){lt&&(this._subscribe=lt)}lift(lt){const pt=new Ze;return pt.source=this,pt.operator=lt,pt}subscribe(lt,pt,vt){const _t=function Re(Ze){return Ze&&Ze instanceof I.Lv||function xe(Ze){return Ze&&(0,Ue.m)(Ze.next)&&(0,Ue.m)(Ze.error)&&(0,Ue.m)(Ze.complete)}(Ze)&&(0,b.Nn)(Ze)}(lt)?lt:new I.Hp(lt,pt,vt);return(0,Le.x)(()=>{const{operator:nt,source:Bt}=this;_t.add(nt?nt.call(_t,Bt):Bt?this._subscribe(_t):this._trySubscribe(_t))}),_t}_trySubscribe(lt){try{return this._subscribe(lt)}catch(pt){lt.error(pt)}}forEach(lt,pt){return new(pt=et(pt))((vt,_t)=>{const nt=new I.Hp({next:Bt=>{try{lt(Bt)}catch(Ft){_t(Ft),nt.unsubscribe()}},error:_t,complete:vt});this.subscribe(nt)})}_subscribe(lt){var pt;return null===(pt=this.source)||void 0===pt?void 0:pt.subscribe(lt)}[dt.L](){return this}pipe(...lt){return(0,l.U)(lt)(this)}toPromise(lt){return new(lt=et(lt))((pt,vt)=>{let _t;this.subscribe(nt=>_t=nt,nt=>vt(nt),()=>pt(_t))})}}return Ze.create=tt=>new Ze(tt),Ze})();function et(Ze){var tt;return null!==(tt=Ze??ve.config.Promise)&&void 0!==tt?tt:Promise}},8645:(Gn,At,K)=>{"use strict";K.d(At,{x:()=>Le});var I=K(5592),b=K(7394);const l=(0,K(2306).d)(et=>function(){et(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ve=K(9039),Ue=K(1441);let Le=(()=>{class et extends I.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Re){const Ze=new it(this,this);return Ze.operator=Re,Ze}_throwIfClosed(){if(this.closed)throw new l}next(Re){(0,Ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Ze of this.currentObservers)Ze.next(Re)}})}error(Re){(0,Ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Re;const{observers:Ze}=this;for(;Ze.length;)Ze.shift().error(Re)}})}complete(){(0,Ue.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Re}=this;for(;Re.length;)Re.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Re;return(null===(Re=this.observers)||void 0===Re?void 0:Re.length)>0}_trySubscribe(Re){return this._throwIfClosed(),super._trySubscribe(Re)}_subscribe(Re){return this._throwIfClosed(),this._checkFinalizedStatuses(Re),this._innerSubscribe(Re)}_innerSubscribe(Re){const{hasError:Ze,isStopped:tt,observers:lt}=this;return Ze||tt?b.Lc:(this.currentObservers=null,lt.push(Re),new b.w0(()=>{this.currentObservers=null,(0,ve.P)(lt,Re)}))}_checkFinalizedStatuses(Re){const{hasError:Ze,thrownError:tt,isStopped:lt}=this;Ze?Re.error(tt):lt&&Re.complete()}asObservable(){const Re=new I.y;return Re.source=this,Re}}return et.create=(xe,Re)=>new it(xe,Re),et})();class it extends Le{constructor(xe,Re){super(),this.destination=xe,this.source=Re}next(xe){var Re,Ze;null===(Ze=null===(Re=this.destination)||void 0===Re?void 0:Re.next)||void 0===Ze||Ze.call(Re,xe)}error(xe){var Re,Ze;null===(Ze=null===(Re=this.destination)||void 0===Re?void 0:Re.error)||void 0===Ze||Ze.call(Re,xe)}complete(){var xe,Re;null===(Re=null===(xe=this.destination)||void 0===xe?void 0:xe.complete)||void 0===Re||Re.call(xe)}_subscribe(xe){var Re,Ze;return null!==(Ze=null===(Re=this.source)||void 0===Re?void 0:Re.subscribe(xe))&&void 0!==Ze?Ze:b.Lc}}},305:(Gn,At,K)=>{"use strict";K.d(At,{Hp:()=>vt,Lv:()=>Ze});var I=K(4674),b=K(7394),dt=K(2653),l=K(3894),ve=K(2420);const Ue=et("C",void 0,void 0);function et(Se,Me,ht){return{kind:Se,value:Me,error:ht}}var xe=K(7599),Re=K(1441);class Ze extends b.w0{constructor(Me){super(),this.isStopped=!1,Me?(this.destination=Me,(0,b.Nn)(Me)&&Me.add(this)):this.destination=Ft}static create(Me,ht,It){return new vt(Me,ht,It)}next(Me){this.isStopped?Bt(function it(Se){return et("N",Se,void 0)}(Me),this):this._next(Me)}error(Me){this.isStopped?Bt(function Le(Se){return et("E",void 0,Se)}(Me),this):(this.isStopped=!0,this._error(Me))}complete(){this.isStopped?Bt(Ue,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Me){this.destination.next(Me)}_error(Me){try{this.destination.error(Me)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const tt=Function.prototype.bind;function lt(Se,Me){return tt.call(Se,Me)}class pt{constructor(Me){this.partialObserver=Me}next(Me){const{partialObserver:ht}=this;if(ht.next)try{ht.next(Me)}catch(It){_t(It)}}error(Me){const{partialObserver:ht}=this;if(ht.error)try{ht.error(Me)}catch(It){_t(It)}else _t(Me)}complete(){const{partialObserver:Me}=this;if(Me.complete)try{Me.complete()}catch(ht){_t(ht)}}}class vt extends Ze{constructor(Me,ht,It){let Je;if(super(),(0,I.m)(Me)||!Me)Je={next:Me??void 0,error:ht??void 0,complete:It??void 0};else{let mt;this&&dt.config.useDeprecatedNextContext?(mt=Object.create(Me),mt.unsubscribe=()=>this.unsubscribe(),Je={next:Me.next&&lt(Me.next,mt),error:Me.error&&lt(Me.error,mt),complete:Me.complete&&lt(Me.complete,mt)}):Je=Me}this.destination=new pt(Je)}}function _t(Se){dt.config.useDeprecatedSynchronousErrorHandling?(0,Re.O)(Se):(0,l.h)(Se)}function Bt(Se,Me){const{onStoppedNotification:ht}=dt.config;ht&&xe.z.setTimeout(()=>ht(Se,Me))}const Ft={closed:!0,next:ve.Z,error:function nt(Se){throw Se},complete:ve.Z}},7394:(Gn,At,K)=>{"use strict";K.d(At,{Lc:()=>Ue,w0:()=>ve,Nn:()=>Le});var I=K(4674);const dt=(0,K(2306).d)(et=>function(Re){et(this),this.message=Re?`${Re.length} errors occurred during unsubscription:\n${Re.map((Ze,tt)=>`${tt+1}) ${Ze.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Re});var l=K(9039);class ve{constructor(xe){this.initialTeardown=xe,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let xe;if(!this.closed){this.closed=!0;const{_parentage:Re}=this;if(Re)if(this._parentage=null,Array.isArray(Re))for(const lt of Re)lt.remove(this);else Re.remove(this);const{initialTeardown:Ze}=this;if((0,I.m)(Ze))try{Ze()}catch(lt){xe=lt instanceof dt?lt.errors:[lt]}const{_finalizers:tt}=this;if(tt){this._finalizers=null;for(const lt of tt)try{it(lt)}catch(pt){xe=xe??[],pt instanceof dt?xe=[...xe,...pt.errors]:xe.push(pt)}}if(xe)throw new dt(xe)}}add(xe){var Re;if(xe&&xe!==this)if(this.closed)it(xe);else{if(xe instanceof ve){if(xe.closed||xe._hasParent(this))return;xe._addParent(this)}(this._finalizers=null!==(Re=this._finalizers)&&void 0!==Re?Re:[]).push(xe)}}_hasParent(xe){const{_parentage:Re}=this;return Re===xe||Array.isArray(Re)&&Re.includes(xe)}_addParent(xe){const{_parentage:Re}=this;this._parentage=Array.isArray(Re)?(Re.push(xe),Re):Re?[Re,xe]:xe}_removeParent(xe){const{_parentage:Re}=this;Re===xe?this._parentage=null:Array.isArray(Re)&&(0,l.P)(Re,xe)}remove(xe){const{_finalizers:Re}=this;Re&&(0,l.P)(Re,xe),xe instanceof ve&&xe._removeParent(this)}}ve.EMPTY=(()=>{const et=new ve;return et.closed=!0,et})();const Ue=ve.EMPTY;function Le(et){return et instanceof ve||et&&"closed"in et&&(0,I.m)(et.remove)&&(0,I.m)(et.add)&&(0,I.m)(et.unsubscribe)}function it(et){(0,I.m)(et)?et():et.unsubscribe()}},2653:(Gn,At,K)=>{"use strict";K.d(At,{config:()=>I});const I={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(Gn,At,K)=>{"use strict";K.d(At,{a:()=>xe});var I=K(5592),b=K(7453),dt=K(2459),l=K(2737),ve=K(7400),Ue=K(9940),Le=K(2714),it=K(8251),et=K(7103);function xe(...tt){const lt=(0,Ue.yG)(tt),pt=(0,Ue.jO)(tt),{args:vt,keys:_t}=(0,b.D)(tt);if(0===vt.length)return(0,dt.D)([],lt);const nt=new I.y(function Re(tt,lt,pt=l.y){return vt=>{Ze(lt,()=>{const{length:_t}=tt,nt=new Array(_t);let Bt=_t,Ft=_t;for(let Se=0;Se<_t;Se++)Ze(lt,()=>{const Me=(0,dt.D)(tt[Se],lt);let ht=!1;Me.subscribe((0,it.x)(vt,It=>{nt[Se]=It,ht||(ht=!0,Ft--),Ft||vt.next(pt(nt.slice()))},()=>{--Bt||vt.complete()}))},vt)},vt)}}(vt,lt,_t?Bt=>(0,Le.n)(_t,Bt):l.y));return pt?nt.pipe((0,ve.Z)(pt)):nt}function Ze(tt,lt,pt){tt?(0,et.f)(pt,tt,lt):lt()}},5211:(Gn,At,K)=>{"use strict";K.d(At,{z:()=>ve});var I=K(7537),dt=K(9940),l=K(2459);function ve(...Ue){return function b(){return(0,I.J)(1)}()((0,l.D)(Ue,(0,dt.yG)(Ue)))}},4911:(Gn,At,K)=>{"use strict";K.d(At,{P:()=>dt});var I=K(5592),b=K(4829);function dt(l){return new I.y(ve=>{(0,b.Xf)(l()).subscribe(ve)})}},6232:(Gn,At,K)=>{"use strict";K.d(At,{E:()=>b});const b=new(K(5592).y)(ve=>ve.complete())},2459:(Gn,At,K)=>{"use strict";K.d(At,{D:()=>Me});var I=K(4829),b=K(3093),dt=K(5137),Ue=K(5592),it=K(4971),et=K(4674),xe=K(7103);function Ze(ht,It){if(!ht)throw new Error("Iterable cannot be null");return new Ue.y(Je=>{(0,xe.f)(Je,It,()=>{const mt=ht[Symbol.asyncIterator]();(0,xe.f)(Je,It,()=>{mt.next().then(Kt=>{Kt.done?Je.complete():Je.next(Kt.value)})},0,!0)})})}var tt=K(8382),lt=K(4026),pt=K(4266),vt=K(3664),_t=K(5726),nt=K(9853),Bt=K(541);function Me(ht,It){return It?function Se(ht,It){if(null!=ht){if((0,tt.c)(ht))return function l(ht,It){return(0,I.Xf)(ht).pipe((0,dt.R)(It),(0,b.Q)(It))}(ht,It);if((0,pt.z)(ht))return function Le(ht,It){return new Ue.y(Je=>{let mt=0;return It.schedule(function(){mt===ht.length?Je.complete():(Je.next(ht[mt++]),Je.closed||this.schedule())})})}(ht,It);if((0,lt.t)(ht))return function ve(ht,It){return(0,I.Xf)(ht).pipe((0,dt.R)(It),(0,b.Q)(It))}(ht,It);if((0,_t.D)(ht))return Ze(ht,It);if((0,vt.T)(ht))return function Re(ht,It){return new Ue.y(Je=>{let mt;return(0,xe.f)(Je,It,()=>{mt=ht[it.h](),(0,xe.f)(Je,It,()=>{let Kt,Ut;try{({value:Kt,done:Ut}=mt.next())}catch(dn){return void Je.error(dn)}Ut?Je.complete():Je.next(Kt)},0,!0)}),()=>(0,et.m)(mt?.return)&&mt.return()})}(ht,It);if((0,Bt.L)(ht))return function Ft(ht,It){return Ze((0,Bt.Q)(ht),It)}(ht,It)}throw(0,nt.z)(ht)}(ht,It):(0,I.Xf)(ht)}},2438:(Gn,At,K)=>{"use strict";K.d(At,{R:()=>xe});var I=K(4829),b=K(5592),dt=K(1631),l=K(4266),ve=K(4674),Ue=K(7400);const Le=["addListener","removeListener"],it=["addEventListener","removeEventListener"],et=["on","off"];function xe(pt,vt,_t,nt){if((0,ve.m)(_t)&&(nt=_t,_t=void 0),nt)return xe(pt,vt,_t).pipe((0,Ue.Z)(nt));const[Bt,Ft]=function lt(pt){return(0,ve.m)(pt.addEventListener)&&(0,ve.m)(pt.removeEventListener)}(pt)?it.map(Se=>Me=>pt[Se](vt,Me,_t)):function Ze(pt){return(0,ve.m)(pt.addListener)&&(0,ve.m)(pt.removeListener)}(pt)?Le.map(Re(pt,vt)):function tt(pt){return(0,ve.m)(pt.on)&&(0,ve.m)(pt.off)}(pt)?et.map(Re(pt,vt)):[];if(!Bt&&(0,l.z)(pt))return(0,dt.z)(Se=>xe(Se,vt,_t))((0,I.Xf)(pt));if(!Bt)throw new TypeError("Invalid event target");return new b.y(Se=>{const Me=(...ht)=>Se.next(1<ht.length?ht:ht[0]);return Bt(Me),()=>Ft(Me)})}function Re(pt,vt){return _t=>nt=>pt[_t](vt,nt)}},4829:(Gn,At,K)=>{"use strict";K.d(At,{Xf:()=>tt});var I=K(7582),b=K(4266),dt=K(4026),l=K(5592),ve=K(8382),Ue=K(5726),Le=K(9853),it=K(3664),et=K(541),xe=K(4674),Re=K(3894),Ze=K(4850);function tt(Se){if(Se instanceof l.y)return Se;if(null!=Se){if((0,ve.c)(Se))return function lt(Se){return new l.y(Me=>{const ht=Se[Ze.L]();if((0,xe.m)(ht.subscribe))return ht.subscribe(Me);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Se);if((0,b.z)(Se))return function pt(Se){return new l.y(Me=>{for(let ht=0;ht<Se.length&&!Me.closed;ht++)Me.next(Se[ht]);Me.complete()})}(Se);if((0,dt.t)(Se))return function vt(Se){return new l.y(Me=>{Se.then(ht=>{Me.closed||(Me.next(ht),Me.complete())},ht=>Me.error(ht)).then(null,Re.h)})}(Se);if((0,Ue.D)(Se))return nt(Se);if((0,it.T)(Se))return function _t(Se){return new l.y(Me=>{for(const ht of Se)if(Me.next(ht),Me.closed)return;Me.complete()})}(Se);if((0,et.L)(Se))return function Bt(Se){return nt((0,et.Q)(Se))}(Se)}throw(0,Le.z)(Se)}function nt(Se){return new l.y(Me=>{(function Ft(Se,Me){var ht,It,Je,mt;return(0,I.mG)(this,void 0,void 0,function*(){try{for(ht=(0,I.KL)(Se);!(It=yield ht.next()).done;)if(Me.next(It.value),Me.closed)return}catch(Kt){Je={error:Kt}}finally{try{It&&!It.done&&(mt=ht.return)&&(yield mt.call(ht))}finally{if(Je)throw Je.error}}Me.complete()})})(Se,Me).catch(ht=>Me.error(ht))})}},3019:(Gn,At,K)=>{"use strict";K.d(At,{T:()=>Ue});var I=K(7537),b=K(4829),dt=K(6232),l=K(9940),ve=K(2459);function Ue(...Le){const it=(0,l.yG)(Le),et=(0,l._6)(Le,1/0),xe=Le;return xe.length?1===xe.length?(0,b.Xf)(xe[0]):(0,I.J)(et)((0,ve.D)(xe,it)):dt.E}},2096:(Gn,At,K)=>{"use strict";K.d(At,{of:()=>dt});var I=K(9940),b=K(2459);function dt(...l){const ve=(0,I.yG)(l);return(0,b.D)(l,ve)}},8251:(Gn,At,K)=>{"use strict";K.d(At,{x:()=>b});var I=K(305);function b(l,ve,Ue,Le,it){return new dt(l,ve,Ue,Le,it)}class dt extends I.Lv{constructor(ve,Ue,Le,it,et,xe){super(ve),this.onFinalize=et,this.shouldUnsubscribe=xe,this._next=Ue?function(Re){try{Ue(Re)}catch(Ze){ve.error(Ze)}}:super._next,this._error=it?function(Re){try{it(Re)}catch(Ze){ve.error(Ze)}finally{this.unsubscribe()}}:super._error,this._complete=Le?function(){try{Le()}catch(Re){ve.error(Re)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ve;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ue}=this;super.unsubscribe(),!Ue&&(null===(ve=this.onFinalize)||void 0===ve||ve.call(this))}}}},6306:(Gn,At,K)=>{"use strict";K.d(At,{K:()=>l});var I=K(4829),b=K(8251),dt=K(9360);function l(ve){return(0,dt.e)((Ue,Le)=>{let xe,it=null,et=!1;it=Ue.subscribe((0,b.x)(Le,void 0,void 0,Re=>{xe=(0,I.Xf)(ve(Re,l(ve)(Ue))),it?(it.unsubscribe(),it=null,xe.subscribe(Le)):et=!0})),et&&(it.unsubscribe(),it=null,xe.subscribe(Le))})}},6328:(Gn,At,K)=>{"use strict";K.d(At,{b:()=>dt});var I=K(1631),b=K(4674);function dt(l,ve){return(0,b.m)(ve)?(0,I.z)(l,ve,1):(0,I.z)(l,1)}},3572:(Gn,At,K)=>{"use strict";K.d(At,{d:()=>dt});var I=K(9360),b=K(8251);function dt(l){return(0,I.e)((ve,Ue)=>{let Le=!1;ve.subscribe((0,b.x)(Ue,it=>{Le=!0,Ue.next(it)},()=>{Le||Ue.next(l),Ue.complete()}))})}},3997:(Gn,At,K)=>{"use strict";K.d(At,{x:()=>l});var I=K(2737),b=K(9360),dt=K(8251);function l(Ue,Le=I.y){return Ue=Ue??ve,(0,b.e)((it,et)=>{let xe,Re=!0;it.subscribe((0,dt.x)(et,Ze=>{const tt=Le(Ze);(Re||!Ue(xe,tt))&&(Re=!1,xe=tt,et.next(Ze))}))})}function ve(Ue,Le){return Ue===Le}},2181:(Gn,At,K)=>{"use strict";K.d(At,{h:()=>dt});var I=K(9360),b=K(8251);function dt(l,ve){return(0,I.e)((Ue,Le)=>{let it=0;Ue.subscribe((0,b.x)(Le,et=>l.call(ve,et,it++)&&Le.next(et)))})}},4716:(Gn,At,K)=>{"use strict";K.d(At,{x:()=>b});var I=K(9360);function b(dt){return(0,I.e)((l,ve)=>{try{l.subscribe(ve)}finally{ve.add(dt)}})}},1374:(Gn,At,K)=>{"use strict";K.d(At,{P:()=>Le});var I=K(6973),b=K(2181),dt=K(8180),l=K(3572),ve=K(3026),Ue=K(2737);function Le(it,et){const xe=arguments.length>=2;return Re=>Re.pipe(it?(0,b.h)((Ze,tt)=>it(Ze,tt,Re)):Ue.y,(0,dt.q)(1),xe?(0,l.d)(et):(0,ve.T)(()=>new I.K))}},7398:(Gn,At,K)=>{"use strict";K.d(At,{U:()=>dt});var I=K(9360),b=K(8251);function dt(l,ve){return(0,I.e)((Ue,Le)=>{let it=0;Ue.subscribe((0,b.x)(Le,et=>{Le.next(l.call(ve,et,it++))}))})}},7537:(Gn,At,K)=>{"use strict";K.d(At,{J:()=>dt});var I=K(1631),b=K(2737);function dt(l=1/0){return(0,I.z)(b.y,l)}},1631:(Gn,At,K)=>{"use strict";K.d(At,{z:()=>it});var I=K(7398),b=K(4829),dt=K(9360),l=K(7103),ve=K(8251),Le=K(4674);function it(et,xe,Re=1/0){return(0,Le.m)(xe)?it((Ze,tt)=>(0,I.U)((lt,pt)=>xe(Ze,lt,tt,pt))((0,b.Xf)(et(Ze,tt))),Re):("number"==typeof xe&&(Re=xe),(0,dt.e)((Ze,tt)=>function Ue(et,xe,Re,Ze,tt,lt,pt,vt){const _t=[];let nt=0,Bt=0,Ft=!1;const Se=()=>{Ft&&!_t.length&&!nt&&xe.complete()},Me=It=>nt<Ze?ht(It):_t.push(It),ht=It=>{lt&&xe.next(It),nt++;let Je=!1;(0,b.Xf)(Re(It,Bt++)).subscribe((0,ve.x)(xe,mt=>{tt?.(mt),lt?Me(mt):xe.next(mt)},()=>{Je=!0},void 0,()=>{if(Je)try{for(nt--;_t.length&&nt<Ze;){const mt=_t.shift();pt?(0,l.f)(xe,pt,()=>ht(mt)):ht(mt)}Se()}catch(mt){xe.error(mt)}}))};return et.subscribe((0,ve.x)(xe,Me,()=>{Ft=!0,Se()})),()=>{vt?.()}}(Ze,tt,et,Re)))}},3093:(Gn,At,K)=>{"use strict";K.d(At,{Q:()=>l});var I=K(7103),b=K(9360),dt=K(8251);function l(ve,Ue=0){return(0,b.e)((Le,it)=>{Le.subscribe((0,dt.x)(it,et=>(0,I.f)(it,ve,()=>it.next(et),Ue),()=>(0,I.f)(it,ve,()=>it.complete(),Ue),et=>(0,I.f)(it,ve,()=>it.error(et),Ue)))})}},6699:(Gn,At,K)=>{"use strict";K.d(At,{R:()=>l});var I=K(9360),b=K(8251);function l(ve,Ue){return(0,I.e)(function dt(ve,Ue,Le,it,et){return(xe,Re)=>{let Ze=Le,tt=Ue,lt=0;xe.subscribe((0,b.x)(Re,pt=>{const vt=lt++;tt=Ze?ve(tt,pt,vt):(Ze=!0,pt),it&&Re.next(tt)},et&&(()=>{Ze&&Re.next(tt),Re.complete()})))}}(ve,Ue,arguments.length>=2,!0))}},3020:(Gn,At,K)=>{"use strict";K.d(At,{B:()=>ve});var I=K(4829),b=K(8645),dt=K(305),l=K(9360);function ve(Le={}){const{connector:it=(()=>new b.x),resetOnError:et=!0,resetOnComplete:xe=!0,resetOnRefCountZero:Re=!0}=Le;return Ze=>{let tt,lt,pt,vt=0,_t=!1,nt=!1;const Bt=()=>{lt?.unsubscribe(),lt=void 0},Ft=()=>{Bt(),tt=pt=void 0,_t=nt=!1},Se=()=>{const Me=tt;Ft(),Me?.unsubscribe()};return(0,l.e)((Me,ht)=>{vt++,!nt&&!_t&&Bt();const It=pt=pt??it();ht.add(()=>{vt--,0===vt&&!nt&&!_t&&(lt=Ue(Se,Re))}),It.subscribe(ht),!tt&&vt>0&&(tt=new dt.Hp({next:Je=>It.next(Je),error:Je=>{nt=!0,Bt(),lt=Ue(Ft,et,Je),It.error(Je)},complete:()=>{_t=!0,Bt(),lt=Ue(Ft,xe),It.complete()}}),(0,I.Xf)(Me).subscribe(tt))})(Ze)}}function Ue(Le,it,...et){if(!0===it)return void Le();if(!1===it)return;const xe=new dt.Hp({next:()=>{xe.unsubscribe(),Le()}});return(0,I.Xf)(it(...et)).subscribe(xe)}},7921:(Gn,At,K)=>{"use strict";K.d(At,{O:()=>l});var I=K(5211),b=K(9940),dt=K(9360);function l(...ve){const Ue=(0,b.yG)(ve);return(0,dt.e)((Le,it)=>{(Ue?(0,I.z)(ve,Le,Ue):(0,I.z)(ve,Le)).subscribe(it)})}},5137:(Gn,At,K)=>{"use strict";K.d(At,{R:()=>b});var I=K(9360);function b(dt,l=0){return(0,I.e)((ve,Ue)=>{Ue.add(dt.schedule(()=>ve.subscribe(Ue),l))})}},4664:(Gn,At,K)=>{"use strict";K.d(At,{w:()=>l});var I=K(4829),b=K(9360),dt=K(8251);function l(ve,Ue){return(0,b.e)((Le,it)=>{let et=null,xe=0,Re=!1;const Ze=()=>Re&&!et&&it.complete();Le.subscribe((0,dt.x)(it,tt=>{et?.unsubscribe();let lt=0;const pt=xe++;(0,I.Xf)(ve(tt,pt)).subscribe(et=(0,dt.x)(it,vt=>it.next(Ue?Ue(tt,vt,pt,lt++):vt),()=>{et=null,Ze()}))},()=>{Re=!0,Ze()}))})}},8180:(Gn,At,K)=>{"use strict";K.d(At,{q:()=>l});var I=K(6232),b=K(9360),dt=K(8251);function l(ve){return ve<=0?()=>I.E:(0,b.e)((Ue,Le)=>{let it=0;Ue.subscribe((0,dt.x)(Le,et=>{++it<=ve&&(Le.next(et),ve<=it&&Le.complete())}))})}},9397:(Gn,At,K)=>{"use strict";K.d(At,{b:()=>ve});var I=K(4674),b=K(9360),dt=K(8251),l=K(2737);function ve(Ue,Le,it){const et=(0,I.m)(Ue)||Le||it?{next:Ue,error:Le,complete:it}:Ue;return et?(0,b.e)((xe,Re)=>{var Ze;null===(Ze=et.subscribe)||void 0===Ze||Ze.call(et);let tt=!0;xe.subscribe((0,dt.x)(Re,lt=>{var pt;null===(pt=et.next)||void 0===pt||pt.call(et,lt),Re.next(lt)},()=>{var lt;tt=!1,null===(lt=et.complete)||void 0===lt||lt.call(et),Re.complete()},lt=>{var pt;tt=!1,null===(pt=et.error)||void 0===pt||pt.call(et,lt),Re.error(lt)},()=>{var lt,pt;tt&&(null===(lt=et.unsubscribe)||void 0===lt||lt.call(et)),null===(pt=et.finalize)||void 0===pt||pt.call(et)}))}):l.y}},3026:(Gn,At,K)=>{"use strict";K.d(At,{T:()=>l});var I=K(6973),b=K(9360),dt=K(8251);function l(Ue=ve){return(0,b.e)((Le,it)=>{let et=!1;Le.subscribe((0,dt.x)(it,xe=>{et=!0,it.next(xe)},()=>et?it.complete():it.error(Ue())))})}function ve(){return new I.K}},1954:(Gn,At,K)=>{"use strict";K.d(At,{o:()=>ve});var I=K(7394);class b extends I.w0{constructor(Le,it){super()}schedule(Le,it=0){return this}}const dt={setInterval(Ue,Le,...it){const{delegate:et}=dt;return et?.setInterval?et.setInterval(Ue,Le,...it):setInterval(Ue,Le,...it)},clearInterval(Ue){const{delegate:Le}=dt;return(Le?.clearInterval||clearInterval)(Ue)},delegate:void 0};var l=K(9039);class ve extends b{constructor(Le,it){super(Le,it),this.scheduler=Le,this.work=it,this.pending=!1}schedule(Le,it=0){var et;if(this.closed)return this;this.state=Le;const xe=this.id,Re=this.scheduler;return null!=xe&&(this.id=this.recycleAsyncId(Re,xe,it)),this.pending=!0,this.delay=it,this.id=null!==(et=this.id)&&void 0!==et?et:this.requestAsyncId(Re,this.id,it),this}requestAsyncId(Le,it,et=0){return dt.setInterval(Le.flush.bind(Le,this),et)}recycleAsyncId(Le,it,et=0){if(null!=et&&this.delay===et&&!1===this.pending)return it;null!=it&&dt.clearInterval(it)}execute(Le,it){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const et=this._execute(Le,it);if(et)return et;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Le,it){let xe,et=!1;try{this.work(Le)}catch(Re){et=!0,xe=Re||new Error("Scheduled action threw falsy error")}if(et)return this.unsubscribe(),xe}unsubscribe(){if(!this.closed){const{id:Le,scheduler:it}=this,{actions:et}=it;this.work=this.state=this.scheduler=null,this.pending=!1,(0,l.P)(et,this),null!=Le&&(this.id=this.recycleAsyncId(it,Le,null)),this.delay=null,super.unsubscribe()}}}},2631:(Gn,At,K)=>{"use strict";K.d(At,{v:()=>dt});var I=K(4552);class b{constructor(ve,Ue=b.now){this.schedulerActionCtor=ve,this.now=Ue}schedule(ve,Ue=0,Le){return new this.schedulerActionCtor(this,ve).schedule(Le,Ue)}}b.now=I.l.now;class dt extends b{constructor(ve,Ue=b.now){super(ve,Ue),this.actions=[],this._active=!1}flush(ve){const{actions:Ue}=this;if(this._active)return void Ue.push(ve);let Le;this._active=!0;do{if(Le=ve.execute(ve.state,ve.delay))break}while(ve=Ue.shift());if(this._active=!1,Le){for(;ve=Ue.shift();)ve.unsubscribe();throw Le}}}},6321:(Gn,At,K)=>{"use strict";K.d(At,{P:()=>l,z:()=>dt});var I=K(1954);const dt=new(K(2631).v)(I.o),l=dt},4552:(Gn,At,K)=>{"use strict";K.d(At,{l:()=>I});const I={now:()=>(I.delegate||Date).now(),delegate:void 0}},7599:(Gn,At,K)=>{"use strict";K.d(At,{z:()=>I});const I={setTimeout(b,dt,...l){const{delegate:ve}=I;return ve?.setTimeout?ve.setTimeout(b,dt,...l):setTimeout(b,dt,...l)},clearTimeout(b){const{delegate:dt}=I;return(dt?.clearTimeout||clearTimeout)(b)},delegate:void 0}},4971:(Gn,At,K)=>{"use strict";K.d(At,{h:()=>b});const b=function I(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Gn,At,K)=>{"use strict";K.d(At,{L:()=>I});const I="function"==typeof Symbol&&Symbol.observable||"@@observable"},6973:(Gn,At,K)=>{"use strict";K.d(At,{K:()=>b});const b=(0,K(2306).d)(dt=>function(){dt(this),this.name="EmptyError",this.message="no elements in sequence"})},9940:(Gn,At,K)=>{"use strict";K.d(At,{_6:()=>Ue,jO:()=>l,yG:()=>ve});var I=K(4674),b=K(671);function dt(Le){return Le[Le.length-1]}function l(Le){return(0,I.m)(dt(Le))?Le.pop():void 0}function ve(Le){return(0,b.K)(dt(Le))?Le.pop():void 0}function Ue(Le,it){return"number"==typeof dt(Le)?Le.pop():it}},7453:(Gn,At,K)=>{"use strict";K.d(At,{D:()=>ve});const{isArray:I}=Array,{getPrototypeOf:b,prototype:dt,keys:l}=Object;function ve(Le){if(1===Le.length){const it=Le[0];if(I(it))return{args:it,keys:null};if(function Ue(Le){return Le&&"object"==typeof Le&&b(Le)===dt}(it)){const et=l(it);return{args:et.map(xe=>it[xe]),keys:et}}}return{args:Le,keys:null}}},9039:(Gn,At,K)=>{"use strict";function I(b,dt){if(b){const l=b.indexOf(dt);0<=l&&b.splice(l,1)}}K.d(At,{P:()=>I})},2306:(Gn,At,K)=>{"use strict";function I(b){const l=b(ve=>{Error.call(ve),ve.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}K.d(At,{d:()=>I})},2714:(Gn,At,K)=>{"use strict";function I(b,dt){return b.reduce((l,ve,Ue)=>(l[ve]=dt[Ue],l),{})}K.d(At,{n:()=>I})},1441:(Gn,At,K)=>{"use strict";K.d(At,{O:()=>l,x:()=>dt});var I=K(2653);let b=null;function dt(ve){if(I.config.useDeprecatedSynchronousErrorHandling){const Ue=!b;if(Ue&&(b={errorThrown:!1,error:null}),ve(),Ue){const{errorThrown:Le,error:it}=b;if(b=null,Le)throw it}}else ve()}function l(ve){I.config.useDeprecatedSynchronousErrorHandling&&b&&(b.errorThrown=!0,b.error=ve)}},7103:(Gn,At,K)=>{"use strict";function I(b,dt,l,ve=0,Ue=!1){const Le=dt.schedule(function(){l(),Ue?b.add(this.schedule(null,ve)):this.unsubscribe()},ve);if(b.add(Le),!Ue)return Le}K.d(At,{f:()=>I})},2737:(Gn,At,K)=>{"use strict";function I(b){return b}K.d(At,{y:()=>I})},4266:(Gn,At,K)=>{"use strict";K.d(At,{z:()=>I});const I=b=>b&&"number"==typeof b.length&&"function"!=typeof b},5726:(Gn,At,K)=>{"use strict";K.d(At,{D:()=>b});var I=K(4674);function b(dt){return Symbol.asyncIterator&&(0,I.m)(dt?.[Symbol.asyncIterator])}},4674:(Gn,At,K)=>{"use strict";function I(b){return"function"==typeof b}K.d(At,{m:()=>I})},8382:(Gn,At,K)=>{"use strict";K.d(At,{c:()=>dt});var I=K(4850),b=K(4674);function dt(l){return(0,b.m)(l[I.L])}},3664:(Gn,At,K)=>{"use strict";K.d(At,{T:()=>dt});var I=K(4971),b=K(4674);function dt(l){return(0,b.m)(l?.[I.h])}},4026:(Gn,At,K)=>{"use strict";K.d(At,{t:()=>b});var I=K(4674);function b(dt){return(0,I.m)(dt?.then)}},541:(Gn,At,K)=>{"use strict";K.d(At,{L:()=>l,Q:()=>dt});var I=K(7582),b=K(4674);function dt(ve){return(0,I.FC)(this,arguments,function*(){const Le=ve.getReader();try{for(;;){const{value:it,done:et}=yield(0,I.qq)(Le.read());if(et)return yield(0,I.qq)(void 0);yield yield(0,I.qq)(it)}}finally{Le.releaseLock()}})}function l(ve){return(0,b.m)(ve?.getReader)}},671:(Gn,At,K)=>{"use strict";K.d(At,{K:()=>b});var I=K(4674);function b(dt){return dt&&(0,I.m)(dt.schedule)}},9360:(Gn,At,K)=>{"use strict";K.d(At,{A:()=>b,e:()=>dt});var I=K(4674);function b(l){return(0,I.m)(l?.lift)}function dt(l){return ve=>{if(b(ve))return ve.lift(function(Ue){try{return l(Ue,this)}catch(Le){this.error(Le)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(Gn,At,K)=>{"use strict";K.d(At,{Z:()=>l});var I=K(7398);const{isArray:b}=Array;function l(ve){return(0,I.U)(Ue=>function dt(ve,Ue){return b(Ue)?ve(...Ue):ve(Ue)}(ve,Ue))}},2420:(Gn,At,K)=>{"use strict";function I(){}K.d(At,{Z:()=>I})},8407:(Gn,At,K)=>{"use strict";K.d(At,{U:()=>dt,z:()=>b});var I=K(2737);function b(...l){return dt(l)}function dt(l){return 0===l.length?I.y:1===l.length?l[0]:function(Ue){return l.reduce((Le,it)=>it(Le),Ue)}}},3894:(Gn,At,K)=>{"use strict";K.d(At,{h:()=>dt});var I=K(2653),b=K(7599);function dt(l){b.z.setTimeout(()=>{const{onUnhandledError:ve}=I.config;if(!ve)throw l;ve(l)})}},9853:(Gn,At,K)=>{"use strict";function I(b){return new TypeError(`You provided ${null!==b&&"object"==typeof b?"an invalid object":`'${b}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}K.d(At,{z:()=>I})},863:(Gn,At,K)=>{var I={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,982,433],"./ion-datetime_3.entry.js":[7059,982,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function b(dt){if(!K.o(I,dt))return Promise.resolve().then(()=>{var Ue=new Error("Cannot find module '"+dt+"'");throw Ue.code="MODULE_NOT_FOUND",Ue});var l=I[dt],ve=l[0];return Promise.all(l.slice(1).map(K.e)).then(()=>K(ve))}b.keys=()=>Object.keys(I),b.id=863,Gn.exports=b},6825:(Gn,At,K)=>{"use strict";K.d(At,{IO:()=>pt,LC:()=>b,SB:()=>et,X$:()=>l,ZE:()=>nt,ZN:()=>_t,_j:()=>I,eR:()=>Re,jt:()=>ve,k1:()=>Bt,l3:()=>dt,oB:()=>it,pV:()=>tt,vP:()=>Le});class I{}class b{}const dt="*";function l(Ft,Se){return{type:7,name:Ft,definitions:Se,options:{}}}function ve(Ft,Se=null){return{type:4,styles:Se,timings:Ft}}function Le(Ft,Se=null){return{type:2,steps:Ft,options:Se}}function it(Ft){return{type:6,styles:Ft,offset:null}}function et(Ft,Se,Me){return{type:0,name:Ft,styles:Se,options:Me}}function Re(Ft,Se,Me=null){return{type:1,expr:Ft,animation:Se,options:Me}}function tt(Ft=null){return{type:9,options:Ft}}function pt(Ft,Se,Me=null){return{type:11,selector:Ft,animation:Se,options:Me}}class _t{constructor(Se=0,Me=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=Se+Me}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Se=>Se()),this._onDoneFns=[])}onStart(Se){this._originalOnStartFns.push(Se),this._onStartFns.push(Se)}onDone(Se){this._originalOnDoneFns.push(Se),this._onDoneFns.push(Se)}onDestroy(Se){this._onDestroyFns.push(Se)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(Se=>Se()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(Se=>Se()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(Se){this._position=this.totalTime?Se*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(Se){const Me="start"==Se?this._onStartFns:this._onDoneFns;Me.forEach(ht=>ht()),Me.length=0}}class nt{constructor(Se){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=Se;let Me=0,ht=0,It=0;const Je=this.players.length;0==Je?queueMicrotask(()=>this._onFinish()):this.players.forEach(mt=>{mt.onDone(()=>{++Me==Je&&this._onFinish()}),mt.onDestroy(()=>{++ht==Je&&this._onDestroy()}),mt.onStart(()=>{++It==Je&&this._onStart()})}),this.totalTime=this.players.reduce((mt,Kt)=>Math.max(mt,Kt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Se=>Se()),this._onDoneFns=[])}init(){this.players.forEach(Se=>Se.init())}onStart(Se){this._onStartFns.push(Se)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(Se=>Se()),this._onStartFns=[])}onDone(Se){this._onDoneFns.push(Se)}onDestroy(Se){this._onDestroyFns.push(Se)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(Se=>Se.play())}pause(){this.players.forEach(Se=>Se.pause())}restart(){this.players.forEach(Se=>Se.restart())}finish(){this._onFinish(),this.players.forEach(Se=>Se.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(Se=>Se.destroy()),this._onDestroyFns.forEach(Se=>Se()),this._onDestroyFns=[])}reset(){this.players.forEach(Se=>Se.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(Se){const Me=Se*this.totalTime;this.players.forEach(ht=>{const It=ht.totalTime?Math.min(1,Me/ht.totalTime):1;ht.setPosition(It)})}getPosition(){const Se=this.players.reduce((Me,ht)=>null===Me||ht.totalTime>Me.totalTime?ht:Me,null);return null!=Se?Se.getPosition():0}beforeDestroy(){this.players.forEach(Se=>{Se.beforeDestroy&&Se.beforeDestroy()})}triggerCallback(Se){const Me="start"==Se?this._onStartFns:this._onDoneFns;Me.forEach(ht=>ht()),Me.length=0}}const Bt="!"},6814:(Gn,At,K)=>{"use strict";K.d(At,{Do:()=>vt,ED:()=>Ce,EM:()=>Uo,HT:()=>l,JF:()=>cs,K0:()=>Ue,Mx:()=>ui,NF:()=>ls,O5:()=>Po,PM:()=>_o,RF:()=>fe,S$:()=>tt,V_:()=>it,Ye:()=>_t,b0:()=>pt,bD:()=>$o,ez:()=>eo,mk:()=>cn,n9:()=>je,q:()=>dt,sg:()=>Yo,tP:()=>xn,w_:()=>ve});var I=K(5879);let b=null;function dt(){return b}function l(N){b||(b=N)}class ve{}const Ue=new I.OlP("DocumentToken");let Le=(()=>{var N;class ee{historyGo(Y){throw new Error("Not implemented")}}return(N=ee).\u0275fac=function(Y){return new(Y||N)},N.\u0275prov=I.Yz7({token:N,factory:function(){return(0,I.f3M)(et)},providedIn:"platform"}),ee})();const it=new I.OlP("Location Initialized");let et=(()=>{var N;class ee extends Le{constructor(){super(),this._doc=(0,I.f3M)(Ue),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return dt().getBaseHref(this._doc)}onPopState(Y){const Fe=dt().getGlobalEventTarget(this._doc,"window");return Fe.addEventListener("popstate",Y,!1),()=>Fe.removeEventListener("popstate",Y)}onHashChange(Y){const Fe=dt().getGlobalEventTarget(this._doc,"window");return Fe.addEventListener("hashchange",Y,!1),()=>Fe.removeEventListener("hashchange",Y)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(Y){this._location.pathname=Y}pushState(Y,Fe,Et){this._history.pushState(Y,Fe,Et)}replaceState(Y,Fe,Et){this._history.replaceState(Y,Fe,Et)}forward(){this._history.forward()}back(){this._history.back()}historyGo(Y=0){this._history.go(Y)}getState(){return this._history.state}}return(N=ee).\u0275fac=function(Y){return new(Y||N)},N.\u0275prov=I.Yz7({token:N,factory:function(){return new N},providedIn:"platform"}),ee})();function xe(N,ee){if(0==N.length)return ee;if(0==ee.length)return N;let Ke=0;return N.endsWith("/")&&Ke++,ee.startsWith("/")&&Ke++,2==Ke?N+ee.substring(1):1==Ke?N+ee:N+"/"+ee}function Re(N){const ee=N.match(/#|\?|$/),Ke=ee&&ee.index||N.length;return N.slice(0,Ke-("/"===N[Ke-1]?1:0))+N.slice(Ke)}function Ze(N){return N&&"?"!==N[0]?"?"+N:N}let tt=(()=>{var N;class ee{historyGo(Y){throw new Error("Not implemented")}}return(N=ee).\u0275fac=function(Y){return new(Y||N)},N.\u0275prov=I.Yz7({token:N,factory:function(){return(0,I.f3M)(pt)},providedIn:"root"}),ee})();const lt=new I.OlP("appBaseHref");let pt=(()=>{var N;class ee extends tt{constructor(Y,Fe){super(),this._platformLocation=Y,this._removeListenerFns=[],this._baseHref=Fe??this._platformLocation.getBaseHrefFromDOM()??(0,I.f3M)(Ue).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(Y){this._removeListenerFns.push(this._platformLocation.onPopState(Y),this._platformLocation.onHashChange(Y))}getBaseHref(){return this._baseHref}prepareExternalUrl(Y){return xe(this._baseHref,Y)}path(Y=!1){const Fe=this._platformLocation.pathname+Ze(this._platformLocation.search),Et=this._platformLocation.hash;return Et&&Y?`${Fe}${Et}`:Fe}pushState(Y,Fe,Et,wn){const Mn=this.prepareExternalUrl(Et+Ze(wn));this._platformLocation.pushState(Y,Fe,Mn)}replaceState(Y,Fe,Et,wn){const Mn=this.prepareExternalUrl(Et+Ze(wn));this._platformLocation.replaceState(Y,Fe,Mn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(Y=0){this._platformLocation.historyGo?.(Y)}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.LFG(Le),I.LFG(lt,8))},N.\u0275prov=I.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),ee})(),vt=(()=>{var N;class ee extends tt{constructor(Y,Fe){super(),this._platformLocation=Y,this._baseHref="",this._removeListenerFns=[],null!=Fe&&(this._baseHref=Fe)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(Y){this._removeListenerFns.push(this._platformLocation.onPopState(Y),this._platformLocation.onHashChange(Y))}getBaseHref(){return this._baseHref}path(Y=!1){let Fe=this._platformLocation.hash;return null==Fe&&(Fe="#"),Fe.length>0?Fe.substring(1):Fe}prepareExternalUrl(Y){const Fe=xe(this._baseHref,Y);return Fe.length>0?"#"+Fe:Fe}pushState(Y,Fe,Et,wn){let Mn=this.prepareExternalUrl(Et+Ze(wn));0==Mn.length&&(Mn=this._platformLocation.pathname),this._platformLocation.pushState(Y,Fe,Mn)}replaceState(Y,Fe,Et,wn){let Mn=this.prepareExternalUrl(Et+Ze(wn));0==Mn.length&&(Mn=this._platformLocation.pathname),this._platformLocation.replaceState(Y,Fe,Mn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(Y=0){this._platformLocation.historyGo?.(Y)}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.LFG(Le),I.LFG(lt,8))},N.\u0275prov=I.Yz7({token:N,factory:N.\u0275fac}),ee})(),_t=(()=>{var N;class ee{constructor(Y){this._subject=new I.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=Y;const Fe=this._locationStrategy.getBaseHref();this._basePath=function Se(N){if(new RegExp("^(https?:)?//").test(N)){const[,Ke]=N.split(/\/\/[^\/]+/);return Ke}return N}(Re(Ft(Fe))),this._locationStrategy.onPopState(Et=>{this._subject.emit({url:this.path(!0),pop:!0,state:Et.state,type:Et.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(Y=!1){return this.normalize(this._locationStrategy.path(Y))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(Y,Fe=""){return this.path()==this.normalize(Y+Ze(Fe))}normalize(Y){return ee.stripTrailingSlash(function Bt(N,ee){if(!N||!ee.startsWith(N))return ee;const Ke=ee.substring(N.length);return""===Ke||["/",";","?","#"].includes(Ke[0])?Ke:ee}(this._basePath,Ft(Y)))}prepareExternalUrl(Y){return Y&&"/"!==Y[0]&&(Y="/"+Y),this._locationStrategy.prepareExternalUrl(Y)}go(Y,Fe="",Et=null){this._locationStrategy.pushState(Et,"",Y,Fe),this._notifyUrlChangeListeners(this.prepareExternalUrl(Y+Ze(Fe)),Et)}replaceState(Y,Fe="",Et=null){this._locationStrategy.replaceState(Et,"",Y,Fe),this._notifyUrlChangeListeners(this.prepareExternalUrl(Y+Ze(Fe)),Et)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(Y=0){this._locationStrategy.historyGo?.(Y)}onUrlChange(Y){return this._urlChangeListeners.push(Y),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Fe=>{this._notifyUrlChangeListeners(Fe.url,Fe.state)})),()=>{const Fe=this._urlChangeListeners.indexOf(Y);this._urlChangeListeners.splice(Fe,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(Y="",Fe){this._urlChangeListeners.forEach(Et=>Et(Y,Fe))}subscribe(Y,Fe,Et){return this._subject.subscribe({next:Y,error:Fe,complete:Et})}}return(N=ee).normalizeQueryParams=Ze,N.joinWithSlash=xe,N.stripTrailingSlash=Re,N.\u0275fac=function(Y){return new(Y||N)(I.LFG(tt))},N.\u0275prov=I.Yz7({token:N,factory:function(){return function nt(){return new _t((0,I.LFG)(tt))}()},providedIn:"root"}),ee})();function Ft(N){return N.replace(/\/index.html$/,"")}function ui(N,ee){ee=encodeURIComponent(ee);for(const Ke of N.split(";")){const Y=Ke.indexOf("="),[Fe,Et]=-1==Y?[Ke,""]:[Ke.slice(0,Y),Ke.slice(Y+1)];if(Fe.trim()===ee)return decodeURIComponent(Et)}return null}const qr=/\s+/,Es=[];let cn=(()=>{var N;class ee{constructor(Y,Fe,Et,wn){this._iterableDiffers=Y,this._keyValueDiffers=Fe,this._ngEl=Et,this._renderer=wn,this.initialClasses=Es,this.stateMap=new Map}set klass(Y){this.initialClasses=null!=Y?Y.trim().split(qr):Es}set ngClass(Y){this.rawClass="string"==typeof Y?Y.trim().split(qr):Y}ngDoCheck(){for(const Fe of this.initialClasses)this._updateState(Fe,!0);const Y=this.rawClass;if(Array.isArray(Y)||Y instanceof Set)for(const Fe of Y)this._updateState(Fe,!0);else if(null!=Y)for(const Fe of Object.keys(Y))this._updateState(Fe,!!Y[Fe]);this._applyStateDiff()}_updateState(Y,Fe){const Et=this.stateMap.get(Y);void 0!==Et?(Et.enabled!==Fe&&(Et.changed=!0,Et.enabled=Fe),Et.touched=!0):this.stateMap.set(Y,{enabled:Fe,changed:!0,touched:!0})}_applyStateDiff(){for(const Y of this.stateMap){const Fe=Y[0],Et=Y[1];Et.changed?(this._toggleClass(Fe,Et.enabled),Et.changed=!1):Et.touched||(Et.enabled&&this._toggleClass(Fe,!1),this.stateMap.delete(Fe)),Et.touched=!1}}_toggleClass(Y,Fe){(Y=Y.trim()).length>0&&Y.split(qr).forEach(Et=>{Fe?this._renderer.addClass(this._ngEl.nativeElement,Et):this._renderer.removeClass(this._ngEl.nativeElement,Et)})}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.Y36(I.ZZ4),I.Y36(I.aQg),I.Y36(I.SBq),I.Y36(I.Qsj))},N.\u0275dir=I.lG2({type:N,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),ee})();class oi{constructor(ee,Ke,Y,Fe){this.$implicit=ee,this.ngForOf=Ke,this.index=Y,this.count=Fe}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Yo=(()=>{var N;class ee{set ngForOf(Y){this._ngForOf=Y,this._ngForOfDirty=!0}set ngForTrackBy(Y){this._trackByFn=Y}get ngForTrackBy(){return this._trackByFn}constructor(Y,Fe,Et){this._viewContainer=Y,this._template=Fe,this._differs=Et,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(Y){Y&&(this._template=Y)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const Y=this._ngForOf;!this._differ&&Y&&(this._differ=this._differs.find(Y).create(this.ngForTrackBy))}if(this._differ){const Y=this._differ.diff(this._ngForOf);Y&&this._applyChanges(Y)}}_applyChanges(Y){const Fe=this._viewContainer;Y.forEachOperation((Et,wn,Mn)=>{if(null==Et.previousIndex)Fe.createEmbeddedView(this._template,new oi(Et.item,this._ngForOf,-1,-1),null===Mn?void 0:Mn);else if(null==Mn)Fe.remove(null===wn?void 0:wn);else if(null!==wn){const Dr=Fe.get(wn);Fe.move(Dr,Mn),Vi(Dr,Et)}});for(let Et=0,wn=Fe.length;Et<wn;Et++){const Dr=Fe.get(Et).context;Dr.index=Et,Dr.count=wn,Dr.ngForOf=this._ngForOf}Y.forEachIdentityChange(Et=>{Vi(Fe.get(Et.currentIndex),Et)})}static ngTemplateContextGuard(Y,Fe){return!0}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.Y36(I.s_b),I.Y36(I.Rgc),I.Y36(I.ZZ4))},N.\u0275dir=I.lG2({type:N,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),ee})();function Vi(N,ee){N.context.$implicit=ee.item}let Po=(()=>{var N;class ee{constructor(Y,Fe){this._viewContainer=Y,this._context=new No,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Fe}set ngIf(Y){this._context.$implicit=this._context.ngIf=Y,this._updateView()}set ngIfThen(Y){qn("ngIfThen",Y),this._thenTemplateRef=Y,this._thenViewRef=null,this._updateView()}set ngIfElse(Y){qn("ngIfElse",Y),this._elseTemplateRef=Y,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(Y,Fe){return!0}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.Y36(I.s_b),I.Y36(I.Rgc))},N.\u0275dir=I.lG2({type:N,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),ee})();class No{constructor(){this.$implicit=null,this.ngIf=null}}function qn(N,ee){if(ee&&!ee.createEmbeddedView)throw new Error(`${N} must be a TemplateRef, but received '${(0,I.AaK)(ee)}'.`)}class Cr{constructor(ee,Ke){this._viewContainerRef=ee,this._templateRef=Ke,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(ee){ee&&!this._created?this.create():!ee&&this._created&&this.destroy()}}let fe=(()=>{var N;class ee{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(Y){this._ngSwitch=Y,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(Y){this._defaultViews.push(Y)}_matchCase(Y){const Fe=Y==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||Fe,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),Fe}_updateDefaultCases(Y){if(this._defaultViews.length>0&&Y!==this._defaultUsed){this._defaultUsed=Y;for(const Fe of this._defaultViews)Fe.enforceState(Y)}}}return(N=ee).\u0275fac=function(Y){return new(Y||N)},N.\u0275dir=I.lG2({type:N,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),ee})(),je=(()=>{var N;class ee{constructor(Y,Fe,Et){this.ngSwitch=Et,Et._addCase(),this._view=new Cr(Y,Fe)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.Y36(I.s_b),I.Y36(I.Rgc),I.Y36(fe,9))},N.\u0275dir=I.lG2({type:N,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),ee})(),Ce=(()=>{var N;class ee{constructor(Y,Fe,Et){Et._addDefault(new Cr(Y,Fe))}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.Y36(I.s_b),I.Y36(I.Rgc),I.Y36(fe,9))},N.\u0275dir=I.lG2({type:N,selectors:[["","ngSwitchDefault",""]],standalone:!0}),ee})(),xn=(()=>{var N;class ee{constructor(Y){this._viewContainerRef=Y,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(Y){if(Y.ngTemplateOutlet||Y.ngTemplateOutletInjector){const Fe=this._viewContainerRef;if(this._viewRef&&Fe.remove(Fe.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:Et,ngTemplateOutletContext:wn,ngTemplateOutletInjector:Mn}=this;this._viewRef=Fe.createEmbeddedView(Et,wn,Mn?{injector:Mn}:void 0)}else this._viewRef=null}else this._viewRef&&Y.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return(N=ee).\u0275fac=function(Y){return new(Y||N)(I.Y36(I.s_b))},N.\u0275dir=I.lG2({type:N,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[I.TTD]}),ee})(),eo=(()=>{var N;class ee{}return(N=ee).\u0275fac=function(Y){return new(Y||N)},N.\u0275mod=I.oAB({type:N}),N.\u0275inj=I.cJS({}),ee})();const $o="browser",Vo="server";function ls(N){return N===$o}function _o(N){return N===Vo}let Uo=(()=>{var N;class ee{}return(N=ee).\u0275prov=(0,I.Yz7)({token:N,providedIn:"root",factory:()=>new jo((0,I.LFG)(Ue),window)}),ee})();class jo{constructor(ee,Ke){this.document=ee,this.window=Ke,this.offset=()=>[0,0]}setOffset(ee){this.offset=Array.isArray(ee)?()=>ee:ee}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(ee){this.supportsScrolling()&&this.window.scrollTo(ee[0],ee[1])}scrollToAnchor(ee){if(!this.supportsScrolling())return;const Ke=function oa(N,ee){const Ke=N.getElementById(ee)||N.getElementsByName(ee)[0];if(Ke)return Ke;if("function"==typeof N.createTreeWalker&&N.body&&"function"==typeof N.body.attachShadow){const Y=N.createTreeWalker(N.body,NodeFilter.SHOW_ELEMENT);let Fe=Y.currentNode;for(;Fe;){const Et=Fe.shadowRoot;if(Et){const wn=Et.getElementById(ee)||Et.querySelector(`[name="${ee}"]`);if(wn)return wn}Fe=Y.nextNode()}}return null}(this.document,ee);Ke&&(this.scrollToElement(Ke),Ke.focus())}setHistoryScrollRestoration(ee){this.supportsScrolling()&&(this.window.history.scrollRestoration=ee)}scrollToElement(ee){const Ke=ee.getBoundingClientRect(),Y=Ke.left+this.window.pageXOffset,Fe=Ke.top+this.window.pageYOffset,Et=this.offset();this.window.scrollTo(Y-Et[0],Fe-Et[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class cs{}},5879:(Gn,At,K)=>{"use strict";K.d(At,{$8M:()=>Ua,$WT:()=>ps,$Z:()=>eu,AFp:()=>tg,AaK:()=>Ze,CHM:()=>Ca,CRH:()=>zx,DdM:()=>vx,EJc:()=>oD,EpF:()=>kv,F$t:()=>Vv,F4k:()=>Lv,FYo:()=>Cp,FiY:()=>bd,G48:()=>WD,Gf:()=>Bx,GfV:()=>Ip,GkF:()=>Cy,Gpc:()=>pt,Gre:()=>E0,HDt:()=>ab,Hsn:()=>Uv,Ikx:()=>Ly,JOm:()=>kh,KtG:()=>El,LFG:()=>vn,LMc:()=>wC,Lbi:()=>fp,Lck:()=>Vw,MAs:()=>Df,MMx:()=>dx,MR2:()=>rd,NdJ:()=>Sy,O4$:()=>Pt,Ojb:()=>rg,OlP:()=>mo,Oqu:()=>ky,P3R:()=>Gm,PXZ:()=>BD,Q6J:()=>uc,QGY:()=>Ty,QbO:()=>Y_,Qsj:()=>Tp,R0b:()=>rl,RDi:()=>km,Rgc:()=>lm,SBq:()=>th,Sil:()=>lD,Suo:()=>Nx,TTD:()=>Ba,TgZ:()=>ua,VuI:()=>xC,X6Q:()=>GD,XFs:()=>fr,Xpm:()=>cr,Xq5:()=>g,Xts:()=>Gd,Y36:()=>Mu,YKP:()=>cx,YNc:()=>wf,Yjl:()=>To,Yz7:()=>an,Z0I:()=>nr,ZZ4:()=>_v,_Bn:()=>lx,_UZ:()=>Fu,_Vd:()=>Kc,_c5:()=>lC,_uU:()=>f0,aQg:()=>yv,c2e:()=>sb,cJS:()=>Bn,cg1:()=>Fy,dDg:()=>OD,dqk:()=>Sr,eFA:()=>wb,eJc:()=>Qy,ekj:()=>Ry,eoX:()=>yb,f3M:()=>Wn,g9A:()=>ng,h0i:()=>bh,hGG:()=>cC,hij:()=>o_,iGM:()=>Fx,ifc:()=>Dn,ip1:()=>ob,jDz:()=>hx,kL8:()=>k0,kcU:()=>sr,lG2:()=>Ri,lqb:()=>kl,lri:()=>gb,n5z:()=>lo,n_E:()=>u_,oAB:()=>oo,oxw:()=>$v,q4F:()=>Wa,qFp:()=>EC,qLn:()=>bc,qOj:()=>bf,qZA:()=>da,rWj:()=>_b,rg0:()=>fc,sBO:()=>qD,s_b:()=>f_,soG:()=>m_,tBr:()=>Lf,tb:()=>dv,tp0:()=>Ch,uIk:()=>Ge,vHH:()=>Se,vpe:()=>su,wAp:()=>If,xp6:()=>df,z2F:()=>Rf,zSh:()=>Xh,zs3:()=>fl});var I=K(8645),b=K(7394),dt=K(5619),l=K(5592),ve=K(3019),Ue=K(2096),Le=K(3020),it=K(4664),et=K(3997);function xe(t){for(let o in t)if(t[o]===xe)return o;throw Error("Could not find renamed property on target object.")}function Re(t,o){for(const a in o)o.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=o[a])}function Ze(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ze).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const o=t.toString();if(null==o)return""+o;const a=o.indexOf("\n");return-1===a?o:o.substring(0,a)}function tt(t,o){return null==t||""===t?null===o?"":o:null==o||""===o?t:t+" "+o}const lt=xe({__forward_ref__:xe});function pt(t){return t.__forward_ref__=pt,t.toString=function(){return Ze(this())},t}function vt(t){return _t(t)?t():t}function _t(t){return"function"==typeof t&&t.hasOwnProperty(lt)&&t.__forward_ref__===pt}function nt(t){return t&&!!t.\u0275providers}const Ft="https://g.co/ng/security#xss";class Se extends Error{constructor(o,a){super(function Me(t,o){return`NG0${Math.abs(t)}${o?": "+o:""}`}(o,a)),this.code=o}}function ht(t){return"string"==typeof t?t:null==t?"":String(t)}function Ut(t,o){throw new Se(-201,!1)}function Yt(t,o){null==t&&function hn(t,o,a,d){throw new Error(`ASSERTION ERROR: ${t}`+(null==d?"":` [Expected=> ${a} ${d} ${o} <=Actual]`))}(o,t,null,"!=")}function an(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Bn(t){return{providers:t.providers||[],imports:t.imports||[]}}function mr(t){return _r(t,bn)||_r(t,Fi)}function nr(t){return null!==mr(t)}function _r(t,o){return t.hasOwnProperty(o)?t[o]:null}function Lr(t){return t&&(t.hasOwnProperty(Jr)||t.hasOwnProperty(hi))?t[Jr]:null}const bn=xe({\u0275prov:xe}),Jr=xe({\u0275inj:xe}),Fi=xe({ngInjectableDef:xe}),hi=xe({ngInjectorDef:xe});var fr=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(fr||{});let Er;function gr(t){const o=Er;return Er=t,o}function Ci(t,o,a){const d=mr(t);return d&&"root"==d.providedIn?void 0===d.value?d.value=d.factory():d.value:a&fr.Optional?null:void 0!==o?o:void Ut(Ze(t))}const Sr=globalThis,kt={},xt="__NG_DI_FLAG__",Vt="ngTempTokenPath",Be=/\n/gm,de="__source";let Ne;function ot(t){const o=Ne;return Ne=t,o}function $t(t,o=fr.Default){if(void 0===Ne)throw new Se(-203,!1);return null===Ne?Ci(t,void 0,o):Ne.get(t,o&fr.Optional?null:void 0,o)}function vn(t,o=fr.Default){return(function yr(){return Er}()||$t)(vt(t),o)}function Wn(t,o=fr.Default){return vn(t,hr(o))}function hr(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function vr(t){const o=[];for(let a=0;a<t.length;a++){const d=vt(t[a]);if(Array.isArray(d)){if(0===d.length)throw new Se(900,!1);let m,x=fr.Default;for(let S=0;S<d.length;S++){const k=d[S],U=ni(k);"number"==typeof U?-1===U?m=k.token:x|=U:m=k}o.push(vn(m,x))}else o.push(vn(d))}return o}function Wr(t,o){return t[xt]=o,t.prototype[xt]=o,t}function ni(t){return t[xt]}function rn(t){return{toString:t}.toString()}var Tt=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Tt||{}),Dn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Dn||{});const ur={},Zn=[],Rr=xe({\u0275cmp:xe}),Fr=xe({\u0275dir:xe}),fi=xe({\u0275pipe:xe}),Ti=xe({\u0275mod:xe}),Qr=xe({\u0275fac:xe}),ui=xe({__NG_ELEMENT_ID__:xe}),qr=xe({__NG_ENV_ID__:xe});function Es(t,o,a){let d=t.length;for(;;){const m=t.indexOf(o,a);if(-1===m)return m;if(0===m||t.charCodeAt(m-1)<=32){const x=o.length;if(m+x===d||t.charCodeAt(m+x)<=32)return m}a=m+1}}function cn(t,o,a){let d=0;for(;d<a.length;){const m=a[d];if("number"==typeof m){if(0!==m)break;d++;const x=a[d++],S=a[d++],k=a[d++];t.setAttribute(o,S,k,x)}else{const x=m,S=a[++d];wi(x)?t.setProperty(o,x,S):t.setAttribute(o,x,S),d++}}return d}function io(t){return 3===t||4===t||6===t}function wi(t){return 64===t.charCodeAt(0)}function oi(t,o){if(null!==o&&0!==o.length)if(null===t||0===t.length)t=o.slice();else{let a=-1;for(let d=0;d<o.length;d++){const m=o[d];"number"==typeof m?a=m:0===a||Yo(t,a,m,null,-1===a||2===a?o[++d]:null)}}return t}function Yo(t,o,a,d,m){let x=0,S=t.length;if(-1===o)S=-1;else for(;x<t.length;){const k=t[x++];if("number"==typeof k){if(k===o){S=-1;break}if(k>o){S=x-1;break}}}for(;x<t.length;){const k=t[x];if("number"==typeof k)break;if(k===a){if(null===d)return void(null!==m&&(t[x+1]=m));if(d===t[x+1])return void(t[x+2]=m)}x++,null!==d&&x++,null!==m&&x++}-1!==S&&(t.splice(S,0,o),x=S+1),t.splice(x++,0,a),null!==d&&t.splice(x++,0,d),null!==m&&t.splice(x++,0,m)}const Vi="ng-template";function ss(t,o,a){let d=0,m=!0;for(;d<t.length;){let x=t[d++];if("string"==typeof x&&m){const S=t[d++];if(a&&"class"===x&&-1!==Es(S.toLowerCase(),o,0))return!0}else{if(1===x){for(;d<t.length&&"string"==typeof(x=t[d++]);)if(x.toLowerCase()===o)return!0;return!1}"number"==typeof x&&(m=!1)}}return!1}function Po(t){return 4===t.type&&t.value!==Vi}function No(t,o,a){return o===(4!==t.type||a?t.value:Vi)}function qn(t,o,a){let d=4;const m=t.attrs||[],x=function Ve(t){for(let o=0;o<t.length;o++)if(io(t[o]))return o;return t.length}(m);let S=!1;for(let k=0;k<o.length;k++){const U=o[k];if("number"!=typeof U){if(!S)if(4&d){if(d=2|1&d,""!==U&&!No(t,U,a)||""===U&&1===o.length){if(Cr(d))return!1;S=!0}}else{const ie=8&d?U:o[++k];if(8&d&&null!==t.attrs){if(!ss(t.attrs,ie,a)){if(Cr(d))return!1;S=!0}continue}const rt=fe(8&d?"class":U,m,Po(t),a);if(-1===rt){if(Cr(d))return!1;S=!0;continue}if(""!==ie){let Nt;Nt=rt>x?"":m[rt+1].toLowerCase();const Qt=8&d?Nt:null;if(Qt&&-1!==Es(Qt,ie,0)||2&d&&ie!==Nt){if(Cr(d))return!1;S=!0}}}}else{if(!S&&!Cr(d)&&!Cr(U))return!1;if(S&&Cr(U))continue;S=!1,d=U|1&d}}return Cr(d)||S}function Cr(t){return 0==(1&t)}function fe(t,o,a,d){if(null===o)return-1;let m=0;if(d||!a){let x=!1;for(;m<o.length;){const S=o[m];if(S===t)return m;if(3===S||6===S)x=!0;else{if(1===S||2===S){let k=o[++m];for(;"string"==typeof k;)k=o[++m];continue}if(4===S)break;if(0===S){m+=4;continue}}m+=x?1:2}return-1}return function St(t,o){let a=t.indexOf(4);if(a>-1)for(a++;a<t.length;){const d=t[a];if("number"==typeof d)return-1;if(d===o)return a;a++}return-1}(o,t)}function je(t,o,a=!1){for(let d=0;d<o.length;d++)if(qn(t,o[d],a))return!0;return!1}function zt(t,o){e:for(let a=0;a<o.length;a++){const d=o[a];if(t.length===d.length){for(let m=0;m<t.length;m++)if(t[m]!==d[m])continue e;return!0}}return!1}function fn(t,o){return t?":not("+o.trim()+")":o}function xn(t){let o=t[0],a=1,d=2,m="",x=!1;for(;a<t.length;){let S=t[a];if("string"==typeof S)if(2&d){const k=t[++a];m+="["+S+(k.length>0?'="'+k+'"':"")+"]"}else 8&d?m+="."+S:4&d&&(m+=" "+S);else""!==m&&!Cr(S)&&(o+=fn(x,m),m=""),d=S,x=x||!Cr(d);a++}return""!==m&&(o+=fn(x,m)),o}function cr(t){return rn(()=>{const o=So(t),a={...o,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Tt.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Dn.Emulated,styles:t.styles||Zn,_:null,schemas:t.schemas||null,tView:null,id:""};Ks(a);const d=t.dependencies;return a.directiveDefs=as(d,!1),a.pipeDefs=as(d,!0),a.id=function Os(t){let o=0;const a=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const m of a)o=Math.imul(31,o)+m.charCodeAt(0)<<0;return o+=2147483648,"c"+o}(a),a})}function kr(t){return jr(t)||Zr(t)}function Ei(t){return null!==t}function oo(t){return rn(()=>({type:t.type,bootstrap:t.bootstrap||Zn,declarations:t.declarations||Zn,imports:t.imports||Zn,exports:t.exports||Zn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Ji(t,o){if(null==t)return ur;const a={};for(const d in t)if(t.hasOwnProperty(d)){let m=t[d],x=m;Array.isArray(m)&&(x=m[1],m=m[0]),a[m]=d,o&&(o[m]=x)}return a}function Ri(t){return rn(()=>{const o=So(t);return Ks(o),o})}function To(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function jr(t){return t[Rr]||null}function Zr(t){return t[Fr]||null}function Qi(t){return t[fi]||null}function ps(t){const o=jr(t)||Zr(t)||Qi(t);return null!==o&&o.standalone}function Pi(t,o){const a=t[Ti]||null;if(!a&&!0===o)throw new Error(`Type ${Ze(t)} does not have '\u0275mod' property.`);return a}function So(t){const o={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:o,inputTransforms:null,inputConfig:t.inputs||ur,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Zn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ji(t.inputs,o),outputs:Ji(t.outputs)}}function Ks(t){t.features?.forEach(o=>o(t))}function as(t,o){if(!t)return null;const a=o?Qi:kr;return()=>("function"==typeof t?t():t).map(d=>a(d)).filter(Ei)}const Oi=0,rr=1,xr=2,Si=3,Io=4,zo=5,Ii=6,Ms=7,eo=8,$o=9,Vo=10,Mr=11,ks=12,ls=13,_o=14,Ui=15,es=16,Ro=17,Uo=18,jo=19,oa=20,ms=21,cs=22,ts=23,ns=24,er=25,As=1,va=2,Ho=7,uo=9,so=11;function Bi(t){return Array.isArray(t)&&"object"==typeof t[As]}function Zi(t){return Array.isArray(t)&&!0===t[As]}function Hs(t){return 0!=(4&t.flags)}function gs(t){return t.componentOffset>-1}function us(t){return 1==(1&t.flags)}function Xo(t){return!!t.template}function sa(t){return 0!=(512&t[xr])}function Ko(t,o){return t.hasOwnProperty(Qr)?t[Qr]:null}let wa=Sr.WeakRef??class Vl{constructor(o){this.ref=o}deref(){return this.ref}},Ul=0,Ls=null,Gs=!1;function ho(t){const o=Ls;return Ls=t,o}class Fs{constructor(){this.id=Ul++,this.ref=function xl(t){return new wa(t)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[o,a]of this.producers){const d=a.producerNode.deref();if(null!=d&&a.atTrackingVersion===this.trackingVersion){if(d.producerPollStatus(a.seenValueVersion))return!0}else this.producers.delete(o),d?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const o=Gs;Gs=!0;try{for(const[a,d]of this.consumers){const m=d.consumerNode.deref();null!=m&&m.trackingVersion===d.atTrackingVersion?m.onConsumerDependencyMayHaveChanged():(this.consumers.delete(a),m?.producers.delete(this.id))}}finally{Gs=o}}producerAccessed(){if(Gs)throw new Error("");if(null===Ls)return;let o=Ls.producers.get(this.id);void 0===o?(o={consumerNode:Ls.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Ls.trackingVersion},Ls.producers.set(this.id,o),this.consumers.set(Ls.id,o)):(o.seenValueVersion=this.valueVersion,o.atTrackingVersion=Ls.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Ls?.consumerAllowSignalWrites}producerPollStatus(o){return this.valueVersion!==o||(this.onProducerUpdateValueVersion(),this.valueVersion!==o)}}let fa=null;function fc(t){const o=ho(null);try{return t()}finally{ho(o)}}const Hl=()=>{};class Ea extends Fs{constructor(o,a,d){super(),this.watch=o,this.schedule=a,this.dirty=!1,this.cleanupFn=Hl,this.registerOnCleanup=m=>{this.cleanupFn=m},this.consumerAllowSignalWrites=d}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const o=ho(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Hl,this.watch(this.registerOnCleanup)}finally{ho(o)}}cleanup(){this.cleanupFn()}}class Qs{constructor(o,a,d){this.previousValue=o,this.currentValue=a,this.firstChange=d}isFirstChange(){return this.firstChange}}function Ba(){return Na}function Na(t){return t.type.prototype.ngOnChanges&&(t.setInput=ea),Qo}function Qo(){const t=ee(this),o=t?.current;if(o){const a=t.previous;if(a===ur)t.previous=o;else for(let d in o)a[d]=o[d];t.current=null,this.ngOnChanges(o)}}function ea(t,o,a,d){const m=this.declaredInputs[a],x=ee(t)||function Ke(t,o){return t[N]=o}(t,{previous:ur,current:null}),S=x.current||(x.current={}),k=x.previous,U=k[m];S[m]=new Qs(U&&U.currentValue,o,k===ur),t[d]=o}Ba.ngInherit=!0;const N="__ngSimpleChanges__";function ee(t){return t[N]||null}const Et=function(t,o,a){},wn="svg";function Dr(t){for(;Array.isArray(t);)t=t[Oi];return t}function bi(t,o){return Dr(o[t])}function Br(t,o){return Dr(o[t.index])}function Di(t,o){return t.data[o]}function ko(t,o){const a=o[t];return Bi(a)?a:a[Oi]}function _s(t,o){return null==o?null:t[o]}function Cs(t){t[Ro]=0}function aa(t){1024&t[xr]||(t[xr]|=1024,cl(t,1))}function Gl(t){1024&t[xr]&&(t[xr]&=-1025,cl(t,-1))}function cl(t,o){let a=t[Si];if(null===a)return;a[zo]+=o;let d=a;for(a=a[Si];null!==a&&(1===o&&1===d[zo]||-1===o&&0===d[zo]);)a[zo]+=o,d=a,a=a[Si]}const ei={lFrame:B(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Wl(){return ei.bindingsEnabled}function Da(){return null!==ei.skipHydrationRootTNode}function Nn(){return ei.lFrame.lView}function ri(){return ei.lFrame.tView}function Ca(t){return ei.lFrame.contextLView=t,t[eo]}function El(t){return ei.lFrame.contextLView=null,t}function ds(){let t=Dl();for(;null!==t&&64===t.type;)t=t.parent;return t}function Dl(){return ei.lFrame.currentTNode}function na(t,o){const a=ei.lFrame;a.currentTNode=t,a.isParent=o}function Yl(){return ei.lFrame.isParent}function Ac(){ei.lFrame.isParent=!1}function Xa(){return ei.lFrame.bindingIndex++}function ca(t){const o=ei.lFrame,a=o.bindingIndex;return o.bindingIndex=o.bindingIndex+t,a}function Ss(t,o){const a=ei.lFrame;a.bindingIndex=a.bindingRootIndex=t,Kl(o)}function Kl(t){ei.lFrame.currentDirectiveIndex=t}function lu(){return ei.lFrame.currentQueryIndex}function qs(t){ei.lFrame.currentQueryIndex=t}function Rc(t){const o=t[rr];return 2===o.type?o.declTNode:1===o.type?t[Ii]:null}function L(t,o,a){if(a&fr.SkipSelf){let m=o,x=t;for(;!(m=m.parent,null!==m||a&fr.Host||(m=Rc(x),null===m||(x=x[_o],10&m.type))););if(null===m)return!1;o=m,t=x}const d=ei.lFrame=H();return d.currentTNode=o,d.lView=t,!0}function z(t){const o=H(),a=t[rr];ei.lFrame=o,o.currentTNode=a.firstChild,o.lView=t,o.tView=a,o.contextLView=t,o.bindingIndex=a.bindingStartIndex,o.inI18n=!1}function H(){const t=ei.lFrame,o=null===t?null:t.child;return null===o?B(t):o}function B(t){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=o),o}function D(){const t=ei.lFrame;return ei.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const _=D;function E(){const t=D();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function oe(){return ei.lFrame.selectedIndex}function ge(t){ei.lFrame.selectedIndex=t}function Oe(){const t=ei.lFrame;return Di(t.tView,t.selectedIndex)}function Pt(){ei.lFrame.currentNamespace=wn}function sr(){!function Qn(){ei.lFrame.currentNamespace=null}()}let Hr=!0;function Nr(){return Hr}function zr(t){Hr=t}function ai(t,o){for(let a=o.directiveStart,d=o.directiveEnd;a<d;a++){const x=t.data[a].type.prototype,{ngAfterContentInit:S,ngAfterContentChecked:k,ngAfterViewInit:U,ngAfterViewChecked:ie,ngOnDestroy:we}=x;S&&(t.contentHooks??=[]).push(-a,S),k&&((t.contentHooks??=[]).push(a,k),(t.contentCheckHooks??=[]).push(a,k)),U&&(t.viewHooks??=[]).push(-a,U),ie&&((t.viewHooks??=[]).push(a,ie),(t.viewCheckHooks??=[]).push(a,ie)),null!=we&&(t.destroyHooks??=[]).push(a,we)}}function zi(t,o,a){c(t,o,3,a)}function h(t,o,a,d){(3&t[xr])===a&&c(t,o,a,d)}function i(t,o){let a=t[xr];(3&a)===o&&(a&=8191,a+=1,t[xr]=a)}function c(t,o,a,d){const x=d??-1,S=o.length-1;let k=0;for(let U=void 0!==d?65535&t[Ro]:0;U<S;U++)if("number"==typeof o[U+1]){if(k=o[U],null!=d&&k>=d)break}else o[U]<0&&(t[Ro]+=65536),(k<x||-1==x)&&(y(t,a,o,U),t[Ro]=(4294901760&t[Ro])+U+2),U++}function p(t,o){Et(4,t,o);const a=ho(null);try{o.call(t)}finally{ho(a),Et(5,t,o)}}function y(t,o,a,d){const m=a[d]<0,x=a[d+1],k=t[m?-a[d]:a[d]];m?t[xr]>>13<t[Ro]>>16&&(3&t[xr])===o&&(t[xr]+=8192,p(k,x)):p(k,x)}const w=-1;class A{constructor(o,a,d){this.factory=o,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=d}}function be(t){return t!==w}function Pe(t){return 32767&t}function Ie(t,o){let a=function se(t){return t>>16}(t),d=o;for(;a>0;)d=d[_o],a--;return d}let We=!0;function Xe(t){const o=We;return We=t,o}const Ct=255,Dt=5;let Rt=0;const Mt={};function On(t,o){const a=Tn(t,o);if(-1!==a)return a;const d=o[rr];d.firstCreatePass&&(t.injectorIndex=o.length,qt(d.data,t),qt(o,null),qt(d.blueprint,null));const m=un(t,o),x=t.injectorIndex;if(be(m)){const S=Pe(m),k=Ie(m,o),U=k[rr].data;for(let ie=0;ie<8;ie++)o[x+ie]=k[S+ie]|U[S+ie]}return o[x+8]=m,x}function qt(t,o){t.push(0,0,0,0,0,0,0,0,o)}function Tn(t,o){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===o[t.injectorIndex+8]?-1:t.injectorIndex}function un(t,o){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let a=0,d=null,m=o;for(;null!==m;){if(d=Sa(m),null===d)return w;if(a++,m=m[_o],-1!==d.injectorIndex)return d.injectorIndex|a<<16}return w}function Fn(t,o,a){!function Wt(t,o,a){let d;"string"==typeof a?d=a.charCodeAt(0)||0:a.hasOwnProperty(ui)&&(d=a[ui]),null==d&&(d=a[ui]=Rt++);const m=d&Ct;o.data[t+(m>>Dt)]|=1<<m}(t,o,a)}function En(t,o,a){if(a&fr.Optional||void 0!==t)return t;Ut()}function zn(t,o,a,d){if(a&fr.Optional&&void 0===d&&(d=null),!(a&(fr.Self|fr.Host))){const m=t[$o],x=gr(void 0);try{return m?m.get(o,d,a&fr.Optional):Ci(o,d,a&fr.Optional)}finally{gr(x)}}return En(d,0,a)}function Rn(t,o,a,d=fr.Default,m){if(null!==t){if(2048&o[xr]&&!(d&fr.Self)){const S=function zs(t,o,a,d,m){let x=t,S=o;for(;null!==x&&null!==S&&2048&S[xr]&&!(512&S[xr]);){const k=Vn(x,S,a,d|fr.Self,Mt);if(k!==Mt)return k;let U=x.parent;if(!U){const ie=S[oa];if(ie){const we=ie.get(a,Mt,d);if(we!==Mt)return we}U=Sa(S),S=S[_o]}x=U}return m}(t,o,a,d,Mt);if(S!==Mt)return S}const x=Vn(t,o,a,d,Mt);if(x!==Mt)return x}return zn(o,a,d,m)}function Vn(t,o,a,d,m){const x=function Ur(t){if("string"==typeof t)return t.charCodeAt(0)||0;const o=t.hasOwnProperty(ui)?t[ui]:void 0;return"number"==typeof o?o>=0?o&Ct:fo:o}(a);if("function"==typeof x){if(!L(o,t,d))return d&fr.Host?En(m,0,d):zn(o,a,d,m);try{let S;if(S=x(d),null!=S||d&fr.Optional)return S;Ut()}finally{_()}}else if("number"==typeof x){let S=null,k=Tn(t,o),U=w,ie=d&fr.Host?o[Ui][Ii]:null;for((-1===k||d&fr.SkipSelf)&&(U=-1===k?un(t,o):o[k+8],U!==w&&pi(d,!1)?(S=o[rr],k=Pe(U),o=Ie(U,o)):k=-1);-1!==k;){const we=o[rr];if(gi(x,k,we.data)){const rt=Ar(k,o,a,S,d,ie);if(rt!==Mt)return rt}U=o[k+8],U!==w&&pi(d,o[rr].data[k+8]===ie)&&gi(x,k,o)?(S=we,k=Pe(U),o=Ie(U,o)):k=-1}}return m}function Ar(t,o,a,d,m,x){const S=o[rr],k=S.data[t+8],we=Xr(k,S,a,null==d?gs(k)&&We:d!=S&&0!=(3&k.type),m&fr.Host&&x===k);return null!==we?dr(o,S,we,k):Mt}function Xr(t,o,a,d,m){const x=t.providerIndexes,S=o.data,k=1048575&x,U=t.directiveStart,we=x>>20,Nt=m?k+we:t.directiveEnd;for(let Qt=d?k:k+we;Qt<Nt;Qt++){const Pn=S[Qt];if(Qt<U&&a===Pn||Qt>=U&&Pn.type===a)return Qt}if(m){const Qt=S[U];if(Qt&&Xo(Qt)&&Qt.type===a)return U}return null}function dr(t,o,a,d){let m=t[a];const x=o.data;if(function O(t){return t instanceof A}(m)){const S=m;S.resolving&&function Je(t,o){const a=o?`. Dependency path: ${o.join(" > ")} > ${t}`:"";throw new Se(-200,`Circular dependency in DI detected for ${t}${a}`)}(function It(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():ht(t)}(x[a]));const k=Xe(S.canSeeViewProviders);S.resolving=!0;const ie=S.injectImpl?gr(S.injectImpl):null;L(t,d,fr.Default);try{m=t[a]=S.factory(void 0,x,t,d),o.firstCreatePass&&a>=d.directiveStart&&function ti(t,o,a){const{ngOnChanges:d,ngOnInit:m,ngDoCheck:x}=o.type.prototype;if(d){const S=Na(o);(a.preOrderHooks??=[]).push(t,S),(a.preOrderCheckHooks??=[]).push(t,S)}m&&(a.preOrderHooks??=[]).push(0-t,m),x&&((a.preOrderHooks??=[]).push(t,x),(a.preOrderCheckHooks??=[]).push(t,x))}(a,x[a],o)}finally{null!==ie&&gr(ie),Xe(k),S.resolving=!1,_()}}return m}function gi(t,o,a){return!!(a[o+(t>>Dt)]&1<<t)}function pi(t,o){return!(t&fr.Self||t&fr.Host&&o)}class _i{constructor(o,a){this._tNode=o,this._lView=a}get(o,a,d){return Rn(this._tNode,this._lView,o,hr(d),a)}}function fo(){return new _i(ds(),Nn())}function lo(t){return rn(()=>{const o=t.prototype.constructor,a=o[Qr]||Ns(o),d=Object.prototype;let m=Object.getPrototypeOf(t.prototype).constructor;for(;m&&m!==d;){const x=m[Qr]||Ns(m);if(x&&x!==a)return x;m=Object.getPrototypeOf(m)}return x=>new x})}function Ns(t){return _t(t)?()=>{const o=Ns(vt(t));return o&&o()}:Ko(t)}function Sa(t){const o=t[rr],a=o.type;return 2===a?o.declTNode:1===a?t[Ii]:null}function Ua(t){return function nn(t,o){if("class"===o)return t.classes;if("style"===o)return t.styles;const a=t.attrs;if(a){const d=a.length;let m=0;for(;m<d;){const x=a[m];if(io(x))break;if(0===x)m+=2;else if("number"==typeof x)for(m++;m<d&&"string"==typeof a[m];)m++;else{if(x===o)return a[m+1];m+=2}}}return null}(ds(),t)}const ji="__parameters__";function no(t,o,a){return rn(()=>{const d=function Zs(t){return function(...a){if(t){const d=t(...a);for(const m in d)this[m]=d[m]}}}(o);function m(...x){if(this instanceof m)return d.apply(this,x),this;const S=new m(...x);return k.annotation=S,k;function k(U,ie,we){const rt=U.hasOwnProperty(ji)?U[ji]:Object.defineProperty(U,ji,{value:[]})[ji];for(;rt.length<=we;)rt.push(null);return(rt[we]=rt[we]||[]).push(S),U}}return a&&(m.prototype=Object.create(a.prototype)),m.prototype.ngMetadataName=t,m.annotationCls=m,m})}function Lc(t,o){t.forEach(a=>Array.isArray(a)?Lc(a,o):o(a))}function yd(t,o,a){o>=t.length?t.push(a):t.splice(o,0,a)}function dl(t,o){return o>=t.length-1?t.pop():t.splice(o,1)[0]}function Fc(t,o){const a=[];for(let d=0;d<t;d++)a.push(o);return a}function Ja(t,o,a){let d=Ql(t,o);return d>=0?t[1|d]=a:(d=~d,function E_(t,o,a,d){let m=t.length;if(m==o)t.push(a,d);else if(1===m)t.push(d,t[0]),t[0]=a;else{for(m--,t.push(t[m-1],t[m]);m>o;)t[m]=t[m-2],m--;t[o]=a,t[o+1]=d}}(t,d,o,a)),d}function vd(t,o){const a=Ql(t,o);if(a>=0)return t[1|a]}function Ql(t,o){return function ec(t,o,a){let d=0,m=t.length>>a;for(;m!==d;){const x=d+(m-d>>1),S=t[x<<a];if(o===S)return x<<a;S>o?m=x:d=x+1}return~(m<<a)}(t,o,1)}const Lf=Wr(no("Inject",t=>({token:t})),-1),bd=Wr(no("Optional"),8),Ch=Wr(no("SkipSelf"),4);function Cd(t){return 128==(128&t.flags)}var kh=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(kh||{});const bm=/^>|^->|<!--|-->|--!>|<!-$/g,wm=/(<|>)/,Td="\u200b$1\u200b";const Sd=new Map;let Vf=0;const Ha="__ngContext__";function ma(t,o){Bi(o)?(t[Ha]=o[jo],function Uf(t){Sd.set(t[jo],t)}(o)):t[Ha]=o}let Vc;function Uc(t,o){return Vc(t,o)}function jc(t){const o=t[Si];return Zi(o)?o[Si]:o}function Bh(t){return _u(t[ks])}function Zf(t){return _u(t[Io])}function _u(t){for(;null!==t&&!Zi(t);)t=t[Io];return t}function yu(t,o,a,d,m){if(null!=d){let x,S=!1;Zi(d)?x=d:Bi(d)&&(S=!0,d=d[Oi]);const k=Dr(d);0===t&&null!==a?null==m?Jf(o,a,k):yc(o,a,k,m||null,!0):1===t&&null!==a?yc(o,a,k,m||null,!0):2===t?function qu(t,o,a){const d=Pd(t,o);d&&function M_(t,o,a,d){t.removeChild(o,a,d)}(t,d,o,a)}(o,k,S):3===t&&o.destroyNode(k),null!=x&&function Rm(t,o,a,d,m){const x=a[Ho];x!==Dr(a)&&yu(o,t,d,x,m);for(let k=so;k<a.length;k++){const U=a[k];Zu(U[rr],U,t,o,d,x)}}(o,t,x,a,m)}}function Xf(t,o){return t.createComment(function Lh(t){return t.replace(bm,o=>o.replace(wm,Td))}(o))}function Nh(t,o,a){return t.createElement(o,a)}function Rl(t,o){const a=t[uo],d=a.indexOf(o);Gl(o),a.splice(d,1)}function Ga(t,o){if(t.length<=so)return;const a=so+o,d=t[a];if(d){const m=d[es];null!==m&&m!==t&&Rl(m,d),o>0&&(t[a-1][Io]=d[Io]);const x=dl(t,so+o);!function Ad(t,o){Zu(t,o,o[Mr],2,null,null),o[Oi]=null,o[Ii]=null}(d[rr],d);const S=x[Uo];null!==S&&S.detachView(x[rr]),d[Si]=null,d[Io]=null,d[xr]&=-129}return d}function Aa(t,o){if(!(256&o[xr])){const a=o[Mr];o[ts]?.destroy(),o[ns]?.destroy(),a.destroyNode&&Zu(t,o,a,3,null,null),function po(t){let o=t[ks];if(!o)return Us(t[rr],t);for(;o;){let a=null;if(Bi(o))a=o[ks];else{const d=o[so];d&&(a=d)}if(!a){for(;o&&!o[Io]&&o!==t;)Bi(o)&&Us(o[rr],o),o=o[Si];null===o&&(o=t),Bi(o)&&Us(o[rr],o),a=o&&o[Io]}o=a}}(o)}}function Us(t,o){if(!(256&o[xr])){o[xr]&=-129,o[xr]|=256,function ia(t,o){let a;if(null!=t&&null!=(a=t.destroyHooks))for(let d=0;d<a.length;d+=2){const m=o[a[d]];if(!(m instanceof A)){const x=a[d+1];if(Array.isArray(x))for(let S=0;S<x.length;S+=2){const k=m[x[S]],U=x[S+1];Et(4,k,U);try{U.call(k)}finally{Et(5,k,U)}}else{Et(4,m,x);try{x.call(m)}finally{Et(5,m,x)}}}}}(t,o),function Im(t,o){const a=t.cleanup,d=o[Ms];if(null!==a)for(let x=0;x<a.length-1;x+=2)if("string"==typeof a[x]){const S=a[x+3];S>=0?d[S]():d[-S].unsubscribe(),x+=2}else a[x].call(d[a[x+1]]);null!==d&&(o[Ms]=null);const m=o[ms];if(null!==m){o[ms]=null;for(let x=0;x<m.length;x++)(0,m[x])()}}(t,o),1===o[rr].type&&o[Mr].destroy();const a=o[es];if(null!==a&&Zi(o[Si])){a!==o[Si]&&Rl(a,o);const d=o[Uo];null!==d&&d.detachView(t)}!function nc(t){Sd.delete(t[jo])}(o)}}function zh(t,o,a){return function vu(t,o,a){let d=o;for(;null!==d&&40&d.type;)d=(o=d).parent;if(null===d)return a[Oi];{const{componentOffset:m}=d;if(m>-1){const{encapsulation:x}=t.data[d.directiveStart+m];if(x===Dn.None||x===Dn.Emulated)return null}return Br(d,a)}}(t,o.parent,a)}function yc(t,o,a,d,m){t.insertBefore(o,a,d,m)}function Jf(t,o,a){t.appendChild(o,a)}function $h(t,o,a,d,m){null!==d?yc(t,o,a,d,m):Jf(t,o,a)}function Pd(t,o){return t.parentNode(o)}function ic(t,o,a){return Rd(t,o,a)}let Wu,rp,Nd,Rd=function Gc(t,o,a){return 40&t.type?Br(t,a):null};function Od(t,o,a,d){const m=zh(t,d,o),x=o[Mr],k=ic(d.parent||o[Ii],d,o);if(null!=m)if(Array.isArray(a))for(let U=0;U<a.length;U++)$h(x,m,a[U],k,!1);else $h(x,m,a,k,!1);void 0!==Wu&&Wu(x,d,o,a,m)}function kd(t,o){if(null!==o){const a=o.type;if(3&a)return Br(o,t);if(4&a)return ep(-1,t[o.index]);if(8&a){const d=o.child;if(null!==d)return kd(t,d);{const m=t[o.index];return Zi(m)?ep(-1,m):Dr(m)}}if(32&a)return Uc(o,t)()||Dr(t[o.index]);{const d=Qf(t,o);return null!==d?Array.isArray(d)?d[0]:kd(jc(t[Ui]),d):kd(t,o.next)}}return null}function Qf(t,o){return null!==o?t[Ui][Ii].projection[o.projection]:null}function ep(t,o){const a=so+t+1;if(a<o.length){const d=o[a],m=d[rr].firstChild;if(null!==m)return kd(d,m)}return o[Ho]}function Ld(t,o,a,d,m,x,S){for(;null!=a;){const k=d[a.index],U=a.type;if(S&&0===o&&(k&&ma(Dr(k),d),a.flags|=2),32!=(32&a.flags))if(8&U)Ld(t,o,a.child,d,m,x,!1),yu(o,t,m,k,x);else if(32&U){const ie=Uc(a,d);let we;for(;we=ie();)yu(o,t,m,we,x);yu(o,t,m,k,x)}else 16&U?Wc(t,o,d,a,m,x):yu(o,t,m,k,x);a=S?a.projectionNext:a.next}}function Zu(t,o,a,d,m,x){Ld(a,d,t.firstChild,o,m,x,!1)}function Wc(t,o,a,d,m,x){const S=a[Ui],U=S[Ii].projection[d.projection];if(Array.isArray(U))for(let ie=0;ie<U.length;ie++)yu(o,t,m,U[ie],x);else{let ie=U;const we=S[Si];Cd(d)&&(ie.flags|=128),Ld(t,o,ie,we,m,x,!0)}}function Fd(t,o,a){""===a?t.removeAttribute(o,"class"):t.setAttribute(o,"class",a)}function tp(t,o,a){const{mergedAttrs:d,classes:m,styles:x}=a;null!==d&&cn(t,o,d),null!==m&&Fd(t,o,m),null!==x&&function Yu(t,o,a){t.setAttribute(o,"style",a)}(t,o,x)}function km(t){rp=t}function Lm(t){return function zd(){if(void 0===Nd&&(Nd=null,Sr.trustedTypes))try{Nd=Sr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Nd}()?.createScriptURL(t)||t}class Uh{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ft})`}}function vc(t){return t instanceof Uh?t.changingThisBreaksApplicationSecurity:t}function Ol(t,o){const a=function $d(t){return t instanceof Uh&&t.getTypeName()||null}(t);if(null!=a&&a!==o){if("ResourceURL"===a&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${a} (see ${Ft})`)}return a===o}const Ku=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ed=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(ed||{});function Um(t){const o=nd();return o?o.sanitize(ed.URL,t)||"":Ol(t,"URL")?vc(t):function sp(t){return(t=String(t)).match(Ku)?t:"unsafe:"+t}(ht(t))}function jm(t){const o=nd();if(o)return Lm(o.sanitize(ed.RESOURCE_URL,t)||"");if(Ol(t,"ResourceURL"))return Lm(vc(t));throw new Se(904,!1)}function Gm(t,o,a){return function td(t,o){return"src"===o&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===o&&("base"===t||"link"===t)?jm:Um}(o,a)(t)}function nd(){const t=Nn();return t&&t[Vo].sanitizer}class mo{constructor(o,a){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=an({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Gd=new mo("ENVIRONMENT_INITIALIZER"),Wm=new mo("INJECTOR",-1),qm=new mo("INJECTOR_DEF_TYPES");class Wd{get(o,a=kt){if(a===kt){const d=new Error(`NullInjectorError: No provider for ${Ze(o)}!`);throw d.name="NullInjectorError",d}return a}}function rd(t){return{\u0275providers:t}}function Wh(...t){return{\u0275providers:Zm(0,t),\u0275fromNgModule:!0}}function Zm(t,...o){const a=[],d=new Set;let m;const x=S=>{a.push(S)};return Lc(o,S=>{const k=S;Zc(k,x,[],d)&&(m||=[],m.push(k))}),void 0!==m&&Ym(m,x),a}function Ym(t,o){for(let a=0;a<t.length;a++){const{ngModule:d,providers:m}=t[a];Zh(m,x=>{o(x,d)})}}function Zc(t,o,a,d){if(!(t=vt(t)))return!1;let m=null,x=Lr(t);const S=!x&&jr(t);if(x||S){if(S&&!S.standalone)return!1;m=t}else{const U=t.ngModule;if(x=Lr(U),!x)return!1;m=U}const k=d.has(m);if(S){if(k)return!1;if(d.add(m),S.dependencies){const U="function"==typeof S.dependencies?S.dependencies():S.dependencies;for(const ie of U)Zc(ie,o,a,d)}}else{if(!x)return!1;{if(null!=x.imports&&!k){let ie;d.add(m);try{Lc(x.imports,we=>{Zc(we,o,a,d)&&(ie||=[],ie.push(we))})}finally{}void 0!==ie&&Ym(ie,o)}if(!k){const ie=Ko(m)||(()=>new m);o({provide:m,useFactory:ie,deps:Zn},m),o({provide:qm,useValue:m,multi:!0},m),o({provide:Gd,useValue:()=>vn(m),multi:!0},m)}const U=x.providers;if(null!=U&&!k){const ie=t;Zh(U,we=>{o(we,ie)})}}}return m!==t&&void 0!==t.providers}function Zh(t,o){for(let a of t)nt(a)&&(a=a.\u0275providers),Array.isArray(a)?Zh(a,o):o(a)}const qd=xe({provide:String,useValue:xe});function Yh(t){return null!==t&&"object"==typeof t&&qd in t}function Yc(t){return"function"==typeof t}const Xh=new mo("Set Injector scope."),Zd={},Jm={};let dp;function Kh(){return void 0===dp&&(dp=new Wd),dp}class kl{}class wu extends kl{get destroyed(){return this._destroyed}constructor(o,a,d,m){super(),this.parent=a,this.source=d,this.scopes=m,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hp(o,S=>this.processProvider(S)),this.records.set(Wm,sc(void 0,this)),m.has("environment")&&this.records.set(kl,sc(void 0,this));const x=this.records.get(Xh);null!=x&&"string"==typeof x.value&&this.scopes.add(x.value),this.injectorDefTypes=new Set(this.get(qm.multi,Zn,fr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const a of this._ngOnDestroyHooks)a.ngOnDestroy();const o=this._onDestroyHooks;this._onDestroyHooks=[];for(const a of o)a()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(o){return this.assertNotDestroyed(),this._onDestroyHooks.push(o),()=>this.removeOnDestroy(o)}runInContext(o){this.assertNotDestroyed();const a=ot(this),d=gr(void 0);try{return o()}finally{ot(a),gr(d)}}get(o,a=kt,d=fr.Default){if(this.assertNotDestroyed(),o.hasOwnProperty(qr))return o[qr](this);d=hr(d);const x=ot(this),S=gr(void 0);try{if(!(d&fr.SkipSelf)){let U=this.records.get(o);if(void 0===U){const ie=function q_(t){return"function"==typeof t||"object"==typeof t&&t instanceof mo}(o)&&mr(o);U=ie&&this.injectableDefInScope(ie)?sc(Jh(o),Zd):null,this.records.set(o,U)}if(null!=U)return this.hydrate(o,U)}return(d&fr.Self?Kh():this.parent).get(o,a=d&fr.Optional&&a===kt?null:a)}catch(k){if("NullInjectorError"===k.name){if((k[Vt]=k[Vt]||[]).unshift(Ze(o)),x)throw k;return function ro(t,o,a,d){const m=t[Vt];throw o[de]&&m.unshift(o[de]),t.message=function Bo(t,o,a,d=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let m=Ze(o);if(Array.isArray(o))m=o.map(Ze).join(" -> ");else if("object"==typeof o){let x=[];for(let S in o)if(o.hasOwnProperty(S)){let k=o[S];x.push(S+":"+("string"==typeof k?JSON.stringify(k):Ze(k)))}m=`{${x.join(", ")}}`}return`${a}${d?"("+d+")":""}[${m}]: ${t.replace(Be,"\n  ")}`}("\n"+t.message,m,a,d),t.ngTokenPath=m,t[Vt]=null,t}(k,o,"R3InjectorError",this.source)}throw k}finally{gr(S),ot(x)}}resolveInjectorInitializers(){const o=ot(this),a=gr(void 0);try{const m=this.get(Gd.multi,Zn,fr.Self);for(const x of m)x()}finally{ot(o),gr(a)}}toString(){const o=[],a=this.records;for(const d of a.keys())o.push(Ze(d));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Se(205,!1)}processProvider(o){let a=Yc(o=vt(o))?o:vt(o&&o.provide);const d=function Yd(t){return Yh(t)?sc(void 0,t.useValue):sc(Eu(t),Zd)}(o);if(Yc(o)||!0!==o.multi)this.records.get(a);else{let m=this.records.get(a);m||(m=sc(void 0,Zd,!0),m.factory=()=>vr(m.multi),this.records.set(a,m)),a=o,m.multi.push(o)}this.records.set(a,d)}hydrate(o,a){return a.value===Zd&&(a.value=Jm,a.value=a.factory()),"object"==typeof a.value&&a.value&&function eg(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(a.value)&&this._ngOnDestroyHooks.add(a.value),a.value}injectableDefInScope(o){if(!o.providedIn)return!1;const a=vt(o.providedIn);return"string"==typeof a?"any"===a||this.scopes.has(a):this.injectorDefTypes.has(a)}removeOnDestroy(o){const a=this._onDestroyHooks.indexOf(o);-1!==a&&this._onDestroyHooks.splice(a,1)}}function Jh(t){const o=mr(t),a=null!==o?o.factory:Ko(t);if(null!==a)return a;if(t instanceof mo)throw new Se(204,!1);if(t instanceof Function)return function ga(t){const o=t.length;if(o>0)throw Fc(o,"?"),new Se(204,!1);const a=function Kn(t){return t&&(t[bn]||t[Fi])||null}(t);return null!==a?()=>a.factory(t):()=>new t}(t);throw new Se(204,!1)}function Eu(t,o,a){let d;if(Yc(t)){const m=vt(t);return Ko(m)||Jh(m)}if(Yh(t))d=()=>vt(t.useValue);else if(function up(t){return!(!t||!t.useFactory)}(t))d=()=>t.useFactory(...vr(t.deps||[]));else if(function Xm(t){return!(!t||!t.useExisting)}(t))d=()=>vn(vt(t.useExisting));else{const m=vt(t&&(t.useClass||t.provide));if(!function Qm(t){return!!t.deps}(t))return Ko(m)||Jh(m);d=()=>new m(...vr(t.deps))}return d}function sc(t,o,a=!1){return{factory:t,value:o,multi:a?[]:void 0}}function hp(t,o){for(const a of t)Array.isArray(a)?hp(a,o):a&&nt(a)?hp(a.\u0275providers,o):o(a)}const tg=new mo("AppId",{providedIn:"root",factory:()=>Z_}),Z_="ng",ng=new mo("Platform Initializer"),fp=new mo("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Y_=new mo("AnimationModuleType"),rg=new mo("CSP nonce",{providedIn:"root",factory:()=>function xu(){if(void 0!==rp)return rp;if(typeof document<"u")return document;throw new Se(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let xp=(t,o,a)=>null;function Kd(t,o,a=!1){return xp(t,o,a)}class Q_{}class ug{}class dg{resolveComponentFactory(o){throw function ey(t){const o=Error(`No component factory found for ${Ze(t)}.`);return o.ngComponent=t,o}(o)}}let Kc=(()=>{class o{}return o.NULL=new dg,o})();function Dp(){return od(ds(),Nn())}function od(t,o){return new th(Br(t,o))}let th=(()=>{class o{constructor(d){this.nativeElement=d}}return o.__NG_ELEMENT_ID__=Dp,o})();function ty(t){return t instanceof th?t.nativeElement:t}class Cp{}let Tp=(()=>{class o{constructor(){this.destroyNode=null}}return o.__NG_ELEMENT_ID__=()=>function Oa(){const t=Nn(),a=ko(ds().index,t);return(Bi(a)?a:t)[Mr]}(),o})(),Sp=(()=>{var t;class o{}return(t=o).\u0275prov=an({token:t,providedIn:"root",factory:()=>null}),o})();class Ip{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Wa=new Ip("16.2.0"),sf={};function Ap(t,o=null,a=null,d){const m=_g(t,o,a,d);return m.resolveInjectorInitializers(),m}function _g(t,o=null,a=null,d,m=new Set){const x=[a||Zn,Wh(t)];return d=d||("object"==typeof t?void 0:Ze(t)),new wu(x,o||Kh(),d||null,m)}let fl=(()=>{var t;class o{static create(d,m){if(Array.isArray(d))return Ap({name:""},m,d,"");{const x=d.name??"";return Ap({name:x},d.parent,d.providers,x)}}}return(t=o).THROW_IF_NOT_FOUND=kt,t.NULL=new Wd,t.\u0275prov=an({token:t,providedIn:"any",factory:()=>vn(Wm)}),t.__NG_ELEMENT_ID__=-1,o})();function ac(t){return t instanceof Function?t():t}let el=(()=>{var t;class o{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new Se(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const d of this.callbacks)d.invoke()}finally{this.runningCallbacks=!1;for(const d of this.deferredCallbacks)this.callbacks.add(d);this.deferredCallbacks.clear()}}register(d){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(d)}unregister(d){this.callbacks.delete(d),this.deferredCallbacks.delete(d)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(t=o).\u0275prov=an({token:t,providedIn:"root",factory:()=>new t}),o})();function Su(t){for(;t;){t[xr]|=64;const o=jc(t);if(sa(t)&&!o)return t;t=o}return null}function uf(t){return t.ngOriginalError}class bc{constructor(){this._console=console}handleError(o){const a=this._findOriginalError(o);this._console.error("ERROR",o),a&&this._console.error("ORIGINAL ERROR",a)}_findOriginalError(o){let a=o&&uf(o);for(;a&&uf(a);)a=uf(a);return a||null}}const sh=new mo("",{providedIn:"root",factory:()=>!1});class Sg extends Fs{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(o){this._lView=o}onConsumerDependencyMayHaveChanged(){Su(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(o,a,d){const m=ho(this);this.trackingVersion++;try{o(a,d)}finally{ho(m)}}destroy(){this.trackingVersion++}}let Qc=null;function wc(){return Qc??=new Sg,Qc}function Op(t,o){return t[o]??wc()}function kp(t,o){const a=wc();a.hasReadASignal&&(t[o]=Qc,a.lView=t,Qc=new Sg)}const mi={};function df(t){Ig(ri(),Nn(),oe()+t,!1)}function Ig(t,o,a,d){if(!d)if(3==(3&o[xr])){const x=t.preOrderCheckHooks;null!==x&&zi(o,x,a)}else{const x=t.preOrderHooks;null!==x&&h(o,x,0,a)}ge(a)}function Mu(t,o=fr.Default){const a=Nn();return null===a?vn(t,o):Rn(ds(),a,vt(t),o)}function eu(){throw new Error("invalid")}function Fl(t,o,a,d,m,x,S,k,U,ie,we){const rt=o.blueprint.slice();return rt[Oi]=m,rt[xr]=140|d,(null!==ie||t&&2048&t[xr])&&(rt[xr]|=2048),Cs(rt),rt[Si]=rt[_o]=t,rt[eo]=a,rt[Vo]=S||t&&t[Vo],rt[Mr]=k||t&&t[Mr],rt[$o]=U||t&&t[$o]||null,rt[Ii]=x,rt[jo]=function pa(){return Vf++}(),rt[cs]=we,rt[oa]=ie,rt[Ui]=2==o.type?t[Ui]:rt,rt}function ld(t,o,a,d,m){let x=t.data[o];if(null===x)x=function Au(t,o,a,d,m){const x=Dl(),S=Yl(),U=t.data[o]=function Rg(t,o,a,d,m,x){let S=o?o.injectorIndex:-1,k=0;return Da()&&(k|=128),{type:a,index:d,insertBeforeIndex:null,injectorIndex:S,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:k,providerIndexes:0,value:m,attrs:x,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,S?x:x&&x.parent,a,o,d,m);return null===t.firstChild&&(t.firstChild=U),null!==x&&(S?null==x.child&&null!==U.parent&&(x.child=U):null===x.next&&(x.next=U,U.prev=x)),U}(t,o,a,d,m),function Pc(){return ei.lFrame.inI18n}()&&(x.flags|=32);else if(64&x.type){x.type=a,x.value=d,x.attrs=m;const S=function $a(){const t=ei.lFrame,o=t.currentTNode;return t.isParent?o:o.parent}();x.injectorIndex=null===S?-1:S.injectorIndex}return na(x,!0),x}function Ec(t,o,a,d){if(0===a)return-1;const m=o.length;for(let x=0;x<a;x++)o.push(d),t.blueprint.push(d),t.data.push(null);return m}function cd(t,o,a,d,m){const x=Op(o,ts),S=oe(),k=2&d;try{if(ge(-1),k&&o.length>er&&Ig(t,o,er,!1),Et(k?2:0,m),k)x.runInContext(a,d,m);else{const ie=ho(null);try{a(d,m)}finally{ho(ie)}}}finally{k&&null===o[ts]&&kp(o,ts),ge(S),Et(k?3:1,m)}}function Pu(t,o,a){if(Hs(o)){const d=ho(null);try{const x=o.directiveEnd;for(let S=o.directiveStart;S<x;S++){const k=t.data[S];k.contentQueries&&k.contentQueries(1,a[S],S)}}finally{ho(d)}}}function ud(t,o,a){Wl()&&(function Np(t,o,a,d){const m=a.directiveStart,x=a.directiveEnd;gs(a)&&function ch(t,o,a){const d=Br(o,t),m=Mg(a);let S=16;a.signals?S=4096:a.onPush&&(S=64);const k=Nl(t,Fl(t,m,null,S,d,o,null,t[Vo].rendererFactory.createRenderer(d,a),null,null,null));t[o.index]=k}(o,a,t.data[m+a.componentOffset]),t.firstCreatePass||On(a,o),ma(d,o);const S=a.initialInputs;for(let k=m;k<x;k++){const U=t.data[k],ie=dr(o,t,k,a);ma(ie,o),null!==S&&kg(0,k-m,ie,U,0,S),Xo(U)&&(ko(a.index,o)[eo]=dr(o,t,k,a))}}(t,o,a,Br(a,o)),64==(64&a.flags)&&zp(t,o,a))}function Lp(t,o,a=Br){const d=o.localNames;if(null!==d){let m=o.index+1;for(let x=0;x<d.length;x+=2){const S=d[x+1],k=-1===S?a(o,t):t[S];t[m++]=k}}}function Mg(t){const o=t.tView;return null===o||o.incompleteFirstPass?t.tView=tu(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):o}function tu(t,o,a,d,m,x,S,k,U,ie,we){const rt=er+d,Nt=rt+m,Qt=function hf(t,o){const a=[];for(let d=0;d<o;d++)a.push(d<t?null:mi);return a}(rt,Nt),Pn="function"==typeof ie?ie():ie;return Qt[rr]={type:t,blueprint:Qt,template:a,queries:null,viewQuery:k,declTNode:o,data:Qt.slice().fill(null,rt),bindingStartIndex:rt,expandoStartIndex:Nt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof x?x():x,pipeRegistry:"function"==typeof S?S():S,firstChild:null,schemas:U,consts:Pn,incompleteFirstPass:!1,ssrId:we}}let Fp=t=>null;function Og(t,o,a,d){for(let m in t)if(t.hasOwnProperty(m)){a=null===a?{}:a;const x=t[m];null===d?Bp(a,o,m,x):d.hasOwnProperty(m)&&Bp(a,o,d[m],x)}return a}function Bp(t,o,a,d){t.hasOwnProperty(a)?t[a].push(o,d):t[a]=[o,d]}function _a(t,o,a,d,m,x,S,k){const U=Br(o,a);let we,ie=o.inputs;!k&&null!=ie&&(we=ie[d])?(dh(t,a,we,d,m),gs(o)&&function ff(t,o){const a=ko(o,t);16&a[xr]||(a[xr]|=64)}(a,o.index)):3&o.type&&(d=function fy(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(d),m=null!=S?S(m,o.value||"",d):m,x.setProperty(U,d,m))}function lh(t,o,a,d){if(Wl()){const m=null===d?null:{"":-1},x=function my(t,o){const a=t.directiveRegistry;let d=null,m=null;if(a)for(let x=0;x<a.length;x++){const S=a[x];if(je(o,S.selectors,!1))if(d||(d=[]),Xo(S))if(null!==S.findHostDirectiveDefs){const k=[];m=m||new Map,S.findHostDirectiveDefs(S,k,m),d.unshift(...k,S),$p(t,o,k.length)}else d.unshift(S),$p(t,o,0);else m=m||new Map,S.findHostDirectiveDefs?.(S,d,m),d.push(S)}return null===d?null:[d,m]}(t,a);let S,k;null===x?S=k=null:[S,k]=x,null!==S&&mf(t,o,a,S,m,k),m&&function gy(t,o,a){if(o){const d=t.localNames=[];for(let m=0;m<o.length;m+=2){const x=a[o[m+1]];if(null==x)throw new Se(-301,!1);d.push(o[m],x)}}}(a,d,m)}a.mergedAttrs=oi(a.mergedAttrs,a.attrs)}function mf(t,o,a,d,m,x){for(let ie=0;ie<d.length;ie++)Fn(On(a,o),t,d[ie].type);!function Vp(t,o,a){t.flags|=1,t.directiveStart=o,t.directiveEnd=o+a,t.providerIndexes=o}(a,t.data.length,d.length);for(let ie=0;ie<d.length;ie++){const we=d[ie];we.providersResolver&&we.providersResolver(we)}let S=!1,k=!1,U=Ec(t,o,d.length,null);for(let ie=0;ie<d.length;ie++){const we=d[ie];a.mergedAttrs=oi(a.mergedAttrs,we.hostAttrs),yy(t,a,o,U,we),_y(U,we,m),null!==we.contentQueries&&(a.flags|=4),(null!==we.hostBindings||null!==we.hostAttrs||0!==we.hostVars)&&(a.flags|=64);const rt=we.type.prototype;!S&&(rt.ngOnChanges||rt.ngOnInit||rt.ngDoCheck)&&((t.preOrderHooks??=[]).push(a.index),S=!0),!k&&(rt.ngOnChanges||rt.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(a.index),k=!0),U++}!function hy(t,o,a){const m=o.directiveEnd,x=t.data,S=o.attrs,k=[];let U=null,ie=null;for(let we=o.directiveStart;we<m;we++){const rt=x[we],Nt=a?a.get(rt):null,Pn=Nt?Nt.outputs:null;U=Og(rt.inputs,we,U,Nt?Nt.inputs:null),ie=Og(rt.outputs,we,ie,Pn);const Jn=null===U||null===S||Po(o)?null:Fg(U,we,S);k.push(Jn)}null!==U&&(U.hasOwnProperty("class")&&(o.flags|=8),U.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=k,o.inputs=U,o.outputs=ie}(t,a,x)}function zp(t,o,a){const d=a.directiveStart,m=a.directiveEnd,x=a.index,S=function md(){return ei.lFrame.currentDirectiveIndex}();try{ge(x);for(let k=d;k<m;k++){const U=t.data[k],ie=o[k];Kl(k),(null!==U.hostBindings||0!==U.hostVars||null!==U.hostAttrs)&&gf(U,ie)}}finally{ge(-1),Kl(S)}}function gf(t,o){null!==t.hostBindings&&t.hostBindings(1,o)}function $p(t,o,a){o.componentOffset=a,(t.components??=[]).push(o.index)}function _y(t,o,a){if(a){if(o.exportAs)for(let d=0;d<o.exportAs.length;d++)a[o.exportAs[d]]=t;Xo(o)&&(a[""]=t)}}function yy(t,o,a,d,m){t.data[d]=m;const x=m.factory||(m.factory=Ko(m.type)),S=new A(x,Xo(m),Mu);t.blueprint[d]=S,a[d]=S,function nu(t,o,a,d,m){const x=m.hostBindings;if(x){let S=t.hostBindingOpCodes;null===S&&(S=t.hostBindingOpCodes=[]);const k=~o.index;(function py(t){let o=t.length;for(;o>0;){const a=t[--o];if("number"==typeof a&&a<0)return a}return 0})(S)!=k&&S.push(k),S.push(a,d,x)}}(t,o,d,Ec(t,a,m.hostVars,mi),m)}function lc(t,o,a,d,m,x){const S=Br(t,o);!function Up(t,o,a,d,m,x,S){if(null==x)t.removeAttribute(o,m,a);else{const k=null==S?ht(x):S(x,d||"",m);t.setAttribute(o,m,k,a)}}(o[Mr],S,x,t.value,a,d,m)}function kg(t,o,a,d,m,x){const S=x[o];if(null!==S)for(let k=0;k<S.length;)Lg(d,a,S[k++],S[k++],S[k++])}function Lg(t,o,a,d,m){const x=ho(null);try{const S=t.inputTransforms;null!==S&&S.hasOwnProperty(d)&&(m=S[d].call(o,m)),null!==t.setInput?t.setInput(o,m,a,d):o[d]=m}finally{ho(x)}}function Fg(t,o,a){let d=null,m=0;for(;m<a.length;){const x=a[m];if(0!==x)if(5!==x){if("number"==typeof x)break;if(t.hasOwnProperty(x)){null===d&&(d=[]);const S=t[x];for(let k=0;k<S.length;k+=2)if(S[k]===o){d.push(x,S[k+1],a[m+1]);break}}m+=2}else m+=2;else m+=4}return d}function tl(t,o,a,d){return[t,!0,!1,o,null,0,d,a,null,null,null]}function Bl(t,o){const a=t.contentQueries;if(null!==a)for(let d=0;d<a.length;d+=2){const x=a[d+1];if(-1!==x){const S=t.data[x];qs(a[d]),S.contentQueries(2,o[x],x)}}}function Nl(t,o){return t[ks]?t[ls][Io]=o:t[ks]=o,t[ls]=o,o}function pl(t,o,a){qs(0);const d=ho(null);try{o(t,a)}finally{ho(d)}}function uh(t){return t[Ms]||(t[Ms]=[])}function jp(t){return t.cleanup||(t.cleanup=[])}function Gp(t,o){const a=t[$o],d=a?a.get(bc,null):null;d&&d.handleError(o)}function dh(t,o,a,d,m){for(let x=0;x<a.length;){const S=a[x++],k=a[x++];Lg(t.data[S],o[S],d,k,m)}}function Bg(t,o){const a=ko(o,t),d=a[rr];!function Ng(t,o){for(let a=o.length;a<t.blueprint.length;a++)o.push(t.blueprint[a])}(d,a);const m=a[Oi];null!==m&&null===a[cs]&&(a[cs]=Kd(m,a[$o])),_f(d,a,a[eo])}function _f(t,o,a){z(o);try{const d=t.viewQuery;null!==d&&pl(1,d,a);const m=t.template;null!==m&&cd(t,o,m,1,a),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Bl(t,o),t.staticViewQueries&&pl(2,t.viewQuery,a);const x=t.components;null!==x&&function zg(t,o){for(let a=0;a<o.length;a++)Bg(t,o[a])}(o,x)}catch(d){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),d}finally{o[xr]&=-5,E()}}let Wp=(()=>{var t;class o{constructor(){this.all=new Set,this.queue=new Map}create(d,m,x){const S=typeof Zone>"u"?null:Zone.current,k=new Ea(d,we=>{this.all.has(we)&&this.queue.set(we,S)},x);let U;this.all.add(k),k.notify();const ie=()=>{k.cleanup(),U?.(),this.all.delete(k),this.queue.delete(k)};return U=m?.onDestroy(ie),{destroy:ie}}flush(){if(0!==this.queue.size)for(const[d,m]of this.queue)this.queue.delete(d),m?m.run(()=>d.run()):d.run()}get isQueueEmpty(){return 0===this.queue.size}}return(t=o).\u0275prov=an({token:t,providedIn:"root",factory:()=>new t}),o})();function hh(t,o,a){let d=a?t.styles:null,m=a?t.classes:null,x=0;if(null!==o)for(let S=0;S<o.length;S++){const k=o[S];"number"==typeof k?x=k:1==x?m=tt(m,k):2==x&&(d=tt(d,k+": "+o[++S]+";"))}a?t.styles=d:t.stylesWithoutHost=d,a?t.classes=m:t.classesWithoutHost=m}function ml(t,o,a,d,m=!1){for(;null!==a;){const x=o[a.index];if(null!==x&&d.push(Dr(x)),Zi(x)){for(let k=so;k<x.length;k++){const U=x[k],ie=U[rr].firstChild;null!==ie&&ml(U[rr],U,ie,d)}x[Ho]!==x[Oi]&&d.push(x[Ho])}const S=a.type;if(8&S)ml(t,o,a.child,d);else if(32&S){const k=Uc(a,o);let U;for(;U=k();)d.push(U)}else if(16&S){const k=Qf(o,a);if(Array.isArray(k))d.push(...k);else{const U=jc(o[Ui]);ml(U[rr],U,k,d,!0)}}a=m?a.projectionNext:a.next}return d}function fh(t,o,a,d=!0){const m=o[Vo],x=m.rendererFactory,S=m.afterRenderEventManager;x.begin?.(),S?.begin();try{ph(t,o,t.template,a)}catch(U){throw d&&Gp(o,U),U}finally{x.end?.(),m.effectManager?.flush(),S?.end()}}function ph(t,o,a,d){const m=o[xr];if(256!=(256&m)){o[Vo].effectManager?.flush(),z(o);try{Cs(o),function Cl(t){return ei.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==a&&cd(t,o,a,2,d);const S=3==(3&m);if(S){const ie=t.preOrderCheckHooks;null!==ie&&zi(o,ie,null)}else{const ie=t.preOrderHooks;null!==ie&&h(o,ie,0,null),i(o,0)}if(function dd(t){for(let o=Bh(t);null!==o;o=Zf(o)){if(!o[va])continue;const a=o[uo];for(let d=0;d<a.length;d++){aa(a[d])}}}(o),Vg(o,2),null!==t.contentQueries&&Bl(t,o),S){const ie=t.contentCheckHooks;null!==ie&&zi(o,ie)}else{const ie=t.contentHooks;null!==ie&&h(o,ie,1),i(o,1)}!function ly(t,o){const a=t.hostBindingOpCodes;if(null===a)return;const d=Op(o,ns);try{for(let m=0;m<a.length;m++){const x=a[m];if(x<0)ge(~x);else{const S=x,k=a[++m],U=a[++m];Ss(k,S),d.runInContext(U,2,o[S])}}}finally{null===o[ns]&&kp(o,ns),ge(-1)}}(t,o);const k=t.components;null!==k&&zl(o,k,0);const U=t.viewQuery;if(null!==U&&pl(2,U,d),S){const ie=t.viewCheckHooks;null!==ie&&zi(o,ie)}else{const ie=t.viewHooks;null!==ie&&h(o,ie,2),i(o,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o[xr]&=-73,Gl(o)}finally{E()}}}function Vg(t,o){for(let a=Bh(t);null!==a;a=Zf(a))for(let d=so;d<a.length;d++)yf(a[d],o)}function qp(t,o,a){yf(ko(o,t),a)}function yf(t,o){if(!function ta(t){return 128==(128&t[xr])}(t))return;const a=t[rr];if(80&t[xr]&&0===o||1024&t[xr]||2===o)ph(a,t,a.template,t[eo]);else if(t[zo]>0){Vg(t,1);const m=t[rr].components;null!==m&&zl(t,m,1)}}function zl(t,o,a){for(let d=0;d<o.length;d++)qp(t,o[d],a)}class Ou{get rootNodes(){const o=this._lView,a=o[rr];return ml(a,o,a.firstChild,[])}constructor(o,a){this._lView=o,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[eo]}set context(o){this._lView[eo]=o}get destroyed(){return 256==(256&this._lView[xr])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[Si];if(Zi(o)){const a=o[8],d=a?a.indexOf(this):-1;d>-1&&(Ga(o,d),dl(a,d))}this._attachedToViewContainer=!1}Aa(this._lView[rr],this._lView)}onDestroy(o){!function or(t,o){if(256==(256&t[xr]))throw new Se(911,!1);null===t[ms]&&(t[ms]=[]),t[ms].push(o)}(this._lView,o)}markForCheck(){Su(this._cdRefInjectingView||this._lView)}detach(){this._lView[xr]&=-129}reattach(){this._lView[xr]|=128}detectChanges(){fh(this._lView[rr],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Hc(t,o){Zu(t,o,o[Mr],2,null,null)}(this._lView[rr],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Se(902,!1);this._appRef=o}}class Zp extends Ou{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;fh(o[rr],o,o[eo],!1)}checkNoChanges(){}get context(){return null}}class gl extends Kc{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const a=jr(o);return new Cc(a,this.ngModule)}}function ru(t){const o=[];for(let a in t)t.hasOwnProperty(a)&&o.push({propName:t[a],templateName:a});return o}class jg{constructor(o,a){this.injector=o,this.parentInjector=a}get(o,a,d){d=hr(d);const m=this.injector.get(o,sf,d);return m!==sf||a===sf?m:this.parentInjector.get(o,a,d)}}class Cc extends ug{get inputs(){const o=this.componentDef,a=o.inputTransforms,d=ru(o.inputs);if(null!==a)for(const m of d)a.hasOwnProperty(m.propName)&&(m.transform=a[m.propName]);return d}get outputs(){return ru(this.componentDef.outputs)}constructor(o,a){super(),this.componentDef=o,this.ngModule=a,this.componentType=o.type,this.selector=function pn(t){return t.map(xn).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!a}create(o,a,d,m){let x=(m=m||this.ngModule)instanceof kl?m:m?.injector;x&&null!==this.componentDef.getStandaloneInjector&&(x=this.componentDef.getStandaloneInjector(x)||x);const S=x?new jg(o,x):o,k=S.get(Cp,null);if(null===k)throw new Se(407,!1);const rt={rendererFactory:k,sanitizer:S.get(Sp,null),effectManager:S.get(Wp,null),afterRenderEventManager:S.get(el,null)},Nt=k.createRenderer(null,this.componentDef),Qt=this.componentDef.selectors[0][0]||"div",Pn=d?function cy(t,o,a,d){const x=d.get(sh,!1)||a===Dn.ShadowDom,S=t.selectRootElement(o,x);return function Ag(t){Fp(t)}(S),S}(Nt,d,this.componentDef.encapsulation,S):Nh(Nt,Qt,function Ug(t){const o=t.toLowerCase();return"svg"===o?wn:"math"===o?"math":null}(Qt)),Kr=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Hn=null;null!==Pn&&(Hn=Kd(Pn,S,!0));const yi=tu(0,null,null,1,0,null,null,null,null,null,null),$i=Fl(null,yi,null,Kr,null,null,rt,Nt,S,null,Hn);let Zo,vl;z($i);try{const Nu=this.componentDef;let Of,xv=null;Nu.findHostDirectiveDefs?(Of=[],xv=new Map,Nu.findHostDirectiveDefs(Nu,Of,xv),Of.push(Nu)):Of=[Nu];const DC=function Hg(t,o){const a=t[rr],d=er;return t[d]=o,ld(a,d,2,"#host",null)}($i,Pn),CC=function Gg(t,o,a,d,m,x,S){const k=m[rr];!function xy(t,o,a,d){for(const m of t)o.mergedAttrs=oi(o.mergedAttrs,m.hostAttrs);null!==o.mergedAttrs&&(hh(o,o.mergedAttrs,!0),null!==a&&tp(d,a,o))}(d,t,o,S);let U=null;null!==o&&(U=Kd(o,m[$o]));const ie=x.rendererFactory.createRenderer(o,a);let we=16;a.signals?we=4096:a.onPush&&(we=64);const rt=Fl(m,Mg(a),null,we,m[t.index],t,x,ie,null,null,U);return k.firstCreatePass&&$p(k,t,d.length-1),Nl(m,rt),m[t.index]=rt}(DC,Pn,Nu,Of,$i,rt,Nt);vl=Di(yi,er),Pn&&function qg(t,o,a,d){if(d)cn(t,a,["ng-version",Wa.full]);else{const{attrs:m,classes:x}=function An(t){const o=[],a=[];let d=1,m=2;for(;d<t.length;){let x=t[d];if("string"==typeof x)2===m?""!==x&&o.push(x,t[++d]):8===m&&a.push(x);else{if(!Cr(m))break;m=x}d++}return{attrs:o,classes:a}}(o.selectors[0]);m&&cn(t,a,m),x&&x.length>0&&Fd(t,a,x.join(" "))}}(Nt,Nu,Pn,d),void 0!==a&&function Zg(t,o,a){const d=t.projection=[];for(let m=0;m<o.length;m++){const x=a[m];d.push(null!=x?Array.from(x):null)}}(vl,this.ngContentSelectors,a),Zo=function Wg(t,o,a,d,m,x){const S=ds(),k=m[rr],U=Br(S,m);mf(k,m,S,a,null,d);for(let we=0;we<a.length;we++)ma(dr(m,k,S.directiveStart+we,S),m);zp(k,m,S),U&&ma(U,m);const ie=dr(m,k,S.directiveStart+S.componentOffset,S);if(t[eo]=m[eo]=ie,null!==x)for(const we of x)we(ie,o);return Pu(k,S,t),ie}(CC,Nu,Of,xv,$i,[by]),_f(yi,$i,null)}finally{E()}return new vf(this.componentType,Zo,od(vl,$i),$i,vl)}}class vf extends Q_{constructor(o,a,d,m,x){super(),this.location=d,this._rootLView=m,this._tNode=x,this.previousInputValues=null,this.instance=a,this.hostView=this.changeDetectorRef=new Zp(m),this.componentType=o}setInput(o,a){const d=this._tNode.inputs;let m;if(null!==d&&(m=d[o])){if(this.previousInputValues??=new Map,this.previousInputValues.has(o)&&Object.is(this.previousInputValues.get(o),a))return;const x=this._rootLView;dh(x[rr],x,m,o,a),this.previousInputValues.set(o,a),Su(ko(this._tNode.index,x))}}get injector(){return new _i(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function by(){const t=ds();ai(Nn()[rr],t)}function bf(t){let o=function xf(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),a=!0;const d=[t];for(;o;){let m;if(Xo(t))m=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Se(903,!1);m=o.\u0275dir}if(m){if(a){d.push(m);const S=t;S.inputs=mh(t.inputs),S.inputTransforms=mh(t.inputTransforms),S.declaredInputs=mh(t.declaredInputs),S.outputs=mh(t.outputs);const k=m.hostBindings;k&&Xg(t,k);const U=m.viewQuery,ie=m.contentQueries;if(U&&Yp(t,U),ie&&Xp(t,ie),Re(t.inputs,m.inputs),Re(t.declaredInputs,m.declaredInputs),Re(t.outputs,m.outputs),null!==m.inputTransforms&&(null===S.inputTransforms&&(S.inputTransforms={}),Re(S.inputTransforms,m.inputTransforms)),Xo(m)&&m.data.animation){const we=t.data;we.animation=(we.animation||[]).concat(m.data.animation)}}const x=m.features;if(x)for(let S=0;S<x.length;S++){const k=x[S];k&&k.ngInherit&&k(t),k===bf&&(a=!1)}}o=Object.getPrototypeOf(o)}!function Yg(t){let o=0,a=null;for(let d=t.length-1;d>=0;d--){const m=t[d];m.hostVars=o+=m.hostVars,m.hostAttrs=oi(m.hostAttrs,a=oi(a,m.hostAttrs))}}(d)}function mh(t){return t===ur?{}:t===Zn?[]:t}function Yp(t,o){const a=t.viewQuery;t.viewQuery=a?(d,m)=>{o(d,m),a(d,m)}:o}function Xp(t,o){const a=t.contentQueries;t.contentQueries=a?(d,m,x)=>{o(d,m,x),a(d,m,x)}:o}function Xg(t,o){const a=t.hostBindings;t.hostBindings=a?(d,m)=>{o(d,m),a(d,m)}:o}function g(t){const o=t.inputConfig,a={};for(const d in o)if(o.hasOwnProperty(d)){const m=o[d];Array.isArray(m)&&m[2]&&(a[d]=m[2])}t.inputTransforms=a}function C(t){return!!V(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function V(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ce(t,o,a){return!Object.is(t[o],a)&&(t[o]=a,!0)}function Ge(t,o,a,d){const m=Nn();return ce(m,Xa(),o)&&(ri(),lc(Oe(),m,t,o,a,d)),Ge}function yt(t,o,a,d){return ce(t,Xa(),a)?o+ht(a)+d:mi}function wf(t,o,a,d,m,x,S,k){const U=Nn(),ie=ri(),we=t+er,rt=ie.firstCreatePass?function e_(t,o,a,d,m,x,S,k,U){const ie=o.consts,we=ld(o,t,4,S||null,_s(ie,k));lh(o,a,we,_s(ie,U)),ai(o,we);const rt=we.tView=tu(2,we,d,m,x,o.directiveRegistry,o.pipeRegistry,null,o.schemas,ie,null);return null!==o.queries&&(o.queries.template(o,we),rt.queries=o.queries.embeddedTView(we)),we}(we,ie,U,o,a,d,m,x,S):ie.data[we];na(rt,!1);const Nt=Ef(ie,U,rt,t);Nr()&&Od(ie,U,Nt,rt),ma(Nt,U),Nl(U,U[we]=tl(Nt,U,Nt,rt)),us(rt)&&ud(ie,U,rt),null!=S&&Lp(U,rt,k)}let Ef=function $l(t,o,a,d){return zr(!0),o[Mr].createComment("")};function Df(t){return function Li(t,o){return t[o]}(function mc(){return ei.lFrame.contextLView}(),er+t)}function uc(t,o,a){const d=Nn();return ce(d,Xa(),o)&&_a(ri(),Oe(),d,t,o,d[Mr],a,!1),uc}function yh(t,o,a,d,m){const S=m?"class":"style";dh(t,a,o.inputs[S],S,d)}function ua(t,o,a,d){const m=Nn(),x=ri(),S=er+t,k=m[Mr],U=x.firstCreatePass?function wy(t,o,a,d,m,x){const S=o.consts,U=ld(o,t,2,d,_s(S,m));return lh(o,a,U,_s(S,x)),null!==U.attrs&&hh(U,U.attrs,!1),null!==U.mergedAttrs&&hh(U,U.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,U),U}(S,x,m,o,a,d):x.data[S],ie=Cf(x,m,U,k,o,t);m[S]=ie;const we=us(U);return na(U,!0),tp(k,ie,U),32!=(32&U.flags)&&Nr()&&Od(x,m,ie,U),0===function ys(){return ei.lFrame.elementDepthCount}()&&ma(ie,m),function Ya(){ei.lFrame.elementDepthCount++}(),we&&(ud(x,m,U),Pu(x,U,m)),null!==d&&Lp(m,U),ua}function da(){let t=ds();Yl()?Ac():(t=t.parent,na(t,!1));const o=t;(function au(t){return ei.skipHydrationRootTNode===t})(o)&&function pc(){ei.skipHydrationRootTNode=null}(),function Bs(){ei.lFrame.elementDepthCount--}();const a=ri();return a.firstCreatePass&&(ai(a,t),Hs(t)&&a.queries.elementEnd(t)),null!=o.classesWithoutHost&&function ae(t){return 0!=(8&t.flags)}(o)&&yh(a,o,Nn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function De(t){return 0!=(16&t.flags)}(o)&&yh(a,o,Nn(),o.stylesWithoutHost,!1),da}function Fu(t,o,a,d){return ua(t,o,a,d),da(),Fu}let Cf=(t,o,a,d,m,x)=>(zr(!0),Nh(d,m,function Vr(){return ei.lFrame.currentNamespace}()));function Ey(t,o,a){const d=Nn(),m=ri(),x=t+er,S=m.firstCreatePass?function Zb(t,o,a,d,m){const x=o.consts,S=_s(x,d),k=ld(o,t,8,"ng-container",S);return null!==S&&hh(k,S,!0),lh(o,a,k,_s(x,m)),null!==o.queries&&o.queries.elementStart(o,k),k}(x,m,d,o,a):m.data[x];na(S,!0);const k=Ov(m,d,S,t);return d[x]=k,Nr()&&Od(m,d,k,S),ma(k,d),us(S)&&(ud(m,d,S),Pu(m,S,d)),null!=a&&Lp(d,S),Ey}function Dy(){let t=ds();const o=ri();return Yl()?Ac():(t=t.parent,na(t,!1)),o.firstCreatePass&&(ai(o,t),Hs(t)&&o.queries.elementEnd(t)),Dy}function Cy(t,o,a){return Ey(t,o,a),Dy(),Cy}let Ov=(t,o,a,d)=>(zr(!0),Xf(o[Mr],""));function kv(){return Nn()}function Ty(t){return!!t&&"function"==typeof t.then}function Lv(t){return!!t&&"function"==typeof t.subscribe}function Sy(t,o,a,d){const m=Nn(),x=ri(),S=ds();return function Bv(t,o,a,d,m,x,S){const k=us(d),ie=t.firstCreatePass&&jp(t),we=o[eo],rt=uh(o);let Nt=!0;if(3&d.type||S){const Jn=Br(d,o),wr=S?S(Jn):Jn,Kr=rt.length,Hn=S?$i=>S(Dr($i[d.index])):d.index;let yi=null;if(!S&&k&&(yi=function Kb(t,o,a,d){const m=t.cleanup;if(null!=m)for(let x=0;x<m.length-1;x+=2){const S=m[x];if(S===a&&m[x+1]===d){const k=o[Ms],U=m[x+2];return k.length>U?k[U]:null}"string"==typeof S&&(x+=2)}return null}(t,o,m,d.index)),null!==yi)(yi.__ngLastListenerFn__||yi).__ngNextListenerFn__=x,yi.__ngLastListenerFn__=x,Nt=!1;else{x=zv(d,o,we,x,!1);const $i=a.listen(wr,m,x);rt.push(x,$i),ie&&ie.push(m,Hn,Kr,Kr+1)}}else x=zv(d,o,we,x,!1);const Qt=d.outputs;let Pn;if(Nt&&null!==Qt&&(Pn=Qt[m])){const Jn=Pn.length;if(Jn)for(let wr=0;wr<Jn;wr+=2){const Zo=o[Pn[wr]][Pn[wr+1]].subscribe(x),vl=rt.length;rt.push(x,Zo),ie&&ie.push(m,d.index,vl,-(vl+1))}}}(x,m,m[Mr],S,t,o,d),Sy}function Nv(t,o,a,d){try{return Et(6,o,a),!1!==a(d)}catch(m){return Gp(t,m),!1}finally{Et(7,o,a)}}function zv(t,o,a,d,m){return function x(S){if(S===Function)return d;Su(t.componentOffset>-1?ko(t.index,o):o);let U=Nv(o,a,d,S),ie=x.__ngNextListenerFn__;for(;ie;)U=Nv(o,a,ie,S)&&U,ie=ie.__ngNextListenerFn__;return m&&!1===U&&S.preventDefault(),U}}function $v(t=1){return function M(t){return(ei.lFrame.contextLView=function q(t,o){for(;t>0;)o=o[_o],t--;return o}(t,ei.lFrame.contextLView))[eo]}(t)}function Jb(t,o){let a=null;const d=function Ce(t){const o=t.attrs;if(null!=o){const a=o.indexOf(5);if(!(1&a))return o[a+1]}return null}(t);for(let m=0;m<o.length;m++){const x=o[m];if("*"!==x){if(null===d?je(t,x,!0):zt(d,x))return m}else a=m}return a}function Vv(t){const o=Nn()[Ui][Ii];if(!o.projection){const d=o.projection=Fc(t?t.length:1,null),m=d.slice();let x=o.child;for(;null!==x;){const S=t?Jb(x,t):0;null!==S&&(m[S]?m[S].projectionNext=x:d[S]=x,m[S]=x),x=x.next}}}function Uv(t,o=0,a){const d=Nn(),m=ri(),x=ld(m,er+t,16,null,a||null);null===x.projection&&(x.projection=o),Ac(),(!d[cs]||Da())&&32!=(32&x.flags)&&function Pm(t,o,a){Wc(o[Mr],0,o,a,zh(t,a,o),ic(a.parent||o[Ii],a,o))}(m,d,x)}function r_(t,o){return t<<17|o<<2}function fd(t){return t>>17&32767}function My(t){return 2|t}function vh(t){return(131068&t)>>2}function Ay(t,o){return-131069&t|o<<2}function Py(t){return 1|t}function Jv(t,o,a,d,m){const x=t[a+1],S=null===o;let k=d?fd(x):vh(x),U=!1;for(;0!==k&&(!1===U||S);){const we=t[k+1];i1(t[k],o)&&(U=!0,t[k+1]=d?Py(we):My(we)),k=d?fd(we):vh(we)}U&&(t[a+1]=d?My(x):Py(x))}function i1(t,o){return null===t||null==o||(Array.isArray(t)?t[1]:t)===o||!(!Array.isArray(t)||"string"!=typeof o)&&Ql(t,o)>=0}const ha={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Qv(t){return t.substring(ha.key,ha.keyEnd)}function e0(t,o){const a=ha.textEnd;return a===o?-1:(o=ha.keyEnd=function l1(t,o,a){for(;o<a&&t.charCodeAt(o)>32;)o++;return o}(t,ha.key=o,a),Tf(t,o,a))}function Tf(t,o,a){for(;o<a&&t.charCodeAt(o)<=32;)o++;return o}function Ry(t,o){return function Tc(t,o,a,d){const m=Nn(),x=ri(),S=ca(2);x.firstUpdatePass&&l0(x,t,S,d),o!==mi&&ce(m,S,o)&&u0(x,x.data[oe()],m,m[Mr],t,m[S+1]=function x1(t,o){return null==t||""===t||("string"==typeof o?t+=o:"object"==typeof t&&(t=Ze(vc(t)))),t}(o,a),d,S)}(t,o,null,!0),Ry}function ou(t,o){for(let a=function s1(t){return function n0(t){ha.key=0,ha.keyEnd=0,ha.value=0,ha.valueEnd=0,ha.textEnd=t.length}(t),e0(t,Tf(t,0,ha.textEnd))}(o);a>=0;a=e0(o,a))Ja(t,Qv(o),!0)}function a0(t,o){return o>=t.expandoStartIndex}function l0(t,o,a,d){const m=t.data;if(null===m[a+1]){const x=m[oe()],S=a0(t,a);h0(x,d)&&null===o&&!S&&(o=!1),o=function f1(t,o,a,d){const m=function gc(t){const o=ei.lFrame.currentDirectiveIndex;return-1===o?null:t[o]}(t);let x=d?o.residualClasses:o.residualStyles;if(null===m)0===(d?o.classBindings:o.styleBindings)&&(a=em(a=Oy(null,t,o,a,d),o.attrs,d),x=null);else{const S=o.directiveStylingLast;if(-1===S||t[S]!==m)if(a=Oy(m,t,o,a,d),null===x){let U=function p1(t,o,a){const d=a?o.classBindings:o.styleBindings;if(0!==vh(d))return t[fd(d)]}(t,o,d);void 0!==U&&Array.isArray(U)&&(U=Oy(null,t,o,U[1],d),U=em(U,o.attrs,d),function m1(t,o,a,d){t[fd(a?o.classBindings:o.styleBindings)]=d}(t,o,d,U))}else x=function g1(t,o,a){let d;const m=o.directiveEnd;for(let x=1+o.directiveStylingLast;x<m;x++)d=em(d,t[x].hostAttrs,a);return em(d,o.attrs,a)}(t,o,d)}return void 0!==x&&(d?o.residualClasses=x:o.residualStyles=x),a}(m,x,o,d),function n1(t,o,a,d,m,x){let S=x?o.classBindings:o.styleBindings,k=fd(S),U=vh(S);t[d]=a;let we,ie=!1;if(Array.isArray(a)?(we=a[1],(null===we||Ql(a,we)>0)&&(ie=!0)):we=a,m)if(0!==U){const Nt=fd(t[k+1]);t[d+1]=r_(Nt,k),0!==Nt&&(t[Nt+1]=Ay(t[Nt+1],d)),t[k+1]=function e1(t,o){return 131071&t|o<<17}(t[k+1],d)}else t[d+1]=r_(k,0),0!==k&&(t[k+1]=Ay(t[k+1],d)),k=d;else t[d+1]=r_(U,0),0===k?k=d:t[U+1]=Ay(t[U+1],d),U=d;ie&&(t[d+1]=My(t[d+1])),Jv(t,we,d,!0),Jv(t,we,d,!1),function r1(t,o,a,d,m){const x=m?t.residualClasses:t.residualStyles;null!=x&&"string"==typeof o&&Ql(x,o)>=0&&(a[d+1]=Py(a[d+1]))}(o,we,t,d,x),S=r_(k,U),x?o.classBindings=S:o.styleBindings=S}(m,x,o,a,S,d)}}function Oy(t,o,a,d,m){let x=null;const S=a.directiveEnd;let k=a.directiveStylingLast;for(-1===k?k=a.directiveStart:k++;k<S&&(x=o[k],d=em(d,x.hostAttrs,m),x!==t);)k++;return null!==t&&(a.directiveStylingLast=k),d}function em(t,o,a){const d=a?1:2;let m=-1;if(null!==o)for(let x=0;x<o.length;x++){const S=o[x];"number"==typeof S?m=S:m===d&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Ja(t,S,!!a||o[++x]))}return void 0===t?null:t}function u0(t,o,a,d,m,x,S,k){if(!(3&o.type))return;const U=t.data,ie=U[k+1],we=function t1(t){return 1==(1&t)}(ie)?d0(U,o,a,m,vh(ie),S):void 0;i_(we)||(i_(x)||function Qb(t){return 2==(2&t)}(ie)&&(x=d0(U,null,a,m,k,S)),function P_(t,o,a,d,m){if(o)m?t.addClass(a,d):t.removeClass(a,d);else{let x=-1===d.indexOf("-")?void 0:kh.DashCase;null==m?t.removeStyle(a,d,x):("string"==typeof m&&m.endsWith("!important")&&(m=m.slice(0,-10),x|=kh.Important),t.setStyle(a,d,m,x))}}(d,S,bi(oe(),a),m,x))}function d0(t,o,a,d,m,x){const S=null===o;let k;for(;m>0;){const U=t[m],ie=Array.isArray(U),we=ie?U[1]:U,rt=null===we;let Nt=a[m+1];Nt===mi&&(Nt=rt?Zn:void 0);let Qt=rt?vd(Nt,d):we===d?Nt:void 0;if(ie&&!i_(Qt)&&(Qt=vd(U,d)),i_(Qt)&&(k=Qt,S))return k;const Pn=t[m+1];m=S?fd(Pn):vh(Pn)}if(null!==o){let U=x?o.residualClasses:o.residualStyles;null!=U&&(k=vd(U,d))}return k}function i_(t){return void 0!==t}function h0(t,o){return 0!=(t.flags&(o?8:16))}function f0(t,o=""){const a=Nn(),d=ri(),m=t+er,x=d.firstCreatePass?ld(d,m,1,o,null):d.data[m],S=p0(d,a,x,o,t);a[m]=S,Nr()&&Od(d,a,S,x),na(x,!1)}let p0=(t,o,a,d,m)=>(zr(!0),function Gu(t,o){return t.createText(o)}(o[Mr],d));function ky(t){return o_("",t,""),ky}function o_(t,o,a){const d=Nn(),m=yt(d,t,o,a);return m!==mi&&function Dc(t,o,a){const d=bi(o,t);!function Yf(t,o,a){t.setValue(o,a)}(t[Mr],d,a)}(d,oe(),m),o_}function E0(t,o,a){!function Sc(t,o,a,d){const m=ri(),x=ca(2);m.firstUpdatePass&&l0(m,null,x,d);const S=Nn();if(a!==mi&&ce(S,x,a)){const k=m.data[oe()];if(h0(k,d)&&!a0(m,x)){let U=d?k.classesWithoutHost:k.stylesWithoutHost;null!==U&&(a=tt(U,a||"")),yh(m,k,S,a,d)}else!function v1(t,o,a,d,m,x,S,k){m===mi&&(m=Zn);let U=0,ie=0,we=0<m.length?m[0]:null,rt=0<x.length?x[0]:null;for(;null!==we||null!==rt;){const Nt=U<m.length?m[U+1]:void 0,Qt=ie<x.length?x[ie+1]:void 0;let Jn,Pn=null;we===rt?(U+=2,ie+=2,Nt!==Qt&&(Pn=rt,Jn=Qt)):null===rt||null!==we&&we<rt?(U+=2,Pn=we):(ie+=2,Pn=rt,Jn=Qt),null!==Pn&&u0(t,o,a,d,Pn,Jn,S,k),we=U<m.length?m[U]:null,rt=ie<x.length?x[ie]:null}}(m,k,S,S[Mr],S[x+1],S[x+1]=function _1(t,o,a){if(null==a||""===a)return Zn;const d=[],m=vc(a);if(Array.isArray(m))for(let x=0;x<m.length;x++)t(d,m[x],!0);else if("object"==typeof m)for(const x in m)m.hasOwnProperty(x)&&t(d,x,m[x]);else"string"==typeof m&&o(d,m);return d}(t,o,a),d,x)}}(Ja,ou,yt(Nn(),t,o,a),!0)}function Ly(t,o,a){const d=Nn();return ce(d,Xa(),o)&&_a(ri(),Oe(),d,t,o,d[Mr],a,!0),Ly}const xh=void 0;var V1=["en",[["a","p"],["AM","PM"],xh],[["AM","PM"],xh,xh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],xh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],xh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",xh,"{1} 'at' {0}",xh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $1(t){const a=Math.floor(Math.abs(t)),d=t.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===d?1:5}];let Sf={};function Fy(t){const o=function U1(t){return t.toLowerCase().replace(/_/g,"-")}(t);let a=L0(o);if(a)return a;const d=o.split("-")[0];if(a=L0(d),a)return a;if("en"===d)return V1;throw new Se(701,!1)}function k0(t){return Fy(t)[If.PluralCase]}function L0(t){return t in Sf||(Sf[t]=Sr.ng&&Sr.ng.common&&Sr.ng.common.locales&&Sr.ng.common.locales[t]),Sf[t]}var If=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(If||{});const Mf="en-US";let F0=Mf;function zy(t,o,a,d,m){if(t=vt(t),Array.isArray(t))for(let x=0;x<t.length;x++)zy(t[x],o,a,d,m);else{const x=ri(),S=Nn(),k=ds();let U=Yc(t)?t:vt(t.provide);const ie=Eu(t),we=1048575&k.providerIndexes,rt=k.directiveStart,Nt=k.providerIndexes>>20;if(Yc(t)||!t.multi){const Qt=new A(ie,m,Mu),Pn=Vy(U,o,m?we:we+Nt,rt);-1===Pn?(Fn(On(k,S),x,U),$y(x,t,o.length),o.push(U),k.directiveStart++,k.directiveEnd++,m&&(k.providerIndexes+=1048576),a.push(Qt),S.push(Qt)):(a[Pn]=Qt,S[Pn]=Qt)}else{const Qt=Vy(U,o,we+Nt,rt),Pn=Vy(U,o,we,we+Nt),wr=Pn>=0&&a[Pn];if(m&&!wr||!m&&!(Qt>=0&&a[Qt])){Fn(On(k,S),x,U);const Kr=function $w(t,o,a,d,m){const x=new A(t,a,Mu);return x.multi=[],x.index=o,x.componentProviders=0,ax(x,m,d&&!a),x}(m?zw:Nw,a.length,m,d,ie);!m&&wr&&(a[Pn].providerFactory=Kr),$y(x,t,o.length,0),o.push(U),k.directiveStart++,k.directiveEnd++,m&&(k.providerIndexes+=1048576),a.push(Kr),S.push(Kr)}else $y(x,t,Qt>-1?Qt:Pn,ax(a[m?Pn:Qt],ie,!m&&d));!m&&d&&wr&&a[Pn].componentProviders++}}}function $y(t,o,a,d){const m=Yc(o),x=function Km(t){return!!t.useClass}(o);if(m||x){const U=(x?vt(o.useClass):o).prototype.ngOnDestroy;if(U){const ie=t.destroyHooks||(t.destroyHooks=[]);if(!m&&o.multi){const we=ie.indexOf(a);-1===we?ie.push(a,[d,U]):ie[we+1].push(d,U)}else ie.push(a,U)}}}function ax(t,o,a){return a&&t.componentProviders++,t.multi.push(o)-1}function Vy(t,o,a,d){for(let m=a;m<d;m++)if(o[m]===t)return m;return-1}function Nw(t,o,a,d){return Uy(this.multi,[])}function zw(t,o,a,d){const m=this.multi;let x;if(this.providerFactory){const S=this.providerFactory.componentProviders,k=dr(a,a[rr],this.providerFactory.index,d);x=k.slice(0,S),Uy(m,x);for(let U=S;U<k.length;U++)x.push(k[U])}else x=[],Uy(m,x);return x}function Uy(t,o){for(let a=0;a<t.length;a++)o.push((0,t[a])());return o}function lx(t,o=[]){return a=>{a.providersResolver=(d,m)=>function Bw(t,o,a){const d=ri();if(d.firstCreatePass){const m=Xo(t);zy(a,d.data,d.blueprint,m,!0),zy(o,d.data,d.blueprint,m,!1)}}(d,m?m(t):t,o)}}class bh{}class cx{}function Vw(t,o){return new jy(t,o??null,[])}class jy extends bh{constructor(o,a,d){super(),this._parent=a,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new gl(this);const m=Pi(o);this._bootstrapComponents=ac(m.bootstrap),this._r3Injector=_g(o,a,[{provide:bh,useValue:this},{provide:Kc,useValue:this.componentFactoryResolver},...d],Ze(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Hy extends cx{constructor(o){super(),this.moduleType=o}create(o){return new jy(this.moduleType,o,[])}}class ux extends bh{constructor(o){super(),this.componentFactoryResolver=new gl(this),this.instance=null;const a=new wu([...o.providers,{provide:bh,useValue:this},{provide:Kc,useValue:this.componentFactoryResolver}],o.parent||Kh(),o.debugName,new Set(["environment"]));this.injector=a,o.runEnvironmentInitializers&&a.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function dx(t,o,a=null){return new ux({providers:t,parent:o,debugName:a,runEnvironmentInitializers:!0}).injector}let jw=(()=>{var t;class o{constructor(d){this._injector=d,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(d){if(!d.standalone)return null;if(!this.cachedInjectors.has(d)){const m=Zm(0,d.type),x=m.length>0?dx([m],this._injector,`Standalone[${d.type.name}]`):null;this.cachedInjectors.set(d,x)}return this.cachedInjectors.get(d)}ngOnDestroy(){try{for(const d of this.cachedInjectors.values())null!==d&&d.destroy()}finally{this.cachedInjectors.clear()}}}return(t=o).\u0275prov=an({token:t,providedIn:"environment",factory:()=>new t(vn(kl))}),o})();function hx(t){t.getStandaloneInjector=o=>o.get(jw).getOrCreateStandaloneInjector(t)}function vx(t,o,a){const d=function Ts(){const t=ei.lFrame;let o=t.bindingRootIndex;return-1===o&&(o=t.bindingRootIndex=t.tView.bindingStartIndex),o}()+t,m=Nn();return m[d]===mi?function Z(t,o,a){return t[o]=a}(m,d,a?o.call(a):o()):function Q(t,o){return t[o]}(m,d)}function Wy(t){return o=>{setTimeout(t,void 0,o)}}const su=class pE extends I.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,a,d){let m=o,x=a||(()=>null),S=d;if(o&&"object"==typeof o){const U=o;m=U.next?.bind(U),x=U.error?.bind(U),S=U.complete?.bind(U)}this.__isAsync&&(x=Wy(x),m&&(m=Wy(m)),S&&(S=Wy(S)));const k=super.subscribe({next:m,error:x,complete:S});return o instanceof b.w0&&o.add(k),k}};function mE(){return this._results[Symbol.iterator]()}class u_{get changes(){return this._changes||(this._changes=new su)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=u_.prototype;a[Symbol.iterator]||(a[Symbol.iterator]=mE)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,a){return this._results.reduce(o,a)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,a){const d=this;d.dirty=!1;const m=function Ka(t){return t.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Eh(t,o,a){if(t.length!==o.length)return!1;for(let d=0;d<t.length;d++){let m=t[d],x=o[d];if(a&&(m=a(m),x=a(x)),x!==m)return!1}return!0}(d._results,m,a))&&(d._results=m,d.length=m.length,d.last=m[this.length-1],d.first=m[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function _E(t,o,a,d=!0){const m=o[rr];if(function Kf(t,o,a,d){const m=so+d,x=a.length;d>0&&(a[m-1][Io]=o),d<x-so?(o[Io]=a[m],yd(a,so+d,o)):(a.push(o),o[Io]=null),o[Si]=a;const S=o[es];null!==S&&a!==S&&function rc(t,o){const a=t[uo];o[Ui]!==o[Si][Si][Ui]&&(t[va]=!0),null===a?t[uo]=[o]:a.push(o)}(S,o);const k=o[Uo];null!==k&&k.insertView(t),o[xr]|=128}(m,o,t,a),d){const x=ep(a,t),S=o[Mr],k=Pd(S,t[Ho]);null!==k&&function Sm(t,o,a,d,m,x){d[Oi]=m,d[Ii]=o,Zu(t,d,a,1,m,x)}(m,t[Ii],S,o,k,x)}}let lm=(()=>{class o{}return o.__NG_ELEMENT_ID__=xE,o})();const yE=lm,vE=class extends yE{constructor(o,a,d){super(),this._declarationLView=o,this._declarationTContainer=a,this.elementRef=d}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(o,a){return this.createEmbeddedViewImpl(o,a)}createEmbeddedViewImpl(o,a,d){const m=function gE(t,o,a,d){const m=o.tView,k=Fl(t,m,a,4096&t[xr]?4096:16,null,o,null,null,null,d?.injector??null,d?.hydrationInfo??null);k[es]=t[o.index];const ie=t[Uo];return null!==ie&&(k[Uo]=ie.createEmbeddedView(m)),_f(m,k,a),k}(this._declarationLView,this._declarationTContainer,o,{injector:a,hydrationInfo:d});return new Ou(m)}};function xE(){return d_(ds(),Nn())}function d_(t,o){return 4&t.type?new vE(o,t,od(t,o)):null}let f_=(()=>{class o{}return o.__NG_ELEMENT_ID__=TE,o})();function TE(){return Px(ds(),Nn())}const SE=f_,Mx=class extends SE{constructor(o,a,d){super(),this._lContainer=o,this._hostTNode=a,this._hostLView=d}get element(){return od(this._hostTNode,this._hostLView)}get injector(){return new _i(this._hostTNode,this._hostLView)}get parentInjector(){const o=un(this._hostTNode,this._hostLView);if(be(o)){const a=Ie(o,this._hostLView),d=Pe(o);return new _i(a[rr].data[d+8],a)}return new _i(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const a=Ax(this._lContainer);return null!==a&&a[o]||null}get length(){return this._lContainer.length-so}createEmbeddedView(o,a,d){let m,x;"number"==typeof d?m=d:null!=d&&(m=d.index,x=d.injector);const k=o.createEmbeddedViewImpl(a||{},x,null);return this.insertImpl(k,m,false),k}createComponent(o,a,d,m,x){const S=o&&!function cu(t){return"function"==typeof t}(o);let k;if(S)k=a;else{const Jn=a||{};k=Jn.index,d=Jn.injector,m=Jn.projectableNodes,x=Jn.environmentInjector||Jn.ngModuleRef}const U=S?o:new Cc(jr(o)),ie=d||this.parentInjector;if(!x&&null==U.ngModule){const wr=(S?ie:this.parentInjector).get(kl,null);wr&&(x=wr)}jr(U.componentType??{});const Qt=U.create(ie,m,null,x);return this.insertImpl(Qt.hostView,k,false),Qt}insert(o,a){return this.insertImpl(o,a,!1)}insertImpl(o,a,d){const m=o._lView;if(function Yi(t){return Zi(t[Si])}(m)){const U=this.indexOf(o);if(-1!==U)this.detach(U);else{const ie=m[Si],we=new Mx(ie,ie[Ii],ie[Si]);we.detach(we.indexOf(o))}}const S=this._adjustIndex(a),k=this._lContainer;return _E(k,m,S,!d),o.attachToViewContainerRef(),yd(qy(k),S,o),o}move(o,a){return this.insert(o,a)}indexOf(o){const a=Ax(this._lContainer);return null!==a?a.indexOf(o):-1}remove(o){const a=this._adjustIndex(o,-1),d=Ga(this._lContainer,a);d&&(dl(qy(this._lContainer),a),Aa(d[rr],d))}detach(o){const a=this._adjustIndex(o,-1),d=Ga(this._lContainer,a);return d&&null!=dl(qy(this._lContainer),a)?new Ou(d):null}_adjustIndex(o,a=0){return o??this.length+a}};function Ax(t){return t[8]}function qy(t){return t[8]||(t[8]=[])}function Px(t,o){let a;const d=o[t.index];return Zi(d)?a=d:(a=tl(d,o,null,t),o[t.index]=a,Nl(o,a)),Rx(a,o,t,d),new Mx(a,t,o)}let Rx=function Ox(t,o,a,d){if(t[Ho])return;let m;m=8&a.type?Dr(d):function IE(t,o){const a=t[Mr],d=a.createComment(""),m=Br(o,t);return yc(a,Pd(a,m),d,function A_(t,o){return t.nextSibling(o)}(a,m),!1),d}(o,a),t[Ho]=m};class Zy{constructor(o){this.queryList=o,this.matches=null}clone(){return new Zy(this.queryList)}setDirty(){this.queryList.setDirty()}}class Yy{constructor(o=[]){this.queries=o}createEmbeddedView(o){const a=o.queries;if(null!==a){const d=null!==o.contentQueries?o.contentQueries[0]:a.length,m=[];for(let x=0;x<d;x++){const S=a.getByIndex(x);m.push(this.queries[S.indexInDeclarationView].clone())}return new Yy(m)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let a=0;a<this.queries.length;a++)null!==Ux(o,a).matches&&this.queries[a].setDirty()}}class kx{constructor(o,a,d=null){this.predicate=o,this.flags=a,this.read=d}}class Xy{constructor(o=[]){this.queries=o}elementStart(o,a){for(let d=0;d<this.queries.length;d++)this.queries[d].elementStart(o,a)}elementEnd(o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(o)}embeddedTView(o){let a=null;for(let d=0;d<this.length;d++){const m=null!==a?a.length:0,x=this.getByIndex(d).embeddedTView(o,m);x&&(x.indexInDeclarationView=d,null!==a?a.push(x):a=[x])}return null!==a?new Xy(a):null}template(o,a){for(let d=0;d<this.queries.length;d++)this.queries[d].template(o,a)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Ky{constructor(o,a=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(o,a){this.isApplyingToNode(a)&&this.matchTNode(o,a)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,a){this.elementStart(o,a)}embeddedTView(o,a){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,a),new Ky(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let d=o.parent;for(;null!==d&&8&d.type&&d.index!==a;)d=d.parent;return a===(null!==d?d.index:-1)}return this._appliesToNextNode}matchTNode(o,a){const d=this.metadata.predicate;if(Array.isArray(d))for(let m=0;m<d.length;m++){const x=d[m];this.matchTNodeWithReadOption(o,a,PE(a,x)),this.matchTNodeWithReadOption(o,a,Xr(a,o,x,!1,!1))}else d===lm?4&a.type&&this.matchTNodeWithReadOption(o,a,-1):this.matchTNodeWithReadOption(o,a,Xr(a,o,d,!1,!1))}matchTNodeWithReadOption(o,a,d){if(null!==d){const m=this.metadata.read;if(null!==m)if(m===th||m===f_||m===lm&&4&a.type)this.addMatch(a.index,-2);else{const x=Xr(a,o,m,!1,!1);null!==x&&this.addMatch(a.index,x)}else this.addMatch(a.index,d)}}addMatch(o,a){null===this.matches?this.matches=[o,a]:this.matches.push(o,a)}}function PE(t,o){const a=t.localNames;if(null!==a)for(let d=0;d<a.length;d+=2)if(a[d]===o)return a[d+1];return null}function OE(t,o,a,d){return-1===a?function RE(t,o){return 11&t.type?od(t,o):4&t.type?d_(t,o):null}(o,t):-2===a?function kE(t,o,a){return a===th?od(o,t):a===lm?d_(o,t):a===f_?Px(o,t):void 0}(t,o,d):dr(t,t[rr],a,o)}function Lx(t,o,a,d){const m=o[Uo].queries[d];if(null===m.matches){const x=t.data,S=a.matches,k=[];for(let U=0;U<S.length;U+=2){const ie=S[U];k.push(ie<0?null:OE(o,x[ie],S[U+1],a.metadata.read))}m.matches=k}return m.matches}function Jy(t,o,a,d){const m=t.queries.getByIndex(a),x=m.matches;if(null!==x){const S=Lx(t,o,m,a);for(let k=0;k<x.length;k+=2){const U=x[k];if(U>0)d.push(S[k/2]);else{const ie=x[k+1],we=o[-U];for(let rt=so;rt<we.length;rt++){const Nt=we[rt];Nt[es]===Nt[Si]&&Jy(Nt[rr],Nt,ie,d)}if(null!==we[uo]){const rt=we[uo];for(let Nt=0;Nt<rt.length;Nt++){const Qt=rt[Nt];Jy(Qt[rr],Qt,ie,d)}}}}}return d}function Fx(t){const o=Nn(),a=ri(),d=lu();qs(d+1);const m=Ux(a,d);if(t.dirty&&function Ps(t){return 4==(4&t[xr])}(o)===(2==(2&m.metadata.flags))){if(null===m.matches)t.reset([]);else{const x=m.crossesNgTemplate?Jy(a,o,d,[]):Lx(a,o,m,d);t.reset(x,ty),t.notifyOnChanges()}return!0}return!1}function Bx(t,o,a){const d=ri();d.firstCreatePass&&(Vx(d,new kx(t,o,a),-1),2==(2&o)&&(d.staticViewQueries=!0)),$x(d,Nn(),o)}function Nx(t,o,a,d){const m=ri();if(m.firstCreatePass){const x=ds();Vx(m,new kx(o,a,d),x.index),function FE(t,o){const a=t.contentQueries||(t.contentQueries=[]);o!==(a.length?a[a.length-1]:-1)&&a.push(t.queries.length-1,o)}(m,t),2==(2&a)&&(m.staticContentQueries=!0)}$x(m,Nn(),a)}function zx(){return function LE(t,o){return t[Uo].queries[o].queryList}(Nn(),lu())}function $x(t,o,a){const d=new u_(4==(4&a));(function dy(t,o,a,d){const m=uh(o);m.push(a),t.firstCreatePass&&jp(t).push(d,m.length-1)})(t,o,d,d.destroy),null===o[Uo]&&(o[Uo]=new Yy),o[Uo].queries.push(new Zy(d))}function Vx(t,o,a){null===t.queries&&(t.queries=new Xy),t.queries.track(new Ky(o,a))}function Ux(t,o){return t.queries.getByIndex(o)}function Qy(t){return!!Pi(t)}const ob=new mo("Application Initializer");let iv=(()=>{var t;class o{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((d,m)=>{this.resolve=d,this.reject=m}),this.appInits=Wn(ob,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const d=[];for(const x of this.appInits){const S=x();if(Ty(S))d.push(S);else if(Lv(S)){const k=new Promise((U,ie)=>{S.subscribe({complete:U,error:ie})});d.push(k)}}const m=()=>{this.done=!0,this.resolve()};Promise.all(d).then(()=>{m()}).catch(x=>{this.reject(x)}),0===d.length&&m(),this.initialized=!0}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),o})(),sb=(()=>{var t;class o{log(d){console.log(d)}warn(d){console.warn(d)}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})();const m_=new mo("LocaleId",{providedIn:"root",factory:()=>Wn(m_,fr.Optional|fr.SkipSelf)||function iD(){return typeof $localize<"u"&&$localize.locale||Mf}()}),oD=new mo("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let ab=(()=>{var t;class o{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new dt.X(!1)}add(){this.hasPendingTasks.next(!0);const d=this.taskId++;return this.pendingTasks.add(d),d}remove(d){this.pendingTasks.delete(d),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();class aD{constructor(o,a){this.ngModuleFactory=o,this.componentFactories=a}}let lD=(()=>{var t;class o{compileModuleSync(d){return new Hy(d)}compileModuleAsync(d){return Promise.resolve(this.compileModuleSync(d))}compileModuleAndAllComponentsSync(d){const m=this.compileModuleSync(d),S=ac(Pi(d).declarations).reduce((k,U)=>{const ie=jr(U);return ie&&k.push(new Cc(ie)),k},[]);return new aD(m,S)}compileModuleAndAllComponentsAsync(d){return Promise.resolve(this.compileModuleAndAllComponentsSync(d))}clearCache(){}clearCacheFor(d){}getModuleId(d){}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function db(...t){}class rl{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:d=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new su(!1),this.onMicrotaskEmpty=new su(!1),this.onStable=new su(!1),this.onError=new su(!1),typeof Zone>"u")throw new Se(908,!1);Zone.assertZonePatched();const m=this;m._nesting=0,m._outer=m._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(m._inner=m._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(m._inner=m._inner.fork(Zone.longStackTraceZoneSpec)),m.shouldCoalesceEventChangeDetection=!d&&a,m.shouldCoalesceRunChangeDetection=d,m.lastRequestAnimationFrameId=-1,m.nativeRequestAnimationFrame=function ID(){const t="function"==typeof Sr.requestAnimationFrame;let o=Sr[t?"requestAnimationFrame":"setTimeout"],a=Sr[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&o&&a){const d=o[Zone.__symbol__("OriginalDelegate")];d&&(o=d);const m=a[Zone.__symbol__("OriginalDelegate")];m&&(a=m)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:a}}().nativeRequestAnimationFrame,function PD(t){const o=()=>{!function AD(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Sr,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,lv(t),t.isCheckStableRunning=!0,av(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),lv(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,d,m,x,S,k)=>{try{return hb(t),a.invokeTask(m,x,S,k)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===x.type||t.shouldCoalesceRunChangeDetection)&&o(),fb(t)}},onInvoke:(a,d,m,x,S,k,U)=>{try{return hb(t),a.invoke(m,x,S,k,U)}finally{t.shouldCoalesceRunChangeDetection&&o(),fb(t)}},onHasTask:(a,d,m,x)=>{a.hasTask(m,x),d===m&&("microTask"==x.change?(t._hasPendingMicrotasks=x.microTask,lv(t),av(t)):"macroTask"==x.change&&(t.hasPendingMacrotasks=x.macroTask))},onHandleError:(a,d,m,x)=>(a.handleError(m,x),t.runOutsideAngular(()=>t.onError.emit(x)),!1)})}(m)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!rl.isInAngularZone())throw new Se(909,!1)}static assertNotInAngularZone(){if(rl.isInAngularZone())throw new Se(909,!1)}run(o,a,d){return this._inner.run(o,a,d)}runTask(o,a,d,m){const x=this._inner,S=x.scheduleEventTask("NgZoneEvent: "+m,o,MD,db,db);try{return x.runTask(S,a,d)}finally{x.cancelTask(S)}}runGuarded(o,a,d){return this._inner.runGuarded(o,a,d)}runOutsideAngular(o){return this._outer.run(o)}}const MD={};function av(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function lv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function hb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function fb(t){t._nesting--,av(t)}class RD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new su,this.onMicrotaskEmpty=new su,this.onStable=new su,this.onError=new su}run(o,a,d){return o.apply(a,d)}runGuarded(o,a,d){return o.apply(a,d)}runOutsideAngular(o){return o()}runTask(o,a,d,m){return o.apply(a,d)}}const pb=new mo("",{providedIn:"root",factory:mb});function mb(){const t=Wn(rl);let o=!0;const a=new l.y(m=>{o=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{m.next(o),m.complete()})}),d=new l.y(m=>{let x;t.runOutsideAngular(()=>{x=t.onStable.subscribe(()=>{rl.assertNotInAngularZone(),queueMicrotask(()=>{!o&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(o=!0,m.next(!0))})})});const S=t.onUnstable.subscribe(()=>{rl.assertInAngularZone(),o&&(o=!1,t.runOutsideAngular(()=>{m.next(!1)}))});return()=>{x.unsubscribe(),S.unsubscribe()}});return(0,ve.T)(a,d.pipe((0,Le.B)()))}const gb=new mo(""),_b=new mo("");let cv,OD=(()=>{var t;class o{constructor(d,m,x){this._ngZone=d,this.registry=m,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,cv||(function kD(t){cv=t}(x),x.addToWindow(m)),this._watchAngularEvents(),d.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{rl.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let d=this._callbacks.pop();clearTimeout(d.timeoutId),d.doneCb(this._didWork)}this._didWork=!1});else{let d=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(d)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(d=>({source:d.source,creationLocation:d.creationLocation,data:d.data})):[]}addCallback(d,m,x){let S=-1;m&&m>0&&(S=setTimeout(()=>{this._callbacks=this._callbacks.filter(k=>k.timeoutId!==S),d(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:d,timeoutId:S,updateCb:x})}whenStable(d,m,x){if(x&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(d,m,x),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(d){this.registry.registerApplication(d,this)}unregisterApplication(d){this.registry.unregisterApplication(d)}findProviders(d,m,x){return[]}}return(t=o).\u0275fac=function(d){return new(d||t)(vn(rl),vn(yb),vn(_b))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),o})(),yb=(()=>{var t;class o{constructor(){this._applications=new Map}registerApplication(d,m){this._applications.set(d,m)}unregisterApplication(d){this._applications.delete(d)}unregisterAllApplications(){this._applications.clear()}getTestability(d){return this._applications.get(d)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(d,m=!0){return cv?.findTestabilityInTree(this,d,m)??null}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})(),pd=null;const vb=new mo("AllowMultipleToken"),uv=new mo("PlatformDestroyListeners"),dv=new mo("appBootstrapListener");class BD{constructor(o,a){this.name=o,this.token=a}}function wb(t,o,a=[]){const d=`Platform: ${o}`,m=new mo(d);return(x=[])=>{let S=hv();if(!S||S.injector.get(vb,!1)){const k=[...a,...x,{provide:m,useValue:!0}];t?t(k):function ND(t){if(pd&&!pd.get(vb,!1))throw new Se(400,!1);(function xb(){!function ll(t){fa=t}(()=>{throw new Se(600,!1)})})(),pd=t;const o=t.get(Db);(function bb(t){t.get(ng,null)?.forEach(a=>a())})(t)}(function Eb(t=[],o){return fl.create({name:o,providers:[{provide:Xh,useValue:"platform"},{provide:uv,useValue:new Set([()=>pd=null])},...t]})}(k,d))}return function $D(t){const o=hv();if(!o)throw new Se(401,!1);return o}()}}function hv(){return pd?.get(Db)??null}let Db=(()=>{var t;class o{constructor(d){this._injector=d,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(d,m){const x=function VD(t="zone.js",o){return"noop"===t?new RD:"zone.js"===t?new rl(o):t}(m?.ngZone,function Cb(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:m?.ngZoneEventCoalescing,runCoalescing:m?.ngZoneRunCoalescing}));return x.run(()=>{const S=function Uw(t,o,a){return new jy(t,o,a)}(d.moduleType,this.injector,function Ab(t){return[{provide:rl,useFactory:t},{provide:Gd,multi:!0,useFactory:()=>{const o=Wn(jD,{optional:!0});return()=>o.initialize()}},{provide:Mb,useFactory:UD},{provide:pb,useFactory:mb}]}(()=>x)),k=S.injector.get(bc,null);return x.runOutsideAngular(()=>{const U=x.onError.subscribe({next:ie=>{k.handleError(ie)}});S.onDestroy(()=>{__(this._modules,S),U.unsubscribe()})}),function Tb(t,o,a){try{const d=a();return Ty(d)?d.catch(m=>{throw o.runOutsideAngular(()=>t.handleError(m)),m}):d}catch(d){throw o.runOutsideAngular(()=>t.handleError(d)),d}}(k,x,()=>{const U=S.injector.get(iv);return U.runInitializers(),U.donePromise.then(()=>(function B0(t){Yt(t,"Expected localeId to be defined"),"string"==typeof t&&(F0=t.toLowerCase().replace(/_/g,"-"))}(S.injector.get(m_,Mf)||Mf),this._moduleDoBootstrap(S),S))})})}bootstrapModule(d,m=[]){const x=Sb({},m);return function LD(t,o,a){const d=new Hy(a);return Promise.resolve(d)}(0,0,d).then(S=>this.bootstrapModuleFactory(S,x))}_moduleDoBootstrap(d){const m=d.injector.get(Rf);if(d._bootstrapComponents.length>0)d._bootstrapComponents.forEach(x=>m.bootstrap(x));else{if(!d.instance.ngDoBootstrap)throw new Se(-403,!1);d.instance.ngDoBootstrap(m)}this._modules.push(d)}onDestroy(d){this._destroyListeners.push(d)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Se(404,!1);this._modules.slice().forEach(m=>m.destroy()),this._destroyListeners.forEach(m=>m());const d=this._injector.get(uv,null);d&&(d.forEach(m=>m()),d.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(t=o).\u0275fac=function(d){return new(d||t)(vn(fl))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})();function Sb(t,o){return Array.isArray(o)?o.reduce(Sb,t):{...t,...o}}let Rf=(()=>{var t;class o{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Wn(Mb),this.zoneIsStable=Wn(pb),this.componentTypes=[],this.components=[],this.isStable=Wn(ab).hasPendingTasks.pipe((0,it.w)(d=>d?(0,Ue.of)(!1):this.zoneIsStable),(0,et.x)(),(0,Le.B)()),this._injector=Wn(kl)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(d,m){const x=d instanceof ug;if(!this._injector.get(iv).done)throw!x&&ps(d),new Se(405,!1);let k;k=x?d:this._injector.get(Kc).resolveComponentFactory(d),this.componentTypes.push(k.componentType);const U=function FD(t){return t.isBoundToModule}(k)?void 0:this._injector.get(bh),we=k.create(fl.NULL,[],m||k.selector,U),rt=we.location.nativeElement,Nt=we.injector.get(gb,null);return Nt?.registerApplication(rt),we.onDestroy(()=>{this.detachView(we.hostView),__(this.components,we),Nt?.unregisterApplication(rt)}),this._loadComponent(we),we}tick(){if(this._runningTick)throw new Se(101,!1);try{this._runningTick=!0;for(let d of this._views)d.detectChanges()}catch(d){this.internalErrorHandler(d)}finally{this._runningTick=!1}}attachView(d){const m=d;this._views.push(m),m.attachToAppRef(this)}detachView(d){const m=d;__(this._views,m),m.detachFromAppRef()}_loadComponent(d){this.attachView(d.hostView),this.tick(),this.components.push(d);const m=this._injector.get(dv,[]);m.push(...this._bootstrapListeners),m.forEach(x=>x(d))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(d=>d()),this._views.slice().forEach(d=>d.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(d){return this._destroyListeners.push(d),()=>__(this._destroyListeners,d)}destroy(){if(this._destroyed)throw new Se(406,!1);const d=this._injector;d.destroy&&!d.destroyed&&d.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function __(t,o){const a=t.indexOf(o);a>-1&&t.splice(a,1)}const Mb=new mo("",{providedIn:"root",factory:()=>Wn(bc).handleError.bind(void 0)});function UD(){const t=Wn(rl),o=Wn(bc);return a=>t.runOutsideAngular(()=>o.handleError(a))}let jD=(()=>{var t;class o{constructor(){this.zone=Wn(rl),this.applicationRef=Wn(Rf)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function GD(){return!1}function WD(){}let qD=(()=>{class o{}return o.__NG_ELEMENT_ID__=ZD,o})();function ZD(t){return function YD(t,o,a){if(gs(t)&&!a){const d=ko(t.index,o);return new Ou(d,d)}return 47&t.type?new Ou(o[Ui],o):null}(ds(),Nn(),16==(16&t))}class kb{constructor(){}supports(o){return C(o)}create(o){return new tC(o)}}const eC=(t,o)=>o;class tC{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||eC}forEachItem(o){let a;for(a=this._itHead;null!==a;a=a._next)o(a)}forEachOperation(o){let a=this._itHead,d=this._removalsHead,m=0,x=null;for(;a||d;){const S=!d||a&&a.currentIndex<Fb(d,m,x)?a:d,k=Fb(S,m,x),U=S.currentIndex;if(S===d)m--,d=d._nextRemoved;else if(a=a._next,null==S.previousIndex)m++;else{x||(x=[]);const ie=k-m,we=U-m;if(ie!=we){for(let Nt=0;Nt<ie;Nt++){const Qt=Nt<x.length?x[Nt]:x[Nt]=0,Pn=Qt+Nt;we<=Pn&&Pn<ie&&(x[Nt]=Qt+1)}x[S.previousIndex]=we-ie}}k!==U&&o(S,k,U)}}forEachPreviousItem(o){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachMovedItem(o){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}forEachIdentityChange(o){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)o(a)}diff(o){if(null==o&&(o=[]),!C(o))throw new Se(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let m,x,S,a=this._itHead,d=!1;if(Array.isArray(o)){this.length=o.length;for(let k=0;k<this.length;k++)x=o[k],S=this._trackByFn(k,x),null!==a&&Object.is(a.trackById,S)?(d&&(a=this._verifyReinsertion(a,x,S,k)),Object.is(a.item,x)||this._addIdentityChange(a,x)):(a=this._mismatch(a,x,S,k),d=!0),a=a._next}else m=0,function F(t,o){if(Array.isArray(t))for(let a=0;a<t.length;a++)o(t[a]);else{const a=t[Symbol.iterator]();let d;for(;!(d=a.next()).done;)o(d.value)}}(o,k=>{S=this._trackByFn(m,k),null!==a&&Object.is(a.trackById,S)?(d&&(a=this._verifyReinsertion(a,k,S,m)),Object.is(a.item,k)||this._addIdentityChange(a,k)):(a=this._mismatch(a,k,S,m),d=!0),a=a._next,m++}),this.length=m;return this._truncate(a),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,a,d,m){let x;return null===o?x=this._itTail:(x=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._reinsertAfter(o,x,m)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(d,m))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._moveAfter(o,x,m)):o=this._addAfter(new nC(a,d),x,m),o}_verifyReinsertion(o,a,d,m){let x=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null);return null!==x?o=this._reinsertAfter(x,o._prev,m):o.currentIndex!=m&&(o.currentIndex=m,this._addToMoves(o,m)),o}_truncate(o){for(;null!==o;){const a=o._next;this._addToRemovals(this._unlink(o)),o=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,a,d){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const m=o._prevRemoved,x=o._nextRemoved;return null===m?this._removalsHead=x:m._nextRemoved=x,null===x?this._removalsTail=m:x._prevRemoved=m,this._insertAfter(o,a,d),this._addToMoves(o,d),o}_moveAfter(o,a,d){return this._unlink(o),this._insertAfter(o,a,d),this._addToMoves(o,d),o}_addAfter(o,a,d){return this._insertAfter(o,a,d),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,a,d){const m=null===a?this._itHead:a._next;return o._next=m,o._prev=a,null===m?this._itTail=o:m._prev=o,null===a?this._itHead=o:a._next=o,null===this._linkedRecords&&(this._linkedRecords=new Lb),this._linkedRecords.put(o),o.currentIndex=d,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const a=o._prev,d=o._next;return null===a?this._itHead=d:a._next=d,null===d?this._itTail=a:d._prev=a,o}_addToMoves(o,a){return o.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Lb),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,a){return o.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class nC{constructor(o,a){this.item=o,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class rC{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,a){let d;for(d=this._head;null!==d;d=d._nextDup)if((null===a||a<=d.currentIndex)&&Object.is(d.trackById,o))return d;return null}remove(o){const a=o._prevDup,d=o._nextDup;return null===a?this._head=d:a._nextDup=d,null===d?this._tail=a:d._prevDup=a,null===this._head}}class Lb{constructor(){this.map=new Map}put(o){const a=o.trackById;let d=this.map.get(a);d||(d=new rC,this.map.set(a,d)),d.add(o)}get(o,a){const m=this.map.get(o);return m?m.get(o,a):null}remove(o){const a=o.trackById;return this.map.get(a).remove(o)&&this.map.delete(a),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Fb(t,o,a){const d=t.previousIndex;if(null===d)return d;let m=0;return a&&d<a.length&&(m=a[d]),d+o+m}class Bb{constructor(){}supports(o){return o instanceof Map||V(o)}create(){return new iC}}class iC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let a;for(a=this._mapHead;null!==a;a=a._next)o(a)}forEachPreviousItem(o){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)o(a)}forEachChangedItem(o){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}diff(o){if(o){if(!(o instanceof Map||V(o)))throw new Se(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(o,(d,m)=>{if(a&&a.key===m)this._maybeAddToChanges(a,d),this._appendAfter=a,a=a._next;else{const x=this._getOrCreateRecordForKey(m,d);a=this._insertBeforeOrAppend(a,x)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let d=a;null!==d;d=d._nextRemoved)d===this._mapHead&&(this._mapHead=null),this._records.delete(d.key),d._nextRemoved=d._next,d.previousValue=d.currentValue,d.currentValue=null,d._prev=null,d._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,a){if(o){const d=o._prev;return a._next=o,a._prev=d,o._prev=a,d&&(d._next=a),o===this._mapHead&&(this._mapHead=a),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(o,a){if(this._records.has(o)){const m=this._records.get(o);this._maybeAddToChanges(m,a);const x=m._prev,S=m._next;return x&&(x._next=S),S&&(S._prev=x),m._next=null,m._prev=null,m}const d=new oC(o);return this._records.set(o,d),d.currentValue=a,this._addToAdditions(d),d}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,a){Object.is(a,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=a,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,a){o instanceof Map?o.forEach(a):Object.keys(o).forEach(d=>a(o[d],d))}}class oC{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Nb(){return new _v([new kb])}let _v=(()=>{var t;class o{constructor(d){this.factories=d}static create(d,m){if(null!=m){const x=m.factories.slice();d=d.concat(x)}return new o(d)}static extend(d){return{provide:o,useFactory:m=>o.create(d,m||Nb()),deps:[[o,new Ch,new bd]]}}find(d){const m=this.factories.find(x=>x.supports(d));if(null!=m)return m;throw new Se(901,!1)}}return(t=o).\u0275prov=an({token:t,providedIn:"root",factory:Nb}),o})();function zb(){return new yv([new Bb])}let yv=(()=>{var t;class o{constructor(d){this.factories=d}static create(d,m){if(m){const x=m.factories.slice();d=d.concat(x)}return new o(d)}static extend(d){return{provide:o,useFactory:m=>o.create(d,m||zb()),deps:[[o,new Ch,new bd]]}}find(d){const m=this.factories.find(x=>x.supports(d));if(m)return m;throw new Se(901,!1)}}return(t=o).\u0275prov=an({token:t,providedIn:"root",factory:zb}),o})();const lC=wb(null,"core",[]);let cC=(()=>{var t;class o{constructor(d){}}return(t=o).\u0275fac=function(d){return new(d||t)(vn(Rf))},t.\u0275mod=oo({type:t}),t.\u0275inj=Bn({}),o})();function xC(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function wC(t,o){const a=jr(t),d=o.elementInjector||Kh();return new Cc(a).create(d,o.projectableNodes,o.hostElement,o.environmentInjector)}function EC(t){const o=jr(t);if(!o)return null;const a=new Cc(o);return{get selector(){return a.selector},get type(){return a.componentType},get inputs(){return a.inputs},get outputs(){return a.outputs},get ngContentSelectors(){return a.ngContentSelectors},get isStandalone(){return o.standalone},get isSignal(){return o.signals}}}},7217:(Gn,At,K)=>{"use strict";K.d(At,{Dh:()=>et,GT:()=>Le,cc:()=>pt,hO:()=>lt,on:()=>Re,pX:()=>Ue,xv:()=>xe});var I=K(1180),b=K(5879),dt=K(1920),l=K(7142);const ve=["ngOnDestroy"],Ue=(Bt,Ft,Se,Me={})=>new Proxy(Bt,{get:(ht,It)=>Se.runOutsideAngular(()=>{if(Bt[It])return Me?.spy?.get&&Me.spy.get(It,Bt[It]),Bt[It];if(ve.indexOf(It)>-1)return()=>{};const Je=Ft.toPromise().then(mt=>{const Kt=mt?.[It];return"function"==typeof Kt?Kt.bind(mt):Kt?.then?Kt.then(Ut=>Se.run(()=>Ut)):Se.run(()=>Kt)});return new Proxy(()=>{},{get:(mt,Kt)=>Je[Kt],apply:(mt,Kt,Ut)=>Je.then(dn=>{const on=dn?.(...Ut);return Me?.spy?.apply&&Me.spy.apply(It,Ut,on),on})})})}),Le=(Bt,Ft)=>{Ft.forEach(Se=>{Object.getOwnPropertyNames(Se.prototype||Se).forEach(Me=>{Object.defineProperty(Bt.prototype,Me,Object.getOwnPropertyDescriptor(Se.prototype||Se,Me))})})};class it{constructor(Ft){return Ft}}const et=new b.OlP("angularfire2.app.options"),xe=new b.OlP("angularfire2.app.name");function Re(Bt,Ft,Se){const ht="object"==typeof Se&&Se||{};ht.name=ht.name||"string"==typeof Se&&Se||"[DEFAULT]";const Je=l.Z.apps.filter(mt=>mt&&mt.name===ht.name)[0]||Ft.runOutsideAngular(()=>l.Z.initializeApp(Bt,ht));try{if(JSON.stringify(Bt)!==JSON.stringify(Je.options)){const mt=!!module.hot;Ze("error",`${Je.name} Firebase App already initialized with different options${mt?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new it(Je)}const Ze=(Bt,...Ft)=>{(0,b.X6Q)()&&typeof console<"u"&&console[Bt](...Ft)},tt={provide:it,useFactory:Re,deps:[et,b.R0b,[new b.FiY,xe]]};let lt=(()=>{var Bt;class Ft{static initializeApp(Me,ht){return{ngModule:Ft,providers:[{provide:et,useValue:Me},{provide:xe,useValue:ht}]}}constructor(Me){l.Z.registerVersion("angularfire",dt.q4.full,"core"),l.Z.registerVersion("angularfire",dt.q4.full,"app-compat"),l.Z.registerVersion("angular",b.q4F.full,Me.toString())}}return Bt=Ft,(0,I.Z)(Ft,"\u0275fac",function(Me){return new(Me||Bt)(b.LFG(b.Lbi))}),(0,I.Z)(Ft,"\u0275mod",b.oAB({type:Bt})),(0,I.Z)(Ft,"\u0275inj",b.cJS({providers:[tt]})),Ft})();function pt(Bt,Ft,Se,Me,ht){const[,It,Je]=globalThis.\u0275AngularfireInstanceCache.find(mt=>mt[0]===Bt)||[];if(It)return function vt(Bt,Ft){try{return Bt.toString()===Ft.toString()}catch{return Bt===Ft}}(ht,Je)||(nt("error",`${Ft} was already initialized on the ${Se} Firebase App with different settings.${_t?" You may need to reload as Firebase is not HMR aware.":""}`),nt("warn",{is:ht,was:Je})),It;{const mt=Me();return globalThis.\u0275AngularfireInstanceCache.push([Bt,mt,ht]),mt}}const _t=typeof module<"u"&&!!module.hot,nt=(Bt,...Ft)=>{(0,b.X6Q)()&&typeof console<"u"&&console[Bt](...Ft)};globalThis.\u0275AngularfireInstanceCache||=[]},1920:(Gn,At,K)=>{"use strict";K.d(At,{q4:()=>pt,iC:()=>on,HU:()=>It,Rf:()=>Bt,vb:()=>nt,JM:()=>_t,u3:()=>en});var I=K(1180),b=K(5879),dt=K(3182),l=K(1954),Ue=K(2631);const it=new class Le extends Ue.v{}(class ve extends l.o{constructor($e,ue){super($e,ue),this.scheduler=$e,this.work=ue}schedule($e,ue=0){return ue>0?super.schedule($e,ue):(this.delay=ue,this.state=$e,this.scheduler.flush(this),this)}execute($e,ue){return ue>0||this.closed?super.execute($e,ue):this._execute($e,ue)}requestAsyncId($e,ue,me=0){return null!=me&&me>0||null==me&&this.delay>0?super.requestAsyncId($e,ue,me):($e.flush(this),0)}});var xe=K(6321),Re=K(5592),Ze=K(9397),tt=K(5137),lt=K(3093);const pt=new b.GfV("ANGULARFIRE2_VERSION");function _t(bt,$e,ue){if($e){if(1===$e.length)return $e[0];const ct=$e.filter(Lt=>Lt.app===ue);if(1===ct.length)return ct[0]}return ue.container.getProvider(bt).getImmediate({optional:!0})}const nt=(bt,$e)=>{const ue=$e?[$e]:(0,dt.C6)(),me=[];return ue.forEach(ze=>{ze.container.getProvider(bt).instances.forEach(Lt=>{me.includes(Lt)||me.push(Lt)})}),me};class Bt{constructor(){return nt(Ft)}}const Ft="app-check";function Se(){}class Me{constructor($e,ue=it){(0,I.Z)(this,"zone",void 0),(0,I.Z)(this,"delegate",void 0),this.zone=$e,this.delegate=ue}now(){return this.delegate.now()}schedule($e,ue,me){const ze=this.zone;return this.delegate.schedule(function(Lt){ze.runGuarded(()=>{$e.apply(this,[Lt])})},ue,me)}}class ht{constructor($e){(0,I.Z)(this,"zone",void 0),(0,I.Z)(this,"task",null),this.zone=$e}call($e,ue){const me=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Se,{},Se,Se)),ue.pipe((0,Ze.b)({next:me,complete:me,error:me})).subscribe($e).add(me)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let It=(()=>{var bt;class $e{constructor(me){(0,I.Z)(this,"ngZone",void 0),(0,I.Z)(this,"outsideAngular",void 0),(0,I.Z)(this,"insideAngular",void 0),this.ngZone=me,this.outsideAngular=me.runOutsideAngular(()=>new Me(Zone.current)),this.insideAngular=me.run(()=>new Me(Zone.current,xe.z)),globalThis.\u0275AngularFireScheduler||=this}}return bt=$e,(0,I.Z)($e,"\u0275fac",function(me){return new(me||bt)(b.LFG(b.R0b))}),(0,I.Z)($e,"\u0275prov",b.Yz7({token:bt,factory:bt.\u0275fac,providedIn:"root"})),$e})();function Je(){const bt=globalThis.\u0275AngularFireScheduler;if(!bt)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return bt}function Kt(bt){return Je().ngZone.run(()=>bt())}function on(bt){return function Ht(bt){return function(ue){return(ue=ue.lift(new ht(bt.ngZone))).pipe((0,tt.R)(bt.outsideAngular),(0,lt.Q)(bt.insideAngular))}}(Je())(bt)}const Yn=(bt,$e)=>function(){const me=arguments;return $e&&setTimeout(()=>{"scheduled"===$e.state&&$e.invoke()},10),Kt(()=>bt.apply(void 0,me))},en=(bt,$e)=>function(){let ue;const me=arguments;for(let ct=0;ct<arguments.length;ct++)"function"==typeof me[ct]&&($e&&(ue||=Kt(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Se,{},Se,Se))),me[ct]=Yn(me[ct],ue));const ze=function mt(bt){return Je().ngZone.runOutsideAngular(()=>bt())}(()=>bt.apply(this,me));if(!$e){if(ze instanceof Re.y){const ct=Je();return ze.pipe((0,tt.R)(ct.outsideAngular),(0,lt.Q)(ct.insideAngular))}return Kt(()=>ze)}return ze instanceof Re.y?ze.pipe(on):ze instanceof Promise?Kt(()=>new Promise((ct,Lt)=>ze.then(Gt=>Kt(()=>ct(Gt)),Gt=>Kt(()=>Lt(Gt))))):"function"==typeof ze&&ue?function(){return setTimeout(()=>{ue&&"scheduled"===ue.state&&ue.invoke()},10),ze.apply(this,arguments)}:Kt(()=>ze)}},95:(Gn,At,K)=>{"use strict";K.d(At,{NI:()=>St,oH:()=>Oi,cw:()=>Xn,sg:()=>xr,u5:()=>ki,JU:()=>pt,a5:()=>Jr,JJ:()=>Er,JL:()=>yr,F:()=>je,UX:()=>ao,kI:()=>Kt,_Y:()=>Ri});var I=K(5879),b=K(6814),dt=K(2459),l=K(5592),ve=K(7453),Ue=K(4829),Le=K(9940),it=K(8251),et=K(7400),xe=K(2714),Ze=K(7398);let tt=(()=>{var te;class X{constructor(re,Ye){this._renderer=re,this._elementRef=Ye,this.onChange=$n=>{},this.onTouched=()=>{}}setProperty(re,Ye){this._renderer.setProperty(this._elementRef.nativeElement,re,Ye)}registerOnTouched(re){this.onTouched=re}registerOnChange(re){this.onChange=re}setDisabledState(re){this.setProperty("disabled",re)}}return(te=X).\u0275fac=function(re){return new(re||te)(I.Y36(I.Qsj),I.Y36(I.SBq))},te.\u0275dir=I.lG2({type:te}),X})(),lt=(()=>{var te;class X extends tt{}return(te=X).\u0275fac=function(){let Ae;return function(Ye){return(Ae||(Ae=I.n5z(te)))(Ye||te)}}(),te.\u0275dir=I.lG2({type:te,features:[I.qOj]}),X})();const pt=new I.OlP("NgValueAccessor"),nt={provide:pt,useExisting:(0,I.Gpc)(()=>Se),multi:!0},Ft=new I.OlP("CompositionEventMode");let Se=(()=>{var te;class X extends tt{constructor(re,Ye,$n){super(re,Ye),this._compositionMode=$n,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Bt(){const te=(0,b.q)()?(0,b.q)().getUserAgent():"";return/android (\d+)/.test(te.toLowerCase())}())}writeValue(re){this.setProperty("value",re??"")}_handleInput(re){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(re)}_compositionStart(){this._composing=!0}_compositionEnd(re){this._composing=!1,this._compositionMode&&this.onChange(re)}}return(te=X).\u0275fac=function(re){return new(re||te)(I.Y36(I.Qsj),I.Y36(I.SBq),I.Y36(Ft,8))},te.\u0275dir=I.lG2({type:te,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(re,Ye){1&re&&I.NdJ("input",function($r){return Ye._handleInput($r.target.value)})("blur",function(){return Ye.onTouched()})("compositionstart",function(){return Ye._compositionStart()})("compositionend",function($r){return Ye._compositionEnd($r.target.value)})},features:[I._Bn([nt]),I.qOj]}),X})();function Me(te){return null==te||("string"==typeof te||Array.isArray(te))&&0===te.length}function ht(te){return null!=te&&"number"==typeof te.length}const It=new I.OlP("NgValidators"),Je=new I.OlP("NgAsyncValidators"),mt=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Kt{static min(X){return function Ut(te){return X=>{if(Me(X.value)||Me(te))return null;const Ae=parseFloat(X.value);return!isNaN(Ae)&&Ae<te?{min:{min:te,actual:X.value}}:null}}(X)}static max(X){return function dn(te){return X=>{if(Me(X.value)||Me(te))return null;const Ae=parseFloat(X.value);return!isNaN(Ae)&&Ae>te?{max:{max:te,actual:X.value}}:null}}(X)}static required(X){return function on(te){return Me(te.value)?{required:!0}:null}(X)}static requiredTrue(X){return function Ht(te){return!0===te.value?null:{required:!0}}(X)}static email(X){return function Yn(te){return Me(te.value)||mt.test(te.value)?null:{email:!0}}(X)}static minLength(X){return function en(te){return X=>Me(X.value)||!ht(X.value)?null:X.value.length<te?{minlength:{requiredLength:te,actualLength:X.value.length}}:null}(X)}static maxLength(X){return function bt(te){return X=>ht(X.value)&&X.value.length>te?{maxlength:{requiredLength:te,actualLength:X.value.length}}:null}(X)}static pattern(X){return function $e(te){if(!te)return ue;let X,Ae;return"string"==typeof te?(Ae="","^"!==te.charAt(0)&&(Ae+="^"),Ae+=te,"$"!==te.charAt(te.length-1)&&(Ae+="$"),X=new RegExp(Ae)):(Ae=te.toString(),X=te),re=>{if(Me(re.value))return null;const Ye=re.value;return X.test(Ye)?null:{pattern:{requiredPattern:Ae,actualValue:Ye}}}}(X)}static nullValidator(X){return null}static compose(X){return hn(X)}static composeAsync(X){return jt(X)}}function ue(te){return null}function me(te){return null!=te}function ze(te){return(0,I.QGY)(te)?(0,dt.D)(te):te}function ct(te){let X={};return te.forEach(Ae=>{X=null!=Ae?{...X,...Ae}:X}),0===Object.keys(X).length?null:X}function Lt(te,X){return X.map(Ae=>Ae(te))}function Yt(te){return te.map(X=>function Gt(te){return!te.validate}(X)?X:Ae=>X.validate(Ae))}function hn(te){if(!te)return null;const X=te.filter(me);return 0==X.length?null:function(Ae){return ct(Lt(Ae,X))}}function sn(te){return null!=te?hn(Yt(te)):null}function jt(te){if(!te)return null;const X=te.filter(me);return 0==X.length?null:function(Ae){return function Re(...te){const X=(0,Le.jO)(te),{args:Ae,keys:re}=(0,ve.D)(te),Ye=new l.y($n=>{const{length:$r}=Ae;if(!$r)return void $n.complete();const Oo=new Array($r);let rs=$r,is=$r;for(let Ko=0;Ko<$r;Ko++){let Ds=!1;(0,Ue.Xf)(Ae[Ko]).subscribe((0,it.x)($n,La=>{Ds||(Ds=!0,is--),Oo[Ko]=La},()=>rs--,void 0,()=>{(!rs||!Ds)&&(is||$n.next(re?(0,xe.n)(re,Oo):Oo),$n.complete())}))}});return X?Ye.pipe((0,et.Z)(X)):Ye}(Lt(Ae,X).map(ze)).pipe((0,Ze.U)(ct))}}function Xt(te){return null!=te?jt(Yt(te)):null}function an(te,X){return null===te?[X]:Array.isArray(te)?[...te,X]:[te,X]}function mn(te){return te._rawValidators}function Bn(te){return te._rawAsyncValidators}function mr(te){return te?Array.isArray(te)?te:[te]:[]}function nr(te,X){return Array.isArray(te)?te.includes(X):te===X}function _r(te,X){const Ae=mr(X);return mr(te).forEach(Ye=>{nr(Ae,Ye)||Ae.push(Ye)}),Ae}function Kn(te,X){return mr(X).filter(Ae=>!nr(te,Ae))}class Lr{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(X){this._rawValidators=X||[],this._composedValidatorFn=sn(this._rawValidators)}_setAsyncValidators(X){this._rawAsyncValidators=X||[],this._composedAsyncValidatorFn=Xt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(X){this._onDestroyCallbacks.push(X)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(X=>X()),this._onDestroyCallbacks=[]}reset(X=void 0){this.control&&this.control.reset(X)}hasError(X,Ae){return!!this.control&&this.control.hasError(X,Ae)}getError(X,Ae){return this.control?this.control.getError(X,Ae):null}}class bn extends Lr{get formDirective(){return null}get path(){return null}}class Jr extends Lr{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Fi{constructor(X){this._cd=X}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Er=(()=>{var te;class X extends Fi{constructor(re){super(re)}}return(te=X).\u0275fac=function(re){return new(re||te)(I.Y36(Jr,2))},te.\u0275dir=I.lG2({type:te,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(re,Ye){2&re&&I.ekj("ng-untouched",Ye.isUntouched)("ng-touched",Ye.isTouched)("ng-pristine",Ye.isPristine)("ng-dirty",Ye.isDirty)("ng-valid",Ye.isValid)("ng-invalid",Ye.isInvalid)("ng-pending",Ye.isPending)},features:[I.qOj]}),X})(),yr=(()=>{var te;class X extends Fi{constructor(re){super(re)}}return(te=X).\u0275fac=function(re){return new(re||te)(I.Y36(bn,10))},te.\u0275dir=I.lG2({type:te,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(re,Ye){2&re&&I.ekj("ng-untouched",Ye.isUntouched)("ng-touched",Ye.isTouched)("ng-pristine",Ye.isPristine)("ng-dirty",Ye.isDirty)("ng-valid",Ye.isValid)("ng-invalid",Ye.isInvalid)("ng-pending",Ye.isPending)("ng-submitted",Ye.isSubmitted)},features:[I.qOj]}),X})();const kt="VALID",xt="INVALID",Vt="PENDING",yn="DISABLED";function Be(te){return(pe(te)?te.validators:te)||null}function de(te,X){return(pe(X)?X.asyncValidators:te)||null}function pe(te){return null!=te&&!Array.isArray(te)&&"object"==typeof te}class vn{constructor(X,Ae){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(X),this._assignAsyncValidators(Ae)}get validator(){return this._composedValidatorFn}set validator(X){this._rawValidators=this._composedValidatorFn=X}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(X){this._rawAsyncValidators=this._composedAsyncValidatorFn=X}get parent(){return this._parent}get valid(){return this.status===kt}get invalid(){return this.status===xt}get pending(){return this.status==Vt}get disabled(){return this.status===yn}get enabled(){return this.status!==yn}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(X){this._assignValidators(X)}setAsyncValidators(X){this._assignAsyncValidators(X)}addValidators(X){this.setValidators(_r(X,this._rawValidators))}addAsyncValidators(X){this.setAsyncValidators(_r(X,this._rawAsyncValidators))}removeValidators(X){this.setValidators(Kn(X,this._rawValidators))}removeAsyncValidators(X){this.setAsyncValidators(Kn(X,this._rawAsyncValidators))}hasValidator(X){return nr(this._rawValidators,X)}hasAsyncValidator(X){return nr(this._rawAsyncValidators,X)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(X={}){this.touched=!0,this._parent&&!X.onlySelf&&this._parent.markAsTouched(X)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(X=>X.markAllAsTouched())}markAsUntouched(X={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(Ae=>{Ae.markAsUntouched({onlySelf:!0})}),this._parent&&!X.onlySelf&&this._parent._updateTouched(X)}markAsDirty(X={}){this.pristine=!1,this._parent&&!X.onlySelf&&this._parent.markAsDirty(X)}markAsPristine(X={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(Ae=>{Ae.markAsPristine({onlySelf:!0})}),this._parent&&!X.onlySelf&&this._parent._updatePristine(X)}markAsPending(X={}){this.status=Vt,!1!==X.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!X.onlySelf&&this._parent.markAsPending(X)}disable(X={}){const Ae=this._parentMarkedDirty(X.onlySelf);this.status=yn,this.errors=null,this._forEachChild(re=>{re.disable({...X,onlySelf:!0})}),this._updateValue(),!1!==X.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...X,skipPristineCheck:Ae}),this._onDisabledChange.forEach(re=>re(!0))}enable(X={}){const Ae=this._parentMarkedDirty(X.onlySelf);this.status=kt,this._forEachChild(re=>{re.enable({...X,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:X.emitEvent}),this._updateAncestors({...X,skipPristineCheck:Ae}),this._onDisabledChange.forEach(re=>re(!1))}_updateAncestors(X){this._parent&&!X.onlySelf&&(this._parent.updateValueAndValidity(X),X.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(X){this._parent=X}getRawValue(){return this.value}updateValueAndValidity(X={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===kt||this.status===Vt)&&this._runAsyncValidator(X.emitEvent)),!1!==X.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!X.onlySelf&&this._parent.updateValueAndValidity(X)}_updateTreeValidity(X={emitEvent:!0}){this._forEachChild(Ae=>Ae._updateTreeValidity(X)),this.updateValueAndValidity({onlySelf:!0,emitEvent:X.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?yn:kt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(X){if(this.asyncValidator){this.status=Vt,this._hasOwnPendingAsyncValidator=!0;const Ae=ze(this.asyncValidator(this));this._asyncValidationSubscription=Ae.subscribe(re=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(re,{emitEvent:X})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(X,Ae={}){this.errors=X,this._updateControlsErrors(!1!==Ae.emitEvent)}get(X){let Ae=X;return null==Ae||(Array.isArray(Ae)||(Ae=Ae.split(".")),0===Ae.length)?null:Ae.reduce((re,Ye)=>re&&re._find(Ye),this)}getError(X,Ae){const re=Ae?this.get(Ae):this;return re&&re.errors?re.errors[X]:null}hasError(X,Ae){return!!this.getError(X,Ae)}get root(){let X=this;for(;X._parent;)X=X._parent;return X}_updateControlsErrors(X){this.status=this._calculateStatus(),X&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(X)}_initObservables(){this.valueChanges=new I.vpe,this.statusChanges=new I.vpe}_calculateStatus(){return this._allControlsDisabled()?yn:this.errors?xt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Vt)?Vt:this._anyControlsHaveStatus(xt)?xt:kt}_anyControlsHaveStatus(X){return this._anyControls(Ae=>Ae.status===X)}_anyControlsDirty(){return this._anyControls(X=>X.dirty)}_anyControlsTouched(){return this._anyControls(X=>X.touched)}_updatePristine(X={}){this.pristine=!this._anyControlsDirty(),this._parent&&!X.onlySelf&&this._parent._updatePristine(X)}_updateTouched(X={}){this.touched=this._anyControlsTouched(),this._parent&&!X.onlySelf&&this._parent._updateTouched(X)}_registerOnCollectionChange(X){this._onCollectionChange=X}_setUpdateStrategy(X){pe(X)&&null!=X.updateOn&&(this._updateOn=X.updateOn)}_parentMarkedDirty(X){return!X&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(X){return null}_assignValidators(X){this._rawValidators=Array.isArray(X)?X.slice():X,this._composedValidatorFn=function le(te){return Array.isArray(te)?sn(te):te||null}(this._rawValidators)}_assignAsyncValidators(X){this._rawAsyncValidators=Array.isArray(X)?X.slice():X,this._composedAsyncValidatorFn=function Ne(te){return Array.isArray(te)?Xt(te):te||null}(this._rawAsyncValidators)}}class Xn extends vn{constructor(X,Ae,re){super(Be(Ae),de(re,Ae)),this.controls=X,this._initObservables(),this._setUpdateStrategy(Ae),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(X,Ae){return this.controls[X]?this.controls[X]:(this.controls[X]=Ae,Ae.setParent(this),Ae._registerOnCollectionChange(this._onCollectionChange),Ae)}addControl(X,Ae,re={}){this.registerControl(X,Ae),this.updateValueAndValidity({emitEvent:re.emitEvent}),this._onCollectionChange()}removeControl(X,Ae={}){this.controls[X]&&this.controls[X]._registerOnCollectionChange(()=>{}),delete this.controls[X],this.updateValueAndValidity({emitEvent:Ae.emitEvent}),this._onCollectionChange()}setControl(X,Ae,re={}){this.controls[X]&&this.controls[X]._registerOnCollectionChange(()=>{}),delete this.controls[X],Ae&&this.registerControl(X,Ae),this.updateValueAndValidity({emitEvent:re.emitEvent}),this._onCollectionChange()}contains(X){return this.controls.hasOwnProperty(X)&&this.controls[X].enabled}setValue(X,Ae={}){(function $t(te,X,Ae){te._forEachChild((re,Ye)=>{if(void 0===Ae[Ye])throw new I.vHH(1002,"")})})(this,0,X),Object.keys(X).forEach(re=>{(function ot(te,X,Ae){const re=te.controls;if(!(X?Object.keys(re):re).length)throw new I.vHH(1e3,"");if(!re[Ae])throw new I.vHH(1001,"")})(this,!0,re),this.controls[re].setValue(X[re],{onlySelf:!0,emitEvent:Ae.emitEvent})}),this.updateValueAndValidity(Ae)}patchValue(X,Ae={}){null!=X&&(Object.keys(X).forEach(re=>{const Ye=this.controls[re];Ye&&Ye.patchValue(X[re],{onlySelf:!0,emitEvent:Ae.emitEvent})}),this.updateValueAndValidity(Ae))}reset(X={},Ae={}){this._forEachChild((re,Ye)=>{re.reset(X[Ye],{onlySelf:!0,emitEvent:Ae.emitEvent})}),this._updatePristine(Ae),this._updateTouched(Ae),this.updateValueAndValidity(Ae)}getRawValue(){return this._reduceChildren({},(X,Ae,re)=>(X[re]=Ae.getRawValue(),X))}_syncPendingControls(){let X=this._reduceChildren(!1,(Ae,re)=>!!re._syncPendingControls()||Ae);return X&&this.updateValueAndValidity({onlySelf:!0}),X}_forEachChild(X){Object.keys(this.controls).forEach(Ae=>{const re=this.controls[Ae];re&&X(re,Ae)})}_setUpControls(){this._forEachChild(X=>{X.setParent(this),X._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(X){for(const[Ae,re]of Object.entries(this.controls))if(this.contains(Ae)&&X(re))return!0;return!1}_reduceValue(){return this._reduceChildren({},(Ae,re,Ye)=>((re.enabled||this.disabled)&&(Ae[Ye]=re.value),Ae))}_reduceChildren(X,Ae){let re=X;return this._forEachChild((Ye,$n)=>{re=Ae(re,Ye,$n)}),re}_allControlsDisabled(){for(const X of Object.keys(this.controls))if(this.controls[X].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(X){return this.controls.hasOwnProperty(X)?this.controls[X]:null}}const ni=new I.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>ro}),ro="always";function rn(te,X,Ae=ro){Zn(te,X),X.valueAccessor.writeValue(te.value),(te.disabled||"always"===Ae)&&X.valueAccessor.setDisabledState?.(te.disabled),function Fr(te,X){X.valueAccessor.registerOnChange(Ae=>{te._pendingValue=Ae,te._pendingChange=!0,te._pendingDirty=!0,"change"===te.updateOn&&Ti(te,X)})}(te,X),function Qr(te,X){const Ae=(re,Ye)=>{X.valueAccessor.writeValue(re),Ye&&X.viewToModelUpdate(re)};te.registerOnChange(Ae),X._registerOnDestroy(()=>{te._unregisterOnChange(Ae)})}(te,X),function fi(te,X){X.valueAccessor.registerOnTouched(()=>{te._pendingTouched=!0,"blur"===te.updateOn&&te._pendingChange&&Ti(te,X),"submit"!==te.updateOn&&te.markAsTouched()})}(te,X),function ur(te,X){if(X.valueAccessor.setDisabledState){const Ae=re=>{X.valueAccessor.setDisabledState(re)};te.registerOnDisabledChange(Ae),X._registerOnDestroy(()=>{te._unregisterOnDisabledChange(Ae)})}}(te,X)}function Tt(te,X,Ae=!0){const re=()=>{};X.valueAccessor&&(X.valueAccessor.registerOnChange(re),X.valueAccessor.registerOnTouched(re)),Rr(te,X),te&&(X._invokeOnDestroyCallbacks(),te._registerOnCollectionChange(()=>{}))}function Dn(te,X){te.forEach(Ae=>{Ae.registerOnValidatorChange&&Ae.registerOnValidatorChange(X)})}function Zn(te,X){const Ae=mn(te);null!==X.validator?te.setValidators(an(Ae,X.validator)):"function"==typeof Ae&&te.setValidators([Ae]);const re=Bn(te);null!==X.asyncValidator?te.setAsyncValidators(an(re,X.asyncValidator)):"function"==typeof re&&te.setAsyncValidators([re]);const Ye=()=>te.updateValueAndValidity();Dn(X._rawValidators,Ye),Dn(X._rawAsyncValidators,Ye)}function Rr(te,X){let Ae=!1;if(null!==te){if(null!==X.validator){const Ye=mn(te);if(Array.isArray(Ye)&&Ye.length>0){const $n=Ye.filter($r=>$r!==X.validator);$n.length!==Ye.length&&(Ae=!0,te.setValidators($n))}}if(null!==X.asyncValidator){const Ye=Bn(te);if(Array.isArray(Ye)&&Ye.length>0){const $n=Ye.filter($r=>$r!==X.asyncValidator);$n.length!==Ye.length&&(Ae=!0,te.setAsyncValidators($n))}}}const re=()=>{};return Dn(X._rawValidators,re),Dn(X._rawAsyncValidators,re),Ae}function Ti(te,X){te._pendingDirty&&te.markAsDirty(),te.setValue(te._pendingValue,{emitModelToViewChange:!1}),X.viewToModelUpdate(te._pendingValue),te._pendingChange=!1}function ui(te,X){Zn(te,X)}function ss(te,X){te._syncPendingControls(),X.forEach(Ae=>{const re=Ae.control;"submit"===re.updateOn&&re._pendingChange&&(Ae.viewToModelUpdate(re._pendingValue),re._pendingChange=!1)})}const Cr={provide:bn,useExisting:(0,I.Gpc)(()=>je)},fe=(()=>Promise.resolve())();let je=(()=>{var te;class X extends bn{constructor(re,Ye,$n){super(),this.callSetDisabledState=$n,this.submitted=!1,this._directives=new Set,this.ngSubmit=new I.vpe,this.form=new Xn({},sn(re),Xt(Ye))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(re){fe.then(()=>{const Ye=this._findContainer(re.path);re.control=Ye.registerControl(re.name,re.control),rn(re.control,re,this.callSetDisabledState),re.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(re)})}getControl(re){return this.form.get(re.path)}removeControl(re){fe.then(()=>{const Ye=this._findContainer(re.path);Ye&&Ye.removeControl(re.name),this._directives.delete(re)})}addFormGroup(re){fe.then(()=>{const Ye=this._findContainer(re.path),$n=new Xn({});ui($n,re),Ye.registerControl(re.name,$n),$n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(re){fe.then(()=>{const Ye=this._findContainer(re.path);Ye&&Ye.removeControl(re.name)})}getFormGroup(re){return this.form.get(re.path)}updateModel(re,Ye){fe.then(()=>{this.form.get(re.path).setValue(Ye)})}setValue(re){this.control.setValue(re)}onSubmit(re){return this.submitted=!0,ss(this.form,this._directives),this.ngSubmit.emit(re),"dialog"===re?.target?.method}onReset(){this.resetForm()}resetForm(re=void 0){this.form.reset(re),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(re){return re.pop(),re.length?this.form.get(re):this.form}}return(te=X).\u0275fac=function(re){return new(re||te)(I.Y36(It,10),I.Y36(Je,10),I.Y36(ni,8))},te.\u0275dir=I.lG2({type:te,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(re,Ye){1&re&&I.NdJ("submit",function($r){return Ye.onSubmit($r)})("reset",function(){return Ye.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[I._Bn([Cr]),I.qOj]}),X})();function Ce(te,X){const Ae=te.indexOf(X);Ae>-1&&te.splice(Ae,1)}function Ve(te){return"object"==typeof te&&null!==te&&2===Object.keys(te).length&&"value"in te&&"disabled"in te}const St=class extends vn{constructor(X=null,Ae,re){super(Be(Ae),de(re,Ae)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(X),this._setUpdateStrategy(Ae),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),pe(Ae)&&(Ae.nonNullable||Ae.initialValueIsDefault)&&(this.defaultValue=Ve(X)?X.value:X)}setValue(X,Ae={}){this.value=this._pendingValue=X,this._onChange.length&&!1!==Ae.emitModelToViewChange&&this._onChange.forEach(re=>re(this.value,!1!==Ae.emitViewToModelChange)),this.updateValueAndValidity(Ae)}patchValue(X,Ae={}){this.setValue(X,Ae)}reset(X=this.defaultValue,Ae={}){this._applyFormState(X),this.markAsPristine(Ae),this.markAsUntouched(Ae),this.setValue(this.value,Ae),this._pendingChange=!1}_updateValue(){}_anyControls(X){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(X){this._onChange.push(X)}_unregisterOnChange(X){Ce(this._onChange,X)}registerOnDisabledChange(X){this._onDisabledChange.push(X)}_unregisterOnDisabledChange(X){Ce(this._onDisabledChange,X)}_forEachChild(X){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(X){Ve(X)?(this.value=this._pendingValue=X.value,X.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=X}};let Ri=(()=>{var te;class X{}return(te=X).\u0275fac=function(re){return new(re||te)},te.\u0275dir=I.lG2({type:te,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),X})(),ps=(()=>{var te;class X{}return(te=X).\u0275fac=function(re){return new(re||te)},te.\u0275mod=I.oAB({type:te}),te.\u0275inj=I.cJS({}),X})();const Ni=new I.OlP("NgModelWithFormControlWarning"),Os={provide:Jr,useExisting:(0,I.Gpc)(()=>Oi)};let Oi=(()=>{var te;class X extends Jr{set isDisabled(re){}constructor(re,Ye,$n,$r,Oo){super(),this._ngModelWarningConfig=$r,this.callSetDisabledState=Oo,this.update=new I.vpe,this._ngModelWarningSent=!1,this._setValidators(re),this._setAsyncValidators(Ye),this.valueAccessor=function Po(te,X){if(!X)return null;let Ae,re,Ye;return Array.isArray(X),X.forEach($n=>{$n.constructor===Se?Ae=$n:function Vi(te){return Object.getPrototypeOf(te.constructor)===lt}($n)?re=$n:Ye=$n}),Ye||re||Ae||null}(0,$n)}ngOnChanges(re){if(this._isControlChanged(re)){const Ye=re.form.previousValue;Ye&&Tt(Ye,this,!1),rn(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}(function Yo(te,X){if(!te.hasOwnProperty("model"))return!1;const Ae=te.model;return!!Ae.isFirstChange()||!Object.is(X,Ae.currentValue)})(re,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Tt(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(re){this.viewModel=re,this.update.emit(re)}_isControlChanged(re){return re.hasOwnProperty("form")}}return(te=X)._ngModelWarningSentOnce=!1,te.\u0275fac=function(re){return new(re||te)(I.Y36(It,10),I.Y36(Je,10),I.Y36(pt,10),I.Y36(Ni,8),I.Y36(ni,8))},te.\u0275dir=I.lG2({type:te,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[I._Bn([Os]),I.qOj,I.TTD]}),X})();const rr={provide:bn,useExisting:(0,I.Gpc)(()=>xr)};let xr=(()=>{var te;class X extends bn{constructor(re,Ye,$n){super(),this.callSetDisabledState=$n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new I.vpe,this._setValidators(re),this._setAsyncValidators(Ye)}ngOnChanges(re){this._checkFormPresent(),re.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Rr(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(re){const Ye=this.form.get(re.path);return rn(Ye,re,this.callSetDisabledState),Ye.updateValueAndValidity({emitEvent:!1}),this.directives.push(re),Ye}getControl(re){return this.form.get(re.path)}removeControl(re){Tt(re.control||null,re,!1),function No(te,X){const Ae=te.indexOf(X);Ae>-1&&te.splice(Ae,1)}(this.directives,re)}addFormGroup(re){this._setUpFormContainer(re)}removeFormGroup(re){this._cleanUpFormContainer(re)}getFormGroup(re){return this.form.get(re.path)}addFormArray(re){this._setUpFormContainer(re)}removeFormArray(re){this._cleanUpFormContainer(re)}getFormArray(re){return this.form.get(re.path)}updateModel(re,Ye){this.form.get(re.path).setValue(Ye)}onSubmit(re){return this.submitted=!0,ss(this.form,this.directives),this.ngSubmit.emit(re),"dialog"===re?.target?.method}onReset(){this.resetForm()}resetForm(re=void 0){this.form.reset(re),this.submitted=!1}_updateDomValue(){this.directives.forEach(re=>{const Ye=re.control,$n=this.form.get(re.path);Ye!==$n&&(Tt(Ye||null,re),(te=>te instanceof St)($n)&&(rn($n,re,this.callSetDisabledState),re.control=$n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(re){const Ye=this.form.get(re.path);ui(Ye,re),Ye.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(re){if(this.form){const Ye=this.form.get(re.path);Ye&&function qr(te,X){return Rr(te,X)}(Ye,re)&&Ye.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Zn(this.form,this),this._oldForm&&Rr(this._oldForm,this)}_checkFormPresent(){}}return(te=X).\u0275fac=function(re){return new(re||te)(I.Y36(It,10),I.Y36(Je,10),I.Y36(ni,8))},te.\u0275dir=I.lG2({type:te,selectors:[["","formGroup",""]],hostBindings:function(re,Ye){1&re&&I.NdJ("submit",function($r){return Ye.onSubmit($r)})("reset",function(){return Ye.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[I._Bn([rr]),I.qOj,I.TTD]}),X})(),Js=(()=>{var te;class X{}return(te=X).\u0275fac=function(re){return new(re||te)},te.\u0275mod=I.oAB({type:te}),te.\u0275inj=I.cJS({imports:[ps]}),X})(),ki=(()=>{var te;class X{static withConfig(re){return{ngModule:X,providers:[{provide:ni,useValue:re.callSetDisabledState??ro}]}}}return(te=X).\u0275fac=function(re){return new(re||te)},te.\u0275mod=I.oAB({type:te}),te.\u0275inj=I.cJS({imports:[Js]}),X})(),ao=(()=>{var te;class X{static withConfig(re){return{ngModule:X,providers:[{provide:Ni,useValue:re.warnOnNgModelWithFormControl??"always"},{provide:ni,useValue:re.callSetDisabledState??ro}]}}}return(te=X).\u0275fac=function(re){return new(re||te)},te.\u0275mod=I.oAB({type:te}),te.\u0275inj=I.cJS({imports:[Js]}),X})()},6593:(Gn,At,K)=>{"use strict";K.d(At,{Dx:()=>Jr,b2:()=>nr,q6:()=>an,se:()=>mt});var I=K(5879),b=K(6814);class dt extends b.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class l extends dt{static makeCurrent(){(0,b.HT)(new l)}onAndCancel(de,Ne,pe){return de.addEventListener(Ne,pe),()=>{de.removeEventListener(Ne,pe)}}dispatchEvent(de,Ne){de.dispatchEvent(Ne)}remove(de){de.parentNode&&de.parentNode.removeChild(de)}createElement(de,Ne){return(Ne=Ne||this.getDefaultDocument()).createElement(de)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(de){return de.nodeType===Node.ELEMENT_NODE}isShadowRoot(de){return de instanceof DocumentFragment}getGlobalEventTarget(de,Ne){return"window"===Ne?window:"document"===Ne?de:"body"===Ne?de.body:null}getBaseHref(de){const Ne=function Ue(){return ve=ve||document.querySelector("base"),ve?ve.getAttribute("href"):null}();return null==Ne?null:function it(le){Le=Le||document.createElement("a"),Le.setAttribute("href",le);const de=Le.pathname;return"/"===de.charAt(0)?de:`/${de}`}(Ne)}resetBaseElement(){ve=null}getUserAgent(){return window.navigator.userAgent}getCookie(de){return(0,b.Mx)(document.cookie,de)}}let Le,ve=null,xe=(()=>{var le;class de{build(){return new XMLHttpRequest}}return(le=de).\u0275fac=function(pe){return new(pe||le)},le.\u0275prov=I.Yz7({token:le,factory:le.\u0275fac}),de})();const Re=new I.OlP("EventManagerPlugins");let Ze=(()=>{var le;class de{constructor(pe,ot){this._zone=ot,this._eventNameToPlugin=new Map,pe.forEach($t=>{$t.manager=this}),this._plugins=pe.slice().reverse()}addEventListener(pe,ot,$t){return this._findPluginFor(ot).addEventListener(pe,ot,$t)}getZone(){return this._zone}_findPluginFor(pe){let ot=this._eventNameToPlugin.get(pe);if(ot)return ot;if(ot=this._plugins.find(vn=>vn.supports(pe)),!ot)throw new I.vHH(5101,!1);return this._eventNameToPlugin.set(pe,ot),ot}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(Re),I.LFG(I.R0b))},le.\u0275prov=I.Yz7({token:le,factory:le.\u0275fac}),de})();class tt{constructor(de){this._doc=de}}const lt="ng-app-id";let pt=(()=>{var le;class de{constructor(pe,ot,$t,vn={}){this.doc=pe,this.appId=ot,this.nonce=$t,this.platformId=vn,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,b.PM)(vn),this.resetHostNodes()}addStyles(pe){for(const ot of pe)1===this.changeUsageCount(ot,1)&&this.onStyleAdded(ot)}removeStyles(pe){for(const ot of pe)this.changeUsageCount(ot,-1)<=0&&this.onStyleRemoved(ot)}ngOnDestroy(){const pe=this.styleNodesInDOM;pe&&(pe.forEach(ot=>ot.remove()),pe.clear());for(const ot of this.getAllStyles())this.onStyleRemoved(ot);this.resetHostNodes()}addHost(pe){this.hostNodes.add(pe);for(const ot of this.getAllStyles())this.addStyleToHost(pe,ot)}removeHost(pe){this.hostNodes.delete(pe)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(pe){for(const ot of this.hostNodes)this.addStyleToHost(ot,pe)}onStyleRemoved(pe){const ot=this.styleRef;ot.get(pe)?.elements?.forEach($t=>$t.remove()),ot.delete(pe)}collectServerRenderedStyles(){const pe=this.doc.head?.querySelectorAll(`style[${lt}="${this.appId}"]`);if(pe?.length){const ot=new Map;return pe.forEach($t=>{null!=$t.textContent&&ot.set($t.textContent,$t)}),ot}return null}changeUsageCount(pe,ot){const $t=this.styleRef;if($t.has(pe)){const vn=$t.get(pe);return vn.usage+=ot,vn.usage}return $t.set(pe,{usage:ot,elements:[]}),ot}getStyleElement(pe,ot){const $t=this.styleNodesInDOM,vn=$t?.get(ot);if(vn?.parentNode===pe)return $t.delete(ot),vn.removeAttribute(lt),vn;{const Xn=this.doc.createElement("style");return this.nonce&&Xn.setAttribute("nonce",this.nonce),Xn.textContent=ot,this.platformIsServer&&Xn.setAttribute(lt,this.appId),Xn}}addStyleToHost(pe,ot){const $t=this.getStyleElement(pe,ot);pe.appendChild($t);const vn=this.styleRef,Xn=vn.get(ot)?.elements;Xn?Xn.push($t):vn.set(ot,{elements:[$t],usage:1})}resetHostNodes(){const pe=this.hostNodes;pe.clear(),pe.add(this.doc.head)}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(b.K0),I.LFG(I.AFp),I.LFG(I.Ojb,8),I.LFG(I.Lbi))},le.\u0275prov=I.Yz7({token:le,factory:le.\u0275fac}),de})();const vt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},_t=/%COMP%/g,Me=new I.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Je(le,de){return de.map(Ne=>Ne.replace(_t,le))}let mt=(()=>{var le;class de{constructor(pe,ot,$t,vn,Xn,Wn,hr,vr=null){this.eventManager=pe,this.sharedStylesHost=ot,this.appId=$t,this.removeStylesOnCompDestroy=vn,this.doc=Xn,this.platformId=Wn,this.ngZone=hr,this.nonce=vr,this.rendererByCompId=new Map,this.platformIsServer=(0,b.PM)(Wn),this.defaultRenderer=new Kt(pe,Xn,hr,this.platformIsServer)}createRenderer(pe,ot){if(!pe||!ot)return this.defaultRenderer;this.platformIsServer&&ot.encapsulation===I.ifc.ShadowDom&&(ot={...ot,encapsulation:I.ifc.Emulated});const $t=this.getOrCreateRenderer(pe,ot);return $t instanceof en?$t.applyToHost(pe):$t instanceof Yn&&$t.applyStyles(),$t}getOrCreateRenderer(pe,ot){const $t=this.rendererByCompId;let vn=$t.get(ot.id);if(!vn){const Xn=this.doc,Wn=this.ngZone,hr=this.eventManager,vr=this.sharedStylesHost,Wr=this.removeStylesOnCompDestroy,ni=this.platformIsServer;switch(ot.encapsulation){case I.ifc.Emulated:vn=new en(hr,vr,ot,this.appId,Wr,Xn,Wn,ni);break;case I.ifc.ShadowDom:return new Ht(hr,vr,pe,ot,Xn,Wn,this.nonce,ni);default:vn=new Yn(hr,vr,ot,Wr,Xn,Wn,ni)}$t.set(ot.id,vn)}return vn}ngOnDestroy(){this.rendererByCompId.clear()}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(Ze),I.LFG(pt),I.LFG(I.AFp),I.LFG(Me),I.LFG(b.K0),I.LFG(I.Lbi),I.LFG(I.R0b),I.LFG(I.Ojb))},le.\u0275prov=I.Yz7({token:le,factory:le.\u0275fac}),de})();class Kt{constructor(de,Ne,pe,ot){this.eventManager=de,this.doc=Ne,this.ngZone=pe,this.platformIsServer=ot,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(de,Ne){return Ne?this.doc.createElementNS(vt[Ne]||Ne,de):this.doc.createElement(de)}createComment(de){return this.doc.createComment(de)}createText(de){return this.doc.createTextNode(de)}appendChild(de,Ne){(on(de)?de.content:de).appendChild(Ne)}insertBefore(de,Ne,pe){de&&(on(de)?de.content:de).insertBefore(Ne,pe)}removeChild(de,Ne){de&&de.removeChild(Ne)}selectRootElement(de,Ne){let pe="string"==typeof de?this.doc.querySelector(de):de;if(!pe)throw new I.vHH(-5104,!1);return Ne||(pe.textContent=""),pe}parentNode(de){return de.parentNode}nextSibling(de){return de.nextSibling}setAttribute(de,Ne,pe,ot){if(ot){Ne=ot+":"+Ne;const $t=vt[ot];$t?de.setAttributeNS($t,Ne,pe):de.setAttribute(Ne,pe)}else de.setAttribute(Ne,pe)}removeAttribute(de,Ne,pe){if(pe){const ot=vt[pe];ot?de.removeAttributeNS(ot,Ne):de.removeAttribute(`${pe}:${Ne}`)}else de.removeAttribute(Ne)}addClass(de,Ne){de.classList.add(Ne)}removeClass(de,Ne){de.classList.remove(Ne)}setStyle(de,Ne,pe,ot){ot&(I.JOm.DashCase|I.JOm.Important)?de.style.setProperty(Ne,pe,ot&I.JOm.Important?"important":""):de.style[Ne]=pe}removeStyle(de,Ne,pe){pe&I.JOm.DashCase?de.style.removeProperty(Ne):de.style[Ne]=""}setProperty(de,Ne,pe){de[Ne]=pe}setValue(de,Ne){de.nodeValue=Ne}listen(de,Ne,pe){if("string"==typeof de&&!(de=(0,b.q)().getGlobalEventTarget(this.doc,de)))throw new Error(`Unsupported event target ${de} for event ${Ne}`);return this.eventManager.addEventListener(de,Ne,this.decoratePreventDefault(pe))}decoratePreventDefault(de){return Ne=>{if("__ngUnwrap__"===Ne)return de;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>de(Ne)):de(Ne))&&Ne.preventDefault()}}}function on(le){return"TEMPLATE"===le.tagName&&void 0!==le.content}class Ht extends Kt{constructor(de,Ne,pe,ot,$t,vn,Xn,Wn){super(de,$t,vn,Wn),this.sharedStylesHost=Ne,this.hostEl=pe,this.shadowRoot=pe.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const hr=Je(ot.id,ot.styles);for(const vr of hr){const Wr=document.createElement("style");Xn&&Wr.setAttribute("nonce",Xn),Wr.textContent=vr,this.shadowRoot.appendChild(Wr)}}nodeOrShadowRoot(de){return de===this.hostEl?this.shadowRoot:de}appendChild(de,Ne){return super.appendChild(this.nodeOrShadowRoot(de),Ne)}insertBefore(de,Ne,pe){return super.insertBefore(this.nodeOrShadowRoot(de),Ne,pe)}removeChild(de,Ne){return super.removeChild(this.nodeOrShadowRoot(de),Ne)}parentNode(de){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(de)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Yn extends Kt{constructor(de,Ne,pe,ot,$t,vn,Xn,Wn){super(de,$t,vn,Xn),this.sharedStylesHost=Ne,this.removeStylesOnCompDestroy=ot,this.styles=Wn?Je(Wn,pe.styles):pe.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class en extends Yn{constructor(de,Ne,pe,ot,$t,vn,Xn,Wn){const hr=ot+"-"+pe.id;super(de,Ne,pe,$t,vn,Xn,Wn,hr),this.contentAttr=function ht(le){return"_ngcontent-%COMP%".replace(_t,le)}(hr),this.hostAttr=function It(le){return"_nghost-%COMP%".replace(_t,le)}(hr)}applyToHost(de){this.applyStyles(),this.setAttribute(de,this.hostAttr,"")}createElement(de,Ne){const pe=super.createElement(de,Ne);return super.setAttribute(pe,this.contentAttr,""),pe}}let bt=(()=>{var le;class de extends tt{constructor(pe){super(pe)}supports(pe){return!0}addEventListener(pe,ot,$t){return pe.addEventListener(ot,$t,!1),()=>this.removeEventListener(pe,ot,$t)}removeEventListener(pe,ot,$t){return pe.removeEventListener(ot,$t)}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(b.K0))},le.\u0275prov=I.Yz7({token:le,factory:le.\u0275fac}),de})();const $e=["alt","control","meta","shift"],ue={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},me={alt:le=>le.altKey,control:le=>le.ctrlKey,meta:le=>le.metaKey,shift:le=>le.shiftKey};let ze=(()=>{var le;class de extends tt{constructor(pe){super(pe)}supports(pe){return null!=de.parseEventName(pe)}addEventListener(pe,ot,$t){const vn=de.parseEventName(ot),Xn=de.eventCallback(vn.fullKey,$t,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,b.q)().onAndCancel(pe,vn.domEventName,Xn))}static parseEventName(pe){const ot=pe.toLowerCase().split("."),$t=ot.shift();if(0===ot.length||"keydown"!==$t&&"keyup"!==$t)return null;const vn=de._normalizeKey(ot.pop());let Xn="",Wn=ot.indexOf("code");if(Wn>-1&&(ot.splice(Wn,1),Xn="code."),$e.forEach(vr=>{const Wr=ot.indexOf(vr);Wr>-1&&(ot.splice(Wr,1),Xn+=vr+".")}),Xn+=vn,0!=ot.length||0===vn.length)return null;const hr={};return hr.domEventName=$t,hr.fullKey=Xn,hr}static matchEventFullKeyCode(pe,ot){let $t=ue[pe.key]||pe.key,vn="";return ot.indexOf("code.")>-1&&($t=pe.code,vn="code."),!(null==$t||!$t)&&($t=$t.toLowerCase()," "===$t?$t="space":"."===$t&&($t="dot"),$e.forEach(Xn=>{Xn!==$t&&(0,me[Xn])(pe)&&(vn+=Xn+".")}),vn+=$t,vn===ot)}static eventCallback(pe,ot,$t){return vn=>{de.matchEventFullKeyCode(vn,pe)&&$t.runGuarded(()=>ot(vn))}}static _normalizeKey(pe){return"esc"===pe?"escape":pe}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(b.K0))},le.\u0275prov=I.Yz7({token:le,factory:le.\u0275fac}),de})();const an=(0,I.eFA)(I._c5,"browser",[{provide:I.Lbi,useValue:b.bD},{provide:I.g9A,useValue:function hn(){l.makeCurrent()},multi:!0},{provide:b.K0,useFactory:function jt(){return(0,I.RDi)(document),document},deps:[]}]),mn=new I.OlP(""),Bn=[{provide:I.rWj,useClass:class et{addToWindow(de){I.dqk.getAngularTestability=(pe,ot=!0)=>{const $t=de.findTestabilityInTree(pe,ot);if(null==$t)throw new I.vHH(5103,!1);return $t},I.dqk.getAllAngularTestabilities=()=>de.getAllTestabilities(),I.dqk.getAllAngularRootElements=()=>de.getAllRootElements(),I.dqk.frameworkStabilizers||(I.dqk.frameworkStabilizers=[]),I.dqk.frameworkStabilizers.push(pe=>{const ot=I.dqk.getAllAngularTestabilities();let $t=ot.length,vn=!1;const Xn=function(Wn){vn=vn||Wn,$t--,0==$t&&pe(vn)};ot.forEach(Wn=>{Wn.whenStable(Xn)})})}findTestabilityInTree(de,Ne,pe){return null==Ne?null:de.getTestability(Ne)??(pe?(0,b.q)().isShadowRoot(Ne)?this.findTestabilityInTree(de,Ne.host,!0):this.findTestabilityInTree(de,Ne.parentElement,!0):null)}},deps:[]},{provide:I.lri,useClass:I.dDg,deps:[I.R0b,I.eoX,I.rWj]},{provide:I.dDg,useClass:I.dDg,deps:[I.R0b,I.eoX,I.rWj]}],mr=[{provide:I.zSh,useValue:"root"},{provide:I.qLn,useFactory:function sn(){return new I.qLn},deps:[]},{provide:Re,useClass:bt,multi:!0,deps:[b.K0,I.R0b,I.Lbi]},{provide:Re,useClass:ze,multi:!0,deps:[b.K0]},mt,pt,Ze,{provide:I.FYo,useExisting:mt},{provide:b.JF,useClass:xe,deps:[]},[]];let nr=(()=>{var le;class de{constructor(pe){}static withServerTransition(pe){return{ngModule:de,providers:[{provide:I.AFp,useValue:pe.appId}]}}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(mn,12))},le.\u0275mod=I.oAB({type:le}),le.\u0275inj=I.cJS({providers:[...mr,...Bn],imports:[b.ez,I.hGG]}),de})(),Jr=(()=>{var le;class de{constructor(pe){this._doc=pe}getTitle(){return this._doc.title}setTitle(pe){this._doc.title=pe||""}}return(le=de).\u0275fac=function(pe){return new(pe||le)(I.LFG(b.K0))},le.\u0275prov=I.Yz7({token:le,factory:function(pe){let ot=null;return ot=pe?new pe:function bn(){return new Jr((0,I.LFG)(b.K0))}(),ot},providedIn:"root"}),de})();typeof window<"u"&&window},1160:(Gn,At,K)=>{"use strict";K.d(At,{gz:()=>Qi,y6:()=>kr,OD:()=>Yo,eC:()=>Yt,wm:()=>or,wN:()=>wn,F0:()=>Yi,rH:()=>Cs,Bz:()=>Ts,Hx:()=>vi});var I=K(5879),b=K(5592),dt=K(4674),ve=K(2459),Ue=K(2096),Le=K(5619),it=K(2572),et=K(6973),xe=K(5211),Re=K(4911),Ze=K(8407);function tt(L,z){const H=(0,dt.m)(L)?L:()=>L,B=D=>D.error(H());return new b.y(z?D=>z.schedule(B,0,D):B)}var lt=K(6232),pt=K(7394),vt=K(9360),_t=K(8251);function nt(){return(0,vt.e)((L,z)=>{let H=null;L._refCount++;const B=(0,_t.x)(z,void 0,void 0,void 0,()=>{if(!L||L._refCount<=0||0<--L._refCount)return void(H=null);const D=L._connection,_=H;H=null,D&&(!_||D===_)&&D.unsubscribe(),z.unsubscribe()});L.subscribe(B),B.closed||(H=L.connect())})}class Bt extends b.y{constructor(z,H){super(),this.source=z,this.subjectFactory=H,this._subject=null,this._refCount=0,this._connection=null,(0,vt.A)(z)&&(this.lift=z.lift)}_subscribe(z){return this.getSubject().subscribe(z)}getSubject(){const z=this._subject;return(!z||z.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:z}=this;this._subject=this._connection=null,z?.unsubscribe()}connect(){let z=this._connection;if(!z){z=this._connection=new pt.w0;const H=this.getSubject();z.add(this.source.subscribe((0,_t.x)(H,void 0,()=>{this._teardown(),H.complete()},B=>{this._teardown(),H.error(B)},()=>this._teardown()))),z.closed&&(this._connection=null,z=pt.w0.EMPTY)}return z}refCount(){return nt()(this)}}var Ft=K(8645),Se=K(6814),Me=K(7398),ht=K(4664),It=K(8180),Je=K(7921),mt=K(2181),Kt=K(1631),Ut=K(1374),dn=K(6328),on=K(9397),Ht=K(6306),Yn=K(6699),en=K(3572);function bt(L){return L<=0?()=>lt.E:(0,vt.e)((z,H)=>{let B=[];z.subscribe((0,_t.x)(H,D=>{B.push(D),L<B.length&&B.shift()},()=>{for(const D of B)H.next(D);H.complete()},void 0,()=>{B=null}))})}var $e=K(3026),ue=K(2737),ct=K(4716),Lt=K(7537),Gt=K(6593);const Yt="primary",hn=Symbol("RouteTitle");class sn{constructor(z){this.params=z||{}}has(z){return Object.prototype.hasOwnProperty.call(this.params,z)}get(z){if(this.has(z)){const H=this.params[z];return Array.isArray(H)?H[0]:H}return null}getAll(z){if(this.has(z)){const H=this.params[z];return Array.isArray(H)?H:[H]}return[]}get keys(){return Object.keys(this.params)}}function jt(L){return new sn(L)}function Xt(L,z,H){const B=H.path.split("/");if(B.length>L.length||"full"===H.pathMatch&&(z.hasChildren()||B.length<L.length))return null;const D={};for(let _=0;_<B.length;_++){const E=B[_],M=L[_];if(E.startsWith(":"))D[E.substring(1)]=M;else if(E!==M.path)return null}return{consumed:L.slice(0,B.length),posParams:D}}function mn(L,z){const H=L?Object.keys(L):void 0,B=z?Object.keys(z):void 0;if(!H||!B||H.length!=B.length)return!1;let D;for(let _=0;_<H.length;_++)if(D=H[_],!Bn(L[D],z[D]))return!1;return!0}function Bn(L,z){if(Array.isArray(L)&&Array.isArray(z)){if(L.length!==z.length)return!1;const H=[...L].sort(),B=[...z].sort();return H.every((D,_)=>B[_]===D)}return L===z}function mr(L){return L.length>0?L[L.length-1]:null}function nr(L){return function l(L){return!!L&&(L instanceof b.y||(0,dt.m)(L.lift)&&(0,dt.m)(L.subscribe))}(L)?L:(0,I.QGY)(L)?(0,ve.D)(Promise.resolve(L)):(0,Ue.of)(L)}const _r={exact:function Jr(L,z,H){if(!Sr(L.segments,z.segments)||!Er(L.segments,z.segments,H)||L.numberOfChildren!==z.numberOfChildren)return!1;for(const B in z.children)if(!L.children[B]||!Jr(L.children[B],z.children[B],H))return!1;return!0},subset:hi},Kn={exact:function bn(L,z){return mn(L,z)},subset:function Fi(L,z){return Object.keys(z).length<=Object.keys(L).length&&Object.keys(z).every(H=>Bn(L[H],z[H]))},ignored:()=>!0};function Lr(L,z,H){return _r[H.paths](L.root,z.root,H.matrixParams)&&Kn[H.queryParams](L.queryParams,z.queryParams)&&!("exact"===H.fragment&&L.fragment!==z.fragment)}function hi(L,z,H){return fr(L,z,z.segments,H)}function fr(L,z,H,B){if(L.segments.length>H.length){const D=L.segments.slice(0,H.length);return!(!Sr(D,H)||z.hasChildren()||!Er(D,H,B))}if(L.segments.length===H.length){if(!Sr(L.segments,H)||!Er(L.segments,H,B))return!1;for(const D in z.children)if(!L.children[D]||!hi(L.children[D],z.children[D],B))return!1;return!0}{const D=H.slice(0,L.segments.length),_=H.slice(L.segments.length);return!!(Sr(L.segments,D)&&Er(L.segments,D,B)&&L.children[Yt])&&fr(L.children[Yt],z,_,B)}}function Er(L,z,H){return z.every((B,D)=>Kn[H](L[D].parameters,B.parameters))}class yr{constructor(z=new gr([],{}),H={},B=null){this.root=z,this.queryParams=H,this.fragment=B}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=jt(this.queryParams)),this._queryParamMap}toString(){return Do.serialize(this)}}class gr{constructor(z,H){this.segments=z,this.children=H,this.parent=null,Object.values(H).forEach(B=>B.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Or(this)}}class Ci{constructor(z,H){this.path=z,this.parameters=H}get parameterMap(){return this._parameterMap||(this._parameterMap=jt(this.parameters)),this._parameterMap}toString(){return Ot(this)}}function Sr(L,z){return L.length===z.length&&L.every((H,B)=>H.path===z[B].path)}let vi=(()=>{var L;class z{}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:function(){return new Yr},providedIn:"root"}),z})();class Yr{parse(z){const H=new $t(z);return new yr(H.parseRootSegment(),H.parseQueryParams(),H.parseFragment())}serialize(z){const H=`/${Co(z.root,!0)}`,B=function xt(L){const z=Object.keys(L).map(H=>{const B=L[H];return Array.isArray(B)?B.map(D=>`${he(H)}=${he(D)}`).join("&"):`${he(H)}=${he(B)}`}).filter(H=>!!H);return z.length?`?${z.join("&")}`:""}(z.queryParams);return`${H}${B}${"string"==typeof z.fragment?`#${function _e(L){return encodeURI(L)}(z.fragment)}`:""}`}}const Do=new Yr;function Or(L){return L.segments.map(z=>Ot(z)).join("/")}function Co(L,z){if(!L.hasChildren())return Or(L);if(z){const H=L.children[Yt]?Co(L.children[Yt],!1):"",B=[];return Object.entries(L.children).forEach(([D,_])=>{D!==Yt&&B.push(`${D}:${Co(_,!1)}`)}),B.length>0?`${H}(${B.join("//")})`:H}{const H=function Ai(L,z){let H=[];return Object.entries(L.children).forEach(([B,D])=>{B===Yt&&(H=H.concat(z(D,B)))}),Object.entries(L.children).forEach(([B,D])=>{B!==Yt&&(H=H.concat(z(D,B)))}),H}(L,(B,D)=>D===Yt?[Co(L.children[Yt],!1)]:[`${D}:${Co(B,!1)}`]);return 1===Object.keys(L.children).length&&null!=L.children[Yt]?`${Or(L)}/${H[0]}`:`${Or(L)}/(${H.join("//")})`}}function Qe(L){return encodeURIComponent(L).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function he(L){return Qe(L).replace(/%3B/gi,";")}function qe(L){return Qe(L).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ut(L){return decodeURIComponent(L)}function wt(L){return ut(L.replace(/\+/g,"%20"))}function Ot(L){return`${qe(L.path)}${function kt(L){return Object.keys(L).map(z=>`;${qe(z)}=${qe(L[z])}`).join("")}(L.parameters)}`}const Vt=/^[^\/()?;#]+/;function yn(L){const z=L.match(Vt);return z?z[0]:""}const Be=/^[^\/()?;=#]+/,de=/^[^=?&#]+/,pe=/^[^&#]+/;class $t{constructor(z){this.url=z,this.remaining=z}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new gr([],{}):new gr([],this.parseChildren())}parseQueryParams(){const z={};if(this.consumeOptional("?"))do{this.parseQueryParam(z)}while(this.consumeOptional("&"));return z}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const z=[];for(this.peekStartsWith("(")||z.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),z.push(this.parseSegment());let H={};this.peekStartsWith("/(")&&(this.capture("/"),H=this.parseParens(!0));let B={};return this.peekStartsWith("(")&&(B=this.parseParens(!1)),(z.length>0||Object.keys(H).length>0)&&(B[Yt]=new gr(z,H)),B}parseSegment(){const z=yn(this.remaining);if(""===z&&this.peekStartsWith(";"))throw new I.vHH(4009,!1);return this.capture(z),new Ci(ut(z),this.parseMatrixParams())}parseMatrixParams(){const z={};for(;this.consumeOptional(";");)this.parseParam(z);return z}parseParam(z){const H=function le(L){const z=L.match(Be);return z?z[0]:""}(this.remaining);if(!H)return;this.capture(H);let B="";if(this.consumeOptional("=")){const D=yn(this.remaining);D&&(B=D,this.capture(B))}z[ut(H)]=ut(B)}parseQueryParam(z){const H=function Ne(L){const z=L.match(de);return z?z[0]:""}(this.remaining);if(!H)return;this.capture(H);let B="";if(this.consumeOptional("=")){const E=function ot(L){const z=L.match(pe);return z?z[0]:""}(this.remaining);E&&(B=E,this.capture(B))}const D=wt(H),_=wt(B);if(z.hasOwnProperty(D)){let E=z[D];Array.isArray(E)||(E=[E],z[D]=E),E.push(_)}else z[D]=_}parseParens(z){const H={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const B=yn(this.remaining),D=this.remaining[B.length];if("/"!==D&&")"!==D&&";"!==D)throw new I.vHH(4010,!1);let _;B.indexOf(":")>-1?(_=B.slice(0,B.indexOf(":")),this.capture(_),this.capture(":")):z&&(_=Yt);const E=this.parseChildren();H[_]=1===Object.keys(E).length?E[Yt]:new gr([],E),this.consumeOptional("//")}return H}peekStartsWith(z){return this.remaining.startsWith(z)}consumeOptional(z){return!!this.peekStartsWith(z)&&(this.remaining=this.remaining.substring(z.length),!0)}capture(z){if(!this.consumeOptional(z))throw new I.vHH(4011,!1)}}function vn(L){return L.segments.length>0?new gr([],{[Yt]:L}):L}function Xn(L){const z={};for(const B of Object.keys(L.children)){const _=Xn(L.children[B]);if(B===Yt&&0===_.segments.length&&_.hasChildren())for(const[E,M]of Object.entries(_.children))z[E]=M;else(_.segments.length>0||_.hasChildren())&&(z[B]=_)}return function Wn(L){if(1===L.numberOfChildren&&L.children[Yt]){const z=L.children[Yt];return new gr(L.segments.concat(z.segments),z.children)}return L}(new gr(L.segments,z))}function hr(L){return L instanceof yr}function Wr(L){let z;const D=vn(function H(_){const E={};for(const q of _.children){const oe=H(q);E[q.outlet]=oe}const M=new gr(_.url,E);return _===L&&(z=M),M}(L.root));return z??D}function ni(L,z,H,B){let D=L;for(;D.parent;)D=D.parent;if(0===z.length)return rn(D,D,D,H,B);const _=function ur(L){if("string"==typeof L[0]&&1===L.length&&"/"===L[0])return new Dn(!0,0,L);let z=0,H=!1;const B=L.reduce((D,_,E)=>{if("object"==typeof _&&null!=_){if(_.outlets){const M={};return Object.entries(_.outlets).forEach(([q,oe])=>{M[q]="string"==typeof oe?oe.split("/"):oe}),[...D,{outlets:M}]}if(_.segmentPath)return[...D,_.segmentPath]}return"string"!=typeof _?[...D,_]:0===E?(_.split("/").forEach((M,q)=>{0==q&&"."===M||(0==q&&""===M?H=!0:".."===M?z++:""!=M&&D.push(M))}),D):[...D,_]},[]);return new Dn(H,z,B)}(z);if(_.toRoot())return rn(D,D,new gr([],{}),H,B);const E=function Rr(L,z,H){if(L.isAbsolute)return new Zn(z,!0,0);if(!H)return new Zn(z,!1,NaN);if(null===H.parent)return new Zn(H,!0,0);const B=ro(L.commands[0])?0:1;return function Fr(L,z,H){let B=L,D=z,_=H;for(;_>D;){if(_-=D,B=B.parent,!B)throw new I.vHH(4005,!1);D=B.segments.length}return new Zn(B,!1,D-_)}(H,H.segments.length-1+B,L.numberOfDoubleDots)}(_,D,L),M=E.processChildren?Qr(E.segmentGroup,E.index,_.commands):Ti(E.segmentGroup,E.index,_.commands);return rn(D,E.segmentGroup,M,H,B)}function ro(L){return"object"==typeof L&&null!=L&&!L.outlets&&!L.segmentPath}function Bo(L){return"object"==typeof L&&null!=L&&L.outlets}function rn(L,z,H,B,D){let E,_={};B&&Object.entries(B).forEach(([q,oe])=>{_[q]=Array.isArray(oe)?oe.map(ge=>`${ge}`):`${oe}`}),E=L===z?H:Tt(L,z,H);const M=vn(Xn(E));return new yr(M,_,D)}function Tt(L,z,H){const B={};return Object.entries(L.children).forEach(([D,_])=>{B[D]=_===z?H:Tt(_,z,H)}),new gr(L.segments,B)}class Dn{constructor(z,H,B){if(this.isAbsolute=z,this.numberOfDoubleDots=H,this.commands=B,z&&B.length>0&&ro(B[0]))throw new I.vHH(4003,!1);const D=B.find(Bo);if(D&&D!==mr(B))throw new I.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Zn{constructor(z,H,B){this.segmentGroup=z,this.processChildren=H,this.index=B}}function Ti(L,z,H){if(L||(L=new gr([],{})),0===L.segments.length&&L.hasChildren())return Qr(L,z,H);const B=function ui(L,z,H){let B=0,D=z;const _={match:!1,pathIndex:0,commandIndex:0};for(;D<L.segments.length;){if(B>=H.length)return _;const E=L.segments[D],M=H[B];if(Bo(M))break;const q=`${M}`,oe=B<H.length-1?H[B+1]:null;if(D>0&&void 0===q)break;if(q&&oe&&"object"==typeof oe&&void 0===oe.outlets){if(!io(q,oe,E))return _;B+=2}else{if(!io(q,{},E))return _;B++}D++}return{match:!0,pathIndex:D,commandIndex:B}}(L,z,H),D=H.slice(B.commandIndex);if(B.match&&B.pathIndex<L.segments.length){const _=new gr(L.segments.slice(0,B.pathIndex),{});return _.children[Yt]=new gr(L.segments.slice(B.pathIndex),L.children),Qr(_,0,D)}return B.match&&0===D.length?new gr(L.segments,{}):B.match&&!L.hasChildren()?qr(L,z,H):B.match?Qr(L,0,D):qr(L,z,H)}function Qr(L,z,H){if(0===H.length)return new gr(L.segments,{});{const B=function fi(L){return Bo(L[0])?L[0].outlets:{[Yt]:L}}(H),D={};if(!B[Yt]&&L.children[Yt]&&1===L.numberOfChildren&&0===L.children[Yt].segments.length){const _=Qr(L.children[Yt],z,H);return new gr(L.segments,_.children)}return Object.entries(B).forEach(([_,E])=>{"string"==typeof E&&(E=[E]),null!==E&&(D[_]=Ti(L.children[_],z,E))}),Object.entries(L.children).forEach(([_,E])=>{void 0===B[_]&&(D[_]=E)}),new gr(L.segments,D)}}function qr(L,z,H){const B=L.segments.slice(0,z);let D=0;for(;D<H.length;){const _=H[D];if(Bo(_)){const q=Es(_.outlets);return new gr(B,q)}if(0===D&&ro(H[0])){B.push(new Ci(L.segments[z].path,cn(H[0]))),D++;continue}const E=Bo(_)?_.outlets[Yt]:`${_}`,M=D<H.length-1?H[D+1]:null;E&&M&&ro(M)?(B.push(new Ci(E,cn(M))),D+=2):(B.push(new Ci(E,{})),D++)}return new gr(B,{})}function Es(L){const z={};return Object.entries(L).forEach(([H,B])=>{"string"==typeof B&&(B=[B]),null!==B&&(z[H]=qr(new gr([],{}),0,B))}),z}function cn(L){const z={};return Object.entries(L).forEach(([H,B])=>z[H]=`${B}`),z}function io(L,z,H){return L==H.path&&mn(z,H.parameters)}const wi="imperative";class oi{constructor(z,H){this.id=z,this.url=H}}class Yo extends oi{constructor(z,H,B="imperative",D=null){super(z,H),this.type=0,this.navigationTrigger=B,this.restoredState=D}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Vi extends oi{constructor(z,H,B){super(z,H),this.urlAfterRedirects=B,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ss extends oi{constructor(z,H,B,D){super(z,H),this.reason=B,this.code=D,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Po extends oi{constructor(z,H,B,D){super(z,H),this.reason=B,this.code=D,this.type=16}}class No extends oi{constructor(z,H,B,D){super(z,H),this.error=B,this.target=D,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class qn extends oi{constructor(z,H,B,D){super(z,H),this.urlAfterRedirects=B,this.state=D,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cr extends oi{constructor(z,H,B,D){super(z,H),this.urlAfterRedirects=B,this.state=D,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fe extends oi{constructor(z,H,B,D,_){super(z,H),this.urlAfterRedirects=B,this.state=D,this.shouldActivate=_,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class je extends oi{constructor(z,H,B,D){super(z,H),this.urlAfterRedirects=B,this.state=D,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ce extends oi{constructor(z,H,B,D){super(z,H),this.urlAfterRedirects=B,this.state=D,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ve{constructor(z){this.route=z,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class St{constructor(z){this.route=z,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class zt{constructor(z){this.snapshot=z,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class fn{constructor(z){this.snapshot=z,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xn{constructor(z){this.snapshot=z,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pn{constructor(z){this.snapshot=z,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class An{constructor(z,H,B){this.routerEvent=z,this.position=H,this.anchor=B,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Tr{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new kr,this.attachRef=null}}let kr=(()=>{var L;class z{constructor(){this.contexts=new Map}onChildOutletCreated(B,D){const _=this.getOrCreateContext(B);_.outlet=D,this.contexts.set(B,_)}onChildOutletDestroyed(B){const D=this.getContext(B);D&&(D.outlet=null,D.attachRef=null)}onOutletDeactivated(){const B=this.contexts;return this.contexts=new Map,B}onOutletReAttached(B){this.contexts=B}getOrCreateContext(B){let D=this.getContext(B);return D||(D=new Tr,this.contexts.set(B,D)),D}getContext(B){return this.contexts.get(B)||null}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})();class Ei{constructor(z){this._root=z}get root(){return this._root.value}parent(z){const H=this.pathFromRoot(z);return H.length>1?H[H.length-2]:null}children(z){const H=oo(z,this._root);return H?H.children.map(B=>B.value):[]}firstChild(z){const H=oo(z,this._root);return H&&H.children.length>0?H.children[0].value:null}siblings(z){const H=Wi(z,this._root);return H.length<2?[]:H[H.length-2].children.map(D=>D.value).filter(D=>D!==z)}pathFromRoot(z){return Wi(z,this._root).map(H=>H.value)}}function oo(L,z){if(L===z.value)return z;for(const H of z.children){const B=oo(L,H);if(B)return B}return null}function Wi(L,z){if(L===z.value)return[z];for(const H of z.children){const B=Wi(L,H);if(B.length)return B.unshift(z),B}return[]}class Ji{constructor(z,H){this.value=z,this.children=H}toString(){return`TreeNode(${this.value})`}}function Ri(L){const z={};return L&&L.children.forEach(H=>z[H.value.outlet]=H),z}class To extends Ei{constructor(z,H){super(z),this.snapshot=H,as(this,z)}toString(){return this.snapshot.toString()}}function jr(L,z){const H=function Zr(L,z){const E=new So([],{},{},"",{},Yt,z,null,{});return new Ks("",new Ji(E,[]))}(0,z),B=new Le.X([new Ci("",{})]),D=new Le.X({}),_=new Le.X({}),E=new Le.X({}),M=new Le.X(""),q=new Qi(B,D,E,M,_,Yt,z,H.root);return q.snapshot=H.root,new To(new Ji(q,[]),H)}class Qi{constructor(z,H,B,D,_,E,M,q){this.urlSubject=z,this.paramsSubject=H,this.queryParamsSubject=B,this.fragmentSubject=D,this.dataSubject=_,this.outlet=E,this.component=M,this._futureSnapshot=q,this.title=this.dataSubject?.pipe((0,Me.U)(oe=>oe[hn]))??(0,Ue.of)(void 0),this.url=z,this.params=H,this.queryParams=B,this.fragment=D,this.data=_}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Me.U)(z=>jt(z)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Me.U)(z=>jt(z)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ps(L,z="emptyOnly"){const H=L.pathFromRoot;let B=0;if("always"!==z)for(B=H.length-1;B>=1;){const D=H[B],_=H[B-1];if(D.routeConfig&&""===D.routeConfig.path)B--;else{if(_.component)break;B--}}return function Pi(L){return L.reduce((z,H)=>({params:{...z.params,...H.params},data:{...z.data,...H.data},resolve:{...H.data,...z.resolve,...H.routeConfig?.data,...H._resolvedData}}),{params:{},data:{},resolve:{}})}(H.slice(B))}class So{get title(){return this.data?.[hn]}constructor(z,H,B,D,_,E,M,q,oe){this.url=z,this.params=H,this.queryParams=B,this.fragment=D,this.data=_,this.outlet=E,this.component=M,this.routeConfig=q,this._resolve=oe}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=jt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=jt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(B=>B.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ks extends Ei{constructor(z,H){super(H),this.url=z,as(this,H)}toString(){return Ni(this._root)}}function as(L,z){z.value._routerState=L,z.children.forEach(H=>as(L,H))}function Ni(L){const z=L.children.length>0?` { ${L.children.map(Ni).join(", ")} } `:"";return`${L.value}${z}`}function Os(L){if(L.snapshot){const z=L.snapshot,H=L._futureSnapshot;L.snapshot=H,mn(z.queryParams,H.queryParams)||L.queryParamsSubject.next(H.queryParams),z.fragment!==H.fragment&&L.fragmentSubject.next(H.fragment),mn(z.params,H.params)||L.paramsSubject.next(H.params),function an(L,z){if(L.length!==z.length)return!1;for(let H=0;H<L.length;++H)if(!mn(L[H],z[H]))return!1;return!0}(z.url,H.url)||L.urlSubject.next(H.url),mn(z.data,H.data)||L.dataSubject.next(H.data)}else L.snapshot=L._futureSnapshot,L.dataSubject.next(L._futureSnapshot.data)}function Oi(L,z){const H=mn(L.params,z.params)&&function qi(L,z){return Sr(L,z)&&L.every((H,B)=>mn(H.parameters,z[B].parameters))}(L.url,z.url);return H&&!(!L.parent!=!z.parent)&&(!L.parent||Oi(L.parent,z.parent))}let rr=(()=>{var L;class z{constructor(){this.activated=null,this._activatedRoute=null,this.name=Yt,this.activateEvents=new I.vpe,this.deactivateEvents=new I.vpe,this.attachEvents=new I.vpe,this.detachEvents=new I.vpe,this.parentContexts=(0,I.f3M)(kr),this.location=(0,I.f3M)(I.s_b),this.changeDetector=(0,I.f3M)(I.sBO),this.environmentInjector=(0,I.f3M)(I.lqb),this.inputBinder=(0,I.f3M)(Si,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(B){if(B.name){const{firstChange:D,previousValue:_}=B.name;if(D)return;this.isTrackedInParentContexts(_)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(_)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(B){return this.parentContexts.getContext(B)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const B=this.parentContexts.getContext(this.name);B?.route&&(B.attachRef?this.attach(B.attachRef,B.route):this.activateWith(B.route,B.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new I.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new I.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new I.vHH(4012,!1);this.location.detach();const B=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(B.instance),B}attach(B,D){this.activated=B,this._activatedRoute=D,this.location.insert(B.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(B.instance)}deactivate(){if(this.activated){const B=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(B)}}activateWith(B,D){if(this.isActivated)throw new I.vHH(4013,!1);this._activatedRoute=B;const _=this.location,M=B.snapshot.component,q=this.parentContexts.getOrCreateContext(this.name).children,oe=new xr(B,q,_.injector);this.activated=_.createComponent(M,{index:_.length,injector:oe,environmentInjector:D??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275dir=I.lG2({type:L,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[I.TTD]}),z})();class xr{constructor(z,H,B){this.route=z,this.childContexts=H,this.parent=B}get(z,H){return z===Qi?this.route:z===kr?this.childContexts:this.parent.get(z,H)}}const Si=new I.OlP("");let Io=(()=>{var L;class z{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(B){this.unsubscribeFromRouteData(B),this.subscribeToRouteData(B)}unsubscribeFromRouteData(B){this.outletDataSubscriptions.get(B)?.unsubscribe(),this.outletDataSubscriptions.delete(B)}subscribeToRouteData(B){const{activatedRoute:D}=B,_=(0,it.a)([D.queryParams,D.params,D.data]).pipe((0,ht.w)(([E,M,q],oe)=>(q={...E,...M,...q},0===oe?(0,Ue.of)(q):Promise.resolve(q)))).subscribe(E=>{if(!B.isActivated||!B.activatedComponentRef||B.activatedRoute!==D||null===D.component)return void this.unsubscribeFromRouteData(B);const M=(0,I.qFp)(D.component);if(M)for(const{templateName:q}of M.inputs)B.activatedComponentRef.setInput(q,E[q]);else this.unsubscribeFromRouteData(B)});this.outletDataSubscriptions.set(B,_)}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac}),z})();function Ii(L,z,H){if(H&&L.shouldReuseRoute(z.value,H.value.snapshot)){const B=H.value;B._futureSnapshot=z.value;const D=function Ms(L,z,H){return z.children.map(B=>{for(const D of H.children)if(L.shouldReuseRoute(B.value,D.value.snapshot))return Ii(L,B,D);return Ii(L,B)})}(L,z,H);return new Ji(B,D)}{if(L.shouldAttach(z.value)){const _=L.retrieve(z.value);if(null!==_){const E=_.route;return E.value._futureSnapshot=z.value,E.children=z.children.map(M=>Ii(L,M)),E}}const B=function eo(L){return new Qi(new Le.X(L.url),new Le.X(L.params),new Le.X(L.queryParams),new Le.X(L.fragment),new Le.X(L.data),L.outlet,L.component,L)}(z.value),D=z.children.map(_=>Ii(L,_));return new Ji(B,D)}}const $o="ngNavigationCancelingError";function Vo(L,z){const{redirectTo:H,navigationBehaviorOptions:B}=hr(z)?{redirectTo:z,navigationBehaviorOptions:void 0}:z,D=Mr(!1,0,z);return D.url=H,D.navigationBehaviorOptions=B,D}function Mr(L,z,H){const B=new Error("NavigationCancelingError: "+(L||""));return B[$o]=!0,B.cancellationCode=z,H&&(B.url=H),B}function ks(L){return ls(L)&&hr(L.url)}function ls(L){return L&&L[$o]}let _o=(()=>{var L;class z{}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275cmp=I.Xpm({type:L,selectors:[["ng-component"]],standalone:!0,features:[I.jDz],decls:1,vars:0,template:function(B,D){1&B&&I._UZ(0,"router-outlet")},dependencies:[rr],encapsulation:2}),z})();function ns(L){const z=L.children&&L.children.map(ns),H=z?{...L,children:z}:{...L};return!H.component&&!H.loadComponent&&(z||H.loadChildren)&&H.outlet&&H.outlet!==Yt&&(H.component=_o),H}function er(L){return L.outlet||Yt}function As(L){if(!L)return null;if(L.routeConfig?._injector)return L.routeConfig._injector;for(let z=L.parent;z;z=z.parent){const H=z.routeConfig;if(H?._loadedInjector)return H._loadedInjector;if(H?._injector)return H._injector}return null}class js{constructor(z,H,B,D,_){this.routeReuseStrategy=z,this.futureState=H,this.currState=B,this.forwardEvent=D,this.inputBindingEnabled=_}activate(z){const H=this.futureState._root,B=this.currState?this.currState._root:null;this.deactivateChildRoutes(H,B,z),Os(this.futureState.root),this.activateChildRoutes(H,B,z)}deactivateChildRoutes(z,H,B){const D=Ri(H);z.children.forEach(_=>{const E=_.value.outlet;this.deactivateRoutes(_,D[E],B),delete D[E]}),Object.values(D).forEach(_=>{this.deactivateRouteAndItsChildren(_,B)})}deactivateRoutes(z,H,B){const D=z.value,_=H?H.value:null;if(D===_)if(D.component){const E=B.getContext(D.outlet);E&&this.deactivateChildRoutes(z,H,E.children)}else this.deactivateChildRoutes(z,H,B);else _&&this.deactivateRouteAndItsChildren(H,B)}deactivateRouteAndItsChildren(z,H){z.value.component&&this.routeReuseStrategy.shouldDetach(z.value.snapshot)?this.detachAndStoreRouteSubtree(z,H):this.deactivateRouteAndOutlet(z,H)}detachAndStoreRouteSubtree(z,H){const B=H.getContext(z.value.outlet),D=B&&z.value.component?B.children:H,_=Ri(z);for(const E of Object.keys(_))this.deactivateRouteAndItsChildren(_[E],D);if(B&&B.outlet){const E=B.outlet.detach(),M=B.children.onOutletDeactivated();this.routeReuseStrategy.store(z.value.snapshot,{componentRef:E,route:z,contexts:M})}}deactivateRouteAndOutlet(z,H){const B=H.getContext(z.value.outlet),D=B&&z.value.component?B.children:H,_=Ri(z);for(const E of Object.keys(_))this.deactivateRouteAndItsChildren(_[E],D);B&&(B.outlet&&(B.outlet.deactivate(),B.children.onOutletDeactivated()),B.attachRef=null,B.route=null)}activateChildRoutes(z,H,B){const D=Ri(H);z.children.forEach(_=>{this.activateRoutes(_,D[_.value.outlet],B),this.forwardEvent(new pn(_.value.snapshot))}),z.children.length&&this.forwardEvent(new fn(z.value.snapshot))}activateRoutes(z,H,B){const D=z.value,_=H?H.value:null;if(Os(D),D===_)if(D.component){const E=B.getOrCreateContext(D.outlet);this.activateChildRoutes(z,H,E.children)}else this.activateChildRoutes(z,H,B);else if(D.component){const E=B.getOrCreateContext(D.outlet);if(this.routeReuseStrategy.shouldAttach(D.snapshot)){const M=this.routeReuseStrategy.retrieve(D.snapshot);this.routeReuseStrategy.store(D.snapshot,null),E.children.onOutletReAttached(M.contexts),E.attachRef=M.componentRef,E.route=M.route.value,E.outlet&&E.outlet.attach(M.componentRef,M.route.value),Os(M.route.value),this.activateChildRoutes(z,null,E.children)}else{const M=As(D.snapshot);E.attachRef=null,E.route=D,E.injector=M,E.outlet&&E.outlet.activateWith(D,E.injector),this.activateChildRoutes(z,null,E.children)}}else this.activateChildRoutes(z,null,B)}}class uo{constructor(z){this.path=z,this.route=this.path[this.path.length-1]}}class Mo{constructor(z,H){this.component=z,this.route=H}}function so(L,z,H){const B=L._root;return Zi(B,z?z._root:null,H,[B.value])}function Bi(L,z){const H=Symbol(),B=z.get(L,H);return B===H?"function"!=typeof L||(0,I.Z0I)(L)?z.get(L):L:B}function Zi(L,z,H,B,D={canDeactivateChecks:[],canActivateChecks:[]}){const _=Ri(z);return L.children.forEach(E=>{(function Hs(L,z,H,B,D={canDeactivateChecks:[],canActivateChecks:[]}){const _=L.value,E=z?z.value:null,M=H?H.getContext(L.value.outlet):null;if(E&&_.routeConfig===E.routeConfig){const q=function gs(L,z,H){if("function"==typeof H)return H(L,z);switch(H){case"pathParamsChange":return!Sr(L.url,z.url);case"pathParamsOrQueryParamsChange":return!Sr(L.url,z.url)||!mn(L.queryParams,z.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Oi(L,z)||!mn(L.queryParams,z.queryParams);default:return!Oi(L,z)}}(E,_,_.routeConfig.runGuardsAndResolvers);q?D.canActivateChecks.push(new uo(B)):(_.data=E.data,_._resolvedData=E._resolvedData),Zi(L,z,_.component?M?M.children:null:H,B,D),q&&M&&M.outlet&&M.outlet.isActivated&&D.canDeactivateChecks.push(new Mo(M.outlet.component,E))}else E&&us(z,M,D),D.canActivateChecks.push(new uo(B)),Zi(L,null,_.component?M?M.children:null:H,B,D)})(E,_[E.value.outlet],H,B.concat([E.value]),D),delete _[E.value.outlet]}),Object.entries(_).forEach(([E,M])=>us(M,H.getContext(E),D)),D}function us(L,z,H){const B=Ri(L),D=L.value;Object.entries(B).forEach(([_,E])=>{us(E,D.component?z?z.children.getContext(_):null:z,H)}),H.canDeactivateChecks.push(new Mo(D.component&&z&&z.outlet&&z.outlet.isActivated?z.outlet.component:null,D))}function Xo(L){return"function"==typeof L}function Cn(L){return L instanceof et.K||"EmptyError"===L?.name}const lr=Symbol("INITIAL_VALUE");function ir(){return(0,ht.w)(L=>(0,it.a)(L.map(z=>z.pipe((0,It.q)(1),(0,Je.O)(lr)))).pipe((0,Me.U)(z=>{for(const H of z)if(!0!==H){if(H===lr)return lr;if(!1===H||H instanceof yr)return H}return!0}),(0,mt.h)(z=>z!==lr),(0,It.q)(1)))}function Oo(L){return(0,Ze.z)((0,on.b)(z=>{if(hr(z))throw Vo(0,z)}),(0,Me.U)(z=>!0===z))}class is{constructor(z){this.segmentGroup=z||null}}class Ko{constructor(z){this.urlTree=z}}function Ds(L){return tt(new is(L))}function La(L){return tt(new Ko(L))}class Vl{constructor(z,H){this.urlSerializer=z,this.urlTree=H}noMatchError(z){return new I.vHH(4002,!1)}lineralizeSegments(z,H){let B=[],D=H.root;for(;;){if(B=B.concat(D.segments),0===D.numberOfChildren)return(0,Ue.of)(B);if(D.numberOfChildren>1||!D.children[Yt])return tt(new I.vHH(4e3,!1));D=D.children[Yt]}}applyRedirectCommands(z,H,B){return this.applyRedirectCreateUrlTree(H,this.urlSerializer.parse(H),z,B)}applyRedirectCreateUrlTree(z,H,B,D){const _=this.createSegmentGroup(z,H.root,B,D);return new yr(_,this.createQueryParams(H.queryParams,this.urlTree.queryParams),H.fragment)}createQueryParams(z,H){const B={};return Object.entries(z).forEach(([D,_])=>{if("string"==typeof _&&_.startsWith(":")){const M=_.substring(1);B[D]=H[M]}else B[D]=_}),B}createSegmentGroup(z,H,B,D){const _=this.createSegments(z,H.segments,B,D);let E={};return Object.entries(H.children).forEach(([M,q])=>{E[M]=this.createSegmentGroup(z,q,B,D)}),new gr(_,E)}createSegments(z,H,B,D){return H.map(_=>_.path.startsWith(":")?this.findPosParam(z,_,D):this.findOrReturn(_,B))}findPosParam(z,H,B){const D=B[H.path.substring(1)];if(!D)throw new I.vHH(4001,!1);return D}findOrReturn(z,H){let B=0;for(const D of H){if(D.path===z.path)return H.splice(B),D;B++}return z}}const wa={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xl(L,z,H,B,D){const _=Fa(L,z,H);return _.matched?(B=function Ui(L,z){return L.providers&&!L._injector&&(L._injector=(0,I.MMx)(L.providers,z,`Route: ${L.path}`)),L._injector??z}(z,B),function rs(L,z,H,B){const D=z.canMatch;if(!D||0===D.length)return(0,Ue.of)(!0);const _=D.map(E=>{const M=Bi(E,L);return nr(function R(L){return L&&Xo(L.canMatch)}(M)?M.canMatch(z,H):L.runInContext(()=>M(z,H)))});return(0,Ue.of)(_).pipe(ir(),Oo())}(B,z,H).pipe((0,Me.U)(E=>!0===E?_:{...wa}))):(0,Ue.of)(_)}function Fa(L,z,H){if(""===z.path)return"full"===z.pathMatch&&(L.hasChildren()||H.length>0)?{...wa}:{matched:!0,consumedSegments:[],remainingSegments:H,parameters:{},positionalParamSegments:{}};const D=(z.matcher||Xt)(H,L,z);if(!D)return{...wa};const _={};Object.entries(D.posParams??{}).forEach(([M,q])=>{_[M]=q.path});const E=D.consumed.length>0?{..._,...D.consumed[D.consumed.length-1].parameters}:_;return{matched:!0,consumedSegments:D.consumed,remainingSegments:H.slice(D.consumed.length),parameters:E,positionalParamSegments:D.posParams??{}}}function Ul(L,z,H,B){return H.length>0&&function ho(L,z,H){return H.some(B=>bl(L,z,B)&&er(B)!==Yt)}(L,H,B)?{segmentGroup:new gr(z,Gs(B,new gr(H,L.children))),slicedSegments:[]}:0===H.length&&function Fs(L,z,H){return H.some(B=>bl(L,z,B))}(L,H,B)?{segmentGroup:new gr(L.segments,Ls(L,0,H,B,L.children)),slicedSegments:H}:{segmentGroup:new gr(L.segments,L.children),slicedSegments:H}}function Ls(L,z,H,B,D){const _={};for(const E of B)if(bl(L,H,E)&&!D[er(E)]){const M=new gr([],{});_[er(E)]=M}return{...D,..._}}function Gs(L,z){const H={};H[Yt]=z;for(const B of L)if(""===B.path&&er(B)!==Yt){const D=new gr([],{});H[er(B)]=D}return H}function bl(L,z,H){return(!(L.hasChildren()||z.length>0)||"full"!==H.pathMatch)&&""===H.path}class al{constructor(z,H,B,D,_,E,M){this.injector=z,this.configLoader=H,this.rootComponentType=B,this.config=D,this.urlTree=_,this.paramsInheritanceStrategy=E,this.urlSerializer=M,this.allowRedirects=!0,this.applyRedirects=new Vl(this.urlSerializer,this.urlTree)}noMatchError(z){return new I.vHH(4002,!1)}recognize(){const z=Ul(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,z,Yt).pipe((0,Ht.K)(H=>{if(H instanceof Ko)return this.allowRedirects=!1,this.urlTree=H.urlTree,this.match(H.urlTree);throw H instanceof is?this.noMatchError(H):H}),(0,Me.U)(H=>{const B=new So([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Yt,this.rootComponentType,null,{}),D=new Ji(B,H),_=new Ks("",D),E=function vr(L,z,H=null,B=null){return ni(Wr(L),z,H,B)}(B,[],this.urlTree.queryParams,this.urlTree.fragment);return E.queryParams=this.urlTree.queryParams,_.url=this.urlSerializer.serialize(E),this.inheritParamsAndData(_._root),{state:_,tree:E}}))}match(z){return this.processSegmentGroup(this.injector,this.config,z.root,Yt).pipe((0,Ht.K)(B=>{throw B instanceof is?this.noMatchError(B):B}))}inheritParamsAndData(z){const H=z.value,B=ps(H,this.paramsInheritanceStrategy);H.params=Object.freeze(B.params),H.data=Object.freeze(B.data),z.children.forEach(D=>this.inheritParamsAndData(D))}processSegmentGroup(z,H,B,D){return 0===B.segments.length&&B.hasChildren()?this.processChildren(z,H,B):this.processSegment(z,H,B,B.segments,D,!0)}processChildren(z,H,B){const D=[];for(const _ of Object.keys(B.children))"primary"===_?D.unshift(_):D.push(_);return(0,ve.D)(D).pipe((0,dn.b)(_=>{const E=B.children[_],M=function ka(L,z){const H=L.filter(B=>er(B)===z);return H.push(...L.filter(B=>er(B)!==z)),H}(H,_);return this.processSegmentGroup(z,M,E,_)}),(0,Yn.R)((_,E)=>(_.push(...E),_)),(0,en.d)(null),function me(L,z){const H=arguments.length>=2;return B=>B.pipe(L?(0,mt.h)((D,_)=>L(D,_,B)):ue.y,bt(1),H?(0,en.d)(z):(0,$e.T)(()=>new et.K))}(),(0,Kt.z)(_=>{if(null===_)return Ds(B);const E=Ws(_);return function dc(L){L.sort((z,H)=>z.value.outlet===Yt?-1:H.value.outlet===Yt?1:z.value.outlet.localeCompare(H.value.outlet))}(E),(0,Ue.of)(E)}))}processSegment(z,H,B,D,_,E){return(0,ve.D)(H).pipe((0,dn.b)(M=>this.processSegmentAgainstRoute(M._injector??z,H,M,B,D,_,E).pipe((0,Ht.K)(q=>{if(q instanceof is)return(0,Ue.of)(null);throw q}))),(0,Ut.P)(M=>!!M),(0,Ht.K)(M=>{if(Cn(M))return function ol(L,z,H){return 0===z.length&&!L.children[H]}(B,D,_)?(0,Ue.of)([]):Ds(B);throw M}))}processSegmentAgainstRoute(z,H,B,D,_,E,M){return function jl(L,z,H,B){return!!(er(L)===B||B!==Yt&&bl(z,H,L))&&("**"===L.path||Fa(z,L,H).matched)}(B,D,_,E)?void 0===B.redirectTo?this.matchSegmentAgainstRoute(z,D,B,_,E,M):M&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(z,D,H,B,_,E):Ds(D):Ds(D)}expandSegmentAgainstRouteUsingRedirect(z,H,B,D,_,E){return"**"===D.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(z,B,D,E):this.expandRegularSegmentAgainstRouteUsingRedirect(z,H,B,D,_,E)}expandWildCardWithParamsAgainstRouteUsingRedirect(z,H,B,D){const _=this.applyRedirects.applyRedirectCommands([],B.redirectTo,{});return B.redirectTo.startsWith("/")?La(_):this.applyRedirects.lineralizeSegments(B,_).pipe((0,Kt.z)(E=>{const M=new gr(E,{});return this.processSegment(z,H,M,E,D,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(z,H,B,D,_,E){const{matched:M,consumedSegments:q,remainingSegments:oe,positionalParamSegments:ge}=Fa(H,D,_);if(!M)return Ds(H);const Oe=this.applyRedirects.applyRedirectCommands(q,D.redirectTo,ge);return D.redirectTo.startsWith("/")?La(Oe):this.applyRedirects.lineralizeSegments(D,Oe).pipe((0,Kt.z)(Pt=>this.processSegment(z,B,H,Pt.concat(oe),E,!1)))}matchSegmentAgainstRoute(z,H,B,D,_,E){let M;if("**"===B.path){const q=D.length>0?mr(D).parameters:{},oe=new So(D,q,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qa(B),er(B),B.component??B._loadedComponent??null,B,hc(B));M=(0,Ue.of)({snapshot:oe,consumedSegments:[],remainingSegments:[]}),H.children={}}else M=xl(H,B,D,z).pipe((0,Me.U)(({matched:q,consumedSegments:oe,remainingSegments:ge,parameters:Oe})=>q?{snapshot:new So(oe,Oe,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qa(B),er(B),B.component??B._loadedComponent??null,B,hc(B)),consumedSegments:oe,remainingSegments:ge}:null));return M.pipe((0,ht.w)(q=>null===q?Ds(H):this.getChildConfig(z=B._injector??z,B,D).pipe((0,ht.w)(({routes:oe})=>{const ge=B._loadedInjector??z,{snapshot:Oe,consumedSegments:Pt,remainingSegments:Jt}=q,{segmentGroup:sr,slicedSegments:Qn}=Ul(H,Pt,Jt,oe);if(0===Qn.length&&sr.hasChildren())return this.processChildren(ge,oe,sr).pipe((0,Me.U)(Hr=>null===Hr?null:[new Ji(Oe,Hr)]));if(0===oe.length&&0===Qn.length)return(0,Ue.of)([new Ji(Oe,[])]);const Vr=er(B)===_;return this.processSegment(ge,oe,sr,Qn,Vr?Yt:_,!0).pipe((0,Me.U)(Hr=>[new Ji(Oe,Hr)]))}))))}getChildConfig(z,H,B){return H.children?(0,Ue.of)({routes:H.children,injector:z}):H.loadChildren?void 0!==H._loadedRoutes?(0,Ue.of)({routes:H._loadedRoutes,injector:H._loadedInjector}):function $r(L,z,H,B){const D=z.canLoad;if(void 0===D||0===D.length)return(0,Ue.of)(!0);const _=D.map(E=>{const M=Bi(E,L);return nr(function ba(L){return L&&Xo(L.canLoad)}(M)?M.canLoad(z,H):L.runInContext(()=>M(z,H)))});return(0,Ue.of)(_).pipe(ir(),Oo())}(z,H,B).pipe((0,Kt.z)(D=>D?this.configLoader.loadChildren(z,H).pipe((0,on.b)(_=>{H._loadedRoutes=_.routes,H._loadedInjector=_.injector})):function il(L){return tt(Mr(!1,3))}())):(0,Ue.of)({routes:[],injector:z})}}function fa(L){const z=L.value.routeConfig;return z&&""===z.path}function Ws(L){const z=[],H=new Set;for(const B of L){if(!fa(B)){z.push(B);continue}const D=z.find(_=>B.value.routeConfig===_.value.routeConfig);void 0!==D?(D.children.push(...B.children),H.add(D)):z.push(B)}for(const B of H){const D=Ws(B.children);z.push(new Ji(B.value,D))}return z.filter(B=>!H.has(B))}function qa(L){return L.data||{}}function hc(L){return L.resolve||{}}function Ba(L){return"string"==typeof L.title||null===L.title}function Na(L){return(0,ht.w)(z=>{const H=L(z);return H?(0,ve.D)(H).pipe((0,Me.U)(()=>z)):(0,Ue.of)(z)})}const Qo=new I.OlP("ROUTES");let ea=(()=>{var L;class z{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,I.f3M)(I.Sil)}loadComponent(B){if(this.componentLoaders.get(B))return this.componentLoaders.get(B);if(B._loadedComponent)return(0,Ue.of)(B._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(B);const D=nr(B.loadComponent()).pipe((0,Me.U)(ee),(0,on.b)(E=>{this.onLoadEndListener&&this.onLoadEndListener(B),B._loadedComponent=E}),(0,ct.x)(()=>{this.componentLoaders.delete(B)})),_=new Bt(D,()=>new Ft.x).pipe(nt());return this.componentLoaders.set(B,_),_}loadChildren(B,D){if(this.childrenLoaders.get(D))return this.childrenLoaders.get(D);if(D._loadedRoutes)return(0,Ue.of)({routes:D._loadedRoutes,injector:D._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(D);const E=this.loadModuleFactoryOrRoutes(D.loadChildren).pipe((0,Me.U)(q=>{this.onLoadEndListener&&this.onLoadEndListener(D);let oe,ge;return Array.isArray(q)?ge=q:(oe=q.create(B).injector,ge=oe.get(Qo,[],I.XFs.Self|I.XFs.Optional).flat()),{routes:ge.map(ns),injector:oe}}),(0,ct.x)(()=>{this.childrenLoaders.delete(D)})),M=new Bt(E,()=>new Ft.x).pipe(nt());return this.childrenLoaders.set(D,M),M}loadModuleFactoryOrRoutes(B){return nr(B()).pipe((0,Me.U)(ee),(0,Kt.z)(D=>D instanceof I.YKP||Array.isArray(D)?(0,Ue.of)(D):(0,ve.D)(this.compiler.compileModuleAsync(D))))}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})();function ee(L){return function N(L){return L&&"object"==typeof L&&"default"in L}(L)?L.default:L}let Ke=(()=>{var L;class z{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ft.x,this.configLoader=(0,I.f3M)(ea),this.environmentInjector=(0,I.f3M)(I.lqb),this.urlSerializer=(0,I.f3M)(vi),this.rootContexts=(0,I.f3M)(kr),this.inputBindingEnabled=null!==(0,I.f3M)(Si,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Ue.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=_=>this.events.next(new St(_)),this.configLoader.onLoadStartListener=_=>this.events.next(new Ve(_))}complete(){this.transitions?.complete()}handleNavigationRequest(B){const D=++this.navigationId;this.transitions?.next({...this.transitions.value,...B,id:D})}setupNavigations(B){return this.transitions=new Le.X({id:0,currentUrlTree:B.currentUrlTree,currentRawUrl:B.currentUrlTree,extractedUrl:B.urlHandlingStrategy.extract(B.currentUrlTree),urlAfterRedirects:B.urlHandlingStrategy.extract(B.currentUrlTree),rawUrl:B.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:wi,restoredState:null,currentSnapshot:B.routerState.snapshot,targetSnapshot:null,currentRouterState:B.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,mt.h)(D=>0!==D.id),(0,Me.U)(D=>({...D,extractedUrl:B.urlHandlingStrategy.extract(D.rawUrl)})),(0,ht.w)(D=>{let _=!1,E=!1;return(0,Ue.of)(D).pipe((0,on.b)(M=>{this.currentNavigation={id:M.id,initialUrl:M.rawUrl,extractedUrl:M.extractedUrl,trigger:M.source,extras:M.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,ht.w)(M=>{const q=B.browserUrlTree.toString(),oe=!B.navigated||M.extractedUrl.toString()!==q||q!==B.currentUrlTree.toString();if(!oe&&"reload"!==(M.extras.onSameUrlNavigation??B.onSameUrlNavigation)){const Oe="";return this.events.next(new Po(M.id,B.serializeUrl(D.rawUrl),Oe,0)),B.rawUrlTree=M.rawUrl,M.resolve(null),lt.E}if(B.urlHandlingStrategy.shouldProcessUrl(M.rawUrl))return Y(M.source)&&(B.browserUrlTree=M.extractedUrl),(0,Ue.of)(M).pipe((0,ht.w)(Oe=>{const Pt=this.transitions?.getValue();return this.events.next(new Yo(Oe.id,this.urlSerializer.serialize(Oe.extractedUrl),Oe.source,Oe.restoredState)),Pt!==this.transitions?.getValue()?lt.E:Promise.resolve(Oe)}),function Ic(L,z,H,B,D,_){return(0,Kt.z)(E=>function sl(L,z,H,B,D,_,E="emptyOnly"){return new al(L,z,H,B,D,E,_).recognize()}(L,z,H,B,E.extractedUrl,D,_).pipe((0,Me.U)(({state:M,tree:q})=>({...E,targetSnapshot:M,urlAfterRedirects:q}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,B.config,this.urlSerializer,B.paramsInheritanceStrategy),(0,on.b)(Oe=>{if(D.targetSnapshot=Oe.targetSnapshot,D.urlAfterRedirects=Oe.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Oe.urlAfterRedirects},"eager"===B.urlUpdateStrategy){if(!Oe.extras.skipLocationChange){const Jt=B.urlHandlingStrategy.merge(Oe.urlAfterRedirects,Oe.rawUrl);B.setBrowserUrl(Jt,Oe)}B.browserUrlTree=Oe.urlAfterRedirects}const Pt=new qn(Oe.id,this.urlSerializer.serialize(Oe.extractedUrl),this.urlSerializer.serialize(Oe.urlAfterRedirects),Oe.targetSnapshot);this.events.next(Pt)}));if(oe&&B.urlHandlingStrategy.shouldProcessUrl(B.rawUrlTree)){const{id:Oe,extractedUrl:Pt,source:Jt,restoredState:sr,extras:Qn}=M,Vr=new Yo(Oe,this.urlSerializer.serialize(Pt),Jt,sr);this.events.next(Vr);const Hr=jr(0,this.rootComponentType).snapshot;return D={...M,targetSnapshot:Hr,urlAfterRedirects:Pt,extras:{...Qn,skipLocationChange:!1,replaceUrl:!1}},(0,Ue.of)(D)}{const Oe="";return this.events.next(new Po(M.id,B.serializeUrl(D.extractedUrl),Oe,1)),B.rawUrlTree=M.rawUrl,M.resolve(null),lt.E}}),(0,on.b)(M=>{const q=new Cr(M.id,this.urlSerializer.serialize(M.extractedUrl),this.urlSerializer.serialize(M.urlAfterRedirects),M.targetSnapshot);this.events.next(q)}),(0,Me.U)(M=>D={...M,guards:so(M.targetSnapshot,M.currentSnapshot,this.rootContexts)}),function ki(L,z){return(0,Kt.z)(H=>{const{targetSnapshot:B,currentSnapshot:D,guards:{canActivateChecks:_,canDeactivateChecks:E}}=H;return 0===E.length&&0===_.length?(0,Ue.of)({...H,guardsResult:!0}):function ao(L,z,H,B){return(0,ve.D)(L).pipe((0,Kt.z)(D=>function $n(L,z,H,B,D){const _=z&&z.routeConfig?z.routeConfig.canDeactivate:null;if(!_||0===_.length)return(0,Ue.of)(!0);const E=_.map(M=>{const q=As(z)??D,oe=Bi(M,q);return nr(function J(L){return L&&Xo(L.canDeactivate)}(oe)?oe.canDeactivate(L,z,H,B):q.runInContext(()=>oe(L,z,H,B))).pipe((0,Ut.P)())});return(0,Ue.of)(E).pipe(ir())}(D.component,D.route,H,z,B)),(0,Ut.P)(D=>!0!==D,!0))}(E,B,D,L).pipe((0,Kt.z)(M=>M&&function sa(L){return"boolean"==typeof L}(M)?function te(L,z,H,B){return(0,ve.D)(z).pipe((0,dn.b)(D=>(0,xe.z)(function Ae(L,z){return null!==L&&z&&z(new zt(L)),(0,Ue.of)(!0)}(D.route.parent,B),function X(L,z){return null!==L&&z&&z(new xn(L)),(0,Ue.of)(!0)}(D.route,B),function Ye(L,z,H){const B=z[z.length-1],_=z.slice(0,z.length-1).reverse().map(E=>function xa(L){const z=L.routeConfig?L.routeConfig.canActivateChild:null;return z&&0!==z.length?{node:L,guards:z}:null}(E)).filter(E=>null!==E).map(E=>(0,Re.P)(()=>{const M=E.guards.map(q=>{const oe=As(E.node)??H,ge=Bi(q,oe);return nr(function P(L){return L&&Xo(L.canActivateChild)}(ge)?ge.canActivateChild(B,L):oe.runInContext(()=>ge(B,L))).pipe((0,Ut.P)())});return(0,Ue.of)(M).pipe(ir())}));return(0,Ue.of)(_).pipe(ir())}(L,D.path,H),function re(L,z,H){const B=z.routeConfig?z.routeConfig.canActivate:null;if(!B||0===B.length)return(0,Ue.of)(!0);const D=B.map(_=>(0,Re.P)(()=>{const E=As(z)??H,M=Bi(_,E);return nr(function Js(L){return L&&Xo(L.canActivate)}(M)?M.canActivate(z,L):E.runInContext(()=>M(z,L))).pipe((0,Ut.P)())}));return(0,Ue.of)(D).pipe(ir())}(L,D.route,H))),(0,Ut.P)(D=>!0!==D,!0))}(B,_,L,z):(0,Ue.of)(M)),(0,Me.U)(M=>({...H,guardsResult:M})))})}(this.environmentInjector,M=>this.events.next(M)),(0,on.b)(M=>{if(D.guardsResult=M.guardsResult,hr(M.guardsResult))throw Vo(0,M.guardsResult);const q=new fe(M.id,this.urlSerializer.serialize(M.extractedUrl),this.urlSerializer.serialize(M.urlAfterRedirects),M.targetSnapshot,!!M.guardsResult);this.events.next(q)}),(0,mt.h)(M=>!!M.guardsResult||(B.restoreHistory(M),this.cancelNavigationTransition(M,"",3),!1)),Na(M=>{if(M.guards.canActivateChecks.length)return(0,Ue.of)(M).pipe((0,on.b)(q=>{const oe=new je(q.id,this.urlSerializer.serialize(q.extractedUrl),this.urlSerializer.serialize(q.urlAfterRedirects),q.targetSnapshot);this.events.next(oe)}),(0,ht.w)(q=>{let oe=!1;return(0,Ue.of)(q).pipe(function Mc(L,z){return(0,Kt.z)(H=>{const{targetSnapshot:B,guards:{canActivateChecks:D}}=H;if(!D.length)return(0,Ue.of)(H);let _=0;return(0,ve.D)(D).pipe((0,dn.b)(E=>function fc(L,z,H,B){const D=L.routeConfig,_=L._resolve;return void 0!==D?.title&&!Ba(D)&&(_[hn]=D.title),function Hl(L,z,H,B){const D=function Ea(L){return[...Object.keys(L),...Object.getOwnPropertySymbols(L)]}(L);if(0===D.length)return(0,Ue.of)({});const _={};return(0,ve.D)(D).pipe((0,Kt.z)(E=>function Qs(L,z,H,B){const D=As(z)??B,_=Bi(L,D);return nr(_.resolve?_.resolve(z,H):D.runInContext(()=>_(z,H)))}(L[E],z,H,B).pipe((0,Ut.P)(),(0,on.b)(M=>{_[E]=M}))),bt(1),function ze(L){return(0,Me.U)(()=>L)}(_),(0,Ht.K)(E=>Cn(E)?lt.E:tt(E)))}(_,L,z,B).pipe((0,Me.U)(E=>(L._resolvedData=E,L.data=ps(L,H).resolve,D&&Ba(D)&&(L.data[hn]=D.title),null)))}(E.route,B,L,z)),(0,on.b)(()=>_++),bt(1),(0,Kt.z)(E=>_===D.length?(0,Ue.of)(H):lt.E))})}(B.paramsInheritanceStrategy,this.environmentInjector),(0,on.b)({next:()=>oe=!0,complete:()=>{oe||(B.restoreHistory(q),this.cancelNavigationTransition(q,"",2))}}))}),(0,on.b)(q=>{const oe=new Ce(q.id,this.urlSerializer.serialize(q.extractedUrl),this.urlSerializer.serialize(q.urlAfterRedirects),q.targetSnapshot);this.events.next(oe)}))}),Na(M=>{const q=oe=>{const ge=[];oe.routeConfig?.loadComponent&&!oe.routeConfig._loadedComponent&&ge.push(this.configLoader.loadComponent(oe.routeConfig).pipe((0,on.b)(Oe=>{oe.component=Oe}),(0,Me.U)(()=>{})));for(const Oe of oe.children)ge.push(...q(Oe));return ge};return(0,it.a)(q(M.targetSnapshot.root)).pipe((0,en.d)(),(0,It.q)(1))}),Na(()=>this.afterPreactivation()),(0,Me.U)(M=>{const q=function zo(L,z,H){const B=Ii(L,z._root,H?H._root:void 0);return new To(B,z)}(B.routeReuseStrategy,M.targetSnapshot,M.currentRouterState);return D={...M,targetRouterState:q}}),(0,on.b)(M=>{B.currentUrlTree=M.urlAfterRedirects,B.rawUrlTree=B.urlHandlingStrategy.merge(M.urlAfterRedirects,M.rawUrl),B.routerState=M.targetRouterState,"deferred"===B.urlUpdateStrategy&&(M.extras.skipLocationChange||B.setBrowserUrl(B.rawUrlTree,M),B.browserUrlTree=M.urlAfterRedirects)}),((L,z,H,B)=>(0,Me.U)(D=>(new js(z,D.targetRouterState,D.currentRouterState,H,B).activate(L),D)))(this.rootContexts,B.routeReuseStrategy,M=>this.events.next(M),this.inputBindingEnabled),(0,It.q)(1),(0,on.b)({next:M=>{_=!0,this.lastSuccessfulNavigation=this.currentNavigation,B.navigated=!0,this.events.next(new Vi(M.id,this.urlSerializer.serialize(M.extractedUrl),this.urlSerializer.serialize(B.currentUrlTree))),B.titleStrategy?.updateTitle(M.targetRouterState.snapshot),M.resolve(!0)},complete:()=>{_=!0}}),(0,ct.x)(()=>{_||E||this.cancelNavigationTransition(D,"",1),this.currentNavigation?.id===D.id&&(this.currentNavigation=null)}),(0,Ht.K)(M=>{if(E=!0,ls(M)){ks(M)||(B.navigated=!0,B.restoreHistory(D,!0));const q=new ss(D.id,this.urlSerializer.serialize(D.extractedUrl),M.message,M.cancellationCode);if(this.events.next(q),ks(M)){const oe=B.urlHandlingStrategy.merge(M.url,B.rawUrlTree),ge={skipLocationChange:D.extras.skipLocationChange,replaceUrl:"eager"===B.urlUpdateStrategy||Y(D.source)};B.scheduleNavigation(oe,wi,null,ge,{resolve:D.resolve,reject:D.reject,promise:D.promise})}else D.resolve(!1)}else{B.restoreHistory(D,!0);const q=new No(D.id,this.urlSerializer.serialize(D.extractedUrl),M,D.targetSnapshot??void 0);this.events.next(q);try{D.resolve(B.errorHandler(M))}catch(oe){D.reject(oe)}}return lt.E}))}))}cancelNavigationTransition(B,D,_){const E=new ss(B.id,this.urlSerializer.serialize(B.extractedUrl),D,_);this.events.next(E),B.resolve(!1)}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})();function Y(L){return L!==wi}let Fe=(()=>{var L;class z{buildTitle(B){let D,_=B.root;for(;void 0!==_;)D=this.getResolvedTitleForRoute(_)??D,_=_.children.find(E=>E.outlet===Yt);return D}getResolvedTitleForRoute(B){return B.data[hn]}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:function(){return(0,I.f3M)(Et)},providedIn:"root"}),z})(),Et=(()=>{var L;class z extends Fe{constructor(B){super(),this.title=B}updateTitle(B){const D=this.buildTitle(B);void 0!==D&&this.title.setTitle(D)}}return(L=z).\u0275fac=function(B){return new(B||L)(I.LFG(Gt.Dx))},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})(),wn=(()=>{var L;class z{}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:function(){return(0,I.f3M)(Dr)},providedIn:"root"}),z})();class Mn{shouldDetach(z){return!1}store(z,H){}shouldAttach(z){return!1}retrieve(z){return null}shouldReuseRoute(z,H){return z.routeConfig===H.routeConfig}}let Dr=(()=>{var L;class z extends Mn{}return(L=z).\u0275fac=function(){let H;return function(D){return(H||(H=I.n5z(L)))(D||L)}}(),L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})();const xi=new I.OlP("",{providedIn:"root",factory:()=>({})});let bi=(()=>{var L;class z{}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:function(){return(0,I.f3M)(Br)},providedIn:"root"}),z})(),Br=(()=>{var L;class z{shouldProcessUrl(B){return!0}extract(B){return B}merge(B,D){return B}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})();var to=function(L){return L[L.COMPLETE=0]="COMPLETE",L[L.FAILED=1]="FAILED",L[L.REDIRECTING=2]="REDIRECTING",L}(to||{});function Di(L,z){L.events.pipe((0,mt.h)(H=>H instanceof Vi||H instanceof ss||H instanceof No||H instanceof Po),(0,Me.U)(H=>H instanceof Vi||H instanceof Po?to.COMPLETE:H instanceof ss&&(0===H.code||1===H.code)?to.REDIRECTING:to.FAILED),(0,mt.h)(H=>H!==to.REDIRECTING),(0,It.q)(1)).subscribe(()=>{z()})}function Li(L){throw L}function ko(L,z,H){return z.parse("/")}const Ps={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ta={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Yi=(()=>{var L;class z{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,I.f3M)(I.c2e),this.isNgZoneEnabled=!1,this.options=(0,I.f3M)(xi,{optional:!0})||{},this.pendingTasks=(0,I.f3M)(I.HDt),this.errorHandler=this.options.errorHandler||Li,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||ko,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,I.f3M)(bi),this.routeReuseStrategy=(0,I.f3M)(wn),this.titleStrategy=(0,I.f3M)(Fe),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,I.f3M)(Qo,{optional:!0})?.flat()??[],this.navigationTransitions=(0,I.f3M)(Ke),this.urlSerializer=(0,I.f3M)(vi),this.location=(0,I.f3M)(Se.Ye),this.componentInputBindingEnabled=!!(0,I.f3M)(Si,{optional:!0}),this.isNgZoneEnabled=(0,I.f3M)(I.R0b)instanceof I.R0b&&I.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new yr,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=jr(0,null),this.navigationTransitions.setupNavigations(this).subscribe(B=>{this.lastSuccessfulId=B.id,this.currentPageId=this.browserPageId??0},B=>{this.console.warn(`Unhandled Navigation Error: ${B}`)})}resetRootComponentType(B){this.routerState.root.component=B,this.navigationTransitions.rootComponentType=B}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const B=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),wi,B)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(B=>{const D="popstate"===B.type?"popstate":"hashchange";"popstate"===D&&setTimeout(()=>{this.navigateToSyncWithBrowser(B.url,D,B.state)},0)}))}navigateToSyncWithBrowser(B,D,_){const E={replaceUrl:!0},M=_?.navigationId?_:null;if(_){const oe={..._};delete oe.navigationId,delete oe.\u0275routerPageId,0!==Object.keys(oe).length&&(E.state=oe)}const q=this.parseUrl(B);this.scheduleNavigation(q,D,M,E)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(B){this.config=B.map(ns),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(B,D={}){const{relativeTo:_,queryParams:E,fragment:M,queryParamsHandling:q,preserveFragment:oe}=D,ge=oe?this.currentUrlTree.fragment:M;let Pt,Oe=null;switch(q){case"merge":Oe={...this.currentUrlTree.queryParams,...E};break;case"preserve":Oe=this.currentUrlTree.queryParams;break;default:Oe=E||null}null!==Oe&&(Oe=this.removeEmptyProps(Oe));try{Pt=Wr(_?_.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof B[0]||!B[0].startsWith("/"))&&(B=[]),Pt=this.currentUrlTree.root}return ni(Pt,B,Oe,ge??null)}navigateByUrl(B,D={skipLocationChange:!1}){const _=hr(B)?B:this.parseUrl(B),E=this.urlHandlingStrategy.merge(_,this.rawUrlTree);return this.scheduleNavigation(E,wi,null,D)}navigate(B,D={skipLocationChange:!1}){return function _s(L){for(let z=0;z<L.length;z++)if(null==L[z])throw new I.vHH(4008,!1)}(B),this.navigateByUrl(this.createUrlTree(B,D),D)}serializeUrl(B){return this.urlSerializer.serialize(B)}parseUrl(B){let D;try{D=this.urlSerializer.parse(B)}catch(_){D=this.malformedUriErrorHandler(_,this.urlSerializer,B)}return D}isActive(B,D){let _;if(_=!0===D?{...Ps}:!1===D?{...ta}:D,hr(B))return Lr(this.currentUrlTree,B,_);const E=this.parseUrl(B);return Lr(this.currentUrlTree,E,_)}removeEmptyProps(B){return Object.keys(B).reduce((D,_)=>{const E=B[_];return null!=E&&(D[_]=E),D},{})}scheduleNavigation(B,D,_,E,M){if(this.disposed)return Promise.resolve(!1);let q,oe,ge;M?(q=M.resolve,oe=M.reject,ge=M.promise):ge=new Promise((Pt,Jt)=>{q=Pt,oe=Jt});const Oe=this.pendingTasks.add();return Di(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(Oe))}),this.navigationTransitions.handleNavigationRequest({source:D,restoredState:_,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:B,extras:E,resolve:q,reject:oe,promise:ge,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),ge.catch(Pt=>Promise.reject(Pt))}setBrowserUrl(B,D){const _=this.urlSerializer.serialize(B);if(this.location.isCurrentPathEqualTo(_)||D.extras.replaceUrl){const M={...D.extras.state,...this.generateNgRouterState(D.id,this.browserPageId)};this.location.replaceState(_,"",M)}else{const E={...D.extras.state,...this.generateNgRouterState(D.id,(this.browserPageId??0)+1)};this.location.go(_,"",E)}}restoreHistory(B,D=!1){if("computed"===this.canceledNavigationResolution){const E=this.currentPageId-(this.browserPageId??this.currentPageId);0!==E?this.location.historyGo(E):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===E&&(this.resetState(B),this.browserUrlTree=B.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(D&&this.resetState(B),this.resetUrlToCurrentUrlTree())}resetState(B){this.routerState=B.currentRouterState,this.currentUrlTree=B.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,B.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(B,D){return"computed"===this.canceledNavigationResolution?{navigationId:B,\u0275routerPageId:D}:{navigationId:B}}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})(),Cs=(()=>{var L;class z{constructor(B,D,_,E,M,q){this.router=B,this.route=D,this.tabIndexAttribute=_,this.renderer=E,this.el=M,this.locationStrategy=q,this.href=null,this.commands=null,this.onChanges=new Ft.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const oe=M.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===oe||"area"===oe,this.isAnchorElement?this.subscription=B.events.subscribe(ge=>{ge instanceof Vi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(B){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",B)}ngOnChanges(B){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(B){null!=B?(this.commands=Array.isArray(B)?B:[B],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(B,D,_,E,M){return!!(null===this.urlTree||this.isAnchorElement&&(0!==B||D||_||E||M||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const B=null===this.href?null:(0,I.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",B)}applyAttributeValue(B,D){const _=this.renderer,E=this.el.nativeElement;null!==D?_.setAttribute(E,B,D):_.removeAttribute(E,B)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(L=z).\u0275fac=function(B){return new(B||L)(I.Y36(Yi),I.Y36(Qi),I.$8M("tabindex"),I.Y36(I.Qsj),I.Y36(I.SBq),I.Y36(Se.S$))},L.\u0275dir=I.lG2({type:L,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(B,D){1&B&&I.NdJ("click",function(E){return D.onClick(E.button,E.ctrlKey,E.shiftKey,E.altKey,E.metaKey)}),2&B&&I.uIk("target",D.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",I.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",I.VuI],replaceUrl:["replaceUrl","replaceUrl",I.VuI],routerLink:"routerLink"},standalone:!0,features:[I.Xq5,I.TTD]}),z})();class cl{}let or=(()=>{var L;class z{preload(B,D){return D().pipe((0,Ht.K)(()=>(0,Ue.of)(null)))}}return(L=z).\u0275fac=function(B){return new(B||L)},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})(),ei=(()=>{var L;class z{constructor(B,D,_,E,M){this.router=B,this.injector=_,this.preloadingStrategy=E,this.loader=M}setUpPreloading(){this.subscription=this.router.events.pipe((0,mt.h)(B=>B instanceof Vi),(0,dn.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(B,D){const _=[];for(const E of D){E.providers&&!E._injector&&(E._injector=(0,I.MMx)(E.providers,B,`Route: ${E.path}`));const M=E._injector??B,q=E._loadedInjector??M;(E.loadChildren&&!E._loadedRoutes&&void 0===E.canLoad||E.loadComponent&&!E._loadedComponent)&&_.push(this.preloadConfig(M,E)),(E.children||E._loadedRoutes)&&_.push(this.processRoutes(q,E.children??E._loadedRoutes))}return(0,ve.D)(_).pipe((0,Lt.J)())}preloadConfig(B,D){return this.preloadingStrategy.preload(D,()=>{let _;_=D.loadChildren&&void 0===D.canLoad?this.loader.loadChildren(B,D):(0,Ue.of)(null);const E=_.pipe((0,Kt.z)(M=>null===M?(0,Ue.of)(void 0):(D._loadedRoutes=M.routes,D._loadedInjector=M.injector,this.processRoutes(M.injector??B,M.routes))));if(D.loadComponent&&!D._loadedComponent){const M=this.loader.loadComponent(D);return(0,ve.D)([E,M]).pipe((0,Lt.J)())}return E})}}return(L=z).\u0275fac=function(B){return new(B||L)(I.LFG(Yi),I.LFG(I.Sil),I.LFG(I.lqb),I.LFG(cl),I.LFG(ea))},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),z})();const Za=new I.OlP("");let wl=(()=>{var L;class z{constructor(B,D,_,E,M={}){this.urlSerializer=B,this.transitions=D,this.viewportScroller=_,this.zone=E,this.options=M,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},M.scrollPositionRestoration=M.scrollPositionRestoration||"disabled",M.anchorScrolling=M.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(B=>{B instanceof Yo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=B.navigationTrigger,this.restoredId=B.restoredState?B.restoredState.navigationId:0):B instanceof Vi?(this.lastId=B.id,this.scheduleScrollEvent(B,this.urlSerializer.parse(B.urlAfterRedirects).fragment)):B instanceof Po&&0===B.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(B,this.urlSerializer.parse(B.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(B=>{B instanceof An&&(B.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(B.position):B.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(B.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(B,D){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new An(B,"popstate"===this.lastSource?this.store[this.restoredId]:null,D))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(L=z).\u0275fac=function(B){I.$Z()},L.\u0275prov=I.Yz7({token:L,factory:L.\u0275fac}),z})();function Bs(L,z){return{\u0275kind:L,\u0275providers:z}}function za(){const L=(0,I.f3M)(I.zs3);return z=>{const H=L.get(I.z2F);if(z!==H.components[0])return;const B=L.get(Yi),D=L.get(Zl);1===L.get(pc)&&B.initialNavigation(),L.get(El,null,I.XFs.Optional)?.setUpPreloading(),L.get(Za,null,I.XFs.Optional)?.init(),B.resetRootComponentType(H.componentTypes[0]),D.closed||(D.next(),D.complete(),D.unsubscribe())}}const Zl=new I.OlP("",{factory:()=>new Ft.x}),pc=new I.OlP("",{providedIn:"root",factory:()=>1}),El=new I.OlP("");function ds(L){return Bs(0,[{provide:El,useExisting:ei},{provide:cl,useExisting:L}])}const mc=new I.OlP("ROUTER_FORROOT_GUARD"),zu=[Se.Ye,{provide:vi,useClass:Yr},Yi,kr,{provide:Qi,useFactory:function Ya(L){return L.routerState.root},deps:[Yi]},ea,[]];function Va(){return new I.PXZ("Router",Yi)}let Ts=(()=>{var L;class z{constructor(B){}static forRoot(B,D){return{ngModule:z,providers:[zu,[],{provide:Qo,multi:!0,useValue:B},{provide:mc,useFactory:ca,deps:[[Yi,new I.FiY,new I.tp0]]},{provide:xi,useValue:D||{}},D?.useHash?{provide:Se.S$,useClass:Se.Do}:{provide:Se.S$,useClass:Se.b0},{provide:Za,useFactory:()=>{const L=(0,I.f3M)(Se.EM),z=(0,I.f3M)(I.R0b),H=(0,I.f3M)(xi),B=(0,I.f3M)(Ke),D=(0,I.f3M)(vi);return H.scrollOffset&&L.setOffset(H.scrollOffset),new wl(D,B,L,z,H)}},D?.preloadingStrategy?ds(D.preloadingStrategy).\u0275providers:[],{provide:I.PXZ,multi:!0,useFactory:Va},D?.initialNavigation?Pc(D):[],D?.bindToComponentInputs?Bs(8,[Io,{provide:Si,useExisting:Io}]).\u0275providers:[],[{provide:Xl,useFactory:za},{provide:I.tb,multi:!0,useExisting:Xl}]]}}static forChild(B){return{ngModule:z,providers:[{provide:Qo,multi:!0,useValue:B}]}}}return(L=z).\u0275fac=function(B){return new(B||L)(I.LFG(mc,8))},L.\u0275mod=I.oAB({type:L}),L.\u0275inj=I.cJS({}),z})();function ca(L){return"guarded"}function Pc(L){return["disabled"===L.initialNavigation?Bs(3,[{provide:I.ip1,multi:!0,useFactory:()=>{const z=(0,I.f3M)(Yi);return()=>{z.setUpLocationChangeListener()}}},{provide:pc,useValue:2}]).\u0275providers:[],"enabledBlocking"===L.initialNavigation?Bs(2,[{provide:pc,useValue:0},{provide:I.ip1,multi:!0,deps:[I.zs3],useFactory:z=>{const H=z.get(Se.V_,Promise.resolve());return()=>H.then(()=>new Promise(B=>{const D=z.get(Yi),_=z.get(Zl);Di(D,()=>{B(!0)}),z.get(Ke).afterPreactivation=()=>(B(!0),_.closed?(0,Ue.of)(void 0):_),D.initialNavigation()}))}}]).\u0275providers:[]]}const Xl=new I.OlP("")},3106:(Gn,At,K)=>{"use strict";K.d(At,{Z:()=>pt});var I=K(9058),b=K(4537),dt=K(534),l=K(7879);class ve{constructor(_t,nt){this._delegate=_t,this.firebase=nt,(0,dt._addComponent)(_t,new b.wA("app-compat",()=>this,"PUBLIC")),this.container=_t.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(_t){this._delegate.automaticDataCollectionEnabled=_t}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(_t=>{this._delegate.checkDestroyed(),_t()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,dt.deleteApp)(this._delegate)))}_getService(_t,nt=dt._DEFAULT_ENTRY_NAME){var Bt;this._delegate.checkDestroyed();const Ft=this._delegate.container.getProvider(_t);return!Ft.isInitialized()&&"EXPLICIT"===(null===(Bt=Ft.getComponent())||void 0===Bt?void 0:Bt.instantiationMode)&&Ft.initialize(),Ft.getImmediate({identifier:nt})}_removeServiceInstance(_t,nt=dt._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(_t).clearInstance(nt)}_addComponent(_t){(0,dt._addComponent)(this._delegate,_t)}_addOrOverwriteComponent(_t){(0,dt._addOrOverwriteComponent)(this._delegate,_t)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Le=new I.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),xe=function et(){const vt=function it(vt){const _t={},nt={__esModule:!0,initializeApp:function Se(Je,mt={}){const Kt=dt.initializeApp(Je,mt);if((0,I.r3)(_t,Kt.name))return _t[Kt.name];const Ut=new vt(Kt,nt);return _t[Kt.name]=Ut,Ut},app:Ft,registerVersion:dt.registerVersion,setLogLevel:dt.setLogLevel,onLog:dt.onLog,apps:null,SDK_VERSION:dt.SDK_VERSION,INTERNAL:{registerComponent:function ht(Je){const mt=Je.name,Kt=mt.replace("-compat","");if(dt._registerComponent(Je)&&"PUBLIC"===Je.type){const Ut=(dn=Ft())=>{if("function"!=typeof dn[Kt])throw Le.create("invalid-app-argument",{appName:mt});return dn[Kt]()};void 0!==Je.serviceProps&&(0,I.ZB)(Ut,Je.serviceProps),nt[Kt]=Ut,vt.prototype[Kt]=function(...dn){return this._getService.bind(this,mt).apply(this,Je.multipleInstances?dn:[])}}return"PUBLIC"===Je.type?nt[Kt]:null},removeApp:function Bt(Je){delete _t[Je]},useAsService:function It(Je,mt){return"serverAuth"===mt?null:mt},modularAPIs:dt}};function Ft(Je){if(!(0,I.r3)(_t,Je=Je||dt._DEFAULT_ENTRY_NAME))throw Le.create("no-app",{appName:Je});return _t[Je]}return nt.default=nt,Object.defineProperty(nt,"apps",{get:function Me(){return Object.keys(_t).map(Je=>_t[Je])}}),Ft.App=vt,nt}(ve);return vt.INTERNAL=Object.assign(Object.assign({},vt.INTERNAL),{createFirebaseNamespace:et,extendNamespace:function _t(nt){(0,I.ZB)(vt,nt)},createSubscribe:I.ne,ErrorFactory:I.LL,deepExtend:I.ZB}),vt}(),Re=new l.Yd("@firebase/app-compat");if((0,I.jU)()&&void 0!==self.firebase){Re.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const vt=self.firebase.SDK_VERSION;vt&&vt.indexOf("LITE")>=0&&Re.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const pt=xe;!function lt(vt){(0,dt.registerVersion)("@firebase/app-compat","0.2.23",vt)}()},534:(Gn,At,K)=>{"use strict";K.r(At),K.d(At,{FirebaseError:()=>l.ZR,SDK_VERSION:()=>Qe,_DEFAULT_ENTRY_NAME:()=>fr,_addComponent:()=>Ci,_addOrOverwriteComponent:()=>qi,_apps:()=>yr,_clearComponents:()=>Yr,_components:()=>gr,_getProvider:()=>Ai,_registerComponent:()=>Sr,_removeServiceInstance:()=>vi,deleteApp:()=>ut,getApp:()=>_e,getApps:()=>qe,initializeApp:()=>he,onLog:()=>kt,registerVersion:()=>Ot,setLogLevel:()=>xt});var I=K(5861),b=K(4537),dt=K(7879),l=K(9058);const ve=(rn,Tt)=>Tt.some(Dn=>rn instanceof Dn);let Ue,Le;const xe=new WeakMap,Re=new WeakMap,Ze=new WeakMap,tt=new WeakMap,lt=new WeakMap;let _t={get(rn,Tt,Dn){if(rn instanceof IDBTransaction){if("done"===Tt)return Re.get(rn);if("objectStoreNames"===Tt)return rn.objectStoreNames||Ze.get(rn);if("store"===Tt)return Dn.objectStoreNames[1]?void 0:Dn.objectStore(Dn.objectStoreNames[0])}return Se(rn[Tt])},set:(rn,Tt,Dn)=>(rn[Tt]=Dn,!0),has:(rn,Tt)=>rn instanceof IDBTransaction&&("done"===Tt||"store"===Tt)||Tt in rn};function Ft(rn){return"function"==typeof rn?function Bt(rn){return rn!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function et(){return Le||(Le=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(rn)?function(...Tt){return rn.apply(Me(this),Tt),Se(xe.get(this))}:function(...Tt){return Se(rn.apply(Me(this),Tt))}:function(Tt,...Dn){const ur=rn.call(Me(this),Tt,...Dn);return Ze.set(ur,Tt.sort?Tt.sort():[Tt]),Se(ur)}}(rn):(rn instanceof IDBTransaction&&function vt(rn){if(Re.has(rn))return;const Tt=new Promise((Dn,ur)=>{const Zn=()=>{rn.removeEventListener("complete",Rr),rn.removeEventListener("error",Fr),rn.removeEventListener("abort",Fr)},Rr=()=>{Dn(),Zn()},Fr=()=>{ur(rn.error||new DOMException("AbortError","AbortError")),Zn()};rn.addEventListener("complete",Rr),rn.addEventListener("error",Fr),rn.addEventListener("abort",Fr)});Re.set(rn,Tt)}(rn),ve(rn,function it(){return Ue||(Ue=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(rn,_t):rn)}function Se(rn){if(rn instanceof IDBRequest)return function pt(rn){const Tt=new Promise((Dn,ur)=>{const Zn=()=>{rn.removeEventListener("success",Rr),rn.removeEventListener("error",Fr)},Rr=()=>{Dn(Se(rn.result)),Zn()},Fr=()=>{ur(rn.error),Zn()};rn.addEventListener("success",Rr),rn.addEventListener("error",Fr)});return Tt.then(Dn=>{Dn instanceof IDBCursor&&xe.set(Dn,rn)}).catch(()=>{}),lt.set(Tt,rn),Tt}(rn);if(tt.has(rn))return tt.get(rn);const Tt=Ft(rn);return Tt!==rn&&(tt.set(rn,Tt),lt.set(Tt,rn)),Tt}const Me=rn=>lt.get(rn),Je=["get","getKey","getAll","getAllKeys","count"],mt=["put","add","delete","clear"],Kt=new Map;function Ut(rn,Tt){if(!(rn instanceof IDBDatabase)||Tt in rn||"string"!=typeof Tt)return;if(Kt.get(Tt))return Kt.get(Tt);const Dn=Tt.replace(/FromIndex$/,""),ur=Tt!==Dn,Zn=mt.includes(Dn);if(!(Dn in(ur?IDBIndex:IDBObjectStore).prototype)||!Zn&&!Je.includes(Dn))return;const Rr=function(){var Fr=(0,I.Z)(function*(fi,...Ti){const Qr=this.transaction(fi,Zn?"readwrite":"readonly");let ui=Qr.store;return ur&&(ui=ui.index(Ti.shift())),(yield Promise.all([ui[Dn](...Ti),Zn&&Qr.done]))[0]});return function(Ti){return Fr.apply(this,arguments)}}();return Kt.set(Tt,Rr),Rr}!function nt(rn){_t=rn(_t)}(rn=>({...rn,get:(Tt,Dn,ur)=>Ut(Tt,Dn)||rn.get(Tt,Dn,ur),has:(Tt,Dn)=>!!Ut(Tt,Dn)||rn.has(Tt,Dn)}));class dn{constructor(Tt){this.container=Tt}getPlatformInfoString(){return this.container.getProviders().map(Dn=>{if(function on(rn){const Tt=rn.getComponent();return"VERSION"===Tt?.type}(Dn)){const ur=Dn.getImmediate();return`${ur.library}/${ur.version}`}return null}).filter(Dn=>Dn).join(" ")}}const Ht="@firebase/app",en=new dt.Yd("@firebase/app"),fr="[DEFAULT]",Er={[Ht]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},yr=new Map,gr=new Map;function Ci(rn,Tt){try{rn.container.addComponent(Tt)}catch(Dn){en.debug(`Component ${Tt.name} failed to register with FirebaseApp ${rn.name}`,Dn)}}function qi(rn,Tt){rn.container.addOrOverwriteComponent(Tt)}function Sr(rn){const Tt=rn.name;if(gr.has(Tt))return en.debug(`There were multiple attempts to register component ${Tt}.`),!1;gr.set(Tt,rn);for(const Dn of yr.values())Ci(Dn,rn);return!0}function Ai(rn,Tt){const Dn=rn.container.getProvider("heartbeat").getImmediate({optional:!0});return Dn&&Dn.triggerHeartbeat(),rn.container.getProvider(Tt)}function vi(rn,Tt,Dn=fr){Ai(rn,Tt).clearInstance(Dn)}function Yr(){gr.clear()}const Or=new l.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Co{constructor(Tt,Dn,ur){this._isDeleted=!1,this._options=Object.assign({},Tt),this._config=Object.assign({},Dn),this._name=Dn.name,this._automaticDataCollectionEnabled=Dn.automaticDataCollectionEnabled,this._container=ur,this.container.addComponent(new b.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Tt){this.checkDestroyed(),this._automaticDataCollectionEnabled=Tt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Tt){this._isDeleted=Tt}checkDestroyed(){if(this.isDeleted)throw Or.create("app-deleted",{appName:this._name})}}const Qe="10.6.0";function he(rn,Tt={}){let Dn=rn;"object"!=typeof Tt&&(Tt={name:Tt});const ur=Object.assign({name:fr,automaticDataCollectionEnabled:!1},Tt),Zn=ur.name;if("string"!=typeof Zn||!Zn)throw Or.create("bad-app-name",{appName:String(Zn)});if(Dn||(Dn=(0,l.aH)()),!Dn)throw Or.create("no-options");const Rr=yr.get(Zn);if(Rr){if((0,l.vZ)(Dn,Rr.options)&&(0,l.vZ)(ur,Rr.config))return Rr;throw Or.create("duplicate-app",{appName:Zn})}const Fr=new b.H0(Zn);for(const Ti of gr.values())Fr.addComponent(Ti);const fi=new Co(Dn,ur,Fr);return yr.set(Zn,fi),fi}function _e(rn=fr){const Tt=yr.get(rn);if(!Tt&&rn===fr&&(0,l.aH)())return he();if(!Tt)throw Or.create("no-app",{appName:rn});return Tt}function qe(){return Array.from(yr.values())}function ut(rn){return wt.apply(this,arguments)}function wt(){return(wt=(0,I.Z)(function*(rn){const Tt=rn.name;yr.has(Tt)&&(yr.delete(Tt),yield Promise.all(rn.container.getProviders().map(Dn=>Dn.delete())),rn.isDeleted=!0)})).apply(this,arguments)}function Ot(rn,Tt,Dn){var ur;let Zn=null!==(ur=Er[rn])&&void 0!==ur?ur:rn;Dn&&(Zn+=`-${Dn}`);const Rr=Zn.match(/\s|\//),Fr=Tt.match(/\s|\//);if(Rr||Fr){const fi=[`Unable to register library "${Zn}" with version "${Tt}":`];return Rr&&fi.push(`library name "${Zn}" contains illegal characters (whitespace or "/")`),Rr&&Fr&&fi.push("and"),Fr&&fi.push(`version name "${Tt}" contains illegal characters (whitespace or "/")`),void en.warn(fi.join(" "))}Sr(new b.wA(`${Zn}-version`,()=>({library:Zn,version:Tt}),"VERSION"))}function kt(rn,Tt){if(null!==rn&&"function"!=typeof rn)throw Or.create("invalid-log-argument");(0,dt.Am)(rn,Tt)}function xt(rn){(0,dt.Ub)(rn)}const Vt="firebase-heartbeat-database",yn=1,Be="firebase-heartbeat-store";let le=null;function de(){return le||(le=function ht(rn,Tt,{blocked:Dn,upgrade:ur,blocking:Zn,terminated:Rr}={}){const Fr=indexedDB.open(rn,Tt),fi=Se(Fr);return ur&&Fr.addEventListener("upgradeneeded",Ti=>{ur(Se(Fr.result),Ti.oldVersion,Ti.newVersion,Se(Fr.transaction),Ti)}),Dn&&Fr.addEventListener("blocked",Ti=>Dn(Ti.oldVersion,Ti.newVersion,Ti)),fi.then(Ti=>{Rr&&Ti.addEventListener("close",()=>Rr()),Zn&&Ti.addEventListener("versionchange",Qr=>Zn(Qr.oldVersion,Qr.newVersion,Qr))}).catch(()=>{}),fi}(Vt,yn,{upgrade:(rn,Tt)=>{0===Tt&&rn.createObjectStore(Be)}}).catch(rn=>{throw Or.create("idb-open",{originalErrorMessage:rn.message})})),le}function pe(){return(pe=(0,I.Z)(function*(rn){try{return yield(yield de()).transaction(Be).objectStore(Be).get(vn(rn))}catch(Tt){if(Tt instanceof l.ZR)en.warn(Tt.message);else{const Dn=Or.create("idb-get",{originalErrorMessage:Tt?.message});en.warn(Dn.message)}}})).apply(this,arguments)}function ot(rn,Tt){return $t.apply(this,arguments)}function $t(){return($t=(0,I.Z)(function*(rn,Tt){try{const ur=(yield de()).transaction(Be,"readwrite");yield ur.objectStore(Be).put(Tt,vn(rn)),yield ur.done}catch(Dn){if(Dn instanceof l.ZR)en.warn(Dn.message);else{const ur=Or.create("idb-set",{originalErrorMessage:Dn?.message});en.warn(ur.message)}}})).apply(this,arguments)}function vn(rn){return`${rn.name}!${rn.options.appId}`}class hr{constructor(Tt){this.container=Tt,this._heartbeatsCache=null;const Dn=this.container.getProvider("app").getImmediate();this._storage=new ni(Dn),this._heartbeatsCachePromise=this._storage.read().then(ur=>(this._heartbeatsCache=ur,ur))}triggerHeartbeat(){var Tt=this;return(0,I.Z)(function*(){var Dn;const Zn=Tt.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Rr=vr();if(null==(null===(Dn=Tt._heartbeatsCache)||void 0===Dn?void 0:Dn.heartbeats)&&(Tt._heartbeatsCache=yield Tt._heartbeatsCachePromise),Tt._heartbeatsCache.lastSentHeartbeatDate!==Rr&&!Tt._heartbeatsCache.heartbeats.some(Fr=>Fr.date===Rr))return Tt._heartbeatsCache.heartbeats.push({date:Rr,agent:Zn}),Tt._heartbeatsCache.heartbeats=Tt._heartbeatsCache.heartbeats.filter(Fr=>{const fi=new Date(Fr.date).valueOf();return Date.now()-fi<=2592e6}),Tt._storage.overwrite(Tt._heartbeatsCache)})()}getHeartbeatsHeader(){var Tt=this;return(0,I.Z)(function*(){var Dn;if(null===Tt._heartbeatsCache&&(yield Tt._heartbeatsCachePromise),null==(null===(Dn=Tt._heartbeatsCache)||void 0===Dn?void 0:Dn.heartbeats)||0===Tt._heartbeatsCache.heartbeats.length)return"";const ur=vr(),{heartbeatsToSend:Zn,unsentEntries:Rr}=function Wr(rn,Tt=1024){const Dn=[];let ur=rn.slice();for(const Zn of rn){const Rr=Dn.find(Fr=>Fr.agent===Zn.agent);if(Rr){if(Rr.dates.push(Zn.date),ro(Dn)>Tt){Rr.dates.pop();break}}else if(Dn.push({agent:Zn.agent,dates:[Zn.date]}),ro(Dn)>Tt){Dn.pop();break}ur=ur.slice(1)}return{heartbeatsToSend:Dn,unsentEntries:ur}}(Tt._heartbeatsCache.heartbeats),Fr=(0,l.L)(JSON.stringify({version:2,heartbeats:Zn}));return Tt._heartbeatsCache.lastSentHeartbeatDate=ur,Rr.length>0?(Tt._heartbeatsCache.heartbeats=Rr,yield Tt._storage.overwrite(Tt._heartbeatsCache)):(Tt._heartbeatsCache.heartbeats=[],Tt._storage.overwrite(Tt._heartbeatsCache)),Fr})()}}function vr(){return(new Date).toISOString().substring(0,10)}class ni{constructor(Tt){this.app=Tt,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,I.Z)(function*(){return!!(0,l.hl)()&&(0,l.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Tt=this;return(0,I.Z)(function*(){return(yield Tt._canUseIndexedDBPromise)&&(yield function Ne(rn){return pe.apply(this,arguments)}(Tt.app))||{heartbeats:[]}})()}overwrite(Tt){var Dn=this;return(0,I.Z)(function*(){var ur;if(yield Dn._canUseIndexedDBPromise){const Rr=yield Dn.read();return ot(Dn.app,{lastSentHeartbeatDate:null!==(ur=Tt.lastSentHeartbeatDate)&&void 0!==ur?ur:Rr.lastSentHeartbeatDate,heartbeats:Tt.heartbeats})}})()}add(Tt){var Dn=this;return(0,I.Z)(function*(){var ur;if(yield Dn._canUseIndexedDBPromise){const Rr=yield Dn.read();return ot(Dn.app,{lastSentHeartbeatDate:null!==(ur=Tt.lastSentHeartbeatDate)&&void 0!==ur?ur:Rr.lastSentHeartbeatDate,heartbeats:[...Rr.heartbeats,...Tt.heartbeats]})}})()}}function ro(rn){return(0,l.L)(JSON.stringify({version:2,heartbeats:rn})).length}!function Bo(rn){Sr(new b.wA("platform-logger",Tt=>new dn(Tt),"PRIVATE")),Sr(new b.wA("heartbeat",Tt=>new hr(Tt),"PRIVATE")),Ot(Ht,"0.9.23",rn),Ot(Ht,"0.9.23","esm2017"),Ot("fire-js","")}("")},4537:(Gn,At,K)=>{"use strict";K.d(At,{H0:()=>it,wA:()=>dt});var I=K(5861),b=K(9058);class dt{constructor(xe,Re,Ze){this.name=xe,this.instanceFactory=Re,this.type=Ze,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(xe){return this.instantiationMode=xe,this}setMultipleInstances(xe){return this.multipleInstances=xe,this}setServiceProps(xe){return this.serviceProps=xe,this}setInstanceCreatedCallback(xe){return this.onInstanceCreated=xe,this}}const l="[DEFAULT]";class ve{constructor(xe,Re){this.name=xe,this.container=Re,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(xe){const Re=this.normalizeInstanceIdentifier(xe);if(!this.instancesDeferred.has(Re)){const Ze=new b.BH;if(this.instancesDeferred.set(Re,Ze),this.isInitialized(Re)||this.shouldAutoInitialize())try{const tt=this.getOrInitializeService({instanceIdentifier:Re});tt&&Ze.resolve(tt)}catch{}}return this.instancesDeferred.get(Re).promise}getImmediate(xe){var Re;const Ze=this.normalizeInstanceIdentifier(xe?.identifier),tt=null!==(Re=xe?.optional)&&void 0!==Re&&Re;if(!this.isInitialized(Ze)&&!this.shouldAutoInitialize()){if(tt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ze})}catch(lt){if(tt)return null;throw lt}}getComponent(){return this.component}setComponent(xe){if(xe.name!==this.name)throw Error(`Mismatching Component ${xe.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=xe,this.shouldAutoInitialize()){if(function Le(et){return"EAGER"===et.instantiationMode}(xe))try{this.getOrInitializeService({instanceIdentifier:l})}catch{}for(const[Re,Ze]of this.instancesDeferred.entries()){const tt=this.normalizeInstanceIdentifier(Re);try{const lt=this.getOrInitializeService({instanceIdentifier:tt});Ze.resolve(lt)}catch{}}}}clearInstance(xe=l){this.instancesDeferred.delete(xe),this.instancesOptions.delete(xe),this.instances.delete(xe)}delete(){var xe=this;return(0,I.Z)(function*(){const Re=Array.from(xe.instances.values());yield Promise.all([...Re.filter(Ze=>"INTERNAL"in Ze).map(Ze=>Ze.INTERNAL.delete()),...Re.filter(Ze=>"_delete"in Ze).map(Ze=>Ze._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(xe=l){return this.instances.has(xe)}getOptions(xe=l){return this.instancesOptions.get(xe)||{}}initialize(xe={}){const{options:Re={}}=xe,Ze=this.normalizeInstanceIdentifier(xe.instanceIdentifier);if(this.isInitialized(Ze))throw Error(`${this.name}(${Ze}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const tt=this.getOrInitializeService({instanceIdentifier:Ze,options:Re});for(const[lt,pt]of this.instancesDeferred.entries())Ze===this.normalizeInstanceIdentifier(lt)&&pt.resolve(tt);return tt}onInit(xe,Re){var Ze;const tt=this.normalizeInstanceIdentifier(Re),lt=null!==(Ze=this.onInitCallbacks.get(tt))&&void 0!==Ze?Ze:new Set;lt.add(xe),this.onInitCallbacks.set(tt,lt);const pt=this.instances.get(tt);return pt&&xe(pt,tt),()=>{lt.delete(xe)}}invokeOnInitCallbacks(xe,Re){const Ze=this.onInitCallbacks.get(Re);if(Ze)for(const tt of Ze)try{tt(xe,Re)}catch{}}getOrInitializeService({instanceIdentifier:xe,options:Re={}}){let Ze=this.instances.get(xe);if(!Ze&&this.component&&(Ze=this.component.instanceFactory(this.container,{instanceIdentifier:(et=xe,et===l?void 0:et),options:Re}),this.instances.set(xe,Ze),this.instancesOptions.set(xe,Re),this.invokeOnInitCallbacks(Ze,xe),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,xe,Ze)}catch{}var et;return Ze||null}normalizeInstanceIdentifier(xe=l){return this.component?this.component.multipleInstances?xe:l:xe}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class it{constructor(xe){this.name=xe,this.providers=new Map}addComponent(xe){const Re=this.getProvider(xe.name);if(Re.isComponentSet())throw new Error(`Component ${xe.name} has already been registered with ${this.name}`);Re.setComponent(xe)}addOrOverwriteComponent(xe){this.getProvider(xe.name).isComponentSet()&&this.providers.delete(xe.name),this.addComponent(xe)}getProvider(xe){if(this.providers.has(xe))return this.providers.get(xe);const Re=new ve(xe,this);return this.providers.set(xe,Re),Re}getProviders(){return Array.from(this.providers.values())}}},7879:(Gn,At,K)=>{"use strict";K.d(At,{Am:()=>et,Ub:()=>it,Yd:()=>Le,in:()=>b});const I=[];var b=function(xe){return xe[xe.DEBUG=0]="DEBUG",xe[xe.VERBOSE=1]="VERBOSE",xe[xe.INFO=2]="INFO",xe[xe.WARN=3]="WARN",xe[xe.ERROR=4]="ERROR",xe[xe.SILENT=5]="SILENT",xe}(b||{});const dt={debug:b.DEBUG,verbose:b.VERBOSE,info:b.INFO,warn:b.WARN,error:b.ERROR,silent:b.SILENT},l=b.INFO,ve={[b.DEBUG]:"log",[b.VERBOSE]:"log",[b.INFO]:"info",[b.WARN]:"warn",[b.ERROR]:"error"},Ue=(xe,Re,...Ze)=>{if(Re<xe.logLevel)return;const tt=(new Date).toISOString(),lt=ve[Re];if(!lt)throw new Error(`Attempted to log a message with an invalid logType (value: ${Re})`);console[lt](`[${tt}]  ${xe.name}:`,...Ze)};class Le{constructor(Re){this.name=Re,this._logLevel=l,this._logHandler=Ue,this._userLogHandler=null,I.push(this)}get logLevel(){return this._logLevel}set logLevel(Re){if(!(Re in b))throw new TypeError(`Invalid value "${Re}" assigned to \`logLevel\``);this._logLevel=Re}setLogLevel(Re){this._logLevel="string"==typeof Re?dt[Re]:Re}get logHandler(){return this._logHandler}set logHandler(Re){if("function"!=typeof Re)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Re}get userLogHandler(){return this._userLogHandler}set userLogHandler(Re){this._userLogHandler=Re}debug(...Re){this._userLogHandler&&this._userLogHandler(this,b.DEBUG,...Re),this._logHandler(this,b.DEBUG,...Re)}log(...Re){this._userLogHandler&&this._userLogHandler(this,b.VERBOSE,...Re),this._logHandler(this,b.VERBOSE,...Re)}info(...Re){this._userLogHandler&&this._userLogHandler(this,b.INFO,...Re),this._logHandler(this,b.INFO,...Re)}warn(...Re){this._userLogHandler&&this._userLogHandler(this,b.WARN,...Re),this._logHandler(this,b.WARN,...Re)}error(...Re){this._userLogHandler&&this._userLogHandler(this,b.ERROR,...Re),this._logHandler(this,b.ERROR,...Re)}}function it(xe){I.forEach(Re=>{Re.setLogLevel(xe)})}function et(xe,Re){for(const Ze of I){let tt=null;Re&&Re.level&&(tt=dt[Re.level]),Ze.userLogHandler=null===xe?null:(lt,pt,...vt)=>{const _t=vt.map(nt=>{if(null==nt)return null;if("string"==typeof nt)return nt;if("number"==typeof nt||"boolean"==typeof nt)return nt.toString();if(nt instanceof Error)return nt.message;try{return JSON.stringify(nt)}catch{return null}}).filter(nt=>nt).join(" ");pt>=(tt??lt.logLevel)&&xe({level:b[pt].toLowerCase(),message:_t,args:vt,type:lt.name})}}}},7852:(Gn,At,K)=>{"use strict";K.d(At,{w:()=>Xt,dr:()=>Er,oU:()=>gr,cs:()=>jo,YG:()=>vi,Sm:()=>Yr,PM:()=>Do,FN:()=>Or,Zi:()=>Co,tO:()=>Qe,Dq:()=>he,wI:()=>ut,W2:()=>wt,fr:()=>Be,Gu:()=>de,gu:()=>Ne,pK:()=>vn,Ie:()=>Xn,Q$:()=>ro,z0:()=>Dn,fG:()=>ur,jP:()=>_o,cJ:()=>Po,GO:()=>No,wd:()=>pn,ho:()=>cr,sr:()=>Tr,Pc:()=>ba,r4:()=>gs,HT:()=>va,SH:()=>To,YI:()=>ms,QI:()=>Bn,j9:()=>mr,yF:()=>so});var I=K(5861),b=K(5879),dt=K(95),l=K(7582),ve=K(2438),Ue=K(8645),Le=K(5619),it=K(2572),et=K(2096),xe=K(1160),pt=(K(6506),K(8899),K(5298),K(8077),K(7876)),vt=K(544),_t=K(1273),nt=K(8354),Ft=(K(1767),K(8946)),ht=(K(7643),K(4587),K(6953)),Je=K(2181),mt=K(4664),Kt=K(3997),Ut=K(6814);const on=pt.i,en=["*"],Lt=P=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(P):"function"==typeof requestAnimationFrame?requestAnimationFrame(P):setTimeout(P);let Gt=(()=>{class P{constructor(R,ne){this.injector=R,this.el=ne,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(R){this.el.nativeElement.value=this.lastValue=R,Yt(this.el)}handleValueChange(R,ne){R===this.el.nativeElement&&(ne!==this.lastValue&&(this.lastValue=ne,this.onChange(ne)),Yt(this.el))}_handleBlurEvent(R){R===this.el.nativeElement&&(this.onTouched(),Yt(this.el))}registerOnChange(R){this.onChange=R}registerOnTouched(R){this.onTouched=R}setDisabledState(R){this.el.nativeElement.disabled=R}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let R;try{R=this.injector.get(dt.a5)}catch{}if(!R)return;R.statusChanges&&(this.statusChanges=R.statusChanges.subscribe(()=>Yt(this.el)));const ne=R.control;ne&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Cn=>{if(typeof ne[Cn]<"u"){const lr=ne[Cn].bind(ne);ne[Cn]=(...ir)=>{lr(...ir),Yt(this.el)}}})}}return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.zs3),b.Y36(b.SBq))},P.\u0275dir=b.lG2({type:P,hostBindings:function(R,ne){1&R&&b.NdJ("ionBlur",function(Cn){return ne._handleBlurEvent(Cn.target)})}}),P})();const Yt=P=>{Lt(()=>{const J=P.nativeElement,R=null!=J.value&&J.value.toString().length>0,ne=hn(J);sn(J,ne);const ke=J.closest("ion-item");ke&&sn(ke,R?[...ne,"item-has-value"]:ne)})},hn=P=>{const J=P.classList,R=[];for(let ne=0;ne<J.length;ne++){const ke=J.item(ne);null!==ke&&jt(ke,"ng-")&&R.push(`ion-${ke.substring(3)}`)}return R},sn=(P,J)=>{const R=P.classList;R.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),R.add(...J)},jt=(P,J)=>P.substring(0,J.length)===J;let Xt=(()=>{class P extends Gt{constructor(R,ne){super(R,ne)}writeValue(R){this.el.nativeElement.checked=this.lastValue=R,Yt(this.el)}_handleIonChange(R){this.handleValueChange(R,R.checked)}}return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.zs3),b.Y36(b.SBq))},P.\u0275dir=b.lG2({type:P,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(R,ne){1&R&&b.NdJ("ionChange",function(Cn){return ne._handleIonChange(Cn.target)})},features:[b._Bn([{provide:dt.JU,useExisting:P,multi:!0}]),b.qOj]}),P})(),Bn=(()=>{class P extends Gt{constructor(R,ne){super(R,ne)}_handleChangeEvent(R){this.handleValueChange(R,R.value)}}return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.zs3),b.Y36(b.SBq))},P.\u0275dir=b.lG2({type:P,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(R,ne){1&R&&b.NdJ("ionChange",function(Cn){return ne._handleChangeEvent(Cn.target)})},features:[b._Bn([{provide:dt.JU,useExisting:P,multi:!0}]),b.qOj]}),P})(),mr=(()=>{class P extends Gt{constructor(R,ne){super(R,ne)}_handleInputEvent(R){this.handleValueChange(R,R.value)}}return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.zs3),b.Y36(b.SBq))},P.\u0275dir=b.lG2({type:P,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(R,ne){1&R&&b.NdJ("ionInput",function(Cn){return ne._handleInputEvent(Cn.target)})},features:[b._Bn([{provide:dt.JU,useExisting:P,multi:!0}]),b.qOj]}),P})();const nr=(P,J)=>{const R=P.prototype;J.forEach(ne=>{Object.defineProperty(R,ne,{get(){return this.el[ne]},set(ke){this.z.runOutsideAngular(()=>this.el[ne]=ke)}})})},_r=(P,J)=>{const R=P.prototype;J.forEach(ne=>{R[ne]=function(){const ke=arguments;return this.z.runOutsideAngular(()=>this.el[ne].apply(this.el,ke))}})},Kn=(P,J,R)=>{R.forEach(ne=>P[ne]=(0,ve.R)(J,ne))};function bn(P){return function(R){const{defineCustomElementFn:ne,inputs:ke,methods:Cn}=P;return void 0!==ne&&ne(),ke&&nr(R,ke),Cn&&_r(R,Cn),R}}let Er=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-app"]],ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({})],P),P})(),gr=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],P),P})(),vi=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement,Kn(this,this.el,["ionFocus","ionBlur"])}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],P),P})(),Yr=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["collapse"]})],P),P})(),Do=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],P),P})(),Or=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["mode"]})],P),P})(),Co=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","mode","translucent"]})],P),P})(),Qe=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-card-subtitle"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","mode"]})],P),P})(),he=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-card-title"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","mode"]})],P),P})(),ut=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],P),P})(),wt=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement,Kn(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],P),P})(),Be=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["collapse","mode","translucent"]})],P),P})(),de=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["collapse","mode","translucent"]})],P),P})(),Ne=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],P),P})(),vn=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement,Kn(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",shape:"shape",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","shape","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],P),P})(),Xn=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],P),P})(),ro=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","mode","position"]})],P),P})(),Dn=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement,Kn(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],P),P})(),ur=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["autoHide","color","disabled","menu","mode","type"]})],P),P})(),Po=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement,Kn(this,this.el,["ionChange"])}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],P),P})(),No=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["disabled","layout","mode","type","value"]})],P),P})(),pn=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","size"]})],P),P})(),cr=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement,Kn(this,this.el,["ionChange","ionFocus","ionBlur"])}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",justify:"justify",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",name:"name",value:"value"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["checked","color","disabled","enableOnOffLabels","justify","labelPlacement","legacy","mode","name","value"]})],P),P})(),Tr=(()=>{let P=class{constructor(R,ne,ke){this.z=ke,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},P.\u0275cmp=b.Xpm({type:P,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:en,decls:1,vars:0,template:function(R,ne){1&R&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([bn({inputs:["color","mode"]})],P),P})(),kr=(()=>{class P{get(R,ne){const ke=oo();return ke?ke.get(R,ne):null}getBoolean(R,ne){const ke=oo();return!!ke&&ke.getBoolean(R,ne)}getNumber(R,ne){const ke=oo();return ke?ke.getNumber(R,ne):0}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const Ei=new b.OlP("USERCONFIG"),oo=()=>{if(typeof window<"u"){const P=window.Ionic;if(P?.config)return P.config}return null};let Wi=(()=>{class P{constructor(R,ne){this.doc=R,this.backButton=new Ue.x,this.keyboardDidShow=new Ue.x,this.keyboardDidHide=new Ue.x,this.pause=new Ue.x,this.resume=new Ue.x,this.resize=new Ue.x,ne.run(()=>{let ke;this.win=R.defaultView,this.backButton.subscribeWithPriority=function(Cn,lr){return this.subscribe(ir=>ir.register(Cn,ki=>ne.run(()=>lr(ki))))},Ri(this.pause,R,"pause"),Ri(this.resume,R,"resume"),Ri(this.backButton,R,"ionBackButton"),Ri(this.resize,this.win,"resize"),Ri(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),Ri(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Cn=>{ke=Cn}),this.win?.cordova?R.addEventListener("deviceready",()=>{ke("cordova")},{once:!0}):ke("dom")})}is(R){return(0,pt.a)(this.win,R)}platforms(){return(0,pt.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(R){return Ji(this.win.location.href,R)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia?.("(orientation: portrait)").matches}testUserAgent(R){const ne=this.win.navigator;return!!(ne?.userAgent&&ne.userAgent.indexOf(R)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return P.\u0275fac=function(R){return new(R||P)(b.LFG(Ut.K0),b.LFG(b.R0b))},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const Ji=(P,J)=>{J=J.replace(/[[\]\\]/g,"\\$&");const ne=new RegExp("[\\?&]"+J+"=([^&#]*)").exec(P);return ne?decodeURIComponent(ne[1].replace(/\+/g," ")):null},Ri=(P,J,R)=>{J&&J.addEventListener(R,ne=>{const ke=ne?.detail;P.next(ke)})};let To=(()=>{class P{constructor(R,ne,ke,Cn){this.location=ne,this.serializer=ke,this.router=Cn,this.direction=Zr,this.animated=Qi,this.guessDirection="forward",this.lastNavId=-1,Cn&&Cn.events.subscribe(lr=>{if(lr instanceof xe.OD){const ir=lr.restoredState?lr.restoredState.navigationId:lr.id;this.guessDirection=ir<this.lastNavId?"back":"forward",this.guessAnimation=lr.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?lr.id:ir}}),R.backButton.subscribeWithPriority(0,lr=>{this.pop(),lr()})}navigateForward(R,ne={}){return this.setDirection("forward",ne.animated,ne.animationDirection,ne.animation),this.navigate(R,ne)}navigateBack(R,ne={}){return this.setDirection("back",ne.animated,ne.animationDirection,ne.animation),this.navigate(R,ne)}navigateRoot(R,ne={}){return this.setDirection("root",ne.animated,ne.animationDirection,ne.animation),this.navigate(R,ne)}back(R={animated:!0,animationDirection:"back"}){return this.setDirection("back",R.animated,R.animationDirection,R.animation),this.location.back()}pop(){var R=this;return(0,I.Z)(function*(){let ne=R.topOutlet;for(;ne;){if(yield ne.pop())return!0;ne=ne.parentOutlet}return!1})()}setDirection(R,ne,ke,Cn){this.direction=R,this.animated=jr(R,ne,ke),this.animationBuilder=Cn}setTopOutlet(R){this.topOutlet=R}consumeTransition(){let ne,R="root";const ke=this.animationBuilder;return"auto"===this.direction?(R=this.guessDirection,ne=this.guessAnimation):(ne=this.animated,R=this.direction),this.direction=Zr,this.animated=Qi,this.animationBuilder=void 0,{direction:R,animation:ne,animationBuilder:ke}}navigate(R,ne){if(Array.isArray(R))return this.router.navigate(R,ne);{const ke=this.serializer.parse(R.toString());return void 0!==ne.queryParams&&(ke.queryParams={...ne.queryParams}),void 0!==ne.fragment&&(ke.fragment=ne.fragment),this.router.navigateByUrl(ke,ne)}}}return P.\u0275fac=function(R){return new(R||P)(b.LFG(Wi),b.LFG(Ut.Ye),b.LFG(xe.Hx),b.LFG(xe.F0,8))},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const jr=(P,J,R)=>{if(!1!==J){if(void 0!==R)return R;if("forward"===P||"back"===P)return P;if("root"===P&&!0===J)return"forward"}},Zr="auto",Qi=void 0;class ps{constructor(J={}){this.data=J}get(J){return this.data[J]}}let Pi=(()=>{class P{constructor(){this.zone=(0,b.f3M)(b.R0b),this.applicationRef=(0,b.f3M)(b.z2F)}create(R,ne,ke){return new So(R,ne,this.applicationRef,this.zone,ke)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac}),P})();class So{constructor(J,R,ne,ke,Cn){this.environmentInjector=J,this.injector=R,this.applicationRef=ne,this.zone=ke,this.elementReferenceKey=Cn,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(J,R,ne,ke){return this.zone.run(()=>new Promise(Cn=>{const lr={...ne};void 0!==this.elementReferenceKey&&(lr[this.elementReferenceKey]=J),Cn(Ks(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,J,R,lr,ke,this.elementReferenceKey))}))}removeViewFromDom(J,R){return this.zone.run(()=>new Promise(ne=>{const ke=this.elRefMap.get(R);if(ke){ke.destroy(),this.elRefMap.delete(R);const Cn=this.elEventsMap.get(R);Cn&&(Cn(),this.elEventsMap.delete(R))}ne()}))}}const Ks=(P,J,R,ne,ke,Cn,lr,ir,ki,ao,te)=>{const X=b.zs3.create({providers:Oi(ki),parent:R}),Ae=(0,b.LMc)(ir,{environmentInjector:J,elementInjector:X}),re=Ae.instance,Ye=Ae.location.nativeElement;if(ki&&(te&&void 0!==re[te]&&console.error(`[Ionic Error]: ${te} is a reserved property when using ${lr.tagName.toLowerCase()}. Rename or remove the "${te}" property from ${ir.name}.`),Object.assign(re,ki)),ao)for(const $r of ao)Ye.classList.add($r);const $n=Ni(P,re,Ye);return lr.appendChild(Ye),ne.attachView(Ae.hostView),ke.set(Ye,Ae),Cn.set(Ye,$n),Ye},as=[nt.L,nt.a,nt.b,nt.c,nt.d],Ni=(P,J,R)=>P.run(()=>{const ne=as.filter(ke=>"function"==typeof J[ke]).map(ke=>{const Cn=lr=>J[ke](lr.detail);return R.addEventListener(ke,Cn),()=>R.removeEventListener(ke,Cn)});return()=>ne.forEach(ke=>ke())}),Os=new b.OlP("NavParamsToken"),Oi=P=>[{provide:Os,useValue:P},{provide:ps,useFactory:rr,deps:[Os]}],rr=P=>new ps(P),Si=(P,J)=>((P=P.filter(R=>R.stackId!==J.stackId)).push(J),P),Ii=(P,J)=>{const R=P.createUrlTree(["."],{relativeTo:J});return P.serializeUrl(R)},eo=(P,J)=>{if(!P)return;const R=$o(J);for(let ne=0;ne<R.length;ne++){if(ne>=P.length)return R[ne];if(R[ne]!==P[ne])return}},$o=P=>P.split("/").map(J=>J.trim()).filter(J=>""!==J),Vo=P=>{P&&(P.ref.destroy(),P.unlistenEvents())};class Mr{constructor(J,R,ne,ke,Cn,lr){this.containerEl=R,this.router=ne,this.navCtrl=ke,this.zone=Cn,this.location=lr,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==J?$o(J):void 0}createView(J,R){const ne=Ii(this.router,R),ke=J?.location?.nativeElement,Cn=Ni(this.zone,J.instance,ke);return{id:this.nextId++,stackId:eo(this.tabsPrefix,ne),unlistenEvents:Cn,element:ke,ref:J,url:ne}}getExistingView(J){const R=Ii(this.router,J),ne=this.views.find(ke=>ke.url===R);return ne&&ne.ref.changeDetectorRef.reattach(),ne}setActive(J){const R=this.navCtrl.consumeTransition();let{direction:ne,animation:ke,animationBuilder:Cn}=R;const lr=this.activeView,ir=((P,J)=>!J||P.stackId!==J.stackId)(J,lr);ir&&(ne="back",ke=void 0);const ki=this.views.slice();let ao;const te=this.router;te.getCurrentNavigation?ao=te.getCurrentNavigation():te.navigations?.value&&(ao=te.navigations.value),ao?.extras?.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const X=this.views.includes(J),Ae=this.insertView(J,ne);X||J.ref.changeDetectorRef.detectChanges();const re=J.animationBuilder;return void 0===Cn&&"back"===ne&&!ir&&void 0!==re&&(Cn=re),lr&&(lr.animationBuilder=Cn),this.zone.runOutsideAngular(()=>this.wait(()=>(lr&&lr.ref.changeDetectorRef.detach(),J.ref.changeDetectorRef.reattach(),this.transition(J,lr,ke,this.canGoBack(1),!1,Cn).then(()=>ks(J,Ae,ki,this.location,this.zone)).then(()=>({enteringView:J,direction:ne,animation:ke,tabSwitch:ir})))))}canGoBack(J,R=this.getActiveStackId()){return this.getStack(R).length>J}pop(J,R=this.getActiveStackId()){return this.zone.run(()=>{const ne=this.getStack(R);if(ne.length<=J)return Promise.resolve(!1);const ke=ne[ne.length-J-1];let Cn=ke.url;const lr=ke.savedData;if(lr){const ki=lr.get("primary");ki?.route?._routerState?.snapshot.url&&(Cn=ki.route._routerState.snapshot.url)}const{animationBuilder:ir}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Cn,{...ke.savedExtras,animation:ir}).then(()=>!0)})}startBackTransition(){const J=this.activeView;if(J){const R=this.getStack(J.stackId),ne=R[R.length-2],ke=ne.animationBuilder;return this.wait(()=>this.transition(ne,J,"back",this.canGoBack(2),!0,ke))}return Promise.resolve()}endBackTransition(J){J?(this.skipTransition=!0,this.pop(1)):this.activeView&&ls(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(J){const R=this.getStack(J);return R.length>0?R[R.length-1]:void 0}getRootUrl(J){const R=this.getStack(J);return R.length>0?R[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(Vo),this.activeView=void 0,this.views=[]}getStack(J){return this.views.filter(R=>R.stackId===J)}insertView(J,R){return this.activeView=J,this.views=((P,J,R)=>"root"===R?Si(P,J):"forward"===R?((P,J)=>(P.indexOf(J)>=0?P=P.filter(ne=>ne.stackId!==J.stackId||ne.id<=J.id):P.push(J),P))(P,J):((P,J)=>P.indexOf(J)>=0?P.filter(ne=>ne.stackId!==J.stackId||ne.id<=J.id):Si(P,J))(P,J))(this.views,J,R),this.views.slice()}transition(J,R,ne,ke,Cn,lr){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(R===J)return Promise.resolve(!1);const ir=J?J.element:void 0,ki=R?R.element:void 0,ao=this.containerEl;return ir&&ir!==ki&&(ir.classList.add("ion-page"),ir.classList.add("ion-page-invisible"),ir.parentElement!==ao&&ao.appendChild(ir),ao.commit)?ao.commit(ir,ki,{duration:void 0===ne?0:void 0,direction:ne,showGoBack:ke,progressAnimation:Cn,animationBuilder:lr}):Promise.resolve(!1)}wait(J){var R=this;return(0,I.Z)(function*(){void 0!==R.runningTask&&(yield R.runningTask,R.runningTask=void 0);const ne=R.runningTask=J();return ne.finally(()=>R.runningTask=void 0),ne})()}}const ks=(P,J,R,ne,ke)=>"function"==typeof requestAnimationFrame?new Promise(Cn=>{requestAnimationFrame(()=>{ls(P,J,R,ne,ke),Cn()})}):Promise.resolve(),ls=(P,J,R,ne,ke)=>{ke.run(()=>R.filter(Cn=>!J.includes(Cn)).forEach(Vo)),J.forEach(Cn=>{const ir=ne.path().split("?")[0].split("#")[0];if(Cn!==P&&Cn.url!==ir){const ki=Cn.element;ki.setAttribute("aria-hidden","true"),ki.classList.add("ion-page-hidden"),Cn.ref.changeDetectorRef.detach()}})};let _o=(()=>{class P{constructor(R,ne,ke,Cn,lr,ir,ki,ao){this.parentOutlet=ao,this.activatedView=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new Le.X(null),this.activated=null,this._activatedRoute=null,this.name=xe.eC,this.stackEvents=new b.vpe,this.activateEvents=new b.vpe,this.deactivateEvents=new b.vpe,this.parentContexts=(0,b.f3M)(xe.y6),this.location=(0,b.f3M)(b.s_b),this.environmentInjector=(0,b.f3M)(b.lqb),this.inputBinder=(0,b.f3M)(es,{optional:!0}),this.supportsBindingToComponentInputs=!0,this.config=(0,b.f3M)(kr),this.navCtrl=(0,b.f3M)(To),this.nativeEl=Cn.nativeElement,this.name=R||xe.eC,this.tabsPrefix="true"===ne?Ii(lr,ki):void 0,this.stackCtrl=new Mr(this.tabsPrefix,this.nativeEl,lr,this.navCtrl,ir,ke),this.parentContexts.onChildOutletCreated(this.name,this)}get activatedComponentRef(){return this.activated}set animation(R){this.nativeEl.animation=R}set animated(R){this.nativeEl.animated=R}set swipeGesture(R){this._swipeGesture=R,this.nativeEl.swipeHandler=R?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ne=>this.stackCtrl.endBackTransition(ne)}:void 0}ngOnDestroy(){this.stackCtrl.destroy(),this.inputBinder?.unsubscribeFromRouteData(this)}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const R=this.getContext();R?.route&&this.activateWith(R.route,R.injector)}new Promise(R=>(0,vt.c)(this.nativeEl,R)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(R,ne){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ne=this.getContext();this.activatedView.savedData=new Map(ne.children.contexts);const ke=this.activatedView.savedData.get("primary");if(ke&&ne.route&&(ke.route={...ne.route}),this.activatedView.savedExtras={},ne.route){const Cn=ne.route.snapshot;this.activatedView.savedExtras.queryParams=Cn.queryParams,this.activatedView.savedExtras.fragment=Cn.fragment}}const R=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(R)}}activateWith(R,ne){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=R;let ke,Cn=this.stackCtrl.getExistingView(R);if(Cn){ke=this.activated=Cn.ref;const lr=Cn.savedData;lr&&(this.getContext().children.contexts=lr),this.updateActivatedRouteProxy(ke.instance,R)}else{const lr=R._futureSnapshot,ir=this.parentContexts.getOrCreateContext(this.name).children,ki=new Le.X(null),ao=this.createActivatedRouteProxy(ki,R),te=new Ui(ao,ir,this.location.injector);ke=this.activated=this.location.createComponent(lr.routeConfig.component??lr.component,{index:this.location.length,injector:te,environmentInjector:ne??this.environmentInjector}),ki.next(ke.instance),Cn=this.stackCtrl.createView(this.activated,R),this.proxyMap.set(ke.instance,ao),this.currentActivatedRoute$.next({component:ke.instance,activatedRoute:R})}this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activatedView=Cn,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(Cn).then(lr=>{this.activateEvents.emit(ke.instance),this.stackEvents.emit(lr)})}canGoBack(R=1,ne){return this.stackCtrl.canGoBack(R,ne)}pop(R=1,ne){return this.stackCtrl.pop(R,ne)}getLastUrl(R){const ne=this.stackCtrl.getLastUrl(R);return ne?ne.url:void 0}getLastRouteView(R){return this.stackCtrl.getLastUrl(R)}getRootView(R){return this.stackCtrl.getRootUrl(R)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(R,ne){const ke=new xe.gz;return ke._futureSnapshot=ne._futureSnapshot,ke._routerState=ne._routerState,ke.snapshot=ne.snapshot,ke.outlet=ne.outlet,ke.component=ne.component,ke._paramMap=this.proxyObservable(R,"paramMap"),ke._queryParamMap=this.proxyObservable(R,"queryParamMap"),ke.url=this.proxyObservable(R,"url"),ke.params=this.proxyObservable(R,"params"),ke.queryParams=this.proxyObservable(R,"queryParams"),ke.fragment=this.proxyObservable(R,"fragment"),ke.data=this.proxyObservable(R,"data"),ke}proxyObservable(R,ne){return R.pipe((0,Je.h)(ke=>!!ke),(0,mt.w)(ke=>this.currentActivatedRoute$.pipe((0,Je.h)(Cn=>null!==Cn&&Cn.component===ke),(0,mt.w)(Cn=>Cn&&Cn.activatedRoute[ne]),(0,Kt.x)())))}updateActivatedRouteProxy(R,ne){const ke=this.proxyMap.get(R);if(!ke)throw new Error("Could not find activated route proxy for view");ke._futureSnapshot=ne._futureSnapshot,ke._routerState=ne._routerState,ke.snapshot=ne.snapshot,ke.outlet=ne.outlet,ke.component=ne.component,this.currentActivatedRoute$.next({component:R,activatedRoute:ne})}}return P.\u0275fac=function(R){return new(R||P)(b.$8M("name"),b.$8M("tabs"),b.Y36(Ut.Ye),b.Y36(b.SBq),b.Y36(xe.F0),b.Y36(b.R0b),b.Y36(xe.gz),b.Y36(P,12))},P.\u0275dir=b.lG2({type:P,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",name:"name"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),P})();class Ui{constructor(J,R,ne){this.route=J,this.childContexts=R,this.parent=ne}get(J,R){return J===xe.gz?this.route:J===xe.y6?this.childContexts:this.parent.get(J,R)}}const es=new b.OlP("");let Ro=(()=>{class P{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(R){this.unsubscribeFromRouteData(R),this.subscribeToRouteData(R)}unsubscribeFromRouteData(R){this.outletDataSubscriptions.get(R)?.unsubscribe(),this.outletDataSubscriptions.delete(R)}subscribeToRouteData(R){const{activatedRoute:ne}=R,ke=(0,it.a)([ne.queryParams,ne.params,ne.data]).pipe((0,mt.w)(([Cn,lr,ir],ki)=>(ir={...Cn,...lr,...ir},0===ki?(0,et.of)(ir):Promise.resolve(ir)))).subscribe(Cn=>{if(!R.isActivated||!R.activatedComponentRef||R.activatedRoute!==ne||null===ne.component)return void this.unsubscribeFromRouteData(R);const lr=(0,b.qFp)(ne.component);if(lr)for(const{templateName:ir}of lr.inputs)R.activatedComponentRef.setInput(ir,Cn[ir]);else this.unsubscribeFromRouteData(R)});this.outletDataSubscriptions.set(R,ke)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac}),P})(),jo=(()=>{class P{constructor(R,ne,ke){this.routerOutlet=R,this.navCtrl=ne,this.config=ke}onClick(R){const ne=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet?.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),R.preventDefault()):null!=ne&&(this.navCtrl.navigateBack(ne,{animation:this.routerAnimation}),R.preventDefault())}}return P.\u0275fac=function(R){return new(R||P)(b.Y36(_o,8),b.Y36(To),b.Y36(kr))},P.\u0275dir=b.lG2({type:P,selectors:[["ion-back-button"]],hostBindings:function(R,ne){1&R&&b.NdJ("click",function(Cn){return ne.onClick(Cn)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),P})(),ms=(()=>{class P{constructor(R,ne,ke,Cn,lr){this.locationStrategy=R,this.navCtrl=ne,this.elementRef=ke,this.router=Cn,this.routerLink=lr,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const R=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=R}}onClick(R){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),R.preventDefault()}}return P.\u0275fac=function(R){return new(R||P)(b.Y36(Ut.S$),b.Y36(To),b.Y36(b.SBq),b.Y36(xe.F0),b.Y36(xe.rH,8))},P.\u0275dir=b.lG2({type:P,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(R,ne){1&R&&b.NdJ("click",function(Cn){return ne.onClick(Cn)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[b.TTD]}),P})();class er{constructor(J){this.ctrl=J}create(J){return this.ctrl.create(J||{})}dismiss(J,R,ne){return this.ctrl.dismiss(J,R,ne)}getTop(){return this.ctrl.getTop()}}let va=(()=>{class P extends er{constructor(){super(Ft.l)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),uo=(()=>{class P extends er{constructor(){super(Ft.m),this.angularDelegate=(0,b.f3M)(Pi),this.injector=(0,b.f3M)(b.zs3),this.environmentInjector=(0,b.f3M)(b.lqb)}create(R){return super.create({...R,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac}),P})(),Mo=(()=>{class P extends er{constructor(){super(Ft.c),this.angularDelegate=(0,b.f3M)(Pi),this.injector=(0,b.f3M)(b.zs3),this.environmentInjector=(0,b.f3M)(b.lqb)}create(R){return super.create({...R,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac}),P})(),so=(()=>{class P extends er{constructor(){super(Ft.t)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=b.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();class gs{shouldDetach(J){return!1}shouldAttach(J){return!1}store(J,R){}retrieve(J){return null}shouldReuseRoute(J,R){if(J.routeConfig!==R.routeConfig)return!1;const ne=J.params,ke=R.params,Cn=Object.keys(ne),lr=Object.keys(ke);if(Cn.length!==lr.length)return!1;for(const ir of Cn)if(ke[ir]!==ne[ir])return!1;return!0}}const us=(P,J,R)=>()=>{if(J.defaultView&&typeof window<"u"){(0,_t.s)({...P,_zoneGate:Cn=>R.run(Cn)});const ke="__zone_symbol__addEventListener"in J.body?"__zone_symbol__addEventListener":"addEventListener";return function dn(){var P=[];if(typeof window<"u"){var J=window;(!J.customElements||J.Element&&(!J.Element.prototype.closest||!J.Element.prototype.matches||!J.Element.prototype.remove||!J.Element.prototype.getRootNode))&&P.push(K.e(6748).then(K.t.bind(K,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||J.NodeList&&!J.NodeList.prototype.forEach||!J.fetch||!function(){try{var ne=new URL("b","http://a");return ne.pathname="c%20d","http://a/c%20d"===ne.href&&ne.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&P.push(K.e(2214).then(K.t.bind(K,2668,23)))}return Promise.all(P)}().then(()=>((P,J)=>typeof window>"u"?Promise.resolve():(0,ht.p)().then(()=>(on(),(0,ht.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"activated":[32]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"legacy":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),J))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Lt,jmp:Cn=>R.runOutsideAngular(Cn),ael(Cn,lr,ir,ki){Cn[ke](lr,ir,ki)},rel(Cn,lr,ir,ki){Cn.removeEventListener(lr,ir,ki)}}))}};let ba=(()=>{class P{static forRoot(R){return{ngModule:P,providers:[{provide:Ei,useValue:R},{provide:b.ip1,useFactory:us,multi:!0,deps:[Ei,Ut.K0,b.R0b]},{provide:es,useFactory:Js,deps:[xe.F0]}]}}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275mod=b.oAB({type:P}),P.\u0275inj=b.cJS({providers:[Pi,uo,Mo],imports:[Ut.ez]}),P})();function Js(P){return P?.componentInputBindingEnabled?new Ro:null}},3182:(Gn,At,K)=>{"use strict";K.d(At,{C6:()=>I.getApps,Mq:()=>I.getApp});var I=K(534);(0,I.registerVersion)("firebase","10.6.0","app")},7142:(Gn,At,K)=>{"use strict";K.d(At,{Z:()=>I.Z});var I=K(3106);I.Z.registerVersion("firebase","10.6.0","app-compat")},5861:(Gn,At,K)=>{"use strict";function I(dt,l,ve,Ue,Le,it,et){try{var xe=dt[it](et),Re=xe.value}catch(Ze){return void ve(Ze)}xe.done?l(Re):Promise.resolve(Re).then(Ue,Le)}function b(dt){return function(){var l=this,ve=arguments;return new Promise(function(Ue,Le){var it=dt.apply(l,ve);function et(Re){I(it,Ue,Le,et,xe,"next",Re)}function xe(Re){I(it,Ue,Le,et,xe,"throw",Re)}et(void 0)})}}K.d(At,{Z:()=>b})},1180:(Gn,At,K)=>{"use strict";function I(ve){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Ue){return typeof Ue}:function(Ue){return Ue&&"function"==typeof Symbol&&Ue.constructor===Symbol&&Ue!==Symbol.prototype?"symbol":typeof Ue})(ve)}function l(ve,Ue,Le){return(Ue=function dt(ve){var Ue=function b(ve,Ue){if("object"!==I(ve)||null===ve)return ve;var Le=ve[Symbol.toPrimitive];if(void 0!==Le){var it=Le.call(ve,Ue||"default");if("object"!==I(it))return it;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===Ue?String:Number)(ve)}(ve,"string");return"symbol"===I(Ue)?Ue:String(Ue)}(Ue))in ve?Object.defineProperty(ve,Ue,{value:Le,enumerable:!0,configurable:!0,writable:!0}):ve[Ue]=Le,ve}K.d(At,{Z:()=>l})},7582:(Gn,At,K)=>{"use strict";K.d(At,{FC:()=>Me,KL:()=>It,ZT:()=>b,_T:()=>l,gn:()=>ve,mG:()=>Ze,qq:()=>Se});var I=function(ue,me){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ze,ct){ze.__proto__=ct}||function(ze,ct){for(var Lt in ct)Object.prototype.hasOwnProperty.call(ct,Lt)&&(ze[Lt]=ct[Lt])})(ue,me)};function b(ue,me){if("function"!=typeof me&&null!==me)throw new TypeError("Class extends value "+String(me)+" is not a constructor or null");function ze(){this.constructor=ue}I(ue,me),ue.prototype=null===me?Object.create(me):(ze.prototype=me.prototype,new ze)}function l(ue,me){var ze={};for(var ct in ue)Object.prototype.hasOwnProperty.call(ue,ct)&&me.indexOf(ct)<0&&(ze[ct]=ue[ct]);if(null!=ue&&"function"==typeof Object.getOwnPropertySymbols){var Lt=0;for(ct=Object.getOwnPropertySymbols(ue);Lt<ct.length;Lt++)me.indexOf(ct[Lt])<0&&Object.prototype.propertyIsEnumerable.call(ue,ct[Lt])&&(ze[ct[Lt]]=ue[ct[Lt]])}return ze}function ve(ue,me,ze,ct){var Yt,Lt=arguments.length,Gt=Lt<3?me:null===ct?ct=Object.getOwnPropertyDescriptor(me,ze):ct;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Gt=Reflect.decorate(ue,me,ze,ct);else for(var hn=ue.length-1;hn>=0;hn--)(Yt=ue[hn])&&(Gt=(Lt<3?Yt(Gt):Lt>3?Yt(me,ze,Gt):Yt(me,ze))||Gt);return Lt>3&&Gt&&Object.defineProperty(me,ze,Gt),Gt}function Ze(ue,me,ze,ct){return new(ze||(ze=Promise))(function(Gt,Yt){function hn(Xt){try{jt(ct.next(Xt))}catch(an){Yt(an)}}function sn(Xt){try{jt(ct.throw(Xt))}catch(an){Yt(an)}}function jt(Xt){Xt.done?Gt(Xt.value):function Lt(Gt){return Gt instanceof ze?Gt:new ze(function(Yt){Yt(Gt)})}(Xt.value).then(hn,sn)}jt((ct=ct.apply(ue,me||[])).next())})}function Se(ue){return this instanceof Se?(this.v=ue,this):new Se(ue)}function Me(ue,me,ze){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Lt,ct=ze.apply(ue,me||[]),Gt=[];return Lt={},Yt("next"),Yt("throw"),Yt("return"),Lt[Symbol.asyncIterator]=function(){return this},Lt;function Yt(mn){ct[mn]&&(Lt[mn]=function(Bn){return new Promise(function(mr,nr){Gt.push([mn,Bn,mr,nr])>1||hn(mn,Bn)})})}function hn(mn,Bn){try{!function sn(mn){mn.value instanceof Se?Promise.resolve(mn.value.v).then(jt,Xt):an(Gt[0][2],mn)}(ct[mn](Bn))}catch(mr){an(Gt[0][3],mr)}}function jt(mn){hn("next",mn)}function Xt(mn){hn("throw",mn)}function an(mn,Bn){mn(Bn),Gt.shift(),Gt.length&&hn(Gt[0][0],Gt[0][1])}}function It(ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ze,me=ue[Symbol.asyncIterator];return me?me.call(ue):(ue=function vt(ue){var me="function"==typeof Symbol&&Symbol.iterator,ze=me&&ue[me],ct=0;if(ze)return ze.call(ue);if(ue&&"number"==typeof ue.length)return{next:function(){return ue&&ct>=ue.length&&(ue=void 0),{value:ue&&ue[ct++],done:!ue}}};throw new TypeError(me?"Object is not iterable.":"Symbol.iterator is not defined.")}(ue),ze={},ct("next"),ct("throw"),ct("return"),ze[Symbol.asyncIterator]=function(){return this},ze);function ct(Gt){ze[Gt]=ue[Gt]&&function(Yt){return new Promise(function(hn,sn){!function Lt(Gt,Yt,hn,sn){Promise.resolve(sn).then(function(jt){Gt({value:jt,done:hn})},Yt)}(hn,sn,(Yt=ue[Gt](Yt)).done,Yt.value)})}}}"function"==typeof SuppressedError&&SuppressedError}},Gn=>{Gn(Gn.s=335)}]);