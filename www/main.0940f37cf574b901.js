(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{6506:(fr,en,oe)=>{"use strict";oe.d(en,{c:()=>Kt});var T=oe(7643),b=oe(544);let Lt;const Ee=It=>It.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ot=It=>(void 0===Lt&&(Lt=void 0===It.style.animationName&&void 0!==It.style.webkitAnimationName?"-webkit-":""),Lt),qe=(It,st,sn)=>{const Tt=st.startsWith("animation")?ot(It):"";It.style.setProperty(Tt+st,sn)},Et=(It,st)=>{const sn=st.startsWith("animation")?ot(It):"";It.style.removeProperty(sn+st)},nt=[],xt=(It=[],st)=>{if(void 0!==st){const sn=Array.isArray(st)?st:[st];return[...It,...sn]}return It},Kt=It=>{let st,sn,Tt,Ge,Le,Yt,yt,Me,Ue,at,Rt,ur,Mn,_n=[],De=[],ft=[],Nt=!1,mn={},hn=[],Gt=[],nr={},Wt=0,pr=!1,an=!1,cn=!0,un=!1,Qn=!0,Ot=!1;const qt=It,$t=[],vn=[],Gn=[],Cr=[],Wn=[],Dr=[],er=[],kr=[],An=[],vi=[],to="function"==typeof AnimationEffect||void 0!==T.w&&"function"==typeof T.w.AnimationEffect,Ai="function"==typeof Element&&"function"==typeof Element.prototype.animate&&to,Ir=()=>vi,Lr=(pe,Se)=>((Se?.oneTimeCallback?vn:$t).push({c:pe,o:Se}),Mn),Gi=()=>{if(Ai)vi.forEach(pe=>{pe.cancel()}),vi.length=0;else{const pe=Gn.slice();(0,b.r)(()=>{pe.forEach(Se=>{Et(Se,"animation-name"),Et(Se,"animation-duration"),Et(Se,"animation-timing-function"),Et(Se,"animation-iteration-count"),Et(Se,"animation-delay"),Et(Se,"animation-play-state"),Et(Se,"animation-fill-mode"),Et(Se,"animation-direction")})})}},ai=()=>{Wn.forEach(pe=>{pe?.parentNode&&pe.parentNode.removeChild(pe)}),Wn.length=0},Vt=()=>void 0!==Le?Le:yt?yt.getFill():"both",En=()=>void 0!==Ue?Ue:void 0!==Yt?Yt:yt?yt.getDirection():"normal",Ln=()=>pr?"linear":void 0!==Tt?Tt:yt?yt.getEasing():"linear",Je=()=>an?0:void 0!==at?at:void 0!==sn?sn:yt?yt.getDuration():0,Ze=()=>void 0!==Ge?Ge:yt?yt.getIterations():1,Dt=()=>void 0!==Rt?Rt:void 0!==st?st:yt?yt.getDelay():0,zn=()=>{0!==Wt&&(Wt--,0===Wt&&((()=>{Fi(),kr.forEach(fn=>fn()),An.forEach(fn=>fn());const pe=cn?1:0,Se=hn,bt=Gt,Pt=nr;Gn.forEach(fn=>{const bn=fn.classList;Se.forEach(pn=>bn.add(pn)),bt.forEach(pn=>bn.remove(pn));for(const pn in Pt)Pt.hasOwnProperty(pn)&&qe(fn,pn,Pt[pn])}),$t.forEach(fn=>fn.c(pe,Mn)),vn.forEach(fn=>fn.c(pe,Mn)),vn.length=0,Qn=!0,cn&&(un=!0),cn=!0})(),yt&&yt.animationFinish()))},br=(pe=!0)=>{ai();const Se=(It=>(It.forEach(st=>{for(const sn in st)if(st.hasOwnProperty(sn)){const Tt=st[sn];if("easing"===sn)st["animation-timing-function"]=Tt,delete st[sn];else{const Ge=Ee(sn);Ge!==sn&&(st[Ge]=Tt,delete st[sn])}}}),It))(_n);Gn.forEach(bt=>{if(Se.length>0){const Pt=((It=[])=>It.map(st=>{const sn=st.offset,Tt=[];for(const Ge in st)st.hasOwnProperty(Ge)&&"offset"!==Ge&&Tt.push(`${Ge}: ${st[Ge]};`);return`${100*sn}% { ${Tt.join(" ")} }`}).join(" "))(Se);ur=void 0!==It?It:(It=>{let st=nt.indexOf(It);return st<0&&(st=nt.push(It)-1),`ion-animation-${st}`})(Pt);const fn=((It,st,sn)=>{var Tt;const Ge=(It=>{const st=void 0!==It.getRootNode?It.getRootNode():It;return st.head||st})(sn),Le=ot(sn),Yt=Ge.querySelector("#"+It);if(Yt)return Yt;const _n=(null!==(Tt=sn.ownerDocument)&&void 0!==Tt?Tt:document).createElement("style");return _n.id=It,_n.textContent=`@${Le}keyframes ${It} { ${st} } @${Le}keyframes ${It}-alt { ${st} }`,Ge.appendChild(_n),_n})(ur,Pt,bt);Wn.push(fn),qe(bt,"animation-duration",`${Je()}ms`),qe(bt,"animation-timing-function",Ln()),qe(bt,"animation-delay",`${Dt()}ms`),qe(bt,"animation-fill-mode",Vt()),qe(bt,"animation-direction",En());const bn=Ze()===1/0?"infinite":Ze().toString();qe(bt,"animation-iteration-count",bn),qe(bt,"animation-play-state","paused"),pe&&qe(bt,"animation-name",`${fn.id}-alt`),(0,b.r)(()=>{qe(bt,"animation-name",fn.id||null)})}})},hi=(pe=!0)=>{(()=>{Dr.forEach(Pt=>Pt()),er.forEach(Pt=>Pt());const pe=De,Se=ft,bt=mn;Gn.forEach(Pt=>{const fn=Pt.classList;pe.forEach(bn=>fn.add(bn)),Se.forEach(bn=>fn.remove(bn));for(const bn in bt)bt.hasOwnProperty(bn)&&qe(Pt,bn,bt[bn])})})(),_n.length>0&&(Ai?(Gn.forEach(pe=>{const Se=pe.animate(_n,{id:qt,delay:Dt(),duration:Je(),easing:Ln(),iterations:Ze(),fill:Vt(),direction:En()});Se.pause(),vi.push(Se)}),vi.length>0&&(vi[0].onfinish=()=>{zn()})):br(pe)),Nt=!0},Sr=pe=>{if(pe=Math.min(Math.max(pe,0),.9999),Ai)vi.forEach(Se=>{Se.currentTime=Se.effect.getComputedTiming().delay+Je()*pe,Se.pause()});else{const Se=`-${Je()*pe}ms`;Gn.forEach(bt=>{_n.length>0&&(qe(bt,"animation-delay",Se),qe(bt,"animation-play-state","paused"))})}},mi=pe=>{vi.forEach(Se=>{Se.effect.updateTiming({delay:Dt(),duration:Je(),easing:Ln(),iterations:Ze(),fill:Vt(),direction:En()})}),void 0!==pe&&Sr(pe)},Yr=(pe=!0,Se)=>{(0,b.r)(()=>{Gn.forEach(bt=>{qe(bt,"animation-name",ur||null),qe(bt,"animation-duration",`${Je()}ms`),qe(bt,"animation-timing-function",Ln()),qe(bt,"animation-delay",void 0!==Se?`-${Se*Je()}ms`:`${Dt()}ms`),qe(bt,"animation-fill-mode",Vt()||null),qe(bt,"animation-direction",En()||null);const Pt=Ze()===1/0?"infinite":Ze().toString();qe(bt,"animation-iteration-count",Pt),pe&&qe(bt,"animation-name",`${ur}-alt`),(0,b.r)(()=>{qe(bt,"animation-name",ur||null)})})})},li=(pe=!1,Se=!0,bt)=>(pe&&Cr.forEach(Pt=>{Pt.update(pe,Se,bt)}),Ai?mi(bt):Yr(Se,bt),Mn),zt=()=>{Nt&&(Ai?vi.forEach(pe=>{pe.pause()}):Gn.forEach(pe=>{qe(pe,"animation-play-state","paused")}),Ot=!0)},Ri=()=>{Me=void 0,zn()},Fi=()=>{Me&&clearTimeout(Me)},yo=pe=>new Promise(Se=>{pe?.sync&&(an=!0,Lr(()=>an=!1,{oneTimeCallback:!0})),Nt||hi(),un&&(Ai?(Sr(0),mi()):Yr(),un=!1),Qn&&(Wt=Cr.length+1,Qn=!1),Lr(()=>Se(),{oneTimeCallback:!0}),Cr.forEach(bt=>{bt.play()}),Ai?(vi.forEach(pe=>{pe.play()}),(0===_n.length||0===Gn.length)&&zn()):(()=>{if(Fi(),(0,b.r)(()=>{Gn.forEach(pe=>{_n.length>0&&qe(pe,"animation-play-state","running")})}),0===_n.length||0===Gn.length)zn();else{const pe=Dt()||0,Se=Je()||0,bt=Ze()||1;isFinite(bt)&&(Me=setTimeout(Ri,pe+Se*bt+100)),((It,st)=>{let sn;const Tt={passive:!0},Le=Yt=>{It===Yt.target&&(sn&&sn(),Fi(),(0,b.r)(()=>{Gn.forEach(pe=>{Et(pe,"animation-duration"),Et(pe,"animation-delay"),Et(pe,"animation-play-state")}),(0,b.r)(zn)}))};It&&(It.addEventListener("webkitAnimationEnd",Le,Tt),It.addEventListener("animationend",Le,Tt),sn=()=>{It.removeEventListener("webkitAnimationEnd",Le,Tt),It.removeEventListener("animationend",Le,Tt)})})(Gn[0])}})(),Ot=!1}),Br=(pe,Se)=>{const bt=_n[0];return void 0===bt||void 0!==bt.offset&&0!==bt.offset?_n=[{offset:0,[pe]:Se},..._n]:bt[pe]=Se,Mn};return Mn={parentAnimation:yt,elements:Gn,childAnimations:Cr,id:qt,animationFinish:zn,from:Br,to:(pe,Se)=>{const bt=_n[_n.length-1];return void 0===bt||void 0!==bt.offset&&1!==bt.offset?_n=[..._n,{offset:1,[pe]:Se}]:bt[pe]=Se,Mn},fromTo:(pe,Se,bt)=>Br(pe,Se).to(pe,bt),parent:pe=>(yt=pe,Mn),play:yo,pause:()=>(Cr.forEach(pe=>{pe.pause()}),zt(),Mn),stop:()=>{Cr.forEach(pe=>{pe.stop()}),Nt&&(Gi(),Nt=!1),pr=!1,an=!1,Qn=!0,Ue=void 0,at=void 0,Rt=void 0,Wt=0,un=!1,cn=!0,Ot=!1},destroy:pe=>(Cr.forEach(Se=>{Se.destroy(pe)}),(pe=>{Gi(),pe&&ai()})(pe),Gn.length=0,Cr.length=0,_n.length=0,$t.length=0,vn.length=0,Nt=!1,Qn=!0,Mn),keyframes:pe=>{const Se=_n!==pe;return _n=pe,Se&&(pe=>{Ai?Ir().forEach(Se=>{if(Se.effect.setKeyframes)Se.effect.setKeyframes(pe);else{const bt=new KeyframeEffect(Se.effect.target,pe,Se.effect.getTiming());Se.effect=bt}}):br()})(_n),Mn},addAnimation:pe=>{if(null!=pe)if(Array.isArray(pe))for(const Se of pe)Se.parent(Mn),Cr.push(Se);else pe.parent(Mn),Cr.push(pe);return Mn},addElement:pe=>{if(null!=pe)if(1===pe.nodeType)Gn.push(pe);else if(pe.length>=0)for(let Se=0;Se<pe.length;Se++)Gn.push(pe[Se]);else console.error("Invalid addElement value");return Mn},update:li,fill:pe=>(Le=pe,li(!0),Mn),direction:pe=>(Yt=pe,li(!0),Mn),iterations:pe=>(Ge=pe,li(!0),Mn),duration:pe=>(!Ai&&0===pe&&(pe=1),sn=pe,li(!0),Mn),easing:pe=>(Tt=pe,li(!0),Mn),delay:pe=>(st=pe,li(!0),Mn),getWebAnimations:Ir,getKeyframes:()=>_n,getFill:Vt,getDirection:En,getDelay:Dt,getIterations:Ze,getEasing:Ln,getDuration:Je,afterAddRead:pe=>(kr.push(pe),Mn),afterAddWrite:pe=>(An.push(pe),Mn),afterClearStyles:(pe=[])=>{for(const Se of pe)nr[Se]="";return Mn},afterStyles:(pe={})=>(nr=pe,Mn),afterRemoveClass:pe=>(Gt=xt(Gt,pe),Mn),afterAddClass:pe=>(hn=xt(hn,pe),Mn),beforeAddRead:pe=>(Dr.push(pe),Mn),beforeAddWrite:pe=>(er.push(pe),Mn),beforeClearStyles:(pe=[])=>{for(const Se of pe)mn[Se]="";return Mn},beforeStyles:(pe={})=>(mn=pe,Mn),beforeRemoveClass:pe=>(ft=xt(ft,pe),Mn),beforeAddClass:pe=>(De=xt(De,pe),Mn),onFinish:Lr,isRunning:()=>0!==Wt&&!Ot,progressStart:(pe=!1,Se)=>(Cr.forEach(bt=>{bt.progressStart(pe,Se)}),zt(),pr=pe,Nt||hi(),li(!1,!0,Se),Mn),progressStep:pe=>(Cr.forEach(Se=>{Se.progressStep(pe)}),Sr(pe),Mn),progressEnd:(pe,Se,bt)=>(pr=!1,Cr.forEach(Pt=>{Pt.progressEnd(pe,Se,bt)}),void 0!==bt&&(at=bt),un=!1,cn=!0,0===pe?(Ue="reverse"===En()?"normal":"reverse","reverse"===Ue&&(cn=!1),Ai?(li(),Sr(1-Se)):(Rt=(1-Se)*Je()*-1,li(!1,!1))):1===pe&&(Ai?(li(),Sr(Se)):(Rt=Se*Je()*-1,li(!1,!1))),void 0!==pe&&(Lr(()=>{at=void 0,Ue=void 0,Rt=void 0},{oneTimeCallback:!0}),yt||yo()),Mn)}}},1273:(fr,en,oe)=>{"use strict";oe.d(en,{E:()=>tt,a:()=>T,s:()=>Et});const T=nt=>{try{if(nt instanceof qe)return nt.value;if(!l()||"string"!=typeof nt||""===nt)return nt;if(nt.includes("onload="))return"";const wt=document.createDocumentFragment(),ht=document.createElement("div");wt.appendChild(ht),ht.innerHTML=nt,ot.forEach(It=>{const st=wt.querySelectorAll(It);for(let sn=st.length-1;sn>=0;sn--){const Tt=st[sn];Tt.parentNode?Tt.parentNode.removeChild(Tt):wt.removeChild(Tt);const Ge=Lt(Tt);for(let Le=0;Le<Ge.length;Le++)b(Ge[Le])}});const et=Lt(wt);for(let It=0;It<et.length;It++)b(et[It]);const xt=document.createElement("div");xt.appendChild(wt);const Kt=xt.querySelector("div");return null!==Kt?Kt.innerHTML:xt.innerHTML}catch(wt){return console.error(wt),""}},b=nt=>{if(nt.nodeType&&1!==nt.nodeType)return;if(typeof NamedNodeMap<"u"&&!(nt.attributes instanceof NamedNodeMap))return void nt.remove();for(let ht=nt.attributes.length-1;ht>=0;ht--){const et=nt.attributes.item(ht),xt=et.name;if(!Ee.includes(xt.toLowerCase())){nt.removeAttribute(xt);continue}const Kt=et.value,It=nt[xt];(null!=Kt&&Kt.toLowerCase().includes("javascript:")||null!=It&&It.toLowerCase().includes("javascript:"))&&nt.removeAttribute(xt)}const wt=Lt(nt);for(let ht=0;ht<wt.length;ht++)b(wt[ht])},Lt=nt=>null!=nt.children?nt.children:nt.childNodes,l=()=>{var nt;const wt=window,ht=null===(nt=wt?.Ionic)||void 0===nt?void 0:nt.config;return!ht||(ht.get?ht.get("sanitizerEnabled",!0):!0===ht.sanitizerEnabled||void 0===ht.sanitizerEnabled)},Ee=["class","id","href","src","name","slot"],ot=["script","style","iframe","meta","link","object","embed"];class qe{constructor(wt){this.value=wt}}const Et=nt=>{const wt=window,ht=wt.Ionic;if(!ht||!ht.config||"Object"===ht.config.constructor.name)return wt.Ionic=wt.Ionic||{},wt.Ionic.config=Object.assign(Object.assign({},wt.Ionic.config),nt),wt.Ionic.config},tt=!1},9439:(fr,en,oe)=>{"use strict";oe.d(en,{C:()=>Ee,a:()=>Lt,d:()=>l});var T=oe(5861),b=oe(544);const Lt=function(){var ot=(0,T.Z)(function*(qe,Et,vt,tt,nt,wt){var ht;if(qe)return qe.attachViewToDom(Et,vt,nt,tt);if(!(wt||"string"==typeof vt||vt instanceof HTMLElement))throw new Error("framework delegate is missing");const et="string"==typeof vt?null===(ht=Et.ownerDocument)||void 0===ht?void 0:ht.createElement(vt):vt;return tt&&tt.forEach(xt=>et.classList.add(xt)),nt&&Object.assign(et,nt),Et.appendChild(et),yield new Promise(xt=>(0,b.c)(et,xt)),et});return function(Et,vt,tt,nt,wt,ht){return ot.apply(this,arguments)}}(),l=(ot,qe)=>{if(qe){if(ot)return ot.removeViewFromDom(qe.parentElement,qe);qe.remove()}return Promise.resolve()},Ee=()=>{let ot,qe;return{attachViewToDom:function(){var tt=(0,T.Z)(function*(nt,wt,ht={},et=[]){var xt,Kt;if(ot=nt,wt){const st="string"==typeof wt?null===(xt=ot.ownerDocument)||void 0===xt?void 0:xt.createElement(wt):wt;et.forEach(sn=>st.classList.add(sn)),Object.assign(st,ht),ot.appendChild(st),yield new Promise(sn=>(0,b.c)(st,sn))}else if(ot.children.length>0&&("ION-MODAL"===ot.tagName||"ION-POPOVER"===ot.tagName)&&!ot.children[0].classList.contains("ion-delegate-host")){const sn=null===(Kt=ot.ownerDocument)||void 0===Kt?void 0:Kt.createElement("div");sn.classList.add("ion-delegate-host"),et.forEach(Tt=>sn.classList.add(Tt)),sn.append(...ot.children),ot.appendChild(sn)}const It=document.querySelector("ion-app")||document.body;return qe=document.createComment("ionic teleport"),ot.parentNode.insertBefore(qe,ot),It.appendChild(ot),ot});return function(wt,ht){return tt.apply(this,arguments)}}(),removeViewFromDom:()=>(ot&&qe&&(qe.parentNode.insertBefore(ot,qe),qe.remove()),Promise.resolve())}}},4587:(fr,en,oe)=>{"use strict";oe.d(en,{G:()=>Ee});class b{constructor(qe,Et,vt,tt,nt){this.id=Et,this.name=vt,this.disableScroll=nt,this.priority=1e6*tt+Et,this.ctrl=qe}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const qe=this.ctrl.capture(this.name,this.id,this.priority);return qe&&this.disableScroll&&this.ctrl.disableScroll(this.id),qe}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Lt{constructor(qe,Et,vt,tt){this.id=Et,this.disable=vt,this.disableScroll=tt,this.ctrl=qe}block(){if(this.ctrl){if(this.disable)for(const qe of this.disable)this.ctrl.disableGesture(qe,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const qe of this.disable)this.ctrl.enableGesture(qe,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const l="backdrop-no-scroll",Ee=new class T{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(qe){var Et;return new b(this,this.newID(),qe.name,null!==(Et=qe.priority)&&void 0!==Et?Et:0,!!qe.disableScroll)}createBlocker(qe={}){return new Lt(this,this.newID(),qe.disable,!!qe.disableScroll)}start(qe,Et,vt){return this.canStart(qe)?(this.requestedStart.set(Et,vt),!0):(this.requestedStart.delete(Et),!1)}capture(qe,Et,vt){if(!this.start(qe,Et,vt))return!1;const tt=this.requestedStart;let nt=-1e4;if(tt.forEach(wt=>{nt=Math.max(nt,wt)}),nt===vt){this.capturedId=Et,tt.clear();const wt=new CustomEvent("ionGestureCaptured",{detail:{gestureName:qe}});return document.dispatchEvent(wt),!0}return tt.delete(Et),!1}release(qe){this.requestedStart.delete(qe),this.capturedId===qe&&(this.capturedId=void 0)}disableGesture(qe,Et){let vt=this.disabledGestures.get(qe);void 0===vt&&(vt=new Set,this.disabledGestures.set(qe,vt)),vt.add(Et)}enableGesture(qe,Et){const vt=this.disabledGestures.get(qe);void 0!==vt&&vt.delete(Et)}disableScroll(qe){this.disabledScroll.add(qe),1===this.disabledScroll.size&&document.body.classList.add(l)}enableScroll(qe){this.disabledScroll.delete(qe),0===this.disabledScroll.size&&document.body.classList.remove(l)}canStart(qe){return!(void 0!==this.capturedId||this.isDisabled(qe))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(qe){const Et=this.disabledGestures.get(qe);return!!(Et&&Et.size>0)}newID(){return this.gestureId++,this.gestureId}}},5421:(fr,en,oe)=>{"use strict";oe.r(en),oe.d(en,{MENU_BACK_BUTTON_PRIORITY:()=>Ee,OVERLAY_BACK_BUTTON_PRIORITY:()=>l,blockHardwareBackButton:()=>b,startHardwareBackButton:()=>Lt});var T=oe(5861);const b=()=>{document.addEventListener("backbutton",()=>{})},Lt=()=>{const ot=document;let qe=!1;ot.addEventListener("backbutton",()=>{if(qe)return;let Et=0,vt=[];const tt=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(ht,et){vt.push({priority:ht,handler:et,id:Et++})}}});ot.dispatchEvent(tt);const nt=function(){var ht=(0,T.Z)(function*(et){try{if(et?.handler){const xt=et.handler(wt);null!=xt&&(yield xt)}}catch(xt){console.error(xt)}});return function(xt){return ht.apply(this,arguments)}}(),wt=()=>{if(vt.length>0){let ht={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};vt.forEach(et=>{et.priority>=ht.priority&&(ht=et)}),qe=!0,vt=vt.filter(et=>et.id!==ht.id),nt(ht).then(()=>qe=!1)}};wt()})},l=100,Ee=99},544:(fr,en,oe)=>{"use strict";oe.d(en,{a:()=>Et,b:()=>vt,c:()=>Lt,d:()=>Kt,e:()=>xt,f:()=>et,g:()=>tt,h:()=>ht,i:()=>qe,j:()=>Le,k:()=>Ee,l:()=>It,m:()=>l,n:()=>wt,o:()=>st,p:()=>Ge,q:()=>Yt,r:()=>nt,s:()=>_n,t:()=>T,u:()=>sn,v:()=>Tt});const T=(De,ft=0)=>new Promise(Nt=>{b(De,ft,Nt)}),b=(De,ft=0,Nt)=>{let yt,mn;const hn={passive:!0},nr=()=>{yt&&yt()},Wt=pr=>{(void 0===pr||De===pr.target)&&(nr(),Nt(pr))};return De&&(De.addEventListener("webkitTransitionEnd",Wt,hn),De.addEventListener("transitionend",Wt,hn),mn=setTimeout(Wt,ft+500),yt=()=>{mn&&(clearTimeout(mn),mn=void 0),De.removeEventListener("webkitTransitionEnd",Wt,hn),De.removeEventListener("transitionend",Wt,hn)}),nr},Lt=(De,ft)=>{De.componentOnReady?De.componentOnReady().then(Nt=>ft(Nt)):nt(()=>ft(De))},l=De=>void 0!==De.componentOnReady,Ee=(De,ft=[])=>{const Nt={};return ft.forEach(yt=>{De.hasAttribute(yt)&&(null!==De.getAttribute(yt)&&(Nt[yt]=De.getAttribute(yt)),De.removeAttribute(yt))}),Nt},ot=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],qe=(De,ft)=>{let Nt=ot;return ft&&ft.length>0&&(Nt=Nt.filter(yt=>!ft.includes(yt))),Ee(De,Nt)},Et=(De,ft,Nt,yt)=>{var mn;if(typeof window<"u"){const hn=window,Gt=null===(mn=hn?.Ionic)||void 0===mn?void 0:mn.config;if(Gt){const nr=Gt.get("_ael");if(nr)return nr(De,ft,Nt,yt);if(Gt._ael)return Gt._ael(De,ft,Nt,yt)}}return De.addEventListener(ft,Nt,yt)},vt=(De,ft,Nt,yt)=>{var mn;if(typeof window<"u"){const hn=window,Gt=null===(mn=hn?.Ionic)||void 0===mn?void 0:mn.config;if(Gt){const nr=Gt.get("_rel");if(nr)return nr(De,ft,Nt,yt);if(Gt._rel)return Gt._rel(De,ft,Nt,yt)}}return De.removeEventListener(ft,Nt,yt)},tt=(De,ft=De)=>De.shadowRoot||ft,nt=De=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(De):"function"==typeof requestAnimationFrame?requestAnimationFrame(De):setTimeout(De),wt=De=>!!De.shadowRoot&&!!De.attachShadow,ht=De=>{const ft=De.closest("ion-item");return ft?ft.querySelector("ion-label"):null},et=De=>{if(De.focus(),De.classList.contains("ion-focusable")){const ft=De.closest("ion-app");ft&&ft.setFocus([De])}},xt=(De,ft)=>{let Nt;const yt=De.getAttribute("aria-labelledby"),mn=De.id;let hn=null!==yt&&""!==yt.trim()?yt:ft+"-lbl",Gt=null!==yt&&""!==yt.trim()?document.getElementById(yt):ht(De);return Gt?(null===yt&&(Gt.id=hn),Nt=Gt.textContent,Gt.setAttribute("aria-hidden","true")):""!==mn.trim()&&(Gt=document.querySelector(`label[for="${mn}"]`),Gt&&(""!==Gt.id?hn=Gt.id:Gt.id=hn=`${mn}-lbl`,Nt=Gt.textContent)),{label:Gt,labelId:hn,labelText:Nt}},Kt=(De,ft,Nt,yt,mn)=>{if(De||wt(ft)){let hn=ft.querySelector("input.aux-input");hn||(hn=ft.ownerDocument.createElement("input"),hn.type="hidden",hn.classList.add("aux-input"),ft.appendChild(hn)),hn.disabled=mn,hn.name=Nt,hn.value=yt||""}},It=(De,ft,Nt)=>Math.max(De,Math.min(ft,Nt)),st=(De,ft)=>{if(!De){const Nt="ASSERT: "+ft;throw console.error(Nt),new Error(Nt)}},sn=De=>De.timeStamp||Date.now(),Tt=De=>{if(De){const ft=De.changedTouches;if(ft&&ft.length>0){const Nt=ft[0];return{x:Nt.clientX,y:Nt.clientY}}if(void 0!==De.pageX)return{x:De.pageX,y:De.pageY}}return{x:0,y:0}},Ge=De=>{const ft="rtl"===document.dir;switch(De){case"start":return ft;case"end":return!ft;default:throw new Error(`"${De}" is not a valid value for [side]. Use "start" or "end" instead.`)}},Le=(De,ft)=>{const Nt=De._original||De;return{_original:De,emit:Yt(Nt.emit.bind(Nt),ft)}},Yt=(De,ft=0)=>{let Nt;return(...yt)=>{clearTimeout(Nt),Nt=setTimeout(De,ft,...yt)}},_n=(De,ft)=>{if(De??(De={}),ft??(ft={}),De===ft)return!0;const Nt=Object.keys(De);if(Nt.length!==Object.keys(ft).length)return!1;for(const yt of Nt)if(!(yt in ft)||De[yt]!==ft[yt])return!1;return!0}},6953:(fr,en,oe)=>{"use strict";oe.d(en,{B:()=>nt,H:()=>nr,a:()=>So,b:()=>Mr,c:()=>un,d:()=>Ot,e:()=>Kn,f:()=>Mn,g:()=>Qn,h:()=>hn,i:()=>lt,j:()=>wt,p:()=>ei,r:()=>yn,w:()=>Br});var T=oe(5861);let Lt,l,Ee,ot=!1,qe=!1,Et=!1,vt=!1,tt=!1;const nt={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},wt=le=>{const Oe=new URL(le,Ur.$resourcesUrl$);return Oe.origin!==li.location.origin?Oe.href:Oe.pathname},sn="s-id",Tt="sty-id",Yt="http://www.w3.org/1999/xlink",_n={},yt=le=>"object"==(le=typeof le)||"function"===le;function mn(le){var Oe,pe,Se;return null!==(Se=null===(pe=null===(Oe=le.head)||void 0===Oe?void 0:Oe.querySelector('meta[name="csp-nonce"]'))||void 0===pe?void 0:pe.getAttribute("content"))&&void 0!==Se?Se:void 0}const hn=(le,Oe,...pe)=>{let Se=null,bt=null,Pt=null,fn=!1,bn=!1;const pn=[],Pn=Ar=>{for(let Zr=0;Zr<Ar.length;Zr++)Se=Ar[Zr],Array.isArray(Se)?Pn(Se):null!=Se&&"boolean"!=typeof Se&&((fn="function"!=typeof le&&!yt(Se))&&(Se=String(Se)),fn&&bn?pn[pn.length-1].$text$+=Se:pn.push(fn?Gt(null,Se):Se),bn=fn)};if(Pn(pe),Oe){Oe.key&&(bt=Oe.key),Oe.name&&(Pt=Oe.name);{const Ar=Oe.className||Oe.class;Ar&&(Oe.class="object"!=typeof Ar?Ar:Object.keys(Ar).filter(Zr=>Ar[Zr]).join(" "))}}if("function"==typeof le)return le(null===Oe?{}:Oe,pn,pr);const lr=Gt(le,null);return lr.$attrs$=Oe,pn.length>0&&(lr.$children$=pn),lr.$key$=bt,lr.$name$=Pt,lr},Gt=(le,Oe)=>({$flags$:0,$tag$:le,$text$:Oe,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),nr={},pr={forEach:(le,Oe)=>le.map(an).forEach(Oe),map:(le,Oe)=>le.map(an).map(Oe).map(Me)},an=le=>({vattrs:le.$attrs$,vchildren:le.$children$,vkey:le.$key$,vname:le.$name$,vtag:le.$tag$,vtext:le.$text$}),Me=le=>{if("function"==typeof le.vtag){const pe=Object.assign({},le.vattrs);return le.vkey&&(pe.key=le.vkey),le.vname&&(pe.name=le.vname),hn(le.vtag,pe,...le.vchildren||[])}const Oe=Gt(le.vtag,le.vtext);return Oe.$attrs$=le.vattrs,Oe.$children$=le.vchildren,Oe.$key$=le.vkey,Oe.$name$=le.vname,Oe},at=(le,Oe,pe,Se,bt,Pt,fn)=>{let bn,pn,Pn,lr;if(1===Pt.nodeType){for(bn=Pt.getAttribute("c-id"),bn&&(pn=bn.split("."),(pn[0]===fn||"0"===pn[0])&&(Pn={$flags$:0,$hostId$:pn[0],$nodeId$:pn[1],$depth$:pn[2],$index$:pn[3],$tag$:Pt.tagName.toLowerCase(),$elm$:Pt,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},Oe.push(Pn),Pt.removeAttribute("c-id"),le.$children$||(le.$children$=[]),le.$children$[Pn.$index$]=Pn,le=Pn,Se&&"0"===Pn.$depth$&&(Se[Pn.$index$]=Pn.$elm$))),lr=Pt.childNodes.length-1;lr>=0;lr--)at(le,Oe,pe,Se,bt,Pt.childNodes[lr],fn);if(Pt.shadowRoot)for(lr=Pt.shadowRoot.childNodes.length-1;lr>=0;lr--)at(le,Oe,pe,Se,bt,Pt.shadowRoot.childNodes[lr],fn)}else if(8===Pt.nodeType)pn=Pt.nodeValue.split("."),(pn[1]===fn||"0"===pn[1])&&(bn=pn[0],Pn={$flags$:0,$hostId$:pn[1],$nodeId$:pn[2],$depth$:pn[3],$index$:pn[4],$elm$:Pt,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===bn?(Pn.$elm$=Pt.nextSibling,Pn.$elm$&&3===Pn.$elm$.nodeType&&(Pn.$text$=Pn.$elm$.textContent,Oe.push(Pn),Pt.remove(),le.$children$||(le.$children$=[]),le.$children$[Pn.$index$]=Pn,Se&&"0"===Pn.$depth$&&(Se[Pn.$index$]=Pn.$elm$))):Pn.$hostId$===fn&&("s"===bn?(Pn.$tag$="slot",Pt["s-sn"]=pn[5]?Pn.$name$=pn[5]:"",Pt["s-sr"]=!0,Se&&(Pn.$elm$=bi.createElement(Pn.$tag$),Pn.$name$&&Pn.$elm$.setAttribute("name",Pn.$name$),Pt.parentNode.insertBefore(Pn.$elm$,Pt),Pt.remove(),"0"===Pn.$depth$&&(Se[Pn.$index$]=Pn.$elm$)),pe.push(Pn),le.$children$||(le.$children$=[]),le.$children$[Pn.$index$]=Pn):"r"===bn&&(Se?Pt.remove():(bt["s-cr"]=Pt,Pt["s-cn"]=!0))));else if(le&&"style"===le.$tag$){const Ar=Gt(null,Pt.textContent);Ar.$elm$=Pt,Ar.$index$="0",le.$children$=[Ar]}},Rt=(le,Oe)=>{if(1===le.nodeType){let pe=0;for(;pe<le.childNodes.length;pe++)Rt(le.childNodes[pe],Oe);if(le.shadowRoot)for(pe=0;pe<le.shadowRoot.childNodes.length;pe++)Rt(le.shadowRoot.childNodes[pe],Oe)}else if(8===le.nodeType){const pe=le.nodeValue.split(".");"o"===pe[0]&&(Oe.set(pe[1]+"."+pe[2],le),le.nodeValue="",le["s-en"]=pe[3])}},un=le=>Yr.push(le),Qn=le=>Xt(le).$modeName$,Mn=le=>Xt(le).$hostElement$,Ot=(le,Oe,pe)=>{const Se=Mn(le);return{emit:bt=>qt(Se,Oe,{bubbles:!!(4&pe),composed:!!(2&pe),cancelable:!!(1&pe),detail:bt})}},qt=(le,Oe,pe)=>{const Se=Ur.ce(Oe,pe);return le.dispatchEvent(Se),Se},$t=new WeakMap,vn=(le,Oe,pe)=>{let Se=mi.get(le);Ri&&pe?(Se=Se||new CSSStyleSheet,"string"==typeof Se?Se=Oe:Se.replaceSync(Oe)):Se=Oe,mi.set(le,Se)},Gn=(le,Oe,pe,Se)=>{var bt;let Pt=Wn(Oe,pe);const fn=mi.get(Pt);if(le=11===le.nodeType?le:bi,fn)if("string"==typeof fn){let pn,bn=$t.get(le=le.head||le);if(bn||$t.set(le,bn=new Set),!bn.has(Pt)){if(le.host&&(pn=le.querySelector(`[${Tt}="${Pt}"]`)))pn.innerHTML=fn;else{pn=bi.createElement("style"),pn.innerHTML=fn;const Pn=null!==(bt=Ur.$nonce$)&&void 0!==bt?bt:mn(bi);null!=Pn&&pn.setAttribute("nonce",Pn),le.insertBefore(pn,le.querySelector("link"))}bn&&bn.add(Pt)}}else le.adoptedStyleSheets.includes(fn)||(le.adoptedStyleSheets=[...le.adoptedStyleSheets,fn]);return Pt},Wn=(le,Oe)=>"sc-"+(Oe&&32&le.$flags$?le.$tagName$+"-"+Oe:le.$tagName$),Dr=le=>le.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),er=(le,Oe,pe,Se,bt,Pt)=>{if(pe!==Se){let fn=br(le,Oe),bn=Oe.toLowerCase();if("class"===Oe){const pn=le.classList,Pn=An(pe),lr=An(Se);pn.remove(...Pn.filter(Ar=>Ar&&!lr.includes(Ar))),pn.add(...lr.filter(Ar=>Ar&&!Pn.includes(Ar)))}else if("style"===Oe){for(const pn in pe)(!Se||null==Se[pn])&&(pn.includes("-")?le.style.removeProperty(pn):le.style[pn]="");for(const pn in Se)(!pe||Se[pn]!==pe[pn])&&(pn.includes("-")?le.style.setProperty(pn,Se[pn]):le.style[pn]=Se[pn])}else if("key"!==Oe)if("ref"===Oe)Se&&Se(le);else if(fn||"o"!==Oe[0]||"n"!==Oe[1]){const pn=yt(Se);if((fn||pn&&null!==Se)&&!bt)try{if(le.tagName.includes("-"))le[Oe]=Se;else{const lr=Se??"";"list"===Oe?fn=!1:(null==pe||le[Oe]!=lr)&&(le[Oe]=lr)}}catch{}let Pn=!1;bn!==(bn=bn.replace(/^xlink\:?/,""))&&(Oe=bn,Pn=!0),null==Se||!1===Se?(!1!==Se||""===le.getAttribute(Oe))&&(Pn?le.removeAttributeNS(Yt,Oe):le.removeAttribute(Oe)):(!fn||4&Pt||bt)&&!pn&&(Se=!0===Se?"":Se,Pn?le.setAttributeNS(Yt,Oe,Se):le.setAttribute(Oe,Se))}else Oe="-"===Oe[2]?Oe.slice(3):br(li,bn)?bn.slice(2):bn[2]+Oe.slice(3),pe&&Ur.rel(le,Oe,pe,!1),Se&&Ur.ael(le,Oe,Se,!1)}},kr=/\s/,An=le=>le?le.split(kr):[],vi=(le,Oe,pe,Se)=>{const bt=11===Oe.$elm$.nodeType&&Oe.$elm$.host?Oe.$elm$.host:Oe.$elm$,Pt=le&&le.$attrs$||_n,fn=Oe.$attrs$||_n;for(Se in Pt)Se in fn||er(bt,Se,Pt[Se],void 0,pe,Oe.$flags$);for(Se in fn)er(bt,Se,Pt[Se],fn[Se],pe,Oe.$flags$)},to=(le,Oe,pe,Se)=>{const bt=Oe.$children$[pe];let fn,bn,pn,Pt=0;if(ot||(Et=!0,"slot"===bt.$tag$&&(Lt&&Se.classList.add(Lt+"-s"),bt.$flags$|=bt.$children$?2:1)),null!==bt.$text$)fn=bt.$elm$=bi.createTextNode(bt.$text$);else if(1&bt.$flags$)fn=bt.$elm$=bi.createTextNode("");else{if(vt||(vt="svg"===bt.$tag$),fn=bt.$elm$=bi.createElementNS(vt?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&bt.$flags$?"slot-fb":bt.$tag$),vt&&"foreignObject"===bt.$tag$&&(vt=!1),vi(null,bt,vt),(le=>null!=le)(Lt)&&fn["s-si"]!==Lt&&fn.classList.add(fn["s-si"]=Lt),bt.$children$)for(Pt=0;Pt<bt.$children$.length;++Pt)bn=to(le,bt,Pt,fn),bn&&fn.appendChild(bn);"svg"===bt.$tag$?vt=!1:"foreignObject"===fn.tagName&&(vt=!0)}return fn["s-hn"]=Ee,3&bt.$flags$&&(fn["s-sr"]=!0,fn["s-cr"]=l,fn["s-sn"]=bt.$name$||"",pn=le&&le.$children$&&le.$children$[pe],pn&&pn.$tag$===bt.$tag$&&le.$elm$&&Ai(le.$elm$,!1)),fn},Ai=(le,Oe)=>{Ur.$flags$|=1;const pe=le.childNodes;for(let Se=pe.length-1;Se>=0;Se--){const bt=pe[Se];bt["s-hn"]!==Ee&&bt["s-ol"]&&($i(bt).insertBefore(bt,Tr(bt)),bt["s-ol"].remove(),bt["s-ol"]=void 0,Et=!0),Oe&&Ai(bt,Oe)}Ur.$flags$&=-2},zi=(le,Oe,pe,Se,bt,Pt)=>{let bn,fn=le["s-cr"]&&le["s-cr"].parentNode||le;for(fn.shadowRoot&&fn.tagName===Ee&&(fn=fn.shadowRoot);bt<=Pt;++bt)Se[bt]&&(bn=to(null,pe,bt,le),bn&&(Se[bt].$elm$=bn,fn.insertBefore(bn,Tr(Oe))))},Ir=(le,Oe,pe)=>{for(let Se=Oe;Se<=pe;++Se){const bt=le[Se];if(bt){const Pt=bt.$elm$;ii(bt),Pt&&(qe=!0,Pt["s-ol"]?Pt["s-ol"].remove():Ai(Pt,!0),Pt.remove())}}},Lo=(le,Oe)=>le.$tag$===Oe.$tag$&&("slot"===le.$tag$?le.$name$===Oe.$name$:le.$key$===Oe.$key$),Tr=le=>le&&le["s-ol"]||le,$i=le=>(le["s-ol"]?le["s-ol"]:le).parentNode,Lr=(le,Oe)=>{const pe=Oe.$elm$=le.$elm$,Se=le.$children$,bt=Oe.$children$,Pt=Oe.$tag$,fn=Oe.$text$;let bn;null===fn?(vt="svg"===Pt||"foreignObject"!==Pt&&vt,"slot"===Pt||vi(le,Oe,vt),null!==Se&&null!==bt?((le,Oe,pe,Se)=>{let zo,Ki,bt=0,Pt=0,fn=0,bn=0,pn=Oe.length-1,Pn=Oe[0],lr=Oe[pn],Ar=Se.length-1,Zr=Se[0],ji=Se[Ar];for(;bt<=pn&&Pt<=Ar;)if(null==Pn)Pn=Oe[++bt];else if(null==lr)lr=Oe[--pn];else if(null==Zr)Zr=Se[++Pt];else if(null==ji)ji=Se[--Ar];else if(Lo(Pn,Zr))Lr(Pn,Zr),Pn=Oe[++bt],Zr=Se[++Pt];else if(Lo(lr,ji))Lr(lr,ji),lr=Oe[--pn],ji=Se[--Ar];else if(Lo(Pn,ji))("slot"===Pn.$tag$||"slot"===ji.$tag$)&&Ai(Pn.$elm$.parentNode,!1),Lr(Pn,ji),le.insertBefore(Pn.$elm$,lr.$elm$.nextSibling),Pn=Oe[++bt],ji=Se[--Ar];else if(Lo(lr,Zr))("slot"===Pn.$tag$||"slot"===ji.$tag$)&&Ai(lr.$elm$.parentNode,!1),Lr(lr,Zr),le.insertBefore(lr.$elm$,Pn.$elm$),lr=Oe[--pn],Zr=Se[++Pt];else{for(fn=-1,bn=bt;bn<=pn;++bn)if(Oe[bn]&&null!==Oe[bn].$key$&&Oe[bn].$key$===Zr.$key$){fn=bn;break}fn>=0?(Ki=Oe[fn],Ki.$tag$!==Zr.$tag$?zo=to(Oe&&Oe[Pt],pe,fn,le):(Lr(Ki,Zr),Oe[fn]=void 0,zo=Ki.$elm$),Zr=Se[++Pt]):(zo=to(Oe&&Oe[Pt],pe,Pt,le),Zr=Se[++Pt]),zo&&$i(Pn.$elm$).insertBefore(zo,Tr(Pn.$elm$))}bt>pn?zi(le,null==Se[Ar+1]?null:Se[Ar+1].$elm$,pe,Se,Pt,Ar):Pt>Ar&&Ir(Oe,bt,pn)})(pe,Se,Oe,bt):null!==bt?(null!==le.$text$&&(pe.textContent=""),zi(pe,null,Oe,bt,0,bt.length-1)):null!==Se&&Ir(Se,0,Se.length-1),vt&&"svg"===Pt&&(vt=!1)):(bn=pe["s-cr"])?bn.parentNode.textContent=fn:le.$text$!==fn&&(pe.data=fn)},si=le=>{const Oe=le.childNodes;let pe,Se,bt,Pt,fn,bn;for(Se=0,bt=Oe.length;Se<bt;Se++)if(pe=Oe[Se],1===pe.nodeType){if(pe["s-sr"])for(fn=pe["s-sn"],pe.hidden=!1,Pt=0;Pt<bt;Pt++)if(bn=Oe[Pt].nodeType,Oe[Pt]["s-hn"]!==pe["s-hn"]||""!==fn){if(1===bn&&fn===Oe[Pt].getAttribute("slot")){pe.hidden=!0;break}}else if(1===bn||3===bn&&""!==Oe[Pt].textContent.trim()){pe.hidden=!0;break}si(pe)}},Gi=[],ai=le=>{let Oe,pe,Se,bt,Pt,fn,bn=0;const pn=le.childNodes,Pn=pn.length;for(;bn<Pn;bn++){if(Oe=pn[bn],Oe["s-sr"]&&(pe=Oe["s-cr"])&&pe.parentNode)for(Se=pe.parentNode.childNodes,bt=Oe["s-sn"],fn=Se.length-1;fn>=0;fn--)pe=Se[fn],!pe["s-cn"]&&!pe["s-nr"]&&pe["s-hn"]!==Oe["s-hn"]&&(Pi(pe,bt)?(Pt=Gi.find(lr=>lr.$nodeToRelocate$===pe),qe=!0,pe["s-sn"]=pe["s-sn"]||bt,Pt?Pt.$slotRefNode$=Oe:Gi.push({$slotRefNode$:Oe,$nodeToRelocate$:pe}),pe["s-sr"]&&Gi.map(lr=>{Pi(lr.$nodeToRelocate$,pe["s-sn"])&&(Pt=Gi.find(Ar=>Ar.$nodeToRelocate$===pe),Pt&&!lr.$slotRefNode$&&(lr.$slotRefNode$=Pt.$slotRefNode$))})):Gi.some(lr=>lr.$nodeToRelocate$===pe)||Gi.push({$nodeToRelocate$:pe}));1===Oe.nodeType&&ai(Oe)}},Pi=(le,Oe)=>1===le.nodeType?null===le.getAttribute("slot")&&""===Oe||le.getAttribute("slot")===Oe:le["s-sn"]===Oe||""===Oe,ii=le=>{le.$attrs$&&le.$attrs$.ref&&le.$attrs$.ref(null),le.$children$&&le.$children$.map(ii)},je=(le,Oe)=>{Oe&&!le.$onRenderResolve$&&Oe["s-p"]&&Oe["s-p"].push(new Promise(pe=>le.$onRenderResolve$=pe))},ae=(le,Oe)=>{if(le.$flags$|=16,!(4&le.$flags$))return je(le,le.$ancestorComponent$),Br(()=>de(le,Oe));le.$flags$|=512},de=(le,Oe)=>{const Se=le.$lazyInstance$;let bt;return Oe&&(le.$flags$|=256,le.$queuedListeners$&&(le.$queuedListeners$.map(([Pt,fn])=>En(Se,Pt,fn)),le.$queuedListeners$=void 0),bt=En(Se,"componentWillLoad")),bt=ke(bt,()=>En(Se,"componentWillRender")),ke(bt,()=>dt(le,Se,Oe))},ke=(le,Oe)=>Ye(le)?le.then(Oe):Oe(),Ye=le=>le instanceof Promise||le&&le.then&&"function"==typeof le.then,dt=function(){var le=(0,T.Z)(function*(Oe,pe,Se){var bt;const Pt=Oe.$hostElement$,bn=Pt["s-rc"];Se&&(le=>{const Oe=le.$cmpMeta$,pe=le.$hostElement$,Se=Oe.$flags$,Pt=Gn(pe.shadowRoot?pe.shadowRoot:pe.getRootNode(),Oe,le.$modeName$);10&Se&&(pe["s-sc"]=Pt,pe.classList.add(Pt+"-h"),2&Se&&pe.classList.add(Pt+"-s"))})(Oe);Mt(Oe,pe),bn&&(bn.map(Pn=>Pn()),Pt["s-rc"]=void 0);{const Pn=null!==(bt=Pt["s-p"])&&void 0!==bt?bt:[],lr=()=>St(Oe);0===Pn.length?lr():(Promise.all(Pn).then(lr),Oe.$flags$|=4,Pn.length=0)}});return function(pe,Se,bt){return le.apply(this,arguments)}}(),Mt=(le,Oe,pe)=>{try{Oe=Oe.render&&Oe.render(),le.$flags$&=-17,le.$flags$|=2,((le,Oe)=>{const pe=le.$hostElement$,Se=le.$cmpMeta$,bt=le.$vnode$||Gt(null,null),Pt=(le=>le&&le.$tag$===nr)(Oe)?Oe:hn(null,null,Oe);if(Ee=pe.tagName,Se.$attrsToReflect$&&(Pt.$attrs$=Pt.$attrs$||{},Se.$attrsToReflect$.map(([fn,bn])=>Pt.$attrs$[bn]=pe[fn])),Pt.$tag$=null,Pt.$flags$|=4,le.$vnode$=Pt,Pt.$elm$=bt.$elm$=pe.shadowRoot||pe,Lt=pe["s-sc"],l=pe["s-cr"],ot=0!=(1&Se.$flags$),qe=!1,Lr(bt,Pt),Ur.$flags$|=1,Et){ai(Pt.$elm$);let fn,bn,pn,Pn,lr,Ar,Zr=0;for(;Zr<Gi.length;Zr++)fn=Gi[Zr],bn=fn.$nodeToRelocate$,bn["s-ol"]||(pn=bi.createTextNode(""),pn["s-nr"]=bn,bn.parentNode.insertBefore(bn["s-ol"]=pn,bn));for(Zr=0;Zr<Gi.length;Zr++)if(fn=Gi[Zr],bn=fn.$nodeToRelocate$,fn.$slotRefNode$){for(Pn=fn.$slotRefNode$.parentNode,lr=fn.$slotRefNode$.nextSibling,pn=bn["s-ol"];pn=pn.previousSibling;)if(Ar=pn["s-nr"],Ar&&Ar["s-sn"]===bn["s-sn"]&&Pn===Ar.parentNode&&(Ar=Ar.nextSibling,!Ar||!Ar["s-nr"])){lr=Ar;break}(!lr&&Pn!==bn.parentNode||bn.nextSibling!==lr)&&bn!==lr&&(!bn["s-hn"]&&bn["s-ol"]&&(bn["s-hn"]=bn["s-ol"].parentNode.nodeName),Pn.insertBefore(bn,lr))}else 1===bn.nodeType&&(bn.hidden=!0)}qe&&si(Pt.$elm$),Ur.$flags$&=-2,Gi.length=0})(le,Oe)}catch(Se){or(Se,le.$hostElement$)}return null},St=le=>{const pe=le.$hostElement$,bt=le.$lazyInstance$,Pt=le.$ancestorComponent$;En(bt,"componentDidRender"),64&le.$flags$?En(bt,"componentDidUpdate"):(le.$flags$|=64,Ln(pe),En(bt,"componentDidLoad"),le.$onReadyResolve$(pe),Pt||Vt()),le.$onInstanceResolve$(pe),le.$onRenderResolve$&&(le.$onRenderResolve$(),le.$onRenderResolve$=void 0),512&le.$flags$&&yo(()=>ae(le,!1)),le.$flags$&=-517},lt=le=>{{const Oe=Xt(le),pe=Oe.$hostElement$.isConnected;return pe&&2==(18&Oe.$flags$)&&ae(Oe,!1),pe}},Vt=le=>{Ln(bi.documentElement),yo(()=>qt(li,"appload",{detail:{namespace:"ionic"}}))},En=(le,Oe,pe)=>{if(le&&le[Oe])try{return le[Oe](pe)}catch(Se){or(Se)}},Ln=le=>le.classList.add("hydrated"),Dt=(le,Oe,pe)=>{if(Oe.$members$){le.watchers&&(Oe.$watchers$=le.watchers);const Se=Object.entries(Oe.$members$),bt=le.prototype;if(Se.map(([Pt,[fn]])=>{31&fn||2&pe&&32&fn?Object.defineProperty(bt,Pt,{get(){return((le,Oe)=>Xt(this).$instanceValues$.get(Oe))(0,Pt)},set(bn){((le,Oe,pe,Se)=>{const bt=Xt(le),Pt=bt.$hostElement$,fn=bt.$instanceValues$.get(Oe),bn=bt.$flags$,pn=bt.$lazyInstance$;pe=((le,Oe)=>null==le||yt(le)?le:4&Oe?"false"!==le&&(""===le||!!le):2&Oe?parseFloat(le):1&Oe?String(le):le)(pe,Se.$members$[Oe][0]);const Pn=Number.isNaN(fn)&&Number.isNaN(pe);if((!(8&bn)||void 0===fn)&&pe!==fn&&!Pn&&(bt.$instanceValues$.set(Oe,pe),pn)){if(Se.$watchers$&&128&bn){const Ar=Se.$watchers$[Oe];Ar&&Ar.map(Zr=>{try{pn[Zr](pe,fn,Oe)}catch(ji){or(ji,Pt)}})}2==(18&bn)&&ae(bt,!1)}})(this,Pt,bn,Oe)},configurable:!0,enumerable:!0}):1&pe&&64&fn&&Object.defineProperty(bt,Pt,{value(...bn){const pn=Xt(this);return pn.$onInstancePromise$.then(()=>pn.$lazyInstance$[Pt](...bn))}})}),1&pe){const Pt=new Map;bt.attributeChangedCallback=function(fn,bn,pn){Ur.jmp(()=>{const Pn=Pt.get(fn);if(this.hasOwnProperty(Pn))pn=this[Pn],delete this[Pn];else if(bt.hasOwnProperty(Pn)&&"number"==typeof this[Pn]&&this[Pn]==pn)return;this[Pn]=(null!==pn||"boolean"!=typeof this[Pn])&&pn})},le.observedAttributes=Se.filter(([fn,bn])=>15&bn[0]).map(([fn,bn])=>{const pn=bn[1]||fn;return Pt.set(pn,fn),512&bn[0]&&Oe.$attrsToReflect$.push([fn,pn]),pn})}}return le},He=function(){var le=(0,T.Z)(function*(Oe,pe,Se,bt,Pt){if(!(32&pe.$flags$)){pe.$flags$|=32;{if((Pt=Sr(Se)).then){const Pn=()=>{};Pt=yield Pt,Pn()}Pt.isProxied||(Se.$watchers$=Pt.watchers,Dt(Pt,Se,2),Pt.isProxied=!0);const pn=()=>{};pe.$flags$|=8;try{new Pt(pe)}catch(Pn){or(Pn)}pe.$flags$&=-9,pe.$flags$|=128,pn(),At(pe.$lazyInstance$)}if(Pt.style){let pn=Pt.style;"string"!=typeof pn&&(pn=pn[pe.$modeName$=(le=>Yr.map(Oe=>Oe(le)).find(Oe=>!!Oe))(Oe)]);const Pn=Wn(Se,pe.$modeName$);if(!mi.has(Pn)){const lr=()=>{};vn(Pn,pn,!!(1&Se.$flags$)),lr()}}}const fn=pe.$ancestorComponent$,bn=()=>ae(pe,!0);fn&&fn["s-rc"]?fn["s-rc"].push(bn):bn()});return function(pe,Se,bt,Pt,fn){return le.apply(this,arguments)}}(),At=le=>{En(le,"connectedCallback")},qn=le=>{const Oe=le["s-cr"]=bi.createComment("");Oe["s-cn"]=!0,le.insertBefore(Oe,le.firstChild)},Mr=(le,Oe={})=>{var pe;const bt=[],Pt=Oe.exclude||[],fn=li.customElements,bn=bi.head,pn=bn.querySelector("meta[charset]"),Pn=bi.createElement("style"),lr=[],Ar=bi.querySelectorAll(`[${Tt}]`);let Zr,ji=!0,zo=0;for(Object.assign(Ur,Oe),Ur.$resourcesUrl$=new URL(Oe.resourcesUrl||"./",bi.baseURI).href,Ur.$flags$|=2;zo<Ar.length;zo++)vn(Ar[zo].getAttribute(Tt),Dr(Ar[zo].innerHTML),!0);le.map(Ki=>{Ki[1].map(Zo=>{const ao={$flags$:Zo[0],$tagName$:Zo[1],$members$:Zo[2],$listeners$:Zo[3]};ao.$members$=Zo[2],ao.$listeners$=Zo[3],ao.$attrsToReflect$=[],ao.$watchers$={};const Io=ao.$tagName$,ro=class extends HTMLElement{constructor(Si){super(Si),zn(Si=this,ao),1&ao.$flags$&&Si.attachShadow({mode:"open",delegatesFocus:!!(16&ao.$flags$)})}connectedCallback(){Zr&&(clearTimeout(Zr),Zr=null),ji?lr.push(this):Ur.jmp(()=>(le=>{if(!(1&Ur.$flags$)){const Oe=Xt(le),pe=Oe.$cmpMeta$,Se=()=>{};if(1&Oe.$flags$)$r(le,Oe,pe.$listeners$),At(Oe.$lazyInstance$);else{let bt;if(Oe.$flags$|=1,bt=le.getAttribute(sn),bt){if(1&pe.$flags$){const Pt=Gn(le.shadowRoot,pe,le.getAttribute("s-mode"));le.classList.remove(Pt+"-h",Pt+"-s")}((le,Oe,pe,Se)=>{const Pt=le.shadowRoot,fn=[],pn=Pt?[]:null,Pn=Se.$vnode$=Gt(Oe,null);Ur.$orgLocNodes$||Rt(bi.body,Ur.$orgLocNodes$=new Map),le[sn]=pe,le.removeAttribute(sn),at(Pn,fn,[],pn,le,le,pe),fn.map(lr=>{const Ar=lr.$hostId$+"."+lr.$nodeId$,Zr=Ur.$orgLocNodes$.get(Ar),ji=lr.$elm$;Zr&&zt&&""===Zr["s-en"]&&Zr.parentNode.insertBefore(ji,Zr.nextSibling),Pt||(ji["s-hn"]=Oe,Zr&&(ji["s-ol"]=Zr,ji["s-ol"]["s-nr"]=ji)),Ur.$orgLocNodes$.delete(Ar)}),Pt&&pn.map(lr=>{lr&&Pt.appendChild(lr)})})(le,pe.$tagName$,bt,Oe)}bt||12&pe.$flags$&&qn(le);{let Pt=le;for(;Pt=Pt.parentNode||Pt.host;)if(1===Pt.nodeType&&Pt.hasAttribute("s-id")&&Pt["s-p"]||Pt["s-p"]){je(Oe,Oe.$ancestorComponent$=Pt);break}}pe.$members$&&Object.entries(pe.$members$).map(([Pt,[fn]])=>{if(31&fn&&le.hasOwnProperty(Pt)){const bn=le[Pt];delete le[Pt],le[Pt]=bn}}),He(le,Oe,pe)}Se()}})(this))}disconnectedCallback(){Ur.jmp(()=>(le=>{if(!(1&Ur.$flags$)){const Oe=Xt(this),pe=Oe.$lazyInstance$;Oe.$rmListeners$&&(Oe.$rmListeners$.map(Se=>Se()),Oe.$rmListeners$=void 0),En(pe,"disconnectedCallback")}})())}componentOnReady(){return Xt(this).$onReadyPromise$}};ao.$lazyBundleId$=Ki[0],!Pt.includes(Io)&&!fn.get(Io)&&(bt.push(Io),fn.define(Io,Dt(ro,ao,1)))})});{Pn.innerHTML=bt+"{visibility:hidden}.hydrated{visibility:inherit}",Pn.setAttribute("data-styles","");const Ki=null!==(pe=Ur.$nonce$)&&void 0!==pe?pe:mn(bi);null!=Ki&&Pn.setAttribute("nonce",Ki),bn.insertBefore(Pn,pn?pn.nextSibling:bn.firstChild)}ji=!1,lr.length?lr.map(Ki=>Ki.connectedCallback()):Ur.jmp(()=>Zr=setTimeout(Vt,30))},$r=(le,Oe,pe,Se)=>{pe&&pe.map(([bt,Pt,fn])=>{const bn=Oi(le,bt),pn=Qr(Oe,fn),Pn=rt(bt);Ur.ael(bn,Pt,pn,Pn),(Oe.$rmListeners$=Oe.$rmListeners$||[]).push(()=>Ur.rel(bn,Pt,pn,Pn))})},Qr=(le,Oe)=>pe=>{try{256&le.$flags$?le.$lazyInstance$[Oe](pe):(le.$queuedListeners$=le.$queuedListeners$||[]).push([Oe,pe])}catch(Se){or(Se)}},Oi=(le,Oe)=>4&Oe?bi:8&Oe?li:16&Oe?bi.body:le,rt=le=>0!=(2&le),tn=new WeakMap,Xt=le=>tn.get(le),yn=(le,Oe)=>tn.set(Oe.$lazyInstance$=le,Oe),zn=(le,Oe)=>{const pe={$flags$:0,$hostElement$:le,$cmpMeta$:Oe,$instanceValues$:new Map};return pe.$onInstancePromise$=new Promise(Se=>pe.$onInstanceResolve$=Se),pe.$onReadyPromise$=new Promise(Se=>pe.$onReadyResolve$=Se),le["s-p"]=[],le["s-rc"]=[],$r(le,pe,Oe.$listeners$),tn.set(le,pe)},br=(le,Oe)=>Oe in le,or=(le,Oe)=>(0,console.error)(le,Oe),hi=new Map,Sr=(le,Oe,pe)=>{const Se=le.$tagName$.replace(/-/g,"_"),bt=le.$lazyBundleId$,Pt=hi.get(bt);return Pt?Pt[Se]:oe(863)(`./${bt}.entry.js`).then(fn=>(hi.set(bt,fn),fn[Se]),or)},mi=new Map,Yr=[],li=typeof window<"u"?window:{},bi=li.document||{head:{}},Ur={$flags$:0,$resourcesUrl$:"",jmp:le=>le(),raf:le=>requestAnimationFrame(le),ael:(le,Oe,pe,Se)=>le.addEventListener(Oe,pe,Se),rel:(le,Oe,pe,Se)=>le.removeEventListener(Oe,pe,Se),ce:(le,Oe)=>new CustomEvent(le,Oe)},So=le=>{Object.assign(Ur,le)},zt=!0,ei=le=>Promise.resolve(le),Ri=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),Fi=[],Vi=[],Ui=(le,Oe)=>pe=>{le.push(pe),tt||(tt=!0,Oe&&4&Ur.$flags$?yo(so):Ur.raf(so))},_o=le=>{for(let Oe=0;Oe<le.length;Oe++)try{le[Oe](performance.now())}catch(pe){or(pe)}le.length=0},so=()=>{_o(Fi),_o(Vi),(tt=Fi.length>0)&&Ur.raf(so)},yo=le=>ei().then(le),Kn=Ui(Fi,!1),Br=Ui(Vi,!0)},8077:(fr,en,oe)=>{"use strict";oe.r(en),oe.d(en,{GESTURE_CONTROLLER:()=>T.G,createGesture:()=>vt});var T=oe(4587);const b=(ht,et,xt,Kt)=>{const It=Lt(ht)?{capture:!!Kt.capture,passive:!!Kt.passive}:!!Kt.capture;let st,sn;return ht.__zone_symbol__addEventListener?(st="__zone_symbol__addEventListener",sn="__zone_symbol__removeEventListener"):(st="addEventListener",sn="removeEventListener"),ht[st](et,xt,It),()=>{ht[sn](et,xt,It)}},Lt=ht=>{if(void 0===l)try{const et=Object.defineProperty({},"passive",{get:()=>{l=!0}});ht.addEventListener("optsTest",()=>{},et)}catch{l=!1}return!!l};let l;const qe=ht=>ht instanceof Document?ht:ht.ownerDocument,vt=ht=>{let et=!1,xt=!1,Kt=!0,It=!1;const st=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},ht),sn=st.canStart,Tt=st.onWillStart,Ge=st.onStart,Le=st.onEnd,Yt=st.notCaptured,_n=st.onMove,De=st.threshold,ft=st.passive,Nt=st.blurOnStart,yt={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},mn=((ht,et,xt)=>{const Kt=xt*(Math.PI/180),It="x"===ht,st=Math.cos(Kt),sn=et*et;let Tt=0,Ge=0,Le=!1,Yt=0;return{start(_n,De){Tt=_n,Ge=De,Yt=0,Le=!0},detect(_n,De){if(!Le)return!1;const ft=_n-Tt,Nt=De-Ge,yt=ft*ft+Nt*Nt;if(yt<sn)return!1;const mn=Math.sqrt(yt),hn=(It?ft:Nt)/mn;return Yt=hn>st?1:hn<-st?-1:0,Le=!1,!0},isGesture:()=>0!==Yt,getDirection:()=>Yt}})(st.direction,st.threshold,st.maxAngle),hn=T.G.createGesture({name:ht.gestureName,priority:ht.gesturePriority,disableScroll:ht.disableScroll}),Wt=()=>{et&&(It=!1,_n&&_n(yt))},pr=()=>!!hn.capture()&&(et=!0,Kt=!1,yt.startX=yt.currentX,yt.startY=yt.currentY,yt.startTime=yt.currentTime,Tt?Tt(yt).then(Me):Me(),!0),Me=()=>{Nt&&(()=>{if(typeof document<"u"){const un=document.activeElement;un?.blur&&un.blur()}})(),Ge&&Ge(yt),Kt=!0},Ue=()=>{et=!1,xt=!1,It=!1,Kt=!0,hn.release()},at=un=>{const Qn=et,ur=Kt;if(Ue(),ur){if(tt(yt,un),Qn)return void(Le&&Le(yt));Yt&&Yt(yt)}},Rt=((ht,et,xt,Kt,It)=>{let st,sn,Tt,Ge,Le,Yt,_n,De=0;const ft=an=>{De=Date.now()+2e3,et(an)&&(!sn&&xt&&(sn=b(ht,"touchmove",xt,It)),Tt||(Tt=b(an.target,"touchend",yt,It)),Ge||(Ge=b(an.target,"touchcancel",yt,It)))},Nt=an=>{De>Date.now()||et(an)&&(!Yt&&xt&&(Yt=b(qe(ht),"mousemove",xt,It)),_n||(_n=b(qe(ht),"mouseup",mn,It)))},yt=an=>{hn(),Kt&&Kt(an)},mn=an=>{Gt(),Kt&&Kt(an)},hn=()=>{sn&&sn(),Tt&&Tt(),Ge&&Ge(),sn=Tt=Ge=void 0},Gt=()=>{Yt&&Yt(),_n&&_n(),Yt=_n=void 0},nr=()=>{hn(),Gt()},Wt=(an=!0)=>{an?(st||(st=b(ht,"touchstart",ft,It)),Le||(Le=b(ht,"mousedown",Nt,It))):(st&&st(),Le&&Le(),st=Le=void 0,nr())};return{enable:Wt,stop:nr,destroy:()=>{Wt(!1),Kt=xt=et=void 0}}})(st.el,un=>{const Qn=wt(un);return!(xt||!Kt||(nt(un,yt),yt.startX=yt.currentX,yt.startY=yt.currentY,yt.startTime=yt.currentTime=Qn,yt.velocityX=yt.velocityY=yt.deltaX=yt.deltaY=0,yt.event=un,sn&&!1===sn(yt))||(hn.release(),!hn.start()))&&(xt=!0,0===De?pr():(mn.start(yt.startX,yt.startY),!0))},un=>{et?!It&&Kt&&(It=!0,tt(yt,un),requestAnimationFrame(Wt)):(tt(yt,un),mn.detect(yt.currentX,yt.currentY)&&(!mn.isGesture()||!pr())&&cn())},at,{capture:!1,passive:ft}),cn=()=>{Ue(),Rt.stop(),Yt&&Yt(yt)};return{enable(un=!0){un||(et&&at(void 0),Ue()),Rt.enable(un)},destroy(){hn.destroy(),Rt.destroy()}}},tt=(ht,et)=>{if(!et)return;const xt=ht.currentX,Kt=ht.currentY,It=ht.currentTime;nt(et,ht);const st=ht.currentX,sn=ht.currentY,Ge=(ht.currentTime=wt(et))-It;if(Ge>0&&Ge<100){const Yt=(sn-Kt)/Ge;ht.velocityX=(st-xt)/Ge*.7+.3*ht.velocityX,ht.velocityY=.7*Yt+.3*ht.velocityY}ht.deltaX=st-ht.startX,ht.deltaY=sn-ht.startY,ht.event=et},nt=(ht,et)=>{let xt=0,Kt=0;if(ht){const It=ht.changedTouches;if(It&&It.length>0){const st=It[0];xt=st.clientX,Kt=st.clientY}else void 0!==ht.pageX&&(xt=ht.pageX,Kt=ht.pageY)}et.currentX=xt,et.currentY=Kt},wt=ht=>ht.timeStamp||Date.now()},1767:(fr,en,oe)=>{"use strict";oe.d(en,{m:()=>nt});var T=oe(5861),b=oe(5421),Lt=oe(544),l=oe(7876),Ee=oe(6506);const ot=wt=>(0,Ee.c)().duration(wt?400:300),qe=wt=>{let ht,et;const xt=wt.width+8,Kt=(0,Ee.c)(),It=(0,Ee.c)();wt.isEndSide?(ht=xt+"px",et="0px"):(ht=-xt+"px",et="0px"),Kt.addElement(wt.menuInnerEl).fromTo("transform",`translateX(${ht})`,`translateX(${et})`);const sn="ios"===(0,l.b)(wt),Tt=sn?.2:.25;return It.addElement(wt.backdropEl).fromTo("opacity",.01,Tt),ot(sn).addAnimation([Kt,It])},Et=wt=>{let ht,et;const xt=(0,l.b)(wt),Kt=wt.width;wt.isEndSide?(ht=-Kt+"px",et=Kt+"px"):(ht=Kt+"px",et=-Kt+"px");const It=(0,Ee.c)().addElement(wt.menuInnerEl).fromTo("transform",`translateX(${et})`,"translateX(0px)"),st=(0,Ee.c)().addElement(wt.contentEl).fromTo("transform","translateX(0px)",`translateX(${ht})`),sn=(0,Ee.c)().addElement(wt.backdropEl).fromTo("opacity",.01,.32);return ot("ios"===xt).addAnimation([It,st,sn])},vt=wt=>{const ht=(0,l.b)(wt),et=wt.width*(wt.isEndSide?-1:1)+"px",xt=(0,Ee.c)().addElement(wt.contentEl).fromTo("transform","translateX(0px)",`translateX(${et})`);return ot("ios"===ht).addAnimation(xt)},nt=(()=>{const wt=new Map,ht=[],et=function(){var Me=(0,T.Z)(function*(Ue){const at=yield Ge(Ue);return!!at&&at.open()});return function(at){return Me.apply(this,arguments)}}(),xt=function(){var Me=(0,T.Z)(function*(Ue){const at=yield void 0!==Ue?Ge(Ue):Le();return void 0!==at&&at.close()});return function(at){return Me.apply(this,arguments)}}(),Kt=function(){var Me=(0,T.Z)(function*(Ue){const at=yield Ge(Ue);return!!at&&at.toggle()});return function(at){return Me.apply(this,arguments)}}(),It=function(){var Me=(0,T.Z)(function*(Ue,at){const Rt=yield Ge(at);return Rt&&(Rt.disabled=!Ue),Rt});return function(at,Rt){return Me.apply(this,arguments)}}(),st=function(){var Me=(0,T.Z)(function*(Ue,at){const Rt=yield Ge(at);return Rt&&(Rt.swipeGesture=Ue),Rt});return function(at,Rt){return Me.apply(this,arguments)}}(),sn=function(){var Me=(0,T.Z)(function*(Ue){if(null!=Ue){const at=yield Ge(Ue);return void 0!==at&&at.isOpen()}return void 0!==(yield Le())});return function(at){return Me.apply(this,arguments)}}(),Tt=function(){var Me=(0,T.Z)(function*(Ue){const at=yield Ge(Ue);return!!at&&!at.disabled});return function(at){return Me.apply(this,arguments)}}(),Ge=function(){var Me=(0,T.Z)(function*(Ue){return yield an(),"start"===Ue||"end"===Ue?pr(cn=>cn.side===Ue&&!cn.disabled)||pr(cn=>cn.side===Ue):null!=Ue?pr(Rt=>Rt.menuId===Ue):pr(Rt=>!Rt.disabled)||(ht.length>0?ht[0].el:void 0)});return function(at){return Me.apply(this,arguments)}}(),Le=function(){var Me=(0,T.Z)(function*(){return yield an(),Gt()});return function(){return Me.apply(this,arguments)}}(),Yt=function(){var Me=(0,T.Z)(function*(){return yield an(),nr()});return function(){return Me.apply(this,arguments)}}(),_n=function(){var Me=(0,T.Z)(function*(){return yield an(),Wt()});return function(){return Me.apply(this,arguments)}}(),De=(Me,Ue)=>{wt.set(Me,Ue)},yt=Me=>{const Ue=Me.side;ht.filter(at=>at.side===Ue&&at!==Me).forEach(at=>at.disabled=!0)},mn=function(){var Me=(0,T.Z)(function*(Ue,at,Rt){if(Wt())return!1;if(at){const cn=yield Le();cn&&Ue.el!==cn&&(yield cn.setOpen(!1,!1))}return Ue._setOpen(at,Rt)});return function(at,Rt,cn){return Me.apply(this,arguments)}}(),Gt=()=>pr(Me=>Me._isOpen),nr=()=>ht.map(Me=>Me.el),Wt=()=>ht.some(Me=>Me.isAnimating),pr=Me=>{const Ue=ht.find(Me);if(void 0!==Ue)return Ue.el},an=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(Me=>new Promise(Ue=>(0,Lt.c)(Me,Ue))));return De("reveal",vt),De("push",Et),De("overlay",qe),typeof document<"u"&&document.addEventListener("ionBackButton",Me=>{const Ue=Gt();Ue&&Me.detail.register(b.MENU_BACK_BUTTON_PRIORITY,()=>Ue.close())}),{registerAnimation:De,get:Ge,getMenus:Yt,getOpen:Le,isEnabled:Tt,swipeGesture:st,isAnimating:_n,isOpen:sn,enable:It,toggle:Kt,close:xt,open:et,_getOpenSync:Gt,_createAnimation:(Me,Ue)=>{const at=wt.get(Me);if(!at)throw new Error("animation not registered");return at(Ue)},_register:Me=>{ht.indexOf(Me)<0&&(Me.disabled||yt(Me),ht.push(Me))},_unregister:Me=>{const Ue=ht.indexOf(Me);Ue>-1&&ht.splice(Ue,1)},_setOpen:mn,_setActiveMenu:yt}})()},8354:(fr,en,oe)=>{"use strict";oe.d(en,{L:()=>l,a:()=>Ee,b:()=>ot,c:()=>qe,d:()=>Et,e:()=>De,g:()=>yt,l:()=>Yt,s:()=>ft,t:()=>nt,w:()=>_n});var T=oe(5861),b=oe(6953),Lt=oe(544);const l="ionViewWillEnter",Ee="ionViewDidEnter",ot="ionViewWillLeave",qe="ionViewDidLeave",Et="ionViewWillUnload",nt=mn=>new Promise((hn,Gt)=>{(0,b.w)(()=>{wt(mn),ht(mn).then(nr=>{nr.animation&&nr.animation.destroy(),et(mn),hn(nr)},nr=>{et(mn),Gt(nr)})})}),wt=mn=>{const hn=mn.enteringEl,Gt=mn.leavingEl;Nt(hn,Gt,mn.direction),mn.showGoBack?hn.classList.add("can-go-back"):hn.classList.remove("can-go-back"),ft(hn,!1),hn.style.setProperty("pointer-events","none"),Gt&&(ft(Gt,!1),Gt.style.setProperty("pointer-events","none"))},ht=function(){var mn=(0,T.Z)(function*(hn){const Gt=yield xt(hn);return Gt&&b.B.isBrowser?Kt(Gt,hn):It(hn)});return function(Gt){return mn.apply(this,arguments)}}(),et=mn=>{const hn=mn.enteringEl,Gt=mn.leavingEl;hn.classList.remove("ion-page-invisible"),hn.style.removeProperty("pointer-events"),void 0!==Gt&&(Gt.classList.remove("ion-page-invisible"),Gt.style.removeProperty("pointer-events"))},xt=function(){var mn=(0,T.Z)(function*(hn){return hn.leavingEl&&hn.animated&&0!==hn.duration?hn.animationBuilder?hn.animationBuilder:"ios"===hn.mode?(yield Promise.resolve().then(oe.bind(oe,8899))).iosTransitionAnimation:(yield Promise.resolve().then(oe.bind(oe,5298))).mdTransitionAnimation:void 0});return function(Gt){return mn.apply(this,arguments)}}(),Kt=function(){var mn=(0,T.Z)(function*(hn,Gt){yield st(Gt,!0);const nr=hn(Gt.baseEl,Gt);Ge(Gt.enteringEl,Gt.leavingEl);const Wt=yield Tt(nr,Gt);return Gt.progressCallback&&Gt.progressCallback(void 0),Wt&&Le(Gt.enteringEl,Gt.leavingEl),{hasCompleted:Wt,animation:nr}});return function(Gt,nr){return mn.apply(this,arguments)}}(),It=function(){var mn=(0,T.Z)(function*(hn){const Gt=hn.enteringEl,nr=hn.leavingEl;return yield st(hn,!1),Ge(Gt,nr),Le(Gt,nr),{hasCompleted:!0}});return function(Gt){return mn.apply(this,arguments)}}(),st=function(){var mn=(0,T.Z)(function*(hn,Gt){(void 0!==hn.deepWait?hn.deepWait:Gt)&&(yield Promise.all([De(hn.enteringEl),De(hn.leavingEl)])),yield sn(hn.viewIsReady,hn.enteringEl)});return function(Gt,nr){return mn.apply(this,arguments)}}(),sn=function(){var mn=(0,T.Z)(function*(hn,Gt){hn&&(yield hn(Gt))});return function(Gt,nr){return mn.apply(this,arguments)}}(),Tt=(mn,hn)=>{const Gt=hn.progressCallback,nr=new Promise(Wt=>{mn.onFinish(pr=>Wt(1===pr))});return Gt?(mn.progressStart(!0),Gt(mn)):mn.play(),nr},Ge=(mn,hn)=>{Yt(hn,ot),Yt(mn,l)},Le=(mn,hn)=>{Yt(mn,Ee),Yt(hn,qe)},Yt=(mn,hn)=>{if(mn){const Gt=new CustomEvent(hn,{bubbles:!1,cancelable:!1});mn.dispatchEvent(Gt)}},_n=()=>new Promise(mn=>(0,Lt.r)(()=>(0,Lt.r)(()=>mn()))),De=function(){var mn=(0,T.Z)(function*(hn){const Gt=hn;if(Gt){if(null!=Gt.componentOnReady){if(null!=(yield Gt.componentOnReady()))return}else if(null!=Gt.__registerHost)return void(yield new Promise(Wt=>(0,Lt.r)(Wt)));yield Promise.all(Array.from(Gt.children).map(De))}});return function(Gt){return mn.apply(this,arguments)}}(),ft=(mn,hn)=>{hn?(mn.setAttribute("aria-hidden","true"),mn.classList.add("ion-page-hidden")):(mn.hidden=!1,mn.removeAttribute("aria-hidden"),mn.classList.remove("ion-page-hidden"))},Nt=(mn,hn,Gt)=>{void 0!==mn&&(mn.style.zIndex="back"===Gt?"99":"101"),void 0!==hn&&(hn.style.zIndex="100")},yt=mn=>mn.classList.contains("ion-page")?mn:mn.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||mn},7643:(fr,en,oe)=>{"use strict";oe.d(en,{d:()=>b,w:()=>T});const T=typeof window<"u"?window:void 0,b=typeof document<"u"?document:void 0},7690:(fr,en,oe)=>{"use strict";oe.d(en,{a:()=>b,b:()=>Lt,p:()=>T});const T=(l,...Ee)=>console.warn(`[Ionic Warning]: ${l}`,...Ee),b=(l,...Ee)=>console.error(`[Ionic Error]: ${l}`,...Ee),Lt=(l,...Ee)=>console.error(`<${l.tagName.toLowerCase()}> must be used inside ${Ee.join(" or ")}.`)},7876:(fr,en,oe)=>{"use strict";oe.d(en,{a:()=>nt,b:()=>Wt,c:()=>Lt,g:()=>tt,i:()=>pr});var T=oe(6953);class b{constructor(){this.m=new Map}reset(Me){this.m=new Map(Object.entries(Me))}get(Me,Ue){const at=this.m.get(Me);return void 0!==at?at:Ue}getBoolean(Me,Ue=!1){const at=this.m.get(Me);return void 0===at?Ue:"string"==typeof at?"true"===at:!!at}getNumber(Me,Ue){const at=parseFloat(this.m.get(Me));return isNaN(at)?void 0!==Ue?Ue:NaN:at}set(Me,Ue){this.m.set(Me,Ue)}}const Lt=new b,vt="ionic-persist-config",tt=an=>wt(an),nt=(an,Me)=>("string"==typeof an&&(Me=an,an=void 0),tt(an).includes(Me)),wt=(an=window)=>{if(typeof an>"u")return[];an.Ionic=an.Ionic||{};let Me=an.Ionic.platforms;return null==Me&&(Me=an.Ionic.platforms=ht(an),Me.forEach(Ue=>an.document.documentElement.classList.add(`plt-${Ue}`))),Me},ht=an=>{const Me=Lt.get("platform");return Object.keys(Gt).filter(Ue=>{const at=Me?.[Ue];return"function"==typeof at?at(an):Gt[Ue](an)})},xt=an=>!!(mn(an,/iPad/i)||mn(an,/Macintosh/i)&&Le(an)),st=an=>mn(an,/android|sink/i),Le=an=>hn(an,"(any-pointer:coarse)"),_n=an=>De(an)||ft(an),De=an=>!!(an.cordova||an.phonegap||an.PhoneGap),ft=an=>{const Me=an.Capacitor;return!!Me?.isNative},mn=(an,Me)=>Me.test(an.navigator.userAgent),hn=(an,Me)=>{var Ue;return null===(Ue=an.matchMedia)||void 0===Ue?void 0:Ue.call(an,Me).matches},Gt={ipad:xt,iphone:an=>mn(an,/iPhone/i),ios:an=>mn(an,/iPhone|iPod/i)||xt(an),android:st,phablet:an=>{const Me=an.innerWidth,Ue=an.innerHeight,at=Math.min(Me,Ue),Rt=Math.max(Me,Ue);return at>390&&at<520&&Rt>620&&Rt<800},tablet:an=>{const Me=an.innerWidth,Ue=an.innerHeight,at=Math.min(Me,Ue),Rt=Math.max(Me,Ue);return xt(an)||(an=>st(an)&&!mn(an,/mobile/i))(an)||at>460&&at<820&&Rt>780&&Rt<1400},cordova:De,capacitor:ft,electron:an=>mn(an,/electron/i),pwa:an=>{var Me;return!!(null!==(Me=an.matchMedia)&&void 0!==Me&&Me.call(an,"(display-mode: standalone)").matches||an.navigator.standalone)},mobile:Le,mobileweb:an=>Le(an)&&!_n(an),desktop:an=>!Le(an),hybrid:_n};let nr;const Wt=an=>an&&(0,T.g)(an)||nr,pr=(an={})=>{if(typeof window>"u")return;const Me=window.document,Ue=window,at=Ue.Ionic=Ue.Ionic||{},Rt={};an._ael&&(Rt.ael=an._ael),an._rel&&(Rt.rel=an._rel),an._ce&&(Rt.ce=an._ce),(0,T.a)(Rt);const cn=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(an=>{try{const Me=an.sessionStorage.getItem(vt);return null!==Me?JSON.parse(Me):{}}catch{return{}}})(Ue)),{persistConfig:!1}),at.config),(an=>{const Me={};return an.location.search.slice(1).split("&").map(Ue=>Ue.split("=")).map(([Ue,at])=>[decodeURIComponent(Ue),decodeURIComponent(at)]).filter(([Ue])=>((an,Me)=>an.substr(0,Me.length)===Me)(Ue,"ionic:")).map(([Ue,at])=>[Ue.slice(6),at]).forEach(([Ue,at])=>{Me[Ue]=at}),Me})(Ue)),an);Lt.reset(cn),Lt.getBoolean("persistConfig")&&((an,Me)=>{try{an.sessionStorage.setItem(vt,JSON.stringify(Me))}catch{return}})(Ue,cn),wt(Ue),at.config=Lt,at.mode=nr=Lt.get("mode",Me.documentElement.getAttribute("mode")||(nt(Ue,"ios")?"ios":"md")),Lt.set("mode",nr),Me.documentElement.setAttribute("mode",nr),Me.documentElement.classList.add(nr),Lt.getBoolean("_testing")&&Lt.set("animated",!1);const un=ur=>{var Mn;return null===(Mn=ur.tagName)||void 0===Mn?void 0:Mn.startsWith("ION-")},Qn=ur=>["ios","md"].includes(ur);(0,T.c)(ur=>{for(;ur;){const Mn=ur.mode||ur.getAttribute("mode");if(Mn){if(Qn(Mn))return Mn;un(ur)&&console.warn('Invalid ionic mode: "'+Mn+'", expected: "ios" or "md"')}ur=ur.parentElement}return nr})}},8899:(fr,en,oe)=>{"use strict";oe.r(en),oe.d(en,{iosTransitionAnimation:()=>ht,shadow:()=>qe});var T=oe(6506),b=oe(8354);oe(7643),oe(6953);const ot=et=>document.querySelector(`${et}.ion-cloned-element`),qe=et=>et.shadowRoot||et,Et=et=>{const xt="ION-TABS"===et.tagName?et:et.querySelector("ion-tabs"),Kt="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=xt){const It=xt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=It?It.querySelector(Kt):null}return et.querySelector(Kt)},vt=(et,xt)=>{const Kt="ION-TABS"===et.tagName?et:et.querySelector("ion-tabs");let It=[];if(null!=Kt){const st=Kt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=st&&(It=st.querySelectorAll("ion-buttons"))}else It=et.querySelectorAll("ion-buttons");for(const st of It){const sn=st.closest("ion-header"),Tt=sn&&!sn.classList.contains("header-collapse-condense-inactive"),Ge=st.querySelector("ion-back-button"),Le=st.classList.contains("buttons-collapse");if(null!==Ge&&("start"===st.slot||""===st.slot)&&(Le&&Tt&&xt||!Le))return Ge}return null},nt=(et,xt,Kt,It,st,sn)=>{const Tt=xt?`calc(100% - ${sn.right+4}px)`:sn.left-4+"px",Ge=xt?"7px":"-7px",Le=xt?"-4px":"4px",Yt=xt?"-4px":"4px",_n=xt?"right":"left",De=xt?"left":"right",yt=Kt?[{offset:0,opacity:1,transform:`translate3d(${Le}, ${sn.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Ge}, ${st.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Ge}, ${st.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${Le}, ${sn.top-46}px, 0) scale(1)`}],Gt=Kt?[{offset:0,opacity:1,transform:`translate3d(${Yt}, ${sn.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${Yt}, ${sn.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${Yt}, ${sn.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${Yt}, ${sn.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${Yt}, ${sn.top-46}px, 0) scale(1)`}],nr=(0,T.c)(),Wt=(0,T.c)(),pr=ot("ion-back-button"),an=qe(pr).querySelector(".button-text"),Me=qe(pr).querySelector("ion-icon");pr.text=It.text,pr.mode=It.mode,pr.icon=It.icon,pr.color=It.color,pr.disabled=It.disabled,pr.style.setProperty("display","block"),pr.style.setProperty("position","fixed"),Wt.addElement(Me),nr.addElement(an),nr.beforeStyles({"transform-origin":`${_n} center`}).beforeAddWrite(()=>{It.style.setProperty("display","none"),pr.style.setProperty(_n,Tt)}).afterAddWrite(()=>{It.style.setProperty("display",""),pr.style.setProperty("display","none"),pr.style.removeProperty(_n)}).keyframes(yt),Wt.beforeStyles({"transform-origin":`${De} center`}).keyframes(Gt),et.addAnimation([nr,Wt])},wt=(et,xt,Kt,It,st,sn)=>{const Tt=xt?`calc(100% - ${st.right}px)`:`${st.left}px`,Ge=xt?"-18px":"18px",Le=xt?"right":"left",De=Kt?[{offset:0,opacity:0,transform:`translate3d(${Ge}, ${sn.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${st.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${st.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Ge}, ${sn.top-4}px, 0) scale(0.5)`}],ft=ot("ion-title"),Nt=(0,T.c)();ft.innerText=It.innerText,ft.size=It.size,ft.color=It.color,Nt.addElement(ft),Nt.beforeStyles({"transform-origin":`${Le} center`,height:"46px",display:"",position:"relative",[Le]:Tt}).beforeAddWrite(()=>{It.style.setProperty("display","none")}).afterAddWrite(()=>{It.style.setProperty("display",""),ft.style.setProperty("display","none")}).keyframes(De),et.addAnimation(Nt)},ht=(et,xt)=>{var Kt;try{const It="cubic-bezier(0.32,0.72,0,1)",st="opacity",sn="transform",Tt="0%",Le="rtl"===et.ownerDocument.dir,Yt=Le?"-99.5%":"99.5%",_n=Le?"33%":"-33%",De=xt.enteringEl,ft=xt.leavingEl,Nt="back"===xt.direction,yt=De.querySelector(":scope > ion-content"),mn=De.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),hn=De.querySelectorAll(":scope > ion-header > ion-toolbar"),Gt=(0,T.c)(),nr=(0,T.c)();if(Gt.addElement(De).duration((null!==(Kt=xt.duration)&&void 0!==Kt?Kt:0)||540).easing(xt.easing||It).fill("both").beforeRemoveClass("ion-page-invisible"),ft&&null!=et){const Me=(0,T.c)();Me.addElement(et),Gt.addAnimation(Me)}if(yt||0!==hn.length||0!==mn.length?(nr.addElement(yt),nr.addElement(mn)):nr.addElement(De.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Gt.addAnimation(nr),Nt?nr.beforeClearStyles([st]).fromTo("transform",`translateX(${_n})`,`translateX(${Tt})`).fromTo(st,.8,1):nr.beforeClearStyles([st]).fromTo("transform",`translateX(${Yt})`,`translateX(${Tt})`),yt){const Me=qe(yt).querySelector(".transition-effect");if(Me){const Ue=Me.querySelector(".transition-cover"),at=Me.querySelector(".transition-shadow"),Rt=(0,T.c)(),cn=(0,T.c)(),un=(0,T.c)();Rt.addElement(Me).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),cn.addElement(Ue).beforeClearStyles([st]).fromTo(st,0,.1),un.addElement(at).beforeClearStyles([st]).fromTo(st,.03,.7),Rt.addAnimation([cn,un]),nr.addAnimation([Rt])}}const Wt=De.querySelector("ion-header.header-collapse-condense"),{forward:pr,backward:an}=((et,xt,Kt,It,st)=>{const sn=vt(It,Kt),Tt=Et(st),Ge=Et(It),Le=vt(st,Kt),Yt=null!==sn&&null!==Tt&&!Kt,_n=null!==Ge&&null!==Le&&Kt;if(Yt){const De=Tt.getBoundingClientRect(),ft=sn.getBoundingClientRect();wt(et,xt,Kt,Tt,De,ft),nt(et,xt,Kt,sn,De,ft)}else if(_n){const De=Ge.getBoundingClientRect(),ft=Le.getBoundingClientRect();wt(et,xt,Kt,Ge,De,ft),nt(et,xt,Kt,Le,De,ft)}return{forward:Yt,backward:_n}})(Gt,Le,Nt,De,ft);if(hn.forEach(Me=>{const Ue=(0,T.c)();Ue.addElement(Me),Gt.addAnimation(Ue);const at=(0,T.c)();at.addElement(Me.querySelector("ion-title"));const Rt=(0,T.c)(),cn=Array.from(Me.querySelectorAll("ion-buttons,[menuToggle]")),un=Me.closest("ion-header"),Qn=un?.classList.contains("header-collapse-condense-inactive");let ur;ur=cn.filter(Nt?vn=>{const Gn=vn.classList.contains("buttons-collapse");return Gn&&!Qn||!Gn}:vn=>!vn.classList.contains("buttons-collapse")),Rt.addElement(ur);const Mn=(0,T.c)();Mn.addElement(Me.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const Ot=(0,T.c)();Ot.addElement(qe(Me).querySelector(".toolbar-background"));const qt=(0,T.c)(),$t=Me.querySelector("ion-back-button");if($t&&qt.addElement($t),Ue.addAnimation([at,Rt,Mn,Ot,qt]),Rt.fromTo(st,.01,1),Mn.fromTo(st,.01,1),Nt)Qn||at.fromTo("transform",`translateX(${_n})`,`translateX(${Tt})`).fromTo(st,.01,1),Mn.fromTo("transform",`translateX(${_n})`,`translateX(${Tt})`),qt.fromTo(st,.01,1);else if(Wt||at.fromTo("transform",`translateX(${Yt})`,`translateX(${Tt})`).fromTo(st,.01,1),Mn.fromTo("transform",`translateX(${Yt})`,`translateX(${Tt})`),Ot.beforeClearStyles([st,"transform"]),un?.translucent?Ot.fromTo("transform",Le?"translateX(-100%)":"translateX(100%)","translateX(0px)"):Ot.fromTo(st,.01,"var(--opacity)"),pr||qt.fromTo(st,.01,1),$t&&!pr){const Gn=(0,T.c)();Gn.addElement(qe($t).querySelector(".button-text")).fromTo("transform",Le?"translateX(-100px)":"translateX(100px)","translateX(0px)"),Ue.addAnimation(Gn)}}),ft){const Me=(0,T.c)(),Ue=ft.querySelector(":scope > ion-content"),at=ft.querySelectorAll(":scope > ion-header > ion-toolbar"),Rt=ft.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(Ue||0!==at.length||0!==Rt.length?(Me.addElement(Ue),Me.addElement(Rt)):Me.addElement(ft.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Gt.addAnimation(Me),Nt){Me.beforeClearStyles([st]).fromTo("transform",`translateX(${Tt})`,Le?"translateX(-100%)":"translateX(100%)");const cn=(0,b.g)(ft);Gt.afterAddWrite(()=>{"normal"===Gt.getDirection()&&cn.style.setProperty("display","none")})}else Me.fromTo("transform",`translateX(${Tt})`,`translateX(${_n})`).fromTo(st,1,.8);if(Ue){const cn=qe(Ue).querySelector(".transition-effect");if(cn){const un=cn.querySelector(".transition-cover"),Qn=cn.querySelector(".transition-shadow"),ur=(0,T.c)(),Mn=(0,T.c)(),Ot=(0,T.c)();ur.addElement(cn).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Mn.addElement(un).beforeClearStyles([st]).fromTo(st,.1,0),Ot.addElement(Qn).beforeClearStyles([st]).fromTo(st,.7,.03),ur.addAnimation([Mn,Ot]),Me.addAnimation([ur])}}at.forEach(cn=>{const un=(0,T.c)();un.addElement(cn);const Qn=(0,T.c)();Qn.addElement(cn.querySelector("ion-title"));const ur=(0,T.c)(),Mn=cn.querySelectorAll("ion-buttons,[menuToggle]"),Ot=cn.closest("ion-header"),qt=Ot?.classList.contains("header-collapse-condense-inactive"),$t=Array.from(Mn).filter(er=>{const kr=er.classList.contains("buttons-collapse");return kr&&!qt||!kr});ur.addElement($t);const vn=(0,T.c)(),Gn=cn.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");Gn.length>0&&vn.addElement(Gn);const Cr=(0,T.c)();Cr.addElement(qe(cn).querySelector(".toolbar-background"));const Wn=(0,T.c)(),Dr=cn.querySelector("ion-back-button");if(Dr&&Wn.addElement(Dr),un.addAnimation([Qn,ur,vn,Wn,Cr]),Gt.addAnimation(un),Wn.fromTo(st,.99,0),ur.fromTo(st,.99,0),vn.fromTo(st,.99,0),Nt){if(qt||Qn.fromTo("transform",`translateX(${Tt})`,Le?"translateX(-100%)":"translateX(100%)").fromTo(st,.99,0),vn.fromTo("transform",`translateX(${Tt})`,Le?"translateX(-100%)":"translateX(100%)"),Cr.beforeClearStyles([st,"transform"]),Ot?.translucent?Cr.fromTo("transform","translateX(0px)",Le?"translateX(-100%)":"translateX(100%)"):Cr.fromTo(st,"var(--opacity)",0),Dr&&!an){const kr=(0,T.c)();kr.addElement(qe(Dr).querySelector(".button-text")).fromTo("transform",`translateX(${Tt})`,`translateX(${(Le?-124:124)+"px"})`),un.addAnimation(kr)}}else qt||Qn.fromTo("transform",`translateX(${Tt})`,`translateX(${_n})`).fromTo(st,.99,0).afterClearStyles([sn,st]),vn.fromTo("transform",`translateX(${Tt})`,`translateX(${_n})`).afterClearStyles([sn,st]),Wn.afterClearStyles([st]),Qn.afterClearStyles([st]),ur.afterClearStyles([st])})}return Gt}catch(It){throw It}}},5298:(fr,en,oe)=>{"use strict";oe.r(en),oe.d(en,{mdTransitionAnimation:()=>Ee});var T=oe(6506),b=oe(8354);oe(7643),oe(6953);const Ee=(ot,qe)=>{var Et,vt,tt;const ht="back"===qe.direction,xt=qe.leavingEl,Kt=(0,b.g)(qe.enteringEl),It=Kt.querySelector("ion-toolbar"),st=(0,T.c)();if(st.addElement(Kt).fill("both").beforeRemoveClass("ion-page-invisible"),ht?st.duration((null!==(Et=qe.duration)&&void 0!==Et?Et:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):st.duration((null!==(vt=qe.duration)&&void 0!==vt?vt:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),It){const sn=(0,T.c)();sn.addElement(It),st.addAnimation(sn)}if(xt&&ht){st.duration((null!==(tt=qe.duration)&&void 0!==tt?tt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const sn=(0,T.c)();sn.addElement((0,b.g)(xt)).onFinish(Tt=>{1===Tt&&sn.elements.length>0&&sn.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),st.addAnimation(sn)}return st}},8946:(fr,en,oe)=>{"use strict";oe.d(en,{B:()=>un,G:()=>Qn,a:()=>nt,b:()=>wt,c:()=>Kt,d:()=>ur,e:()=>Mn,f:()=>Gt,g:()=>Wt,h:()=>Me,i:()=>at,j:()=>st,k:()=>sn,m:()=>et,n:()=>vt,o:()=>Le,q:()=>mn,s:()=>cn,t:()=>It});var T=oe(5861),b=oe(7876),Lt=oe(9439),l=oe(5421),Ee=oe(544),ot=oe(7690);let qe=0,Et=0;const vt=new WeakMap,tt=Ot=>({create:qt=>Tt(Ot,qt),dismiss:(qt,$t,vn)=>Nt(document,qt,$t,Ot,vn),getTop:()=>(0,T.Z)(function*(){return mn(document,Ot)})()}),nt=tt("ion-alert"),wt=tt("ion-action-sheet"),et=tt("ion-modal"),Kt=tt("ion-popover"),It=tt("ion-toast"),st=Ot=>{typeof document<"u"&&ft(document);const qt=qe++;Ot.overlayIndex=qt},sn=Ot=>(Ot.hasAttribute("id")||(Ot.id="ion-overlay-"+ ++Et),Ot.id),Tt=(Ot,qt)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(Ot).then(()=>{const $t=document.createElement(Ot);return $t.classList.add("overlay-hidden"),Object.assign($t,Object.assign(Object.assign({},qt),{hasController:!0})),pr(document).appendChild($t),new Promise(vn=>(0,Ee.c)($t,vn))}):Promise.resolve(),Ge='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Le=(Ot,qt)=>{let $t=Ot.querySelector(Ge);const vn=$t?.shadowRoot;vn&&($t=vn.querySelector(Ge)||$t),$t?(0,Ee.f)($t):qt.focus()},_n=(Ot,qt)=>{const $t=Array.from(Ot.querySelectorAll(Ge));let vn=$t.length>0?$t[$t.length-1]:null;const Gn=vn?.shadowRoot;Gn&&(vn=Gn.querySelector(Ge)||vn),vn?vn.focus():qt.focus()},ft=Ot=>{0===qe&&(qe=1,Ot.addEventListener("focus",qt=>{((Ot,qt)=>{const $t=mn(qt,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),vn=Ot.target;$t&&vn&&!$t.classList.contains("ion-disable-focus-trap")&&($t.shadowRoot?(()=>{if($t.contains(vn))$t.lastFocus=vn;else{const Wn=$t.lastFocus;Le($t,$t),Wn===qt.activeElement&&_n($t,$t),$t.lastFocus=qt.activeElement}})():(()=>{if($t===vn)$t.lastFocus=void 0;else{const Wn=(0,Ee.g)($t);if(!Wn.contains(vn))return;const Dr=Wn.querySelector(".ion-overlay-wrapper");if(!Dr)return;if(Dr.contains(vn)||vn===Wn.querySelector("ion-backdrop"))$t.lastFocus=vn;else{const er=$t.lastFocus;Le(Dr,$t),er===qt.activeElement&&_n(Dr,$t),$t.lastFocus=qt.activeElement}}})())})(qt,Ot)},!0),Ot.addEventListener("ionBackButton",qt=>{const $t=mn(Ot);$t?.backdropDismiss&&qt.detail.register(l.OVERLAY_BACK_BUTTON_PRIORITY,()=>$t.dismiss(void 0,un))}),Ot.addEventListener("keydown",qt=>{if("Escape"===qt.key){const $t=mn(Ot);$t?.backdropDismiss&&$t.dismiss(void 0,un)}}))},Nt=(Ot,qt,$t,vn,Gn)=>{const Cr=mn(Ot,vn,Gn);return Cr?Cr.dismiss(qt,$t):Promise.reject("overlay does not exist")},mn=(Ot,qt,$t)=>{const vn=((Ot,qt)=>(void 0===qt&&(qt="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(Ot.querySelectorAll(qt)).filter($t=>$t.overlayIndex>0)))(Ot,qt).filter(Gn=>!(Ot=>Ot.classList.contains("overlay-hidden"))(Gn));return void 0===$t?vn[vn.length-1]:vn.find(Gn=>Gn.id===$t)},hn=(Ot=!1)=>{const $t=pr(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");$t&&(Ot?$t.setAttribute("aria-hidden","true"):$t.removeAttribute("aria-hidden"))},Gt=function(){var Ot=(0,T.Z)(function*(qt,$t,vn,Gn,Cr){var Wn,Dr;if(qt.presented)return;hn(!0),qt.presented=!0,qt.willPresent.emit(),null===(Wn=qt.willPresentShorthand)||void 0===Wn||Wn.emit();const er=(0,b.b)(qt),kr=qt.enterAnimation?qt.enterAnimation:b.c.get($t,"ios"===er?vn:Gn);(yield an(qt,kr,qt.el,Cr))&&(qt.didPresent.emit(),null===(Dr=qt.didPresentShorthand)||void 0===Dr||Dr.emit()),"ION-TOAST"!==qt.el.tagName&&nr(qt.el),qt.keyboardClose&&(null===document.activeElement||!qt.el.contains(document.activeElement))&&qt.el.focus()});return function($t,vn,Gn,Cr,Wn){return Ot.apply(this,arguments)}}(),nr=function(){var Ot=(0,T.Z)(function*(qt){let $t=document.activeElement;if(!$t)return;const vn=$t?.shadowRoot;vn&&($t=vn.querySelector(Ge)||$t),yield qt.onDidDismiss(),$t.focus()});return function($t){return Ot.apply(this,arguments)}}(),Wt=function(){var Ot=(0,T.Z)(function*(qt,$t,vn,Gn,Cr,Wn,Dr){var er,kr;if(!qt.presented)return!1;hn(!1),qt.presented=!1;try{qt.el.style.setProperty("pointer-events","none"),qt.willDismiss.emit({data:$t,role:vn}),null===(er=qt.willDismissShorthand)||void 0===er||er.emit({data:$t,role:vn});const An=(0,b.b)(qt),vi=qt.leaveAnimation?qt.leaveAnimation:b.c.get(Gn,"ios"===An?Cr:Wn);vn!==Qn&&(yield an(qt,vi,qt.el,Dr)),qt.didDismiss.emit({data:$t,role:vn}),null===(kr=qt.didDismissShorthand)||void 0===kr||kr.emit({data:$t,role:vn}),vt.delete(qt),qt.el.classList.add("overlay-hidden"),qt.el.style.removeProperty("pointer-events"),void 0!==qt.el.lastFocus&&(qt.el.lastFocus=void 0)}catch(An){console.error(An)}return qt.el.remove(),!0});return function($t,vn,Gn,Cr,Wn,Dr,er){return Ot.apply(this,arguments)}}(),pr=Ot=>Ot.querySelector("ion-app")||Ot.body,an=function(){var Ot=(0,T.Z)(function*(qt,$t,vn,Gn){vn.classList.remove("overlay-hidden");const Wn=$t(qt.el,Gn);(!qt.animated||!b.c.getBoolean("animated",!0))&&Wn.duration(0),qt.keyboardClose&&Wn.beforeAddWrite(()=>{const er=vn.ownerDocument.activeElement;er?.matches("input,ion-input, ion-textarea")&&er.blur()});const Dr=vt.get(qt)||[];return vt.set(qt,[...Dr,Wn]),yield Wn.play(),!0});return function($t,vn,Gn,Cr){return Ot.apply(this,arguments)}}(),Me=(Ot,qt)=>{let $t;const vn=new Promise(Gn=>$t=Gn);return Ue(Ot,qt,Gn=>{$t(Gn.detail)}),vn},Ue=(Ot,qt,$t)=>{const vn=Gn=>{(0,Ee.b)(Ot,qt,vn),$t(Gn)};(0,Ee.a)(Ot,qt,vn)},at=Ot=>"cancel"===Ot||Ot===un,Rt=Ot=>Ot(),cn=(Ot,qt)=>{if("function"==typeof Ot)return b.c.get("_zoneGate",Rt)(()=>{try{return Ot(qt)}catch(vn){throw vn}})},un="backdrop",Qn="gesture",ur=Ot=>{let $t,qt=!1;const vn=(0,Lt.C)(),Gn=(Dr=!1)=>{if($t&&!Dr)return{delegate:$t,inline:qt};const{el:er,hasController:kr,delegate:An}=Ot;return qt=null!==er.parentNode&&!kr,$t=qt?An||vn:An,{inline:qt,delegate:$t}};return{attachViewToDom:function(){var Dr=(0,T.Z)(function*(er){const{delegate:kr}=Gn(!0);if(kr)return yield kr.attachViewToDom(Ot.el,er);const{hasController:An}=Ot;if(An&&void 0!==er)throw new Error("framework delegate is missing");return null});return function(kr){return Dr.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:Dr}=Gn();Dr&&void 0!==Ot.el&&Dr.removeViewFromDom(Ot.el.parentElement,Ot.el)}}},Mn=()=>{let Ot;const qt=()=>{Ot&&(Ot(),Ot=void 0)};return{addClickListener:(vn,Gn)=>{qt();const Cr=void 0!==Gn?document.getElementById(Gn):null;Cr?Ot=((Dr,er)=>{const kr=()=>{er.present()};return Dr.addEventListener("click",kr),()=>{Dr.removeEventListener("click",kr)}})(Cr,vn):(0,ot.p)(`A trigger element with the ID "${Gn}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,vn)},removeClickListener:qt}}},5882:(fr,en,oe)=>{"use strict";oe.d(en,{l:()=>ot});var T=oe(9862),b=oe(9397),Lt=oe(6306),l=oe(2096),Ee=oe(9468);let ot=(()=>{var qe;class Et{constructor(tt){this.http=tt,this.URL="https://nancyb3a.github.io/Test_/usuarios_PGY4121_08.json",this.httpHeader={headers:new T.WM({"Content-Type":"application/json","Access-Control-Allow-Origin":"*"})}}getUser(tt){return this.http.get(`${this.URL}`+tt).pipe((0,b.b)(nt=>console.log(`User fetched: ${tt}`)),(0,Lt.K)(this.handleError(`Get user id=${tt}`)))}getUserList(){return this.http.get(`${this.URL}`).pipe((0,b.b)(tt=>console.log("User fetched!")),(0,Lt.K)(this.handleError("Get user",[])))}handleError(tt="operation",nt){return wt=>(console.error(wt),console.log(`${tt} failed: ${wt.message}`),(0,l.of)(nt))}}return(qe=Et).\u0275fac=function(tt){return new(tt||qe)(Ee.LFG(T.eN))},qe.\u0275prov=Ee.Yz7({token:qe,factory:qe.\u0275fac,providedIn:"root"}),Et})()},5048:(fr,en,oe)=>{"use strict";var T=oe(6593),b=oe(9468),Lt=oe(3874),l=oe(7852);let Ee=(()=>{var ce;class M{constructor(){}}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275cmp=b.Xpm({type:ce,selectors:[["app-root"]],decls:2,vars:0,template:function(G,ue){1&G&&(b.TgZ(0,"ion-app"),b._UZ(1,"ion-router-outlet"),b.qZA())},dependencies:[l.dr,l.jP]}),M})(),ot=(()=>{var ce;class M{constructor(){this.navCTRL=(0,b.tBr)(l.SH)}canActivate(G,ue){return!!localStorage.getItem("ingresado")||(this.navCTRL.navigateRoot("login"),!1)}}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275prov=b.Yz7({token:ce,factory:ce.\u0275fac,providedIn:"root"}),M})();const Et=[{path:"home",loadChildren:()=>oe.e(5489).then(oe.bind(oe,5489)).then(ce=>ce.HomePageModule),canActivate:[ot]},{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadChildren:()=>oe.e(6488).then(oe.bind(oe,6488)).then(ce=>ce.LoginPageModule),canActivate:[(()=>{var ce;class M{constructor(){this.navCTRL=(0,b.f3M)(l.SH)}canActivate(G,ue){return!localStorage.getItem("ingresado")||(this.navCTRL.navigateRoot("home"),!1)}}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275prov=b.Yz7({token:ce,factory:ce.\u0275fac,providedIn:"root"}),M})()]},{path:"historial",loadChildren:()=>oe.e(3030).then(oe.bind(oe,3030)).then(ce=>ce.HistorialPageModule),canActivate:[ot]},{path:"perfil",loadChildren:()=>oe.e(3147).then(oe.bind(oe,3147)).then(ce=>ce.PerfilPageModule),canActivate:[ot]},{path:"mapa-x",loadChildren:()=>oe.e(5001).then(oe.bind(oe,5001)).then(ce=>ce.MapaXPageModule),canActivate:[ot]},{path:"config",loadChildren:()=>oe.e(6305).then(oe.bind(oe,6305)).then(ce=>ce.ConfigPageModule),canActivate:[ot]},{path:"**",loadChildren:()=>oe.e(1123).then(oe.bind(oe,1123)).then(ce=>ce.NotfoundPageModule),canActivate:[ot]}];let vt=(()=>{var ce;class M{}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275mod=b.oAB({type:ce}),ce.\u0275inj=b.cJS({imports:[Lt.Bz.forRoot(Et,{preloadingStrategy:Lt.wm}),Lt.Bz]}),M})();var tt=oe(6825);function wt(ce){return new b.vHH(3e3,!1)}function Gn(ce){switch(ce.length){case 0:return new tt.ZN;case 1:return ce[0];default:return new tt.ZE(ce)}}function Cr(ce,M,F=new Map,G=new Map){const ue=[],Ce=[];let ct=-1,ut=null;if(M.forEach(Qt=>{const Dn=Qt.get("offset"),Er=Dn==ct,ar=Er&&ut||new Map;Qt.forEach((Ei,ui)=>{let Jr=ui,pi=Ei;if("offset"!==ui)switch(Jr=ce.normalizePropertyName(Jr,ue),pi){case tt.k1:pi=F.get(ui);break;case tt.l3:pi=G.get(ui);break;default:pi=ce.normalizeStyleValue(ui,Jr,pi,ue)}ar.set(Jr,pi)}),Er||Ce.push(ar),ut=ar,ct=Dn}),ue.length)throw function Me(ce){return new b.vHH(3502,!1)}();return Ce}function Wn(ce,M,F,G){switch(M){case"start":ce.onStart(()=>G(F&&Dr(F,"start",ce)));break;case"done":ce.onDone(()=>G(F&&Dr(F,"done",ce)));break;case"destroy":ce.onDestroy(()=>G(F&&Dr(F,"destroy",ce)))}}function Dr(ce,M,F){const Ce=er(ce.element,ce.triggerName,ce.fromState,ce.toState,M||ce.phaseName,F.totalTime??ce.totalTime,!!F.disabled),ct=ce._data;return null!=ct&&(Ce._data=ct),Ce}function er(ce,M,F,G,ue="",Ce=0,ct){return{element:ce,triggerName:M,fromState:F,toState:G,phaseName:ue,totalTime:Ce,disabled:!!ct}}function kr(ce,M,F){let G=ce.get(M);return G||ce.set(M,G=F),G}function An(ce){const M=ce.indexOf(":");return[ce.substring(1,M),ce.slice(M+1)]}const vi=(()=>typeof document>"u"?null:document.documentElement)();function to(ce){const M=ce.parentNode||ce.host||null;return M===vi?null:M}let zi=null,Ir=!1;function $i(ce,M){for(;M;){if(M===ce)return!0;M=to(M)}return!1}function Lr(ce,M,F){if(F)return Array.from(ce.querySelectorAll(M));const G=ce.querySelector(M);return G?[G]:[]}let Gi=(()=>{var ce;class M{validateStyleProperty(G){return function Hr(ce){zi||(zi=function Tr(){return typeof document<"u"?document.body:null}()||{},Ir=!!zi.style&&"WebkitAppearance"in zi.style);let M=!0;return zi.style&&!function Ai(ce){return"ebkit"==ce.substring(1,6)}(ce)&&(M=ce in zi.style,!M&&Ir&&(M="Webkit"+ce.charAt(0).toUpperCase()+ce.slice(1)in zi.style)),M}(G)}matchesElement(G,ue){return!1}containsElement(G,ue){return $i(G,ue)}getParentElement(G){return to(G)}query(G,ue,Ce){return Lr(G,ue,Ce)}computeStyle(G,ue,Ce){return Ce||""}animate(G,ue,Ce,ct,ut,Qt=[],Dn){return new tt.ZN(Ce,ct)}}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275prov=b.Yz7({token:ce,factory:ce.\u0275fac}),M})(),ai=(()=>{class M{}return M.NOOP=new Gi,M})();const Pi=1e3,je="ng-enter",ae="ng-leave",de="ng-trigger",ke=".ng-trigger",Ye="ng-animating",dt=".ng-animating";function Mt(ce){if("number"==typeof ce)return ce;const M=ce.match(/^(-?[\.\d]+)(m?s)/);return!M||M.length<2?0:St(parseFloat(M[1]),M[2])}function St(ce,M){return"s"===M?ce*Pi:ce}function lt(ce,M,F){return ce.hasOwnProperty("duration")?ce:function Vt(ce,M,F){let ue,Ce=0,ct="";if("string"==typeof ce){const ut=ce.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===ut)return M.push(wt()),{duration:0,delay:0,easing:""};ue=St(parseFloat(ut[1]),ut[2]);const Qt=ut[3];null!=Qt&&(Ce=St(parseFloat(Qt),ut[4]));const Dn=ut[5];Dn&&(ct=Dn)}else ue=ce;if(!F){let ut=!1,Qt=M.length;ue<0&&(M.push(function ht(){return new b.vHH(3100,!1)}()),ut=!0),Ce<0&&(M.push(function et(){return new b.vHH(3101,!1)}()),ut=!0),ut&&M.splice(Qt,0,wt())}return{duration:ue,delay:Ce,easing:ct}}(ce,M,F)}function En(ce,M={}){return Object.keys(ce).forEach(F=>{M[F]=ce[F]}),M}function Ln(ce){const M=new Map;return Object.keys(ce).forEach(F=>{M.set(F,ce[F])}),M}function Dt(ce,M=new Map,F){if(F)for(let[G,ue]of F)M.set(G,ue);for(let[G,ue]of ce)M.set(G,ue);return M}function He(ce,M,F){M.forEach((G,ue)=>{const Ce=rt(ue);F&&!F.has(ue)&&F.set(ue,ce.style[Ce]),ce.style[Ce]=G})}function At(ce,M){M.forEach((F,G)=>{const ue=rt(G);ce.style[ue]=""})}function dn(ce){return Array.isArray(ce)?1==ce.length?ce[0]:(0,tt.vP)(ce):ce}const gr=new RegExp("{{\\s*(.+?)\\s*}}","g");function Mr(ce){let M=[];if("string"==typeof ce){let F;for(;F=gr.exec(ce);)M.push(F[1]);gr.lastIndex=0}return M}function $r(ce,M,F){const G=ce.toString(),ue=G.replace(gr,(Ce,ct)=>{let ut=M[ct];return null==ut&&(F.push(function Kt(ce){return new b.vHH(3003,!1)}()),ut=""),ut.toString()});return ue==G?ce:ue}function Qr(ce){const M=[];let F=ce.next();for(;!F.done;)M.push(F.value),F=ce.next();return M}const Oi=/-+([a-z0-9])/g;function rt(ce){return ce.replace(Oi,(...M)=>M[1].toUpperCase())}function yn(ce,M,F){switch(M.type){case 7:return ce.visitTrigger(M,F);case 0:return ce.visitState(M,F);case 1:return ce.visitTransition(M,F);case 2:return ce.visitSequence(M,F);case 3:return ce.visitGroup(M,F);case 4:return ce.visitAnimate(M,F);case 5:return ce.visitKeyframes(M,F);case 6:return ce.visitStyle(M,F);case 8:return ce.visitReference(M,F);case 9:return ce.visitAnimateChild(M,F);case 10:return ce.visitAnimateRef(M,F);case 11:return ce.visitQuery(M,F);case 12:return ce.visitStagger(M,F);default:throw function It(ce){return new b.vHH(3004,!1)}()}}function zn(ce,M){return window.getComputedStyle(ce)[M]}const li="*";function bi(ce,M){const F=[];return"string"==typeof ce?ce.split(/\s*,\s*/).forEach(G=>function Ur(ce,M,F){if(":"==ce[0]){const Qt=function So(ce,M){switch(ce){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(F,G)=>parseFloat(G)>parseFloat(F);case":decrement":return(F,G)=>parseFloat(G)<parseFloat(F);default:return M.push(function nr(ce){return new b.vHH(3016,!1)}()),"* => *"}}(ce,F);if("function"==typeof Qt)return void M.push(Qt);ce=Qt}const G=ce.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==G||G.length<4)return F.push(function Gt(ce){return new b.vHH(3015,!1)}()),M;const ue=G[1],Ce=G[2],ct=G[3];M.push(Ri(ue,ct));"<"==Ce[0]&&!(ue==li&&ct==li)&&M.push(Ri(ct,ue))}(G,F,M)):F.push(ce),F}const zt=new Set(["true","1"]),ei=new Set(["false","0"]);function Ri(ce,M){const F=zt.has(ce)||ei.has(ce),G=zt.has(M)||ei.has(M);return(ue,Ce)=>{let ct=ce==li||ce==ue,ut=M==li||M==Ce;return!ct&&F&&"boolean"==typeof ue&&(ct=ue?zt.has(ce):ei.has(ce)),!ut&&G&&"boolean"==typeof Ce&&(ut=Ce?zt.has(M):ei.has(M)),ct&&ut}}const Vi=new RegExp("s*:selfs*,?","g");function Ui(ce,M,F,G){return new so(ce).build(M,F,G)}class so{constructor(M){this._driver=M}build(M,F,G){const ue=new Br(F);return this._resetContextStyleTimingState(ue),yn(this,dn(M),ue)}_resetContextStyleTimingState(M){M.currentQuerySelector="",M.collectedStyles=new Map,M.collectedStyles.set("",new Map),M.currentTime=0}visitTrigger(M,F){let G=F.queryCount=0,ue=F.depCount=0;const Ce=[],ct=[];return"@"==M.name.charAt(0)&&F.errors.push(function sn(){return new b.vHH(3006,!1)}()),M.definitions.forEach(ut=>{if(this._resetContextStyleTimingState(F),0==ut.type){const Qt=ut,Dn=Qt.name;Dn.toString().split(/\s*,\s*/).forEach(Er=>{Qt.name=Er,Ce.push(this.visitState(Qt,F))}),Qt.name=Dn}else if(1==ut.type){const Qt=this.visitTransition(ut,F);G+=Qt.queryCount,ue+=Qt.depCount,ct.push(Qt)}else F.errors.push(function Tt(){return new b.vHH(3007,!1)}())}),{type:7,name:M.name,states:Ce,transitions:ct,queryCount:G,depCount:ue,options:null}}visitState(M,F){const G=this.visitStyle(M.styles,F),ue=M.options&&M.options.params||null;if(G.containsDynamicStyles){const Ce=new Set,ct=ue||{};G.styles.forEach(ut=>{ut instanceof Map&&ut.forEach(Qt=>{Mr(Qt).forEach(Dn=>{ct.hasOwnProperty(Dn)||Ce.add(Dn)})})}),Ce.size&&(Qr(Ce.values()),F.errors.push(function Ge(ce,M){return new b.vHH(3008,!1)}()))}return{type:0,name:M.name,style:G,options:ue?{params:ue}:null}}visitTransition(M,F){F.queryCount=0,F.depCount=0;const G=yn(this,dn(M.animation),F);return{type:1,matchers:bi(M.expr,F.errors),animation:G,queryCount:F.queryCount,depCount:F.depCount,options:pe(M.options)}}visitSequence(M,F){return{type:2,steps:M.steps.map(G=>yn(this,G,F)),options:pe(M.options)}}visitGroup(M,F){const G=F.currentTime;let ue=0;const Ce=M.steps.map(ct=>{F.currentTime=G;const ut=yn(this,ct,F);return ue=Math.max(ue,F.currentTime),ut});return F.currentTime=ue,{type:3,steps:Ce,options:pe(M.options)}}visitAnimate(M,F){const G=function Oe(ce,M){if(ce.hasOwnProperty("duration"))return ce;if("number"==typeof ce)return Se(lt(ce,M).duration,0,"");const F=ce;if(F.split(/\s+/).some(Ce=>"{"==Ce.charAt(0)&&"{"==Ce.charAt(1))){const Ce=Se(0,0,"");return Ce.dynamic=!0,Ce.strValue=F,Ce}const ue=lt(F,M);return Se(ue.duration,ue.delay,ue.easing)}(M.timings,F.errors);F.currentAnimateTimings=G;let ue,Ce=M.styles?M.styles:(0,tt.oB)({});if(5==Ce.type)ue=this.visitKeyframes(Ce,F);else{let ct=M.styles,ut=!1;if(!ct){ut=!0;const Dn={};G.easing&&(Dn.easing=G.easing),ct=(0,tt.oB)(Dn)}F.currentTime+=G.duration+G.delay;const Qt=this.visitStyle(ct,F);Qt.isEmptyStep=ut,ue=Qt}return F.currentAnimateTimings=null,{type:4,timings:G,style:ue,options:null}}visitStyle(M,F){const G=this._makeStyleAst(M,F);return this._validateStyleAst(G,F),G}_makeStyleAst(M,F){const G=[],ue=Array.isArray(M.styles)?M.styles:[M.styles];for(let ut of ue)"string"==typeof ut?ut===tt.l3?G.push(ut):F.errors.push(new b.vHH(3002,!1)):G.push(Ln(ut));let Ce=!1,ct=null;return G.forEach(ut=>{if(ut instanceof Map&&(ut.has("easing")&&(ct=ut.get("easing"),ut.delete("easing")),!Ce))for(let Qt of ut.values())if(Qt.toString().indexOf("{{")>=0){Ce=!0;break}}),{type:6,styles:G,easing:ct,offset:M.offset,containsDynamicStyles:Ce,options:null}}_validateStyleAst(M,F){const G=F.currentAnimateTimings;let ue=F.currentTime,Ce=F.currentTime;G&&Ce>0&&(Ce-=G.duration+G.delay),M.styles.forEach(ct=>{"string"!=typeof ct&&ct.forEach((ut,Qt)=>{const Dn=F.collectedStyles.get(F.currentQuerySelector),Er=Dn.get(Qt);let ar=!0;Er&&(Ce!=ue&&Ce>=Er.startTime&&ue<=Er.endTime&&(F.errors.push(function _n(ce,M,F,G,ue){return new b.vHH(3010,!1)}()),ar=!1),Ce=Er.startTime),ar&&Dn.set(Qt,{startTime:Ce,endTime:ue}),F.options&&function qn(ce,M,F){const G=M.params||{},ue=Mr(ce);ue.length&&ue.forEach(Ce=>{G.hasOwnProperty(Ce)||F.push(function xt(ce){return new b.vHH(3001,!1)}())})}(ut,F.options,F.errors)})})}visitKeyframes(M,F){const G={type:5,styles:[],options:null};if(!F.currentAnimateTimings)return F.errors.push(function De(){return new b.vHH(3011,!1)}()),G;let Ce=0;const ct=[];let ut=!1,Qt=!1,Dn=0;const Er=M.steps.map(es=>{const Go=this._makeStyleAst(es,F);let As=null!=Go.offset?Go.offset:function le(ce){if("string"==typeof ce)return null;let M=null;if(Array.isArray(ce))ce.forEach(F=>{if(F instanceof Map&&F.has("offset")){const G=F;M=parseFloat(G.get("offset")),G.delete("offset")}});else if(ce instanceof Map&&ce.has("offset")){const F=ce;M=parseFloat(F.get("offset")),F.delete("offset")}return M}(Go.styles),ss=0;return null!=As&&(Ce++,ss=Go.offset=As),Qt=Qt||ss<0||ss>1,ut=ut||ss<Dn,Dn=ss,ct.push(ss),Go});Qt&&F.errors.push(function ft(){return new b.vHH(3012,!1)}()),ut&&F.errors.push(function Nt(){return new b.vHH(3200,!1)}());const ar=M.steps.length;let Ei=0;Ce>0&&Ce<ar?F.errors.push(function yt(){return new b.vHH(3202,!1)}()):0==Ce&&(Ei=1/(ar-1));const ui=ar-1,Jr=F.currentTime,pi=F.currentAnimateTimings,Mo=pi.duration;return Er.forEach((es,Go)=>{const As=Ei>0?Go==ui?1:Ei*Go:ct[Go],ss=As*Mo;F.currentTime=Jr+pi.delay+ss,pi.duration=ss,this._validateStyleAst(es,F),es.offset=As,G.styles.push(es)}),G}visitReference(M,F){return{type:8,animation:yn(this,dn(M.animation),F),options:pe(M.options)}}visitAnimateChild(M,F){return F.depCount++,{type:9,options:pe(M.options)}}visitAnimateRef(M,F){return{type:10,animation:this.visitReference(M.animation,F),options:pe(M.options)}}visitQuery(M,F){const G=F.currentQuerySelector,ue=M.options||{};F.queryCount++,F.currentQuery=M;const[Ce,ct]=function yo(ce){const M=!!ce.split(/\s*,\s*/).find(F=>":self"==F);return M&&(ce=ce.replace(Vi,"")),ce=ce.replace(/@\*/g,ke).replace(/@\w+/g,F=>ke+"-"+F.slice(1)).replace(/:animating/g,dt),[ce,M]}(M.selector);F.currentQuerySelector=G.length?G+" "+Ce:Ce,kr(F.collectedStyles,F.currentQuerySelector,new Map);const ut=yn(this,dn(M.animation),F);return F.currentQuery=null,F.currentQuerySelector=G,{type:11,selector:Ce,limit:ue.limit||0,optional:!!ue.optional,includeSelf:ct,animation:ut,originalSelector:M.selector,options:pe(M.options)}}visitStagger(M,F){F.currentQuery||F.errors.push(function mn(){return new b.vHH(3013,!1)}());const G="full"===M.timings?{duration:0,delay:0,easing:"full"}:lt(M.timings,F.errors,!0);return{type:12,animation:yn(this,dn(M.animation),F),timings:G,options:null}}}class Br{constructor(M){this.errors=M,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function pe(ce){return ce?(ce=En(ce)).params&&(ce.params=function Kn(ce){return ce?En(ce):null}(ce.params)):ce={},ce}function Se(ce,M,F){return{duration:ce,delay:M,easing:F}}function bt(ce,M,F,G,ue,Ce,ct=null,ut=!1){return{type:1,element:ce,keyframes:M,preStyleProps:F,postStyleProps:G,duration:ue,delay:Ce,totalTime:ue+Ce,easing:ct,subTimeline:ut}}class Pt{constructor(){this._map=new Map}get(M){return this._map.get(M)||[]}append(M,F){let G=this._map.get(M);G||this._map.set(M,G=[]),G.push(...F)}has(M){return this._map.has(M)}clear(){this._map.clear()}}const pn=new RegExp(":enter","g"),lr=new RegExp(":leave","g");function Ar(ce,M,F,G,ue,Ce=new Map,ct=new Map,ut,Qt,Dn=[]){return(new Zr).buildKeyframes(ce,M,F,G,ue,Ce,ct,ut,Qt,Dn)}class Zr{buildKeyframes(M,F,G,ue,Ce,ct,ut,Qt,Dn,Er=[]){Dn=Dn||new Pt;const ar=new zo(M,F,Dn,ue,Ce,Er,[]);ar.options=Qt;const Ei=Qt.delay?Mt(Qt.delay):0;ar.currentTimeline.delayNextStep(Ei),ar.currentTimeline.setStyles([ct],null,ar.errors,Qt),yn(this,G,ar);const ui=ar.timelines.filter(Jr=>Jr.containsAnimation());if(ui.length&&ut.size){let Jr;for(let pi=ui.length-1;pi>=0;pi--){const Mo=ui[pi];if(Mo.element===F){Jr=Mo;break}}Jr&&!Jr.allowOnlyTimelineStyles()&&Jr.setStyles([ut],null,ar.errors,Qt)}return ui.length?ui.map(Jr=>Jr.buildKeyframes()):[bt(F,[],[],[],0,Ei,"",!1)]}visitTrigger(M,F){}visitState(M,F){}visitTransition(M,F){}visitAnimateChild(M,F){const G=F.subInstructions.get(F.element);if(G){const ue=F.createSubContext(M.options),Ce=F.currentTimeline.currentTime,ct=this._visitSubInstructions(G,ue,ue.options);Ce!=ct&&F.transformIntoNewTimeline(ct)}F.previousNode=M}visitAnimateRef(M,F){const G=F.createSubContext(M.options);G.transformIntoNewTimeline(),this._applyAnimationRefDelays([M.options,M.animation.options],F,G),this.visitReference(M.animation,G),F.transformIntoNewTimeline(G.currentTimeline.currentTime),F.previousNode=M}_applyAnimationRefDelays(M,F,G){for(const ue of M){const Ce=ue?.delay;if(Ce){const ct="number"==typeof Ce?Ce:Mt($r(Ce,ue?.params??{},F.errors));G.delayNextStep(ct)}}}_visitSubInstructions(M,F,G){let Ce=F.currentTimeline.currentTime;const ct=null!=G.duration?Mt(G.duration):null,ut=null!=G.delay?Mt(G.delay):null;return 0!==ct&&M.forEach(Qt=>{const Dn=F.appendInstructionToTimeline(Qt,ct,ut);Ce=Math.max(Ce,Dn.duration+Dn.delay)}),Ce}visitReference(M,F){F.updateOptions(M.options,!0),yn(this,M.animation,F),F.previousNode=M}visitSequence(M,F){const G=F.subContextCount;let ue=F;const Ce=M.options;if(Ce&&(Ce.params||Ce.delay)&&(ue=F.createSubContext(Ce),ue.transformIntoNewTimeline(),null!=Ce.delay)){6==ue.previousNode.type&&(ue.currentTimeline.snapshotCurrentStyles(),ue.previousNode=ji);const ct=Mt(Ce.delay);ue.delayNextStep(ct)}M.steps.length&&(M.steps.forEach(ct=>yn(this,ct,ue)),ue.currentTimeline.applyStylesToKeyframe(),ue.subContextCount>G&&ue.transformIntoNewTimeline()),F.previousNode=M}visitGroup(M,F){const G=[];let ue=F.currentTimeline.currentTime;const Ce=M.options&&M.options.delay?Mt(M.options.delay):0;M.steps.forEach(ct=>{const ut=F.createSubContext(M.options);Ce&&ut.delayNextStep(Ce),yn(this,ct,ut),ue=Math.max(ue,ut.currentTimeline.currentTime),G.push(ut.currentTimeline)}),G.forEach(ct=>F.currentTimeline.mergeTimelineCollectedStyles(ct)),F.transformIntoNewTimeline(ue),F.previousNode=M}_visitTiming(M,F){if(M.dynamic){const G=M.strValue;return lt(F.params?$r(G,F.params,F.errors):G,F.errors)}return{duration:M.duration,delay:M.delay,easing:M.easing}}visitAnimate(M,F){const G=F.currentAnimateTimings=this._visitTiming(M.timings,F),ue=F.currentTimeline;G.delay&&(F.incrementTime(G.delay),ue.snapshotCurrentStyles());const Ce=M.style;5==Ce.type?this.visitKeyframes(Ce,F):(F.incrementTime(G.duration),this.visitStyle(Ce,F),ue.applyStylesToKeyframe()),F.currentAnimateTimings=null,F.previousNode=M}visitStyle(M,F){const G=F.currentTimeline,ue=F.currentAnimateTimings;!ue&&G.hasCurrentStyleProperties()&&G.forwardFrame();const Ce=ue&&ue.easing||M.easing;M.isEmptyStep?G.applyEmptyStep(Ce):G.setStyles(M.styles,Ce,F.errors,F.options),F.previousNode=M}visitKeyframes(M,F){const G=F.currentAnimateTimings,ue=F.currentTimeline.duration,Ce=G.duration,ut=F.createSubContext().currentTimeline;ut.easing=G.easing,M.styles.forEach(Qt=>{ut.forwardTime((Qt.offset||0)*Ce),ut.setStyles(Qt.styles,Qt.easing,F.errors,F.options),ut.applyStylesToKeyframe()}),F.currentTimeline.mergeTimelineCollectedStyles(ut),F.transformIntoNewTimeline(ue+Ce),F.previousNode=M}visitQuery(M,F){const G=F.currentTimeline.currentTime,ue=M.options||{},Ce=ue.delay?Mt(ue.delay):0;Ce&&(6===F.previousNode.type||0==G&&F.currentTimeline.hasCurrentStyleProperties())&&(F.currentTimeline.snapshotCurrentStyles(),F.previousNode=ji);let ct=G;const ut=F.invokeQuery(M.selector,M.originalSelector,M.limit,M.includeSelf,!!ue.optional,F.errors);F.currentQueryTotal=ut.length;let Qt=null;ut.forEach((Dn,Er)=>{F.currentQueryIndex=Er;const ar=F.createSubContext(M.options,Dn);Ce&&ar.delayNextStep(Ce),Dn===F.element&&(Qt=ar.currentTimeline),yn(this,M.animation,ar),ar.currentTimeline.applyStylesToKeyframe(),ct=Math.max(ct,ar.currentTimeline.currentTime)}),F.currentQueryIndex=0,F.currentQueryTotal=0,F.transformIntoNewTimeline(ct),Qt&&(F.currentTimeline.mergeTimelineCollectedStyles(Qt),F.currentTimeline.snapshotCurrentStyles()),F.previousNode=M}visitStagger(M,F){const G=F.parentContext,ue=F.currentTimeline,Ce=M.timings,ct=Math.abs(Ce.duration),ut=ct*(F.currentQueryTotal-1);let Qt=ct*F.currentQueryIndex;switch(Ce.duration<0?"reverse":Ce.easing){case"reverse":Qt=ut-Qt;break;case"full":Qt=G.currentStaggerTime}const Er=F.currentTimeline;Qt&&Er.delayNextStep(Qt);const ar=Er.currentTime;yn(this,M.animation,F),F.previousNode=M,G.currentStaggerTime=ue.currentTime-ar+(ue.startTime-G.currentTimeline.startTime)}}const ji={};class zo{constructor(M,F,G,ue,Ce,ct,ut,Qt){this._driver=M,this.element=F,this.subInstructions=G,this._enterClassName=ue,this._leaveClassName=Ce,this.errors=ct,this.timelines=ut,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=ji,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=Qt||new Ki(this._driver,F,0),ut.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(M,F){if(!M)return;const G=M;let ue=this.options;null!=G.duration&&(ue.duration=Mt(G.duration)),null!=G.delay&&(ue.delay=Mt(G.delay));const Ce=G.params;if(Ce){let ct=ue.params;ct||(ct=this.options.params={}),Object.keys(Ce).forEach(ut=>{(!F||!ct.hasOwnProperty(ut))&&(ct[ut]=$r(Ce[ut],ct,this.errors))})}}_copyOptions(){const M={};if(this.options){const F=this.options.params;if(F){const G=M.params={};Object.keys(F).forEach(ue=>{G[ue]=F[ue]})}}return M}createSubContext(M=null,F,G){const ue=F||this.element,Ce=new zo(this._driver,ue,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(ue,G||0));return Ce.previousNode=this.previousNode,Ce.currentAnimateTimings=this.currentAnimateTimings,Ce.options=this._copyOptions(),Ce.updateOptions(M),Ce.currentQueryIndex=this.currentQueryIndex,Ce.currentQueryTotal=this.currentQueryTotal,Ce.parentContext=this,this.subContextCount++,Ce}transformIntoNewTimeline(M){return this.previousNode=ji,this.currentTimeline=this.currentTimeline.fork(this.element,M),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(M,F,G){const ue={duration:F??M.duration,delay:this.currentTimeline.currentTime+(G??0)+M.delay,easing:""},Ce=new Zo(this._driver,M.element,M.keyframes,M.preStyleProps,M.postStyleProps,ue,M.stretchStartingKeyframe);return this.timelines.push(Ce),ue}incrementTime(M){this.currentTimeline.forwardTime(this.currentTimeline.duration+M)}delayNextStep(M){M>0&&this.currentTimeline.delayNextStep(M)}invokeQuery(M,F,G,ue,Ce,ct){let ut=[];if(ue&&ut.push(this.element),M.length>0){M=(M=M.replace(pn,"."+this._enterClassName)).replace(lr,"."+this._leaveClassName);let Dn=this._driver.query(this.element,M,1!=G);0!==G&&(Dn=G<0?Dn.slice(Dn.length+G,Dn.length):Dn.slice(0,G)),ut.push(...Dn)}return!Ce&&0==ut.length&&ct.push(function hn(ce){return new b.vHH(3014,!1)}()),ut}}class Ki{constructor(M,F,G,ue){this._driver=M,this.element=F,this.startTime=G,this._elementTimelineStylesLookup=ue,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(F),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(F,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(M){const F=1===this._keyframes.size&&this._pendingStyles.size;this.duration||F?(this.forwardTime(this.currentTime+M),F&&this.snapshotCurrentStyles()):this.startTime+=M}fork(M,F){return this.applyStylesToKeyframe(),new Ki(this._driver,M,F||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(M){this.applyStylesToKeyframe(),this.duration=M,this._loadKeyframe()}_updateStyle(M,F){this._localTimelineStyles.set(M,F),this._globalTimelineStyles.set(M,F),this._styleSummary.set(M,{time:this.currentTime,value:F})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(M){M&&this._previousKeyframe.set("easing",M);for(let[F,G]of this._globalTimelineStyles)this._backFill.set(F,G||tt.l3),this._currentKeyframe.set(F,tt.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(M,F,G,ue){F&&this._previousKeyframe.set("easing",F);const Ce=ue&&ue.params||{},ct=function Io(ce,M){const F=new Map;let G;return ce.forEach(ue=>{if("*"===ue){G=G||M.keys();for(let Ce of G)F.set(Ce,tt.l3)}else Dt(ue,F)}),F}(M,this._globalTimelineStyles);for(let[ut,Qt]of ct){const Dn=$r(Qt,Ce,G);this._pendingStyles.set(ut,Dn),this._localTimelineStyles.has(ut)||this._backFill.set(ut,this._globalTimelineStyles.get(ut)??tt.l3),this._updateStyle(ut,Dn)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((M,F)=>{this._currentKeyframe.set(F,M)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((M,F)=>{this._currentKeyframe.has(F)||this._currentKeyframe.set(F,M)}))}snapshotCurrentStyles(){for(let[M,F]of this._localTimelineStyles)this._pendingStyles.set(M,F),this._updateStyle(M,F)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const M=[];for(let F in this._currentKeyframe)M.push(F);return M}mergeTimelineCollectedStyles(M){M._styleSummary.forEach((F,G)=>{const ue=this._styleSummary.get(G);(!ue||F.time>ue.time)&&this._updateStyle(G,F.value)})}buildKeyframes(){this.applyStylesToKeyframe();const M=new Set,F=new Set,G=1===this._keyframes.size&&0===this.duration;let ue=[];this._keyframes.forEach((ut,Qt)=>{const Dn=Dt(ut,new Map,this._backFill);Dn.forEach((Er,ar)=>{Er===tt.k1?M.add(ar):Er===tt.l3&&F.add(ar)}),G||Dn.set("offset",Qt/this.duration),ue.push(Dn)});const Ce=M.size?Qr(M.values()):[],ct=F.size?Qr(F.values()):[];if(G){const ut=ue[0],Qt=new Map(ut);ut.set("offset",0),Qt.set("offset",1),ue=[ut,Qt]}return bt(this.element,ue,Ce,ct,this.duration,this.startTime,this.easing,!1)}}class Zo extends Ki{constructor(M,F,G,ue,Ce,ct,ut=!1){super(M,F,ct.delay),this.keyframes=G,this.preStyleProps=ue,this.postStyleProps=Ce,this._stretchStartingKeyframe=ut,this.timings={duration:ct.duration,delay:ct.delay,easing:ct.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let M=this.keyframes,{delay:F,duration:G,easing:ue}=this.timings;if(this._stretchStartingKeyframe&&F){const Ce=[],ct=G+F,ut=F/ct,Qt=Dt(M[0]);Qt.set("offset",0),Ce.push(Qt);const Dn=Dt(M[0]);Dn.set("offset",ao(ut)),Ce.push(Dn);const Er=M.length-1;for(let ar=1;ar<=Er;ar++){let Ei=Dt(M[ar]);const ui=Ei.get("offset");Ei.set("offset",ao((F+ui*G)/ct)),Ce.push(Ei)}G=ct,F=0,ue="",M=Ce}return bt(this.element,M,this.preStyleProps,this.postStyleProps,G,F,ue,!0)}}function ao(ce,M=3){const F=Math.pow(10,M-1);return Math.round(ce*F)/F}class Si{}const sa=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Gr extends Si{normalizePropertyName(M,F){return rt(M)}normalizeStyleValue(M,F,G,ue){let Ce="";const ct=G.toString().trim();if(sa.has(F)&&0!==G&&"0"!==G)if("number"==typeof G)Ce="px";else{const ut=G.match(/^[+-]?[\d\.]+([a-z]*)$/);ut&&0==ut[1].length&&ue.push(function st(ce,M){return new b.vHH(3005,!1)}())}return ct+Ce}}function Ii(ce,M,F,G,ue,Ce,ct,ut,Qt,Dn,Er,ar,Ei){return{type:0,element:ce,triggerName:M,isRemovalTransition:ue,fromState:F,fromStyles:Ce,toState:G,toStyles:ct,timelines:ut,queriedElements:Qt,preStyleProps:Dn,postStyleProps:Er,totalTime:ar,errors:Ei}}const Fo={};class gs{constructor(M,F,G){this._triggerName=M,this.ast=F,this._stateStyles=G}match(M,F,G,ue){return function Js(ce,M,F,G,ue){return ce.some(Ce=>Ce(M,F,G,ue))}(this.ast.matchers,M,F,G,ue)}buildStyles(M,F,G){let ue=this._stateStyles.get("*");return void 0!==M&&(ue=this._stateStyles.get(M?.toString())||ue),ue?ue.buildStyles(F,G):new Map}build(M,F,G,ue,Ce,ct,ut,Qt,Dn,Er){const ar=[],Ei=this.ast.options&&this.ast.options.params||Fo,Jr=this.buildStyles(G,ut&&ut.params||Fo,ar),pi=Qt&&Qt.params||Fo,Mo=this.buildStyles(ue,pi,ar),es=new Set,Go=new Map,As=new Map,ss="void"===ue,va={params:Qs(pi,Ei),delay:this.ast.options?.delay},fa=Er?[]:Ar(M,F,this.ast.animation,Ce,ct,Jr,Mo,va,Dn,ar);let Es=0;if(fa.forEach(Cs=>{Es=Math.max(Cs.duration+Cs.delay,Es)}),ar.length)return Ii(F,this._triggerName,G,ue,ss,Jr,Mo,[],[],Go,As,Es,ar);fa.forEach(Cs=>{const k=Cs.element,X=kr(Go,k,new Set);Cs.preStyleProps.forEach(W=>X.add(W));const Be=kr(As,k,new Set);Cs.postStyleProps.forEach(W=>Be.add(W)),k!==F&&es.add(k)});const Ds=Qr(es.values());return Ii(F,this._triggerName,G,ue,ss,Jr,Mo,fa,Ds,Go,As,Es)}}function Qs(ce,M){const F=En(M);for(const G in ce)ce.hasOwnProperty(G)&&null!=ce[G]&&(F[G]=ce[G]);return F}class Is{constructor(M,F,G){this.styles=M,this.defaultParams=F,this.normalizer=G}buildStyles(M,F){const G=new Map,ue=En(this.defaultParams);return Object.keys(M).forEach(Ce=>{const ct=M[Ce];null!==ct&&(ue[Ce]=ct)}),this.styles.styles.forEach(Ce=>{"string"!=typeof Ce&&Ce.forEach((ct,ut)=>{ct&&(ct=$r(ct,ue,F));const Qt=this.normalizer.normalizePropertyName(ut,F);ct=this.normalizer.normalizeStyleValue(ut,Qt,ct,F),G.set(ut,ct)})}),G}}class ha{constructor(M,F,G){this.name=M,this.ast=F,this._normalizer=G,this.transitionFactories=[],this.states=new Map,F.states.forEach(ue=>{this.states.set(ue.name,new Is(ue.style,ue.options&&ue.options.params||{},G))}),rr(this.states,"true","1"),rr(this.states,"false","0"),F.transitions.forEach(ue=>{this.transitionFactories.push(new gs(M,ue,this.states))}),this.fallbackTransition=function Wi(ce,M,F){return new gs(ce,{type:1,animation:{type:2,steps:[],options:null},matchers:[(ct,ut)=>!0],options:null,queryCount:0,depCount:0},M)}(M,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(M,F,G,ue){return this.transitionFactories.find(ct=>ct.match(M,F,G,ue))||null}matchStyles(M,F,G){return this.fallbackTransition.buildStyles(M,F,G)}}function rr(ce,M,F){ce.has(M)?ce.has(F)||ce.set(F,ce.get(M)):ce.has(F)&&ce.set(M,ce.get(F))}const Rr=new Pt;class qi{constructor(M,F,G){this.bodyNode=M,this._driver=F,this._normalizer=G,this._animations=new Map,this._playersById=new Map,this.players=[]}register(M,F){const G=[],Ce=Ui(this._driver,F,G,[]);if(G.length)throw function Ue(ce){return new b.vHH(3503,!1)}();this._animations.set(M,Ce)}_buildPlayer(M,F,G){const ue=M.element,Ce=Cr(this._normalizer,M.keyframes,F,G);return this._driver.animate(ue,Ce,M.duration,M.delay,M.easing,[],!0)}create(M,F,G={}){const ue=[],Ce=this._animations.get(M);let ct;const ut=new Map;if(Ce?(ct=Ar(this._driver,F,Ce,je,ae,new Map,new Map,G,Rr,ue),ct.forEach(Er=>{const ar=kr(ut,Er.element,new Map);Er.postStyleProps.forEach(Ei=>ar.set(Ei,null))})):(ue.push(function at(){return new b.vHH(3300,!1)}()),ct=[]),ue.length)throw function Rt(ce){return new b.vHH(3504,!1)}();ut.forEach((Er,ar)=>{Er.forEach((Ei,ui)=>{Er.set(ui,this._driver.computeStyle(ar,ui,tt.l3))})});const Dn=Gn(ct.map(Er=>{const ar=ut.get(Er.element);return this._buildPlayer(Er,new Map,ar)}));return this._playersById.set(M,Dn),Dn.onDestroy(()=>this.destroy(M)),this.players.push(Dn),Dn}destroy(M){const F=this._getPlayer(M);F.destroy(),this._playersById.delete(M);const G=this.players.indexOf(F);G>=0&&this.players.splice(G,1)}_getPlayer(M){const F=this._playersById.get(M);if(!F)throw function cn(ce){return new b.vHH(3301,!1)}();return F}listen(M,F,G,ue){const Ce=er(F,"","","");return Wn(this._getPlayer(M),G,Ce,ue),()=>{}}command(M,F,G,ue){if("register"==G)return void this.register(M,ue[0]);if("create"==G)return void this.create(M,F,ue[0]||{});const Ce=this._getPlayer(M);switch(G){case"play":Ce.play();break;case"pause":Ce.pause();break;case"reset":Ce.reset();break;case"restart":Ce.restart();break;case"finish":Ce.finish();break;case"init":Ce.init();break;case"setPosition":Ce.setPosition(parseFloat(ue[0]));break;case"destroy":this.destroy(M)}}}const _s="ng-animate-queued",io="ng-animate-disabled",Bo=[],Wr={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Xo={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ko="__ng_removed";class ys{get params(){return this.options.params}constructor(M,F=""){this.namespaceId=F;const G=M&&M.hasOwnProperty("value");if(this.value=function ci(ce){return ce??null}(G?M.value:M),G){const Ce=En(M);delete Ce.value,this.options=Ce}else this.options={};this.options.params||(this.options.params={})}absorbOptions(M){const F=M.params;if(F){const G=this.options.params;Object.keys(F).forEach(ue=>{null==G[ue]&&(G[ue]=F[ue])})}}}const Ni="void",aa=new ys(Ni);class js{constructor(M,F,G){this.id=M,this.hostElement=F,this._engine=G,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+M,Qo(F,this._hostClassName)}listen(M,F,G,ue){if(!this._triggers.has(F))throw function un(ce,M){return new b.vHH(3302,!1)}();if(null==G||0==G.length)throw function Qn(ce){return new b.vHH(3303,!1)}();if(!function ta(ce){return"start"==ce||"done"==ce}(G))throw function ur(ce,M){return new b.vHH(3400,!1)}();const Ce=kr(this._elementListeners,M,[]),ct={name:F,phase:G,callback:ue};Ce.push(ct);const ut=kr(this._engine.statesByElement,M,new Map);return ut.has(F)||(Qo(M,de),Qo(M,de+"-"+F),ut.set(F,aa)),()=>{this._engine.afterFlush(()=>{const Qt=Ce.indexOf(ct);Qt>=0&&Ce.splice(Qt,1),this._triggers.has(F)||ut.delete(F)})}}register(M,F){return!this._triggers.has(M)&&(this._triggers.set(M,F),!0)}_getTrigger(M){const F=this._triggers.get(M);if(!F)throw function Mn(ce){return new b.vHH(3401,!1)}();return F}trigger(M,F,G,ue=!0){const Ce=this._getTrigger(F),ct=new is(this.id,F,M);let ut=this._engine.statesByElement.get(M);ut||(Qo(M,de),Qo(M,de+"-"+F),this._engine.statesByElement.set(M,ut=new Map));let Qt=ut.get(F);const Dn=new ys(G,this.id);if(!(G&&G.hasOwnProperty("value"))&&Qt&&Dn.absorbOptions(Qt.options),ut.set(F,Dn),Qt||(Qt=aa),Dn.value!==Ni&&Qt.value===Dn.value){if(!function Fs(ce,M){const F=Object.keys(ce),G=Object.keys(M);if(F.length!=G.length)return!1;for(let ue=0;ue<F.length;ue++){const Ce=F[ue];if(!M.hasOwnProperty(Ce)||ce[Ce]!==M[Ce])return!1}return!0}(Qt.params,Dn.params)){const pi=[],Mo=Ce.matchStyles(Qt.value,Qt.params,pi),es=Ce.matchStyles(Dn.value,Dn.params,pi);pi.length?this._engine.reportError(pi):this._engine.afterFlush(()=>{At(M,Mo),He(M,es)})}return}const Ei=kr(this._engine.playersByElement,M,[]);Ei.forEach(pi=>{pi.namespaceId==this.id&&pi.triggerName==F&&pi.queued&&pi.destroy()});let ui=Ce.matchTransition(Qt.value,Dn.value,M,Dn.params),Jr=!1;if(!ui){if(!ue)return;ui=Ce.fallbackTransition,Jr=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:M,triggerName:F,transition:ui,fromState:Qt,toState:Dn,player:ct,isFallbackTransition:Jr}),Jr||(Qo(M,_s),ct.onStart(()=>{xs(M,_s)})),ct.onDone(()=>{let pi=this.players.indexOf(ct);pi>=0&&this.players.splice(pi,1);const Mo=this._engine.playersByElement.get(M);if(Mo){let es=Mo.indexOf(ct);es>=0&&Mo.splice(es,1)}}),this.players.push(ct),Ei.push(ct),ct}deregister(M){this._triggers.delete(M),this._engine.statesByElement.forEach(F=>F.delete(M)),this._elementListeners.forEach((F,G)=>{this._elementListeners.set(G,F.filter(ue=>ue.name!=M))})}clearElementCache(M){this._engine.statesByElement.delete(M),this._elementListeners.delete(M);const F=this._engine.playersByElement.get(M);F&&(F.forEach(G=>G.destroy()),this._engine.playersByElement.delete(M))}_signalRemovalForInnerTriggers(M,F){const G=this._engine.driver.query(M,ke,!0);G.forEach(ue=>{if(ue[Ko])return;const Ce=this._engine.fetchNamespacesByElement(ue);Ce.size?Ce.forEach(ct=>ct.triggerLeaveAnimation(ue,F,!1,!0)):this.clearElementCache(ue)}),this._engine.afterFlushAnimationsDone(()=>G.forEach(ue=>this.clearElementCache(ue)))}triggerLeaveAnimation(M,F,G,ue){const Ce=this._engine.statesByElement.get(M),ct=new Map;if(Ce){const ut=[];if(Ce.forEach((Qt,Dn)=>{if(ct.set(Dn,Qt.value),this._triggers.has(Dn)){const Er=this.trigger(M,Dn,Ni,ue);Er&&ut.push(Er)}}),ut.length)return this._engine.markElementAsRemoved(this.id,M,!0,F,ct),G&&Gn(ut).onDone(()=>this._engine.processLeaveNode(M)),!0}return!1}prepareLeaveAnimationListeners(M){const F=this._elementListeners.get(M),G=this._engine.statesByElement.get(M);if(F&&G){const ue=new Set;F.forEach(Ce=>{const ct=Ce.name;if(ue.has(ct))return;ue.add(ct);const Qt=this._triggers.get(ct).fallbackTransition,Dn=G.get(ct)||aa,Er=new ys(Ni),ar=new is(this.id,ct,M);this._engine.totalQueuedPlayers++,this._queue.push({element:M,triggerName:ct,transition:Qt,fromState:Dn,toState:Er,player:ar,isFallbackTransition:!0})})}}removeNode(M,F){const G=this._engine;if(M.childElementCount&&this._signalRemovalForInnerTriggers(M,F),this.triggerLeaveAnimation(M,F,!0))return;let ue=!1;if(G.totalAnimations){const Ce=G.players.length?G.playersByQueriedElement.get(M):[];if(Ce&&Ce.length)ue=!0;else{let ct=M;for(;ct=ct.parentNode;)if(G.statesByElement.get(ct)){ue=!0;break}}}if(this.prepareLeaveAnimationListeners(M),ue)G.markElementAsRemoved(this.id,M,!1,F);else{const Ce=M[Ko];(!Ce||Ce===Wr)&&(G.afterFlush(()=>this.clearElementCache(M)),G.destroyInnerAnimations(M),G._onRemovalComplete(M,F))}}insertNode(M,F){Qo(M,this._hostClassName)}drainQueuedTransitions(M){const F=[];return this._queue.forEach(G=>{const ue=G.player;if(ue.destroyed)return;const Ce=G.element,ct=this._elementListeners.get(Ce);ct&&ct.forEach(ut=>{if(ut.name==G.triggerName){const Qt=er(Ce,G.triggerName,G.fromState.value,G.toState.value);Qt._data=M,Wn(G.player,ut.phase,Qt,ut.callback)}}),ue.markedForDestroy?this._engine.afterFlush(()=>{ue.destroy()}):F.push(G)}),this._queue=[],F.sort((G,ue)=>{const Ce=G.transition.ast.depCount,ct=ue.transition.ast.depCount;return 0==Ce||0==ct?Ce-ct:this._engine.driver.containsElement(G.element,ue.element)?1:-1})}destroy(M){this.players.forEach(F=>F.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,M)}}class vs{_onRemovalComplete(M,F){this.onRemovalComplete(M,F)}constructor(M,F,G){this.bodyNode=M,this.driver=F,this._normalizer=G,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(ue,Ce)=>{}}get queuedPlayers(){const M=[];return this._namespaceList.forEach(F=>{F.players.forEach(G=>{G.queued&&M.push(G)})}),M}createNamespace(M,F){const G=new js(M,F,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,F)?this._balanceNamespaceList(G,F):(this.newHostElements.set(F,G),this.collectEnterElement(F)),this._namespaceLookup[M]=G}_balanceNamespaceList(M,F){const G=this._namespaceList,ue=this.namespacesByHostElement;if(G.length-1>=0){let ct=!1,ut=this.driver.getParentElement(F);for(;ut;){const Qt=ue.get(ut);if(Qt){const Dn=G.indexOf(Qt);G.splice(Dn+1,0,M),ct=!0;break}ut=this.driver.getParentElement(ut)}ct||G.unshift(M)}else G.push(M);return ue.set(F,M),M}register(M,F){let G=this._namespaceLookup[M];return G||(G=this.createNamespace(M,F)),G}registerTrigger(M,F,G){let ue=this._namespaceLookup[M];ue&&ue.register(F,G)&&this.totalAnimations++}destroy(M,F){M&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const G=this._fetchNamespace(M);this.namespacesByHostElement.delete(G.hostElement);const ue=this._namespaceList.indexOf(G);ue>=0&&this._namespaceList.splice(ue,1),G.destroy(F),delete this._namespaceLookup[M]}))}_fetchNamespace(M){return this._namespaceLookup[M]}fetchNamespacesByElement(M){const F=new Set,G=this.statesByElement.get(M);if(G)for(let ue of G.values())if(ue.namespaceId){const Ce=this._fetchNamespace(ue.namespaceId);Ce&&F.add(Ce)}return F}trigger(M,F,G,ue){if(Ms(F)){const Ce=this._fetchNamespace(M);if(Ce)return Ce.trigger(F,G,ue),!0}return!1}insertNode(M,F,G,ue){if(!Ms(F))return;const Ce=F[Ko];if(Ce&&Ce.setForRemoval){Ce.setForRemoval=!1,Ce.setForMove=!0;const ct=this.collectedLeaveElements.indexOf(F);ct>=0&&this.collectedLeaveElements.splice(ct,1)}if(M){const ct=this._fetchNamespace(M);ct&&ct.insertNode(F,G)}ue&&this.collectEnterElement(F)}collectEnterElement(M){this.collectedEnterElements.push(M)}markElementAsDisabled(M,F){F?this.disabledNodes.has(M)||(this.disabledNodes.add(M),Qo(M,io)):this.disabledNodes.has(M)&&(this.disabledNodes.delete(M),xs(M,io))}removeNode(M,F,G){if(Ms(F)){const ue=M?this._fetchNamespace(M):null;ue?ue.removeNode(F,G):this.markElementAsRemoved(M,F,!1,G);const Ce=this.namespacesByHostElement.get(F);Ce&&Ce.id!==M&&Ce.removeNode(F,G)}else this._onRemovalComplete(F,G)}markElementAsRemoved(M,F,G,ue,Ce){this.collectedLeaveElements.push(F),F[Ko]={namespaceId:M,setForRemoval:ue,hasAnimation:G,removedBeforeQueried:!1,previousTriggersValues:Ce}}listen(M,F,G,ue,Ce){return Ms(F)?this._fetchNamespace(M).listen(F,G,ue,Ce):()=>{}}_buildInstruction(M,F,G,ue,Ce){return M.transition.build(this.driver,M.element,M.fromState.value,M.toState.value,G,ue,M.fromState.options,M.toState.options,F,Ce)}destroyInnerAnimations(M){let F=this.driver.query(M,ke,!0);F.forEach(G=>this.destroyActiveAnimationsForElement(G)),0!=this.playersByQueriedElement.size&&(F=this.driver.query(M,dt,!0),F.forEach(G=>this.finishActiveQueriedAnimationOnElement(G)))}destroyActiveAnimationsForElement(M){const F=this.playersByElement.get(M);F&&F.forEach(G=>{G.queued?G.markedForDestroy=!0:G.destroy()})}finishActiveQueriedAnimationOnElement(M){const F=this.playersByQueriedElement.get(M);F&&F.forEach(G=>G.finish())}whenRenderingDone(){return new Promise(M=>{if(this.players.length)return Gn(this.players).onDone(()=>M());M()})}processLeaveNode(M){const F=M[Ko];if(F&&F.setForRemoval){if(M[Ko]=Wr,F.namespaceId){this.destroyInnerAnimations(M);const G=this._fetchNamespace(F.namespaceId);G&&G.clearElementCache(M)}this._onRemovalComplete(M,F.setForRemoval)}M.classList?.contains(io)&&this.markElementAsDisabled(M,!1),this.driver.query(M,".ng-animate-disabled",!0).forEach(G=>{this.markElementAsDisabled(G,!1)})}flush(M=-1){let F=[];if(this.newHostElements.size&&(this.newHostElements.forEach((G,ue)=>this._balanceNamespaceList(G,ue)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let G=0;G<this.collectedEnterElements.length;G++)Qo(this.collectedEnterElements[G],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const G=[];try{F=this._flushAnimations(G,M)}finally{for(let ue=0;ue<G.length;ue++)G[ue]()}}else for(let G=0;G<this.collectedLeaveElements.length;G++)this.processLeaveNode(this.collectedLeaveElements[G]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(G=>G()),this._flushFns=[],this._whenQuietFns.length){const G=this._whenQuietFns;this._whenQuietFns=[],F.length?Gn(F).onDone(()=>{G.forEach(ue=>ue())}):G.forEach(ue=>ue())}}reportError(M){throw function Ot(ce){return new b.vHH(3402,!1)}()}_flushAnimations(M,F){const G=new Pt,ue=[],Ce=new Map,ct=[],ut=new Map,Qt=new Map,Dn=new Map,Er=new Set;this.disabledNodes.forEach(kt=>{Er.add(kt);const Ut=this.driver.query(kt,".ng-animate-queued",!0);for(let tr=0;tr<Ut.length;tr++)Er.add(Ut[tr])});const ar=this.bodyNode,Ei=Array.from(this.statesByElement.keys()),ui=la(Ei,this.collectedEnterElements),Jr=new Map;let pi=0;ui.forEach((kt,Ut)=>{const tr=je+pi++;Jr.set(Ut,tr),kt.forEach(_r=>Qo(_r,tr))});const Mo=[],es=new Set,Go=new Set;for(let kt=0;kt<this.collectedLeaveElements.length;kt++){const Ut=this.collectedLeaveElements[kt],tr=Ut[Ko];tr&&tr.setForRemoval&&(Mo.push(Ut),es.add(Ut),tr.hasAnimation?this.driver.query(Ut,".ng-star-inserted",!0).forEach(_r=>es.add(_r)):Go.add(Ut))}const As=new Map,ss=la(Ei,Array.from(es));ss.forEach((kt,Ut)=>{const tr=ae+pi++;As.set(Ut,tr),kt.forEach(_r=>Qo(_r,tr))}),M.push(()=>{ui.forEach((kt,Ut)=>{const tr=Jr.get(Ut);kt.forEach(_r=>xs(_r,tr))}),ss.forEach((kt,Ut)=>{const tr=As.get(Ut);kt.forEach(_r=>xs(_r,tr))}),Mo.forEach(kt=>{this.processLeaveNode(kt)})});const va=[],fa=[];for(let kt=this._namespaceList.length-1;kt>=0;kt--)this._namespaceList[kt].drainQueuedTransitions(F).forEach(tr=>{const _r=tr.player,ti=tr.element;if(va.push(_r),this.collectedEnterElements.length){const uo=ti[Ko];if(uo&&uo.setForMove){if(uo.previousTriggersValues&&uo.previousTriggersValues.has(tr.triggerName)){const ho=uo.previousTriggersValues.get(tr.triggerName),Yi=this.statesByElement.get(tr.element);if(Yi&&Yi.has(tr.triggerName)){const zs=Yi.get(tr.triggerName);zs.value=ho,Yi.set(tr.triggerName,zs)}}return void _r.destroy()}}const Kr=!ar||!this.driver.containsElement(ar,ti),Pr=As.get(ti),Bi=Jr.get(ti),ni=this._buildInstruction(tr,G,Bi,Pr,Kr);if(ni.errors&&ni.errors.length)return void fa.push(ni);if(Kr)return _r.onStart(()=>At(ti,ni.fromStyles)),_r.onDestroy(()=>He(ti,ni.toStyles)),void ue.push(_r);if(tr.isFallbackTransition)return _r.onStart(()=>At(ti,ni.fromStyles)),_r.onDestroy(()=>He(ti,ni.toStyles)),void ue.push(_r);const co=[];ni.timelines.forEach(uo=>{uo.stretchStartingKeyframe=!0,this.disabledNodes.has(uo.element)||co.push(uo)}),ni.timelines=co,G.append(ti,ni.timelines),ct.push({instruction:ni,player:_r,element:ti}),ni.queriedElements.forEach(uo=>kr(ut,uo,[]).push(_r)),ni.preStyleProps.forEach((uo,ho)=>{if(uo.size){let Yi=Qt.get(ho);Yi||Qt.set(ho,Yi=new Set),uo.forEach((zs,Ao)=>Yi.add(Ao))}}),ni.postStyleProps.forEach((uo,ho)=>{let Yi=Dn.get(ho);Yi||Dn.set(ho,Yi=new Set),uo.forEach((zs,Ao)=>Yi.add(Ao))})});if(fa.length){const kt=[];fa.forEach(Ut=>{kt.push(function $t(ce,M){return new b.vHH(3505,!1)}())}),va.forEach(Ut=>Ut.destroy()),this.reportError(kt)}const Es=new Map,Ds=new Map;ct.forEach(kt=>{const Ut=kt.element;G.has(Ut)&&(Ds.set(Ut,Ut),this._beforeAnimationBuild(kt.player.namespaceId,kt.instruction,Es))}),ue.forEach(kt=>{const Ut=kt.element;this._getPreviousPlayers(Ut,!1,kt.namespaceId,kt.triggerName,null).forEach(_r=>{kr(Es,Ut,[]).push(_r),_r.destroy()})});const Cs=Mo.filter(kt=>Eo(kt,Qt,Dn)),k=new Map;fi(k,this.driver,Go,Dn,tt.l3).forEach(kt=>{Eo(kt,Qt,Dn)&&Cs.push(kt)});const Be=new Map;ui.forEach((kt,Ut)=>{fi(Be,this.driver,new Set(kt),Qt,tt.k1)}),Cs.forEach(kt=>{const Ut=k.get(kt),tr=Be.get(kt);k.set(kt,new Map([...Ut?.entries()??[],...tr?.entries()??[]]))});const W=[],be=[],_t={};ct.forEach(kt=>{const{element:Ut,player:tr,instruction:_r}=kt;if(G.has(Ut)){if(Er.has(Ut))return tr.onDestroy(()=>He(Ut,_r.toStyles)),tr.disabled=!0,tr.overrideTotalTime(_r.totalTime),void ue.push(tr);let ti=_t;if(Ds.size>1){let Pr=Ut;const Bi=[];for(;Pr=Pr.parentNode;){const ni=Ds.get(Pr);if(ni){ti=ni;break}Bi.push(Pr)}Bi.forEach(ni=>Ds.set(ni,ti))}const Kr=this._buildAnimation(tr.namespaceId,_r,Es,Ce,Be,k);if(tr.setRealPlayer(Kr),ti===_t)W.push(tr);else{const Pr=this.playersByElement.get(ti);Pr&&Pr.length&&(tr.parentPlayer=Gn(Pr)),ue.push(tr)}}else At(Ut,_r.fromStyles),tr.onDestroy(()=>He(Ut,_r.toStyles)),be.push(tr),Er.has(Ut)&&ue.push(tr)}),be.forEach(kt=>{const Ut=Ce.get(kt.element);if(Ut&&Ut.length){const tr=Gn(Ut);kt.setRealPlayer(tr)}}),ue.forEach(kt=>{kt.parentPlayer?kt.syncPlayerEvents(kt.parentPlayer):kt.destroy()});for(let kt=0;kt<Mo.length;kt++){const Ut=Mo[kt],tr=Ut[Ko];if(xs(Ut,ae),tr&&tr.hasAnimation)continue;let _r=[];if(ut.size){let Kr=ut.get(Ut);Kr&&Kr.length&&_r.push(...Kr);let Pr=this.driver.query(Ut,dt,!0);for(let Bi=0;Bi<Pr.length;Bi++){let ni=ut.get(Pr[Bi]);ni&&ni.length&&_r.push(...ni)}}const ti=_r.filter(Kr=>!Kr.destroyed);ti.length?os(this,Ut,ti):this.processLeaveNode(Ut)}return Mo.length=0,W.forEach(kt=>{this.players.push(kt),kt.onDone(()=>{kt.destroy();const Ut=this.players.indexOf(kt);this.players.splice(Ut,1)}),kt.play()}),W}afterFlush(M){this._flushFns.push(M)}afterFlushAnimationsDone(M){this._whenQuietFns.push(M)}_getPreviousPlayers(M,F,G,ue,Ce){let ct=[];if(F){const ut=this.playersByQueriedElement.get(M);ut&&(ct=ut)}else{const ut=this.playersByElement.get(M);if(ut){const Qt=!Ce||Ce==Ni;ut.forEach(Dn=>{Dn.queued||!Qt&&Dn.triggerName!=ue||ct.push(Dn)})}}return(G||ue)&&(ct=ct.filter(ut=>!(G&&G!=ut.namespaceId||ue&&ue!=ut.triggerName))),ct}_beforeAnimationBuild(M,F,G){const Ce=F.element,ct=F.isRemovalTransition?void 0:M,ut=F.isRemovalTransition?void 0:F.triggerName;for(const Qt of F.timelines){const Dn=Qt.element,Er=Dn!==Ce,ar=kr(G,Dn,[]);this._getPreviousPlayers(Dn,Er,ct,ut,F.toState).forEach(ui=>{const Jr=ui.getRealPlayer();Jr.beforeDestroy&&Jr.beforeDestroy(),ui.destroy(),ar.push(ui)})}At(Ce,F.fromStyles)}_buildAnimation(M,F,G,ue,Ce,ct){const ut=F.triggerName,Qt=F.element,Dn=[],Er=new Set,ar=new Set,Ei=F.timelines.map(Jr=>{const pi=Jr.element;Er.add(pi);const Mo=pi[Ko];if(Mo&&Mo.removedBeforeQueried)return new tt.ZN(Jr.duration,Jr.delay);const es=pi!==Qt,Go=function na(ce){const M=[];return Ho(ce,M),M}((G.get(pi)||Bo).map(Es=>Es.getRealPlayer())).filter(Es=>!!Es.element&&Es.element===pi),As=Ce.get(pi),ss=ct.get(pi),va=Cr(this._normalizer,Jr.keyframes,As,ss),fa=this._buildPlayer(Jr,va,Go);if(Jr.subTimeline&&ue&&ar.add(pi),es){const Es=new is(M,ut,pi);Es.setRealPlayer(fa),Dn.push(Es)}return fa});Dn.forEach(Jr=>{kr(this.playersByQueriedElement,Jr.element,[]).push(Jr),Jr.onDone(()=>function ea(ce,M,F){let G=ce.get(M);if(G){if(G.length){const ue=G.indexOf(F);G.splice(ue,1)}0==G.length&&ce.delete(M)}return G}(this.playersByQueriedElement,Jr.element,Jr))}),Er.forEach(Jr=>Qo(Jr,Ye));const ui=Gn(Ei);return ui.onDestroy(()=>{Er.forEach(Jr=>xs(Jr,Ye)),He(Qt,F.toStyles)}),ar.forEach(Jr=>{kr(ue,Jr,[]).push(ui)}),ui}_buildPlayer(M,F,G){return F.length>0?this.driver.animate(M.element,F,M.duration,M.delay,M.easing,G):new tt.ZN(M.duration,M.delay)}}class is{constructor(M,F,G){this.namespaceId=M,this.triggerName=F,this.element=G,this._player=new tt.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(M){this._containsRealPlayer||(this._player=M,this._queuedCallbacks.forEach((F,G)=>{F.forEach(ue=>Wn(M,G,void 0,ue))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(M.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(M){this.totalTime=M}syncPlayerEvents(M){const F=this._player;F.triggerCallback&&M.onStart(()=>F.triggerCallback("start")),M.onDone(()=>this.finish()),M.onDestroy(()=>this.destroy())}_queueEvent(M,F){kr(this._queuedCallbacks,M,[]).push(F)}onDone(M){this.queued&&this._queueEvent("done",M),this._player.onDone(M)}onStart(M){this.queued&&this._queueEvent("start",M),this._player.onStart(M)}onDestroy(M){this.queued&&this._queueEvent("destroy",M),this._player.onDestroy(M)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(M){this.queued||this._player.setPosition(M)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(M){const F=this._player;F.triggerCallback&&F.triggerCallback(M)}}function Ms(ce){return ce&&1===ce.nodeType}function Jo(ce,M){const F=ce.style.display;return ce.style.display=M??"none",F}function fi(ce,M,F,G,ue){const Ce=[];F.forEach(Qt=>Ce.push(Jo(Qt)));const ct=[];G.forEach((Qt,Dn)=>{const Er=new Map;Qt.forEach(ar=>{const Ei=M.computeStyle(Dn,ar,ue);Er.set(ar,Ei),(!Ei||0==Ei.length)&&(Dn[Ko]=Xo,ct.push(Dn))}),ce.set(Dn,Er)});let ut=0;return F.forEach(Qt=>Jo(Qt,Ce[ut++])),ct}function la(ce,M){const F=new Map;if(ce.forEach(ut=>F.set(ut,[])),0==M.length)return F;const ue=new Set(M),Ce=new Map;function ct(ut){if(!ut)return 1;let Qt=Ce.get(ut);if(Qt)return Qt;const Dn=ut.parentNode;return Qt=F.has(Dn)?Dn:ue.has(Dn)?1:ct(Dn),Ce.set(ut,Qt),Qt}return M.forEach(ut=>{const Qt=ct(ut);1!==Qt&&F.get(Qt).push(ut)}),F}function Qo(ce,M){ce.classList?.add(M)}function xs(ce,M){ce.classList?.remove(M)}function os(ce,M,F){Gn(F).onDone(()=>ce.processLeaveNode(M))}function Ho(ce,M){for(let F=0;F<ce.length;F++){const G=ce[F];G instanceof tt.ZE?Ho(G.players,M):M.push(G)}}function Eo(ce,M,F){const G=F.get(ce);if(!G)return!1;let ue=M.get(ce);return ue?G.forEach(Ce=>ue.add(Ce)):M.set(ce,G),F.delete(ce),!0}class Hs{constructor(M,F,G){this.bodyNode=M,this._driver=F,this._normalizer=G,this._triggerCache={},this.onRemovalComplete=(ue,Ce)=>{},this._transitionEngine=new vs(M,F,G),this._timelineEngine=new qi(M,F,G),this._transitionEngine.onRemovalComplete=(ue,Ce)=>this.onRemovalComplete(ue,Ce)}registerTrigger(M,F,G,ue,Ce){const ct=M+"-"+ue;let ut=this._triggerCache[ct];if(!ut){const Qt=[],Er=Ui(this._driver,Ce,Qt,[]);if(Qt.length)throw function an(ce,M){return new b.vHH(3404,!1)}();ut=function vo(ce,M,F){return new ha(ce,M,F)}(ue,Er,this._normalizer),this._triggerCache[ct]=ut}this._transitionEngine.registerTrigger(F,ue,ut)}register(M,F){this._transitionEngine.register(M,F)}destroy(M,F){this._transitionEngine.destroy(M,F)}onInsert(M,F,G,ue){this._transitionEngine.insertNode(M,F,G,ue)}onRemove(M,F,G){this._transitionEngine.removeNode(M,F,G)}disableAnimations(M,F){this._transitionEngine.markElementAsDisabled(M,F)}process(M,F,G,ue){if("@"==G.charAt(0)){const[Ce,ct]=An(G);this._timelineEngine.command(Ce,F,ct,ue)}else this._transitionEngine.trigger(M,F,G,ue)}listen(M,F,G,ue,Ce){if("@"==G.charAt(0)){const[ct,ut]=An(G);return this._timelineEngine.listen(ct,F,ut,Ce)}return this._transitionEngine.listen(M,F,G,ue,Ce)}flush(M=-1){this._transitionEngine.flush(M)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(M){this._transitionEngine.afterFlushAnimationsDone(M)}}let us=(()=>{class M{constructor(G,ue,Ce){this._element=G,this._startStyles=ue,this._endStyles=Ce,this._state=0;let ct=M.initialStylesByElement.get(G);ct||M.initialStylesByElement.set(G,ct=new Map),this._initialStyles=ct}start(){this._state<1&&(this._startStyles&&He(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(He(this._element,this._initialStyles),this._endStyles&&(He(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(M.initialStylesByElement.delete(this._element),this._startStyles&&(At(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(At(this._element,this._endStyles),this._endStyles=null),He(this._element,this._initialStyles),this._state=3)}}return M.initialStylesByElement=new WeakMap,M})();function ya(ce){let M=null;return ce.forEach((F,G)=>{(function ds(ce){return"display"===ce||"position"===ce})(G)&&(M=M||new Map,M.set(G,F))}),M}class bs{constructor(M,F,G,ue){this.element=M,this.keyframes=F,this.options=G,this._specialStyles=ue,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=G.duration,this._delay=G.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(M=>M()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const M=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,M,this.options),this._finalKeyframe=M.length?M[M.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(M){const F=[];return M.forEach(G=>{F.push(Object.fromEntries(G))}),F}_triggerWebAnimation(M,F,G){return M.animate(this._convertKeyframesToObject(F),G)}onStart(M){this._originalOnStartFns.push(M),this._onStartFns.push(M)}onDone(M){this._originalOnDoneFns.push(M),this._onDoneFns.push(M)}onDestroy(M){this._onDestroyFns.push(M)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(M=>M()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(M=>M()),this._onDestroyFns=[])}setPosition(M){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=M*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const M=new Map;this.hasStarted()&&this._finalKeyframe.forEach((G,ue)=>{"offset"!==ue&&M.set(ue,this._finished?G:zn(this.element,ue))}),this.currentSnapshot=M}triggerCallback(M){const F="start"===M?this._onStartFns:this._onDoneFns;F.forEach(G=>G()),F.length=0}}class S{validateStyleProperty(M){return!0}validateAnimatableStyleProperty(M){return!0}matchesElement(M,F){return!1}containsElement(M,F){return $i(M,F)}getParentElement(M){return to(M)}query(M,F,G){return Lr(M,F,G)}computeStyle(M,F,G){return window.getComputedStyle(M)[F]}animate(M,F,G,ue,Ce,ct=[]){const Qt={duration:G,delay:ue,fill:0==ue?"both":"forwards"};Ce&&(Qt.easing=Ce);const Dn=new Map,Er=ct.filter(ui=>ui instanceof bs);(function tn(ce,M){return 0===ce||0===M})(G,ue)&&Er.forEach(ui=>{ui.currentSnapshot.forEach((Jr,pi)=>Dn.set(pi,Jr))});let ar=function Je(ce){return ce.length?ce[0]instanceof Map?ce:ce.map(M=>Ln(M)):[]}(F).map(ui=>Dt(ui));ar=function Xt(ce,M,F){if(F.size&&M.length){let G=M[0],ue=[];if(F.forEach((Ce,ct)=>{G.has(ct)||ue.push(ct),G.set(ct,Ce)}),ue.length)for(let Ce=1;Ce<M.length;Ce++){let ct=M[Ce];ue.forEach(ut=>ct.set(ut,zn(ce,ut)))}}return M}(M,ar,Dn);const Ei=function xo(ce,M){let F=null,G=null;return Array.isArray(M)&&M.length?(F=ya(M[0]),M.length>1&&(G=ya(M[M.length-1]))):M instanceof Map&&(F=ya(M)),F||G?new us(ce,F,G):null}(M,ar);return new bs(M,ar,Qt,Ei)}}var K=oe(6814);let I=(()=>{var ce;class M extends tt._j{constructor(G,ue){super(),this._nextAnimationId=0,this._renderer=G.createRenderer(ue.body,{id:"0",encapsulation:b.ifc.None,styles:[],data:{animation:[]}})}build(G){const ue=this._nextAnimationId.toString();this._nextAnimationId++;const Ce=Array.isArray(G)?(0,tt.vP)(G):G;return Tn(this._renderer,null,ue,"register",[Ce]),new ee(ue,this._renderer)}}return(ce=M).\u0275fac=function(G){return new(G||ce)(b.LFG(b.FYo),b.LFG(K.K0))},ce.\u0275prov=b.Yz7({token:ce,factory:ce.\u0275fac}),M})();class ee extends tt.LC{constructor(M,F){super(),this._id=M,this._renderer=F}create(M,F){return new xe(this._id,M,F||{},this._renderer)}}class xe{constructor(M,F,G,ue){this.id=M,this.element=F,this._renderer=ue,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",G)}_listen(M,F){return this._renderer.listen(this.element,`@@${this.id}:${M}`,F)}_command(M,...F){return Tn(this._renderer,this.element,this.id,M,F)}onDone(M){this._listen("done",M)}onStart(M){this._listen("start",M)}onDestroy(M){this._listen("destroy",M)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(M){this._command("setPosition",M)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function Tn(ce,M,F,G,ue){return ce.setProperty(M,`@@${F}:${G}`,ue)}const dr="@.disabled";let Hi=(()=>{var ce;class M{constructor(G,ue,Ce){this.delegate=G,this.engine=ue,this._zone=Ce,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,ue.onRemovalComplete=(ct,ut)=>{const Qt=ut?.parentNode(ct);Qt&&ut.removeChild(Qt,ct)}}createRenderer(G,ue){const ct=this.delegate.createRenderer(G,ue);if(!(G&&ue&&ue.data&&ue.data.animation)){let ar=this._rendererCache.get(ct);return ar||(ar=new lo("",ct,this.engine,()=>this._rendererCache.delete(ct)),this._rendererCache.set(ct,ar)),ar}const ut=ue.id,Qt=ue.id+"-"+this._currentId;this._currentId++,this.engine.register(Qt,G);const Dn=ar=>{Array.isArray(ar)?ar.forEach(Dn):this.engine.registerTrigger(ut,Qt,G,ar.name,ar)};return ue.data.animation.forEach(Dn),new Q(this,Qt,ct,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(G,ue,Ce){G>=0&&G<this._microtaskId?this._zone.run(()=>ue(Ce)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(ct=>{const[ut,Qt]=ct;ut(Qt)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([ue,Ce]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(ce=M).\u0275fac=function(G){return new(G||ce)(b.LFG(b.FYo),b.LFG(Hs),b.LFG(b.R0b))},ce.\u0275prov=b.Yz7({token:ce,factory:ce.\u0275fac}),M})();class lo{constructor(M,F,G,ue){this.namespaceId=M,this.delegate=F,this.engine=G,this._onDestroy=ue}get data(){return this.delegate.data}destroyNode(M){this.delegate.destroyNode?.(M)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(M,F){return this.delegate.createElement(M,F)}createComment(M){return this.delegate.createComment(M)}createText(M){return this.delegate.createText(M)}appendChild(M,F){this.delegate.appendChild(M,F),this.engine.onInsert(this.namespaceId,F,M,!1)}insertBefore(M,F,G,ue=!0){this.delegate.insertBefore(M,F,G),this.engine.onInsert(this.namespaceId,F,M,ue)}removeChild(M,F,G){this.engine.onRemove(this.namespaceId,F,this.delegate)}selectRootElement(M,F){return this.delegate.selectRootElement(M,F)}parentNode(M){return this.delegate.parentNode(M)}nextSibling(M){return this.delegate.nextSibling(M)}setAttribute(M,F,G,ue){this.delegate.setAttribute(M,F,G,ue)}removeAttribute(M,F,G){this.delegate.removeAttribute(M,F,G)}addClass(M,F){this.delegate.addClass(M,F)}removeClass(M,F){this.delegate.removeClass(M,F)}setStyle(M,F,G,ue){this.delegate.setStyle(M,F,G,ue)}removeStyle(M,F,G){this.delegate.removeStyle(M,F,G)}setProperty(M,F,G){"@"==F.charAt(0)&&F==dr?this.disableAnimations(M,!!G):this.delegate.setProperty(M,F,G)}setValue(M,F){this.delegate.setValue(M,F)}listen(M,F,G){return this.delegate.listen(M,F,G)}disableAnimations(M,F){this.engine.disableAnimations(M,F)}}class Q extends lo{constructor(M,F,G,ue,Ce){super(F,G,ue,Ce),this.factory=M,this.namespaceId=F}setProperty(M,F,G){"@"==F.charAt(0)?"."==F.charAt(1)&&F==dr?this.disableAnimations(M,G=void 0===G||!!G):this.engine.process(this.namespaceId,M,F.slice(1),G):this.delegate.setProperty(M,F,G)}listen(M,F,G){if("@"==F.charAt(0)){const ue=function Z(ce){switch(ce){case"body":return document.body;case"document":return document;case"window":return window;default:return ce}}(M);let Ce=F.slice(1),ct="";return"@"!=Ce.charAt(0)&&([Ce,ct]=function ge(ce){const M=ce.indexOf(".");return[ce.substring(0,M),ce.slice(M+1)]}(Ce)),this.engine.listen(this.namespaceId,ue,Ce,ct,ut=>{this.factory.scheduleListenerCallback(ut._data||-1,G,ut)})}return this.delegate.listen(M,F,G)}}const Xr=[{provide:tt._j,useClass:I},{provide:Si,useFactory:function Fe(){return new Gr}},{provide:Hs,useClass:(()=>{var ce;class M extends Hs{constructor(G,ue,Ce,ct){super(G.body,ue,Ce)}ngOnDestroy(){this.flush()}}return(ce=M).\u0275fac=function(G){return new(G||ce)(b.LFG(K.K0),b.LFG(ai),b.LFG(Si),b.LFG(b.z2F))},ce.\u0275prov=b.Yz7({token:ce,factory:ce.\u0275fac}),M})()},{provide:b.FYo,useFactory:function Zn(ce,M,F){return new Hi(ce,M,F)},deps:[T.se,Hs,b.R0b]}],qo=[{provide:ai,useFactory:()=>new S},{provide:b.QbO,useValue:"BrowserAnimations"},...Xr],hs=[{provide:ai,useClass:Gi},{provide:b.QbO,useValue:"NoopAnimations"},...Xr];let ws=(()=>{var ce;class M{static withConfig(G){return{ngModule:M,providers:G.disableAnimations?hs:qo}}}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275mod=b.oAB({type:ce}),ce.\u0275inj=b.cJS({providers:qo,imports:[T.b2]}),M})();var Bs=oe(9862),Ns=oe(5882);let al=(()=>{var ce;class M{}return(ce=M).\u0275fac=function(G){return new(G||ce)},ce.\u0275mod=b.oAB({type:ce,bootstrap:[Ee]}),ce.\u0275inj=b.cJS({providers:[{provide:Lt.wN,useClass:l.r4},Ns.l],imports:[T.b2,l.Pc.forRoot(),vt,ws,Bs.JF]}),M})();var Ya=oe(2574);oe.n(Ya)().accessToken="pk.eyJ1IjoicGF0MWhubyIsImEiOiJjbG5naWgyOXIwYnF2Mm1vOXhueWFtbXM4In0.zfLtRF__vmCcRycCOuJbPw",(0,b.G48)(),T.q6().bootstrapModule(al).catch(ce=>console.log(ce))},2574:function(fr){fr.exports=function(){"use strict";var en,oe,T;function b(l,Ee){if(en)if(oe){var ot="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+en+")(sharedChunk); ("+oe+")(sharedChunk); self.onerror = null;",qe={};en(qe),T=Ee(qe),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(T.workerUrl=window.URL.createObjectURL(new Blob([ot],{type:"text/javascript"})))}else oe=Ee;else en=Ee}return b(0,function(l){var Ee=typeof self<"u"?self:{},ot="2.15.0";let qe;const Et={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==qe){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{qe=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):n}catch{qe=n}}return qe},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Et.API_URL)return null;try{const n=new URL(Et.API_URL);return"api.mapbox.cn"===n.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===n.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},vt={supported:!1,testSupport:function(n){!wt&&nt&&(ht?et(n):tt=n)}};let tt,nt,wt=!1,ht=!1;function et(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,nt),n.isContextLost())return;vt.supported=!0}catch{}n.deleteTexture(e),wt=!0}Ee.document&&(nt=Ee.document.createElement("img"),nt.onload=function(){tt&&et(tt),tt=null,ht=!0},nt.onerror=function(){wt=!0,tt=null},nt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xt="01";function Kt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var It=st;function st(n,e,r,s){this.cx=3*n,this.bx=3*(r-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=r,this.p2y=s}st.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(void 0===e&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var r=n,s=0;s<8;s++){var u=this.sampleCurveX(r)-n;if(Math.abs(u)<e)return r;var f=this.sampleCurveDerivativeX(r);if(Math.abs(f)<1e-6)break;r-=u/f}var g=0,y=1;for(r=n,s=0;s<20&&(u=this.sampleCurveX(r),!(Math.abs(u-n)<e));s++)n>u?g=r:y=r,r=.5*(y-g)+g;return r},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var sn=Kt(It),Tt=Ge;function Ge(n,e){this.x=n,this.y=e}Ge.prototype={clone:function(){return new Ge(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,r=n.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),r=Math.sin(n),s=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=s,this},_rotateAround:function(n,e){var r=Math.cos(n),s=Math.sin(n),u=e.y+s*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ge.convert=function(n){return n instanceof Ge?n:Array.isArray(n)?new Ge(n[0],n[1]):n};var Le=Kt(Tt);const Yt=Math.PI/180,_n=180/Math.PI;function De(n){return n*Yt}function ft(n){return n*_n}const Nt=[[0,0],[1,0],[1,1],[0,1]];function yt(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,r=e*n;return 4*(n<.5?r:3*(n-e)+r-.75)}function mn(n,e,r,s){const u=new sn(n,e,r,s);return function(f){return u.solve(f)}}const hn=mn(.25,.1,.25,1);function Gt(n,e,r){return Math.min(r,Math.max(e,n))}function nr(n,e,r){return(r=Gt((r-n)/(e-n),0,1))*r*(3-2*r)}function Wt(n,e,r){const s=r-e,u=((n-e)%s+s)%s+e;return u===e?r:u}function pr(n,e,r){if(!n.length)return r(null,[]);let s=n.length;const u=new Array(n.length);let f=null;n.forEach((g,y)=>{e(g,(w,E)=>{w&&(f=w),u[y]=E,0==--s&&r(f,u)})})}function an(n){const e=[];for(const r in n)e.push(n[r]);return e}function Me(n,...e){for(const r of e)for(const s in r)n[s]=r[s];return n}let Ue=1;function at(){return Ue++}function Rt(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function cn(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function un(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function Qn(n,e){n.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function ur(n,e){return-1!==n.indexOf(e,n.length-e.length)}function Mn(n,e,r){const s={};for(const u in n)s[u]=e.call(r||this,n[u],u,n);return s}function Ot(n,e,r){const s={};for(const u in n)e.call(r||this,n[u],u,n)&&(s[u]=n[u]);return s}function qt(n){return Array.isArray(n)?n.map(qt):"object"==typeof n&&n?Mn(n,qt):n}const $t={};function vn(n){$t[n]||(typeof console<"u"&&console.warn(n),$t[n]=!0)}function Gn(n,e,r){return(r.y-n.y)*(e.x-n.x)>(e.y-n.y)*(r.x-n.x)}function Cr(n){let e=0;for(let r,s,u=0,f=n.length,g=f-1;u<f;g=u++)r=n[u],s=n[g],e+=(s.x-r.x)*(r.y+s.y);return e}function Wn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Dr(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,s,u,f)=>{const g=u||f;return e[s]=!g||g.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let er=null;function kr(n){if(null==er){const e=n.navigator?n.navigator.userAgent:null;er=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return er}function An(n){try{const e=Ee[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function vi(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const to="mapbox-tiles";let Ir,Hr,Ai=500,zi=50;function Lo(){try{return Ee.caches}catch{}}function Tr(){Lo()&&!Ir&&(Ir=Ee.caches.open(to))}function $i(n){const e=n.indexOf("?");if(e<0)return n;const s=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(n).filter(u=>{const f=u.split("=");return"language"===f[0]||"worldview"===f[0]});return s.length?`${n.slice(0,e)}?${s.join("&")}`:n.slice(0,e)}let Lr=1/0;const si={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(si);class Gi extends Error{constructor(e,r,s){401===r&&Mt(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ai=Wn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Ee.location.protocol?Ee.parent:Ee).location.href,Pi=function(n,e){if(!(/^file:/.test(r=n.url)||/^file:/.test(ai())&&!/^\w+:/.test(r))){if(Ee.fetch&&Ee.Request&&Ee.AbortController&&Ee.Request.prototype.hasOwnProperty("signal"))return function(s,u){const f=new Ee.AbortController,g=new Ee.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:ai(),referrerPolicy:s.referrerPolicy,signal:f.signal});let y=!1,w=!1;const E=(O=g.url).indexOf("sku=")>0&&Mt(O);var O;"json"===s.type&&g.headers.set("Accept","application/json");const z=(q,J,se)=>{if(w)return;if(q&&"SecurityError"!==q.message&&vn(q.toString()),J&&se)return U(J);const me=Date.now();Ee.fetch(g).then(Pe=>{if(Pe.ok){const Xe=E?Pe.clone():null;return U(Pe,Xe,me)}return u(new Gi(Pe.statusText,Pe.status,s.url))}).catch(Pe=>{"AbortError"!==Pe.name&&u(new Error(`${Pe.message} ${s.url}`))})},U=(q,J,se)=>{("arrayBuffer"===s.type?q.arrayBuffer():"json"===s.type?q.json():q.text()).then(me=>{w||(J&&se&&function(Pe,Xe,Ae){if(Tr(),!Ir)return;const We={status:Xe.status,statusText:Xe.statusText,headers:new Ee.Headers};Xe.headers.forEach((rn,Ht)=>We.headers.set(Ht,rn));const it=Dr(Xe.headers.get("Cache-Control")||"");if(it["no-store"])return;it["max-age"]&&We.headers.set("Expires",new Date(Ae+1e3*it["max-age"]).toUTCString());const Qe=We.headers.get("Expires");Qe&&(new Date(Qe).getTime()-Ae<42e4||function(rn,Ht){if(void 0===Hr)try{new Response(new ReadableStream),Hr=!0}catch{Hr=!1}Hr?Ht(rn.body):rn.blob().then(Ht)}(Xe,rn=>{const Ht=new Ee.Response(rn,We);Tr(),Ir&&Ir.then(xn=>xn.put($i(Pe.url),Ht)).catch(xn=>vn(xn.message))}))}(g,J,se),y=!0,u(null,me,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(me=>{w||u(new Error(me.message))})};return E?function(q,J){if(Tr(),!Ir)return J(null);const se=$i(q.url);Ir.then(me=>{me.match(se).then(Pe=>{const Xe=function(Ae){if(!Ae)return!1;const We=new Date(Ae.headers.get("Expires")||0),it=Dr(Ae.headers.get("Cache-Control")||"");return We>Date.now()&&!it["no-cache"]}(Pe);me.delete(se),Xe&&me.put(se,Pe.clone()),J(null,Pe,Xe)}).catch(J)}).catch(J)}(g,z):z(null,null),{cancel:()=>{w=!0,y||f.abort()}}}(n,e);if(Wn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var r;return function(s,u){const f=new Ee.XMLHttpRequest;f.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(f.responseType="arraybuffer");for(const g in s.headers)f.setRequestHeader(g,s.headers[g]);return"json"===s.type&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials="include"===s.credentials,f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||0===f.status)&&null!==f.response){let g=f.response;if("json"===s.type)try{g=JSON.parse(f.response)}catch(y){return u(y)}u(null,g,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new Gi(f.statusText,f.status,s.url))},f.send(s.body),{cancel:()=>f.abort()}}(n,e)},ii=function(n,e){return Pi(Me(n,{type:"arrayBuffer"}),e)};function cs(n){const e=Ee.document.createElement("a");return e.href=n,e.protocol===Ee.document.location.protocol&&e.host===Ee.document.location.host}const je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ae,de;ae=[],de=0;const ke=function(n,e){if(vt.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),de>=Et.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return ae.push(f),f}de++;let r=!1;const s=()=>{if(!r)for(r=!0,de--;ae.length&&de<Et.MAX_PARALLEL_IMAGE_REQUESTS;){const f=ae.shift(),{requestParameters:g,callback:y,cancelled:w}=f;w||(f.cancel=ke(g,y).cancel)}},u=ii(n,(f,g,y,w)=>{s(),f?e(f):g&&(Ee.createImageBitmap?function(E,O){const z=new Ee.Blob([new Uint8Array(E)],{type:"image/png"});Ee.createImageBitmap(z).then(U=>{O(null,U)}).catch(U=>{O(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(E,O)=>e(E,O,y,w)):function(E,O){const z=new Ee.Image,U=Ee.URL;z.onload=()=>{O(null,z),U.revokeObjectURL(z.src),z.onload=null,Ee.requestAnimationFrame(()=>{z.src=je})},z.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Ee.Blob([new Uint8Array(E)],{type:"image/png"});z.src=E.byteLength?U.createObjectURL(q):je}(g,(E,O)=>e(E,O,y,w)))});return{cancel:()=>{u.cancel(),s()}}},Ye="NO_ACCESS_TOKEN";function dt(n){return 0===n.indexOf("mapbox:")}function Mt(n){return Et.API_URL_REGEX.test(n)}function St(n){return Et.API_CDN_URL_REGEX.test(n)}function lt(n){return Et.API_STYLE_REGEX.test(n)&&!Vt(n)}function Vt(n){return Et.API_SPRITE_REGEX.test(n)}const En=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ln(n){const e=n.match(En);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Je(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}const Ze="mapbox.eventData";function Dt(n){if(!n)return null;const e=n.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Ee.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class He{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=Dt(Et.ACCESS_TOKEN);let s="";return s=r&&r.u?Ee.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(+("0x"+f)))):Et.ACCESS_TOKEN||"",e?`${Ze}.${e}:${s}`:`${Ze}:${s}`}fetchEventData(){const e=An("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const u=Ee.localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));const f=Ee.localStorage.getItem(s);f&&(this.anonId=f)}catch{vn("Unable to read from LocalStorage")}}saveEventData(){const e=An("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{Ee.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&Ee.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{vn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,s,u){if(!Et.EVENTS_URL)return;const f=Ln(Et.EVENTS_URL);f.params.push(`access_token=${u||Et.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(e).toISOString()},y=r?Me(g,r):g,w={url:Je(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};var O;this.pendingRequest=(O=E=>{this.pendingRequest=null,s(E),this.saveEventData(),this.processRequests(u)},Pi(Me(w,{method:"POST"}),O))}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const At=new class extends He{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){Et.EVENTS_URL&&Et.ACCESS_TOKEN&&Array.isArray(n)&&n.some(r=>dt(r)||Mt(r))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Dt(Et.ACCESS_TOKEN),r=e?e.u:Et.ACCESS_TOKEN;let s=r!==this.eventData.tokenU;un(this.anonId)||(this.anonId=Rt(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),g=new Date(u),y=(u-this.eventData.lastSuccess)/864e5;s=s||y>=1||y<-1||f.getDate()!==g.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ot,skuId:xt,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},n):this.processRequests()}},dn=At.postTurnstileEvent.bind(At),qn=new class extends He{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,r,s){this.skuToken=e,this.errorCb=s,Et.EVENTS_URL&&(r||Et.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},r):this.errorCb(new Error(Ye)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),un(this.anonId)||(this.anonId=Rt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ot,skuId:xt,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n))}},gr=qn.postMapLoadEvent.bind(qn),Mr=new class extends He{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){Et.EVENTS_URL&&(n||Et.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:r}=this.queue.shift(),s=function(u){const f=Ee.performance.getEntriesByType("resource"),g=Ee.performance.getEntriesByType("mark"),y=function(U){const q={};if(U)for(const J in U)if("other"!==J)for(const se of U[J]){const me=`${J}ResolveRangeMin`,Pe=`${J}ResolveRangeMax`,Xe=`${J}RequestCount`,Ae=`${J}RequestCachedCount`;q[me]=Math.min(q[me]||1/0,se.startTime),q[Pe]=Math.max(q[Pe]||-1/0,se.responseEnd);const We=it=>{void 0===q[it]&&(q[it]=0),++q[it]};void 0!==se.transferSize&&0===se.transferSize&&We(Ae),We(Xe)}return q}(function(U,q){const J={};if(U)for(const se of U){const me=q(se);void 0===J[me]&&(J[me]=[]),J[me].push(se)}return J}(f,Xt)),w=Ee.devicePixelRatio,E=Ee.navigator.connection||Ee.navigator.mozConnection||Ee.navigator.webkitConnection,O={counters:[],metadata:[],attributes:[]},z=(U,q,J)=>{null!=J&&U.push({name:q,value:J.toString()})};for(const U in y)z(O.counters,U,y[U]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(z(O.counters,"interactionRangeMin",u.interactionRange[0]),z(O.counters,"interactionRangeMax",u.interactionRange[1])),g)for(const U of Object.keys(Ke)){const q=Ke[U],J=g.find(se=>se.name===q);J&&z(O.counters,q,J.startTime)}return z(O.counters,"visibilityHidden",u.visibilityHidden),z(O.attributes,"style",function(U){if(U)for(const q of U){const J=q.name.split("?")[0];if(lt(J)){const se=J.split("/").slice(-2);if(2===se.length)return`mapbox://styles/${se[0]}/${se[1]}`}}}(f)),z(O.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),z(O.attributes,"fogEnabled",u.fogEnabled?"true":"false"),z(O.attributes,"projection",u.projection),z(O.attributes,"zoom",u.zoom),z(O.metadata,"devicePixelRatio",w),z(O.metadata,"connectionEffectiveType",E?E.effectiveType:void 0),z(O.metadata,"navigatorUserAgent",Ee.navigator.userAgent),z(O.metadata,"screenWidth",Ee.screen.width),z(O.metadata,"screenHeight",Ee.screen.height),z(O.metadata,"windowWidth",Ee.innerWidth),z(O.metadata,"windowHeight",Ee.innerHeight),z(O.metadata,"mapWidth",u.width/w),z(O.metadata,"mapHeight",u.height/w),z(O.metadata,"webglRenderer",u.renderer),z(O.metadata,"webglVendor",u.vendor),z(O.metadata,"sdkVersion",ot),z(O.metadata,"sdkIdentifier","mapbox-gl-js"),O}(r);for(const u of s.metadata);for(const u of s.counters);for(const u of s.attributes);this.postEvent(e,s,()=>{},n)}},$r=Mr.postPerformanceEvent.bind(Mr),Qr=new class extends He{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,r,s){if(!Et.API_URL||!Et.SESSION_PATH)return;const u=Ln(Et.API_URL+Et.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||Et.ACCESS_TOKEN||""}`);const f={url:Je(u),headers:{"Content-Type":"text/plain"}};var y;this.pendingRequest=(y=g=>{this.pendingRequest=null,r(g),this.saveEventData(),this.processRequests(s)},Pi(Me(f,{method:"GET"}),y))}getSessionAPI(n,e,r,s){this.skuToken=e,this.errorCb=s,Et.SESSION_PATH&&Et.API_URL&&(r||Et.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},r):this.errorCb(new Error(Ye)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n)}},Oi=Qr.getSessionAPI.bind(Qr),rt=new Set,Ke={create:"create",load:"load",fullLoad:"fullLoad"},tn={mark(n){Ee.performance.mark(n)},measure(n,e,r){Ee.performance.measure(n,e,r)}};function Xt(n){const e=n.name.split("?")[0];return St(e)&&e.includes("mapbox-gl.js")?"javascript":St(e)&&e.includes("mapbox-gl.css")?"css":Et.API_FONTS_REGEX.test(e)?"fontRange":Vt(e)?"sprite":lt(e)?"style":Et.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const yn=Ee.performance;function zn(n){const e=n?n.url.toString():void 0;return yn.getEntriesByName(e)}let br,or,hi,Sr;const mi={now:()=>void 0!==hi?hi:Ee.performance.now(),setNow(n){hi=n},restoreNow(){hi=void 0},frame(n){const e=Ee.requestAnimationFrame(n);return{cancel:()=>Ee.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:r,height:s}=n;Sr||(Sr=Ee.document.createElement("canvas"));const u=Sr.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>Sr.width||s>Sr.height)&&(Sr.width=r,Sr.height=s),u.clearRect(-e,-e,r+2*e,s+2*e),u.drawImage(n,0,0,r,s),u.getImageData(-e,-e,r+2*e,s+2*e)},resolveURL:n=>(br||(br=Ee.document.createElement("a")),br.href=n,br.href),get devicePixelRatio(){return Ee.devicePixelRatio},get prefersReducedMotion(){return!!Ee.matchMedia&&(null==or&&(or=Ee.matchMedia("(prefers-reduced-motion: reduce)")),or.matches)}};function Yr(n,e,r){r[n]&&-1!==r[n].indexOf(e)||(r[n]=r[n]||[],r[n].push(e))}function li(n,e,r){if(r&&r[n]){const s=r[n].indexOf(e);-1!==s&&r[n].splice(s,1)}}class bi{constructor(e,r={}){Me(this,r),this.type=e}}class Ur extends bi{constructor(e,r={}){super("error",Me({error:e},r))}}class So{on(e,r){return this._listeners=this._listeners||{},Yr(e,r,this._listeners),this}off(e,r){return li(e,r,this._listeners),li(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Yr(e,r,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,r){"string"==typeof e&&(e=new bi(e,r||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const y of u)y.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const y of f)li(s,y,this._oneTimeListeners),y.call(this,e);const g=this._eventedParent;g&&(Me(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof Ur&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var zt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ei(n,...e){for(const r of e)for(const s in r)n[s]=r[s];return n}function Ri(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Fi(n){if(Array.isArray(n))return n.map(Fi);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const r in n)e[r]=Fi(n[r]);return e}return Ri(n)}class Vi extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var Ui=Vi;class _o{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[s,u]of r)this.bindings[s]=u}concat(e){return new _o(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var so=_o;const yo={kind:"null"},Kn={kind:"number"},Br={kind:"string"},le={kind:"boolean"},Oe={kind:"color"},pe={kind:"object"},Se={kind:"value"},bt={kind:"collator"},Pt={kind:"formatted"},fn={kind:"resolvedImage"};function bn(n,e){return{kind:"array",itemType:n,N:e}}function pn(n){if("array"===n.kind){const e=pn(n.itemType);return"number"==typeof n.N?`array<${e}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${e}>`}return n.kind}const Pn=[yo,Kn,Br,le,Oe,Pt,pe,bn(Se),fn];function lr(n,e){if("error"===e.kind)return null;if("array"===n.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!lr(n.itemType,e.itemType))&&("number"!=typeof n.N||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if("value"===n.kind)for(const r of Pn)if(!lr(r,e))return null}return`Expected ${pn(n)} but found ${pn(e)} instead.`}function Ar(n,e){return e.some(r=>r.kind===n.kind)}function Zr(n,e){return e.some(r=>"null"===r?null===n:"array"===r?Array.isArray(n):"object"===r?n&&!Array.isArray(n)&&"object"==typeof n:r===typeof n)}var ji,zo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ki(n){return(n=Math.round(n))<0?0:n>255?255:n}function Zo(n){return Ki("%"===n[n.length-1]?parseFloat(n)/100*255:parseInt(n))}function ao(n){return(e="%"===n[n.length-1]?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function Io(n,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?n+(e-n)*r*6:2*r<1?e:3*r<2?n+(e-n)*(2/3-r)*6:n}try{ji={}.parseCSSColor=function(n){var e,r=n.replace(/ /g,"").toLowerCase();if(r in zo)return zo[r].slice();if("#"===r[0])return 4===r.length?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===r.length&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=r.indexOf("("),u=r.indexOf(")");if(-1!==s&&u+1===r.length){var f=r.substr(0,s),g=r.substr(s+1,u-(s+1)).split(","),y=1;switch(f){case"rgba":if(4!==g.length)return null;y=ao(g.pop());case"rgb":return 3!==g.length?null:[Zo(g[0]),Zo(g[1]),Zo(g[2]),y];case"hsla":if(4!==g.length)return null;y=ao(g.pop());case"hsl":if(3!==g.length)return null;var w=(parseFloat(g[0])%360+360)%360/360,E=ao(g[1]),O=ao(g[2]),z=O<=.5?O*(E+1):O+E-O*E,U=2*O-z;return[Ki(255*Io(U,z,w+1/3)),Ki(255*Io(U,z,w)),Ki(255*Io(U,z,w-1/3)),y];default:return null}}return null}}catch{}class ro{constructor(e,r,s,u=1){this.r=e,this.g=r,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof ro)return e;if("string"!=typeof e)return;const r=ji(e);return r?new ro(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,s,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(s)},${u})`}toArray(){const{r:e,g:r,b:s,a:u}=this;return 0===u?[0,0,0,0]:[255*e/u,255*r/u,255*s/u,u]}toArray01(){const{r:e,g:r,b:s,a:u}=this;return 0===u?[0,0,0,0]:[e/u,r/u,s/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:s,a:u}=this;return[e,r,s,u]}}ro.black=new ro(0,0,0,1),ro.white=new ro(1,1,1,1),ro.transparent=new ro(0,0,0,0),ro.red=new ro(1,0,0,1),ro.blue=new ro(0,0,1,1);var Si=ro;class wa{constructor(e,r,s){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class sa{constructor(e,r,s,u,f){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=s,this.fontStack=u,this.textColor=f}}class Gr{constructor(e){this.sections=e}static fromString(e){return new Gr([new sa(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Gr?e:Gr.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(s)}return e}}class Ii{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ii({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Fo(n,e,r,s){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[n,e,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[n,e,r,s]:[n,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function gs(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof Si||n instanceof wa||n instanceof Gr||n instanceof Ii)return!0;if(Array.isArray(n)){for(const e of n)if(!gs(e))return!1;return!0}if("object"==typeof n){for(const e in n)if(!gs(n[e]))return!1;return!0}return!1}function xi(n){if(null===n)return yo;if("string"==typeof n)return Br;if("boolean"==typeof n)return le;if("number"==typeof n)return Kn;if(n instanceof Si)return Oe;if(n instanceof wa)return bt;if(n instanceof Gr)return Pt;if(n instanceof Ii)return fn;if(Array.isArray(n)){const e=n.length;let r;for(const s of n){const u=xi(s);if(r){if(r===u)continue;r=Se;break}r=u}return bn(r||Se,e)}return pe}function Js(n){const e=typeof n;return null===n?"":"string"===e||"number"===e||"boolean"===e?String(n):n instanceof Si||n instanceof Gr||n instanceof Ii?n.toString():JSON.stringify(n)}class Qs{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(2!==e.length)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!gs(e[1]))return r.error("invalid value");const s=e[1];let u=xi(s);const f=r.expectedType;return"array"!==u.kind||0!==u.N||!f||"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(u=f),new Qs(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Si?["rgba"].concat(this.value.toArray()):this.value instanceof Gr?this.value.serialize():this.value}}var Is=Qs,vo=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const ha={string:Br,number:Kn,boolean:le,object:pe};class Wi{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let s,u=1;const f=e[0];if("array"===f){let y,w;if(e.length>2){const E=e[1];if("string"!=typeof E||!(E in ha)||"object"===E)return r.error('The item type argument of "array" must be one of string, number, boolean',1);y=ha[E],u++}else y=Se;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);w=e[2],u++}s=bn(y,w)}else s=ha[f];const g=[];for(;u<e.length;u++){const y=r.parse(e[u],u,Se);if(!y)return null;g.push(y)}return new Wi(s,g)}evaluate(e){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(e);if(!lr(this.type,xi(s)))return s;if(r===this.args.length-1)throw new vo(`Expected value to be of type ${pn(this.type)}, but found ${pn(xi(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){r.push(s.kind);const u=e.N;("number"==typeof u||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(s=>s.serialize()))}}var rr=Wi;class Rr{constructor(e){this.type=Pt,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return r.error("First argument must be an image or text section.");const u=[];let f=!1;for(let g=1;g<=e.length-1;++g){const y=e[g];if(f&&"object"==typeof y&&!Array.isArray(y)){f=!1;let w=null;if(y["font-scale"]&&(w=r.parse(y["font-scale"],1,Kn),!w))return null;let E=null;if(y["text-font"]&&(E=r.parse(y["text-font"],1,bn(Br)),!E))return null;let O=null;if(y["text-color"]&&(O=r.parse(y["text-color"],1,Oe),!O))return null;const z=u[u.length-1];z.scale=w,z.font=E,z.textColor=O}else{const w=r.parse(e[g],1,Se);if(!w)return null;const E=w.type.kind;if("string"!==E&&"value"!==E&&"null"!==E&&"resolvedImage"!==E)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:w,scale:null,font:null,textColor:null})}}return new Rr(u)}evaluate(e){return new Gr(this.sections.map(r=>{const s=r.content.evaluate(e);return xi(s)===fn?new sa("",s,null,null,null):new sa(Js(s),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),e.push(s)}return e}}class qi{constructor(e){this.type=fn,this.input=e}static parse(e,r){if(2!==e.length)return r.error("Expected two arguments.");const s=r.parse(e[1],1,Br);return s?new qi(s):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),s=Ii.fromString(r);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(r)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const _s={"to-boolean":le,"to-color":Oe,"to-number":Kn,"to-string":Br};class rs{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return r.error("Expected one argument.");const u=_s[s],f=[];for(let g=1;g<e.length;g++){const y=r.parse(e[g],g,Se);if(!y)return null;f.push(y)}return new rs(u,f)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let r,s;for(const u of this.args){if(r=u.evaluate(e),s=null,r instanceof Si)return r;if("string"==typeof r){const f=e.parseColor(r);if(f)return f}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Fo(r[0],r[1],r[2],r[3]),!s))return new Si(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new vo(s||`Could not parse color from value '${"string"==typeof r?r:String(JSON.stringify(r))}'`)}if("number"===this.type.kind){let r=null;for(const s of this.args){if(r=s.evaluate(e),null===r)return 0;const u=Number(r);if(!isNaN(u))return u}throw new vo(`Could not convert ${JSON.stringify(r)} to number.`)}return"formatted"===this.type.kind?Gr.fromString(Js(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Ii.fromString(Js(this.args[0].evaluate(e))):Js(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Rr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new qi(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var io=rs;const Wo=["Unknown","Point","LineString","Polygon"];var no=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Wo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-n[0])+this.featureDistanceData.bearing[1]*(s*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=Si.parse(n)),e}};class $o{constructor(e,r,s,u){this.name=e,this.type=r,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const s=e[0],u=$o.definitions[s];if(!u)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,g=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=g.filter(([E])=>!Array.isArray(E)||E.length===e.length-1);let w=null;for(const[E,O]of y){w=new us(r.registry,r.path,null,r.scope);const z=[];let U=!1;for(let q=1;q<e.length;q++){const J=e[q],se=Array.isArray(E)?E[q-1]:E.type,me=w.parse(J,1+z.length,se);if(!me){U=!0;break}z.push(me)}if(!U)if(Array.isArray(E)&&E.length!==z.length)w.error(`Expected ${E.length} arguments, but found ${z.length} instead.`);else{for(let q=0;q<z.length;q++){const J=Array.isArray(E)?E[q]:E.type,se=z[q];w.concat(q+1).checkSubtype(J,se.type)}if(0===w.errors.length)return new $o(s,f,O,z)}}if(1===y.length)r.errors.push(...w.errors);else{const E=(y.length?y:g).map(([z])=>{return U=z,Array.isArray(U)?`(${U.map(pn).join(", ")})`:`(${pn(U.type)}...)`;var U}).join(" | "),O=[];for(let z=1;z<e.length;z++){const U=r.parse(e[z],1+O.length);if(!U)return null;O.push(pn(U.type))}r.error(`Expected arguments of type ${E}, but found (${O.join(", ")}) instead.`)}return null}static register(e,r){$o.definitions=r;for(const s in r)e[s]=$o}}var Bo=$o;class Wr{constructor(e,r,s){this.type=bt,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(2!==e.length)return r.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return r.error("Collator options argument must be an object.");const u=r.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,le);if(!u)return null;const f=r.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,le);if(!f)return null;let g=null;return s.locale&&(g=r.parse(s.locale,1,Br),!g)?null:new Wr(u,f,g)}evaluate(e){return new wa(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Xo=8192;function Ko(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function ys(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Ni(n,e){const r=(180+n[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(r*u*Xo),Math.round(s*u*Xo)]}function aa(n,e,r){const s=n[0]-e[0],u=n[1]-e[1],f=n[0]-r[0],g=n[1]-r[1];return s*g-f*u==0&&s*f<=0&&u*g<=0}function js(n,e){let r=!1;for(let g=0,y=e.length;g<y;g++){const w=e[g];for(let E=0,O=w.length;E<O-1;E++){if(aa(n,w[E],w[E+1]))return!1;(u=w[E])[1]>(s=n)[1]!=(f=w[E+1])[1]>s[1]&&s[0]<(f[0]-u[0])*(s[1]-u[1])/(f[1]-u[1])+u[0]&&(r=!r)}}var s,u,f;return r}function vs(n,e){for(let r=0;r<e.length;r++)if(js(n,e[r]))return!0;return!1}function is(n,e,r,s){const u=s[0]-r[0],f=s[1]-r[1],g=(n[0]-r[0])*f-u*(n[1]-r[1]),y=(e[0]-r[0])*f-u*(e[1]-r[1]);return g>0&&y<0||g<0&&y>0}function ea(n,e,r){for(const E of r)for(let O=0;O<E.length-1;++O)if((y=[(g=E[O+1])[0]-(f=E[O])[0],g[1]-f[1]])[0]*(w=[(u=e)[0]-(s=n)[0],u[1]-s[1]])[1]-y[1]*w[0]!=0&&is(s,u,f,g)&&is(f,g,s,u))return!0;var s,u,f,g,y,w;return!1}function ci(n,e){for(let r=0;r<n.length;++r)if(!js(n[r],e))return!1;for(let r=0;r<n.length-1;++r)if(ea(n[r],n[r+1],e))return!1;return!0}function Ms(n,e){for(let r=0;r<e.length;r++)if(ci(n,e[r]))return!0;return!1}function ta(n,e,r){const s=[];for(let u=0;u<n.length;u++){const f=[];for(let g=0;g<n[u].length;g++){const y=Ni(n[u][g],r);Ko(e,y),f.push(y)}s.push(f)}return s}function Jo(n,e,r){const s=[];for(let u=0;u<n.length;u++){const f=ta(n[u],e,r);s.push(f)}return s}function fi(n,e,r,s){if(n[0]<r[0]||n[0]>r[2]){const u=.5*s;let f=n[0]-r[0]>u?-s:r[0]-n[0]>u?s:0;0===f&&(f=n[0]-r[2]>u?-s:r[2]-n[0]>u?s:0),n[0]+=f}Ko(e,n)}function la(n,e,r,s){const u=Math.pow(2,s.z)*Xo,f=[s.x*Xo,s.y*Xo],g=[];if(!n)return g;for(const y of n)for(const w of y){const E=[w.x+f[0],w.y+f[1]];fi(E,e,r,u),g.push(E)}return g}function Qo(n,e,r,s){const u=Math.pow(2,s.z)*Xo,f=[s.x*Xo,s.y*Xo],g=[];if(!n)return g;for(const w of n){const E=[];for(const O of w){const z=[O.x+f[0],O.y+f[1]];Ko(e,z),E.push(z)}g.push(E)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const w of g)for(const E of w)fi(E,e,r,u)}var y;return g}class xs{constructor(e,r){this.type=le,this.geojson=e,this.geometries=r}static parse(e,r){if(2!==e.length)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(gs(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let u=0;u<s.features.length;++u){const f=s.features[u].geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new xs(s,s.features[u].geometry)}else if("Feature"===s.type){const u=s.geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new xs(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new xs(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(r,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(!g)return!1;if("Polygon"===s.type){const y=ta(s.coordinates,f,g),w=la(r.geometry(),u,f,g);if(!ys(u,f))return!1;for(const E of w)if(!js(E,y))return!1}if("MultiPolygon"===s.type){const y=Jo(s.coordinates,f,g),w=la(r.geometry(),u,f,g);if(!ys(u,f))return!1;for(const E of w)if(!vs(E,y))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(r,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(!g)return!1;if("Polygon"===s.type){const y=ta(s.coordinates,f,g),w=Qo(r.geometry(),u,f,g);if(!ys(u,f))return!1;for(const E of w)if(!ci(E,y))return!1}if("MultiPolygon"===s.type){const y=Jo(s.coordinates,f,g),w=Qo(r.geometry(),u,f,g);if(!ys(u,f))return!1;for(const E of w)if(!Ms(E,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var os=xs;function na(n){if(n instanceof Bo&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof os)return!1;let e=!0;return n.eachChild(r=>{e&&!na(r)&&(e=!1)}),e}function Ho(n){if(n instanceof Bo&&"feature-state"===n.name)return!1;let e=!0;return n.eachChild(r=>{e&&!Ho(r)&&(e=!1)}),e}function Fs(n,e){if(n instanceof Bo&&e.indexOf(n.name)>=0)return!1;let r=!0;return n.eachChild(s=>{r&&!Fs(s,e)&&(r=!1)}),r}class Eo{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(2!==e.length||"string"!=typeof e[1])return r.error("'var' expression requires exactly one string literal argument.");const s=e[1];return r.scope.has(s)?new Eo(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Hs=Eo;class xo{constructor(e,r=[],s,u=new so,f=[]){this.registry=e,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=f,this.expectedType=s}parse(e,r,s,u,f={}){return r?this.concat(r,s,u)._parse(e,f):this._parse(e,f)}_parse(e,r){function s(u,f,g){return"assert"===g?new rr(f,[u]):"coerce"===g?new io(f,[u]):u}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if("string"!=typeof u)return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let g=f.parse(e,this);if(!g)return null;if(this.expectedType){const y=this.expectedType,w=g.type;if("string"!==y.kind&&"number"!==y.kind&&"boolean"!==y.kind&&"object"!==y.kind&&"array"!==y.kind||"value"!==w.kind)if("color"!==y.kind&&"formatted"!==y.kind&&"resolvedImage"!==y.kind||"value"!==w.kind&&"string"!==w.kind){if(this.checkSubtype(y,w))return null}else g=s(g,y,r.typeAnnotation||"coerce");else g=s(g,y,r.typeAnnotation||"assert")}if(!(g instanceof Is)&&"resolvedImage"!==g.type.kind&&ya(g)){const y=new no;try{g=new Is(g.type,g.evaluate(y))}catch(w){return this.error(w.message),null}}return g}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,s){const u="number"==typeof e?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new xo(this.registry,u,r||null,f,this.errors)}error(e,...r){const s=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new Ui(s,e))}checkSubtype(e,r){const s=lr(e,r);return s&&this.error(s),s}}var us=xo;function ya(n){if(n instanceof Hs)return ya(n.boundExpression);if(n instanceof Bo&&"error"===n.name||n instanceof Wr||n instanceof os)return!1;const e=n instanceof io||n instanceof rr;let r=!0;return n.eachChild(s=>{r=e?r&&ya(s):r&&s instanceof Is}),!!r&&na(n)&&Fs(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ds(n,e){const r=n.length-1;let s,u,f=0,g=r,y=0;for(;f<=g;)if(y=Math.floor((f+g)/2),s=n[y],u=n[y+1],s<=e){if(y===r||e<u)return y;f=y+1}else{if(!(s>e))throw new vo("Input is not a number.");g=y-1}return 0}class bs{constructor(e,r,s){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[u,f]of s)this.labels.push(u),this.outputs.push(f)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(e[1],1,Kn);if(!s)return null;const u=[];let f=null;r.expectedType&&"value"!==r.expectedType.kind&&(f=r.expectedType);for(let g=1;g<e.length;g+=2){const y=1===g?-1/0:e[g],w=e[g+1],E=g,O=g+1;if("number"!=typeof y)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(u.length&&u[u.length-1][0]>=y)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const z=r.parse(w,O,f);if(!z)return null;f=f||z.type,u.push([y,z])}return new bs(f,s,u)}evaluate(e){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);const f=r.length;return u>=r[f-1]?s[f-1].evaluate(e):s[ds(r,u)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var S=bs;function K(n,e,r){return n*(1-r)+e*r}var I=Object.freeze({__proto__:null,array:function(n,e,r){return n.map((s,u)=>K(s,e[u],r))},color:function(n,e,r){return new Si(K(n.r,e.r,r),K(n.g,e.g,r),K(n.b,e.b,r),K(n.a,e.a,r))},number:K});const Tn=4/29,hr=6/29,dr=3*hr*hr,Hi=hr*hr*hr,lo=Math.PI/180,Q=180/Math.PI;function Z(n){return n>Hi?Math.pow(n,1/3):n/dr+Tn}function ge(n){return n>hr?n*n*n:dr*(n-Tn)}function te(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function Fe(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Zn(n){const e=Fe(n.r),r=Fe(n.g),s=Fe(n.b),u=Z((.4124564*e+.3575761*r+.1804375*s)/.95047),f=Z((.2126729*e+.7151522*r+.072175*s)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-Z((.0193339*e+.119192*r+.9503041*s)/1.08883)),alpha:n.a}}function Xr(n){let e=(n.l+16)/116,r=isNaN(n.a)?e:e+n.a/500,s=isNaN(n.b)?e:e-n.b/200;return e=1*ge(e),r=.95047*ge(r),s=1.08883*ge(s),new Si(te(3.2404542*r-1.5371385*e-.4985314*s),te(-.969266*r+1.8760108*e+.041556*s),te(.0556434*r-.2040259*e+1.0572252*s),n.alpha)}function qo(n,e,r){const s=e-n;return n+r*(s>180||s<-180?s-360*Math.round(s/360):s)}const hs={forward:Zn,reverse:Xr,interpolate:function(n,e,r){return{l:K(n.l,e.l,r),a:K(n.a,e.a,r),b:K(n.b,e.b,r),alpha:K(n.alpha,e.alpha,r)}}},ws={forward:function(n){const{l:e,a:r,b:s}=Zn(n),u=Math.atan2(s,r)*Q;return{h:u<0?u+360:u,c:Math.sqrt(r*r+s*s),l:e,alpha:n.a}},reverse:function(n){const e=n.h*lo,r=n.c;return Xr({l:n.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:n.alpha})},interpolate:function(n,e,r){return{h:qo(n.h,e.h,r),c:K(n.c,e.c,r),l:K(n.l,e.l,r),alpha:K(n.alpha,e.alpha,r)}}};var Gs=Object.freeze({__proto__:null,hcl:ws,lab:hs});class Aa{constructor(e,r,s,u,f){this.type=e,this.operator=r,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,y]of f)this.labels.push(g),this.outputs.push(y)}static interpolationFactor(e,r,s,u){let f=0;if("exponential"===e.name)f=Ea(r,e.base,s,u);else if("linear"===e.name)f=Ea(r,1,s,u);else if("cubic-bezier"===e.name){const g=e.controlPoints;f=new sn(g[0],g[1],g[2],g[3]).solve(Ea(r,1,s,u))}return f}static parse(e,r){let[s,u,f,...g]=e;if(!Array.isArray(u)||0===u.length)return r.error("Expected an interpolation type expression.",1);if("linear"===u[0])u={name:"linear"};else if("exponential"===u[0]){const E=u[1];if("number"!=typeof E)return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:E}}else{if("cubic-bezier"!==u[0])return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const E=u.slice(1);if(4!==E.length||E.some(O=>"number"!=typeof O||O<0||O>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:E}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(f=r.parse(f,2,Kn),!f)return null;const y=[];let w=null;"interpolate-hcl"===s||"interpolate-lab"===s?w=Oe:r.expectedType&&"value"!==r.expectedType.kind&&(w=r.expectedType);for(let E=0;E<g.length;E+=2){const O=g[E],z=g[E+1],U=E+3,q=E+4;if("number"!=typeof O)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(y.length&&y[y.length-1][0]>=O)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const J=r.parse(z,q,w);if(!J)return null;w=w||J.type,y.push([O,J])}return"number"===w.kind||"color"===w.kind||"array"===w.kind&&"number"===w.itemType.kind&&"number"==typeof w.N?new Aa(w,s,u,f,y):r.error(`Type ${pn(w)} is not interpolatable.`)}evaluate(e){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);const f=r.length;if(u>=r[f-1])return s[f-1].evaluate(e);const g=ds(r,u),y=Aa.interpolationFactor(this.interpolation,u,r[g],r[g+1]),w=s[g].evaluate(e),E=s[g+1].evaluate(e);return"interpolate"===this.operator?I[this.type.kind.toLowerCase()](w,E,y):"interpolate-hcl"===this.operator?ws.reverse(ws.interpolate(ws.forward(w),ws.forward(E),y)):hs.reverse(hs.interpolate(hs.forward(w),hs.forward(E),y))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r}}function Ea(n,e,r,s){const u=s-r,f=n-r;return 0===u?0:1===e?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var Bs=Aa;class Ns{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let s=null;const u=r.expectedType;u&&"value"!==u.kind&&(s=u);const f=[];for(const y of e.slice(1)){const w=r.parse(y,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!w)return null;s=s||w.type,f.push(w)}const g=u&&f.some(y=>lr(u,y.type));return new Ns(g?Se:s,f)}evaluate(e){let r,s=null,u=0;for(const f of this.args){if(u++,s=f.evaluate(e),s&&s instanceof Ii&&!s.available&&(r||(r=s),s=null,u===this.args.length))return r;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var al=Ns;class ll{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const g=e[f];if("string"!=typeof g)return r.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return r.error("Variable names must contain only alphanumeric characters or '_'.",f);const y=r.parse(e[f+1],f+1);if(!y)return null;s.push([g,y])}const u=r.parse(e[e.length-1],e.length-1,r.expectedType,s);return u?new ll(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,s]of this.bindings)e.push(r,s.serialize());return e.push(this.result.serialize()),e}}var Ya=ll;class xl{constructor(e,r,s){this.type=e,this.index=r,this.input=s}static parse(e,r){if(3!==e.length)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Kn),u=r.parse(e[2],2,bn(r.expectedType||Se));return s&&u?new xl(u.type.itemType,s,u):null}evaluate(e){const r=this.index.evaluate(e),s=this.input.evaluate(e);if(r<0)throw new vo(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new vo(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new vo(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ce=xl;class M{constructor(e,r){this.type=le,this.needle=e,this.haystack=r}static parse(e,r){if(3!==e.length)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Se),u=r.parse(e[2],2,Se);return s&&u?Ar(s.type,[le,Br,Kn,yo,Se])?new M(s,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${pn(s.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!Zr(r,["boolean","string","number","null"]))throw new vo(`Expected first argument to be of type boolean, string, number or null, but found ${pn(xi(r))} instead.`);if(!Zr(s,["string","array"]))throw new vo(`Expected second argument to be of type array or string, but found ${pn(xi(s))} instead.`);return s.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var F=M;class G{constructor(e,r,s){this.type=Kn,this.needle=e,this.haystack=r,this.fromIndex=s}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Se),u=r.parse(e[2],2,Se);if(!s||!u)return null;if(!Ar(s.type,[le,Br,Kn,yo,Se]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${pn(s.type)} instead`);if(4===e.length){const f=r.parse(e[3],3,Kn);return f?new G(s,u,f):null}return new G(s,u)}evaluate(e){const r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!Zr(r,["boolean","string","number","null"]))throw new vo(`Expected first argument to be of type boolean, string, number or null, but found ${pn(xi(r))} instead.`);if(!Zr(s,["string","array"]))throw new vo(`Expected second argument to be of type array or string, but found ${pn(xi(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return s.indexOf(r,u)}return s.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var ue=G;class Ce{constructor(e,r,s,u,f,g){this.inputType=e,this.type=r,this.input=s,this.cases=u,this.outputs=f,this.otherwise=g}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let s,u;r.expectedType&&"value"!==r.expectedType.kind&&(u=r.expectedType);const f={},g=[];for(let E=2;E<e.length-1;E+=2){let O=e[E];const z=e[E+1];Array.isArray(O)||(O=[O]);const U=r.concat(E);if(0===O.length)return U.error("Expected at least one branch label.");for(const J of O){if("number"!=typeof J&&"string"!=typeof J)return U.error("Branch labels must be numbers or strings.");if("number"==typeof J&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof J&&Math.floor(J)!==J)return U.error("Numeric branch labels must be integer values.");if(s){if(U.checkSubtype(s,xi(J)))return null}else s=xi(J);if(void 0!==f[String(J)])return U.error("Branch labels must be unique.");f[String(J)]=g.length}const q=r.parse(z,E,u);if(!q)return null;u=u||q.type,g.push(q)}const y=r.parse(e[1],1,Se);if(!y)return null;const w=r.parse(e[e.length-1],e.length-1,u);return w?"value"!==y.type.kind&&r.concat(1).checkSubtype(s,y.type)?null:new Ce(s,u,y,f,g,w):null}evaluate(e){const r=this.input.evaluate(e);return(xi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),s=[],u={};for(const g of r){const y=u[this.cases[g]];void 0===y?(u[this.cases[g]]=s.length,s.push([this.cases[g],[g]])):s[y][1].push(g)}const f=g=>"number"===this.inputType.kind?Number(g):g;for(const[g,y]of s)e.push(1===y.length?f(y[0]):y.map(f)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}var ct=Ce;class ut{constructor(e,r,s){this.type=e,this.branches=r,this.otherwise=s}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&"value"!==r.expectedType.kind&&(s=r.expectedType);const u=[];for(let g=1;g<e.length-1;g+=2){const y=r.parse(e[g],g,le);if(!y)return null;const w=r.parse(e[g+1],g+1,s);if(!w)return null;u.push([y,w]),s=s||w.type}const f=r.parse(e[e.length-1],e.length-1,s);return f?new ut(s,u,f):null}evaluate(e){for(const[r,s]of this.branches)if(r.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,s]of this.branches)e(r),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Qt=ut;class Dn{constructor(e,r,s,u){this.type=e,this.input=r,this.beginIndex=s,this.endIndex=u}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Se),u=r.parse(e[2],2,Kn);if(!s||!u)return null;if(!Ar(s.type,[bn(Se),Br,Se]))return r.error(`Expected first argument to be of type array or string, but found ${pn(s.type)} instead`);if(4===e.length){const f=r.parse(e[3],3,Kn);return f?new Dn(s.type,s,u,f):null}return new Dn(s.type,s,u)}evaluate(e){const r=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!Zr(r,["string","array"]))throw new vo(`Expected first argument to be of type array or string, but found ${pn(xi(r))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return r.slice(s,u)}return r.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Er=Dn;function ar(n,e){return"=="===n||"!="===n?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ei(n,e,r,s){return 0===s.compare(e,r)}function ui(n,e,r){const s="=="!==n&&"!="!==n;return class Zb{constructor(f,g,y){this.type=le,this.lhs=f,this.rhs=g,this.collator=y,this.hasUntypedArgument="value"===f.type.kind||"value"===g.type.kind}static parse(f,g){if(3!==f.length&&4!==f.length)return g.error("Expected two or three arguments.");const y=f[0];let w=g.parse(f[1],1,Se);if(!w)return null;if(!ar(y,w.type))return g.concat(1).error(`"${y}" comparisons are not supported for type '${pn(w.type)}'.`);let E=g.parse(f[2],2,Se);if(!E)return null;if(!ar(y,E.type))return g.concat(2).error(`"${y}" comparisons are not supported for type '${pn(E.type)}'.`);if(w.type.kind!==E.type.kind&&"value"!==w.type.kind&&"value"!==E.type.kind)return g.error(`Cannot compare types '${pn(w.type)}' and '${pn(E.type)}'.`);s&&("value"===w.type.kind&&"value"!==E.type.kind?w=new rr(E.type,[w]):"value"!==w.type.kind&&"value"===E.type.kind&&(E=new rr(w.type,[E])));let O=null;if(4===f.length){if("string"!==w.type.kind&&"string"!==E.type.kind&&"value"!==w.type.kind&&"value"!==E.type.kind)return g.error("Cannot use collator to compare non-string types.");if(O=g.parse(f[3],3,bt),!O)return null}return new Zb(w,E,O)}evaluate(f){const g=this.lhs.evaluate(f),y=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const w=xi(g),E=xi(y);if(w.kind!==E.kind||"string"!==w.kind&&"number"!==w.kind)throw new vo(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${w.kind}, ${E.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const w=xi(g),E=xi(y);if("string"!==w.kind||"string"!==E.kind)return e(f,g,y)}return this.collator?r(f,g,y,this.collator.evaluate(f)):e(f,g,y)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[n];return this.eachChild(g=>{f.push(g.serialize())}),f}}}const Jr=ui("==",function(n,e,r){return e===r},Ei),pi=ui("!=",function(n,e,r){return e!==r},function(n,e,r,s){return!Ei(0,e,r,s)}),Mo=ui("<",function(n,e,r){return e<r},function(n,e,r,s){return s.compare(e,r)<0}),es=ui(">",function(n,e,r){return e>r},function(n,e,r,s){return s.compare(e,r)>0}),Go=ui("<=",function(n,e,r){return e<=r},function(n,e,r,s){return s.compare(e,r)<=0}),As=ui(">=",function(n,e,r){return e>=r},function(n,e,r,s){return s.compare(e,r)>=0});class ss{constructor(e,r,s,u,f,g){this.type=Br,this.number=e,this.locale=r,this.currency=s,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(e,r){if(3!==e.length)return r.error("Expected two arguments.");const s=r.parse(e[1],1,Kn);if(!s)return null;const u=e[2];if("object"!=typeof u||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=r.parse(u.locale,1,Br),!f))return null;let g=null;if(u.currency&&(g=r.parse(u.currency,1,Br),!g))return null;let y=null;if(u.unit&&(y=r.parse(u.unit,1,Br),!y))return null;let w=null;if(u["min-fraction-digits"]&&(w=r.parse(u["min-fraction-digits"],1,Kn),!w))return null;let E=null;return u["max-fraction-digits"]&&(E=r.parse(u["max-fraction-digits"],1,Kn),!E)?null:new ss(s,f,g,y,w,E)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class va{constructor(e){this.type=Kn,this.input=e}static parse(e,r){if(2!==e.length)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=r.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?r.error(`Expected argument of type string or array, but found ${pn(s.type)} instead.`):new va(s):null}evaluate(e){const r=this.input.evaluate(e);if("string"==typeof r||Array.isArray(r))return r.length;throw new vo(`Expected value to be of type string or array, but found ${pn(xi(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const fa={"==":Jr,"!=":pi,">":es,"<":Mo,">=":As,"<=":Go,array:rr,at:ce,boolean:rr,case:Qt,coalesce:al,collator:Wr,format:Rr,image:qi,in:F,"index-of":ue,interpolate:Bs,"interpolate-hcl":Bs,"interpolate-lab":Bs,length:va,let:Ya,literal:Is,match:ct,number:rr,"number-format":ss,object:rr,slice:Er,step:S,string:rr,"to-boolean":io,"to-color":io,"to-number":io,"to-string":io,var:Hs,within:os};function Es(n,[e,r,s,u]){e=e.evaluate(n),r=r.evaluate(n),s=s.evaluate(n);const f=u?u.evaluate(n):1,g=Fo(e,r,s,f);if(g)throw new vo(g);return new Si(e/255*f,r/255*f,s/255*f,f)}function Ds(n,e){return n in e}function Cs(n,e){const r=e[n];return void 0===r?null:r}function k(n){return{type:n}}Bo.register(fa,{error:[{kind:"error"},[Br],(n,[e])=>{throw new vo(e.evaluate(n))}],typeof:[Br,[Se],(n,[e])=>pn(xi(e.evaluate(n)))],"to-rgba":[bn(Kn,4),[Oe],(n,[e])=>e.evaluate(n).toArray()],rgb:[Oe,[Kn,Kn,Kn],Es],rgba:[Oe,[Kn,Kn,Kn,Kn],Es],has:{type:le,overloads:[[[Br],(n,[e])=>Ds(e.evaluate(n),n.properties())],[[Br,pe],(n,[e,r])=>Ds(e.evaluate(n),r.evaluate(n))]]},get:{type:Se,overloads:[[[Br],(n,[e])=>Cs(e.evaluate(n),n.properties())],[[Br,pe],(n,[e,r])=>Cs(e.evaluate(n),r.evaluate(n))]]},"feature-state":[Se,[Br],(n,[e])=>Cs(e.evaluate(n),n.featureState||{})],properties:[pe,[],n=>n.properties()],"geometry-type":[Br,[],n=>n.geometryType()],id:[Se,[],n=>n.id()],zoom:[Kn,[],n=>n.globals.zoom],pitch:[Kn,[],n=>n.globals.pitch||0],"distance-from-center":[Kn,[],n=>n.distanceFromCenter()],"heatmap-density":[Kn,[],n=>n.globals.heatmapDensity||0],"line-progress":[Kn,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Kn,[],n=>n.globals.skyRadialProgress||0],accumulated:[Se,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[Kn,k(Kn),(n,e)=>{let r=0;for(const s of e)r+=s.evaluate(n);return r}],"*":[Kn,k(Kn),(n,e)=>{let r=1;for(const s of e)r*=s.evaluate(n);return r}],"-":{type:Kn,overloads:[[[Kn,Kn],(n,[e,r])=>e.evaluate(n)-r.evaluate(n)],[[Kn],(n,[e])=>-e.evaluate(n)]]},"/":[Kn,[Kn,Kn],(n,[e,r])=>e.evaluate(n)/r.evaluate(n)],"%":[Kn,[Kn,Kn],(n,[e,r])=>e.evaluate(n)%r.evaluate(n)],ln2:[Kn,[],()=>Math.LN2],pi:[Kn,[],()=>Math.PI],e:[Kn,[],()=>Math.E],"^":[Kn,[Kn,Kn],(n,[e,r])=>Math.pow(e.evaluate(n),r.evaluate(n))],sqrt:[Kn,[Kn],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Kn,[Kn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Kn,[Kn],(n,[e])=>Math.log(e.evaluate(n))],log2:[Kn,[Kn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Kn,[Kn],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Kn,[Kn],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Kn,[Kn],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Kn,[Kn],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Kn,[Kn],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Kn,[Kn],(n,[e])=>Math.atan(e.evaluate(n))],min:[Kn,k(Kn),(n,e)=>Math.min(...e.map(r=>r.evaluate(n)))],max:[Kn,k(Kn),(n,e)=>Math.max(...e.map(r=>r.evaluate(n)))],abs:[Kn,[Kn],(n,[e])=>Math.abs(e.evaluate(n))],round:[Kn,[Kn],(n,[e])=>{const r=e.evaluate(n);return r<0?-Math.round(-r):Math.round(r)}],floor:[Kn,[Kn],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Kn,[Kn],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[le,[Br,Se],(n,[e,r])=>n.properties()[e.value]===r.value],"filter-id-==":[le,[Se],(n,[e])=>n.id()===e.value],"filter-type-==":[le,[Br],(n,[e])=>n.geometryType()===e.value],"filter-<":[le,[Br,Se],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s<u}],"filter-id-<":[le,[Se],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r<s}],"filter->":[le,[Br,Se],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s>u}],"filter-id->":[le,[Se],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r>s}],"filter-<=":[le,[Br,Se],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[le,[Se],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r<=s}],"filter->=":[le,[Br,Se],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[le,[Se],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r>=s}],"filter-has":[le,[Se],(n,[e])=>e.value in n.properties()],"filter-has-id":[le,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[le,[bn(Br)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[le,[bn(Se)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[le,[Br,bn(Se)],(n,[e,r])=>r.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[le,[Br,bn(Se)],(n,[e,r])=>function(s,u,f,g){for(;f<=g;){const y=f+g>>1;if(u[y]===s)return!0;u[y]>s?g=y-1:f=y+1}return!1}(n.properties()[e.value],r.value,0,r.value.length-1)],all:{type:le,overloads:[[[le,le],(n,[e,r])=>e.evaluate(n)&&r.evaluate(n)],[k(le),(n,e)=>{for(const r of e)if(!r.evaluate(n))return!1;return!0}]]},any:{type:le,overloads:[[[le,le],(n,[e,r])=>e.evaluate(n)||r.evaluate(n)],[k(le),(n,e)=>{for(const r of e)if(r.evaluate(n))return!0;return!1}]]},"!":[le,[le],(n,[e])=>!e.evaluate(n)],"is-supported-script":[le,[Br],(n,[e])=>{const r=n.globals&&n.globals.isSupportedScript;return!r||r(e.evaluate(n))}],upcase:[Br,[Br],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Br,[Br],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Br,k(Se),(n,e)=>e.map(r=>Js(r.evaluate(n))).join("")],"resolved-locale":[Br,[bt],(n,[e])=>e.evaluate(n).resolvedLocale()]});var X=fa;function Be(n){return{result:"success",value:n}}function W(n){return{result:"error",value:n}}function be(n){return"data-driven"===n["property-type"]}function _t(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function kt(n){return!!n.expression&&n.expression.interpolated}function Ut(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}function tr(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}function _r(n){return n}function ti(n,e){const r="color"===e.type,s=n.stops&&"object"==typeof n.stops[0][0],u=s||!(s||void 0!==n.property),f=n.type||(kt(e)?"exponential":"interval");if(r&&((n=ei({},n)).stops&&(n.stops=n.stops.map(E=>[E[0],Si.parse(E[1])])),n.default=Si.parse(n.default?n.default:e.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!Gs[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let g,y,w;if("exponential"===f)g=ni;else if("interval"===f)g=Bi;else if("categorical"===f){g=Pr,y=Object.create(null);for(const E of n.stops)y[E[0]]=E[1];w=typeof n.stops[0][0]}else{if("identity"!==f)throw new Error(`Unknown function type "${f}"`);g=co}if(s){const E={},O=[];for(let q=0;q<n.stops.length;q++){const J=n.stops[q],se=J[0].zoom;void 0===E[se]&&(E[se]={zoom:se,type:n.type,property:n.property,default:n.default,stops:[]},O.push(se)),E[se].stops.push([J[0].value,J[1]])}const z=[];for(const q of O)z.push([E[q].zoom,ti(E[q],e)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Bs.interpolationFactor.bind(void 0,U),zoomStops:z.map(q=>q[0]),evaluate:({zoom:q},J)=>ni({stops:z,base:n.base},e,q).evaluate(q,J)}}if(u){const E="exponential"===f?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:Bs.interpolationFactor.bind(void 0,E),zoomStops:n.stops.map(O=>O[0]),evaluate:({zoom:O})=>g(n,e,O,y,w)}}return{kind:"source",evaluate(E,O){const z=O&&O.properties?O.properties[n.property]:void 0;return void 0===z?Kr(n.default,e.default):g(n,e,z,y,w)}}}function Kr(n,e,r){return void 0!==n?n:void 0!==e?e:void 0!==r?r:void 0}function Pr(n,e,r,s,u){return Kr(typeof r===u?s[r]:void 0,n.default,e.default)}function Bi(n,e,r){if("number"!==Ut(r))return Kr(n.default,e.default);const s=n.stops.length;if(1===s||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[s-1][0])return n.stops[s-1][1];const u=ds(n.stops.map(f=>f[0]),r);return n.stops[u][1]}function ni(n,e,r){const s=void 0!==n.base?n.base:1;if("number"!==Ut(r))return Kr(n.default,e.default);const u=n.stops.length;if(1===u||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[u-1][0])return n.stops[u-1][1];const f=ds(n.stops.map(O=>O[0]),r),g=function(O,z,U,q){const J=q-U,se=O-U;return 0===J?0:1===z?se/J:(Math.pow(z,se)-1)/(Math.pow(z,J)-1)}(r,s,n.stops[f][0],n.stops[f+1][0]),y=n.stops[f][1],w=n.stops[f+1][1];let E=I[e.type]||_r;if(n.colorSpace&&"rgb"!==n.colorSpace){const O=Gs[n.colorSpace];E=(z,U)=>O.reverse(O.interpolate(O.forward(z),O.forward(U),g))}return"function"==typeof y.evaluate?{evaluate(...O){const z=y.evaluate.apply(void 0,O),U=w.evaluate.apply(void 0,O);if(void 0!==z&&void 0!==U)return E(z,U,g)}}:E(y,w,g)}function co(n,e,r){return"color"===e.type?r=Si.parse(r):"formatted"===e.type?r=Gr.fromString(r.toString()):"resolvedImage"===e.type?r=Ii.fromString(r.toString()):Ut(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Kr(r,n.default,e.default)}class Ws{constructor(e,r){var s;this.expression=e,this._warningHistory={},this._evaluator=new no,this._defaultValue=r?"color"===(s=r).type&&(tr(s.default)||Array.isArray(s.default))?new Si(0,0,0,0):"color"===s.type?Si.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=r&&"enum"===r.type?r.values:null}evaluateWithoutErrorHandling(e,r,s,u,f,g,y,w){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,s,u,f,g,y,w){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=w||null;try{const E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new vo(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function uo(n){return Array.isArray(n)&&n.length>0&&"string"==typeof n[0]&&n[0]in X}function ho(n,e){const r=new us(X,[],e?function(u){const f={color:Oe,string:Br,number:Kn,enum:Br,boolean:le,formatted:Pt,resolvedImage:fn};return"array"===u.type?bn(f[u.value]||Se,u.length):f[u.type]}(e):void 0),s=r.parse(n,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?Be(new Ws(s,e)):W(r.errors)}class Yi{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent="constant"!==e&&!Ho(r.expression)}evaluateWithoutErrorHandling(e,r,s,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,f,g)}evaluate(e,r,s,u,f,g){return this._styleExpression.evaluate(e,r,s,u,f,g)}}class zs{constructor(e,r,s,u){this.kind=e,this.zoomStops=s,this._styleExpression=r,this.isStateDependent="camera"!==e&&!Ho(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,r,s,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,f,g)}evaluate(e,r,s,u,f,g){return this._styleExpression.evaluate(e,r,s,u,f,g)}interpolationFactor(e,r,s){return this.interpolationType?Bs.interpolationFactor(this.interpolationType,e,r,s):0}}function Ao(n,e){if("error"===(n=ho(n,e)).result)return n;const r=n.value.expression,s=na(r);if(!s&&!be(e))return W([new Ui("","data expressions not supported")]);const u=Fs(r,["zoom","pitch","distance-from-center"]);if(!u&&!_t(e))return W([new Ui("","zoom expressions not supported")]);const f=pa(r);return f||u?f instanceof Ui?W([f]):f instanceof Bs&&!kt(e)?W([new Ui("",'"interpolate" expressions cannot be used with this property')]):Be(f?new zs(s?"camera":"composite",n.value,f.labels,f instanceof Bs?f.interpolation:void 0):new Yi(s?"constant":"source",n.value)):W([new Ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class wc{constructor(e,r){this._parameters=e,this._specification=r,ei(this,ti(this._parameters,this._specification))}static deserialize(e){return new wc(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function pa(n){let e=null;if(n instanceof Ya)e=pa(n.result);else if(n instanceof al){for(const r of n.args)if(e=pa(r),e)break}else(n instanceof S||n instanceof Bs)&&n.input instanceof Bo&&"zoom"===n.input.name&&(e=n);return e instanceof Ui||n.eachChild(r=>{const s=pa(r);s instanceof Ui?e=s:!e&&s?e=new Ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Ui("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class cr{constructor(e,r,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),null!=r&&r.__line__&&(this.line=r.__line__)}}function Pa(n){const e=n.key,r=n.value,s=n.valueSpec||{},u=n.objectElementValidators||{},f=n.style,g=n.styleSpec;let y=[];const w=Ut(r);if("object"!==w)return[new cr(e,r,`object expected, ${w} found`)];for(const E in r){const O=E.split(".")[0];let z;u[O]?z=u[O]:s[O]?z=fs:u["*"]?z=u["*"]:s["*"]&&(z=fs),z?y=y.concat(z({key:(e&&`${e}.`)+E,value:r[E],valueSpec:s[O]||s["*"],style:f,styleSpec:g,object:r,objectKey:E},r)):y.push(new cr(e,r[E],`unknown property "${E}"`))}for(const E in s)u[E]||s[E].required&&void 0===s[E].default&&void 0===r[E]&&y.push(new cr(e,r,`missing required property "${E}"`));return y}function Ec(n){const e=n.value,r=n.valueSpec,s=n.style,u=n.styleSpec,f=n.key,g=n.arrayElementValidator||fs;if("array"!==Ut(e))return[new cr(f,e,`array expected, ${Ut(e)} found`)];if(r.length&&e.length!==r.length)return[new cr(f,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new cr(f,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let y={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};u.$version<7&&(y.function=r.function),"object"===Ut(r.value)&&(y=r.value);let w=[];for(let E=0;E<e.length;E++)w=w.concat(g({array:e,arrayIndex:E,value:e[E],valueSpec:y,style:s,styleSpec:u,key:`${f}[${E}]`}));return w}function Rl(n){const e=n.key,r=n.value,s=n.valueSpec;let u=Ut(r);if("number"===u&&r!=r&&(u="NaN"),"number"!==u)return[new cr(e,r,`number expected, ${u} found`)];if("minimum"in s){let f=s.minimum;if("array"===Ut(s.minimum)&&(f=s.minimum[n.arrayIndex]),r<f)return[new cr(e,r,`${r} is less than the minimum value ${f}`)]}if("maximum"in s){let f=s.maximum;if("array"===Ut(s.maximum)&&(f=s.maximum[n.arrayIndex]),r>f)return[new cr(e,r,`${r} is greater than the maximum value ${f}`)]}return[]}function tc(n){const e=n.valueSpec,r=Ri(n.value.type);let s,u,f,g={};const y="categorical"!==r&&void 0===n.value.property,w=!y,E="array"===Ut(n.value.stops)&&"array"===Ut(n.value.stops[0])&&"object"===Ut(n.value.stops[0][0]),O=Pa({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(q){if("identity"===r)return[new cr(q.key,q.value,'identity function may not have a "stops" property')];let J=[];const se=q.value;return J=J.concat(Ec({key:q.key,value:se,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:z})),"array"===Ut(se)&&0===se.length&&J.push(new cr(q.key,se,"array must have at least one stop")),J},default:function(q){return fs({key:q.key,value:q.value,valueSpec:e,style:q.style,styleSpec:q.styleSpec})}}});return"identity"===r&&y&&O.push(new cr(n.key,n.value,'missing required property "property"')),"identity"===r||n.value.stops||O.push(new cr(n.key,n.value,'missing required property "stops"')),"exponential"===r&&n.valueSpec.expression&&!kt(n.valueSpec)&&O.push(new cr(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(w&&!be(n.valueSpec)?O.push(new cr(n.key,n.value,"property functions not supported")):y&&!_t(n.valueSpec)&&O.push(new cr(n.key,n.value,"zoom functions not supported"))),"categorical"!==r&&!E||void 0!==n.value.property||O.push(new cr(n.key,n.value,'"property" property is required')),O;function z(q){let J=[];const se=q.value,me=q.key;if("array"!==Ut(se))return[new cr(me,se,`array expected, ${Ut(se)} found`)];if(2!==se.length)return[new cr(me,se,`array length 2 expected, length ${se.length} found`)];if(E){if("object"!==Ut(se[0]))return[new cr(me,se,`object expected, ${Ut(se[0])} found`)];if(void 0===se[0].zoom)return[new cr(me,se,"object stop key must have zoom")];if(void 0===se[0].value)return[new cr(me,se,"object stop key must have value")];const Pe=Ri(se[0].zoom);if("number"!=typeof Pe)return[new cr(me,se[0].zoom,"stop zoom values must be numbers")];if(f&&f>Pe)return[new cr(me,se[0].zoom,"stop zoom values must appear in ascending order")];Pe!==f&&(f=Pe,u=void 0,g={}),J=J.concat(Pa({key:`${me}[0]`,value:se[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:Rl,value:U}}))}else J=J.concat(U({key:`${me}[0]`,value:se[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},se));return uo(Fi(se[1]))?J.concat([new cr(`${me}[1]`,se[1],"expressions are not allowed in function stops.")]):J.concat(fs({key:`${me}[1]`,value:se[1],valueSpec:e,style:q.style,styleSpec:q.styleSpec}))}function U(q,J){const se=Ut(q.value),me=Ri(q.value),Pe=null!==q.value?q.value:J;if(s){if(se!==s)return[new cr(q.key,Pe,`${se} stop domain type must match previous stop domain type ${s}`)]}else s=se;if("number"!==se&&"string"!==se&&"boolean"!==se&&"number"!=typeof me&&"string"!=typeof me&&"boolean"!=typeof me)return[new cr(q.key,Pe,"stop domain value must be a number, string, or boolean")];if("number"!==se&&"categorical"!==r){let Xe=`number expected, ${se} found`;return be(e)&&void 0===r&&(Xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new cr(q.key,Pe,Xe)]}return"categorical"!==r||"number"!==se||"number"==typeof me&&isFinite(me)&&Math.floor(me)===me?"categorical"!==r&&"number"===se&&"number"==typeof me&&"number"==typeof u&&void 0!==u&&me<u?[new cr(q.key,Pe,"stop domain values must appear in ascending order")]:(u=me,"categorical"===r&&me in g?[new cr(q.key,Pe,"stop domain values must be unique")]:(g[me]=!0,[])):[new cr(q.key,Pe,`integer expected, found ${String(me)}`)]}}function $s(n){const e=("property"===n.expressionContext?Ao:ho)(Fi(n.value),n.valueSpec);if("error"===e.result)return e.value.map(s=>new cr(`${n.key}${s.key}`,n.value,s.message));const r=e.value.expression||e.value._styleExpression.expression;if("property"===n.expressionContext&&"text-font"===n.propertyKey&&!r.outputDefined())return[new cr(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===n.expressionContext&&"layout"===n.propertyType&&!Ho(r))return[new cr(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===n.expressionContext)return ri(r,n);if(n.expressionContext&&0===n.expressionContext.indexOf("cluster")){if(!Fs(r,["zoom","feature-state"]))return[new cr(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===n.expressionContext&&!na(r))return[new cr(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ri(n,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)r.delete(u);if(0===r.size)return[];const s=[];return n instanceof Bo&&r.has(n.name)?[new cr(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(u=>{s.push(...ri(u,e))}),s)}function Ol(n){const e=n.key,r=n.value,s=n.valueSpec,u=[];return Array.isArray(s.values)?-1===s.values.indexOf(Ri(r))&&u.push(new cr(e,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(s.values).indexOf(Ri(r))&&u.push(new cr(e,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function yd(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!yd(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function nc(n,e="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yd(n)||(n=wl(n));const r=n;let s=!0;try{s=function(E){if(!kl(E))return E;let O=Fi(E);return Dc(O),O=$a(O),O}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const u=zt[`filter_${e}`],f=ho(s,u);let g=null;if("error"===f.result)throw new Error(f.value.map(E=>`${E.key}: ${E.message}`).join(", "));g=(E,O,z)=>f.value.evaluate(E,O,{},z);let y=null,w=null;if(s!==r){const E=ho(r,u);if("error"===E.result)throw new Error(E.value.map(O=>`${O.key}: ${O.message}`).join(", "));y=(O,z,U,q,J)=>E.value.evaluate(O,z,{},U,void 0,void 0,q,J),w=!na(E.value.expression)}return{filter:g,dynamicFilter:y||void 0,needGeometry:ru(s),needFeature:!!w}}function $a(n){if(!Array.isArray(n))return n;const e=function(r){if(bl.has(r[0]))for(let s=1;s<r.length;s++)if(kl(r[s]))return!0;return r}(n);return!0===e?e:e.map(r=>$a(r))}function Dc(n){let e=!1;const r=[];if("case"===n[0]){for(let s=1;s<n.length-1;s+=2)e=e||kl(n[s]),r.push(n[s+1]);r.push(n[n.length-1])}else if("match"===n[0]){e=e||kl(n[1]);for(let s=2;s<n.length-1;s+=2)r.push(n[s+1]);r.push(n[n.length-1])}else if("step"===n[0]){e=e||kl(n[1]);for(let s=1;s<n.length-1;s+=2)r.push(n[s+1])}e&&(n.length=0,n.push("any",...r));for(let s=1;s<n.length;s++)Dc(n[s])}function kl(n){if(!Array.isArray(n))return!1;if("pitch"===(e=n[0])||"distance-from-center"===e)return!0;var e;for(let r=1;r<n.length;r++)if(kl(n[r]))return!0;return!1}const bl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function hh(n,e){return n<e?-1:n>e?1:0}function ru(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let e=1;e<n.length;e++)if(ru(n[e]))return!0;return!1}function wl(n){if(!n)return!0;const e=n[0];return n.length<=1?"any"!==e:"=="===e?rc(n[1],n[2],"=="):"!="===e?Zi(rc(n[1],n[2],"==")):"<"===e||">"===e||"<="===e||">="===e?rc(n[1],n[2],e):"any"===e?(r=n.slice(1),["any"].concat(r.map(wl))):"all"===e?["all"].concat(n.slice(1).map(wl)):"none"===e?["all"].concat(n.slice(1).map(wl).map(Zi)):"in"===e?iu(n[1],n.slice(2)):"!in"===e?Zi(iu(n[1],n.slice(2))):"has"===e?Vn(n[1]):"!has"===e?Zi(Vn(n[1])):"within"!==e||n;var r}function rc(n,e,r){switch(n){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,n,e]}}function iu(n,e){if(0===e.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",n,["literal",e.sort(hh)]]:["filter-in-small",n,["literal",e]]}}function Vn(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Zi(n){return["!",n]}function El(n){return yd(Fi(n.value))?$s(ei({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):Ll(n)}function Ll(n){const e=n.value,r=n.key;if("array"!==Ut(e))return[new cr(r,e,`array expected, ${Ut(e)} found`)];const s=n.styleSpec;let u,f=[];if(e.length<1)return[new cr(r,e,"filter array must have at least 1 element")];switch(f=f.concat(Ol({key:`${r}[0]`,value:e[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),Ri(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Ri(e[1])&&f.push(new cr(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&f.push(new cr(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Ut(e[1]),"string"!==u&&f.push(new cr(`${r}[1]`,e[1],`string expected, ${u} found`)));for(let g=2;g<e.length;g++)u=Ut(e[g]),"$type"===Ri(e[1])?f=f.concat(Ol({key:`${r}[${g}]`,value:e[g],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==u&&"number"!==u&&"boolean"!==u&&f.push(new cr(`${r}[${g}]`,e[g],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)f=f.concat(Ll({key:`${r}[${g}]`,value:e[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Ut(e[1]),2!==e.length?f.push(new cr(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==u&&f.push(new cr(`${r}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Ut(e[1]),2!==e.length?f.push(new cr(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==u&&f.push(new cr(`${r}[1]`,e[1],`object expected, ${u} found`))}return f}function Vs(n,e){const r=n.key,s=n.style,u=n.styleSpec,f=n.value,g=n.objectKey,y=u[`${e}_${n.layerType}`];if(!y)return[];const w=g.match(/^(.*)-transition$/);if("paint"===e&&w&&y[w[1]]&&y[w[1]].transition)return fs({key:r,value:f,valueSpec:u.transition,style:s,styleSpec:u});const E=n.valueSpec||y[g];if(!E)return[new cr(r,f,`unknown property "${g}"`)];let O;if("string"===Ut(f)&&be(E)&&!E.tokens&&(O=/^{([^}]+)}$/.exec(f))){const U=`\`{ "type": "identity", "property": ${O?JSON.stringify(O[1]):'"_"'} }\``;return[new cr(r,f,`"${g}" does not support interpolation syntax\nUse an identity property function instead: ${U}.`)]}const z=[];return"symbol"===n.layerType&&("text-field"===g&&s&&!s.glyphs&&z.push(new cr(r,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&tr(Fi(f))&&"identity"===Ri(f.type)&&z.push(new cr(r,f,'"text-font" does not support identity functions'))),z.concat(fs({key:n.key,value:f,valueSpec:E,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:g}))}function Mu(n){return Vs(n,"paint")}function Fl(n){return Vs(n,"layout")}function Ra(n){let e=[];const r=n.value,s=n.key,u=n.style,f=n.styleSpec;r.type||r.ref||e.push(new cr(s,r,'either "type" or "ref" is required'));let g=Ri(r.type);const y=Ri(r.ref);if(r.id){const w=Ri(r.id);for(let E=0;E<n.arrayIndex;E++){const O=u.layers[E];Ri(O.id)===w&&e.push(new cr(s,r.id,`duplicate layer id "${r.id}", previously used at line ${O.id.__line__}`))}}if("ref"in r){let w;["type","source","source-layer","filter","layout"].forEach(E=>{E in r&&e.push(new cr(s,r[E],`"${E}" is prohibited for ref layers`))}),u.layers.forEach(E=>{Ri(E.id)===y&&(w=E)}),w?w.ref?e.push(new cr(s,r.ref,"ref cannot reference another ref layer")):g=Ri(w.type):"string"==typeof y&&e.push(new cr(s,r.ref,`ref layer "${y}" not found`))}else if("background"!==g&&"sky"!==g)if(r.source){const w=u.sources&&u.sources[r.source],E=w&&Ri(w.type);w?"vector"===E&&"raster"===g?e.push(new cr(s,r.source,`layer "${r.id}" requires a raster source`)):"raster"===E&&"raster"!==g?e.push(new cr(s,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==E||r["source-layer"]?"raster-dem"===E&&"hillshade"!==g?e.push(new cr(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==g||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===E&&w.lineMetrics||e.push(new cr(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new cr(s,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new cr(s,r.source,`source "${r.source}" not found`))}else e.push(new cr(s,r,'missing required property "source"'));return e=e.concat(Pa({key:s,value:r,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>fs({key:`${s}.type`,value:r.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,object:r,objectKey:"type"}),filter:w=>El(ei({layerType:g},w)),layout:w=>Pa({layer:r,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":E=>Fl(ei({layerType:g},E))}}),paint:w=>Pa({layer:r,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":E=>Mu(ei({layerType:g},E))}})}})),e}function Za(n){const e=n.value,r=n.key,s=Ut(e);return"string"!==s?[new cr(r,e,`string expected, ${s} found`)]:[]}const ic={promoteId:function({key:n,value:e}){if("string"===Ut(e))return Za({key:n,value:e});{const r=[];for(const s in e)r.push(...Za({key:`${n}.${s}`,value:e[s]}));return r}}};function Au(n){const e=n.value,r=n.key,s=n.styleSpec,u=n.style;if(!e.type)return[new cr(r,e,'"type" is required')];const f=Ri(e.type);let g;switch(f){case"vector":case"raster":case"raster-dem":return g=Pa({key:r,value:e,valueSpec:s[`source_${f.replace("-","_")}`],style:n.style,styleSpec:s,objectElementValidators:ic}),g;case"geojson":if(g=Pa({key:r,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:ic}),e.cluster)for(const y in e.clusterProperties){const[w,E]=e.clusterProperties[y],O="string"==typeof w?[w,["accumulated"],["get",y]]:w;g.push(...$s({key:`${r}.${y}.map`,value:E,expressionContext:"cluster-map"})),g.push(...$s({key:`${r}.${y}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return g;case"video":return Pa({key:r,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return Pa({key:r,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new cr(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ol({key:`${r}.type`,value:e.type,valueSpec:{values:fh(s)},style:u,styleSpec:s})}}function fh(n){return n.source.reduce((e,r)=>{const s=n[r];return"enum"===s.type.type&&(e=e.concat(Object.keys(s.type.values))),e},[])}function ou(n){const e=n.value,r=n.styleSpec,s=r.light,u=n.style;let f=[];const g=Ut(e);if(void 0===e)return f;if("object"!==g)return f=f.concat([new cr("light",e,`object expected, ${g} found`)]),f;for(const y in e){const w=y.match(/^(.*)-transition$/);f=f.concat(w&&s[w[1]]&&s[w[1]].transition?fs({key:y,value:e[y],valueSpec:r.transition,style:u,styleSpec:r}):s[y]?fs({key:y,value:e[y],valueSpec:s[y],style:u,styleSpec:r}):[new cr(y,e[y],`unknown property "${y}"`)])}return f}function qs(n){const e=n.value,r=n.key,s=n.style,u=n.styleSpec,f=u.terrain;let g=[];const y=Ut(e);if(void 0===e)return g;if("object"!==y)return g=g.concat([new cr("terrain",e,`object expected, ${y} found`)]),g;for(const w in e){const E=w.match(/^(.*)-transition$/);g=g.concat(E&&f[E[1]]&&f[E[1]].transition?fs({key:w,value:e[w],valueSpec:u.transition,style:s,styleSpec:u}):f[w]?fs({key:w,value:e[w],valueSpec:f[w],style:s,styleSpec:u}):[new cr(w,e[w],`unknown property "${w}"`)])}if(e.source){const w=s.sources&&s.sources[e.source],E=w&&Ri(w.type);w?"raster-dem"!==E&&g.push(new cr(r,e.source,`terrain cannot be used with a source of type ${String(E)}, it only be used with a "raster-dem" source type`)):g.push(new cr(r,e.source,`source "${e.source}" not found`))}else g.push(new cr(r,e,'terrain is missing required property "source"'));return g}function Va(n){const e=n.value,r=n.style,s=n.styleSpec,u=s.fog;let f=[];const g=Ut(e);if(void 0===e)return f;if("object"!==g)return f=f.concat([new cr("fog",e,`object expected, ${g} found`)]),f;for(const y in e){const w=y.match(/^(.*)-transition$/);f=f.concat(w&&u[w[1]]&&u[w[1]].transition?fs({key:y,value:e[y],valueSpec:s.transition,style:r,styleSpec:s}):u[y]?fs({key:y,value:e[y],valueSpec:u[y],style:r,styleSpec:s}):[new cr(y,e[y],`unknown property "${y}"`)])}return f}const su={"*":()=>[],array:Ec,boolean:function(n){const e=n.value,r=n.key,s=Ut(e);return"boolean"!==s?[new cr(r,e,`boolean expected, ${s} found`)]:[]},number:Rl,color:function(n){const e=n.key,r=n.value,s=Ut(r);return"string"!==s?[new cr(e,r,`color expected, ${s} found`)]:null===ji(r)?[new cr(e,r,`color expected, "${r}" found`)]:[]},enum:Ol,filter:El,function:tc,layer:Ra,object:Pa,source:Au,light:ou,terrain:qs,fog:Va,string:Za,formatted:function(n){return 0===Za(n).length?[]:$s(n)},resolvedImage:function(n){return 0===Za(n).length?[]:$s(n)},projection:function(n){const e=n.value,r=n.styleSpec,s=r.projection,u=n.style;let f=[];const g=Ut(e);if("object"===g)for(const y in e)f=f.concat(fs({key:y,value:e[y],valueSpec:s[y],style:u,styleSpec:r}));else"string"!==g&&(f=f.concat([new cr("projection",e,`object or string expected, ${g} found`)]));return f}};function fs(n){const e=n.value,r=n.valueSpec,s=n.styleSpec;return r.expression&&tr(Ri(e))?tc(n):r.expression&&uo(Fi(e))?$s(n):r.type&&su[r.type]?su[r.type](n):Pa(ei({},n,{valueSpec:r.type?s[r.type]:r}))}function Xa(n){const e=n.value,r=n.key,s=Za(n);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new cr(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new cr(r,e,'"glyphs" url must include a "{range}" token'))),s}function au(n,e=zt){return Oa(fs({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:Xa,"*":()=>[]}}))}const Pu=n=>Oa(Mu(n)),ph=n=>Oa(Fl(n));function Oa(n){return n.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function lu(n,e){let r=!1;if(e&&e.length)for(const s of e)n.fire(new Ur(new Error(s.message))),r=!0;return r}var Ru=La,ka=3;function La(n,e,r){var s=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var u=new Int32Array(this.arrayBuffer);n=u[0],this.d=(e=u[1])+2*(r=u[2]);for(var f=0;f<this.d*this.d;f++){var g=u[ka+f],y=u[ka+f+1];s.push(g===y?null:u.subarray(g,y))}var w=u[ka+s.length+1];this.keys=u.subarray(u[ka+s.length],w),this.bboxes=u.subarray(w),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var E=0;E<this.d*this.d;E++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=r,this.scale=e/n,this.uid=0;var O=r/e*n;this.min=-O,this.max=n+O}La.prototype.insert=function(n,e,r,s,u){this._forEachCell(e,r,s,u,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(u)},La.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},La.prototype._insertCell=function(n,e,r,s,u,f){this.cells[u].push(f)},La.prototype.query=function(n,e,r,s,u){var f=this.min,g=this.max;if(n<=f&&e<=f&&g<=r&&g<=s&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(n,e,r,s,this._queryCell,y,{},u),y},La.prototype._queryCell=function(n,e,r,s,u,f,g,y){var w=this.cells[u];if(null!==w)for(var E=this.keys,O=this.bboxes,z=0;z<w.length;z++){var U=w[z];if(void 0===g[U]){var q=4*U;(y?y(O[q+0],O[q+1],O[q+2],O[q+3]):n<=O[q+2]&&e<=O[q+3]&&r>=O[q+0]&&s>=O[q+1])?(g[U]=!0,f.push(E[U])):g[U]=!1}}},La.prototype._forEachCell=function(n,e,r,s,u,f,g,y){for(var w=this._convertToCellCoord(n),E=this._convertToCellCoord(e),O=this._convertToCellCoord(r),z=this._convertToCellCoord(s),U=w;U<=O;U++)for(var q=E;q<=z;q++){var J=this.d*q+U;if((!y||y(this._convertFromCellCoord(U),this._convertFromCellCoord(q),this._convertFromCellCoord(U+1),this._convertFromCellCoord(q+1)))&&u.call(this,n,e,r,s,J,f,g,y))return}},La.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},La.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},La.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=ka+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var u=new Int32Array(e+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,g=0;g<n.length;g++){var y=n[g];u[ka+g]=f,u.set(y,f),f+=y.length}return u[ka+n.length]=f,u.set(this.keys,f),u[ka+n.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};var R=Kt(Ru);const B={};function $(n,e,r={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),B[e]={klass:n,omit:r.omit||[]}}$(Object,"Object"),R.serialize=function(n,e){const r=n.toArrayBuffer();return e&&e.push(r),{buffer:r}},R.deserialize=function(n){return new R(n.buffer)},Object.defineProperty(R,"name",{value:"Grid"}),$(R,"Grid"),$(Si,"Color"),$(Error,"Error"),$(Gi,"AJAXError"),$(Ii,"ResolvedImage"),$(wc,"StylePropertyFunction"),$(Ws,"StyleExpression",{omit:["_evaluator"]}),$(zs,"ZoomDependentExpression"),$(Yi,"ZoomConstantExpression"),$(Bo,"CompoundExpression",{omit:["_evaluate"]});for(const n in X)B[X[n]._classRegistryKey]||$(X[n],`Expression${n}`);function L(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function Y(n){return Ee.ImageBitmap&&n instanceof Ee.ImageBitmap}function _e(n,e){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(L(n)||Y(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const r=n;return e&&e.push(r.buffer),r}if(n instanceof Ee.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const r=[];for(const s of n)r.push(_e(s,e));return r}if("object"==typeof n){const r=n.constructor,s=r._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const u=r.serialize?r.serialize(n,e):{};if(!r.serialize){for(const f in n)n.hasOwnProperty(f)&&(B[s].omit.indexOf(f)>=0||(u[f]=_e(n[f],e)));n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof n)}function ze(n){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||L(n)||Y(n)||ArrayBuffer.isView(n)||n instanceof Ee.ImageData)return n;if(Array.isArray(n))return n.map(ze);if("object"==typeof n){const e=n.$name||"Object",{klass:r}=B[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(n);const s=Object.create(r.prototype);for(const u of Object.keys(n))"$name"!==u&&(s[u]=ze(n[u]));return s}throw new Error("can't deserialize object of type "+typeof n)}const we={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function Rn(n){for(const e of n)if(Nr(e.charCodeAt(0)))return!0;return!1}function mr(n){for(const e of n)if(!oi(e.charCodeAt(0)))return!1;return!0}function oi(n){return!(we.Arabic(n)||we["Arabic Supplement"](n)||we["Arabic Extended-A"](n)||we["Arabic Presentation Forms-A"](n)||we["Arabic Presentation Forms-B"](n))}function Nr(n){return!(746!==n&&747!==n&&(n<4352||!(we["Bopomofo Extended"](n)||we.Bopomofo(n)||we["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||we["CJK Compatibility Ideographs"](n)||we["CJK Compatibility"](n)||we["CJK Radicals Supplement"](n)||we["CJK Strokes"](n)||!(!we["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||we["CJK Unified Ideographs Extension A"](n)||we["CJK Unified Ideographs"](n)||we["Enclosed CJK Letters and Months"](n)||we["Hangul Compatibility Jamo"](n)||we["Hangul Jamo Extended-A"](n)||we["Hangul Jamo Extended-B"](n)||we["Hangul Jamo"](n)||we["Hangul Syllables"](n)||we.Hiragana(n)||we["Ideographic Description Characters"](n)||we.Kanbun(n)||we["Kangxi Radicals"](n)||we["Katakana Phonetic Extensions"](n)||we.Katakana(n)&&12540!==n||!(!we["Halfwidth and Fullwidth Forms"](n)||65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||!(!we["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||we["Unified Canadian Aboriginal Syllabics"](n)||we["Unified Canadian Aboriginal Syllabics Extended"](n)||we["Vertical Forms"](n)||we["Yijing Hexagram Symbols"](n)||we["Yi Syllables"](n)||we["Yi Radicals"](n))))}function Mi(n){return!(Nr(n)||(e=n,we["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||we["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||we["Letterlike Symbols"](e)||we["Number Forms"](e)||we["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||we["Control Pictures"](e)&&9251!==e||we["Optical Character Recognition"](e)||we["Enclosed Alphanumerics"](e)||we["Geometric Shapes"](e)||we["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||we["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||we["CJK Symbols and Punctuation"](e)||we.Katakana(e)||we["Private Use Area"](e)||we["CJK Compatibility Forms"](e)||we["Small Form Variants"](e)||we["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Da(n){return n>=1424&&n<=2303||we["Arabic Presentation Forms-A"](n)||we["Arabic Presentation Forms-B"](n)}function oc(n,e){return!(!e&&Da(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||we.Khmer(n))}function Bl(n){for(const e of n)if(Da(e.charCodeAt(0)))return!0;return!1}const sc="deferred",Ka="loading",Ou="loaded";let Dl=null,h="unavailable",i=null;const c=function(n){n&&"string"==typeof n&&n.indexOf("NetworkError")>-1&&(h="error"),Dl&&Dl(n)};function p(){_.fire(new bi("pluginStateChange",{pluginStatus:h,pluginURL:i}))}const _=new So,x=function(){return h},C=function(){if(h!==sc||!i)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");h=Ka,p(),i&&ii({url:i},n=>{n?c(n):(h=Ou,p())})},A={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>h===Ou||null!=A.applyArabicShaping,isLoading:()=>h===Ka,setState(n){h=n.pluginStatus,i=n.pluginURL},isParsed:()=>null!=A.applyArabicShaping&&null!=A.processBidirectionalText&&null!=A.processStyledBidirectionalText,getPluginURL:()=>i};class N{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,s){for(const u of r)if(!oc(u.charCodeAt(0),s))return!1;return!0}(e,A.isLoaded())}}class H{constructor(e,r){this.property=e,this.value=r,this.expression=function(s,u){if(tr(s))return new wc(s,u);if(uo(s)){const f=Ao(s,u);if("error"===f.result)throw new Error(f.value.map(g=>`${g.key}: ${g.message}`).join(", "));return f.value}{let f=s;return"string"==typeof s&&"color"===u.type&&(f=Si.parse(s)),{kind:"constant",evaluate:()=>f}}}(void 0===r?e.specification.default:r,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,r,s){return this.property.possiblyEvaluate(this,e,r,s)}}class j{constructor(e){this.property=e,this.value=new H(e,void 0)}transitioned(e,r){return new fe(this.property,this.value,r,Me({},e.transition,this.transition),e.now)}untransitioned(){return new fe(this.property,this.value,null,{},0)}}class re{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return qt(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new j(this._values[e].property)),this._values[e].value=new H(this._values[e].property,null===r?void 0:qt(r))}getTransition(e){return qt(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new j(this._values[e].property)),this._values[e].transition=qt(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(e[r]=s);const u=this.getTransition(r);void 0!==u&&(e[`${r}-transition`]=u)}return e}transitioned(e,r){const s=new ye(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,r._values[u]);return s}untransitioned(){const e=new ye(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class fe{constructor(e,r,s,u,f){const g=u.delay||0,y=u.duration||0;f=f||0,this.property=e,this.value=r,this.begin=f+g,this.end=this.begin+y,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,r,s){const u=e.now||0,f=this.value.possiblyEvaluate(e,r,s),g=this.prior;if(g){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return g.possiblyEvaluate(e,r,s);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,r,s),f,yt(y))}}return f}}class ye{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,s){const u=new Re(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,r,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ie{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return qt(this._values[e].value)}setValue(e,r){this._values[e]=new H(this._values[e].property,null===r?void 0:qt(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(e[r]=s)}return e}possiblyEvaluate(e,r,s){const u=new Re(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,r,s);return u}}class Te{constructor(e,r,s){this.property=e,this.value=r,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,r,s,u){return this.property.evaluate(this.value,this.parameters,e,r,s,u)}}class Re{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ie{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,s){const u=I[this.specification.type];return u?u(e,r,s):e}}class ve{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,s,u){return new Te(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(r,null,{},s,u)}:e.expression,r)}interpolate(e,r,s){if("constant"!==e.value.kind||"constant"!==r.value.kind)return e;if(void 0===e.value.value||void 0===r.value.value)return new Te(this,{kind:"constant",value:void 0},e.parameters);const u=I[this.specification.type];return u?new Te(this,{kind:"constant",value:u(e.value.value,r.value.value,s)},e.parameters):e}evaluate(e,r,s,u,f,g){return"constant"===e.kind?e.value:e.evaluate(r,s,u,f,g)}}class Ne{constructor(e){this.specification=e}possiblyEvaluate(e,r,s,u){return!!e.expression.evaluate(r,null,{},s,u)}interpolate(){return!1}}class $e{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new N(0,{});for(const s in e){const u=e[s];u.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new H(u,void 0),g=this.defaultTransitionablePropertyValues[s]=new j(u);this.defaultTransitioningPropertyValues[s]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate(r)}}}function pt(n,e){return 256*(n=Gt(Math.floor(n),0,255))+Gt(Math.floor(e),0,255)}$(ve,"DataDrivenProperty"),$(ie,"DataConstantProperty"),$(Ne,"ColorRampProperty");const mt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class gt{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ft(n,e=1){let r=0,s=0;return{members:n.map(u=>{const f=mt[u.type].BYTES_PER_ELEMENT,g=r=nn(r,Math.max(e,f)),y=u.components||1;return s=Math.max(s,f),r+=f*y,{name:u.name,type:u.type,components:y,offset:g}}),size:nn(r,Math.max(s,e)),alignment:e}}function nn(n,e){return Math.ceil(n/e)*e}class Un extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.int16[u+0]=r,this.int16[u+1]=s,e}}Un.prototype.bytesPerElement=4,$(Un,"StructArrayLayout2i4");class Zt extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.int16[f+0]=r,this.int16[f+1]=s,this.int16[f+2]=u,e}}Zt.prototype.bytesPerElement=6,$(Zt,"StructArrayLayout3i6");class wn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=4*e;return this.int16[g+0]=r,this.int16[g+1]=s,this.int16[g+2]=u,this.int16[g+3]=f,e}}wn.prototype.bytesPerElement=8,$(wn,"StructArrayLayout4i8");class ln extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,s,u,f,g,y)}emplace(e,r,s,u,f,g,y,w){const E=6*e,O=12*e,z=3*e;return this.int16[E+0]=r,this.int16[E+1]=s,this.uint8[O+4]=u,this.uint8[O+5]=f,this.uint8[O+6]=g,this.uint8[O+7]=y,this.float32[z+2]=w,e}}ln.prototype.bytesPerElement=12,$(ln,"StructArrayLayout2i4ub1f12");class Bn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=4*e;return this.float32[g+0]=r,this.float32[g+1]=s,this.float32[g+2]=u,this.float32[g+3]=f,e}}Bn.prototype.bytesPerElement=16,$(Bn,"StructArrayLayout4f16");class Jt extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,s,u,f)}emplace(e,r,s,u,f,g){const y=6*e,w=3*e;return this.uint16[y+0]=r,this.uint16[y+1]=s,this.uint16[y+2]=u,this.uint16[y+3]=f,this.float32[w+2]=g,e}}Jt.prototype.bytesPerElement=12,$(Jt,"StructArrayLayout4ui1f12");class Cn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=4*e;return this.uint16[g+0]=r,this.uint16[g+1]=s,this.uint16[g+2]=u,this.uint16[g+3]=f,e}}Cn.prototype.bytesPerElement=8,$(Cn,"StructArrayLayout4ui8");class $n extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,s,u,f,g)}emplace(e,r,s,u,f,g,y){const w=6*e;return this.int16[w+0]=r,this.int16[w+1]=s,this.int16[w+2]=u,this.int16[w+3]=f,this.int16[w+4]=g,this.int16[w+5]=y,e}}$n.prototype.bytesPerElement=12,$($n,"StructArrayLayout6i12");class kn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,y,w,E,O,z,U){const q=this.length;return this.resize(q+1),this.emplace(q,e,r,s,u,f,g,y,w,E,O,z,U)}emplace(e,r,s,u,f,g,y,w,E,O,z,U,q){const J=12*e;return this.int16[J+0]=r,this.int16[J+1]=s,this.int16[J+2]=u,this.int16[J+3]=f,this.uint16[J+4]=g,this.uint16[J+5]=y,this.uint16[J+6]=w,this.uint16[J+7]=E,this.int16[J+8]=O,this.int16[J+9]=z,this.int16[J+10]=U,this.int16[J+11]=q,e}}kn.prototype.bytesPerElement=24,$(kn,"StructArrayLayout4i4ui4i24");class Yn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,r,s,u,f,g)}emplace(e,r,s,u,f,g,y){const w=10*e,E=5*e;return this.int16[w+0]=r,this.int16[w+1]=s,this.int16[w+2]=u,this.float32[E+2]=f,this.float32[E+3]=g,this.float32[E+4]=y,e}}Yn.prototype.bytesPerElement=20,$(Yn,"StructArrayLayout3i3f20");class Or extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Or.prototype.bytesPerElement=4,$(Or,"StructArrayLayout1ul4");class di extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,y,w,E,O,z,U,q){const J=this.length;return this.resize(J+1),this.emplace(J,e,r,s,u,f,g,y,w,E,O,z,U,q)}emplace(e,r,s,u,f,g,y,w,E,O,z,U,q,J){const se=20*e,me=10*e;return this.int16[se+0]=r,this.int16[se+1]=s,this.int16[se+2]=u,this.int16[se+3]=f,this.int16[se+4]=g,this.float32[me+3]=y,this.float32[me+4]=w,this.float32[me+5]=E,this.float32[me+6]=O,this.int16[se+14]=z,this.uint32[me+8]=U,this.uint16[se+18]=q,this.uint16[se+19]=J,e}}di.prototype.bytesPerElement=40,$(di,"StructArrayLayout5i4f1i1ul2ui40");class yr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,y){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,s,u,f,g,y)}emplace(e,r,s,u,f,g,y,w){const E=8*e;return this.int16[E+0]=r,this.int16[E+1]=s,this.int16[E+2]=u,this.int16[E+4]=f,this.int16[E+5]=g,this.int16[E+6]=y,this.int16[E+7]=w,e}}yr.prototype.bytesPerElement=16,$(yr,"StructArrayLayout3i2i2i16");class Vr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,s,u,f)}emplace(e,r,s,u,f,g){const y=4*e,w=8*e;return this.float32[y+0]=r,this.float32[y+1]=s,this.float32[y+2]=u,this.int16[w+6]=f,this.int16[w+7]=g,e}}Vr.prototype.bytesPerElement=16,$(Vr,"StructArrayLayout2f1f2i16");class ki extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=12*e,y=3*e;return this.uint8[g+0]=r,this.uint8[g+1]=s,this.float32[y+1]=u,this.float32[y+2]=f,e}}ki.prototype.bytesPerElement=12,$(ki,"StructArrayLayout2ub2f12");class Di extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.float32[f+0]=r,this.float32[f+1]=s,this.float32[f+2]=u,e}}Di.prototype.bytesPerElement=12,$(Di,"StructArrayLayout3f12");class wr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.uint16[f+0]=r,this.uint16[f+1]=s,this.uint16[f+2]=u,e}}wr.prototype.bytesPerElement=6,$(wr,"StructArrayLayout3ui6");class fo extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me,Pe,Xe,Ae,We,it){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me,Pe,Xe,Ae,We,it)}emplace(e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me,Pe,Xe,Ae,We,it,Qe){const rn=30*e,Ht=15*e,xn=60*e;return this.int16[rn+0]=r,this.int16[rn+1]=s,this.int16[rn+2]=u,this.float32[Ht+2]=f,this.float32[Ht+3]=g,this.uint16[rn+8]=y,this.uint16[rn+9]=w,this.uint32[Ht+5]=E,this.uint32[Ht+6]=O,this.uint32[Ht+7]=z,this.uint16[rn+16]=U,this.uint16[rn+17]=q,this.uint16[rn+18]=J,this.float32[Ht+10]=se,this.float32[Ht+11]=me,this.uint8[xn+48]=Pe,this.uint8[xn+49]=Xe,this.uint8[xn+50]=Ae,this.uint32[Ht+13]=We,this.int16[rn+28]=it,this.uint8[xn+58]=Qe,e}}fo.prototype.bytesPerElement=60,$(fo,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Do extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me,Pe,Xe,Ae,We,it,Qe,rn,Ht,xn,Nn,on,Sn,In,Fn){const jn=this.length;return this.resize(jn+1),this.emplace(jn,e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me,Pe,Xe,Ae,We,it,Qe,rn,Ht,xn,Nn,on,Sn,In,Fn)}emplace(e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me,Pe,Xe,Ae,We,it,Qe,rn,Ht,xn,Nn,on,Sn,In,Fn,jn){const gn=38*e,ir=19*e;return this.int16[gn+0]=r,this.int16[gn+1]=s,this.int16[gn+2]=u,this.float32[ir+2]=f,this.float32[ir+3]=g,this.int16[gn+8]=y,this.int16[gn+9]=w,this.int16[gn+10]=E,this.int16[gn+11]=O,this.int16[gn+12]=z,this.int16[gn+13]=U,this.uint16[gn+14]=q,this.uint16[gn+15]=J,this.uint16[gn+16]=se,this.uint16[gn+17]=me,this.uint16[gn+18]=Pe,this.uint16[gn+19]=Xe,this.uint16[gn+20]=Ae,this.uint16[gn+21]=We,this.uint16[gn+22]=it,this.uint16[gn+23]=Qe,this.uint16[gn+24]=rn,this.uint16[gn+25]=Ht,this.uint16[gn+26]=xn,this.uint16[gn+27]=Nn,this.uint16[gn+28]=on,this.uint32[ir+15]=Sn,this.float32[ir+16]=In,this.float32[ir+17]=Fn,this.float32[ir+18]=jn,e}}Do.prototype.bytesPerElement=76,$(Do,"StructArrayLayout3i2f6i15ui1ul3f76");class Co extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}Co.prototype.bytesPerElement=4,$(Co,"StructArrayLayout1f4");class oo extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,s,u,f)}emplace(e,r,s,u,f,g){const y=5*e;return this.float32[y+0]=r,this.float32[y+1]=s,this.float32[y+2]=u,this.float32[y+3]=f,this.float32[y+4]=g,e}}oo.prototype.bytesPerElement=20,$(oo,"StructArrayLayout5f20");class ma extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const g=6*e;return this.uint32[3*e+0]=r,this.uint16[g+2]=s,this.uint16[g+3]=u,this.uint16[g+4]=f,e}}ma.prototype.bytesPerElement=12,$(ma,"StructArrayLayout1ul3ui12");class bo extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.uint16[u+0]=r,this.uint16[u+1]=s,e}}bo.prototype.bytesPerElement=4,$(bo,"StructArrayLayout2ui4");class Ua extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}Ua.prototype.bytesPerElement=2,$(Ua,"StructArrayLayout1ui2");class Ja extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.float32[u+0]=r,this.float32[u+1]=s,e}}Ja.prototype.bytesPerElement=8,$(Ja,"StructArrayLayout2f8");class Vo extends gt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Vo.prototype.size=40;class Po extends di{get(e){return new Vo(this,e)}}$(Po,"CollisionBoxArray");class Qi extends gt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Qi.prototype.size=60;class ps extends fo{get(e){return new Qi(this,e)}}$(ps,"PlacedSymbolArray");class Us extends gt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Us.prototype.size=76;class wo extends Do{get(e){return new Us(this,e)}}$(wo,"SymbolInstanceArray");class Ys extends Co{getoffsetX(e){return this.float32[1*e+0]}}$(Ys,"GlyphOffsetArray");class cu extends Un{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}$(cu,"SymbolLineVertexArray");class Cl extends gt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Cl.prototype.size=12;class cl extends ma{get(e){return new Cl(this,e)}}$(cl,"FeatureIndexArray");class Nl extends bo{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}$(Nl,"FillExtrusionCentroidArray");const zl=Ft([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Cc=Ft([{name:"a_dash",components:4,type:"Uint16"}]);var vd={exports:{}},c_=function(n,e){var r,s,u,f,g,y,w,E;for(s=n.length-(r=3&n.length),u=e,g=3432918353,y=461845907,E=0;E<s;)w=255&n.charCodeAt(E)|(255&n.charCodeAt(++E))<<8|(255&n.charCodeAt(++E))<<16|(255&n.charCodeAt(++E))<<24,++E,u=27492+(65535&(f=5*(65535&(u=(u^=w=(65535&(w=(w=(65535&w)*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*y+(((w>>>16)*y&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(w=0,r){case 3:w^=(255&n.charCodeAt(E+2))<<16;case 2:w^=(255&n.charCodeAt(E+1))<<8;case 1:u^=w=(65535&(w=(w=(65535&(w^=255&n.charCodeAt(E)))*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*y+(((w>>>16)*y&65535)<<16)&4294967295}return u^=n.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0},Lu=function(n,e){for(var r,s=n.length,u=e^s,f=0;s>=4;)r=1540483477*(65535&(r=255&n.charCodeAt(f)|(255&n.charCodeAt(++f))<<8|(255&n.charCodeAt(++f))<<16|(255&n.charCodeAt(++f))<<24))+((1540483477*(r>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:u^=(255&n.charCodeAt(f+2))<<16;case 2:u^=(255&n.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&n.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};vd.exports=c_,vd.exports.murmur3=c_,vd.exports.murmur2=Lu;var Ff=Kt(vd.exports);class gh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,s,u){this.ids.push(ra(e)),this.positions.push(r,s,u)}getPositions(e){const r=ra(e);let s=0,u=this.ids.length-1;for(;s<u;){const g=s+u>>1;this.ids[g]>=r?u=g:s=g+1}const f=[];for(;this.ids[s]===r;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,r){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Bf(s,u,0,s.length-1),r&&r.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const r=new gh;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function ra(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Ff(String(n))}function Bf(n,e,r,s){for(;r<s;){const u=n[r+s>>1];let f=r-1,g=s+1;for(;;){do{f++}while(n[f]<u);do{g--}while(n[g]>u);if(f>=g)break;Tc(n,f,g),Tc(e,3*f,3*g),Tc(e,3*f+1,3*g+1),Tc(e,3*f+2,3*g+2)}g-r<s-g?(Bf(n,e,r,g),r=g+1):(Bf(n,e,g+1,s),s=g)}}function Tc(n,e,r){const s=n[e];n[e]=n[r],n[r]=s}$(gh,"FeaturePositionMap");class ac{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}}class Fa extends ac{constructor(e){super(e),this.current=0}set(e,r,s){this.fetchUniformLocation(e,r)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class uu extends ac{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,s){this.fetchUniformLocation(e,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class Nf extends ac{constructor(e){super(e),this.current=Si.transparent}set(e,r,s){this.fetchUniformLocation(e,r)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const _h=new Float32Array(16),xd=new Float32Array(9),u_=new Float32Array(4);function wm(n){return[pt(255*n.r,255*n.g),pt(255*n.b,255*n.a)]}class bd{constructor(e,r,s){this.value=e,this.uniformNames=r.map(u=>`u_${u}`),this.type=s}setUniform(e,r,s,u,f){r.set(e,f,u.constantOr(this.value))}getBinding(e,r){return"color"===this.type?new Nf(e):new Fa(e)}}class wd{constructor(e,r){this.uniformNames=r.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,s,u,f){const g="u_pattern"===f||"u_dash"===f?this.pattern:"u_pixel_ratio"===f?this.pixelRatio:null;g&&r.set(e,f,g)}getBinding(e,r){return"u_pattern"===r||"u_dash"===r?new uu(e):new Fa(e)}}class Zs{constructor(e,r,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(f=>({name:`a_${f}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,r,s,u,f,g){const y=this.paintVertexArray.length,w=this.expression.evaluate(new N(0),r,{},f,u,g);this.paintVertexArray.resize(e),this._setPaintValue(y,e,w)}updatePaintArray(e,r,s,u,f){const g=this.expression.evaluate({zoom:0},s,u,void 0,f);this._setPaintValue(e,r,g)}_setPaintValue(e,r,s){if("color"===this.type){const u=wm(s);for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<r;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Qa{constructor(e,r,s,u,f,g){this.expression=e,this.uniformNames=r.map(y=>`u_${y}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=r.map(y=>({name:`a_${y}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,r,s,u,f,g){const y=this.expression.evaluate(new N(this.zoom),r,{},f,u,g),w=this.expression.evaluate(new N(this.zoom+1),r,{},f,u,g),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,y,w)}updatePaintArray(e,r,s,u,f){const g=this.expression.evaluate({zoom:this.zoom},s,u,void 0,f),y=this.expression.evaluate({zoom:this.zoom+1},s,u,void 0,f);this._setPaintValue(e,r,g,y)}_setPaintValue(e,r,s,u){if("color"===this.type){const f=wm(s),g=wm(u);for(let y=e;y<r;y++)this.paintVertexArray.emplace(y,f[0],f[1],g[0],g[1])}else{for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,s,u,f){const g=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,y=Gt(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);r.set(e,f,y)}getBinding(e,r){return new Fa(e)}}class el{constructor(e,r,s,u,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=("array"===s?Cc:zl).members;for(let g=0;g<r.length;++g);this.paintVertexArray=new u}populatePaintArray(e,r,s){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,r.patterns&&r.patterns[this.layerId],s)}updatePaintArray(e,r,s,u,f,g){this._setPaintValues(e,r,s.patterns&&s.patterns[this.layerId],g)}_setPaintValues(e,r,s,u){if(!u||!s)return;const f=u[s];if(!f)return;const{tl:g,br:y,pixelRatio:w}=f;for(let E=e;E<r;E++)this.paintVertexArray.emplace(E,g[0],g[1],y[0],y[1],w)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class du{constructor(e,r,s=(()=>!0)){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!s(f))continue;const g=e.paint.get(f);if(!(g instanceof Te&&be(g.property.specification)))continue;const y=h_(f,e.type),w=g.value,E=g.property.specification.type,O=!!g.property.useIntegerZoom,z="line-dasharray"===f||f.endsWith("pattern"),U="line-dasharray"===f&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==w.kind||U)if("source"===w.kind||U||z){const q=Em(f,E,"source");this.binders[f]=z?new el(w,y,E,q,e.id):new Zs(w,y,E,q),u.push(`/a_${f}`)}else{const q=Em(f,E,"composite");this.binders[f]=new Qa(w,y,E,O,r,q),u.push(`/z_${f}`)}else this.binders[f]=z?new wd(w.value,y):new bd(w.value,y,E),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Zs||r instanceof Qa?r.maxValue:0}populatePaintArrays(e,r,s,u,f,g){for(const y in this.binders){const w=this.binders[y];(w instanceof Zs||w instanceof Qa||w instanceof el)&&w.populatePaintArray(e,r,s,u,f,g)}}setConstantPatternPositions(e){for(const r in this.binders){const s=this.binders[r];s instanceof wd&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,r,s,u,f,g){let y=!1;for(const w in e){const E=r.getPositions(w);for(const O of E){const z=s.feature(O.index);for(const U in this.binders){const q=this.binders[U];if((q instanceof Zs||q instanceof Qa||q instanceof el)&&!0===q.expression.isStateDependent){const J=u.paint.get(U);q.expression=J.value,q.updatePaintArray(O.start,O.end,z,e[w],f,g),y=!0}}}}return y}defines(){const e=[];for(const r in this.binders){const s=this.binders[r];(s instanceof bd||s instanceof wd)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Zs||s instanceof Qa||s instanceof el)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof bd||s instanceof wd||s instanceof Qa)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const r=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof bd||u instanceof wd||u instanceof Qa)for(const f of u.uniformNames)r.push({name:f,property:s,binding:u.getBinding(e,f)})}return r}setUniforms(e,r,s,u,f){for(const{name:g,property:y,binding:w}of s)this.binders[y].setUniform(e,w,f,u.get(y),g)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const r=this.binders[e];(r instanceof Zs||r instanceof Qa||r instanceof el)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){const s=this.binders[r];(s instanceof Zs||s instanceof Qa||s instanceof el)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Zs||r instanceof Qa||r instanceof el)&&r.destroy()}}}class Sc{constructor(e,r,s=(()=>!0)){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new du(u,r,s);this.needsUpload=!1,this._featureMap=new gh,this._bufferOffset=0}populatePaintArrays(e,r,s,u,f,g,y){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,r,u,f,g,y);void 0!==r.id&&this._featureMap.add(r.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,s,u,f){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,r,g,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const d_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function h_(n,e){return d_[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const f_={"line-pattern":{source:Jt,composite:Jt},"fill-pattern":{source:Jt,composite:Jt},"fill-extrusion-pattern":{source:Jt,composite:Jt},"line-dasharray":{source:Cn,composite:Cn}},p_={color:{source:Ja,composite:Bn},number:{source:Co,composite:Ja}};function Em(n,e,r){const s=f_[n];return s&&s[r]||p_[e][r]}$(bd,"ConstantBinder"),$(wd,"PatternConstantBinder"),$(Zs,"SourceExpressionBinder"),$(el,"PatternCompositeBinder"),$(Qa,"CompositeExpressionBinder"),$(du,"ProgramConfiguration",{omit:["_buffers"]}),$(Sc,"ProgramConfigurationSet");const Dm="-transition";class tl extends So{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Ie(r.layout)),r.paint)){this._transitionablePaint=new re(r.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Re(r.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,s={}){null!=r&&this._validate(ph,`layers.${this.id}.layout.${e}`,e,r,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return ur(e,Dm)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,s={}){if(null!=r&&this._validate(Pu,`layers.${this.id}.paint.${e}`,e,r,s))return!1;if(ur(e,Dm))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.value.isDataDriven(),g=u.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const y=this._transitionablePaint._values[e].value,w=y.isDataDriven(),E=ur(e,"pattern")||"line-dasharray"===e;return w||f||E||this._handleOverridablePaintPropertyUpdate(e,g,y)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ot(e,(r,s)=>!(void 0===r||"layout"===s&&!Object.keys(r).length||"paint"===s&&!Object.keys(r).length))}_validate(e,r,s,u,f={}){return(!f||!1!==f.validate)&&lu(this,e.call(au,{key:r,layerType:this.type,objectKey:s,value:u,styleSpec:zt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof Te&&be(r.property.specification)&&("source"===r.value.kind||"composite"===r.value.kind)&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=nc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const yh=Ft([{name:"a_pos",components:2,type:"Int16"}],4),Cm=Ft([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class as{constructor(e=[]){this.segments=e}prepareSegment(e,r,s,u){let f=this.segments[this.segments.length-1];return e>as.MAX_VERTEX_ARRAY_LENGTH&&vn(`Max vertices per segment is ${as.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>as.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==u&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,s,u){return new as([{vertexOffset:e,primitiveOffset:r,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}as.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$(as,"SegmentVector");var zr=8192;class Tl{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof po?new po(e.lng,e.lat):po.convert(e),this}setSouthWest(e){return this._sw=e instanceof po?new po(e.lng,e.lat):po.convert(e),this}extend(e){const r=this._sw,s=this._ne;let u,f;if(e instanceof po)u=e,f=e;else{if(!(e instanceof Tl))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Tl.convert(e)):this.extend(po.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(po.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return r||s?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),s.lng=Math.max(f.lng,s.lng),s.lat=Math.max(f.lat,s.lat)):(this._sw=new po(u.lng,u.lat),this._ne=new po(f.lng,f.lat)),this}getCenter(){return new po((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new po(this.getWest(),this.getNorth())}getSouthEast(){return new po(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:s}=po.convert(e);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof Tl?e:new Tl(e)}}var vh=1e-6,Ba=typeof Float32Array<"u"?Float32Array:Array;function xh(){var n=new Ba(9);return Ba!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Ed(n,e,r){var s=e[0],u=e[1],f=e[2],g=e[3],y=e[4],w=e[5],E=e[6],O=e[7],z=e[8],U=r[0],q=r[1],J=r[2],se=r[3],me=r[4],Pe=r[5],Xe=r[6],Ae=r[7],We=r[8];return n[0]=U*s+q*g+J*E,n[1]=U*u+q*y+J*O,n[2]=U*f+q*w+J*z,n[3]=se*s+me*g+Pe*E,n[4]=se*u+me*y+Pe*O,n[5]=se*f+me*w+Pe*z,n[6]=Xe*s+Ae*g+We*E,n[7]=Xe*u+Ae*y+We*O,n[8]=Xe*f+Ae*w+We*z,n}function ul(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function zf(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=e[4],y=e[5],w=e[6],E=e[7],O=e[8],z=e[9],U=e[10],q=e[11],J=e[12],se=e[13],me=e[14],Pe=e[15],Xe=r*y-s*g,Ae=r*w-u*g,We=r*E-f*g,it=s*w-u*y,Qe=s*E-f*y,rn=u*E-f*w,Ht=O*se-z*J,xn=O*me-U*J,Nn=O*Pe-q*J,on=z*me-U*se,Sn=z*Pe-q*se,In=U*Pe-q*me,Fn=Xe*In-Ae*Sn+We*on+it*Nn-Qe*xn+rn*Ht;return Fn?(n[0]=(y*In-w*Sn+E*on)*(Fn=1/Fn),n[1]=(u*Sn-s*In-f*on)*Fn,n[2]=(se*rn-me*Qe+Pe*it)*Fn,n[3]=(U*Qe-z*rn-q*it)*Fn,n[4]=(w*Nn-g*In-E*xn)*Fn,n[5]=(r*In-u*Nn+f*xn)*Fn,n[6]=(me*We-J*rn-Pe*Ae)*Fn,n[7]=(O*rn-U*We+q*Ae)*Fn,n[8]=(g*Sn-y*Nn+E*Ht)*Fn,n[9]=(s*Nn-r*Sn-f*Ht)*Fn,n[10]=(J*Qe-se*We+Pe*Xe)*Fn,n[11]=(z*We-O*Qe-q*Xe)*Fn,n[12]=(y*xn-g*on-w*Ht)*Fn,n[13]=(r*on-s*xn+u*Ht)*Fn,n[14]=(se*Ae-J*it-me*Xe)*Fn,n[15]=(O*it-z*Ae+U*Xe)*Fn,n):null}function hu(n,e,r){var s=e[0],u=e[1],f=e[2],g=e[3],y=e[4],w=e[5],E=e[6],O=e[7],z=e[8],U=e[9],q=e[10],J=e[11],se=e[12],me=e[13],Pe=e[14],Xe=e[15],Ae=r[0],We=r[1],it=r[2],Qe=r[3];return n[0]=Ae*s+We*y+it*z+Qe*se,n[1]=Ae*u+We*w+it*U+Qe*me,n[2]=Ae*f+We*E+it*q+Qe*Pe,n[3]=Ae*g+We*O+it*J+Qe*Xe,n[4]=(Ae=r[4])*s+(We=r[5])*y+(it=r[6])*z+(Qe=r[7])*se,n[5]=Ae*u+We*w+it*U+Qe*me,n[6]=Ae*f+We*E+it*q+Qe*Pe,n[7]=Ae*g+We*O+it*J+Qe*Xe,n[8]=(Ae=r[8])*s+(We=r[9])*y+(it=r[10])*z+(Qe=r[11])*se,n[9]=Ae*u+We*w+it*U+Qe*me,n[10]=Ae*f+We*E+it*q+Qe*Pe,n[11]=Ae*g+We*O+it*J+Qe*Xe,n[12]=(Ae=r[12])*s+(We=r[13])*y+(it=r[14])*z+(Qe=r[15])*se,n[13]=Ae*u+We*w+it*U+Qe*me,n[14]=Ae*f+We*E+it*q+Qe*Pe,n[15]=Ae*g+We*O+it*J+Qe*Xe,n}function $l(n,e,r){var s,u,f,g,y,w,E,O,z,U,q,J,se=r[0],me=r[1],Pe=r[2];return e===n?(n[12]=e[0]*se+e[4]*me+e[8]*Pe+e[12],n[13]=e[1]*se+e[5]*me+e[9]*Pe+e[13],n[14]=e[2]*se+e[6]*me+e[10]*Pe+e[14],n[15]=e[3]*se+e[7]*me+e[11]*Pe+e[15]):(u=e[1],f=e[2],g=e[3],y=e[4],w=e[5],E=e[6],O=e[7],z=e[8],U=e[9],q=e[10],J=e[11],n[0]=s=e[0],n[1]=u,n[2]=f,n[3]=g,n[4]=y,n[5]=w,n[6]=E,n[7]=O,n[8]=z,n[9]=U,n[10]=q,n[11]=J,n[12]=s*se+y*me+z*Pe+e[12],n[13]=u*se+w*me+U*Pe+e[13],n[14]=f*se+E*me+q*Pe+e[14],n[15]=g*se+O*me+J*Pe+e[15]),n}function Sl(n,e,r){var s=r[0],u=r[1],f=r[2];return n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n[3]=e[3]*s,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function $f(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[4],g=e[5],y=e[6],w=e[7],E=e[8],O=e[9],z=e[10],U=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*u+E*s,n[5]=g*u+O*s,n[6]=y*u+z*s,n[7]=w*u+U*s,n[8]=E*u-f*s,n[9]=O*u-g*s,n[10]=z*u-y*s,n[11]=U*u-w*s,n}function Vf(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[0],g=e[1],y=e[2],w=e[3],E=e[8],O=e[9],z=e[10],U=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u-E*s,n[1]=g*u-O*s,n[2]=y*u-z*s,n[3]=w*u-U*s,n[8]=f*s+E*u,n[9]=g*s+O*u,n[10]=y*s+z*u,n[11]=w*s+U*u,n}function Uf(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Tm(n,e,r){var s,u,f,g=r[0],y=r[1],w=r[2],E=Math.hypot(g,y,w);return E<vh?null:(g*=E=1/E,y*=E,w*=E,s=Math.sin(e),u=Math.cos(e),n[0]=g*g*(f=1-u)+u,n[1]=y*g*f+w*s,n[2]=w*g*f-y*s,n[3]=0,n[4]=g*y*f-w*s,n[5]=y*y*f+u,n[6]=w*y*f+g*s,n[7]=0,n[8]=g*w*f+y*s,n[9]=y*w*f-g*s,n[10]=w*w*f+u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var mv=hu;function jf(){var n=new Ba(3);return Ba!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Sm(n){var e=new Ba(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Dd(n){return Math.hypot(n[0],n[1],n[2])}function lc(n,e,r){var s=new Ba(3);return s[0]=n,s[1]=e,s[2]=r,s}function Vl(n,e,r){return n[0]=e[0]+r[0],n[1]=e[1]+r[1],n[2]=e[2]+r[2],n}function Hf(n,e,r){return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],n}function Gf(n,e,r){return n[0]=e[0]*r[0],n[1]=e[1]*r[1],n[2]=e[2]*r[2],n}function bh(n,e,r){return n[0]=Math.min(e[0],r[0]),n[1]=Math.min(e[1],r[1]),n[2]=Math.min(e[2],r[2]),n}function Fu(n,e,r){return n[0]=Math.max(e[0],r[0]),n[1]=Math.max(e[1],r[1]),n[2]=Math.max(e[2],r[2]),n}function dl(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n}function Cd(n,e,r,s){return n[0]=e[0]+r[0]*s,n[1]=e[1]+r[1]*s,n[2]=e[2]+r[2]*s,n}function Ca(n,e){var r=e[0],s=e[1],u=e[2],f=r*r+s*s+u*u;return f>0&&(f=1/Math.sqrt(f)),n[0]=e[0]*f,n[1]=e[1]*f,n[2]=e[2]*f,n}function ja(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Im(n,e,r){var s=e[0],u=e[1],f=e[2],g=r[0],y=r[1],w=r[2];return n[0]=u*w-f*y,n[1]=f*g-s*w,n[2]=s*y-u*g,n}function Ps(n,e,r){var s=e[0],u=e[1],f=e[2],g=r[3]*s+r[7]*u+r[11]*f+r[15];return n[0]=(r[0]*s+r[4]*u+r[8]*f+r[12])/(g=g||1),n[1]=(r[1]*s+r[5]*u+r[9]*f+r[13])/g,n[2]=(r[2]*s+r[6]*u+r[10]*f+r[14])/g,n}function wh(n,e,r){var s=r[0],u=r[1],f=r[2],g=e[0],y=e[1],w=e[2],E=u*w-f*y,O=f*g-s*w,z=s*y-u*g,U=u*z-f*O,q=f*E-s*z,J=s*O-u*E,se=2*r[3];return O*=se,z*=se,q*=2,J*=2,n[0]=g+(E*=se)+(U*=2),n[1]=y+O+q,n[2]=w+z+J,n}var Eh,Ul=Hf,gv=Gf,_v=Dd;function m_(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n}function Mm(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=r*r+s*s+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),n[0]=r*g,n[1]=s*g,n[2]=u*g,n[3]=f*g,n}function jl(n,e,r){var s=e[0],u=e[1],f=e[2],g=e[3];return n[0]=r[0]*s+r[4]*u+r[8]*f+r[12]*g,n[1]=r[1]*s+r[5]*u+r[9]*f+r[13]*g,n[2]=r[2]*s+r[6]*u+r[10]*f+r[14]*g,n[3]=r[3]*s+r[7]*u+r[11]*f+r[15]*g,n}function Td(){var n=new Ba(4);return Ba!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Wf(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function qf(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],y=Math.sin(r),w=Math.cos(r);return n[0]=s*w+g*y,n[1]=u*w+f*y,n[2]=f*w-u*y,n[3]=g*w-s*y,n}function Yf(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],y=Math.sin(r),w=Math.cos(r);return n[0]=s*w-f*y,n[1]=u*w+g*y,n[2]=f*w+s*y,n[3]=g*w-u*y,n}jf(),Eh=new Ba(4),Ba!=Float32Array&&(Eh[0]=0,Eh[1]=0,Eh[2]=0,Eh[3]=0);var Bu=Mm;jf(),lc(1,0,0),lc(0,1,0),Td(),Td(),xh();const Am=Ft([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Zf}=Am,Sd=Ft([{name:"a_pos_3",components:3,type:"Int16"}]);var Ic=Ft([{name:"a_pos",type:"Int16",components:2}]);class Nu{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,s){const u=ja(r,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/u;return s[0]=this.pos[0]+this.dir[0]*f,s[1]=this.pos[1]+this.dir[1]*f,s[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,r,s){if(se=(q=this.pos)[0],me=q[1],Pe=q[2],Xe=(J=e)[0],Ae=J[1],We=J[2],Math.abs(se-Xe)<=vh*Math.max(1,Math.abs(se),Math.abs(Xe))&&Math.abs(me-Ae)<=vh*Math.max(1,Math.abs(me),Math.abs(Ae))&&Math.abs(Pe-We)<=vh*Math.max(1,Math.abs(Pe),Math.abs(We))||0===r)return s[0]=s[1]=s[2]=0,!1;var q,J,se,me,Pe,Xe,Ae,We;const[u,f,g]=this.dir,y=this.pos[0]-e[0],w=this.pos[1]-e[1],E=this.pos[2]-e[2],O=u*u+f*f+g*g,z=2*(y*u+w*f+E*g),U=z*z-4*O*(y*y+w*w+E*E-r*r);if(U<0){const q=Math.max(-z/2,0),J=y+u*q,se=w+f*q,me=E+g*q,Pe=Math.hypot(J,se,me);return s[0]=J*r/Pe,s[1]=se*r/Pe,s[2]=me*r/Pe,!1}{const q=(-z-Math.sqrt(U))/(2*O);if(q<0){const J=Math.hypot(y,w,E);return s[0]=y*r/J,s[1]=w*r/J,s[2]=E*r/J,!1}return s[0]=y+u*q,s[1]=w+f*q,s[2]=E+g*q,!0}}}class Xf{constructor(e,r,s,u,f){this.TL=e,this.TR=r,this.BR=s,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,r,s){const u=[-1,1,1],f=[1,1,1],g=[1,-1,1],y=[-1,-1,1],w=Ps(u,u,e),E=Ps(f,f,e),O=Ps(g,g,e),z=Ps(y,y,e);return new Xf(w,E,O,z,r/s)}}class Kf{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,s,u){const f=Math.pow(2,s),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const E=jl([],w,e),O=1/E[3]/r*f;return(z=E)[0]=(U=E)[0]*(q=[O,O,u?1/E[3]:O,O])[0],z[1]=U[1]*q[1],z[2]=U[2]*q[2],z[3]=U[3]*q[3],z;var z,U,q}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const E=Ca([],Im([],Ul([],g[w[0]],g[w[1]]),Ul([],g[w[2]],g[w[1]]))),O=-ja(E,g[w[1]]);return E.concat(O)});return new Kf(g,y)}}class Ta{static fromPoints(e){const r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const u of e)bh(r,r,u),Fu(s,s,u);return new Ta(r,s)}static applyTransform(e,r){const s=e.getCorners();for(let u=0;u<s.length;++u)Ps(s[u],s[u],r);return Ta.fromPoints(s)}constructor(e,r){this.min=e,this.max=r,this.center=dl([],Vl([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],s=Sm(this.min),u=Sm(this.max);for(let f=0;f<r.length;f++)s[f]=r[f]?this.min[f]:this.center[f],u[f]=r[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new Ta(s,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let s=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let g=0;for(let y=0;y<r.length;y++)g+=ja(f,r[y])+f[3]>=0;if(0===g)return 0;g!==r.length&&(s=!1)}if(s)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let y=0;y<e.points.length;y++){const w=e.points[y][u]-this.min[u];f=Math.min(f,w),g=Math.max(g,w)}if(g<0||f>this.max[u]-this.min[u])return 0}return 1}}const Dh=5,Ch=6,Hl=zr/Math.PI/2,g_=16383,zu=[64,32,16],hl=-Hl,fl=Hl,Ha=[new Ta([hl,hl,hl],[fl,fl,fl]),new Ta([hl,hl,hl],[0,0,fl]),new Ta([0,hl,hl],[fl,0,fl]),new Ta([hl,0,hl],[0,fl,fl]),new Ta([0,0,hl],[fl,fl,fl])];function $u(n){return n*Hl/Ac}function Jf(n,e,r,s=!0){const u=dl([],n._camera.position,n.worldSize),f=[e,r,1,1];jl(f,f,n.pixelMatrixInverse),m_(f,f,1/f[3]);const g=Ca([],Ul([],f,u)),y=n.globeMatrix,w=[y[12],y[13],y[14]],E=Ul([],w,u),O=Dd(E),z=Ca([],E),U=n.worldSize/(2*Math.PI),q=ja(z,g),J=Math.asin(U/O);if(J<Math.acos(q)){if(!s)return null;const Nn=[],on=[];dl(Nn,g,O/q),Ca(on,Ul(on,Nn,E)),Ca(g,Vl(g,E,dl(g,on,Math.tan(J)*O)))}const se=[];new Nu(u,g).closestPointOnSphere(w,U,se);const me=Ca([],vi(y,0)),Pe=Ca([],vi(y,1)),Xe=Ca([],vi(y,2)),Ae=ja(me,se),We=ja(Pe,se),it=ja(Xe,se),Qe=ft(Math.asin(-We/U));let rn=ft(Math.atan2(Ae,it));rn=n.center.lng+function(Nn,on){const Sn=(on-Nn+180)%360-180;return Sn<-180?Sn+360:Sn}(n.center.lng,rn);const Ht=Wl(rn),xn=Gt(ql(Qe),0,1);return new Pc(Ht,xn)}class Qf{constructor(e,r,s){this.a=Ul([],e,s),this.b=Ul([],r,s),this.center=s;const u=Ca([],this.a),f=Ca([],this.b);this.angle=Math.acos(ja(u,f))}}function ga(n,e){if(0===n.angle)return null;let r;return r=0===n.a[e]?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),r<0||r>1?null:function(s,u,f,g){const y=Math.sin(f);return s*(Math.sin((1-g)*f)/y)+u*(Math.sin(g*f)/y)}(n.a[e],n.b[e],n.angle,Gt(r,0,1))+n.center[e]}function Ga(n){if(n.z<=1)return Ha[n.z+2*n.y+n.x];const e=Sh(Th(n));return Ta.fromPoints(e)}function Mc(n,e,r){return dl(n,n,1-r),Cd(n,n,e,r)}function ep(n,e){const r=ju(e.zoom);if(0===r)return Ga(n);const s=Th(n),u=Sh(s),f=Wl(s.getWest())*e.worldSize,g=Wl(s.getEast())*e.worldSize,y=ql(s.getNorth())*e.worldSize,w=ql(s.getSouth())*e.worldSize,E=[f,y,0],O=[g,y,0],z=[f,w,0],U=[g,w,0],q=zf([],e.globeMatrix);return Ps(E,E,q),Ps(O,O,q),Ps(z,z,q),Ps(U,U,q),u[0]=Mc(u[0],z,r),u[1]=Mc(u[1],U,r),u[2]=Mc(u[2],O,r),u[3]=Mc(u[3],E,r),Ta.fromPoints(u)}function Pm(n,e,r){for(const s of n)Ps(s,s,e),dl(s,s,r)}function Th({x:n,y:e,z:r}){const s=1/(1<<r),u=new po(nl(n*s),_a((e+1)*s)),f=new po(nl((n+1)*s),_a(e*s));return new Tl(u,f)}function Sh(n){const e=De(n.getNorth()),r=De(n.getSouth()),s=Math.cos(e),u=Math.cos(r),f=Math.sin(e),g=Math.sin(r),y=n.getWest(),w=n.getEast();return[Vu(u,g,y),Vu(u,g,w),Vu(s,f,w),Vu(s,f,y)]}function Vu(n,e,r,s=Hl){return r=De(r),[n*Math.sin(r)*s,-e*s,n*Math.cos(r)*s]}function pu(n,e,r){return Vu(Math.cos(De(n)),Math.sin(De(n)),e,r)}function Id(n,e,r,s){const u=1<<r.z,f=(n/zr+r.x)/u;return pu(_a((e/zr+r.y)/u),nl(f),s)}function Ih({min:n,max:e}){return g_/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const Mh=new Float64Array(16);function mu(n){const e=Ih(n),r=Uf(Mh,[e,e,e]);return $l(r,r,((s=[])[0]=-(u=n.min)[0],s[1]=-u[1],s[2]=-u[2],s));var s,u}function tp(n){const e=(s=n.min,(r=Mh)[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=s[0],r[13]=s[1],r[14]=s[2],r[15]=1,r);var r,s;const u=1/Ih(n);return Sl(e,e,[u,u,u])}function Uu(n,e,r,s,u){const f=function(w){const E=zr/(2*Math.PI);return w/(2*Math.PI)/E}(r),g=[n,e,-r/(2*Math.PI)],y=ul(new Float64Array(16));return $l(y,y,g),Sl(y,y,[f,f,f]),$f(y,y,De(-u)),Vf(y,y,De(-s)),y}function ju(n){return nr(Dh,Ch,n)}function Om(n,e){const r=pu(e.lat,e.lng);return g=(u=Hf([],function(J){const se=pu(J._center.lat,J._center.lng);let me=Im([],lc(0,1,0),se);const Pe=Tm([],-J.angle,se);me=Ps(me,me,Pe),Tm(Pe,-J._pitch,me);const Xe=Ca([],se);return dl(Xe,Xe,$u(J.cameraToCenterDistance/J.pixelsPerMeter)),Ps(Xe,Xe,Pe),Vl([],se,Xe)}(n),r))[0],y=u[1],w=u[2],E=(f=r)[0],O=f[1],z=f[2],q=(U=Math.sqrt(g*g+y*y+w*w)*Math.sqrt(E*E+O*O+z*z))&&ja(u,f)/U,Math.acos(Math.min(Math.max(q,-1),1));var u,f,g,y,w,E,O,z,U,q}function Ah(n,e){return Om(n,e)>Math.PI/2*1.01}const np=De(85),km=Math.cos(np),Hu=Math.sin(np),Ac=6371008.8,rp=2*Math.PI*Ac;class Gl{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gl(Wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,s=this.lat*r,u=e.lat*r,f=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*r);return Ac*Math.acos(Math.min(f,1))}toBounds(e=0){const r=360*e/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new Tl(new Gl(this.lng-s,this.lat-r),new Gl(this.lng+s,this.lat+r))}toEcef(e){const r=$u(e);return pu(this.lat,this.lng,Hl+r)}static convert(e){if(e instanceof Gl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Gl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Gl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var po=Gl;function ip(n){return rp*Math.cos(n*Math.PI/180)}function Wl(n){return(180+n)/360}function ql(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Il(n,e){return n/ip(e)}function nl(n){return 360*n-180}function _a(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function op(n,e){return n*ip(_a(e))}const Xs=85.051129;function Ph(n){return 1/Math.cos(n*Math.PI/180)}class Pc{constructor(e,r,s=0){this.x=+e,this.y=+r,this.z=+s}static fromLngLat(e,r=0){const s=po.convert(e);return new Pc(Wl(s.lng),ql(s.lat),Il(r,s.lat))}toLngLat(){return new po(nl(this.x),_a(this.y))}toAltitude(){return op(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rp*Ph(_a(this.y))}}function sp(n,e,r,s,u,f,g,y,w){const E=(e+s)/2,O=(r+u)/2,z=new Le(E,O);y(z),function(U,q,J,se,me,Pe){const Xe=J-me,Ae=se-Pe;return Math.abs((se-q)*Xe-(J-U)*Ae)/Math.hypot(Xe,Ae)}(z.x,z.y,f.x,f.y,g.x,g.y)>=w?(sp(n,e,r,E,O,f,z,y,w),sp(n,E,O,s,u,z,g,y,w)):n.push(g)}function Lm(n,e,r){let s=n[0],u=s.x,f=s.y;e(s);const g=[s];for(let y=1;y<n.length;y++){const w=n[y],{x:E,y:O}=w;e(w),sp(g,u,f,E,O,s,w,e,r),u=E,f=O,s=w}return g}function Md(n,e,r,s){if(s(e,r)){const u=e.add(r)._mult(.5);Md(n,e,u,s),Md(n,u,r,s)}else n.push(r)}function Fm(n,e){let r=n[0];const s=[r];for(let u=1;u<n.length;u++){const f=n[u];Md(s,r,f,e),r=f}return s}const cc=Math.pow(2,14)-1,ap=-cc-1;function Bm(n,e){const r=Math.round(n.x*e),s=Math.round(n.y*e);return n.x=Gt(r,ap,cc),n.y=Gt(s,ap,cc),(r<n.x||r>n.x+1||s<n.y||s>n.y+1)&&vn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function uc(n,e,r){const s=n.loadGeometry(),u=n.extent,f=zr/u;if(e&&r&&r.projection.isReprojectedInTileSpace){const g=1<<e.z,{scale:y,x:w,y:E,projection:O}=r,z=U=>{const q=nl((e.x+U.x/u)/g),J=_a((e.y+U.y/u)/g),se=O.project(q,J);U.x=(se.x*y-w)*u,U.y=(se.y*y-E)*u};for(let U=0;U<s.length;U++)if(1!==n.type)s[U]=Lm(s[U],z,1);else{const q=[];for(const J of s[U])J.x<0||J.x>=u||J.y<0||J.y>=u||(z(J),q.push(J));s[U]=q}}for(const g of s)for(const y of g)Bm(y,f);return s}function Gu(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?uc(n):[]}}function gu(n,e,r,s,u){n.emplaceBack(2*e+(s+1)/2,2*r+(u+1)/2)}function Rh(n,e,r){n.emplaceBack(e.x,e.y,e.z,16384*r[0],16384*r[1],16384*r[2])}class Oh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Un,this.indexArray=new wr,this.segments=new as,this.programConfigurations=new Sc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,s,u){const f=this.layers[0],g=[];let y=null;"circle"===f.type&&(y=f.layout.get("circle-sort-key"));for(const{feature:E,id:O,index:z,sourceLayerIndex:U}of e){const q=this.layers[0]._featureFilter.needGeometry,J=Gu(E,q);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),J,s))continue;const se=y?y.evaluate(J,{},s):void 0,me={id:O,properties:E.properties,type:E.type,sourceLayerIndex:U,index:z,geometry:q?J.geometry:uc(E,s,u),patterns:{},sortKey:se};g.push(me)}y&&g.sort((E,O)=>E.sortKey-O.sortKey);let w=null;"globe"===u.projection.name&&(this.globeExtVertexArray=new $n,w=u.projection);for(const E of g){const{geometry:O,index:z,sourceLayerIndex:U}=E,q=e[z].feature;this.addFeature(E,O,z,r.availableImages,s,w),r.featureIndex.insert(q,O,z,U,this.index)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,yh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Cm.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,s,u,f,g){for(const y of r)for(const w of y){const E=w.x,O=w.y;if(E<0||E>=zr||O<0||O>=zr)continue;if(g){const q=g.projectTilePoint(E,O,f),J=g.upVector(f,E,O),se=this.globeExtVertexArray;Rh(se,q,J),Rh(se,q,J),Rh(se,q,J),Rh(se,q,J)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=z.vertexLength;gu(this.layoutVertexArray,E,O,-1,-1),gu(this.layoutVertexArray,E,O,1,-1),gu(this.layoutVertexArray,E,O,1,1),gu(this.layoutVertexArray,E,O,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u,f)}}function lp(n,e){for(let r=0;r<n.length;r++)if(Rc(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(Rc(n,e[r]))return!0;return!!Wu(n,e)}function Nm(n,e,r){return!!Rc(n,e)||!!Lh(e,n,r)}function kh(n,e){if(1===n.length)return Pd(e,n[0]);for(let r=0;r<e.length;r++){const s=e[r];for(let u=0;u<s.length;u++)if(Rc(n,s[u]))return!0}for(let r=0;r<n.length;r++)if(Pd(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(Wu(n,e[r]))return!0;return!1}function zm(n,e,r){if(n.length>1){if(Wu(n,e))return!0;for(let s=0;s<e.length;s++)if(Lh(e[s],n,r))return!0}for(let s=0;s<n.length;s++)if(Lh(n[s],e,r))return!0;return!1}function Wu(n,e){if(0===n.length||0===e.length)return!1;for(let r=0;r<n.length-1;r++){const s=n[r],u=n[r+1];for(let f=0;f<e.length-1;f++)if(Ad(s,u,e[f],e[f+1]))return!0}return!1}function Ad(n,e,r,s){return Gn(n,r,s)!==Gn(e,r,s)&&Gn(n,e,r)!==Gn(n,e,s)}function Lh(n,e,r){const s=r*r;if(1===e.length)return n.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(Fh(n,e[u-1],e[u])<s)return!0;return!1}function Fh(n,e,r){const s=e.distSqr(r);if(0===s)return n.distSqr(e);const u=((n.x-e.x)*(r.x-e.x)+(n.y-e.y)*(r.y-e.y))/s;return n.distSqr(u<0?e:u>1?r:r.sub(e)._mult(u)._add(e))}function Pd(n,e){let r,s,u,f=!1;for(let g=0;g<n.length;g++){r=n[g];for(let y=0,w=r.length-1;y<r.length;w=y++)s=r[y],u=r[w],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(f=!f)}return f}function Rc(n,e){let r=!1;for(let s=0,u=n.length-1;s<n.length;u=s++){const f=n[s],g=n[u];f.y>e.y!=g.y>e.y&&e.x<(g.x-f.x)*(e.y-f.y)/(g.y-f.y)+f.x&&(r=!r)}return r}function Bh(n,e,r,s,u){for(const g of n)if(e<=g.x&&r<=g.y&&s>=g.x&&u>=g.y)return!0;const f=[new Le(e,r),new Le(e,u),new Le(s,u),new Le(s,r)];if(n.length>2)for(const g of f)if(Rc(n,g))return!0;for(let g=0;g<n.length-1;g++)if(Rd(n[g],n[g+1],f))return!0;return!1}function Rd(n,e,r){const s=r[0],u=r[2];if(n.x<s.x&&e.x<s.x||n.x>u.x&&e.x>u.x||n.y<s.y&&e.y<s.y||n.y>u.y&&e.y>u.y)return!1;const f=Gn(n,e,r[0]);return f!==Gn(n,e,r[1])||f!==Gn(n,e,r[2])||f!==Gn(n,e,r[3])}function qu(n,e,r){const s=e.paint.get(n).value;return"constant"===s.kind?s.value:r.programConfigurations.get(e.id).getMaxValue(n)}function Od(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function $m(n,e,r,s,u){if(!e[0]&&!e[1])return n;const f=Le.convert(e)._mult(u);"viewport"===r&&f._rotate(-s);const g=[];for(let y=0;y<n.length;y++)g.push(n[y].sub(f));return g}function Vm(n,e,r,s){const u=Le.convert(n)._mult(s);return"viewport"===e&&u._rotate(-r),u}$(Oh,"CircleBucket",{omit:["layers"]});const __=new $e({"circle-sort-key":new ve(zt.layout_circle["circle-sort-key"])});var Um={paint:new $e({"circle-radius":new ve(zt.paint_circle["circle-radius"]),"circle-color":new ve(zt.paint_circle["circle-color"]),"circle-blur":new ve(zt.paint_circle["circle-blur"]),"circle-opacity":new ve(zt.paint_circle["circle-opacity"]),"circle-translate":new ie(zt.paint_circle["circle-translate"]),"circle-translate-anchor":new ie(zt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ie(zt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ie(zt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ve(zt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ve(zt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ve(zt.paint_circle["circle-stroke-opacity"])}),layout:__};function cp(n,e,r,s,u,f,g,y,w){if(f&&n.queryGeometry.isAboveHorizon)return!1;f&&(w*=n.pixelToTileUnitsFactor);const E=n.tileID.canonical,O=r.projection.upVectorScale(E,r.center.lat,r.worldSize).metersToTile;for(const z of e)for(const U of z){const q=U.add(y),J=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(q.x,q.y,!0):0,se=r.projection.projectTilePoint(q.x,q.y,E);if(J>0){const Ae=r.projection.upVector(E,q.x,q.y);se.x+=Ae[0]*O*J,se.y+=Ae[1]*O*J,se.z+=Ae[2]*O*J}const me=f?q:Nh(se.x,se.y,se.z,s),Pe=f?n.tilespaceRays.map(Ae=>y_(Ae,J)):n.queryGeometry.screenGeometry,Xe=jl([],[se.x,se.y,se.z,1],s);if(!g&&f?w*=Xe[3]/r.cameraToCenterDistance:g&&!f&&(w*=r.cameraToCenterDistance/Xe[3]),f){const Ae=_a((U.y/zr+E.y)/(1<<E.z));w/=r.projection.pixelsPerMeter(Ae,1)/Il(1,Ae)}if(Nm(Pe,me,w))return!0}return!1}function Nh(n,e,r,s){const u=jl([],[n,e,r,1],s);return new Le(u[0]/u[3],u[1]/u[3])}const zh=lc(0,0,0),Yu=lc(0,0,1);function y_(n,e){const r=jf();return zh[2]=e,n.intersectsPlane(zh,Yu,r),new Le(r[0],r[1])}class jm extends Oh{}function v_(n,{width:e,height:r},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*r*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*r*s);return n.width=e,n.height=r,n.data=u,n}function Hm(n,e,r){const{width:s,height:u}=e;s===n.width&&u===n.height||(kd(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,s),height:Math.min(n.height,u)},r),n.width=s,n.height=u,n.data=e.data)}function kd(n,e,r,s,u,f){if(0===u.width||0===u.height)return e;if(u.width>n.width||u.height>n.height||r.x>n.width-u.width||r.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,y=e.data;for(let w=0;w<u.height;w++){const E=((r.y+w)*n.width+r.x)*f,O=((s.y+w)*e.width+s.x)*f;for(let z=0;z<u.width*f;z++)y[O+z]=g[E+z]}return e}$(jm,"HeatmapBucket",{omit:["layers"]});class dc{constructor(e,r){v_(this,e,1,r)}resize(e){Hm(this,new dc(e),1)}clone(){return new dc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,f){kd(e,r,s,u,f,1)}}class ca{constructor(e,r){v_(this,e,4,r)}resize(e){Hm(this,new ca(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ca({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,f){kd(e,r,s,u,f,4)}}$(dc,"AlphaImage"),$(ca,"RGBAImage");var $h={paint:new $e({"heatmap-radius":new ve(zt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ve(zt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ie(zt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ne(zt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ie(zt.paint_heatmap["heatmap-opacity"])})};function Ld(n){const e={},r=n.resolution||256,s=n.clips?n.clips.length:1,u=n.image||new ca({width:r,height:s}),f=(g,y,w)=>{e[n.evaluationKey]=w;const E=n.expression.evaluate(e);u.data[g+y+0]=Math.floor(255*E.r/E.a),u.data[g+y+1]=Math.floor(255*E.g/E.a),u.data[g+y+2]=Math.floor(255*E.b/E.a),u.data[g+y+3]=Math.floor(255*E.a)};if(n.clips)for(let g=0,y=0;g<s;++g,y+=4*r)for(let w=0,E=0;w<r;w++,E+=4){const O=w/(r-1),{start:z,end:U}=n.clips[g];f(y,E,z*(1-O)+U*O)}else for(let g=0,y=0;g<r;g++,y+=4)f(0,y,g/(r-1));return u}var Gm={paint:new $e({"hillshade-illumination-direction":new ie(zt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ie(zt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ie(zt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ie(zt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ie(zt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ie(zt.paint_hillshade["hillshade-accent-color"])})};const Wm=Ft([{name:"a_pos",components:2,type:"Int16"}],4),{members:qm}=Wm;var Vh={exports:{}};function Uh(n,e,r){r=r||2;var s,u,f,g,y,w,E,O=e&&e.length,z=O?e[0]*r:n.length,U=Ym(n,0,z,r,!0),q=[];if(!U||U.next===U.prev)return q;if(O&&(U=function(se,me,Pe,Xe){var Ae,We,it,Qe=[];for(Ae=0,We=me.length;Ae<We;Ae++)(it=Ym(se,me[Ae]*Xe,Ae<We-1?me[Ae+1]*Xe:se.length,Xe,!1))===it.next&&(it.steiner=!0),Qe.push(bv(it));for(Qe.sort(yv),Ae=0;Ae<Qe.length;Ae++)Pe=vv(Qe[Ae],Pe);return Pe}(n,e,U,r)),n.length>80*r){s=f=n[0],u=g=n[1];for(var J=r;J<z;J+=r)(y=n[J])<s&&(s=y),(w=n[J+1])<u&&(u=w),y>f&&(f=y),w>g&&(g=w);E=0!==(E=Math.max(f-s,g-u))?32767/E:0}return Fd(U,q,r,s,u,E,0),q}function Ym(n,e,r,s,u){var f,g;if(u===Jm(n,e,r,s)>0)for(f=e;f<r;f+=s)g=dp(f,n[f],n[f+1],g);else for(f=r-s;f>=e;f-=s)g=dp(f,n[f],n[f+1],g);return g&&jh(g,g.next)&&(Xu(g),g=g.next),g}function _u(n,e){if(!n)return n;e||(e=n);var r,s=n;do{if(r=!1,s.steiner||!jh(s,s.next)&&0!==Rs(s.prev,s,s.next))s=s.next;else{if(Xu(s),(s=e=s.prev)===s.next)break;r=!0}}while(r||s!==e);return e}function Fd(n,e,r,s,u,f,g){if(n){!g&&f&&function(O,z,U,q){var J=O;do{0===J.z&&(J.z=Zm(J.x,J.y,z,U,q)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next}while(J!==O);J.prevZ.nextZ=null,J.prevZ=null,function(se){var me,Pe,Xe,Ae,We,it,Qe,rn,Ht=1;do{for(Pe=se,se=null,We=null,it=0;Pe;){for(it++,Xe=Pe,Qe=0,me=0;me<Ht&&(Qe++,Xe=Xe.nextZ);me++);for(rn=Ht;Qe>0||rn>0&&Xe;)0!==Qe&&(0===rn||!Xe||Pe.z<=Xe.z)?(Ae=Pe,Pe=Pe.nextZ,Qe--):(Ae=Xe,Xe=Xe.nextZ,rn--),We?We.nextZ=Ae:se=Ae,Ae.prevZ=We,We=Ae;Pe=Xe}We.nextZ=null,Ht*=2}while(it>1)}(J)}(n,s,u,f);for(var y,w,E=n;n.prev!==n.next;)if(y=n.prev,w=n.next,f?Oc(n,s,u,f):x_(n))e.push(y.i/r|0),e.push(n.i/r|0),e.push(w.i/r|0),Xu(n),n=w.next,E=w.next;else if((n=w)===E){g?1===g?Fd(n=Bd(_u(n),e,r),e,r,s,u,f,2):2===g&&b_(n,e,r,s,u,f):Fd(_u(n),e,r,s,u,f,1);break}}}function x_(n){var e=n.prev,r=n,s=n.next;if(Rs(e,r,s)>=0)return!1;for(var u=e.x,f=r.x,g=s.x,y=e.y,w=r.y,E=s.y,O=u<f?u<g?u:g:f<g?f:g,z=y<w?y<E?y:E:w<E?w:E,U=u>f?u>g?u:g:f>g?f:g,q=y>w?y>E?y:E:w>E?w:E,J=s.next;J!==e;){if(J.x>=O&&J.x<=U&&J.y>=z&&J.y<=q&&yu(u,y,f,w,g,E,J.x,J.y)&&Rs(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Oc(n,e,r,s){var u=n.prev,f=n,g=n.next;if(Rs(u,f,g)>=0)return!1;for(var y=u.x,w=f.x,E=g.x,O=u.y,z=f.y,U=g.y,q=y<w?y<E?y:E:w<E?w:E,J=O<z?O<U?O:U:z<U?z:U,se=y>w?y>E?y:E:w>E?w:E,me=O>z?O>U?O:U:z>U?z:U,Pe=Zm(q,J,e,r,s),Xe=Zm(se,me,e,r,s),Ae=n.prevZ,We=n.nextZ;Ae&&Ae.z>=Pe&&We&&We.z<=Xe;){if(Ae.x>=q&&Ae.x<=se&&Ae.y>=J&&Ae.y<=me&&Ae!==u&&Ae!==g&&yu(y,O,w,z,E,U,Ae.x,Ae.y)&&Rs(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,We.x>=q&&We.x<=se&&We.y>=J&&We.y<=me&&We!==u&&We!==g&&yu(y,O,w,z,E,U,We.x,We.y)&&Rs(We.prev,We,We.next)>=0))return!1;We=We.nextZ}for(;Ae&&Ae.z>=Pe;){if(Ae.x>=q&&Ae.x<=se&&Ae.y>=J&&Ae.y<=me&&Ae!==u&&Ae!==g&&yu(y,O,w,z,E,U,Ae.x,Ae.y)&&Rs(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;We&&We.z<=Xe;){if(We.x>=q&&We.x<=se&&We.y>=J&&We.y<=me&&We!==u&&We!==g&&yu(y,O,w,z,E,U,We.x,We.y)&&Rs(We.prev,We,We.next)>=0)return!1;We=We.nextZ}return!0}function Bd(n,e,r){var s=n;do{var u=s.prev,f=s.next.next;!jh(u,f)&&Xm(u,s,s.next,f)&&hc(u,f)&&hc(f,u)&&(e.push(u.i/r|0),e.push(s.i/r|0),e.push(f.i/r|0),Xu(s),Xu(s.next),s=n=f),s=s.next}while(s!==n);return _u(s)}function b_(n,e,r,s,u,f){var g=n;do{for(var y=g.next.next;y!==g.prev;){if(g.i!==y.i&&w_(g,y)){var w=up(g,y);return g=_u(g,g.next),w=_u(w,w.next),Fd(g,e,r,s,u,f,0),void Fd(w,e,r,s,u,f,0)}y=y.next}g=g.next}while(g!==n)}function yv(n,e){return n.x-e.x}function vv(n,e){var r=function(u,f){var g,y=f,w=u.x,E=u.y,O=-1/0;do{if(E<=y.y&&E>=y.next.y&&y.next.y!==y.y){var z=y.x+(E-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(z<=w&&z>O&&(O=z,g=y.x<y.next.x?y:y.next,z===w))return g}y=y.next}while(y!==f);if(!g)return null;var U,q=g,J=g.x,se=g.y,me=1/0;y=g;do{w>=y.x&&y.x>=J&&w!==y.x&&yu(E<se?w:O,E,J,se,E<se?O:w,E,y.x,y.y)&&(U=Math.abs(E-y.y)/(w-y.x),hc(y,u)&&(U<me||U===me&&(y.x>g.x||y.x===g.x&&xv(g,y)))&&(g=y,me=U)),y=y.next}while(y!==q);return g}(n,e);if(!r)return e;var s=up(r,n);return _u(s,s.next),_u(r,r.next)}function xv(n,e){return Rs(n.prev,n,e.prev)<0&&Rs(e.next,n,n.next)<0}function Zm(n,e,r,s,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function bv(n){var e=n,r=n;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==n);return r}function yu(n,e,r,s,u,f,g,y){return(u-g)*(e-y)>=(n-g)*(f-y)&&(n-g)*(s-y)>=(r-g)*(e-y)&&(r-g)*(f-y)>=(u-g)*(s-y)}function w_(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(r,s){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==s.i&&u.next.i!==s.i&&Xm(u,u.next,r,s))return!0;u=u.next}while(u!==r);return!1}(n,e)&&(hc(n,e)&&hc(e,n)&&function(r,s){var u=r,f=!1,g=(r.x+s.x)/2,y=(r.y+s.y)/2;do{u.y>y!=u.next.y>y&&u.next.y!==u.y&&g<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next}while(u!==r);return f}(n,e)&&(Rs(n.prev,n,e.prev)||Rs(n,e.prev,e))||jh(n,e)&&Rs(n.prev,n,n.next)>0&&Rs(e.prev,e,e.next)>0)}function Rs(n,e,r){return(e.y-n.y)*(r.x-e.x)-(e.x-n.x)*(r.y-e.y)}function jh(n,e){return n.x===e.x&&n.y===e.y}function Xm(n,e,r,s){var u=pl(Rs(n,e,r)),f=pl(Rs(n,e,s)),g=pl(Rs(r,s,n)),y=pl(Rs(r,s,e));return u!==f&&g!==y||!(0!==u||!Zu(n,r,e))||!(0!==f||!Zu(n,s,e))||!(0!==g||!Zu(r,n,s))||!(0!==y||!Zu(r,e,s))}function Zu(n,e,r){return e.x<=Math.max(n.x,r.x)&&e.x>=Math.min(n.x,r.x)&&e.y<=Math.max(n.y,r.y)&&e.y>=Math.min(n.y,r.y)}function pl(n){return n>0?1:n<0?-1:0}function hc(n,e){return Rs(n.prev,n,n.next)<0?Rs(n,e,n.next)>=0&&Rs(n,n.prev,e)>=0:Rs(n,e,n.prev)<0||Rs(n,n.next,e)<0}function up(n,e){var r=new Km(n.i,n.x,n.y),s=new Km(e.i,e.x,e.y),u=n.next,f=e.prev;return n.next=e,e.prev=n,r.next=u,u.prev=r,s.next=r,r.prev=s,f.next=s,s.prev=f,s}function dp(n,e,r,s){var u=new Km(n,e,r);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function Xu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Km(n,e,r){this.i=n,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jm(n,e,r,s){for(var u=0,f=e,g=r-s;f<r;f+=s)u+=(n[g]-n[f])*(n[f+1]+n[g+1]),g=f;return u}Vh.exports=Uh,Vh.exports.default=Uh,Uh.deviation=function(n,e,r,s){var u=e&&e.length,f=Math.abs(Jm(n,0,u?e[0]*r:n.length,r));if(u)for(var g=0,y=e.length;g<y;g++)f-=Math.abs(Jm(n,e[g]*r,g<y-1?e[g+1]*r:n.length,r));var w=0;for(g=0;g<s.length;g+=3){var E=s[g]*r,O=s[g+1]*r,z=s[g+2]*r;w+=Math.abs((n[E]-n[z])*(n[O+1]-n[E+1])-(n[E]-n[O])*(n[z+1]-n[E+1]))}return 0===f&&0===w?0:Math.abs((w-f)/f)},Uh.flatten=function(n){for(var e=n[0][0].length,r={vertices:[],holes:[],dimensions:e},s=0,u=0;u<n.length;u++){for(var f=0;f<n[u].length;f++)for(var g=0;g<e;g++)r.vertices.push(n[u][f][g]);u>0&&r.holes.push(s+=n[u-1].length)}return r};var Qm=Kt(Vh.exports);function hp(n,e,r,s,u){Hh(n,e,r||0,s||n.length-1,u||wv)}function Hh(n,e,r,s,u){for(;s>r;){if(s-r>600){var f=s-r+1,g=e-r+1,y=Math.log(f),w=.5*Math.exp(2*y/3),E=.5*Math.sqrt(y*w*(f-w)/f)*(g-f/2<0?-1:1);Hh(n,e,Math.max(r,Math.floor(e-g*w/f+E)),Math.min(s,Math.floor(e+(f-g)*w/f+E)),u)}var O=n[e],z=r,U=s;for(Gh(n,r,e),u(n[s],O)>0&&Gh(n,r,s);z<U;){for(Gh(n,z,U),z++,U--;u(n[z],O)<0;)z++;for(;u(n[U],O)>0;)U--}0===u(n[r],O)?Gh(n,r,U):Gh(n,++U,s),U<=e&&(r=U+1),e<=U&&(s=U-1)}}function Gh(n,e,r){var s=n[e];n[e]=n[r],n[r]=s}function wv(n,e){return n<e?-1:n>e?1:0}function Wh(n,e){const r=n.length;if(r<=1)return[n];const s=[];let u,f;for(let g=0;g<r;g++){const y=Cr(n[g]);0!==y&&(n[g].area=Math.abs(y),void 0===f&&(f=y<0),f===y<0?(u&&s.push(u),u=[n[g]]):u.push(n[g]))}if(u&&s.push(u),e>1)for(let g=0;g<s.length;g++)s[g].length<=e||(hp(s[g],e,1,s[g].length-1,E_),s[g]=s[g].slice(0,e));return s}function E_(n,e){return e.area-n.area}function fp(n,e,r){const s=r.patternDependencies;let u=!1;for(const f of e){const g=f.paint.get(`${n}-pattern`);g.isConstant()||(u=!0);const y=g.constantOr(null);y&&(u=!0,s[y]=!0)}return u}function pp(n,e,r,s,u){const f=u.patternDependencies;for(const g of e){const y=g.paint.get(`${n}-pattern`).value;if("constant"!==y.kind){let w=y.evaluate({zoom:s},r,{},u.availableImages);w=w&&w.name?w.name:w,f[w]=!0,r.patterns[g.id]=w}}return r}class qh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Un,this.indexArray=new wr,this.indexArray2=new bo,this.programConfigurations=new Sc(e.layers,e.zoom),this.segments=new as,this.segments2=new as,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,s,u){this.hasPattern=fp("fill",this.layers,r);const f=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:y,id:w,index:E,sourceLayerIndex:O}of e){const z=this.layers[0]._featureFilter.needGeometry,U=Gu(y,z);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),U,s))continue;const q=f?f.evaluate(U,{},s,r.availableImages):void 0,J={id:w,properties:y.properties,type:y.type,sourceLayerIndex:O,index:E,geometry:z?U.geometry:uc(y,s,u),patterns:{},sortKey:q};g.push(J)}f&&g.sort((y,w)=>y.sortKey-w.sortKey);for(const y of g){const{geometry:w,index:E,sourceLayerIndex:O}=y;if(this.hasPattern){const z=pp("fill",this.layers,y,this.zoom,r);this.patternFeatures.push(z)}else this.addFeature(y,w,E,s,{},r.availableImages);r.featureIndex.insert(e[E].feature,w,E,O,this.index)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}addFeatures(e,r,s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,qm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,s,u,f,g=[]){for(const y of Wh(r,500)){let w=0;for(const J of y)w+=J.length;const E=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),O=E.vertexLength,z=[],U=[];for(const J of y){if(0===J.length)continue;J!==y[0]&&U.push(z.length/2);const se=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),me=se.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(me+J.length-1,me),z.push(J[0].x),z.push(J[0].y);for(let Pe=1;Pe<J.length;Pe++)this.layoutVertexArray.emplaceBack(J[Pe].x,J[Pe].y),this.indexArray2.emplaceBack(me+Pe-1,me+Pe),z.push(J[Pe].x),z.push(J[Pe].y);se.vertexLength+=J.length,se.primitiveLength+=J.length}const q=Qm(z,U);for(let J=0;J<q.length;J+=3)this.indexArray.emplaceBack(O+q[J],O+q[J+1],O+q[J+2]);E.vertexLength+=w,E.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}}$(qh,"FillBucket",{omit:["layers","patternFeatures"]});const eg=new $e({"fill-sort-key":new ve(zt.layout_fill["fill-sort-key"])});var Yh={paint:new $e({"fill-antialias":new ie(zt.paint_fill["fill-antialias"]),"fill-opacity":new ve(zt.paint_fill["fill-opacity"]),"fill-color":new ve(zt.paint_fill["fill-color"]),"fill-outline-color":new ve(zt.paint_fill["fill-outline-color"]),"fill-translate":new ie(zt.paint_fill["fill-translate"]),"fill-translate-anchor":new ie(zt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ve(zt.paint_fill["fill-pattern"])}),layout:eg};const D_=Ft([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),mp=Ft([{name:"a_centroid_pos",components:2,type:"Uint16"}]),C_=Ft([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ku}=D_;var Zh={},T_=Tt,gp=vu;function vu(n,e,r,s,u){this.properties={},this.extent=r,this.type=0,this._pbf=n,this._geometry=-1,this._keys=s,this._values=u,n.readFields(S_,this,e)}function S_(n,e,r){1==n?e.id=r.readVarint():2==n?function(s,u){for(var f=s.readVarint()+s.pos;s.pos<f;){var g=u._keys[s.readVarint()],y=u._values[s.readVarint()];u.properties[g]=y}}(r,e):3==n?e.type=r.readVarint():4==n&&(e._geometry=r.pos)}function I_(n){for(var e,r,s=0,u=0,f=n.length,g=f-1;u<f;g=u++)s+=((r=n[g]).x-(e=n[u]).x)*(e.y+r.y);return s}vu.types=["Unknown","Point","LineString","Polygon"],vu.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,r=n.readVarint()+n.pos,s=1,u=0,f=0,g=0,y=[];n.pos<r;){if(u<=0){var w=n.readVarint();s=7&w,u=w>>3}if(u--,1===s||2===s)f+=n.readSVarint(),g+=n.readSVarint(),1===s&&(e&&y.push(e),e=[]),e.push(new T_(f,g));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&y.push(e),y},vu.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,r=1,s=0,u=0,f=0,g=1/0,y=-1/0,w=1/0,E=-1/0;n.pos<e;){if(s<=0){var O=n.readVarint();r=7&O,s=O>>3}if(s--,1===r||2===r)(u+=n.readSVarint())<g&&(g=u),u>y&&(y=u),(f+=n.readSVarint())<w&&(w=f),f>E&&(E=f);else if(7!==r)throw new Error("unknown command "+r)}return[g,w,y,E]},vu.prototype.toGeoJSON=function(n,e,r){var s,u,f=this.extent*Math.pow(2,r),g=this.extent*n,y=this.extent*e,w=this.loadGeometry(),E=vu.types[this.type];function O(q){for(var J=0;J<q.length;J++){var se=q[J];q[J]=[360*(se.x+g)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+y)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(s=0;s<w.length;s++)z[s]=w[s][0];O(w=z);break;case 2:for(s=0;s<w.length;s++)O(w[s]);break;case 3:for(w=function(q){var J=q.length;if(J<=1)return[q];for(var se,me,Pe=[],Xe=0;Xe<J;Xe++){var Ae=I_(q[Xe]);0!==Ae&&(void 0===me&&(me=Ae<0),me===Ae<0?(se&&Pe.push(se),se=[q[Xe]]):se.push(q[Xe]))}return se&&Pe.push(se),Pe}(w),s=0;s<w.length;s++)for(u=0;u<w[s].length;u++)O(w[s][u])}1===w.length?w=w[0]:E="Multi"+E;var U={type:"Feature",geometry:{type:E,coordinates:w},properties:this.properties};return"id"in this&&(U.id=this.id),U};var M_=gp,tg=_p;function _p(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(Ev,this,e),this.length=this._features.length}function Ev(n,e,r){15===n?e.version=r.readVarint():1===n?e.name=r.readString():5===n?e.extent=r.readVarint():2===n?e._features.push(r.pos):3===n?e._keys.push(r.readString()):4===n&&e._values.push(function(s){for(var u=null,f=s.readVarint()+s.pos;s.pos<f;){var g=s.readVarint()>>3;u=1===g?s.readString():2===g?s.readFloat():3===g?s.readDouble():4===g?s.readVarint64():5===g?s.readVarint():6===g?s.readSVarint():7===g?s.readBoolean():null}return u}(r))}_p.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new M_(this._pbf,e,this.extent,this._keys,this._values)};var Dv=tg;function Nd(n,e,r){if(3===n){var s=new Dv(r,r.readVarint()+r.pos);s.length&&(e[s.name]=s)}}var To=Zh.VectorTile=function(n,e){this.layers=n.readFields(Nd,{},e)},kc=Zh.VectorTileFeature=gp;function zd(n,e,r,s){const u=[],f=0===s?(g,y,w,E,O,z)=>{g.push(new Le(z,w+(z-y)/(E-y)*(O-w)))}:(g,y,w,E,O,z)=>{g.push(new Le(y+(z-w)/(O-w)*(E-y),z))};for(const g of n){const y=[];for(const w of g){if(w.length<=2)continue;const E=[];for(let U=0;U<w.length-1;U++){const q=w[U].x,J=w[U].y,se=w[U+1].x,me=w[U+1].y,Pe=0===s?q:J,Xe=0===s?se:me;Pe<e?Xe>e&&f(E,q,J,se,me,e):Pe>r?Xe<r&&f(E,q,J,se,me,r):E.push(w[U]),Xe<e&&Pe>=e&&f(E,q,J,se,me,e),Xe>r&&Pe<=r&&f(E,q,J,se,me,r)}let O=w[w.length-1];const z=0===s?O.x:O.y;z>=e&&z<=r&&E.push(O),E.length&&(O=E[E.length-1],E[0].x===O.x&&E[0].y===O.y||E.push(E[0]),y.push(E))}y.length&&u.push(y)}return u}Zh.VectorTileLayer=tg;const ng=kc.types,yp=Math.pow(2,13);function xu(n,e,r,s,u,f,g,y){n.emplaceBack((e<<1)+g,(r<<1)+f,(Math.floor(s*yp)<<1)+u,Math.round(y))}function $d(n,e,r){n.emplaceBack(e.x,e.y,e.z,16384*r[0],16384*r[1],16384*r[2])}class vp{constructor(){this.acc=new Le(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Le(e.x,e.y),this.max=new Le(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,u=this.max;e.x<s.x?s.x=e.x:e.x>u.x&&(u.x=e.x),e.y<s.y?s.y=e.y:e.y>u.y&&(u.y=e.y),((0===e.x||e.x===zr)&&e.x===r.x)!=((0===e.y||e.y===zr)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,K(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>zr!=e.x>zr&&this.addBorderIntersection(1,K(r.y,e.y,(zr-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,K(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>zr!=e.y>zr&&this.addBorderIntersection(3,K(r.x,e.x,(zr-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];r<s[0]&&(s[0]=r),r>s[1]&&(s[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,r.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,r.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((r,s)=>r+s.edges,0);return 0!==e?this.acc.div(e)._round():new Le(0,0)}span(){return new Le(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class Ju{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new wn,this.centroidVertexArray=new Nl,this.indexArray=new wr,this.programConfigurations=new Sc(e.layers,e.zoom),this.segments=new as,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,s,u){this.features=[],this.hasPattern=fp("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const g=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*g/(g*g+1)/zr/(1<<f.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:g,index:y,sourceLayerIndex:w}of e){const E=this.layers[0]._featureFilter.needGeometry,O=Gu(f,E);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),O,s))continue;const z={id:g,sourceLayerIndex:w,index:y,geometry:E?O.geometry:uc(f,s,u),properties:f.properties,type:f.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(pp("fill-extrusion",this.layers,z,this.zoom,r)):this.addFeature(z,z.geometry,y,s,{},r.availableImages,u),r.featureIndex.insert(f,z.geometry,y,w,this.index,U)}this.sortBorders()}addFeatures(e,r,s,u,f){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,r,s,u,f)}this.sortBorders()}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ku),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,C_.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,mp.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,s,u,f,g,y){const w=[new Le(0,0),new Le(zr,zr)],E=y.projection,O="globe"===E.name,z=this.enableTerrain&&!O?new vp:null,U="Polygon"===ng[e.type];O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new $n);const q=Wh(r,500);for(let Pe=q.length-1;Pe>=0;Pe--){const Xe=q[Pe];(0===Xe.length||(J=Xe[0]).every(Ae=>Ae.x<=0)||J.every(Ae=>Ae.x>=zr)||J.every(Ae=>Ae.y<=0)||J.every(Ae=>Ae.y>=zr))&&q.splice(Pe,1)}var J;let se;if(O)se=Lc(q,w,u);else{se=[];for(const Pe of q)se.push({polygon:Pe,bounds:w})}const me=U?this.edgeRadius:0;for(const{polygon:Pe,bounds:Xe}of se){let Ae=0,We=0;for(const Qe of Pe)U&&!Qe[0].equals(Qe[Qe.length-1])&&Qe.push(Qe[0]),We+=U?Qe.length-1:Qe.length;const it=this.segments.prepareSegment((U?5:4)*We,this.layoutVertexArray,this.indexArray);if(U){const Qe=[],rn=[];Ae=it.vertexLength;for(const xn of Pe){let Nn,on;xn.length&&xn!==Pe[0]&&rn.push(Qe.length/2),Nn=xn[1].sub(xn[0])._perp()._unit();for(let Sn=1;Sn<xn.length;Sn++){const In=xn[Sn],Fn=xn[Sn===xn.length-1?1:Sn+1];let{x:jn,y:gn}=In;if(me){on=Fn.sub(In)._perp()._unit();const ir=Nn.add(on)._unit(),vr=me*Math.min(4,1/(Nn.x*ir.x+Nn.y*ir.y));jn+=vr*ir.x,gn+=vr*ir.y,Nn=on}xu(this.layoutVertexArray,jn,gn,0,0,1,1,0),it.vertexLength++,Qe.push(In.x,In.y),O&&$d(this.layoutVertexExtArray,E.projectTilePoint(jn,gn,u),E.upVector(u,jn,gn))}}const Ht=Qm(Qe,rn);for(let xn=0;xn<Ht.length;xn+=3)this.indexArray.emplaceBack(Ae+Ht[xn],Ae+Ht[xn+2],Ae+Ht[xn+1]),it.primitiveLength++}for(const Qe of Pe){z&&Qe.length&&z.startRing(Qe[0]);let rn,Ht,xn,Nn=Qe.length>4&&Kh(Qe[Qe.length-2],Qe[0],Qe[1]),on=me?Cv(Qe[Qe.length-2],Qe[0],Qe[1],me):0;Ht=Qe[1].sub(Qe[0])._perp()._unit();let Sn=!0;for(let In=1,Fn=0;In<Qe.length;In++){let jn=Qe[In-1],gn=Qe[In];const ir=Qe[In===Qe.length-1?1:In+1];if(z&&U&&z.currentPolyCount.top++,rg(gn,jn,Xe)){me&&(Ht=ir.sub(gn)._perp()._unit(),Sn=!Sn);continue}z&&z.append(gn,jn);const vr=gn.sub(jn)._perp(),sr=vr.x/(Math.abs(vr.x)+Math.abs(vr.y)),gi=vr.y>0?1:0,Xn=jn.dist(gn);if(Fn+Xn>32768&&(Fn=0),me){xn=ir.sub(gn)._perp()._unit();let yi=Xh(jn,gn,ir,Vd(Ht,xn),me);isNaN(yi)&&(yi=0);const jr=gn.sub(jn)._unit();jn=jn.add(jr.mult(on))._round(),gn=gn.add(jr.mult(-yi))._round(),on=yi,Ht=xn}const Fr=it.vertexLength,_i=Qe.length>4&&Kh(jn,gn,ir);let Ji=xp(Fn,Nn,Sn);if(xu(this.layoutVertexArray,jn.x,jn.y,sr,gi,0,0,Ji),xu(this.layoutVertexArray,jn.x,jn.y,sr,gi,0,1,Ji),Fn+=Xn,Ji=xp(Fn,_i,!Sn),Nn=_i,xu(this.layoutVertexArray,gn.x,gn.y,sr,gi,0,0,Ji),xu(this.layoutVertexArray,gn.x,gn.y,sr,gi,0,1,Ji),it.vertexLength+=4,this.indexArray.emplaceBack(Fr+0,Fr+1,Fr+2),this.indexArray.emplaceBack(Fr+1,Fr+3,Fr+2),it.primitiveLength+=2,me){const yi=Ae+(1===In?Qe.length-2:In-2),jr=1===In?Ae:yi+1;if(this.indexArray.emplaceBack(Fr+1,yi,Fr+3),this.indexArray.emplaceBack(yi,jr,Fr+3),it.primitiveLength+=2,void 0===rn&&(rn=Fr),!rg(ir,Qe[In],Xe)){const Uo=In===Qe.length-1?rn:it.vertexLength;this.indexArray.emplaceBack(Fr+2,Fr+3,Uo),this.indexArray.emplaceBack(Fr+3,Uo+1,Uo),this.indexArray.emplaceBack(Fr+3,jr,Uo+1),it.primitiveLength+=3}Sn=!Sn}if(O){const yi=this.layoutVertexExtArray,jr=E.projectTilePoint(jn.x,jn.y,u),Uo=E.projectTilePoint(gn.x,gn.y,u),Ci=E.upVector(u,jn.x,jn.y),Ti=E.upVector(u,gn.x,gn.y);$d(yi,jr,Ci),$d(yi,jr,Ci),$d(yi,Uo,Ti),$d(yi,Uo,Ti)}}U&&(Ae+=Qe.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const Pe=z.borders,Xe=this.featuresOnBorder.push(z)-1;for(let Ae=0;Ae<4;Ae++)Pe[Ae][0]!==Number.MAX_VALUE&&this.borders[Ae].push(Xe)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,s)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,r,s=!0){let u,f;if(e)if(0!==e.y){const y=r.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+s;let g=s?this.centroidVertexArray.length:r.vertexArrayOffset;for(const y of r.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let w=0;w<y.top;w++)this.centroidVertexArray.emplace(g++,u,f);for(let w=0;w<2*y.edges;w++)this.centroidVertexArray.emplace(g++,0,f),this.centroidVertexArray.emplace(g++,u,f)}}}function Vd(n,e){const r=n.add(e)._unit();return n.x*r.x+n.y*r.y}function Cv(n,e,r,s){const u=e.sub(n)._perp()._unit(),f=r.sub(e)._perp()._unit();return Xh(n,e,r,Vd(u,f),s)}function Xh(n,e,r,s,u){const f=Math.sqrt(1-s*s);return Math.min(n.dist(e)/3,e.dist(r)/3,u*f/s)}function rg(n,e,r){return n.x<r[0].x&&e.x<r[0].x||n.x>r[1].x&&e.x>r[1].x||n.y<r[0].y&&e.y<r[0].y||n.y>r[1].y&&e.y>r[1].y}function Kh(n,e,r){if(n.x<0||n.x>=zr||e.x<0||e.x>=zr||r.x<0||r.x>=zr)return!1;const s=r.sub(e),u=s.perp(),f=n.sub(e);return(s.x*f.x+s.y*f.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function xp(n,e,r){const s=e?2|n:-3&n;return r?1|s:-2&s}function bp(){const n=Math.PI/32,e=Math.tan(n),r=Ac;return r*Math.sqrt(1+2*e*e)-r}function Lc(n,e,r){const s=1<<r.z,u=nl(r.x/s),f=nl((r.x+1)/s),g=_a(r.y/s),y=_a((r.y+1)/s);return function(w,E,O,z,U=0,q){const J=[];if(!w.length||!O||!z)return J;const se=(Qe,rn)=>{for(const Ht of Qe)J.push({polygon:Ht,bounds:rn})},me=Math.ceil(Math.log2(O)),Pe=Math.ceil(Math.log2(z)),Xe=me-Pe,Ae=[];for(let Qe=0;Qe<Math.abs(Xe);Qe++)Ae.push(Xe>0?0:1);for(let Qe=0;Qe<Math.min(me,Pe);Qe++)Ae.push(0),Ae.push(1);let We=w;if(We=zd(We,E[0].y-U,E[1].y+U,1),We=zd(We,E[0].x-U,E[1].x+U,0),!We.length)return J;const it=[];for(Ae.length?it.push({polygons:We,bounds:E,depth:0}):se(We,E);it.length;){const Qe=it.pop(),rn=Qe.depth,Ht=Ae[rn],xn=Qe.bounds[0],Nn=Qe.bounds[1],on=0===Ht?xn.x:xn.y,Sn=0===Ht?Nn.x:Nn.y,In=q?q(Ht,on,Sn):.5*(on+Sn),Fn=zd(Qe.polygons,on-U,In+U,Ht),jn=zd(Qe.polygons,In-U,Sn+U,Ht);if(Fn.length){const gn=[xn,new Le(0===Ht?In:Nn.x,1===Ht?In:Nn.y)];Ae.length>rn+1?it.push({polygons:Fn,bounds:gn,depth:rn+1}):se(Fn,gn)}if(jn.length){const gn=[new Le(0===Ht?In:xn.x,1===Ht?In:xn.y),Nn];Ae.length>rn+1?it.push({polygons:jn,bounds:gn,depth:rn+1}):se(jn,gn)}}return J}(n,e,Math.ceil((f-u)/11.25),Math.ceil((g-y)/11.25),1,(w,E,O)=>{if(0===w)return.5*(E+O);{const z=_a((r.y+E/zr)/s);return(ql(.5*(_a((r.y+O/zr)/s)+z))*s-r.y)*zr}})}$(Ju,"FillExtrusionBucket",{omit:["layers","features"]}),$(vp,"PartMetadata");const A_=new $e({"fill-extrusion-edge-radius":new ie(zt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var wp={paint:new $e({"fill-extrusion-opacity":new ie(zt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ve(zt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ie(zt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ie(zt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ve(zt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ve(zt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ve(zt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ie(zt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ie(zt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ie(zt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ie(zt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:A_};function Ud(n,e,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[n*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class Jh{constructor(e,r,s){this.z=e,this.x=r,this.y=s,this.key=Wa(0,e,e,r,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const s=(g=this.y,y=this.z,w=Ud(256*(f=this.x),256*(g=Math.pow(2,y)-g-1),y),E=Ud(256*(f+1),256*(g+1),y),w[0]+","+w[1]+","+E[0]+","+E[1]),u=function(f,g,y){let w,E="";for(let O=f;O>0;O--)w=1<<O-1,E+=(g&w?1:0)+(y&w?2:0);return E}(this.z,this.x,this.y);var f,g,y,w,E;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Qh{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Wa(e,r.z,r.z,r.x,r.y)}}class ua{constructor(e,r,s,u,f){this.overscaledZ=e,this.wrap=r,this.canonical=new Jh(s,+u,+f),this.key=0===r&&e===s?this.canonical.key:Wa(r,e,s,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new ua(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ua(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return Wa(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return Wa(this.wrap*+r,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new ua(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new ua(r,this.wrap,r,s,u),new ua(r,this.wrap,r,s+1,u),new ua(r,this.wrap,r,s,u+1),new ua(r,this.wrap,r,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ua(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ua(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Qh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Wa(n,e,r,s,u){const f=1<<Math.min(r,22);let g=f*(u%f)+s%f;return n&&r<22&&(g+=f*f*((n<0?-2*n-1:2*n)%(1<<2*(22-r)))),16*(32*g+r)+(e-r)}$(Jh,"CanonicalTileID"),$(ua,"OverscaledTileID",{omit:["projMatrix"]});class fc extends Le{constructor(e,r,s){super(e,r),this.z=s}}function bu(n,e){return n.x*e.x+n.y*e.y}function ig(n,e){if(1===n.length){let r=0;const s=e[r++];let u;for(;!u||s.equals(u);)if(u=e[r++],!u)return 1/0;for(;r<e.length;r++){const f=e[r],g=n[0],y=u.sub(s),w=f.sub(s),E=g.sub(s),O=bu(y,y),z=bu(y,w),U=bu(w,w),q=bu(E,y),J=bu(E,w),se=O*U-z*z,me=(U*q-z*J)/se,Pe=(O*J-z*q)/se,Xe=s.z*(1-me-Pe)+u.z*me+f.z*Pe;if(isFinite(Xe))return Xe}return 1/0}{let r=1/0;for(const s of e)r=Math.min(r,s.z);return r}}function og(n,e,r,s,u,f,g,y){const w=g*u.getElevationAt(n,e,!0,!0),E=0!==f[0],O=E?0===f[1]?g*(f[0]/7-450):g*function(z,U,q){const J=Math.floor(U[0]/8),se=Math.floor(U[1]/8),me=10*(U[0]-8*J),Pe=10*(U[1]-8*se),Xe=z.getElevationAt(J,se,!0,!0),Ae=z.getMeterToDEM(q),We=Math.floor(.5*(me*Ae-1)),it=Math.floor(.5*(Pe*Ae-1)),Qe=z.tileCoordToPixel(J,se),rn=2*We+1,Ht=2*it+1,xn=(vr=rn,sr=Ht,[(jn=z).getElevationAtPixel(gn=Qe.x-We,ir=Qe.y-it,!0),jn.getElevationAtPixel(gn+sr,ir,!0),jn.getElevationAtPixel(gn,ir+sr,!0),jn.getElevationAtPixel(gn+vr,ir+sr,!0)]),Nn=Math.abs(xn[0]-xn[1]),on=Math.abs(xn[2]-xn[3]),Sn=Math.abs(xn[0]-xn[2])+Math.abs(xn[1]-xn[3]),In=Math.min(.25,.5*Ae*(Nn+on)/rn),Fn=Math.min(.25,.5*Ae*Sn/Ht);var jn,gn,ir,vr,sr;return Xe+Math.max(In*me,Fn*Pe)}(u,f,y):w;return{base:w+(0===r)?-1:r,top:E?Math.max(O+s,w+r+2):w+s}}const sg=Ft([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Qu}=sg,P_=Ft([{name:"a_packed",components:4,type:"Float32"}]),{members:R_}=P_,O_=kc.types,Ep=Math.cos(Math.PI/180*37.5);class jd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new ln,this.layoutVertexArray2=new Bn,this.indexArray=new wr,this.programConfigurations=new Sc(e.layers,e.zoom),this.segments=new as,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,s,u){this.hasPattern=fp("line",this.layers,r);const f=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:O,id:z,index:U,sourceLayerIndex:q}of e){const J=this.layers[0]._featureFilter.needGeometry,se=Gu(O,J);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),se,s))continue;const me=f?f.evaluate(se,{},s):void 0,Pe={id:z,properties:O.properties,type:O.type,sourceLayerIndex:q,index:U,geometry:J?se.geometry:uc(O,s,u),patterns:{},sortKey:me};g.push(Pe)}f&&g.sort((O,z)=>O.sortKey-z.sortKey);const{lineAtlas:y,featureIndex:w}=r,E=this.addConstantDashes(y);for(const O of g){const{geometry:z,index:U,sourceLayerIndex:q}=O;if(E&&this.addFeatureDashes(O,y),this.hasPattern){const J=pp("line",this.layers,O,this.zoom,r);this.patternFeatures.push(J)}else this.addFeature(O,z,U,s,y.positions,r.availableImages);w.insert(e[U].feature,z,U,q,this.index)}}addConstantDashes(e){let r=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,f=s.layout.get("line-cap").value;if("constant"!==u.kind||"constant"!==f.kind)r=!0;else{const g=f.value,y=u.value;if(!y)continue;e.addDash(y,g)}}return r}addFeatureDashes(e,r){const s=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if("constant"===f.kind&&"constant"===g.kind)continue;let y,w;if("constant"===f.kind){if(y=f.value,!y)continue}else y=f.evaluate({zoom:s},e);w="constant"===g.kind?g.value:g.evaluate({zoom:s},e),r.addDash(y,w),e.patterns[u.id]=r.getKey(y,w)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}addFeatures(e,r,s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,R_)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Qu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,s,u,f,g){const y=this.layers[0].layout,w=y.get("line-join").evaluate(e,{}),E=y.get("line-cap").evaluate(e,{}),O=y.get("line-miter-limit"),z=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const U of r)this.addLine(U,e,w,E,O,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}addLine(e,r,s,u,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Pe=0;Pe<e.length-1;Pe++)this.totalDistance+=e[Pe].dist(e[Pe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y="Polygon"===O_[r.type];let w=e.length;for(;w>=2&&e[w-1].equals(e[w-2]);)w--;let E=0;for(;E<w-1&&e[E].equals(e[E+1]);)E++;if(w<(y?3:2))return;"bevel"===s&&(f=1.05);const O=this.overscaling<=16?15*zr/(512*this.overscaling):0,z=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let U,q,J,se,me;this.e1=this.e2=-1,y&&(U=e[w-2],me=e[E].sub(U)._unit()._perp());for(let Pe=E;Pe<w;Pe++){if(J=Pe===w-1?y?e[E+1]:void 0:e[Pe+1],J&&e[Pe].equals(J))continue;me&&(se=me),U&&(q=U),U=e[Pe],me=J?J.sub(U)._unit()._perp():se,se=se||me;let Xe=se.add(me);0===Xe.x&&0===Xe.y||Xe._unit();const Ae=se.x*me.x+se.y*me.y,We=Xe.x*me.x+Xe.y*me.y,it=0!==We?1/We:1/0,Qe=2*Math.sqrt(2-2*We),rn=We<Ep&&q&&J,Ht=se.x*me.y-se.y*me.x>0;if(rn&&Pe>E){const on=U.dist(q);if(on>2*O){const Sn=U.sub(U.sub(q)._mult(O/on)._round());this.updateDistance(q,Sn),this.addCurrentVertex(Sn,se,0,0,z),q=Sn}}const xn=q&&J;let Nn=xn?s:y?"butt":u;if(xn&&"round"===Nn&&(it<g?Nn="miter":it<=2&&(Nn="fakeround")),"miter"===Nn&&it>f&&(Nn="bevel"),"bevel"===Nn&&(it>2&&(Nn="flipbevel"),it<f&&(Nn="miter")),q&&this.updateDistance(q,U),"miter"===Nn)Xe._mult(it),this.addCurrentVertex(U,Xe,0,0,z);else if("flipbevel"===Nn){if(it>100)Xe=me.mult(-1);else{const on=it*se.add(me).mag()/se.sub(me).mag();Xe._perp()._mult(on*(Ht?-1:1))}this.addCurrentVertex(U,Xe,0,0,z),this.addCurrentVertex(U,Xe.mult(-1),0,0,z)}else if("bevel"===Nn||"fakeround"===Nn){const on=-Math.sqrt(it*it-1),Sn=Ht?on:0,In=Ht?0:on;if(q&&this.addCurrentVertex(U,se,Sn,In,z),"fakeround"===Nn){const Fn=Math.round(180*Qe/Math.PI/20);for(let jn=1;jn<Fn;jn++){let gn=jn/Fn;if(.5!==gn){const vr=gn-.5;gn+=gn*vr*(gn-1)*((1.0904+Ae*(Ae*(3.55645-1.43519*Ae)-3.2452))*vr*vr+(.848013+Ae*(.215638*Ae-1.06021)))}const ir=me.sub(se)._mult(gn)._add(se)._unit()._mult(Ht?-1:1);this.addHalfVertex(U,ir.x,ir.y,!1,Ht,0,z)}}J&&this.addCurrentVertex(U,me,-Sn,-In,z)}else if("butt"===Nn)this.addCurrentVertex(U,Xe,0,0,z);else if("square"===Nn){const on=q?1:-1;q||this.addCurrentVertex(U,Xe,on,on,z),this.addCurrentVertex(U,Xe,0,0,z),q&&this.addCurrentVertex(U,Xe,on,on,z)}else"round"===Nn&&(q&&(this.addCurrentVertex(U,se,0,0,z),this.addCurrentVertex(U,se,1,1,z,!0)),J&&(this.addCurrentVertex(U,me,-1,-1,z,!0),this.addCurrentVertex(U,me,0,0,z)));if(rn&&Pe<w-1){const on=U.dist(J);if(on>2*O){const Sn=U.add(J.sub(U)._mult(O/on)._round());this.updateDistance(U,Sn),this.addCurrentVertex(Sn,me,0,0,z),U=Sn}}}}addCurrentVertex(e,r,s,u,f,g=!1){const y=r.y*u-r.x,w=-r.y-r.x*u;this.addHalfVertex(e,r.x+r.y*s,r.y-r.x*s,g,!1,s,f),this.addHalfVertex(e,y,w,g,!0,-u,f)}addHalfVertex({x:e,y:r},s,u,f,g,y,w){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(r<<1)+(g?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(0===y?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const E=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),w.primitiveLength++),g?this.e2=E:this.e1=E}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}$(jd,"LineBucket",{omit:["layers","patternFeatures"]});const k_=new $e({"line-cap":new ve(zt.layout_line["line-cap"]),"line-join":new ve(zt.layout_line["line-join"]),"line-miter-limit":new ie(zt.layout_line["line-miter-limit"]),"line-round-limit":new ie(zt.layout_line["line-round-limit"]),"line-sort-key":new ve(zt.layout_line["line-sort-key"])});var Dp={paint:new $e({"line-opacity":new ve(zt.paint_line["line-opacity"]),"line-color":new ve(zt.paint_line["line-color"]),"line-translate":new ie(zt.paint_line["line-translate"]),"line-translate-anchor":new ie(zt.paint_line["line-translate-anchor"]),"line-width":new ve(zt.paint_line["line-width"]),"line-gap-width":new ve(zt.paint_line["line-gap-width"]),"line-offset":new ve(zt.paint_line["line-offset"]),"line-blur":new ve(zt.paint_line["line-blur"]),"line-dasharray":new ve(zt.paint_line["line-dasharray"]),"line-pattern":new ve(zt.paint_line["line-pattern"]),"line-gradient":new Ne(zt.paint_line["line-gradient"]),"line-trim-offset":new ie(zt.paint_line["line-trim-offset"])}),layout:k_};const ef=new class extends ve{possiblyEvaluate(n,e){return e=new N(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,r,s){return e=Me({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,r,s)}}(Dp.paint.properties["line-width"].specification);function L_(n,e){return e>0?e+2*n:n}ef.useIntegerZoom=!0;const F_=Ft([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),B_=Ft([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),N_=Ft([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ft([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Tv=Ft([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Sv=Ft([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ft([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Hd=Ft([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),z_=Ft([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ft([{name:"triangle",components:3,type:"Uint16"}]),Ft([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ft([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ft([{type:"Float32",name:"offsetX"}]),Ft([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ks=24;const rl=128;function Fc(n,e){const{expression:r}=e;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new N(n+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:u}=r;let f=0;for(;f<s.length&&s[f]<=n;)f++;f=Math.max(0,f-1);let g=f;for(;g<s.length&&s[g]<n+1;)g++;g=Math.min(s.length-1,g);const y=s[f],w=s[g];return"composite"===r.kind?{kind:"composite",minZoom:y,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:w,minSize:r.evaluate(new N(y)),maxSize:r.evaluate(new N(w)),interpolationType:u}}}function ed(n,{uSize:e,uSizeT:r},{lowerSize:s,upperSize:u}){return"source"===n.kind?s/rl:"composite"===n.kind?K(s/rl,u/rl,r):e}function Bc(n,e){let r=0,s=0;if("constant"===n.kind)s=n.layoutSize;else if("source"!==n.kind){const{interpolationType:u,minZoom:f,maxZoom:g}=n,y=u?Gt(Bs.interpolationFactor(u,e,f,g),0,1):0;"camera"===n.kind?s=K(n.minSize,n.maxSize,y):r=y}return{uSizeT:r,uSize:s}}var Gd=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:rl,evaluateSizeForFeature:ed,evaluateSizeForZoom:Bc,getSizeData:Fc});function tf(n,e,r){return n.sections.forEach(s=>{s.text=function(u,f,g){const y=f.layout.get("text-transform").evaluate(g,{});return"uppercase"===y?u=u.toLocaleUpperCase():"lowercase"===y&&(u=u.toLocaleLowerCase()),A.applyArabicShaping&&(u=A.applyArabicShaping(u)),u}(s.text,e,r)}),n}const pc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function ag(n){return"\ufe36"===n||"\ufe48"===n||"\ufe38"===n||"\ufe44"===n||"\ufe42"===n||"\ufe3e"===n||"\ufe3c"===n||"\ufe3a"===n||"\ufe18"===n||"\ufe40"===n||"\ufe10"===n||"\ufe13"===n||"\ufe14"===n||"\uff40"===n||"\uffe3"===n||"\ufe11"===n||"\ufe12"===n}function Cp(n){return"\ufe35"===n||"\ufe47"===n||"\ufe37"===n||"\ufe43"===n||"\ufe41"===n||"\ufe3d"===n||"\ufe3b"===n||"\ufe39"===n||"\ufe17"===n||"\ufe3f"===n}var Wd=mo,$_=function(n,e,r,s,u){var f,g,y=8*u-s-1,w=(1<<y)-1,E=w>>1,O=-7,z=r?u-1:0,U=r?-1:1,q=n[e+z];for(z+=U,f=q&(1<<-O)-1,q>>=-O,O+=y;O>0;f=256*f+n[e+z],z+=U,O-=8);for(g=f&(1<<-O)-1,f>>=-O,O+=s;O>0;g=256*g+n[e+z],z+=U,O-=8);if(0===f)f=1-E;else{if(f===w)return g?NaN:1/0*(q?-1:1);g+=Math.pow(2,s),f-=E}return(q?-1:1)*g*Math.pow(2,f-s)},nf=function(n,e,r,s,u,f){var g,y,w,E=8*f-u-1,O=(1<<E)-1,z=O>>1,U=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,q=s?0:f-1,J=s?1:-1,se=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,g=O):(g=Math.floor(Math.log(e)/Math.LN2),e*(w=Math.pow(2,-g))<1&&(g--,w*=2),(e+=g+z>=1?U/w:U*Math.pow(2,1-z))*w>=2&&(g++,w/=2),g+z>=O?(y=0,g=O):g+z>=1?(y=(e*w-1)*Math.pow(2,u),g+=z):(y=e*Math.pow(2,z-1)*Math.pow(2,u),g=0));u>=8;n[r+q]=255&y,q+=J,y/=256,u-=8);for(g=g<<u|y,E+=u;E>0;n[r+q]=255&g,q+=J,g/=256,E-=8);n[r+q-J]|=128*se};function mo(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}mo.Varint=0,mo.Fixed64=1,mo.Bytes=2,mo.Fixed32=5;var Tp=4294967296,Sp=1/Tp,lg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function mc(n){return n.type===mo.Bytes?n.readVarint()+n.pos:n.pos+1}function Ip(n,e,r){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(s);for(var u=r.pos-1;u>=n;u--)r.buf[u+s]=r.buf[u]}function V_(n,e){for(var r=0;r<n.length;r++)e.writeVarint(n[r])}function U_(n,e){for(var r=0;r<n.length;r++)e.writeSVarint(n[r])}function Iv(n,e){for(var r=0;r<n.length;r++)e.writeFloat(n[r])}function j_(n,e){for(var r=0;r<n.length;r++)e.writeDouble(n[r])}function rf(n,e){for(var r=0;r<n.length;r++)e.writeBoolean(n[r])}function Mp(n,e){for(var r=0;r<n.length;r++)e.writeFixed32(n[r])}function H_(n,e){for(var r=0;r<n.length;r++)e.writeSFixed32(n[r])}function cg(n,e){for(var r=0;r<n.length;r++)e.writeFixed64(n[r])}function Ap(n,e){for(var r=0;r<n.length;r++)e.writeSFixed64(n[r])}function wu(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function td(n,e,r){n[r]=e,n[r+1]=e>>>8,n[r+2]=e>>>16,n[r+3]=e>>>24}function Pp(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}mo.prototype={destroy:function(){this.buf=null},readFields:function(n,e,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),u=s>>3,f=this.pos;this.type=7&s,n(u,e,this),this.pos===f&&this.skip(s)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=wu(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Pp(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=wu(this.buf,this.pos)+wu(this.buf,this.pos+4)*Tp;return this.pos+=8,n},readSFixed64:function(){var n=wu(this.buf,this.pos)+Pp(this.buf,this.pos+4)*Tp;return this.pos+=8,n},readFloat:function(){var n=$_(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=$_(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,r,s=this.buf;return e=127&(r=s[this.pos++]),r<128?e:(e|=(127&(r=s[this.pos++]))<<7,r<128?e:(e|=(127&(r=s[this.pos++]))<<14,r<128?e:(e|=(127&(r=s[this.pos++]))<<21,r<128?e:function(u,f,g){var y,w,E=g.buf;if(y=(112&(w=E[g.pos++]))>>4,w<128||(y|=(127&(w=E[g.pos++]))<<3,w<128)||(y|=(127&(w=E[g.pos++]))<<10,w<128)||(y|=(127&(w=E[g.pos++]))<<17,w<128)||(y|=(127&(w=E[g.pos++]))<<24,w<128)||(y|=(1&(w=E[g.pos++]))<<31,w<128))return function Nc(n,e,r){return r?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}(u,y,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=s[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&lg?lg.decode(this.buf.subarray(e,n)):function(r,s,u){for(var f="",g=s;g<u;){var y,w,E,O=r[g],z=null,U=O>239?4:O>223?3:O>191?2:1;if(g+U>u)break;1===U?O<128&&(z=O):2===U?128==(192&(y=r[g+1]))&&(z=(31&O)<<6|63&y)<=127&&(z=null):3===U?(w=r[g+2],128==(192&(y=r[g+1]))&&128==(192&w)&&((z=(15&O)<<12|(63&y)<<6|63&w)<=2047||z>=55296&&z<=57343)&&(z=null)):4===U&&(w=r[g+2],E=r[g+3],128==(192&(y=r[g+1]))&&128==(192&w)&&128==(192&E)&&((z=(15&O)<<18|(63&y)<<12|(63&w)<<6|63&E)<=65535||z>=1114112)&&(z=null)),null===z?(z=65533,U=1):z>65535&&(z-=65536,f+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),f+=String.fromCharCode(z),g+=U}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==mo.Bytes)return n.push(this.readVarint(e));var r=mc(this);for(n=n||[];this.pos<r;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==mo.Bytes)return n.push(this.readSVarint());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==mo.Bytes)return n.push(this.readBoolean());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==mo.Bytes)return n.push(this.readFloat());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==mo.Bytes)return n.push(this.readDouble());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==mo.Bytes)return n.push(this.readFixed32());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==mo.Bytes)return n.push(this.readSFixed32());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==mo.Bytes)return n.push(this.readFixed64());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==mo.Bytes)return n.push(this.readSFixed64());var e=mc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===mo.Varint)for(;this.buf[this.pos++]>127;);else if(e===mo.Bytes)this.pos=this.readVarint()+this.pos;else if(e===mo.Fixed32)this.pos+=4;else{if(e!==mo.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),td(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),td(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),td(this.buf,-1&n,this.pos),td(this.buf,Math.floor(n*Sp),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),td(this.buf,-1&n,this.pos),td(this.buf,Math.floor(n*Sp),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,r){var s,u,f,y;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),f=s,(y=r).buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,y.buf[y.pos]=127&(f>>>=7),function(f,g){var y=(7&f)<<4;g.buf[g.pos++]|=y|((f>>>=3)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f)))))}(u,r)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(s,u,f){for(var g,y,w=0;w<u.length;w++){if((g=u.charCodeAt(w))>55295&&g<57344){if(!y){g>56319||w+1===u.length?(s[f++]=239,s[f++]=191,s[f++]=189):y=g;continue}if(g<56320){s[f++]=239,s[f++]=191,s[f++]=189,y=g;continue}g=y-55296<<10|g-56320|65536,y=null}else y&&(s[f++]=239,s[f++]=191,s[f++]=189,y=null);g<128?s[f++]=g:(g<2048?s[f++]=g>>6|192:(g<65536?s[f++]=g>>12|224:(s[f++]=g>>18|240,s[f++]=g>>12&63|128),s[f++]=g>>6&63|128),s[f++]=63&g|128)}return f}(this.buf,n,this.pos);var r=this.pos-e;r>=128&&Ip(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(n){this.realloc(4),nf(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),nf(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=n[r]},writeRawMessage:function(n,e){this.pos++;var r=this.pos;n(e,this);var s=this.pos-r;s>=128&&Ip(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(n,e,r){this.writeTag(n,mo.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,V_,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,U_,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,rf,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,Iv,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,j_,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,Mp,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,H_,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,cg,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,Ap,e)},writeBytesField:function(n,e){this.writeTag(n,mo.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,mo.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,mo.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,mo.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,mo.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,mo.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,mo.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,mo.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,mo.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,mo.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};var sf=Kt(Wd);const af=3;function Mv(n,e,r){e.glyphs=[],1===n&&r.readMessage(G_,e)}function G_(n,e,r){if(3===n){const{id:s,bitmap:u,width:f,height:g,left:y,top:w,advance:E}=r.readMessage(qd,{});e.glyphs.push({id:s,bitmap:new dc({width:f+2*af,height:g+2*af},u),metrics:{width:f,height:g,left:y,top:w,advance:E}})}else 4===n?e.ascender=r.readSVarint():5===n&&(e.descender=r.readSVarint())}function qd(n,e,r){1===n?e.id=r.readVarint():2===n?e.bitmap=r.readBytes():3===n?e.width=r.readVarint():4===n?e.height=r.readVarint():5===n?e.left=r.readSVarint():6===n?e.top=r.readSVarint():7===n&&(e.advance=r.readVarint())}const ug=af;function zc(n){let e=0,r=0;for(const g of n)e+=g.w*g.h,r=Math.max(r,g.w);n.sort((g,y)=>y.h-g.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let u=0,f=0;for(const g of n)for(let y=s.length-1;y>=0;y--){const w=s[y];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,f=Math.max(f,g.y+g.h),u=Math.max(u,g.x+g.w),g.w===w.w&&g.h===w.h){const E=s.pop();y<s.length&&(s[y]=E)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(s.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}const da=1;class Rp{constructor(e,{pixelRatio:r,version:s,stretchX:u,stretchY:f,content:g}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=u,this.stretchY=f,this.content=g,this.version=s}get tl(){return[this.paddedRect.x+da,this.paddedRect.y+da]}get br(){return[this.paddedRect.x+this.paddedRect.w-da,this.paddedRect.y+this.paddedRect.h-da]}get displaySize(){return[(this.paddedRect.w-2*da)/this.pixelRatio,(this.paddedRect.h-2*da)/this.pixelRatio]}}class Op{constructor(e,r){const s={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(r,u,f);const{w:g,h:y}=zc(f),w=new ca({width:g||1,height:y||1});for(const E in e){const O=e[E],z=s[E].paddedRect;ca.copy(O.data,w,{x:0,y:0},{x:z.x+da,y:z.y+da},O.data)}for(const E in r){const O=r[E],z=u[E].paddedRect,U=z.x+da,q=z.y+da,J=O.data.width,se=O.data.height;ca.copy(O.data,w,{x:0,y:0},{x:U,y:q},O.data),ca.copy(O.data,w,{x:0,y:se-1},{x:U,y:q-1},{width:J,height:1}),ca.copy(O.data,w,{x:0,y:0},{x:U,y:q+se},{width:J,height:1}),ca.copy(O.data,w,{x:J-1,y:0},{x:U-1,y:q},{width:1,height:se}),ca.copy(O.data,w,{x:0,y:0},{x:U+J,y:q},{width:1,height:se})}this.image=w,this.iconPositions=s,this.patternPositions=u}addImages(e,r,s){for(const u in e){const f=e[u],g={x:0,y:0,w:f.data.width+2*da,h:f.data.height+2*da};s.push(g),r[u]=new Rp(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),r)}patchUpdatedImage(e,r,s){if(!e||!r||e.version===r.version)return;e.version=r.version;const[u,f]=e.tl;s.update(r.data,void 0,{x:u,y:f})}}$(Rp,"ImagePosition"),$(Op,"ImageAtlas");const il={horizontal:1,vertical:2,horizontalOnly:3},dg=-17;class Yd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const s=new Yd;return s.scale=e||1,s.fontStack=r,s}static forImage(e){const r=new Yd;return r.imageName=e,r}}class Eu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const s=new Eu;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?s.addImageSection(f):s.addTextSection(f,r)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,s){let u="";for(let f=0;f<r.length;f++){const g=r.charCodeAt(f+1)||null,y=r.charCodeAt(f-1)||null;u+=!s&&(g&&Mi(g)&&!pc[r[f+1]]||y&&Mi(y)&&!pc[r[f-1]])||!pc[r[f]]?r[f]:pc[r[f]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&nd[this.text.charCodeAt(s)];s++)e++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&nd[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const s=new Eu;return s.text=this.text.substring(e,r),s.sectionIndex=this.sectionIndex.slice(e,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Yd.forText(e.scale,e.fontStack||r));const s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){const r=e.image?e.image.name:"";if(0===r.length)return void vn("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Yd.forImage(r)),this.sectionIndex.push(this.sections.length-1)):vn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function kp(n,e,r,s,u,f,g,y,w,E,O,z,U,q,J){const se=Eu.fromFeature(n,u);z===il.vertical&&se.verticalizePunctuation(U);let me=[];const Pe=function(Qe,rn,Ht,xn,Nn,on){if(!Qe)return[];const Sn=[],In=function(ir,vr,sr,gi,Xn,Fr){let _i=0;for(let Ji=0;Ji<ir.length();Ji++){const yi=ir.getSection(Ji);_i+=lf(ir.getCharCode(Ji),yi,gi,Xn,vr,Fr)}return _i/Math.max(1,Math.ceil(_i/sr))}(Qe,rn,Ht,xn,Nn,on),Fn=Qe.text.indexOf("\u200b")>=0;let jn=0;for(let ir=0;ir<Qe.length();ir++){const vr=Qe.getSection(ir),sr=Qe.getCharCode(ir);if(nd[sr]||(jn+=lf(sr,vr,xn,Nn,rn,on)),ir<Qe.length()-1){const gi=!((gn=sr)<11904||!(we["Bopomofo Extended"](gn)||we.Bopomofo(gn)||we["CJK Compatibility Forms"](gn)||we["CJK Compatibility Ideographs"](gn)||we["CJK Compatibility"](gn)||we["CJK Radicals Supplement"](gn)||we["CJK Strokes"](gn)||we["CJK Symbols and Punctuation"](gn)||we["CJK Unified Ideographs Extension A"](gn)||we["CJK Unified Ideographs"](gn)||we["Enclosed CJK Letters and Months"](gn)||we["Halfwidth and Fullwidth Forms"](gn)||we.Hiragana(gn)||we["Ideographic Description Characters"](gn)||we["Kangxi Radicals"](gn)||we["Katakana Phonetic Extensions"](gn)||we.Katakana(gn)||we["Vertical Forms"](gn)||we["Yi Radicals"](gn)||we["Yi Syllables"](gn)));(Av[sr]||gi||vr.imageName)&&Sn.push(hg(ir+1,jn,In,Sn,W_(sr,Qe.getCharCode(ir+1),gi&&Fn),!1))}}var gn;return Fp(hg(Qe.length(),jn,In,Sn,0,!0))}(se,E,f,e,s,q),{processBidirectionalText:Xe,processStyledBidirectionalText:Ae}=A;if(Xe&&1===se.sections.length){const Qe=Xe(se.toString(),Pe);for(const rn of Qe){const Ht=new Eu;Ht.text=rn,Ht.sections=se.sections;for(let xn=0;xn<rn.length;xn++)Ht.sectionIndex.push(0);me.push(Ht)}}else if(Ae){const Qe=Ae(se.text,se.sectionIndex,Pe);for(const rn of Qe){const Ht=new Eu;Ht.text=rn[0],Ht.sectionIndex=rn[1],Ht.sections=se.sections,me.push(Ht)}}else me=function(Qe,rn){const Ht=[],xn=Qe.text;let Nn=0;for(const on of rn)Ht.push(Qe.substring(Nn,on)),Nn=on;return Nn<xn.length&&Ht.push(Qe.substring(Nn,xn.length)),Ht}(se,Pe);const We=[],it={positionedLines:We,text:se.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Qe,rn,Ht,xn,Nn,on,Sn,In,Fn,jn,gn,ir){let vr=0,sr=0,gi=0;const Xn="right"===In?1:"left"===In?0:.5;let Fr=!1;for(const Ci of Nn){const Ti=Ci.getSections();for(const Ro of Ti){if(Ro.imageName)continue;const No=rn[Ro.fontStack];if(No&&(Fr=void 0!==No.ascender&&void 0!==No.descender,!Fr))break}if(!Fr)break}let _i=0;for(const Ci of Nn){Ci.trim();const Ti=Ci.getMaxScale(),Ro=(Ti-1)*Ks,No={positionedGlyphs:[],lineOffset:0};Qe.positionedLines[_i]=No;const jo=No.positionedGlyphs;let Oo=0;if(!Ci.length()){sr+=on,++_i;continue}let ls=0,ms=0;for(let ko=0;ko<Ci.length();ko++){const Ts=Ci.getSection(ko),ts=Ci.getSectionIndex(ko),Yo=Ci.getCharCode(ko);let Xi=Ts.scale,Ss=null,go=null,xa=null,ks=Ks,Ls=0;const ia=!(Fn===il.horizontal||!gn&&!Nr(Yo)||gn&&(nd[Yo]||(Ji=Yo,we.Arabic(Ji)||we["Arabic Supplement"](Ji)||we["Arabic Extended-A"](Ji)||we["Arabic Presentation Forms-A"](Ji)||we["Arabic Presentation Forms-B"](Ji))));if(Ts.imageName){const Ia=xn[Ts.imageName];if(!Ia)continue;xa=Ts.imageName,Qe.iconsInText=Qe.iconsInText||!0,go=Ia.paddedRect;const oa=Ia.displaySize;Xi=Xi*Ks/ir,Ss={width:oa[0],height:oa[1],left:da,top:-ug,advance:ia?oa[1]:oa[0],localGlyph:!1},Ls=Fr?-Ss.height*Xi:dg+Ti*Ks-oa[1]*Xi,ks=Ss.advance;const Pl=(ia?oa[0]:oa[1])*Xi-Ks*Ti;Pl>0&&Pl>Oo&&(Oo=Pl)}else{const Ia=Ht[Ts.fontStack];if(!Ia)continue;Ia[Yo]&&(go=Ia[Yo]);const oa=rn[Ts.fontStack];if(!oa)continue;const Pl=oa.glyphs[Yo];if(!Pl)continue;if(Ss=Pl.metrics,ks=8203!==Yo?Ks:0,Fr){const Zc=void 0!==oa.ascender?Math.abs(oa.ascender):0,Xc=void 0!==oa.descender?Math.abs(oa.descender):0,Kc=(Zc+Xc)*Xi;ls<Kc&&(ls=Kc,ms=(Zc-Xc)/2*Xi),Ls=-Zc*Xi}else Ls=dg+(Ti-Xi)*Ks}ia?(Qe.verticalizable=!0,jo.push({glyph:Yo,imageName:xa,x:vr,y:sr+Ls,vertical:ia,scale:Xi,localGlyph:Ss.localGlyph,fontStack:Ts.fontStack,sectionIndex:ts,metrics:Ss,rect:go}),vr+=ks*Xi+jn):(jo.push({glyph:Yo,imageName:xa,x:vr,y:sr+Ls,vertical:ia,scale:Xi,localGlyph:Ss.localGlyph,fontStack:Ts.fontStack,sectionIndex:ts,metrics:Ss,rect:go}),vr+=Ss.advance*Xi+jn)}0!==jo.length&&(gi=Math.max(vr-jn,gi),Fr?Np(jo,Xn,Oo,ms,on*Ti/2):Np(jo,Xn,Oo,0,on/2)),vr=0;const Os=on*Ti+Oo;No.lineOffset=Math.max(Oo,Ro),sr+=Os,++_i}var Ji;const yi=sr,{horizontalAlign:jr,verticalAlign:Uo}=Bp(Sn);(function(Ci,Ti,Ro,No,jo,Oo){const ls=(Ti-Ro)*jo,ms=-Oo*No;for(const Os of Ci)for(const ko of Os.positionedGlyphs)ko.x+=ls,ko.y+=ms})(Qe.positionedLines,Xn,jr,Uo,gi,yi),Qe.top+=-Uo*yi,Qe.bottom=Qe.top+yi,Qe.left+=-jr*gi,Qe.right=Qe.left+gi,Qe.hasBaseline=Fr}(it,e,r,s,me,g,y,w,z,E,U,J),!function(Qe){for(const rn of Qe)if(0!==rn.positionedGlyphs.length)return!1;return!0}(We)&&it}const nd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Av={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function lf(n,e,r,s,u,f){if(e.imageName){const g=s[e.imageName];return g?g.displaySize[0]*e.scale*Ks/f+u:0}{const g=r[e.fontStack],y=g&&g.glyphs[n];return y?y.metrics.advance*e.scale+u:0}}function Lp(n,e,r,s){const u=Math.pow(n-e,2);return s?n<e?u/2:2*u:u+Math.abs(r)*r}function W_(n,e,r){let s=0;return 10===n&&(s-=1e4),r&&(s+=150),40!==n&&65288!==n||(s+=50),41!==e&&65289!==e||(s+=50),s}function hg(n,e,r,s,u,f){let g=null,y=Lp(e,r,u,f);for(const w of s){const E=Lp(e-w.x,r,u,f)+w.badness;E<=y&&(g=w,y=E)}return{index:n,x:e,priorBreak:g,badness:y}}function Fp(n){return n?Fp(n.priorBreak).concat(n.index):[]}function Bp(n){let e=.5,r=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Np(n,e,r,s,u){if(!(e||r||s||u))return;const f=n.length-1,g=n[f],y=(g.x+g.metrics.advance*g.scale)*e;for(let w=0;w<=f;w++)n[w].x-=y,n[w].y+=r+s+u}function q_(n,e,r){const{horizontalAlign:s,verticalAlign:u}=Bp(r),f=e[0]-n.displaySize[0]*s,g=e[1]-n.displaySize[1]*u;return{image:n,top:g,bottom:g+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function fg(n,e,r,s,u,f){const g=n.image;let y;if(g.content){const me=g.content,Pe=g.pixelRatio||1;y=[me[0]/Pe,me[1]/Pe,g.displaySize[0]-me[2]/Pe,g.displaySize[1]-me[3]/Pe]}const w=e.left*f,E=e.right*f;let O,z,U,q;"width"===r||"both"===r?(q=u[0]+w-s[3],z=u[0]+E+s[1]):(q=u[0]+(w+E-g.displaySize[0])/2,z=q+g.displaySize[0]);const J=e.top*f,se=e.bottom*f;return"height"===r||"both"===r?(O=u[1]+J-s[0],U=u[1]+se+s[2]):(O=u[1]+(J+se-g.displaySize[1])/2,U=O+g.displaySize[1]),{image:g,top:O,right:z,bottom:U,left:q,collisionPadding:y}}class $c extends Le{constructor(e,r,s,u,f){super(e,r),this.angle=u,this.z=s,void 0!==f&&(this.segment=f)}clone(){return new $c(this.x,this.y,this.z,this.angle,this.segment)}}function zp(n,e,r,s,u){if(void 0===e.segment)return!0;let f=e,g=e.segment+1,y=0;for(;y>-r/2;){if(g--,g<0)return!1;y-=n[g].dist(f),f=n[g]}y+=n[g].dist(n[g+1]),g++;const w=[];let E=0;for(;y<r/2;){const O=n[g],z=n[g+1];if(!z)return!1;let U=n[g-1].angleTo(O)-O.angleTo(z);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:y,angleDelta:U}),E+=U;y-w[0].distance>s;)E-=w.shift().angleDelta;if(E>u)return!1;g++,y+=O.dist(z)}return!0}function $p(n){let e=0;for(let r=0;r<n.length-1;r++)e+=n[r].dist(n[r+1]);return e}function ml(n,e,r){return n?.6*e*r:0}function cf(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function Y_(n,e,r,s,u,f){const g=ml(r,u,f),y=cf(r,s)*f;let w=0;const E=$p(n)/2;for(let O=0;O<n.length-1;O++){const z=n[O],U=n[O+1],q=z.dist(U);if(w+q>E){const J=(E-w)/q,se=K(z.x,U.x,J),me=K(z.y,U.y,J),Pe=new $c(se,me,0,U.angleTo(z),O);return!g||zp(n,Pe,y,g,e)?Pe:void 0}w+=q}}function Pv(n,e,r,s,u,f,g,y,w){const E=ml(s,f,g),O=cf(s,u),z=O*g,U=0===n[0].x||n[0].x===w||0===n[0].y||n[0].y===w;return e-z<e/4&&(e=z+e/4),pg(n,U?e/2*y%e:(O/2+2*f)*g*y%e,e,E,r,z,U,!1,w)}function pg(n,e,r,s,u,f,g,y,w){const E=f/2,O=$p(n);let z=0,U=e-r,q=[];for(let J=0;J<n.length-1;J++){const se=n[J],me=n[J+1],Pe=se.dist(me),Xe=me.angleTo(se);for(;U+r<z+Pe;){U+=r;const Ae=(U-z)/Pe,We=K(se.x,me.x,Ae),it=K(se.y,me.y,Ae);if(We>=0&&We<w&&it>=0&&it<w&&U-E>=0&&U+E<=O){const Qe=new $c(We,it,0,Xe,J);Qe._round(),s&&!zp(n,Qe,f,s,u)||q.push(Qe)}}z+=Pe}return y||q.length||g||(q=pg(n,z/2,r,s,u,f,g,!0,w)),q}function mg(n,e,r,s,u){const f=[];for(let g=0;g<n.length;g++){const y=n[g];let w;for(let E=0;E<y.length-1;E++){let O=y[E],z=y[E+1];O.x<e&&z.x<e||(O.x<e?O=new Le(e,O.y+(e-O.x)/(z.x-O.x)*(z.y-O.y))._round():z.x<e&&(z=new Le(e,O.y+(e-O.x)/(z.x-O.x)*(z.y-O.y))._round()),O.y<r&&z.y<r||(O.y<r?O=new Le(O.x+(r-O.y)/(z.y-O.y)*(z.x-O.x),r)._round():z.y<r&&(z=new Le(O.x+(r-O.y)/(z.y-O.y)*(z.x-O.x),r)._round()),O.x>=s&&z.x>=s||(O.x>=s?O=new Le(s,O.y+(s-O.x)/(z.x-O.x)*(z.y-O.y))._round():z.x>=s&&(z=new Le(s,O.y+(s-O.x)/(z.x-O.x)*(z.y-O.y))._round()),O.y>=u&&z.y>=u||(O.y>=u?O=new Le(O.x+(u-O.y)/(z.y-O.y)*(z.x-O.x),u)._round():z.y>=u&&(z=new Le(O.x+(u-O.y)/(z.y-O.y)*(z.x-O.x),u)._round()),w&&O.equals(w[w.length-1])||(w=[O],f.push(w)),w.push(z)))))}}return f}$($c,"Anchor");const rd=1e20;function Du(n,e,r,s,u,f,g,y,w){for(let E=e;E<e+s;E++)Yl(n,r*f+E,f,u,g,y,w);for(let E=r;E<r+u;E++)Yl(n,E*f+e,1,s,g,y,w)}function Yl(n,e,r,s,u,f,g){f[0]=0,g[0]=-rd,g[1]=rd,u[0]=n[e];for(let y=1,w=0,E=0;y<s;y++){u[y]=n[e+y*r];const O=y*y;do{const z=f[w];E=(u[y]-u[z]+O-z*z)/(y-z)/2}while(E<=g[w]&&--w>-1);w++,f[w]=y,g[w]=E,g[w+1]=rd}for(let y=0,w=0;y<s;y++){for(;g[w+1]<y;)w++;const E=f[w],O=y-E;n[e+y*r]=u[E]+O*O}}const Sa=2,Vp={none:0,ideographs:1,all:2};class id{constructor(e,r,s){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const s=[];for(const u in e)for(const f of e[u])s.push({stack:u,id:f});pr(s,({stack:u,id:f},g)=>{let y=this.entries[u];y||(y=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=y.glyphs[f];if(void 0!==w)return void g(null,{stack:u,id:f,glyph:w});if(w=this._tinySDF(y,u,f),w)return y.glyphs[f]=w,void g(null,{stack:u,id:f,glyph:w});const E=Math.floor(f/256);if(256*E>65535)return void g(new Error("glyphs > 65535 not supported"));if(y.ranges[E])return void g(null,{stack:u,id:f,glyph:w});let O=y.requests[E];O||(O=y.requests[E]=[],id.loadGlyphRange(u,E,this.url,this.requestManager,(z,U)=>{if(U){y.ascender=U.ascender,y.descender=U.descender;for(const q in U.glyphs)this._doesCharSupportLocalGlyph(+q)||(y.glyphs[+q]=U.glyphs[+q]);y.ranges[E]=!0}for(const q of O)q(z,U);delete y.requests[E]})),O.push((z,U)=>{z?g(z):U&&g(null,{stack:u,id:f,glyph:U.glyphs[f]||null})})},(u,f)=>{if(u)r(u);else if(f){const g={};for(const{stack:y,id:w,glyph:E}of f)void 0===g[y]&&(g[y]={}),void 0===g[y].glyphs&&(g[y].glyphs={}),g[y].glyphs[w]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},g[y].ascender=this.entries[y].ascender,g[y].descender=this.entries[y].descender;r(null,g)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Vp.none&&(this.localGlyphMode===Vp.all?!!this.localFontFamily:!!this.localFontFamily&&(we["CJK Unified Ideographs"](e)||we["Hangul Syllables"](e)||we.Hiragana(e)||we.Katakana(e)||we["CJK Symbols and Punctuation"](e)))}_tinySDF(e,r,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let f=e.tinySDF;if(!f){let se="400";/bold/i.test(r)?se="900":/medium/i.test(r)?se="500":/light/i.test(r)&&(se="200"),f=e.tinySDF=new id.TinySDF({fontFamily:u,fontWeight:se,fontSize:24*Sa,buffer:3*Sa,radius:8*Sa}),f.fontWeight=se}if(this.localGlyphs[f.fontWeight][s])return this.localGlyphs[f.fontWeight][s];const g=String.fromCharCode(s),{data:y,width:w,height:E,glyphWidth:O,glyphHeight:z,glyphLeft:U,glyphTop:q,glyphAdvance:J}=f.draw(g);return this.localGlyphs[f.fontWeight][s]={id:s,bitmap:new dc({width:w,height:E},y),metrics:{width:O/Sa,height:z/Sa,left:U/Sa,top:q/Sa-27,advance:J/Sa,localGlyph:!0}}}}id.loadGlyphRange=function(n,e,r,s,u){const f=256*e,g=f+255,y=s.transformRequest(s.normalizeGlyphsURL(r).replace("{fontstack}",n).replace("{range}",`${f}-${g}`),si.Glyphs);ii(y,(w,E)=>{if(w)u(w);else if(E){const O={},z=new sf(E).readFields(Mv,{});for(const U of z.glyphs)O[U.id]=U;u(null,{glyphs:O,ascender:z.ascender,descender:z.descender})}})},id.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:r=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:g="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=r;const y=this.size=n+4*e,w=this._createCanvas(y),E=this.ctx=w.getContext("2d",{willReadFrequently:!0});E.font=`${g} ${f} ${n}px ${u}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(n),g=Math.ceil(r),y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),w=Math.min(this.size-this.buffer,g+Math.ceil(s)),E=y+2*this.buffer,O=w+2*this.buffer,z=Math.max(E*O,0),U=new Uint8ClampedArray(z),q={data:U,width:E,height:O,glyphWidth:y,glyphHeight:w,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(0===y||0===w)return q;const{ctx:J,buffer:se,gridInner:me,gridOuter:Pe}=this;J.clearRect(se,se,y,w),J.fillText(n,se,se+g);const Xe=J.getImageData(se,se,y,w);Pe.fill(rd,0,z),me.fill(0,0,z);for(let Ae=0;Ae<w;Ae++)for(let We=0;We<y;We++){const it=Xe.data[4*(Ae*y+We)+3]/255;if(0===it)continue;const Qe=(Ae+se)*E+We+se;if(1===it)Pe[Qe]=0,me[Qe]=rd;else{const rn=.5-it;Pe[Qe]=rn>0?rn*rn:0,me[Qe]=rn<0?rn*rn:0}}Du(Pe,0,0,E,O,E,this.f,this.v,this.z),Du(me,se,se,y,w,E,this.f,this.v,this.z);for(let Ae=0;Ae<z;Ae++){const We=Math.sqrt(Pe[Ae])-Math.sqrt(me[Ae]);U[Ae]=Math.round(255-255*(We/this.radius+this.cutoff))}return q}};const Cu=da;function uf(n,e,r,s){const u=[],f=n.image,g=f.pixelRatio,y=f.paddedRect.w-2*Cu,w=f.paddedRect.h-2*Cu,E=n.right-n.left,O=n.bottom-n.top,z=f.stretchX||[[0,y]],U=f.stretchY||[[0,w]],q=(on,Sn)=>on+Sn[1]-Sn[0],J=z.reduce(q,0),se=U.reduce(q,0),me=y-J,Pe=w-se;let Xe=0,Ae=J,We=0,it=se,Qe=0,rn=me,Ht=0,xn=Pe;if(f.content&&s){const on=f.content;Xe=Vc(z,0,on[0]),We=Vc(U,0,on[1]),Ae=Vc(z,on[0],on[2]),it=Vc(U,on[1],on[3]),Qe=on[0]-Xe,Ht=on[1]-We,rn=on[2]-on[0]-Ae,xn=on[3]-on[1]-it}const Nn=(on,Sn,In,Fn)=>{const jn=jp(on.stretch-Xe,Ae,E,n.left),gn=od(on.fixed-Qe,rn,on.stretch,J),ir=jp(Sn.stretch-We,it,O,n.top),vr=od(Sn.fixed-Ht,xn,Sn.stretch,se),sr=jp(In.stretch-Xe,Ae,E,n.left),gi=od(In.fixed-Qe,rn,In.stretch,J),Xn=jp(Fn.stretch-We,it,O,n.top),Fr=od(Fn.fixed-Ht,xn,Fn.stretch,se),_i=new Le(jn,ir),Ji=new Le(sr,ir),yi=new Le(sr,Xn),jr=new Le(jn,Xn),Uo=new Le(gn/g,vr/g),Ci=new Le(gi/g,Fr/g),Ti=e*Math.PI/180;if(Ti){const jo=Math.sin(Ti),Oo=Math.cos(Ti),ls=[Oo,-jo,jo,Oo];_i._matMult(ls),Ji._matMult(ls),jr._matMult(ls),yi._matMult(ls)}const Ro=on.stretch+on.fixed,No=Sn.stretch+Sn.fixed;return{tl:_i,tr:Ji,bl:jr,br:yi,tex:{x:f.paddedRect.x+Cu+Ro,y:f.paddedRect.y+Cu+No,w:In.stretch+In.fixed-Ro,h:Fn.stretch+Fn.fixed-No},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Uo,pixelOffsetBR:Ci,minFontScaleX:rn/g/E,minFontScaleY:xn/g/O,isSDF:r}};if(s&&(f.stretchX||f.stretchY)){const on=Up(z,me,J),Sn=Up(U,Pe,se);for(let In=0;In<on.length-1;In++){const Fn=on[In],jn=on[In+1];for(let gn=0;gn<Sn.length-1;gn++)u.push(Nn(Fn,Sn[gn],jn,Sn[gn+1]))}}else u.push(Nn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:w+1}));return u}function Vc(n,e,r){let s=0;for(const u of n)s+=Math.max(e,Math.min(r,u[1]))-Math.max(e,Math.min(r,u[0]));return s}function Up(n,e,r){const s=[{fixed:-Cu,stretch:0}];for(const[u,f]of n){const g=s[s.length-1];s.push({fixed:u-g.stretch,stretch:g.stretch}),s.push({fixed:u-g.stretch,stretch:g.stretch+(f-u)})}return s.push({fixed:e+Cu,stretch:r}),s}function jp(n,e,r,s){return n/e*r+s}function od(n,e,r,s){return n-e*r/s}function sd(n,e,r,s){const u=e+n.positionedLines[s].lineOffset;return 0===s?r+u/2:r+(u+(e+n.positionedLines[s-1].lineOffset))/2}class df{constructor(e=[],r=gg){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:s}=this,u=r[e];for(;e>0;){const f=e-1>>1,g=r[f];if(s(u,g)>=0)break;r[e]=g,e=f}r[e]=u}_down(e){const{data:r,compare:s}=this,u=this.length>>1,f=r[e];for(;e<u;){let g=1+(e<<1),y=r[g];const w=g+1;if(w<this.length&&s(r[w],y)<0&&(g=w,y=r[w]),s(y,f)>=0)break;r[e]=y,e=g}r[e]=f}}function gg(n,e){return n<e?-1:n>e?1:0}function _g(n,e=1,r=!1){let s=1/0,u=1/0,f=-1/0,g=-1/0;const y=n[0];for(let q=0;q<y.length;q++){const J=y[q];(!q||J.x<s)&&(s=J.x),(!q||J.y<u)&&(u=J.y),(!q||J.x>f)&&(f=J.x),(!q||J.y>g)&&(g=J.y)}const w=Math.min(f-s,g-u);let E=w/2;const O=new df([],Z_);if(0===w)return new Le(s,u);for(let q=s;q<f;q+=w)for(let J=u;J<g;J+=w)O.push(new ad(q+E,J+E,E,n));let z=function(q){let J=0,se=0,me=0;const Pe=q[0];for(let Xe=0,Ae=Pe.length,We=Ae-1;Xe<Ae;We=Xe++){const it=Pe[Xe],Qe=Pe[We],rn=it.x*Qe.y-Qe.x*it.y;se+=(it.x+Qe.x)*rn,me+=(it.y+Qe.y)*rn,J+=3*rn}return new ad(se/J,me/J,0,q)}(n),U=O.length;for(;O.length;){const q=O.pop();(q.d>z.d||!z.d)&&(z=q,r&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,U)),q.max-z.d<=e||(E=q.h/2,O.push(new ad(q.p.x-E,q.p.y-E,E,n)),O.push(new ad(q.p.x+E,q.p.y-E,E,n)),O.push(new ad(q.p.x-E,q.p.y+E,E,n)),O.push(new ad(q.p.x+E,q.p.y+E,E,n)),U+=4)}return r&&(console.log(`num probes: ${U}`),console.log(`best distance: ${z.d}`)),z.p}function Z_(n,e){return e.max-n.max}class ad{constructor(e,r,s,u){this.p=new Le(e,r),this.h=s,this.d=function(f,g){let y=!1,w=1/0;for(let E=0;E<g.length;E++){const O=g[E];for(let z=0,U=O.length,q=U-1;z<U;q=z++){const J=O[z],se=O[q];J.y>f.y!=se.y>f.y&&f.x<(se.x-J.x)*(f.y-J.y)/(se.y-J.y)+J.x&&(y=!y),w=Math.min(w,Fh(f,J,se))}}return(y?1:-1)*Math.sqrt(w)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const ld=7,Hp=Number.POSITIVE_INFINITY,yg=Math.sqrt(2);function X_(n,[e,r]){let s=0,u=0;if(r===Hp){e<0&&(e=0);const f=e/yg;switch(n){case"top-right":case"top-left":u=f-ld;break;case"bottom-right":case"bottom-left":u=-f+ld;break;case"bottom":u=-e+ld;break;case"top":u=e-ld}switch(n){case"top-right":case"bottom-right":s=-f;break;case"top-left":case"bottom-left":s=f;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),n){case"top-right":case"top-left":case"top":u=r-ld;break;case"bottom-right":case"bottom-left":case"bottom":u=-r+ld}switch(n){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,u]}function K_(n,e,r,s,u,f,g,y,w,E){n.createArrays(),n.tilePixelRatio=zr/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const O=n.layers[0].layout,z=n.layers[0]._unevaluatedLayout._values,U={};if("composite"===n.textSizeData.kind){const{minZoom:se,maxZoom:me}=n.textSizeData;U.compositeTextSizes=[z["text-size"].possiblyEvaluate(new N(se),y),z["text-size"].possiblyEvaluate(new N(me),y)]}if("composite"===n.iconSizeData.kind){const{minZoom:se,maxZoom:me}=n.iconSizeData;U.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new N(se),y),z["icon-size"].possiblyEvaluate(new N(me),y)]}U.layoutTextSize=z["text-size"].possiblyEvaluate(new N(w+1),y),U.layoutIconSize=z["icon-size"].possiblyEvaluate(new N(w+1),y),U.textMaxSize=z["text-size"].possiblyEvaluate(new N(18),y);const q="map"===O.get("text-rotation-alignment")&&"point"!==O.get("symbol-placement"),J=O.get("text-size");for(const se of n.features){const me=O.get("text-font").evaluate(se,{},y).join(","),Pe=J.evaluate(se,{},y),Xe=U.layoutTextSize.evaluate(se,{},y),Ae=(U.layoutIconSize.evaluate(se,{},y),{horizontal:{},vertical:void 0}),We=se.text;let it,Qe=[0,0];if(We){const xn=We.toString(),Nn=O.get("text-letter-spacing").evaluate(se,{},y)*Ks,on=O.get("text-line-height").evaluate(se,{},y)*Ks,Sn=mr(xn)?Nn:0,In=O.get("text-anchor").evaluate(se,{},y),Fn=O.get("text-variable-anchor");if(!Fn){const sr=O.get("text-radial-offset").evaluate(se,{},y);Qe=sr?X_(In,[sr*Ks,Hp]):O.get("text-offset").evaluate(se,{},y).map(gi=>gi*Ks)}let jn=q?"center":O.get("text-justify").evaluate(se,{},y);const gn="point"===O.get("symbol-placement"),ir=gn?O.get("text-max-width").evaluate(se,{},y)*Ks:1/0,vr=sr=>{n.allowVerticalPlacement&&Rn(xn)&&(Ae.vertical=kp(We,e,r,u,me,ir,on,In,sr,Sn,Qe,il.vertical,!0,Xe,Pe))};if(!q&&Fn){const sr="auto"===jn?Fn.map(Xn=>vg(Xn)):[jn];let gi=!1;for(let Xn=0;Xn<sr.length;Xn++){const Fr=sr[Xn];if(!Ae.horizontal[Fr])if(gi)Ae.horizontal[Fr]=Ae.horizontal[0];else{const _i=kp(We,e,r,u,me,ir,on,"center",Fr,Sn,Qe,il.horizontal,!1,Xe,Pe);_i&&(Ae.horizontal[Fr]=_i,gi=1===_i.positionedLines.length)}}vr("left")}else{if("auto"===jn&&(jn=vg(In)),gn||O.get("text-writing-mode").indexOf("horizontal")>=0||!Rn(xn)){const sr=kp(We,e,r,u,me,ir,on,In,jn,Sn,Qe,il.horizontal,!1,Xe,Pe);sr&&(Ae.horizontal[jn]=sr)}vr(gn?"left":jn)}}let rn=!1;if(se.icon&&se.icon.name){const xn=s[se.icon.name];xn&&(it=q_(u[se.icon.name],O.get("icon-offset").evaluate(se,{},y),O.get("icon-anchor").evaluate(se,{},y)),rn=xn.sdf,void 0===n.sdfIcons?n.sdfIcons=xn.sdf:n.sdfIcons!==xn.sdf&&vn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xn.pixelRatio!==n.pixelRatio||0!==O.get("icon-rotate").constantOr(1))&&(n.iconsNeedLinear=!0))}const Ht=Gp(Ae.horizontal)||Ae.vertical;n.iconsInText||(n.iconsInText=!!Ht&&Ht.iconsInText),(Ht||it)&&Rv(n,se,Ae,it,s,U,Xe,0,Qe,rn,g,y,E)}f&&n.generateCollisionDebugBuffers(w,n.collisionBoxArray)}function vg(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Rv(n,e,r,s,u,f,g,y,w,E,O,z,U){let q=f.textMaxSize.evaluate(e,{},z);void 0===q&&(q=g);const J=n.layers[0].layout,se=J.get("icon-offset").evaluate(e,{},z),me=Gp(r.horizontal)||r.vertical,Pe="globe"===U.name,Xe=Ks,Ae=g/Xe,We=n.tilePixelRatio*q/Xe,it=(In=n.overscaling,n.zoom>18&&In>2&&(In>>=1),Math.max(zr/(512*In),1)*J.get("symbol-spacing")),Qe=J.get("text-padding")*n.tilePixelRatio,rn=J.get("icon-padding")*n.tilePixelRatio,Ht=De(J.get("text-max-angle")),xn="map"===J.get("text-rotation-alignment")&&"point"!==J.get("symbol-placement"),Nn="map"===J.get("icon-rotation-alignment")&&"point"!==J.get("symbol-placement"),on=J.get("symbol-placement"),Sn=it/2;var In;const Fn=J.get("icon-text-fit");let jn;s&&"none"!==Fn&&(n.allowVerticalPlacement&&r.vertical&&(jn=fg(s,r.vertical,Fn,J.get("icon-text-fit-padding"),se,Ae)),me&&(s=fg(s,me,Fn,J.get("icon-text-fit-padding"),se,Ae)));const gn=(ir,vr,sr)=>{if(vr.x<0||vr.x>=zr||vr.y<0||vr.y>=zr)return;let gi=null;if(Pe){const{x:Xn,y:Fr,z:_i}=U.projectTilePoint(vr.x,vr.y,sr);gi={anchor:new $c(Xn,Fr,_i,0,void 0),up:U.upVector(sr,vr.x,vr.y)}}!function(Xn,Fr,_i,Ji,yi,jr,Uo,Ci,Ti,Ro,No,jo,Oo,ls,ms,Os,ko,Ts,ts,Yo,Xi,Ss,go,xa,ks){const Ls=Xn.addToLineVertexArray(Fr,Ji);let ia,Ia,oa,Pl,Zc,Xc,Kc,py=0,Vg=0,Ug=0,Df=0,lm=-1,Cf=-1;const Ql={};let jg=Ff("");const Jc=_i?_i.anchor:Fr;let Tf=0,Sf=0;if(void 0===Ti._unevaluatedLayout.getValue("text-radial-offset")?[Tf,Sf]=Ti.layout.get("text-offset").evaluate(Xi,{},ks).map(za=>za*Ks):(Tf=Ti.layout.get("text-radial-offset").evaluate(Xi,{},ks)*Ks,Sf=Hp),Xn.allowVerticalPlacement&&yi.vertical){const za=yi.vertical;if(ms)Xc=hf(za),Ci&&(Kc=hf(Ci));else{const Ma=Ti.layout.get("text-rotate").evaluate(Xi,{},ks)+90;oa=Tu(Ro,Jc,Fr,No,jo,Oo,za,ls,Ma,Os),Ci&&(Pl=Tu(Ro,Jc,Fr,No,jo,Oo,Ci,Ts,Ma))}}if(jr){const za=Ti.layout.get("icon-rotate").evaluate(Xi,{},ks),Ma="none"!==Ti.layout.get("icon-text-fit"),Su=uf(jr,za,go,Ma),um=Ci?uf(Ci,za,go,Ma):void 0;Ia=Tu(Ro,Jc,Fr,No,jo,Oo,jr,Ts,za),py=4*Su.length;const ah=Xn.iconSizeData;let ec=null;"source"===ah.kind?(ec=[rl*Ti.layout.get("icon-size").evaluate(Xi,{},ks)],ec[0]>gc&&vn(`${Xn.layerIds[0]}: Value for "icon-size" is >= ${cd}. Reduce your "icon-size".`)):"composite"===ah.kind&&(ec=[rl*Ss.compositeIconSizes[0].evaluate(Xi,{},ks),rl*Ss.compositeIconSizes[1].evaluate(Xi,{},ks)],(ec[0]>gc||ec[1]>gc)&&vn(`${Xn.layerIds[0]}: Value for "icon-size" is >= ${cd}. Reduce your "icon-size".`)),Xn.addSymbols(Xn.icon,Su,ec,Yo,ts,Xi,!1,_i,Fr,Ls.lineStartIndex,Ls.lineLength,-1,xa,ks),lm=Xn.icon.placedSymbolArray.length-1,um&&(Vg=4*um.length,Xn.addSymbols(Xn.icon,um,ec,Yo,ts,Xi,il.vertical,_i,Fr,Ls.lineStartIndex,Ls.lineLength,-1,xa,ks),Cf=Xn.icon.placedSymbolArray.length-1)}for(const za in yi.horizontal){const Ma=yi.horizontal[za];ia||(jg=Ff(Ma.text),ms?Zc=hf(Ma):ia=Tu(Ro,Jc,Fr,No,jo,Oo,Ma,ls,Ti.layout.get("text-rotate").evaluate(Xi,{},ks),Os));const Su=1===Ma.positionedLines.length;if(Ug+=J_(Xn,_i,Fr,Ma,Uo,Ti,ms,Xi,Os,Ls,yi.vertical?il.horizontal:il.horizontalOnly,Su?Object.keys(yi.horizontal):[za],Ql,lm,Ss,xa,ks),Su)break}yi.vertical&&(Df+=J_(Xn,_i,Fr,yi.vertical,Uo,Ti,ms,Xi,Os,Ls,il.vertical,["vertical"],Ql,Cf,Ss,xa,ks));let Qc=-1;const cm=(za,Ma)=>za?Math.max(za,Ma):Ma;Qc=cm(Zc,Qc),Qc=cm(Xc,Qc),Qc=cm(Kc,Qc);const my=Qc>-1?1:0;Xn.glyphOffsetArray.length>=Hc.MAX_GLYPHS&&vn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Xi.sortKey&&Xn.addToSortKeyRanges(Xn.symbolInstances.length,Xi.sortKey),Xn.symbolInstances.emplaceBack(Jc.x,Jc.y,Jc.z,Fr.x,Fr.y,Ql.right>=0?Ql.right:-1,Ql.center>=0?Ql.center:-1,Ql.left>=0?Ql.left:-1,Ql.vertical>=0?Ql.vertical:-1,lm,Cf,jg,void 0!==ia?ia:Xn.collisionBoxArray.length,void 0!==ia?ia+1:Xn.collisionBoxArray.length,void 0!==oa?oa:Xn.collisionBoxArray.length,void 0!==oa?oa+1:Xn.collisionBoxArray.length,void 0!==Ia?Ia:Xn.collisionBoxArray.length,void 0!==Ia?Ia+1:Xn.collisionBoxArray.length,Pl||Xn.collisionBoxArray.length,Pl?Pl+1:Xn.collisionBoxArray.length,No,Ug,Df,py,Vg,my,0,Tf,Sf,Qc)}(n,vr,gi,ir,r,s,u,jn,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,Qe,xn,w,0,rn,Nn,se,e,f,E,O,z)};if("line"===on)for(const ir of mg(e.geometry,0,0,zr,zr)){const vr=Pv(ir,it,Ht,r.vertical||me,s,Xe,We,n.overscaling,zr);for(const sr of vr)me&&xg(n,me.text,Sn,sr)||gn(ir,sr,z)}else if("line-center"===on){for(const ir of e.geometry)if(ir.length>1){const vr=Y_(ir,Ht,r.vertical||me,s,Xe,We);vr&&gn(ir,vr,z)}}else if("Polygon"===e.type)for(const ir of Wh(e.geometry,0)){const vr=_g(ir,16);gn(ir[0],new $c(vr.x,vr.y,0,0,void 0),z)}else if("LineString"===e.type)for(const ir of e.geometry)gn(ir,new $c(ir[0].x,ir[0].y,0,0,void 0),z);else if("Point"===e.type)for(const ir of e.geometry)for(const vr of ir)gn([vr],new $c(vr.x,vr.y,0,0,void 0),z)}const cd=255,gc=cd*rl;function J_(n,e,r,s,u,f,g,y,w,E,O,z,U,q,J,se,me){const Pe=function(We,it,Qe,rn,Ht,xn,Nn,on){const Sn=[];if(0===it.positionedLines.length)return Sn;const In=rn.layout.get("text-rotate").evaluate(xn,{})*Math.PI/180,Fn=function(sr){const gi=sr[0],Xn=sr[1],Fr=gi*Xn;return Fr>0?[gi,-Xn]:Fr<0?[-gi,Xn]:0===gi?[Xn,gi]:[Xn,-gi]}(Qe);let jn=Math.abs(it.top-it.bottom);for(const sr of it.positionedLines)jn-=sr.lineOffset;const gn=it.positionedLines.length,ir=jn/gn;let vr=it.top-Qe[1];for(let sr=0;sr<gn;++sr){const gi=it.positionedLines[sr];vr=sd(it,ir,vr,sr);for(const Xn of gi.positionedGlyphs){if(!Xn.rect)continue;const Fr=Xn.rect||{};let _i=ug+1,Ji=!0,yi=1,jr=0;if(Xn.imageName){const go=Nn[Xn.imageName];if(!go)continue;if(go.sdf){vn("SDF images are not supported in formatted text and will be ignored.");continue}Ji=!1,yi=go.pixelRatio,_i=da/yi}const Uo=(Ht||on)&&Xn.vertical,Ci=Xn.metrics.advance*Xn.scale/2,Ti=Xn.metrics,Ro=Xn.rect;if(null===Ro)continue;on&&it.verticalizable&&(jr=Xn.imageName?Ci-Xn.metrics.width*Xn.scale/2:0);const No=Ht?[Xn.x+Ci,Xn.y]:[0,0];let jo=[0,0],Oo=[0,0],ls=!1;Ht||(Uo?(Oo=[Xn.x+Ci+Fn[0],Xn.y+Fn[1]-jr],ls=!0):jo=[Xn.x+Ci+Qe[0],Xn.y+Qe[1]-jr]);const ms=Ro.w*Xn.scale/(yi*(Xn.localGlyph?Sa:1)),Os=Ro.h*Xn.scale/(yi*(Xn.localGlyph?Sa:1));let ko,Ts,ts,Yo;if(Uo){const go=Xn.y-vr,xa=new Le(-Ci,Ci-go),ks=-Math.PI/2,Ls=new Le(...Oo);ko=new Le(-Ci+jo[0],jo[1]),ko._rotateAround(ks,xa)._add(Ls),ko.x+=-go+Ci,ko.y-=(Ti.left-_i)*Xn.scale;const ia=Xn.imageName?Ti.advance*Xn.scale:Ks*Xn.scale,Ia=String.fromCharCode(Xn.glyph);ag(Ia)?ko.x+=(1-_i)*Xn.scale:Cp(Ia)?ko.x+=ia-Ti.height*Xn.scale+(-_i-1)*Xn.scale:ko.x+=Xn.imageName||Ti.width+2*_i===Ro.w&&Ti.height+2*_i===Ro.h?(ia-Os)/2:(ia-(Ti.height+2*_i)*Xn.scale)/2,Ts=new Le(ko.x,ko.y-ms),ts=new Le(ko.x+Os,ko.y),Yo=new Le(ko.x+Os,ko.y-ms)}else{const go=(Ti.left-_i)*Xn.scale-Ci+jo[0],xa=(-Ti.top-_i)*Xn.scale+jo[1],ks=go+ms,Ls=xa+Os;ko=new Le(go,xa),Ts=new Le(ks,xa),ts=new Le(go,Ls),Yo=new Le(ks,Ls)}if(In){let go;go=Ht?new Le(0,0):ls?new Le(Fn[0],Fn[1]):new Le(Qe[0],Qe[1]),ko._rotateAround(In,go),Ts._rotateAround(In,go),ts._rotateAround(In,go),Yo._rotateAround(In,go)}const Xi=new Le(0,0),Ss=new Le(0,0);Sn.push({tl:ko,tr:Ts,bl:ts,br:Yo,tex:Fr,writingMode:it.writingMode,glyphOffset:No,sectionIndex:Xn.sectionIndex,isSDF:Ji,pixelOffsetTL:Xi,pixelOffsetBR:Ss,minFontScaleX:0,minFontScaleY:0})}}return Sn}(0,s,w,f,g,y,u,n.allowVerticalPlacement),Xe=n.textSizeData;let Ae=null;"source"===Xe.kind?(Ae=[rl*f.layout.get("text-size").evaluate(y,{},me)],Ae[0]>gc&&vn(`${n.layerIds[0]}: Value for "text-size" is >= ${cd}. Reduce your "text-size".`)):"composite"===Xe.kind&&(Ae=[rl*J.compositeTextSizes[0].evaluate(y,{},me),rl*J.compositeTextSizes[1].evaluate(y,{},me)],(Ae[0]>gc||Ae[1]>gc)&&vn(`${n.layerIds[0]}: Value for "text-size" is >= ${cd}. Reduce your "text-size".`)),n.addSymbols(n.text,Pe,Ae,w,g,y,O,e,r,E.lineStartIndex,E.lineLength,q,se,me);for(const We of z)U[We]=n.text.placedSymbolArray.length-1;return 4*Pe.length}function Gp(n){for(const e in n)return n[e];return null}function Tu(n,e,r,s,u,f,g,y,w,E){let O=g.top,z=g.bottom,U=g.left,q=g.right;const J=g.collisionPadding;if(J&&(U-=J[0],O-=J[1],q+=J[2],z+=J[3]),w){const se=new Le(U,O),me=new Le(q,O),Pe=new Le(U,z),Xe=new Le(q,z),Ae=De(w);let We=new Le(0,0);E&&(We=new Le(E[0],E[1])),se._rotateAround(Ae,We),me._rotateAround(Ae,We),Pe._rotateAround(Ae,We),Xe._rotateAround(Ae,We),U=Math.min(se.x,me.x,Pe.x,Xe.x),q=Math.max(se.x,me.x,Pe.x,Xe.x),O=Math.min(se.y,me.y,Pe.y,Xe.y),z=Math.max(se.y,me.y,Pe.y,Xe.y)}return n.emplaceBack(e.x,e.y,e.z,r.x,r.y,U,O,q,z,y,s,u,f),n.length-1}function hf(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function xg(n,e,r,s){const u=n.compareText;if(e in u){const f=u[e];for(let g=f.length-1;g>=0;g--)if(s.dist(f[g])<r)return!0}else u[e]=[];return u[e].push(s),!1}function Wp(n,e){const r=n.fovAboveCenter,s=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,u=(n._camera.position[2]*n.worldSize-s)/Math.cos(n._pitch),f=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-n._pitch-r,.01)),g=Math.sin(n._pitch)*f+u;return Math.min(1.01*g,u*(1/n._horizonShift))}function wi(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const r=Math.pow(2,-n.z),s=n.x*r,u=(n.x+1)*r,f=n.y*r,g=(n.y+1)*r,y=nl(s),w=nl(u),E=_a(f),O=_a(g),z=e.project(y,E),U=e.project(w,E),q=e.project(w,O),J=e.project(y,O);let se=Math.min(z.x,U.x,q.x,J.x),me=Math.min(z.y,U.y,q.y,J.y),Pe=Math.max(z.x,U.x,q.x,J.x),Xe=Math.max(z.y,U.y,q.y,J.y);const Ae=r/16;function We(Qe,rn,Ht,xn,Nn,on){const Sn=(Ht+Nn)/2,In=(xn+on)/2,Fn=e.project(nl(Sn),_a(In)),jn=Math.max(0,se-Fn.x,me-Fn.y,Fn.x-Pe,Fn.y-Xe);se=Math.min(se,Fn.x),Pe=Math.max(Pe,Fn.x),me=Math.min(me,Fn.y),Xe=Math.max(Xe,Fn.y),jn>Ae&&(We(Qe,Fn,Ht,xn,Sn,In),We(Fn,rn,Sn,In,Nn,on))}We(z,U,s,f,u,f),We(U,q,u,f,u,g),We(q,J,u,g,s,g),We(J,z,s,g,s,f),se-=Ae,me-=Ae,Pe+=Ae,Xe+=Ae;const it=1/Math.max(Pe-se,Xe-me);return{scale:it,x:se*it,y:me*it,x2:Pe*it,y2:Xe*it,projection:e}}const bg=ul(new Float32Array(16));class _c{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new po(0,0)}projectTilePoint(e,r,s){return{x:e,y:r,z:0}}locationPoint(e,r,s=!0){return e._coordinatePoint(e.locationCoordinate(r),s)}pixelsPerMeter(e,r){return Il(1,e)*r}pixelSpaceConversion(e,r,s){return 1}farthestPixelDistance(e){return Wp(e,e.pixelsPerMeter)}pointCoordinate(e,r,s,u){const f=e.horizonLineFromTop(!1),g=new Le(r,Math.max(f,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(g,u))}pointCoordinate3D(e,r,s){const u=new Le(r,s);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const s=e.horizonLineFromTop();return r.y<s}createInversionMatrix(e,r){return bg}createTileMatrix(e,r,s){let u,f,g;const y=s.canonical,w=ul(new Float64Array(16));if(this.isReprojectedInTileSpace){const E=wi(y,this);u=1,f=E.x+s.wrap*E.scale,g=E.y,Sl(w,w,[u/E.scale,u/E.scale,e.pixelsPerMeter/r])}else u=r/e.zoomScale(y.z),f=(y.x+Math.pow(2,y.z)*s.wrap)*u,g=y.y*u;return $l(w,w,[f,g,0]),Sl(w,w,[u/zr,u/zr,1]),w}upVector(e,r,s){return[0,0,1]}upVectorScale(e,r,s){return{metersToTile:1}}}class ud extends _c{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,s]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(De(r));this.n=(u+Math.sin(De(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n:s,c:u,r0:f}=this,g=De(e-this.center[0]),y=De(r),w=Math.sqrt(u-2*s*Math.sin(y))/s;return{x:w*Math.sin(g*s),y:w*Math.cos(g*s)-f,z:0}}unproject(e,r){const{n:s,c:u,r0:f}=this,g=f+r;let y=Math.atan2(e,Math.abs(g))*Math.sign(g);g*s<0&&(y-=Math.PI*Math.sign(e)*Math.sign(g));const w=De(this.center[0])*s;y=Wt(y,-Math.PI-w,Math.PI-w);const E=Gt(ft(y/s)+this.center[0],-180,180),O=Math.asin(Gt((u-(e*e+g*g)*s*s)/(2*s),-1,1)),z=Gt(ft(O),-Xs,Xs);return new po(E,z)}}const dd=1.340264,Zd=-.081106,Uc=893e-6,Zl=.003796,hd=Math.sqrt(3)/2;class Xd extends _c{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(hd*Math.sin(r)),u=s*s,f=u*u*u;return{x:.5*(e*Math.cos(s)/(hd*(dd+3*Zd*u+f*(7*Uc+9*Zl*u)))/Math.PI+.5),y:1-.5*(s*(dd+Zd*u+f*(Uc+Zl*u))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=s*s,f=u*u*u;for(let O,z,U,q=0;q<12&&(z=s*(dd+Zd*u+f*(Uc+Zl*u))-r,U=dd+3*Zd*u+f*(7*Uc+9*Zl*u),O=z/U,s=Gt(s-O,-Math.PI/3,Math.PI/3),u=s*s,f=u*u*u,!(Math.abs(O)<1e-12));++q);const g=hd*e*(dd+3*Zd*u+f*(7*Uc+9*Zl*u))/Math.cos(s),y=Math.asin(Math.sin(s)/hd),w=Gt(180*g/Math.PI,-180,180),E=Gt(180*y/Math.PI,-Xs,Xs);return new po(w,E)}}class wg extends _c{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const s=360*(e-.5),u=Gt(360*(.5-r),-Xs,Xs);return new po(s,u)}}const jc=Math.PI/2;function fd(n){return Math.tan((jc+n)/2)}class qp extends _c{constructor(e){super(e),this.center=e.center||[0,30];const[r,s]=this.parallels=e.parallels||[30,30];let u=De(r),f=De(s);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const g=Math.cos(u),y=fd(u);this.n=u===f?Math.sin(u):Math.log(g/Math.cos(f))/Math.log(fd(f)/y),this.f=g*Math.pow(fd(u),this.n)/this.n}project(e,r){r=De(r),this.southernCenter&&(r=-r),e=De(e-this.center[0]);const s=1e-6,{n:u,f}=this;f>0?r<-jc+s&&(r=-jc+s):r>jc-s&&(r=jc-s);const g=f/Math.pow(fd(r),u);let y=g*Math.sin(u*e),w=f-g*Math.cos(u*e);return y=.5*(y/Math.PI+.5),w=.5*(w/Math.PI+.5),{x:y,y:this.southernCenter?w:1-w,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:s,f:u}=this,f=u-r,g=Math.sign(f),y=Math.sign(s)*Math.sqrt(e*e+f*f);let w=Math.atan2(e,Math.abs(f))*g;f*s<0&&(w-=Math.PI*Math.sign(e)*g);const E=Gt(ft(w/s)+this.center[0],-180,180),O=Gt(ft(2*Math.atan(Math.pow(u/y,1/s))-jc),-Xs,Xs);return new po(E,this.southernCenter?-O:O)}}class Yp extends _c{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:Wl(e),y:ql(r),z:0}}unproject(e,r){const s=nl(e),u=_a(r);return new po(s,u)}}const ff=De(Xs);class Q_ extends _c{project(e,r){const s=(r=De(r))*r,u=s*s;return{x:.5*((e=De(e))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=25,f=0,g=s*s;do{g=s*s;const E=g*g;f=(s*(1.007226+g*(.015085+E*(.028874*g-.044475-.005916*E)))-r)/(1.007226+g*(.045255+E*(.259866*g-.311325-.005916*11*E))),s=Gt(s-f,-ff,ff)}while(Math.abs(f)>1e-6&&--u>0);g=s*s;const y=Gt(ft(e/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),w=ft(s);return new po(y,w)}}const Eg=De(Xs);class ey extends _c{project(e,r){r=De(r),e=De(e);const s=Math.cos(r),u=2/Math.PI,f=Math.acos(s*Math.cos(e/2)),g=Math.sin(f)/f,y=.5*(e*u+2*s*Math.sin(e/2)/g)||0,w=.5*(r+Math.sin(r)/g)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(w/Math.PI+1),z:0}}unproject(e,r){let s=e=(2*e-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,f=25;const g=1e-6;let y=0,w=0;do{const E=Math.cos(u),O=Math.sin(u),z=2*O*E,U=O*O,q=E*E,J=Math.cos(s/2),se=Math.sin(s/2),me=2*J*se,Pe=se*se,Xe=1-q*J*J,Ae=Xe?1/Xe:0,We=Xe?Math.acos(E*J)*Math.sqrt(1/Xe):0,it=.5*(2*We*E*se+2*s/Math.PI)-e,Qe=.5*(We*O+u)-r,rn=.5*Ae*(q*Pe+We*E*J*U)+1/Math.PI,Ht=Ae*(me*z/4-We*O*se),xn=.125*Ae*(z*se-We*O*q*me),Nn=.5*Ae*(U*J+We*Pe*E)+.5,on=Ht*xn-Nn*rn;y=(Qe*Ht-it*Nn)/on,w=(it*xn-Qe*rn)/on,s=Gt(s-y,-Math.PI,Math.PI),u=Gt(u-w,-Eg,Eg)}while((Math.abs(y)>g||Math.abs(w)>g)&&--f>0);return new po(ft(s),ft(u))}}class Zp extends _c{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(De(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:s,cosPhi:u}=this;return{x:De(e)*u*s+.5,y:-Math.sin(De(r))/u*s+.5,z:0}}unproject(e,r){const{scale:s,cosPhi:u}=this,f=-(r-.5)/s,g=Gt(ft((e-.5)/s)/u,-180,180),y=Math.asin(Gt(f*u,-1,1)),w=Gt(ft(y),-Xs,Xs);return new po(g,w)}}class ty extends Yp{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,s){const u=Id(e,r,s);return Ps(u,u,mu(Ga(s))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,r){const s=pu(r.lat,r.lng),u=Ca([],s),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude;Cd(s,s,u,Il(1,0)*zr*f);const g=ul(new Float64Array(16));return hu(g,e.pixelMatrix,e.globeMatrix),Ps(s,s,g),new Le(s[0],s[1])}pixelsPerMeter(e,r){return Il(1,0)*r}pixelSpaceConversion(e,r,s){const u=Il(1,e)*r,f=K(Il(1,45)*r,u,s);return this.pixelsPerMeter(e,r)/f}createTileMatrix(e,r,s){const u=tp(Ga(s.canonical));return hu(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,r){const{center:s}=e,u=mu(Ga(r));return Vf(u,u,De(s.lng)),$f(u,u,De(s.lat)),Sl(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,r,s,u){return Jf(e,r,s,!0)||new Pc(0,0)}pointCoordinate3D(e,r,s){const u=this.pointCoordinate(e,r,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,r){return!Jf(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(u,f){const g=u.cameraToCenterDistance,y=u._centerAltitude*f,w=u._camera,E=u._camera.forward(),O=Vl([],dl([],E,-g),[0,0,y]),z=u.worldSize/(2*Math.PI),U=[0,0,-z],q=u.width/u.height,J=Math.tan(u.fovAboveCenter),se=dl([],w.up(),J),me=dl([],w.right(),J*q),Pe=Ca([],Vl([],Vl([],E,se),me)),Xe=[];let Ae;if(new Nu(O,Pe).closestPointOnSphere(U,z,Xe)){const We=Vl([],Xe,U),it=Ul([],We,O);Ae=Math.cos(u.fovAboveCenter)*Dd(it)}else{const We=Ul([],O,U),it=Ul([],U,O);Ca(it,it);const Qe=Dd(We)-z;Ae=Math.sqrt(Qe*(Qe+2*z));const rn=Math.acos(Ae/(z+Qe))-Math.acos(ja(E,it));Ae*=Math.cos(rn)}return 1.01*Ae}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=ju(e.zoom);if(s>0){const u=Wp(e,Il(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),g=Math.max(e.width,e.height)/e.worldSize*Math.PI;return K(r,u+f*(1-Math.cos(g)),Math.pow(s,10))}return r}upVector(e,r,s){return Id(r,s,e,1)}upVectorScale(e){return{metersToTile:$u(Ih(Ga(e)))}}}function Dg(n){const e=n.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new Yp(n);case"equirectangular":return new wg(n);case"naturalEarth":return new Q_(n);case"equalEarth":return new Xd(n);case"winkelTripel":return new ey(n);case"albers":return r?new Zp(n):new ud(n);case"lambertConformalConic":return r?new Zp(n):new qp(n);case"globe":return new ty(n)}throw new Error(`Invalid projection name: ${n.name}`)}const ny=kc.types,ry=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kd(n,e,r,s,u,f,g,y,w,E,O,z,U){const q=y?Math.min(gc,Math.round(y[0])):0,J=y?Math.min(gc,Math.round(y[1])):0;n.emplaceBack(e,r,Math.round(32*s),Math.round(32*u),f,g,(q<<1)+(w?1:0),J,16*E,16*O,256*z,256*U)}function Jd(n,e,r,s,u,f,g){n.emplaceBack(e,r,s,u,f,g)}function pf(n,e,r,s,u){n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u)}function iy(n){for(const e of n.sections)if(Bl(e.text))return!0;return!1}class Na{constructor(e){this.layoutVertexArray=new kn,this.indexArray=new wr,this.programConfigurations=e,this.segments=new as,this.dynamicLayoutVertexArray=new Bn,this.opacityVertexArray=new Or,this.placedSymbolArray=new ps,this.globeExtVertexArray=new Yn}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,r,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,F_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,N_.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ry,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,B_.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}$(Na,"SymbolBuffers");class Xp{constructor(e,r,s){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new s,this.segments=new as,this.collisionVertexArray=new ki,this.collisionVertexArrayExt=new Di}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Tv.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Sv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$(Xp,"CollisionBuffers");class Hc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ul([]),this.placementViewportMatrix=ul([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fc(this.zoom,r["text-size"]),this.iconSizeData=Fc(this.zoom,r["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==f&&void 0!==u.constantOr(1),this.sortFeaturesByY=("viewport-y"===f||"auto"===f&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(g=>il[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Na(new Sc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Na(new Sc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ys,this.lineVertexArray=new cu,this.symbolInstances=new wo}calculateGlyphDependencies(e,r,s,u,f){for(let g=0;g<e.length;g++)if(r[e.charCodeAt(g)]=!0,u&&f){const y=pc[e.charAt(g)];y&&(r[y.charCodeAt(0)]=!0)}}populate(e,r,s,u){const f=this.layers[0],g=f.layout,y="globe"===this.projection.name,w=g.get("text-font"),E=g.get("text-field"),O=g.get("icon-image"),z=("constant"!==E.value.kind||E.value.value instanceof Gr&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==w.value.kind||w.value.value.length>0),U="constant"!==O.value.kind||!!O.value.value||Object.keys(O.parameters).length>0,q=g.get("symbol-sort-key");if(this.features=[],!z&&!U)return;const J=r.iconDependencies,se=r.glyphDependencies,me=r.availableImages,Pe=new N(this.zoom);for(const{feature:Xe,id:Ae,index:We,sourceLayerIndex:it}of e){const Qe=f._featureFilter.needGeometry,rn=Gu(Xe,Qe);if(!f._featureFilter.filter(Pe,rn,s))continue;if(Qe||(rn.geometry=uc(Xe,s,u)),y&&1!==Xe.type&&s.z<=5){const on=rn.geometry,Sn=.98078528056,In=(Fn,jn)=>ja(Id(Fn.x,Fn.y,s,1),Id(jn.x,jn.y,s,1))<Sn;for(let Fn=0;Fn<on.length;Fn++)on[Fn]=Fm(on[Fn],In)}let Ht,xn;if(z){const on=f.getValueAndResolveTokens("text-field",rn,s,me),Sn=Gr.factory(on);iy(Sn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===x()||this.hasRTLText&&A.isParsed())&&(Ht=tf(Sn,f,rn))}if(U){const on=f.getValueAndResolveTokens("icon-image",rn,s,me);xn=on instanceof Ii?on:Ii.fromString(on)}if(!Ht&&!xn)continue;const Nn=this.sortFeaturesByKey?q.evaluate(rn,{},s):void 0;if(this.features.push({id:Ae,text:Ht,icon:xn,index:We,sourceLayerIndex:it,geometry:rn.geometry,properties:Xe.properties,type:ny[Xe.type],sortKey:Nn}),xn&&(J[xn.name]=!0),Ht){const on=w.evaluate(rn,{},s).join(","),Sn="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(il.vertical)>=0;for(const In of Ht.sections)if(In.image)J[In.image.name]=!0;else{const Fn=Rn(Ht.toString()),jn=In.fontStack||on,gn=se[jn]=se[jn]||{};this.calculateGlyphDependencies(In.text,gn,Sn,this.allowVerticalPlacement,Fn)}}}"line"===g.get("symbol-placement")&&(this.features=function(Xe){const Ae={},We={},it=[];let Qe=0;function rn(on){it.push(Xe[on]),Qe++}function Ht(on,Sn,In){const Fn=We[on];return delete We[on],We[Sn]=Fn,it[Fn].geometry[0].pop(),it[Fn].geometry[0]=it[Fn].geometry[0].concat(In[0]),Fn}function xn(on,Sn,In){const Fn=Ae[Sn];return delete Ae[Sn],Ae[on]=Fn,it[Fn].geometry[0].shift(),it[Fn].geometry[0]=In[0].concat(it[Fn].geometry[0]),Fn}function Nn(on,Sn,In){const Fn=In?Sn[0][Sn[0].length-1]:Sn[0][0];return`${on}:${Fn.x}:${Fn.y}`}for(let on=0;on<Xe.length;on++){const Sn=Xe[on],In=Sn.geometry,Fn=Sn.text?Sn.text.toString():null;if(!Fn){rn(on);continue}const jn=Nn(Fn,In),gn=Nn(Fn,In,!0);if(jn in We&&gn in Ae&&We[jn]!==Ae[gn]){const ir=xn(jn,gn,In),vr=Ht(jn,gn,it[ir].geometry);delete Ae[jn],delete We[gn],We[Nn(Fn,it[vr].geometry,!0)]=vr,it[ir].geometry=null}else jn in We?Ht(jn,gn,In):gn in Ae?xn(jn,gn,In):(rn(on),Ae[jn]=Qe-1,We[gn]=Qe-1)}return it.filter(on=>on.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Xe,Ae)=>Xe.sortKey-Ae.sortKey)}update(e,r,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,s,u),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,s,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Dg(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const s=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:u,y:f}of r)this.lineVertexArray.emplaceBack(u,f);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,r,s,u,f,g,y,w,E,O,z,U,q,J){const se=e.indexArray,me=e.layoutVertexArray,Pe=e.globeExtVertexArray,Xe=e.segments.prepareSegment(4*r.length,me,se,this.canOverlap?g.sortKey:void 0),Ae=this.glyphOffsetArray.length,We=Xe.vertexLength,it=this.allowVerticalPlacement&&y===il.vertical?Math.PI/2:0,Qe=g.text&&g.text.sections;for(let Ht=0;Ht<r.length;Ht++){const{tl:xn,tr:Nn,bl:on,br:Sn,tex:In,pixelOffsetTL:Fn,pixelOffsetBR:jn,minFontScaleX:gn,minFontScaleY:ir,glyphOffset:vr,isSDF:sr,sectionIndex:gi}=r[Ht],Xn=Xe.vertexLength,Fr=vr[1];if(Kd(me,E.x,E.y,xn.x,Fr+xn.y,In.x,In.y,s,sr,Fn.x,Fn.y,gn,ir),Kd(me,E.x,E.y,Nn.x,Fr+Nn.y,In.x+In.w,In.y,s,sr,jn.x,Fn.y,gn,ir),Kd(me,E.x,E.y,on.x,Fr+on.y,In.x,In.y+In.h,s,sr,Fn.x,jn.y,gn,ir),Kd(me,E.x,E.y,Sn.x,Fr+Sn.y,In.x+In.w,In.y+In.h,s,sr,jn.x,jn.y,gn,ir),w){const{x:_i,y:Ji,z:yi}=w.anchor,[jr,Uo,Ci]=w.up;Jd(Pe,_i,Ji,yi,jr,Uo,Ci),Jd(Pe,_i,Ji,yi,jr,Uo,Ci),Jd(Pe,_i,Ji,yi,jr,Uo,Ci),Jd(Pe,_i,Ji,yi,jr,Uo,Ci),pf(e.dynamicLayoutVertexArray,_i,Ji,yi,it)}else pf(e.dynamicLayoutVertexArray,E.x,E.y,E.z,it);se.emplaceBack(Xn,Xn+1,Xn+2),se.emplaceBack(Xn+1,Xn+2,Xn+3),Xe.vertexLength+=4,Xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vr[0]),Ht!==r.length-1&&gi===r[Ht+1].sectionIndex||e.programConfigurations.populatePaintArrays(me.length,g,g.index,{},q,J,Qe&&Qe[gi])}const rn=w?w.anchor:E;e.placedSymbolArray.emplaceBack(rn.x,rn.y,rn.z,E.x,E.y,Ae,this.glyphOffsetArray.length-Ae,We,O,z,E.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],y,0,!1,0,U,0)}_commitLayoutVertex(e,r,s,u,f,g,y){e.emplaceBack(r,s,u,f,g,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,r,s,u,f,g,y){const w=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),E=w.vertexLength,O=y.tileAnchorX,z=y.tileAnchorY;for(let q=0;q<4;q++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,O,z,new Le(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,O,z,new Le(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,O,z,new Le(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,O,z,new Le(e.x1,e.y2)),w.vertexLength+=4;const U=s.indexArray;U.emplaceBack(E,E+1),U.emplaceBack(E+1,E+2),U.emplaceBack(E+2,E+3),U.emplaceBack(E+3,E),w.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,s,u,f,g){for(let y=u;y<f;y++){const w=s.get(y),E=this.getSymbolInstanceTextSize(e,g,r,y);this._addCollisionDebugVertices(w,E,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,r,s,u,f,g){for(let y=u;y<f;y++){const w=s.get(y),E=this.getSymbolInstanceIconSize(e,r,g.placedIconSymbolIndex);this._addCollisionDebugVertices(w,E,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xp(yr,Hd.members,bo),this.iconCollisionBox=new Xp(yr,Hd.members,bo);const s=Bc(this.iconSizeData,e),u=Bc(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,r,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(u,e,r,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(s,e,r,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(s,e,r,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(e,r,s,u){const f=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),g=ed(this.textSizeData,e,f)/Ks;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,r,s){const u=this.icon.placedSymbolArray.get(s),f=ed(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,r,s){e.emplaceBack(r,-s,-s),e.emplaceBack(r,s,-s),e.emplaceBack(r,s,s),e.emplaceBack(r,-s,s)}_updateTextDebugCollisionBoxes(e,r,s,u,f,g){for(let y=u;y<f;y++){const w=s.get(y),E=this.getSymbolInstanceTextSize(e,g,r,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,w.padding)}}_updateIconDebugCollisionBoxes(e,r,s,u,f,g){for(let y=u;y<f;y++){const w=s.get(y),E=this.getSymbolInstanceIconSize(e,r,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,E,w.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Bc(this.iconSizeData,e),u=Bc(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,r,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(u,e,r,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(s,e,r,g.iconBoxStartIndex,g.iconBoxEndIndex,g.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,r,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,s,u,f,g,y,w,E){const O={};if(r<s){const{x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We,featureIndex:it}=e.get(r);O.textBox={x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We},O.textFeatureIndex=it}if(u<f){const{x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We,featureIndex:it}=e.get(u);O.verticalTextBox={x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We},O.verticalTextFeatureIndex=it}if(g<y){const{x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We,featureIndex:it}=e.get(g);O.iconBox={x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We},O.iconFeatureIndex=it}if(w<E){const{x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We,featureIndex:it}=e.get(w);O.verticalIconBox={x1:z,y1:U,x2:q,y2:J,padding:se,projectedAnchorX:me,projectedAnchorY:Pe,projectedAnchorZ:Xe,tileAnchorX:Ae,tileAnchorY:We},O.verticalIconFeatureIndex=it}return O}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const s=e.placedSymbolArray.get(r),u=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const r=Math.sin(e),s=Math.cos(e),u=[],f=[],g=[];for(let y=0;y<this.symbolInstances.length;++y){g.push(y);const w=this.symbolInstances.get(y);u.push(0|Math.round(r*w.tileAnchorX+s*w.tileAnchorY)),f.push(w.featureIndex)}return g.sort((y,w)=>u[y]-u[w]||f[w]-f[y]),g}addToSortKeyRanges(e,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:y,placedIconSymbolIndex:w,verticalPlacedIconSymbolIndex:E}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),f>=0&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&g!==u&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$(Hc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Hc.MAX_GLYPHS=65535,Hc.addDynamicAttributes=pf;const Ov=new $e({"symbol-placement":new ie(zt.layout_symbol["symbol-placement"]),"symbol-spacing":new ie(zt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ie(zt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ve(zt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ie(zt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ie(zt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ie(zt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ie(zt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ie(zt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ve(zt.layout_symbol["icon-size"]),"icon-text-fit":new ie(zt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ie(zt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ve(zt.layout_symbol["icon-image"]),"icon-rotate":new ve(zt.layout_symbol["icon-rotate"]),"icon-padding":new ie(zt.layout_symbol["icon-padding"]),"icon-keep-upright":new ie(zt.layout_symbol["icon-keep-upright"]),"icon-offset":new ve(zt.layout_symbol["icon-offset"]),"icon-anchor":new ve(zt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ie(zt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ie(zt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ie(zt.layout_symbol["text-rotation-alignment"]),"text-field":new ve(zt.layout_symbol["text-field"]),"text-font":new ve(zt.layout_symbol["text-font"]),"text-size":new ve(zt.layout_symbol["text-size"]),"text-max-width":new ve(zt.layout_symbol["text-max-width"]),"text-line-height":new ve(zt.layout_symbol["text-line-height"]),"text-letter-spacing":new ve(zt.layout_symbol["text-letter-spacing"]),"text-justify":new ve(zt.layout_symbol["text-justify"]),"text-radial-offset":new ve(zt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ie(zt.layout_symbol["text-variable-anchor"]),"text-anchor":new ve(zt.layout_symbol["text-anchor"]),"text-max-angle":new ie(zt.layout_symbol["text-max-angle"]),"text-writing-mode":new ie(zt.layout_symbol["text-writing-mode"]),"text-rotate":new ve(zt.layout_symbol["text-rotate"]),"text-padding":new ie(zt.layout_symbol["text-padding"]),"text-keep-upright":new ie(zt.layout_symbol["text-keep-upright"]),"text-transform":new ve(zt.layout_symbol["text-transform"]),"text-offset":new ve(zt.layout_symbol["text-offset"]),"text-allow-overlap":new ie(zt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ie(zt.layout_symbol["text-ignore-placement"]),"text-optional":new ie(zt.layout_symbol["text-optional"])});var Qd={paint:new $e({"icon-opacity":new ve(zt.paint_symbol["icon-opacity"]),"icon-color":new ve(zt.paint_symbol["icon-color"]),"icon-halo-color":new ve(zt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ve(zt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ve(zt.paint_symbol["icon-halo-blur"]),"icon-translate":new ie(zt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ie(zt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ve(zt.paint_symbol["text-opacity"]),"text-color":new ve(zt.paint_symbol["text-color"],{runtimeType:Oe,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new ve(zt.paint_symbol["text-halo-color"]),"text-halo-width":new ve(zt.paint_symbol["text-halo-width"]),"text-halo-blur":new ve(zt.paint_symbol["text-halo-blur"]),"text-translate":new ie(zt.paint_symbol["text-translate"]),"text-translate-anchor":new ie(zt.paint_symbol["text-translate-anchor"])}),layout:Ov};class Kp{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:yo,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$(Kp,"FormatSectionOverride",{omit:["defaultValue"]});class mf extends tl{constructor(e){super(e,Qd)}recalculate(e,r){super.recalculate(e,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const f of s)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,s,u){const f=this.layout.get(e).evaluate(r,{},s,u),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||uo(g.value)||!f?f:(y=r.properties,f.replace(/{([^{}]+)}/g,(E,O)=>O in y?String(y[O]):""));var y}createBucket(e){return new Hc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Qd.paint.overridableProperties){if(!mf.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),s=new Kp(r),u=new Ws(s,r.property.specification);let f=null;f="constant"===r.value.kind||"source"===r.value.kind?new Yi("source",u):new zs("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new Te(r.property,f,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&mf.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const s=e.get("text-field"),u=Qd.paint.properties[r];let f=!1;const g=y=>{for(const w of y)if(u.overrides&&u.overrides.hasOverride(w))return void(f=!0)};if("constant"===s.value.kind&&s.value.value instanceof Gr)g(s.value.value.sections);else if("source"===s.value.kind){const y=E=>{f||(E instanceof Is&&xi(E.value)===Pt?g(E.value.sections):E instanceof Rr?g(E.sections):E.eachChild(y))},w=s.value;w._styleExpression&&y(w._styleExpression.expression)}return f}getProgramConfiguration(e){return new du(this,e)}}var oy={paint:new $e({"background-color":new ie(zt.paint_background["background-color"]),"background-pattern":new ie(zt.paint_background["background-pattern"]),"background-opacity":new ie(zt.paint_background["background-opacity"])})},sy={paint:new $e({"raster-opacity":new ie(zt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ie(zt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ie(zt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ie(zt.paint_raster["raster-brightness-max"]),"raster-saturation":new ie(zt.paint_raster["raster-saturation"]),"raster-contrast":new ie(zt.paint_raster["raster-contrast"]),"raster-resampling":new ie(zt.paint_raster["raster-resampling"]),"raster-fade-duration":new ie(zt.paint_raster["raster-fade-duration"])})};class Cg extends tl{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var ay={paint:new $e({"sky-type":new ie(zt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ie(zt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ie(zt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ie(zt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ie(zt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ne(zt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ie(zt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ie(zt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ie(zt.paint_sky["sky-opacity"])})};function Jp(n,e,r){const s=[0,0,1],u=Wf([]);return Yf(u,u,r?-De(n)+Math.PI:De(n)),qf(u,u,-De(e)),wh(s,s,u),Ca(s,s)}const Qp={circle:class extends tl{constructor(n){super(n,Um)}createBucket(n){return new Oh(n)}queryRadius(n){const e=n;return qu("circle-radius",this,e)+qu("circle-stroke-width",this,e)+Od(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,r,s,u,f,g,y){const w=Vm(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),E=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return cp(n,s,f,g,y,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),w,E)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new du(this,n)}},heatmap:class extends tl{createBucket(n){return new jm(n)}constructor(n){super(n,$h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"heatmap-color"===n&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ld({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return qu("heatmap-radius",this,n)}queryIntersectsFeature(n,e,r,s,u,f,g,y){const w=this.paint.get("heatmap-radius").evaluate(e,r);return cp(n,s,f,g,y,!0,!0,new Le(0,0),w)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new du(this,n)}},hillshade:class extends tl{constructor(n){super(n,Gm)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends tl{constructor(n){super(n,Yh)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(n){return new du(this,n)}recalculate(n,e){super.recalculate(n,e);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new qh(n)}queryRadius(){return Od(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,r,s,u,f){return!n.queryGeometry.isAboveHorizon&&kh($m(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends tl{constructor(n){super(n,wp)}createBucket(n){return new Ju(n)}queryRadius(){return Od(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new du(this,n)}queryIntersectsFeature(n,e,r,s,u,f,g,y,w){const E=Vm(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(e,r),z=this.paint.get("fill-extrusion-base").evaluate(e,r),U=[0,0],q=y&&f.elevation,J=f.elevation?f.elevation.exaggeration():1,se=n.tile.getBucket(this);if(q&&se instanceof Ju){const We=se.centroidVertexArray,it=w+1;it<We.length&&(U[0]=We.geta_centroid_pos0(it),U[1]=We.geta_centroid_pos1(it))}if(0===U[0]&&1===U[1])return!1;"globe"===f.projection.name&&(s=Lc([s],[new Le(0,0),new Le(zr,zr)],n.tileID.canonical).map(We=>We.polygon).flat());const me=q?y:null,[Pe,Xe]=(it=s,Qe=z,rn=O,Ht=E,xn=g,Nn=me,on=U,Sn=J,In=f.center.lat,"globe"===(We=f).projection.name?function(jn,gn,ir,vr,sr,gi,Xn,Fr,_i,Ji,yi){const jr=[],Uo=[],Ci=jn.projection.upVectorScale(yi,jn.center.lat,jn.worldSize).metersToTile,Ti=[0,0,0,1],Ro=[0,0,0,1],No=(Oo,ls,ms,Os)=>{Oo[0]=ls,Oo[1]=ms,Oo[2]=Os,Oo[3]=1},jo=bp();ir>0&&(ir+=jo),vr+=jo;for(const Oo of gn){const ls=[],ms=[];for(const Os of Oo){const ko=Os.x+sr.x,Ts=Os.y+sr.y,ts=jn.projection.projectTilePoint(ko,Ts,yi),Yo=jn.projection.upVector(yi,Os.x,Os.y);let Xi=ir,Ss=vr;if(Xn){const go=og(ko,Ts,ir,vr,Xn,Fr,_i,Ji);Xi+=go.base,Ss+=go.top}0!==ir?No(Ti,ts.x+Yo[0]*Ci*Xi,ts.y+Yo[1]*Ci*Xi,ts.z+Yo[2]*Ci*Xi):No(Ti,ts.x,ts.y,ts.z),No(Ro,ts.x+Yo[0]*Ci*Ss,ts.y+Yo[1]*Ci*Ss,ts.z+Yo[2]*Ci*Ss),Ps(Ti,Ti,gi),Ps(Ro,Ro,gi),ls.push(new fc(Ti[0],Ti[1],Ti[2])),ms.push(new fc(Ro[0],Ro[1],Ro[2]))}jr.push(ls),Uo.push(ms)}return[jr,Uo]}(We,it,Qe,rn,Ht,xn,Nn,on,Sn,In,n.tileID.canonical):Nn?function(jn,gn,ir,vr,sr,gi,Xn,Fr,_i){const Ji=[],yi=[],jr=[0,0,0,1];for(const Uo of jn){const Ci=[],Ti=[];for(const Ro of Uo){const No=Ro.x+vr.x,jo=Ro.y+vr.y,Oo=og(No,jo,gn,ir,gi,Xn,Fr,_i);jr[0]=No,jr[1]=jo,jr[2]=Oo.base,jr[3]=1,jl(jr,jr,sr),jr[3]=Math.max(jr[3],1e-5);const ls=new fc(jr[0]/jr[3],jr[1]/jr[3],jr[2]/jr[3]);jr[0]=No,jr[1]=jo,jr[2]=Oo.top,jr[3]=1,jl(jr,jr,sr),jr[3]=Math.max(jr[3],1e-5);const ms=new fc(jr[0]/jr[3],jr[1]/jr[3],jr[2]/jr[3]);Ci.push(ls),Ti.push(ms)}Ji.push(Ci),yi.push(Ti)}return[Ji,yi]}(it,Qe,rn,Ht,xn,Nn,on,Sn,In):function(jn,gn,ir,vr,sr){const gi=[],Xn=[],Fr=sr[8]*gn,_i=sr[9]*gn,Ji=sr[10]*gn,yi=sr[11]*gn,jr=sr[8]*ir,Uo=sr[9]*ir,Ci=sr[10]*ir,Ti=sr[11]*ir;for(const Ro of jn){const No=[],jo=[];for(const Oo of Ro){const ls=Oo.x+vr.x,ms=Oo.y+vr.y,Os=sr[0]*ls+sr[4]*ms+sr[12],ko=sr[1]*ls+sr[5]*ms+sr[13],Ts=sr[2]*ls+sr[6]*ms+sr[14],ts=sr[3]*ls+sr[7]*ms+sr[15],Yo=Os+Fr,Xi=ko+_i,Ss=Ts+Ji,go=Math.max(ts+yi,1e-5),xa=Os+jr,ks=ko+Uo,Ls=Ts+Ci,ia=Math.max(ts+Ti,1e-5);No.push(new fc(Yo/go,Xi/go,Ss/go)),jo.push(new fc(xa/ia,ks/ia,Ls/ia))}gi.push(No),Xn.push(jo)}return[gi,Xn]}(it,Qe,rn,Ht,xn)),Ae=n.queryGeometry;var We,it,Qe,rn,Ht,xn,Nn,on,Sn,In;return function(We,it,Qe){let rn=1/0;kh(Qe,it)&&(rn=ig(Qe,it[0]));for(let Ht=0;Ht<it.length;Ht++){const xn=it[Ht],Nn=We[Ht];for(let on=0;on<xn.length-1;on++){const Sn=xn[on],In=[Sn,xn[on+1],Nn[on+1],Nn[on],Sn];lp(Qe,In)&&(rn=Math.min(rn,ig(Qe,In)))}}return rn!==1/0&&rn}(Pe,Xe,Ae.isPointQuery()?Ae.screenBounds:Ae.screenGeometry)}},line:class extends tl{constructor(n){super(n,Dp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if("line-gradient"===n){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof S,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=ef.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new jd(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new du(this,n)}queryRadius(n){const e=n,r=L_(qu("line-width",this,e),qu("line-gap-width",this,e)),s=qu("line-offset",this,e);return r/2+Math.abs(s)+Od(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,r,s,u,f){if(n.queryGeometry.isAboveHorizon)return!1;const g=$m(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),y=n.pixelToTileUnitsFactor/2*L_(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),w=this.paint.get("line-offset").evaluate(e,r);return w&&(s=function(E,O){const z=[],U=new Le(0,0);for(let q=0;q<E.length;q++){const J=E[q],se=[];for(let me=0;me<J.length;me++){const Pe=J[me],Xe=J[me+1],Ae=0===me?U:Pe.sub(J[me-1])._unit()._perp(),We=me===J.length-1?U:Xe.sub(Pe)._unit()._perp(),it=Ae._add(We)._unit();it._mult(1/(it.x*We.x+it.y*We.y)),se.push(it._mult(O)._add(Pe))}z.push(se)}return z}(s,w*n.pixelToTileUnitsFactor)),function(E,O,z){for(let U=0;U<O.length;U++){const q=O[U];if(E.length>=3)for(let J=0;J<q.length;J++)if(Rc(E,q[J]))return!0;if(zm(E,q,z))return!0}return!1}(g,s,y)}isTileClipped(){return!0}},symbol:mf,background:class extends tl{constructor(n){super(n,oy)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends tl{constructor(n){super(n,sy)}getProgramIds(){return["raster"]}},sky:class extends tl{constructor(n){super(n,ay),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"sky-gradient"===n?this._updateColorRamp():"sky-atmosphere-sun"!==n&&"sky-atmosphere-halo-color"!==n&&"sky-atmosphere-color"!==n&&"sky-atmosphere-sun-intensity"!==n||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ld({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),u=!s,f=n.style.light,g=f.properties.get("position");return u&&"viewport"===f.properties.get("anchor")&&vn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Jp(g.azimuthal,90-g.polar,e):Jp(s[0],90-s[1],e)}const r=this.paint.get("sky-gradient-center");return Jp(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return"atmosphere"===n?["skyboxCapture","skybox"]:"gradient"===n?["skyboxGradient"]:null}}};class eh{constructor(e,r,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,s){const{width:u,height:f}=e,{context:g}=this,{gl:y}=g,{HTMLImageElement:w,HTMLCanvasElement:E,HTMLVideoElement:O,ImageData:z,ImageBitmap:U}=Ee;if(y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!r||!1!==r.premultiply)),s||this.size&&this.size[0]===u&&this.size[1]===f){const{x:q,y:J}=s||{x:0,y:0};e instanceof w||e instanceof E||e instanceof O||e instanceof z||U&&e instanceof U?y.texSubImage2D(y.TEXTURE_2D,0,q,J,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,q,J,u,f,y.RGBA,y.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof w||e instanceof E||e instanceof O||e instanceof z||U&&e instanceof U?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,u,f,0,this.format,y.UNSIGNED_BYTE,e.data);this.useMipmap=!!(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,r){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ly{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class cy{constructor(){this.tasks={},this.taskQueue=[],Qn(["process"],this),this.invoker=new ly(this.process),this.nextId=0}add(e,r){const s=this.nextId++,u=function({type:f,isSymbolTile:g,zoom:y}){return y=y||0,"message"===f?0:"maybePrepare"!==f||g?"parseTile"!==f||g?"parseTile"===f&&g?300-y:"maybePrepare"===f&&g?400-y:500:200-y:100-y}(r);if(0===u){Wn();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:r,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){Wn();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<r&&(r=f.priority,e=u)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class Tg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const s=e[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const uy=["tile","layer","source","sourceLayer","state"];class Ml{constructor(e,r,s,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=s,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const r of uy)void 0!==this[r]&&(e[r]=this[r]);return e}}const yc=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,r=0,s=0,u=0,f=0,g=0,y=0;for(1&e?u=f=g=32:r=s=y=32;(e>>=1)>1;){const E=r+u>>1,O=s+f>>1;1&e?(u=r,f=s,r=g,s=y):(r=u,s=f,u=g,f=y),g=E,y=O}const w=4*n;yc[w+0]=r,yc[w+1]=s,yc[w+2]=u,yc[w+3]=f}const Kl=new Uint16Array(2178),vc=new Uint8Array(1089),th=new Uint16Array(1089);function nh(n){return 0===n?-.03125:32===n?.03125:0}var gf=Ft([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const dy={type:2,extent:zr,loadGeometry:()=>[[new Le(0,0),new Le(zr+1,0),new Le(zr+1,zr+1),new Le(0,zr+1),new Le(0,0)]]};class _f{constructor(e,r,s,u,f){this.tileID=e,this.uid=at(),this.uses=0,this.tileSize=r,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<mi.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=wi(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const g={};if(!f)return g;for(const y of u){const w=y.layerIds.map(E=>f.getLayer(E)).filter(Boolean);if(0!==w.length){y.layers=w,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(E=>w.filter(O=>O.id===E)[0]));for(const E of w)g[E.id]=y}}return g}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof Hc){if(this.hasSymbolBuckets=!0,!s)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof Hc&&f.hasRTLText){this.hasRTLText=!0,A.isLoading()||A.isLoaded()||"deferred"!==x()||C();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Po}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const u=this.buckets[s];u.uploadPending()&&u.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new eh(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new eh(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new eh(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,s,u,f,g,y,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:y,transform:g,params:f,tileTransform:this.tileTransform},e,r,s):{}}querySourceFeatures(e,r){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),f=r?r.sourceLayer:"",g=u._geojsonTileLayer||u[f];if(!g)return;const y=nc(r&&r.filter),{z:w,x:E,y:O}=this.tileID.canonical,z={z:w,x:E,y:O};for(let U=0;U<g.length;U++){const q=g.feature(U);if(y.needGeometry){const me=Gu(q,!0);if(!y.filter(new N(this.tileID.overscaledZ),me,this.tileID.canonical))continue}else if(!y.filter(new N(this.tileID.overscaledZ),q))continue;const J=s.getId(q,f),se=new Ml(q,w,E,O,J);se.tile=z,e.push(se)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const s=Dr(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const f=this.expirationTime-r;f?this.expirationTime=s+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!r)return;const s=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const g=this.buckets[f],y=g.layers[0].sourceLayer||"_geojsonTileLayer",w=s[y],E=e[y];if(!w||!E||0===Object.keys(E).length)continue;if(g.update(E,w,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof jd||g instanceof qh){const z=r.style._getSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&z&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(z.id,this.tileID)}const O=r&&r.style&&r.style.getLayer(f);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(g)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=mi.now()+e}setTexture(e,r){const s=r.context,u=s.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new eh(s,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,r){const s={};for(const u of r)s[u]=!0;this.dependencies[e]=s}hasDependency(e,r){for(const s of e){const u=this.dependencies[s];if(u)for(const f of r)if(u[f])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||"mercator"===r.name||this._tileDebugBuffer)return;const s=uc(dy,this.tileID.canonical,this.tileTransform)[0],u=new Un,f=new Ua;for(let g=0;g<s.length;g++){const{x:y,y:w}=s[g];u.emplaceBack(y,w),f.emplaceBack(g)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,Ic.members),this._tileDebugSegments=as.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||"mercator"===r.name)return;const s=uc(dy,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const g=function(y,w){const E=wi(y,w),O=Math.pow(2,y.z);for(let me=0;me<33;me++)for(let Pe=0;Pe<33;Pe++){const Xe=nl((y.x+(Pe+nh(Pe))/32)/O),Ae=_a((y.y+(me+nh(me))/32)/O),We=w.project(Xe,Ae),it=33*me+Pe;Kl[2*it+0]=Math.round((We.x*E.scale-E.x)*zr),Kl[2*it+1]=Math.round((We.y*E.scale-E.y)*zr)}vc.fill(0),th.fill(0);for(let me=2045;me>=0;me--){const Pe=4*me,Xe=yc[Pe+0],Ae=yc[Pe+1],We=yc[Pe+2],it=yc[Pe+3],Qe=Xe+We>>1,rn=Ae+it>>1,Ht=Qe+rn-Ae,xn=rn+Xe-Qe,Nn=33*Ae+Xe,on=33*it+We,Sn=33*rn+Qe,In=Math.hypot((Kl[2*Nn+0]+Kl[2*on+0])/2-Kl[2*Sn+0],(Kl[2*Nn+1]+Kl[2*on+1])/2-Kl[2*Sn+1])>=16;vc[Sn]=vc[Sn]||(In?1:0),me<1022&&(vc[Sn]=vc[Sn]||vc[33*(Ae+xn>>1)+(Xe+Ht>>1)]||vc[33*(it+xn>>1)+(We+Ht>>1)])}const z=new wn,U=new wr;let q=0;function J(me,Pe){const Xe=33*Pe+me;return 0===th[Xe]&&(z.emplaceBack(Kl[2*Xe+0],Kl[2*Xe+1],me*zr/32,Pe*zr/32),th[Xe]=++q),th[Xe]-1}function se(me,Pe,Xe,Ae,We,it){const Qe=me+Xe>>1,rn=Pe+Ae>>1;if(Math.abs(me-We)+Math.abs(Pe-it)>1&&vc[33*rn+Qe])se(We,it,me,Pe,Qe,rn),se(Xe,Ae,We,it,Qe,rn);else{const Ht=J(me,Pe),xn=J(Xe,Ae),Nn=J(We,it);U.emplaceBack(Ht,xn,Nn)}}return se(0,0,32,32,32,0),se(32,32,0,0,0,32),{vertices:z,indices:U}}(this.tileID.canonical,r);u=g.vertices,f=g.indices}else{u=new wn,f=new wr;for(const{x:y,y:w}of s)u.emplaceBack(y,w,0,0);const g=Qm(u.int16,void 0,4);for(let y=0;y<g.length;y+=3)f.emplaceBack(g[y],g[y+1],g[y+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,gf.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=as.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,r){const s=r.projection;if(!s||"globe"!==s.name||r.freezeTileCoverage)return;const u=this.tileID.canonical,f=mu(ep(u,r)),g=ju(r.zoom);let y;g>0&&(y=zf(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,r,f,y,g),this._makeGlobeTileDebugTextBuffer(e,u,r,f,y,g)}_globePoint(e,r,s,u,f,g,y){let w=Id(e,r,s);if(g){const E=1<<s.z,O=Wl(u.center.lng),z=ql(u.center.lat),U=(s.x+.5)/E-O;let q=0;U>.5?q=-1:U<-.5&&(q=1);let J=(e/zr+s.x)/E+q,se=(r/zr+s.y)/E;J=(J-O)*u._pixelsPerMercatorPixel+O,se=(se-z)*u._pixelsPerMercatorPixel+z;const me=[J*u.worldSize,se*u.worldSize,0];Ps(me,me,g),w=Mc(w,me,y)}return Ps(w,w,f)}_makeGlobeTileDebugBorderBuffer(e,r,s,u,f,g){const y=new Un,w=new Ua,E=new Zt,O=(U,q,J,se,me)=>{const Pe=(J-U)/(me-1),Xe=(se-q)/(me-1),Ae=y.length;for(let We=0;We<me;We++){const it=U+We*Pe,Qe=q+We*Xe;y.emplaceBack(it,Qe);const rn=this._globePoint(it,Qe,r,s,u,f,g);E.emplaceBack(rn[0],rn[1],rn[2]),w.emplaceBack(Ae+We)}},z=zr;O(0,0,z,0,16),O(z,0,z,z,16),O(z,z,0,z,16),O(0,z,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(w),this._tileDebugBuffer=e.createVertexBuffer(y,Ic.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(E,Sd.members),this._tileDebugSegments=as.simpleSegment(0,0,y.length,w.length)}_makeGlobeTileDebugTextBuffer(e,r,s,u,f,g){const y=zr/4,w=new Un,E=new wr,O=new Zt,z=25;E.reserve(32),w.reserve(z),O.reserve(z);const U=(q,J)=>z*q+J;for(let q=0;q<z;q++){const J=q*y;for(let se=0;se<z;se++){const me=se*y;w.emplaceBack(me,J);const Pe=this._globePoint(me,J,r,s,u,f,g);O.emplaceBack(Pe[0],Pe[1],Pe[2])}}for(let q=0;q<4;q++)for(let J=0;J<4;J++){const se=U(q,J),me=U(q,J+1),Pe=U(q+1,J),Xe=U(q+1,J+1);E.emplaceBack(se,me,Pe),E.emplaceBack(Pe,me,Xe)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(E),this._tileDebugTextBuffer=e.createVertexBuffer(w,Ic.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(O,Sd.members),this._tileDebugTextSegments=as.simpleSegment(0,0,z,32)}}class Sg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,s){const u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Me(this.stateChanges[e][u],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][u]){this.deletedStates[e][u]={};for(const f in this.state[e][u])s[f]||(this.deletedStates[e][u][f]=null)}else for(const f in s)this.deletedStates[e]&&this.deletedStates[e][u]&&null===this.deletedStates[e][u][f]&&delete this.deletedStates[e][u][f]}removeFeatureState(e,r,s){if(null===this.deletedStates[e])return;const u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==r)null!==this.deletedStates[e][u]&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(void 0!==r)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){const s=String(r),u=Me({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const f=this.deletedStates[e][r];if(null===f)return{};for(const g in f)delete u[g]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),Me(this.state[u][g],this.stateChanges[u][g]),f[g]=this.state[u][g];s[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(null===this.deletedStates[u])for(const g in this.state[u])f[g]={},this.state[u][g]={};else for(const g in this.deletedStates[u]){if(null===this.deletedStates[u][g])this.state[u][g]={};else if(this.state[u][g])for(const y of Object.keys(this.deletedStates[u][g]))delete this.state[u][g][y];f[g]=this.state[u][g]}s[u]=s[u]||{},Me(s[u],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const u in e)e[u].setFeatureState(s,r)}}class em{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const s=this.toIdx(e,r);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function tm(n,e,r,s){let u=0,f=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(s[g])<1e-15){if(r[g]<n[g]||r[g]>e[g])return null}else{const y=1/s[g];let w=(n[g]-r[g])*y,E=(e[g]-r[g])*y;if(w>E){const O=w;w=E,E=O}if(w>u&&(u=w),E<f&&(f=E),u>f)return null}return u}function yf(n,e,r,s,u,f,g,y,w,E,O){const z=s-n,U=u-e,q=f-r,J=g-n,se=y-e,me=w-r,Pe=O[1]*me-O[2]*se,Xe=O[2]*J-O[0]*me,Ae=O[0]*se-O[1]*J,We=z*Pe+U*Xe+q*Ae;if(Math.abs(We)<1e-15)return null;const it=1/We,Qe=E[0]-n,rn=E[1]-e,Ht=E[2]-r,xn=(Qe*Pe+rn*Xe+Ht*Ae)*it;if(xn<0||xn>1)return null;const Nn=rn*q-Ht*U,on=Ht*z-Qe*q,Sn=Qe*U-rn*z,In=(O[0]*Nn+O[1]*on+O[2]*Sn)*it;return In<0||xn+In>1?null:(J*Nn+se*on+me*Sn)*it}function Jl(n,e,r){return(n-e)/(r-e)}function Ig(n,e,r,s,u,f,g,y,w){const E=1<<r,O=f-s,z=g-u,U=(n+1)/E*O+s,q=(e+0)/E*z+u,J=(e+1)/E*z+u;y[0]=(n+0)/E*O+s,y[1]=q,w[0]=U,w[1]=J}class Mg{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(f){const g=Math.ceil(Math.log2(f.dim/8)),y=[];let w=Math.ceil(Math.pow(2,g));const E=1/w,O=(q,J,se,me,Pe)=>{const Xe=me?1:0,Ae=(q+1)*se-Xe,We=J*se,it=(J+1)*se-Xe;Pe[0]=q*se,Pe[1]=We,Pe[2]=Ae,Pe[3]=it};let z=new em(w);const U=[];for(let q=0;q<w*w;q++){O(q%w,Math.floor(q/w),E,!1,U);const J=Gc(U[0],U[1],f),se=Gc(U[2],U[1],f),me=Gc(U[2],U[3],f),Pe=Gc(U[0],U[3],f);z.minimums.push(Math.min(J,se,me,Pe)),z.maximums.push(Math.max(J,se,me,Pe)),z.leaves.push(1)}for(y.push(z),w/=2;w>=1;w/=2){const q=y[y.length-1];z=new em(w);for(let J=0;J<w*w;J++){O(J%w,Math.floor(J/w),2,!0,U);const se=q.getElevation(U[0],U[1]),me=q.getElevation(U[2],U[1]),Pe=q.getElevation(U[2],U[3]),Xe=q.getElevation(U[0],U[3]),Ae=q.isLeaf(U[0],U[1]),We=q.isLeaf(U[2],U[1]),it=q.isLeaf(U[2],U[3]),Qe=q.isLeaf(U[0],U[3]),rn=Math.min(se.min,me.min,Pe.min,Xe.min),Ht=Math.max(se.max,me.max,Pe.max,Xe.max),xn=Ae&&We&&it&&Qe;z.maximums.push(Ht),z.minimums.push(rn),z.leaves.push(Ht-rn<=5&&xn?1:0)}y.push(z)}return y}(this.dem),s=r.length-1,u=r[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,s,0)}raycastRoot(e,r,s,u,f,g,y=1){return tm([e,r,-100],[s,u,this.maximums[0]*y],f,g)}raycast(e,r,s,u,f,g,y=1){if(!this.nodeCount)return null;const w=this.raycastRoot(e,r,s,u,f,g,y);if(null==w)return null;const E=[],O=[],z=[],U=[],q=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:J,t:se,nodex:me,nodey:Pe,depth:Xe}=q.pop();if(this.leaves[J]){Ig(me,Pe,Xe,e,r,s,u,z,U);const We=1<<Xe,it=(me+0)/We,Qe=(me+1)/We,rn=(Pe+0)/We,Ht=(Pe+1)/We,xn=Gc(it,rn,this.dem)*y,Nn=Gc(Qe,rn,this.dem)*y,on=Gc(Qe,Ht,this.dem)*y,Sn=Gc(it,Ht,this.dem)*y,In=yf(z[0],z[1],xn,U[0],z[1],Nn,U[0],U[1],on,f,g),Fn=yf(U[0],U[1],on,z[0],U[1],Sn,z[0],z[1],xn,f,g),jn=Math.min(null!==In?In:Number.MAX_VALUE,null!==Fn?Fn:Number.MAX_VALUE);if(jn!==Number.MAX_VALUE)return jn;{const gn=Cd([],f,g,se);if(vf(xn,Nn,Sn,on,Jl(gn[0],z[0],U[0]),Jl(gn[1],z[1],U[1]))>=gn[2])return se}continue}let Ae=0;for(let We=0;We<this._siblingOffset.length;We++){Ig((me<<1)+this._siblingOffset[We][0],(Pe<<1)+this._siblingOffset[We][1],Xe+1,e,r,s,u,z,U),z[2]=-100,U[2]=this.maximums[this.childOffsets[J]+We]*y;const it=tm(z,U,f,g);if(null!=it){const Qe=it;E[We]=Qe;let rn=!1;for(let Ht=0;Ht<Ae&&!rn;Ht++)Qe>=E[O[Ht]]&&(O.splice(Ht,0,We),rn=!0);rn||(O[Ae]=We),Ae++}}for(let We=0;We<Ae;We++){const it=O[We];q.push({idx:this.childOffsets[J]+it,t:E[it],nodex:(me<<1)+this._siblingOffset[it][0],nodey:(Pe<<1)+this._siblingOffset[it][1],depth:Xe+1})}}return null}_addNode(e,r,s){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,s,u,f){if(1===e[u].isLeaf(r,s))return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const g=u-1,y=e[g];let w=0,E=0;for(let O=0;O<this._siblingOffset.length;O++){const z=2*r+this._siblingOffset[O][0],U=2*s+this._siblingOffset[O][1],q=y.getElevation(z,U),J=y.isLeaf(z,U),se=this._addNode(q.min,q.max,J);J&&(w|=1<<O),E||(E=se)}for(let O=0;O<this._siblingOffset.length;O++)w&1<<O||this._construct(e,2*r+this._siblingOffset[O][0],2*s+this._siblingOffset[O][1],g,E+O)}}function vf(n,e,r,s,u,f){return K(K(n,r,f),K(e,s,f),u)}function Gc(n,e,r){const s=r.dim,u=Gt(n*s-.5,0,s-1),f=Gt(e*s-.5,0,s-1),g=Math.floor(u),y=Math.floor(f),w=Math.min(g+1,s-1),E=Math.min(y+1,s-1);return vf(r.get(g,y),r.get(w,y),r.get(g,E),r.get(w,E),u-g,f-y)}const nm={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function hy(n,e,r){return(256*n*256+256*e+r)/10-1e4}function xf(n,e,r){return 256*n+e+r/256-32768}class Wc{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,s,u=!1,f=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return vn(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const g=this.dim=r.height-2,y=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=s||"mapbox",this.borderReady=u,!u){for(let w=0;w<g;w++)y[this._idx(-1,w)]=y[this._idx(0,w)],y[this._idx(g,w)]=y[this._idx(g-1,w)],y[this._idx(w,-1)]=y[this._idx(w,0)],y[this._idx(w,g)]=y[this._idx(w,g-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(g,-1)]=y[this._idx(g-1,0)],y[this._idx(-1,g)]=y[this._idx(0,g-1)],y[this._idx(g,g)]=y[this._idx(g-1,g-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Mg(this)}get(e,r,s=!1){s&&(e=Gt(e,-1,this.dim),r=Gt(r,-1,this.dim));const u=4*this._idx(e,r);return("terrarium"===this.encoding?xf:hy)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return nm[e]}get unpackVector(){return nm[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}static pack(e,r){const s=[0,0,0,0],u=Wc.getUnpackVector(r);let f=Math.floor((e+u[3])/u[2]);return s[2]=f%256,f=Math.floor(f/256),s[1]=f%256,f=Math.floor(f/256),s[0]=f,s}getPixels(){return new ca({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,f=r*this.dim+this.dim,g=s*this.dim,y=s*this.dim+this.dim;switch(r){case-1:u=f-1;break;case 1:f=u+1}switch(s){case-1:g=y-1;break;case 1:y=g+1}const w=-r*this.dim,E=-s*this.dim;for(let O=g;O<y;O++)for(let z=u;z<f;z++){const U=4*this._idx(z,O),q=4*this._idx(z+w,O+E);this.pixels[U+0]=e.pixels[q+0],this.pixels[U+1]=e.pixels[q+1],this.pixels[U+2]=e.pixels[q+2],this.pixels[U+3]=e.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}$(Wc,"DEMData"),$(Mg,"DemMinMaxQuadTree",{omit:["dem"]});class bf{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,s){const u=e.wrapped().key;void 0===this.data[u]&&(this.data[u]=[]);const f={value:r,timeout:void 0};if(void 0!==s&&(f.timeout=setTimeout(()=>{this.remove(e,f)},s)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const s=e.wrapped().key,u=void 0===r?0:this.data[s].indexOf(r),f=this.data[s][u];return this.data[s].splice(u,1),f.timeout&&clearTimeout(f.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(f.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const s in this.data)for(const u of this.data[s])e(u.value)||r.push(u);for(const s of r)this.remove(s.value.tileID,s)}}class rh{constructor(e,r,s){this.func=e,this.mask=r,this.range=s}}rh.ReadOnly=!1,rh.ReadWrite=!0,rh.disabled=new rh(519,rh.ReadOnly,[0,1]);class wf{constructor(e,r,s,u,f,g){this.test=e,this.ref=r,this.mask=s,this.fail=u,this.depthFail=f,this.pass=g}}wf.disabled=new wf({func:519,mask:0},0,0,7680,7680,7680);class Al{constructor(e,r,s){this.blendFunction=e,this.blendColor=r,this.mask=s}}Al.Replace=[1,0],Al.disabled=new Al(Al.Replace,Si.transparent,[!1,!1,!1,!1]),Al.unblended=new Al(Al.Replace,Si.transparent,[!0,!0,!0,!0]),Al.alphaBlended=new Al([1,771],Si.transparent,[!0,!0,!0,!0]);class gl{constructor(e,r,s){this.enable=e,this.mode=r,this.frontFace=s}}gl.disabled=new gl(!1,1029,2305),gl.backCCW=new gl(!0,1029,2305),gl.backCW=new gl(!0,1029,2304),gl.frontCW=new gl(!0,1028,2304),gl.frontCCW=new gl(!0,1028,2305);class qc extends So{constructor(e,r,s){super(),this.id=e,this._onlySymbols=s,r.on("data",u=>{"source"===u.dataType&&"metadata"===u.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===u.dataType&&"content"===u.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new bf(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Sg,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if("loaded"!==r.state&&"errored"!==r.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const s=this._tiles[r];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return an(this._tiles).map(e=>e.tileID).sort(pd).map(e=>e.key)}getRenderableIds(e){const r=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&r.push(this._tiles[s]);return e?r.sort((s,u)=>{const f=s.tileID,g=u.tileID,y=new Le(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),w=new Le(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||w.y-y.y||w.x-y.x}).map(s=>s.tileID.key):r.map(s=>s.tileID).sort(pd).map(s=>s.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=r),this._loadTile(s,this._tileLoaded.bind(this,s,e,r)))}_tileLoaded(e,r,s,u){if(u)if(e.state="errored",404!==u.status)this._source.fire(new Ur(u,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=mi.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new bi("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const f=r[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const g=this.getTileByID(f);s(e,g),s(g,e)}}function s(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let g=f.tileID.canonical.x-u.tileID.canonical.x;const y=f.tileID.canonical.y-u.tileID.canonical.y,w=Math.pow(2,u.tileID.canonical.z),E=f.tileID.key;0===g&&0===y||Math.abs(y)>1||(Math.abs(g)>1&&(1===Math.abs(g+w)?g+=w:1===Math.abs(g-w)&&(g-=w)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,g,y),u.neighboringTiles&&u.neighboringTiles[E]&&(u.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,s,u){for(const f in this._tiles){let g=this._tiles[f];if(u[f]||!g.hasData()||g.tileID.overscaledZ<=r||g.tileID.overscaledZ>s)continue;let y=g.tileID;for(;g&&g.tileID.overscaledZ>r+1;){const E=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[E.key],g&&g.hasData()&&(y=E)}let w=y;for(;w.overscaledZ>r;)if(w=w.scaledTo(w.overscaledZ-1),e[w.key]){u[y.key]=y;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=r?s:null}for(let s=e.overscaledZ-1;s>=r;s--){const u=e.scaledTo(s),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const s=Math.ceil(e.width/r)+1,u=Math.ceil(e.height/r)+1,f=Math.floor(s*u*5),g="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,f):f,y="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(y)}handleWrapJump(e){const r=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,r){const s={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+r),s[f.tileID.key]=f}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,r,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let u;this.updateCacheSize(e,r),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new ua(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(u=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(y=>this._source.hasTile(y)))):u=[];const f=this._updateRetainedTiles(u);if(Ag(this._source.type)&&0!==u.length){const y={},w={},E=Object.keys(f);for(const z of E){const U=f[z],q=this._tiles[z];if(!q||q.fadeEndTime&&q.fadeEndTime<=mi.now())continue;const J=this.findLoadedParent(U,Math.max(U.overscaledZ-qc.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),y[J.tileID.key]=J.tileID),w[z]=U}const O=u[u.length-1].overscaledZ;for(const z in this._tiles){const U=this._tiles[z];if(f[z]||!U.hasData())continue;let q=U.tileID;for(;q.overscaledZ>O;){q=q.scaledTo(q.overscaledZ-1);const J=this._tiles[q.key];if(J&&J.hasData()&&w[q.key]){f[z]=U.tileID;break}}}for(const z in y)f[z]||(this._coveredTiles[z]=!0,f[z]=y[z])}for(const y in f)this._tiles[y].clearFadeHold();const g=function(y,w){const E=[];for(const O in y)O in w||E.push(O);return E}(this._tiles,f);for(const y of g){const w=this._tiles[y];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(0===e.length)return r;const s={},u=e.reduce((E,O)=>Math.min(E,O.overscaledZ),1/0),f=e[0].overscaledZ,g=Math.max(f-qc.maxOverzooming,this._source.minzoom),y=Math.max(f+qc.maxUnderzooming,this._source.minzoom),w={};for(const E of e){const O=this._addTile(E);r[E.key]=E,O.hasData()||u<this._source.maxzoom&&(w[E.key]=E)}this._retainLoadedChildren(w,u,y,r);for(const E of e){let O=this._tiles[E.key];if(O.hasData())continue;if(E.canonical.z>=this._source.maxzoom){const U=E.children(this._source.maxzoom)[0],q=this.getTile(U);if(q&&q.hasData()){r[U.key]=U;continue}}else{const U=E.children(this._source.maxzoom);if(r[U[0].key]&&r[U[1].key]&&r[U[2].key]&&r[U[3].key])continue}let z=O.wasRequested();for(let U=E.overscaledZ-1;U>=g;--U){const q=E.scaledTo(U);if(s[q.key]||(s[q.key]=!0,O=this.getTile(q),!O&&z&&(O=this._addTile(q)),O&&(r[q.key]=q,z=O.wasRequested(),O.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}r.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(f),s)break;u=f}for(const f of r)this._loadedParentTiles[f]=s}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const s=!!r;if(!s){const u=this.map?this.map.painter:null;r=new _f(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,s||this._source.fire(new bi("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=r.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&"reloading"!==r.state?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,s){const u=[],f=this.transform;if(!f)return u;const g="globe"===f.projection.name,y=Wl(f.center.lng);for(const w in this._tiles){const E=this._tiles[w];if(s&&E.clearQueryDebugViz(),E.holdingForFade())continue;let O;if(g){const z=E.tileID.canonical;if(0===z.z){const U=[Math.abs(Gt(y,...md(z,-1))-y),Math.abs(Gt(y,...md(z,1))-y)];O=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(Gt(y,...md(z,-1))-y),Math.abs(Gt(y,...md(z,0))-y),Math.abs(Gt(y,...md(z,1))-y)];O=[U.indexOf(Math.min(...U))-1]}}else O=[0];for(const z of O){const U=e.containsTile(E,f,r,z);U&&u.push(U)}}return u}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of r)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(Ag(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=mi.now())return!0}return!1}setFeatureState(e,r,s){this._state.updateState(e=e||"_geojsonTileLayer",r,s)}removeFeatureState(e,r,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,s)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,s){const u=this._tiles[e];u&&u.setDependencies(r,s)}reloadTilesForDependencies(e,r){for(const s in this._tiles)this._tiles[s].hasDependency(e,r)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){const y=()=>{this._sourceLoaded&&(this._source.off("data",y),this._preloadTiles(e,r))};return void this._source.on("data",y)}const s=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,g=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const y of u){const w=y.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const E of w)s.set(E.key,E);this.usedForTerrain&&y.updateElevation(!1)}pr(Array.from(s.values()),(y,w)=>{const E=new _f(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(E,O=>{"raster-dem"===this._source.type&&E.dem&&this._backfillDEM(E),w(O,E)})},r)}}function pd(n,e){const r=Math.abs(2*n.wrap)-+(n.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||s-r||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function Ag(n){return"raster"===n||"image"===n||"video"===n||"custom"===n}function md(n,e){const r=1<<n.z;return[n.x/r+e,(n.x+1)/r+e]}qc.maxOverzooming=10,qc.maxUnderzooming=3;class ih{constructor(e,r,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=s}static create(e,r,s){const u=s||e.findDEMTileFor(r);if(!u||!u.dem)return;const f=u.dem,g=u.tileID,y=1<<r.canonical.z-g.canonical.z;return new ih(u,u.tileSize/zr/y,[(r.canonical.x/y-g.canonical.x)*f.dim,(r.canonical.y/y-g.canonical.y)*f.dim])}tileCoordToPixel(e,r){const s=r*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(s);return new Le(u,f)}getElevationAt(e,r,s,u){const f=e*this._scale+this._offset[0],g=r*this._scale+this._offset[1],y=Math.floor(f),w=Math.floor(g),E=this._dem;return u=!!u,s?K(K(E.get(y,w,u),E.get(y,w+1,u),g-w),K(E.get(y+1,w,u),E.get(y+1,w+1,u),g-w),f-y):E.get(y,w,u)}getElevationAtPixel(e,r,s){return this._dem.get(e,r,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Il(1,e)*this._dem.stride}}class Pg{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new R(zr,16,0),this.featureIndexArray=new cl,this.promoteId=r}insert(e,r,s,u,f,g=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,f,g);const w=this.grid;for(let E=0;E<r.length;E++){const O=r[E],z=[1/0,1/0,-1/0,-1/0];for(let U=0;U<O.length;U++){const q=O[U];z[0]=Math.min(z[0],q.x),z[1]=Math.min(z[1],q.y),z[2]=Math.max(z[2],q.x),z[3]=Math.max(z[3],q.y)}z[0]<zr&&z[1]<zr&&z[2]>=0&&z[3]>=0&&w.insert(y,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new To(new sf(this.rawTileData)).layers,this.sourceLayerCoder=new Tg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,s,u){this.loadVTLayers();const f=e.params||{},g=nc(f.filter),y=e.tileResult,w=e.transform,E=y.bufferedTilespaceBounds,O=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(J,se,me,Pe)=>Bh(y.bufferedTilespaceGeometry,J,se,me,Pe));O.sort(oh);let z=null;w.elevation&&O.length>0&&(z=ih.create(w.elevation,this.tileID));const U={};let q;for(let J=0;J<O.length;J++){const se=O[J];if(se===q)continue;q=se;const me=this.featureIndexArray.get(se);let Pe=null;this.loadMatchingFeature(U,me,g,f.layers,f.availableImages,r,s,u,(Xe,Ae,We,it=0)=>(Pe||(Pe=uc(Xe,this.tileID.canonical,e.tileTransform)),Ae.queryIntersectsFeature(y,Xe,We,Pe,this.z,e.transform,e.pixelPosMatrix,z,it)))}return U}loadMatchingFeature(e,r,s,u,f,g,y,w,E){const{featureIndex:O,bucketIndex:z,sourceLayerIndex:U,layoutVertexArrayOffset:q}=r,J=this.bucketLayerIDs[z];if(u&&!function(Xe,Ae){for(let We=0;We<Xe.length;We++)if(Ae.indexOf(Xe[We])>=0)return!0;return!1}(u,J))return;const se=this.sourceLayerCoder.decode(U),me=this.vtLayers[se].feature(O);if(s.needGeometry){const Xe=Gu(me,!0);if(!s.filter(new N(this.tileID.overscaledZ),Xe,this.tileID.canonical))return}else if(!s.filter(new N(this.tileID.overscaledZ),me))return;const Pe=this.getId(me,se);for(let Xe=0;Xe<J.length;Xe++){const Ae=J[Xe];if(u&&u.indexOf(Ae)<0)continue;const We=g[Ae];if(!We)continue;let it={};void 0!==Pe&&w&&(it=w.getState(We.sourceLayer||"_geojsonTileLayer",Pe));const Qe=Me({},y[Ae]);Qe.paint=Rg(Qe.paint,We.paint,me,it,f),Qe.layout=Rg(Qe.layout,We.layout,me,it,f);const rn=!E||E(me,We,it,q);if(!rn)continue;const Ht=new Ml(me,this.z,this.x,this.y,Pe);Ht.layer=Qe;let xn=e[Ae];void 0===xn&&(xn=e[Ae]=[]),xn.push({featureIndex:O,feature:Ht,intersectionZ:rn})}}lookupSymbolFeatures(e,r,s,u,f,g,y,w){const E={};this.loadVTLayers();const O=nc(f);for(const z of e)this.loadMatchingFeature(E,{bucketIndex:s,sourceLayerIndex:u,featureIndex:z,layoutVertexArrayOffset:0},O,g,y,w,r);return E}loadFeature(e){const{featureIndex:r,sourceLayerIndex:s}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(s),f=this.vtFeatures[u];if(f[r])return f[r];const g=this.vtLayers[u].feature(r);return f[r]=g,g}hasLayer(e){for(const r of this.bucketLayerIDs)for(const s of r)if(e===s)return!0;return!1}getId(e,r){let s=e.id;if(this.promoteId){const u="string"==typeof this.promoteId?this.promoteId:this.promoteId[r];null!=u&&(s=e.properties[u]),"boolean"==typeof s&&(s=Number(s))}return s}}function Rg(n,e,r,s,u){return Mn(n,(f,g)=>{const y=e instanceof Re?e.get(g):null;return y&&y.evaluate?y.evaluate(r,s,u):y})}function oh(n,e){return e-n}$(Pg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Og{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new dc({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const s=this.getKey(e,r);return this.positions[s]}trim(){const e=this.width,r=this.height=cn(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,s){const u=[];let f=e.length%2==1?-e[e.length-1]*s:0,g=e[0]*s,y=!0;u.push({left:f,right:g,isDash:y,zeroLength:0===e[0]});let w=e[0];for(let E=1;E<e.length;E++){y=!y;const O=e[E];f=w*s,w+=O,g=w*s,u.push({left:f,right:g,isDash:y,zeroLength:0===O})}return u}addRoundDash(e,r,s){const u=r/2;for(let f=-s;f<=s;f++){const g=this.width*(this.nextRow+s+f);let y=0,w=e[y];for(let E=0;E<this.width;E++){E/w.right>1&&(w=e[++y]);const O=Math.abs(E-w.left),z=Math.abs(E-w.right),U=Math.min(O,z);let q;const J=f/s*(u+1);if(w.isDash){const se=u-Math.abs(J);q=Math.sqrt(U*U+se*se)}else q=u-Math.sqrt(U*U+J*J);this.image.data[g+E]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(e,r){for(let w=e.length-1;w>=0;--w){const E=e[w],O=e[w+1];E.zeroLength?e.splice(w,1):O&&O.isDash===E.isDash&&(O.left=E.left,e.splice(w,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const f=this.width*this.nextRow;let g=0,y=e[g];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++g]);const E=Math.abs(w-y.left),O=Math.abs(w-y.right),z=Math.min(E,O);this.image.data[f+w]=Math.max(0,Math.min(255,(y.isDash?z:-z)+r+128))}}addDash(e,r){const s=this.getKey(e,r);if(this.positions[s])return this.positions[s];const u="round"===r,f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return vn("LineAtlas out of space"),null;0===e.length&&e.push(1);let y=0;for(let O=0;O<e.length;O++)e[O]<0&&(vn("Negative value is found in line dasharray, replacing values with 0"),e[O]=0),y+=e[O];if(0!==y){const O=this.width/y,z=this.getDashRanges(e,this.width,O);u?this.addRoundDash(z,O,f):this.addRegularDash(z,"square"===r?.5*O:0)}const w=this.nextRow+f;this.nextRow+=g;const E={tl:[w,f],br:[y,0]};return this.positions[s]=E,E}}$(Og,"LineAtlas");const kg=1*Sa;class Lg{constructor(e){const r={},s=[];for(const y in e){const w=e[y],E=r[y]={};for(const O in w.glyphs){const z=w.glyphs[+O];if(!z||0===z.bitmap.width||0===z.bitmap.height)continue;const U=z.metrics.localGlyph?kg:1,q={x:0,y:0,w:z.bitmap.width+2*U,h:z.bitmap.height+2*U};s.push(q),E[O]=q}}const{w:u,h:f}=zc(s),g=new dc({width:u||1,height:f||1});for(const y in e){const w=e[y];for(const E in w.glyphs){const O=w.glyphs[+E];if(!O||0===O.bitmap.width||0===O.bitmap.height)continue;const z=r[y][E],U=O.metrics.localGlyph?kg:1;dc.copy(O.bitmap,g,{x:0,y:0},{x:z.x+U,y:z.y+U},O.bitmap)}}this.image=g,this.positions=r}}$(Lg,"GlyphAtlas");class fy{constructor(e){this.tileID=new ua(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=wi(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,s,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new Po;const g=new Tg(Object.keys(e.layers).sort()),y=new Pg(this.tileID,this.promoteId);y.bucketLayerIDs=[];const w={},E=new Og(256,256),O={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:E,availableImages:s},z=r.familiesBySource[this.source];for(const it in z){const Qe=e.layers[it];if(!Qe)continue;let rn=!1,Ht=!1;for(const on of z[it])"symbol"===on[0].type?rn=!0:Ht=!0;if(!0===this.isSymbolTile&&!rn||!1===this.isSymbolTile&&!Ht)continue;1===Qe.version&&vn(`Vector tile source "${this.source}" layer "${it}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xn=g.encode(it),Nn=[];for(let on=0;on<Qe.length;on++){const Sn=Qe.feature(on),In=y.getId(Sn,it);Nn.push({feature:Sn,id:In,index:on,sourceLayerIndex:xn})}for(const on of z[it]){const Sn=on[0];void 0!==this.isSymbolTile&&"symbol"===Sn.type!==this.isSymbolTile||Sn.minzoom&&this.zoom<Math.floor(Sn.minzoom)||Sn.maxzoom&&this.zoom>=Sn.maxzoom||"none"!==Sn.visibility&&(sm(on,this.zoom,s),(w[Sn.id]=Sn.createBucket({index:y.bucketLayerIDs.length,layers:on,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(Nn,O,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(on.map(In=>In.id)))}}let U,q,J,se;E.trim();const me={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Pe=()=>{if(U)return f(U);if(q&&J&&se){const it=new Lg(q),Qe=new Op(J,se);for(const rn in w){const Ht=w[rn];Ht instanceof Hc?(sm(Ht.layers,this.zoom,s),K_(Ht,q,it.positions,J,Qe.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):Ht.hasPattern&&(Ht instanceof jd||Ht instanceof qh||Ht instanceof Ju)&&(sm(Ht.layers,this.zoom,s),Ht.addFeatures(O,this.tileID.canonical,Qe.patternPositions,s,this.tileTransform))}this.status="done",f(null,{buckets:an(w).filter(rn=>!rn.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:it.image,lineAtlas:E,imageAtlas:Qe,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?it.positions:null})}},Xe=Mn(O.glyphDependencies,it=>Object.keys(it).map(Number));Object.keys(Xe).length?u.send("getGlyphs",{uid:this.uid,stacks:Xe},(it,Qe)=>{U||(U=it,q=Qe,Pe())},void 0,!1,me):q={};const Ae=Object.keys(O.iconDependencies);Ae.length?u.send("getImages",{icons:Ae,source:this.source,tileID:this.tileID,type:"icons"},(it,Qe)=>{U||(U=it,J=Qe,Pe())},void 0,!1,me):J={};const We=Object.keys(O.patternDependencies);We.length?u.send("getImages",{icons:We,source:this.source,tileID:this.tileID,type:"patterns"},(it,Qe)=>{U||(U=it,se=Qe,Pe())},void 0,!1,me):se={},Pe()}}function sm(n,e,r){const s=new N(e);for(const u of n)u.recalculate(s,r)}class Fg{constructor(e){this.entries={},this.scheduler=e}request(e,r,s,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[g,y]=f.result;return this.scheduler?this.scheduler.add(()=>{u(g,y)},r):u(g,y),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=s((g,y)=>{f.result=[g,y];for(const w of f.callbacks)this.scheduler?this.scheduler.add(()=>{w(g,y)},r):w(g,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(g=>g!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function Bg(n,e,r){const s=JSON.stringify(n.request);return n.data&&(this.deduped.entries[s]={result:[null,n.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},u=>{const f=ii(n.request,(g,y,w,E)=>{g?u(g):y&&u(null,{vectorTile:r?void 0:new To(new sf(y)),rawData:y,cacheControl:w,expires:E})});return()=>{f.cancel(),u()}},e)}const Ng=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ef{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(e,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");const u=s>>4;if(1!==u)throw new Error(`Got v${u} data when expected v1.`);const f=Ng[15&s];if(!f)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[y]=new Uint32Array(e,4,1);return new Ef(y,g,f,e)}constructor(e,r=64,s=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=Ng.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,y=e*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-y%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+y+w,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+y+w),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+y+w,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=r,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return sh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:y}=this,w=[0,f.length-1,0],E=[];for(;w.length;){const O=w.pop()||0,z=w.pop()||0,U=w.pop()||0;if(z-U<=y){for(let me=U;me<=z;me++){const Pe=g[2*me],Xe=g[2*me+1];Pe>=e&&Pe<=s&&Xe>=r&&Xe<=u&&E.push(f[me])}continue}const q=U+z>>1,J=g[2*q],se=g[2*q+1];J>=e&&J<=s&&se>=r&&se<=u&&E.push(f[q]),(0===O?e<=J:r<=se)&&(w.push(U),w.push(q-1),w.push(1-O)),(0===O?s>=J:u>=se)&&(w.push(q+1),w.push(z),w.push(1-O))}return E}within(e,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:f,nodeSize:g}=this,y=[0,u.length-1,0],w=[],E=s*s;for(;y.length;){const O=y.pop()||0,z=y.pop()||0,U=y.pop()||0;if(z-U<=g){for(let me=U;me<=z;me++)$g(f[2*me],f[2*me+1],e,r)<=E&&w.push(u[me]);continue}const q=U+z>>1,J=f[2*q],se=f[2*q+1];$g(J,se,e,r)<=E&&w.push(u[q]),(0===O?e-s<=J:r-s<=se)&&(y.push(U),y.push(q-1),y.push(1-O)),(0===O?e+s>=J:r+s>=se)&&(y.push(q+1),y.push(z),y.push(1-O))}return w}}function sh(n,e,r,s,u,f){if(u-s<=r)return;const g=s+u>>1;zg(n,e,g,s,u,f),sh(n,e,r,s,g-1,1-f),sh(n,e,r,g+1,u,1-f)}function zg(n,e,r,s,u,f){for(;u>s;){if(u-s>600){const E=u-s+1,O=r-s+1,z=Math.log(E),U=.5*Math.exp(2*z/3),q=.5*Math.sqrt(z*U*(E-U)/E)*(O-E/2<0?-1:1);zg(n,e,r,Math.max(s,Math.floor(r-O*U/E+q)),Math.min(u,Math.floor(r+(E-O)*U/E+q)),f)}const g=e[2*r+f];let y=s,w=u;for(Yc(n,e,s,r),e[2*u+f]>g&&Yc(n,e,s,u);y<w;){for(Yc(n,e,y,w),y++,w--;e[2*y+f]<g;)y++;for(;e[2*w+f]>g;)w--}e[2*s+f]===g?Yc(n,e,s,w):(w++,Yc(n,e,w,u)),w<=r&&(s=w+1),r<=w&&(u=w-1)}}function Yc(n,e,r,s){am(n,r,s),am(e,2*r,2*s),am(e,2*r+1,2*s+1)}function am(n,e,r){const s=n[e];n[e]=n[r],n[r]=s}function $g(n,e,r,s){const u=n-r,f=e-s;return u*u+f*f}l.ARRAY_TYPE=Ba,l.AUTH_ERR_MSG=Ye,l.Aabb=Ta,l.Actor=class{constructor(n,e,r){this.target=n,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},Qn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Wn()?n:Ee,this.scheduler=new cy}send(n,e,r,s,u=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=f,this.callbacks[g]=r);const y=kr(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:n,hasCallback:!!r,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:_e(e,y)},y),{cancel:()=>{r&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(n){const e=n.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[r];delete this.cancelCallbacks[r],s&&s.cancel()}else if(e.mustQueue||Wn()){const s=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),s&&s.metadata||{type:"message"})}else this.processTask(r,e)}processTask(n,e){if("<response>"===e.type){const r=this.callbacks[n];delete this.callbacks[n],r&&(e.error?r(ze(e.error)):r(null,ze(e.data)))}else{const r=kr(this.globalScope)?void 0:[],s=e.hasCallback?(f,g)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:f?_e(f):null,data:_e(g,r)},r)}:f=>{},u=ze(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,s);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=Jh,l.Color=Si,l.ColorMode=Al,l.CullFaceMode=gl,l.DEMData=Wc,l.DataConstantProperty=ie,l.DedupedRequest=Fg,l.DepthMode=rh,l.EXTENT=zr,l.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const r=e.getSource().maxzoom,s=1<<r,u=Math.floor(n.x),f=Math.floor((n.x-u)*s),g=Math.floor(n.y*s),y=this.findDEMTileFor(new ua(r,u,r,f,g));return!(!y||!y.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,r=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const s=this._source();if(!s||n.y<0||n.y>1)return e;const u=s.getSource().maxzoom,f=1<<u,g=Math.floor(n.x),y=n.x-g,w=new ua(u,g,u,Math.floor(y*f),Math.floor(n.y*f)),E=this.findDEMTileFor(w);if(!E||!E.dem)return e;const O=E.dem,z=1<<E.tileID.canonical.z,U=(y*z-E.tileID.canonical.x)*O.dim,q=(n.y*z-E.tileID.canonical.y)*O.dim,J=Math.floor(U),se=Math.floor(q);return(r?this.exaggeration():1)*K(K(O.get(J,se),O.get(J,se+1),q-se),K(O.get(J+1,se),O.get(J+1,se+1),q-se),U-J)}getAtTileOffset(n,e,r){const s=1<<n.canonical.z;return this.getAtPointOrZero(new Pc(n.wrap+(n.canonical.x+e/zr)/s,(n.canonical.y+r/zr)/s))}getAtTileOffsetFunc(n,e,r,s){return u=>{const f=this.getAtTileOffset(n,u.x,u.y),g=s.upVector(n.canonical,u.x,u.y);return dl(g,g,f*s.upVectorScale(n.canonical,e,r).metersToTile),g}}getForTilePoints(n,e,r,s){if(this.isUsingMockSource())return!1;const u=ih.create(this,n,s);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],r)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const r=e.dem.tree,s=e.tileID,u=1<<n.canonical.z-s.canonical.z;let f=n.canonical.x/u-s.canonical.x,g=n.canonical.y/u-s.canonical.y,y=0;for(let w=0;w<n.canonical.z-s.canonical.z&&!r.leaves[y];w++){f*=2,g*=2;const E=2*Math.floor(g)+Math.floor(f);y=r.childOffsets[y]+E,f%=1,g%=1}return{min:this.exaggeration()*r.minimums[y],max:this.exaggeration()*r.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=Ur,l.EvaluationParameters=N,l.Event=bi,l.Evented=So,l.FillExtrusionBucket=Ju,l.Frustum=Kf,l.FrustumCorners=Xf,l.GLOBE_RADIUS=Hl,l.GLOBE_SCALE_MATCH_LATITUDE=45,l.GLOBE_ZOOM_THRESHOLD_MAX=Ch,l.GLOBE_ZOOM_THRESHOLD_MIN=Dh,l.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,e){const r=new Un,s=new wr,u=[],f=n+1+2,g=e[0]+1,y=e[0]+1+(1+e.length),w=(E,O,z)=>{let U=E===f-1?E-2:0===E?E:E-1;return U+=z?24575:0,[U,O]};for(let E=0;E<f;++E)r.emplaceBack(...w(E,0,!0));for(let E=0;E<g;++E)for(let O=0;O<f;++O)r.emplaceBack(...w(O,E,(0===O||O===f-1)&&!0));for(let E=0;E<e.length;++E){const O=e[E];for(let z=0;z<f;++z)r.emplaceBack(...w(z,O,!0))}for(let E=0;E<e.length;++E){const O=s.length,z=e[E]+1+2,U=new wr;for(let se=0;se<z-1;se++){const me=se===z-2,Pe=me?f*(y-e.length+E-se):f;for(let Xe=0;Xe<f-1;Xe++){const Ae=se*f+Xe;0===se||me||0===Xe||Xe===f-2?(U.emplaceBack(Ae+1,Ae,Ae+Pe),U.emplaceBack(Ae+Pe,Ae+Pe+1,Ae+1)):(s.emplaceBack(Ae+1,Ae,Ae+Pe),s.emplaceBack(Ae+Pe,Ae+Pe+1,Ae+1))}}const q=as.simpleSegment(0,O,r.length,s.length-O);for(let se=0;se<U.uint16.length;se+=3)s.emplaceBack(U.uint16[se],U.uint16[se+1],U.uint16[se+2]);const J=as.simpleSegment(0,O,r.length,s.length-O);u.push({withoutSkirts:q,withSkirts:J})}return{vertices:r,indices:s,segments:u}}_createGrid(n){const e=this._fillGridMeshWithLods(64,zu);this._gridSegments=e.segments,this._gridBuffer=n.createVertexBuffer(e.vertices,Ic.members),this._gridIndexBuffer=n.createIndexBuffer(e.indices,!0)}_createPoles(n){const e=new wr;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const r=new oo,s=new oo;this._poleSegments=[];for(let u=0,f=0;u<Dh;u++){const g=360/(1<<u);r.emplaceBack(0,-Hl,0,.5,0),s.emplaceBack(0,-Hl,0,.5,1);for(let y=0;y<=64;y++){const w=y/64,E=K(0,g,w),[O,z,U]=Vu(km,Hu,E,Hl);r.emplaceBack(O,z,U,w,0),s.emplaceBack(O,z,U,w,1)}this._poleSegments.push(as.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(r,Zf,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(s,Zf,!1)}getGridBuffers(n,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const r=new bo,s=64,u=s+1+2,f=1;this._wireframeSegments=[];for(let g=0,y=0;g<zu.length;g++){const w=zu[g];for(let O=f;O<w+f;O++)for(let z=f;z<s+f;z++){const U=O*u+z;r.emplaceBack(U,U+1),r.emplaceBack(U,U+u),r.emplaceBack(U,U+u+1)}const E=w*s*3;this._wireframeSegments.push(as.simpleSegment(0,y,(w+1)*u,E)),y+=E}this._wireframeIndexBuffer=n.createIndexBuffer(r)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},l.GlyphManager=id,l.ImagePosition=Rp,l.KDBush=Ef,l.LivePerformanceUtils=tn,l.LngLat=po,l.LngLatBounds=Tl,l.LocalGlyphMode=Vp,l.MAX_MERCATOR_LATITUDE=Xs,l.MercatorCoordinate=Pc,l.ONE_EM=Ks,l.OverscaledTileID=ua,l.PerformanceMarkers=Ke,l.Point=Le,l.Properties=$e,l.RGBAImage=ca,l.Ray=Nu,l.RequestManager=class{constructor(n,e,r){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",xt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!dt(n))return n;const r=Ln(n);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!dt(n))return n;const r=Ln(n);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(n,e,r,s){if(!dt(n))return n;const u=Ln(n);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),r&&u.params.push(`language=${r}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(n,e,r,s){const u=Ln(n);return dt(n)?(u.path=`/styles/v1${u.path}/sprite${e}${r}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${r}`,Je(u))}normalizeTileURL(n,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!dt(n))return n;const s=Ln(n);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&"raster"!==s.authority&&512===r?"@2x":""}${vt.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${Et.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${Et.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(f){for(const g of f){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(s.params)||Et.ACCESS_TOKEN;return Et.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(n,e){const r=Ln(n);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return n;let s="mapbox://";r.path.match(/^\/raster\/v1\//)?s+=`raster/${r.path.replace(`/${Et.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${r.path.replace(`/${Et.TILE_URL_VERSION}/`,"")}`;let u=r.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(n,e){const r=!!e&&dt(e),s=[];for(const u of n.tiles||[])Mt(u)?s.push(this.canonicalizeTileURL(u,r)):s.push(u);return s}_makeAPIURL(n,e){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Ln(Et.API_URL);if(n.protocol=s.protocol,n.authority=s.authority,"http"===n.protocol){const u=n.params.indexOf("secure");u>=0&&n.params.splice(u,1)}if("/"!==s.path&&(n.path=`${s.path}${n.path}`),!Et.REQUIRE_ACCESS_TOKEN)return Je(n);if(e=e||Et.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return n.params=n.params.filter(u=>-1===u.indexOf("access_token")),n.params.push(`access_token=${e||""}`),Je(n)}},l.ResourceType=si,l.SegmentVector=as,l.SourceCache=qc,l.StencilMode=wf,l.StructArrayLayout1ui2=Ua,l.StructArrayLayout2f1f2i16=Vr,l.StructArrayLayout2i4=Un,l.StructArrayLayout2ui4=bo,l.StructArrayLayout3f12=Di,l.StructArrayLayout3ui6=wr,l.StructArrayLayout4i8=wn,l.StructArrayLayout5f20=oo,l.Texture=eh,l.Tile=_f,l.Transitionable=re,l.Uniform1f=Fa,l.Uniform1i=class extends ac{constructor(n){super(n),this.current=0}set(n,e,r){this.fetchUniformLocation(n,e)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},l.Uniform2f=class extends ac{constructor(n){super(n),this.current=[0,0]}set(n,e,r){this.fetchUniformLocation(n,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}},l.Uniform3f=class extends ac{constructor(n){super(n),this.current=[0,0,0]}set(n,e,r){this.fetchUniformLocation(n,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}},l.Uniform4f=uu,l.UniformColor=Nf,l.UniformMatrix2f=class extends ac{constructor(n){super(n),this.current=u_}set(n,e,r){if(this.fetchUniformLocation(n,e))for(let s=0;s<4;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}},l.UniformMatrix3f=class extends ac{constructor(n){super(n),this.current=xd}set(n,e,r){if(this.fetchUniformLocation(n,e))for(let s=0;s<9;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},l.UniformMatrix4f=class extends ac{constructor(n){super(n),this.current=_h}set(n,e,r){if(this.fetchUniformLocation(n,e)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let s=1;s<16;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}},l.UnwrappedTileID=Qh,l.ValidationError=cr,l.VectorTileFeature=kc,l.VectorTileWorkerSource=class extends So{constructor(n,e,r,s,u){super(),this.actor=n,this.layerIndex=e,this.availableImages=r,this.loadVectorData=u||Bg,this.loading={},this.loaded={},this.deduped=new Fg(n.scheduler),this.isSpriteLoaded=s,this.scheduler=n.scheduler}loadTile(n,e){const r=n.uid,s=n&&n.request,u=s&&s.collectResourceTiming,f=this.loading[r]=new fy(n);f.abort=this.loadVectorData(n,(g,y)=>{const w=!this.loading[r];if(delete this.loading[r],w||g||!y)return f.status="done",w||(this.loaded[r]=f),e(g);const E=y.rawData,O={};y.expires&&(O.expires=y.expires),y.cacheControl&&(O.cacheControl=y.cacheControl),f.vectorTile=y.vectorTile||new To(new sf(E));const z=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(U,q)=>{if(U||!q)return e(U);const J={};if(u){const se=zn(s);se.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(se)))}e(null,Me({rawTileData:E.slice(0)},q,O,J))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[r]=f})}reloadTile(n,e){const r=this.loaded,s=n.uid,u=this;if(r&&r[s]){const f=r[s];f.showCollisionBoxes=n.showCollisionBoxes,f.enableTerrain=!!n.enableTerrain,f.projection=n.projection,f.tileTransform=wi(n.tileID.canonical,n.projection);const g=(y,w)=>{const E=f.reloadCallback;E&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,E)),e(y,w)};"parsing"===f.status?f.reloadCallback=g:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(n,e){const r=n.uid,s=this.loading[r];s&&(s.abort&&s.abort(),delete this.loading[r]),e()}removeTile(n,e){const r=this.loaded,s=n.uid;r&&r[s]&&delete r[s],e()}},l.WritingMode=il,l.ZoomDependentExpression=zs,l.add=Vl,l.addDynamicAttributes=pf,l.adjoint=function(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=e[4],y=e[5],w=e[6],E=e[7],O=e[8];return n[0]=g*O-y*E,n[1]=u*E-s*O,n[2]=s*y-u*g,n[3]=y*w-f*O,n[4]=r*O-u*w,n[5]=u*f-r*y,n[6]=f*E-g*w,n[7]=s*w-r*E,n[8]=r*g-s*f,n},l.asyncAll=pr,l.bezier=mn,l.bindAll=Qn,l.boundsAttributes=gf,l.bufferConvexPolygon=function(n,e){const r=[];for(let s=0;s<n.length;s++){const u=Wt(s-1,-1,n.length-1),f=Wt(s+1,-1,n.length-1),g=n[s],y=n[f],w=n[u].sub(g).unit(),E=y.sub(g).unit(),O=E.angleWithSep(w.x,w.y),z=w.add(E).unit().mult(-1*e/Math.sin(O/2));r.push(g.add(z))}return r},l.cacheEntryPossiblyAdded=function(n){Lr++,Lr>zi&&(n.getActor().send("enforceCacheSizeLimit",Ai),Lr=0)},l.calculateGlobeLabelMatrix=function(n,e){const{x:r,y:s}=n.point,u=Uu(r,s,n.worldSize/n._pixelsPerMercatorPixel,0,0);return hu(u,u,tp(Ga(e)))},l.calculateGlobeMatrix=function(n){const{x:e,y:r}=n.point,{lng:s,lat:u}=n._center;return Uu(e,r,n.worldSize,s,u)},l.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,r=e/Il(1,n.center.lat),s=ul(new Float64Array(16));return $l(s,s,[n.point.x,n.point.y,0]),Sl(s,s,[r,r,e]),Float32Array.from(s)},l.circumferenceAtLatitude=ip,l.clamp=Gt,l.clearTileCache=function(n){if(!Lo())return;const e=Ee.caches.delete(to);n&&e.catch(n).then(()=>n())},l.clipLine=mg,l.clone=function(n){var e=new Ba(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},l.clone$1=qt,l.collisionCircleLayout=z_,l.config=Et,l.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},l.create=function(){var n=new Ba(16);return Ba!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},l.create$1=xh,l.createExpression=ho,l.createLayout=Ft,l.createStyleLayer=function(n){return"custom"===n.type?new Cg(n):new Qp[n.type](n)},l.cross=Im,l.degToRad=De,l.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},l.div=function(n,e,r){return n[0]=e[0]/r[0],n[1]=e[1]/r[1],n[2]=e[2]/r[2],n},l.dot=ja,l.earthRadius=Ac,l.ease=hn,l.easeCubicInOut=yt,l.ecefToLatLng=function([n,e,r]){const s=Math.hypot(n,e,r),u=Math.atan2(n,r),f=.5*Math.PI-Math.acos(-e/s);return new po(ft(u),ft(f))},l.emitValidationErrors=lu,l.endsWith=ur,l.enforceCacheSizeLimit=function(n){Tr(),Ir&&Ir.then(e=>{e.keys().then(r=>{for(let s=0;s<r.length-n;s++)e.delete(r[s])})})},l.evaluateSizeForFeature=ed,l.evaluateSizeForZoom=Bc,l.evaluateVariableOffset=X_,l.evented=_,l.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},l.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},l.exported=mi,l.exported$1=vt,l.extend=Me,l.extend$1=ei,l.fillExtrusionHeightLift=bp,l.filterObject=Ot,l.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},l.fromQuat=function(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],g=r+r,y=s+s,w=u+u,E=r*g,O=s*g,z=s*y,U=u*g,q=u*y,J=u*w,se=f*g,me=f*y,Pe=f*w;return n[0]=1-z-J,n[1]=O+Pe,n[2]=U-me,n[3]=0,n[4]=O-Pe,n[5]=1-E-J,n[6]=q+se,n[7]=0,n[8]=U+me,n[9]=q-se,n[10]=1-E-z,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},l.fromRotation=function(n,e){var r=Math.sin(e),s=Math.cos(e);return n[0]=s,n[1]=r,n[2]=0,n[3]=-r,n[4]=s,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},l.fromScaling=Uf,l.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return Nt[e]},l.getAABBPointSquareDist=function(n,e,r){let s=0;for(let u=0;u<2;++u){const f=r?r[u]:0;n[u]>f&&(s+=(n[u]-f)*(n[u]-f)),e[u]<f&&(s+=(f-e[u])*(f-e[u]))}return s},l.getAnchorAlignment=Bp,l.getAnchorJustification=vg,l.getBounds=function(n){let e=1/0,r=1/0,s=-1/0,u=-1/0;for(const f of n)e=Math.min(e,f.x),r=Math.min(r,f.y),s=Math.max(s,f.x),u=Math.max(u,f.y);return{min:new Le(e,r),max:new Le(s,u)}},l.getColumn=vi,l.getDefaultExportFromCjs=Kt,l.getGridMatrix=function(n,e,r,s){const u=e.getNorth(),f=e.getSouth(),g=e.getWest(),y=e.getEast(),w=1<<n.z,E=y-g,O=u-f,z=E/64,U=-O/zu[r],q=[0,z,0,U,0,0,u,g,0];if(n.z>0){const J=180/s;Ed(q,q,[J/E+1,0,0,0,J/O+1,0,-.5*J/z,.5*J/U,1])}return q[2]=w,q[5]=n.x,q[8]=n.y,q},l.getImage=ke,l.getJSON=function(n,e){return Pi(Me(n,{type:"json"}),e)},l.getLatitudinalLod=function(n){const e=Xs-5;n=Gt(n,-e,e)/e*90;const r=Math.pow(Math.abs(Math.sin(De(n))),3);return Math.round(r*(zu.length-1))},l.getMapSessionAPI=Oi,l.getPerformanceMeasurement=zn,l.getProjection=Dg,l.getRTLTextPluginStatus=x,l.getReferrer=ai,l.getTilePoint=function(n,{x:e,y:r},s=0){return new Le(((e-s)*n.scale-n.x)*zr,(r*n.scale-n.y)*zr)},l.getTileVec3=function(n,e,r=0){return lc(((e.x-r)*n.scale-n.x)*zr,(e.y*n.scale-n.y)*zr,op(e.z,e.y))},l.getVideo=function(n,e){const r=Ee.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let s=0;s<n.length;s++){const u=Ee.document.createElement("source");cs(n[s])||(r.crossOrigin="Anonymous"),u.src=n[s],r.appendChild(u)}return{cancel:()=>{}}},l.globeCenterToScreenPoint=function(n){const e=[0,0,0],r=ul(new Float64Array(16));return hu(r,n.pixelMatrix,n.globeMatrix),Ps(e,e,r),new Le(e[0],e[1])},l.globeDenormalizeECEF=tp,l.globeECEFOrigin=function(n,e){const r=[0,0,0];return Ps(r,r,mu(Ga(e.canonical))),Ps(r,r,n),r},l.globeMetersToEcef=$u,l.globeNormalizeECEF=mu,l.globePixelsToTileUnits=function(n,e){return zr/(512*Math.pow(2,n))*Ih(Ga(e))},l.globePoleMatrixForTile=function(n,e,r){const s=ul(new Float64Array(16)),u=(e/(1<<n)-.5)*Math.PI*2;return Vf(s,r.globeMatrix,u),Float32Array.from(s)},l.globeTileBounds=Ga,l.globeTiltAtLngLat=Om,l.globeToMercatorTransition=ju,l.globeUseCustomAntiAliasing=function(n,e,r){const s=ju(r.zoom),u=n.style.map._antialias,f=!!e.extStandardDerivatives,g=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return 0===s&&!u&&!g&&f},l.identity=ul,l.identity$1=Wf,l.invert=zf,l.isFullscreen=function(){return!!Ee.document.fullscreenElement||!!Ee.document.webkitFullscreenElement},l.isLngLatBehindGlobe=Ah,l.isMapAuthenticated=function(n){return rt.has(n)},l.isMapboxURL=dt,l.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!kr(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},l.latFromMercatorY=_a,l.latLngToECEF=pu,l.len=_v,l.length=Dd,l.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},l.lngFromMercatorX=nl,l.loadVectorTile=Bg,l.makeRequest=Pi,l.mapValue=function(n,e,r,s,u){return Gt((n-e)/(r-e)*(u-s)+s,s,u)},l.mercatorScale=Ph,l.mercatorXfromLng=Wl,l.mercatorYfromLat=ql,l.mercatorZfromAltitude=Il,l.mul=mv,l.mul$1=gv,l.multiply=hu,l.multiply$1=Ed,l.multiply$2=Gf,l.nextPowerOfTwo=cn,l.normalize=Ca,l.normalize$1=Bu,l.normalize$2=Mm,l.number=K,l.ortho=function(n,e,r,s,u,f,g){var y=1/(e-r),w=1/(s-u),E=1/(f-g);return n[0]=-2*y,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*w,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*E,n[11]=0,n[12]=(e+r)*y,n[13]=(u+s)*w,n[14]=(g+f)*E,n[15]=1,n},l.pbf=Wd,l.perspective=function(n,e,r,s,u){var f,g=1/Math.tan(e/2);return n[0]=g/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=u&&u!==1/0?(n[10]=(u+s)*(f=1/(s-u)),n[14]=2*u*s*f):(n[10]=-1,n[14]=-2*s),n},l.pick=function(n,e){const r={};for(let s=0;s<e.length;s++){const u=e[s];u in n&&(r[u]=n[u])}return r},l.plugin=A,l.pointGeometry=Tt,l.polesInViewport=function(n){const e=ul(new Float64Array(16));hu(e,n.pixelMatrix,n.globeMatrix);const r=[0,hl,0],s=[0,fl,0];return Ps(r,r,e),Ps(s,s,e),[r[0]>0&&r[0]<=n.width&&r[1]>0&&r[1]<=n.height&&!Ah(n,new po(n.center.lat,90)),s[0]>0&&s[0]<=n.width&&s[1]>0&&s[1]<=n.height&&!Ah(n,new po(n.center.lat,-90))]},l.polygonContainsPoint=Rc,l.polygonIntersectsBox=Bh,l.polygonIntersectsPolygon=lp,l.polygonizeBounds=function(n,e,r=0,s=!0){const u=new Le(r,r),f=n.sub(u),g=e.add(u),y=[f,new Le(g.x,f.y),g,new Le(f.x,g.y)];return s&&y.push(f.clone()),y},l.posAttributes=Ic,l.postMapLoadEvent=gr,l.postPerformanceEvent=$r,l.postTurnstileEvent=dn,l.potpack=zc,l.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},l.radToDeg=ft,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(n){return n({pluginStatus:h,pluginURL:i}),_.on("pluginStateChange",n),n},l.removeAuthState=function(n){rt.delete(n)},l.renderColorRamp=Ld,l.resample=Lm,l.rotateX=$f,l.rotateX$1=qf,l.rotateY=Vf,l.rotateY$1=Yf,l.rotateZ=function(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[0],g=e[1],y=e[2],w=e[3],E=e[4],O=e[5],z=e[6],U=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u+E*s,n[1]=g*u+O*s,n[2]=y*u+z*s,n[3]=w*u+U*s,n[4]=E*u-f*s,n[5]=O*u-g*s,n[6]=z*u-y*s,n[7]=U*u-w*s,n},l.rotateZ$1=function(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],y=Math.sin(r),w=Math.cos(r);return n[0]=s*w+u*y,n[1]=u*w-s*y,n[2]=f*w+g*y,n[3]=g*w-f*y,n},l.scale=Sl,l.scale$1=m_,l.scale$2=dl,l.scaleAndAdd=Cd,l.set=function(n,e,r,s){return n[0]=e,n[1]=r,n[2]=s,n},l.setCacheLimits=function(n,e){Ai=n,zi=e},l.setColumn=function(n,e,r){n[4*e+0]=r[0],n[4*e+1]=r[1],n[4*e+2]=r[2],n[4*e+3]=r[3]},l.setRTLTextPlugin=function(n,e,r=!1){if(h===sc||h===Ka||h===Ou)throw new Error("setRTLTextPlugin cannot be called multiple times.");i=mi.resolveURL(n),h=sc,Dl=e,p(),r||C()},l.smoothstep=nr,l.spec=zt,l.squaredLength=function(n){var e=n[0],r=n[1],s=n[2];return e*e+r*r+s*s},l.storeAuthState=function(n,e){e?rt.add(n):rt.delete(n)},l.sub=Ul,l.subtract=Hf,l.symbolSize=Gd,l.tileAABB=function(n,e,r,s,u,f,g,y,w){if("globe"===w.name)return function Rm(n,e,r){const s=e/n.worldSize,u=n.globeMatrix;if(r.z<=1){const Ht=Ga(r).getCorners();return Pm(Ht,u,s),Ta.fromPoints(Ht)}const f=Th(r),g=Sh(f);Pm(g,u,s);const y=Number.MAX_VALUE,w=[-y,-y,-y],E=[y,y,y];if(f.contains(n.center)){for(const Nn of g)bh(E,E,Nn),Fu(w,w,Nn);w[2]=0;const Ht=n.point,xn=[Ht.x*s,Ht.y*s,0];return bh(E,E,xn),Fu(w,w,xn),new Ta(E,w)}const O=[u[12]*s,u[13]*s,u[14]*s],z=f.getCenter(),U=Gt(n.center.lat,-Xs,Xs),q=Gt(z.lat,-Xs,Xs),J=Wl(n.center.lng),se=ql(U);let me=J-Wl(z.lng);const Pe=se-ql(q);me>.5?me-=1:me<-.5&&(me+=1);let Xe=0;Math.abs(me)>Math.abs(Pe)?Xe=me>=0?1:3:(Xe=Pe>=0?0:2,Cd(O,O,[u[4]*s,u[5]*s,u[6]*s],-Math.sin(De(Pe>=0?f.getSouth():f.getNorth()))*Hl));const Ae=g[Xe],We=g[(Xe+1)%4],it=new Qf(Ae,We,O),Qe=[ga(it,0)||Ae[0],ga(it,1)||Ae[1],ga(it,2)||Ae[2]],rn=ju(n.zoom);if(rn>0){const Ht=function({x:Nn,y:on,z:Sn},In,Fn,jn,gn){const ir=1/(1<<Sn);let vr=Nn*ir,sr=vr+ir,gi=on*ir,Xn=gi+ir,Fr=0;const _i=(vr+sr)/2-jn;return _i>.5?Fr=-1:_i<-.5&&(Fr=1),vr=((vr+Fr)*In-(jn*=In))*Fn+jn,sr=((sr+Fr)*In-jn)*Fn+jn,gi=(gi*In-(gn*=In))*Fn+gn,Xn=(Xn*In-gn)*Fn+gn,[[vr,Xn,0],[sr,Xn,0],[sr,gi,0],[vr,gi,0]]}(r,e,n._pixelsPerMercatorPixel,J,se);for(let Nn=0;Nn<g.length;Nn++)Mc(g[Nn],Ht[Nn],rn);const xn=Vl([],Ht[Xe],Ht[(Xe+1)%4]);dl(xn,xn,.5),Mc(Qe,xn,rn)}for(const Ht of g)bh(E,E,Ht),Fu(w,w,Ht);return E[2]=Math.min(Ae[2],We[2]),bh(E,E,Qe),Fu(w,w,Qe),new Ta(E,w)}(n,e,new Jh(r,s,u));const E=wi({z:r,x:s,y:u},w);return new Ta([(f+E.x/E.scale)*e,e*(E.y/E.scale),g],[(f+E.x2/E.scale)*e,e*(E.y2/E.scale),y])},l.tileCornersToBounds=Th,l.tileTransform=wi,l.transformMat3=function(n,e,r){var s=e[0],u=e[1],f=e[2];return n[0]=s*r[0]+u*r[3]+f*r[6],n[1]=s*r[1]+u*r[4]+f*r[7],n[2]=s*r[2]+u*r[5]+f*r[8],n},l.transformMat4=Ps,l.transformMat4$1=jl,l.transformQuat=wh,l.transitionTileAABBinECEF=ep,l.translate=$l,l.transpose=function(n,e){if(n===e){var r=e[1],s=e[2],u=e[5];n[1]=e[3],n[2]=e[6],n[3]=r,n[5]=e[7],n[6]=s,n[7]=u}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},l.triggerPluginCompletionEvent=c,l.uniqueId=at,l.updateGlobeVertexNormal=function(n,e,r,s,u){const f=5*e+2;n.float32[f+0]=r,n.float32[f+1]=s,n.float32[f+2]=u},l.validateCustomStyleLayer=function(n){const e=[],r=n.id;return void 0===r&&e.push({message:`layers.${r}: missing required property "id"`}),void 0===n.render&&e.push({message:`layers.${r}: missing required method "render"`}),n.renderingMode&&"2d"!==n.renderingMode&&"3d"!==n.renderingMode&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateFilter=n=>Oa(El(n)),l.validateFog=n=>Oa(Va(n)),l.validateLayer=n=>Oa(Ra(n)),l.validateLight=n=>Oa(ou(n)),l.validateSource=n=>Oa(Au(n)),l.validateStyle=au,l.validateTerrain=n=>Oa(qs(n)),l.values=an,l.vectorTile=Zh,l.version=ot,l.warnOnce=vn,l.window=Ee,l.wrap=Wt}),b(0,function(l){function Ee(je){if("number"==typeof je||"boolean"==typeof je||"string"==typeof je||null==je)return JSON.stringify(je);if(Array.isArray(je)){let de="[";for(const ke of je)de+=`${Ee(ke)},`;return`${de}]`}let ae="{";for(const de of Object.keys(je).sort())ae+=`${de}:${Ee(je[de])},`;return`${ae}}`}function ot(je){let ae="";for(const de of l.refProperties)ae+=`/${Ee(je[de])}`;return ae}class qe{constructor(ae){this.keyCache={},ae&&this.replace(ae)}replace(ae){this._layerConfigs={},this._layers={},this.update(ae,[])}update(ae,de){for(const Ye of ae)this._layerConfigs[Ye.id]=Ye,(this._layers[Ye.id]=l.createStyleLayer(Ye)).compileFilter(),this.keyCache[Ye.id]&&delete this.keyCache[Ye.id];for(const Ye of de)delete this.keyCache[Ye],delete this._layerConfigs[Ye],delete this._layers[Ye];this.familiesBySource={};const ke=function(Ye,dt){const Mt={};for(let lt=0;lt<Ye.length;lt++){const Vt=dt&&dt[Ye[lt].id]||ot(Ye[lt]);dt&&(dt[Ye[lt].id]=Vt);let En=Mt[Vt];En||(En=Mt[Vt]=[]),En.push(Ye[lt])}const St=[];for(const lt in Mt)St.push(Mt[lt]);return St}(l.values(this._layerConfigs),this.keyCache);for(const Ye of ke){const dt=Ye.map(Ln=>this._layers[Ln.id]),Mt=dt[0];if("none"===Mt.visibility)continue;const St=Mt.source||"";let lt=this.familiesBySource[St];lt||(lt=this.familiesBySource[St]={});const Vt=Mt.sourceLayer||"_geojsonTileLayer";let En=lt[Vt];En||(En=lt[Vt]=[]),En.push(dt)}}}class Et{loadTile(ae,de){const{uid:ke,encoding:Ye,rawImageData:dt,padding:Mt,buildQuadTree:St}=ae,lt=l.window.ImageBitmap&&dt instanceof l.window.ImageBitmap?this.getImageData(dt,Mt):dt;de(null,new l.DEMData(ke,lt,Ye,Mt<1,St))}getImageData(ae,de){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ae.width,ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ae.width,this.offscreenCanvas.height=ae.height,this.offscreenCanvasContext.drawImage(ae,0,0,ae.width,ae.height);const ke=this.offscreenCanvasContext.getImageData(-de,-de,ae.width+2*de,ae.height+2*de);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ke}}function vt(je,ae){if(0!==je.length){tt(je[0],ae);for(var de=1;de<je.length;de++)tt(je[de],!ae)}}function tt(je,ae){for(var de=0,ke=0,Ye=0,dt=je.length,Mt=dt-1;Ye<dt;Mt=Ye++){var St=(je[Ye][0]-je[Mt][0])*(je[Mt][1]+je[Ye][1]),lt=de+St;ke+=Math.abs(de)>=Math.abs(St)?de-lt+St:St-lt+de,de=lt}de+ke>=0!=!!ae&&je.reverse()}var nt=l.getDefaultExportFromCjs(function je(ae,de){var ke,Ye=ae&&ae.type;if("FeatureCollection"===Ye)for(ke=0;ke<ae.features.length;ke++)je(ae.features[ke],de);else if("GeometryCollection"===Ye)for(ke=0;ke<ae.geometries.length;ke++)je(ae.geometries[ke],de);else if("Feature"===Ye)je(ae.geometry,de);else if("Polygon"===Ye)vt(ae.coordinates,de);else if("MultiPolygon"===Ye)for(ke=0;ke<ae.coordinates.length;ke++)vt(ae.coordinates[ke],de);return ae});const wt=l.VectorTileFeature.prototype.toGeoJSON;var ht={exports:{}},et=l.pointGeometry,xt=l.vectorTile.VectorTileFeature,Kt=It;function It(je,ae){this.options=ae||{},this.features=je,this.length=je.length}function st(je,ae){this.id="number"==typeof je.id?je.id:void 0,this.type=je.type,this.rawGeometry=1===je.type?[je.geometry]:je.geometry,this.properties=je.tags,this.extent=ae||4096}It.prototype.feature=function(je){return new st(this.features[je],this.options.extent)},st.prototype.loadGeometry=function(){var je=this.rawGeometry;this.geometry=[];for(var ae=0;ae<je.length;ae++){for(var de=je[ae],ke=[],Ye=0;Ye<de.length;Ye++)ke.push(new et(de[Ye][0],de[Ye][1]));this.geometry.push(ke)}return this.geometry},st.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var je=this.geometry,ae=1/0,de=-1/0,ke=1/0,Ye=-1/0,dt=0;dt<je.length;dt++)for(var Mt=je[dt],St=0;St<Mt.length;St++){var lt=Mt[St];ae=Math.min(ae,lt.x),de=Math.max(de,lt.x),ke=Math.min(ke,lt.y),Ye=Math.max(Ye,lt.y)}return[ae,ke,de,Ye]},st.prototype.toGeoJSON=xt.prototype.toGeoJSON;var sn=l.pbf,Tt=Kt;function Ge(je){var ae=new sn;return function(de,ke){for(var Ye in de.layers)ke.writeMessage(3,Le,de.layers[Ye])}(je,ae),ae.finish()}function Le(je,ae){var de;ae.writeVarintField(15,je.version||1),ae.writeStringField(1,je.name||""),ae.writeVarintField(5,je.extent||4096);var ke={keys:[],values:[],keycache:{},valuecache:{}};for(de=0;de<je.length;de++)ke.feature=je.feature(de),ae.writeMessage(2,Yt,ke);var Ye=ke.keys;for(de=0;de<Ye.length;de++)ae.writeStringField(3,Ye[de]);var dt=ke.values;for(de=0;de<dt.length;de++)ae.writeMessage(4,yt,dt[de])}function Yt(je,ae){var de=je.feature;void 0!==de.id&&ae.writeVarintField(1,de.id),ae.writeMessage(2,_n,je),ae.writeVarintField(3,de.type),ae.writeMessage(4,Nt,de)}function _n(je,ae){var de=je.feature,ke=je.keys,Ye=je.values,dt=je.keycache,Mt=je.valuecache;for(var St in de.properties){var lt=de.properties[St],Vt=dt[St];if(null!==lt){void 0===Vt&&(ke.push(St),dt[St]=Vt=ke.length-1),ae.writeVarint(Vt);var En=typeof lt;"string"!==En&&"boolean"!==En&&"number"!==En&&(lt=JSON.stringify(lt));var Ln=En+":"+lt,Je=Mt[Ln];void 0===Je&&(Ye.push(lt),Mt[Ln]=Je=Ye.length-1),ae.writeVarint(Je)}}}function De(je,ae){return(ae<<3)+(7&je)}function ft(je){return je<<1^je>>31}function Nt(je,ae){for(var de=je.loadGeometry(),ke=je.type,Ye=0,dt=0,Mt=de.length,St=0;St<Mt;St++){var lt=de[St],Vt=1;1===ke&&(Vt=lt.length),ae.writeVarint(De(1,Vt));for(var En=3===ke?lt.length-1:lt.length,Ln=0;Ln<En;Ln++){1===Ln&&1!==ke&&ae.writeVarint(De(2,En-1));var Je=lt[Ln].x-Ye,Ze=lt[Ln].y-dt;ae.writeVarint(ft(Je)),ae.writeVarint(ft(Ze)),Ye+=Je,dt+=Ze}3===ke&&ae.writeVarint(De(7,1))}}function yt(je,ae){var de=typeof je;"string"===de?ae.writeStringField(1,je):"boolean"===de?ae.writeBooleanField(7,je):"number"===de&&(je%1!=0?ae.writeDoubleField(3,je):je<0?ae.writeSVarintField(6,je):ae.writeVarintField(5,je))}ht.exports=Ge,ht.exports.fromVectorTileJs=Ge,ht.exports.fromGeojsonVt=function(je,ae){ae=ae||{};var de={};for(var ke in je)de[ke]=new Tt(je[ke].features,ae),de[ke].name=ke,de[ke].version=ae.version,de[ke].extent=ae.extent;return Ge({layers:de})},ht.exports.GeoJSONWrapper=Tt;var mn=l.getDefaultExportFromCjs(ht.exports);const hn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:je=>je},Gt=Math.fround||(nr=new Float32Array(1),je=>(nr[0]=+je,nr[0]));var nr;const Wt=3,pr=5,an=6;class Me{constructor(ae){this.options=Object.assign(Object.create(hn),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:de,minZoom:ke,maxZoom:Ye}=this.options;de&&console.time("total time");const dt=`prepare ${ae.length} points`;de&&console.time(dt),this.points=ae;const Mt=[];for(let lt=0;lt<ae.length;lt++){const Vt=ae[lt];if(!Vt.geometry)continue;const[En,Ln]=Vt.geometry.coordinates,Je=Gt(Rt(En)),Ze=Gt(cn(Ln));Mt.push(Je,Ze,1/0,lt,-1,1),this.options.reduce&&Mt.push(0)}let St=this.trees[Ye+1]=this._createTree(Mt);de&&console.timeEnd(dt);for(let lt=Ye;lt>=ke;lt--){const Vt=+Date.now();St=this.trees[lt]=this._createTree(this._cluster(St,lt)),de&&console.log("z%d: %d clusters in %dms",lt,St.numItems,+Date.now()-Vt)}return de&&console.timeEnd("total time"),this}getClusters(ae,de){let ke=((ae[0]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ae[1]));let dt=180===ae[2]?180:((ae[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)ke=-180,dt=180;else if(ke>dt){const Ln=this.getClusters([ke,Ye,180,Mt],de),Je=this.getClusters([-180,Ye,dt,Mt],de);return Ln.concat(Je)}const St=this.trees[this._limitZoom(de)],lt=St.range(Rt(ke),cn(Mt),Rt(dt),cn(Ye)),Vt=St.data,En=[];for(const Ln of lt){const Je=this.stride*Ln;En.push(Vt[Je+pr]>1?Ue(Vt,Je,this.clusterProps):this.points[Vt[Je+Wt]])}return En}getChildren(ae){const de=this._getOriginId(ae),ke=this._getOriginZoom(ae),Ye="No cluster with the specified id.",dt=this.trees[ke];if(!dt)throw new Error(Ye);const Mt=dt.data;if(de*this.stride>=Mt.length)throw new Error(Ye);const St=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),lt=dt.within(Mt[de*this.stride],Mt[de*this.stride+1],St),Vt=[];for(const En of lt){const Ln=En*this.stride;Mt[Ln+4]===ae&&Vt.push(Mt[Ln+pr]>1?Ue(Mt,Ln,this.clusterProps):this.points[Mt[Ln+Wt]])}if(0===Vt.length)throw new Error(Ye);return Vt}getLeaves(ae,de,ke){const Ye=[];return this._appendLeaves(Ye,ae,de=de||10,ke=ke||0,0),Ye}getTile(ae,de,ke){const Ye=this.trees[this._limitZoom(ae)],dt=Math.pow(2,ae),{extent:Mt,radius:St}=this.options,lt=St/Mt,Vt=(ke-lt)/dt,En=(ke+1+lt)/dt,Ln={features:[]};return this._addTileFeatures(Ye.range((de-lt)/dt,Vt,(de+1+lt)/dt,En),Ye.data,de,ke,dt,Ln),0===de&&this._addTileFeatures(Ye.range(1-lt/dt,Vt,1,En),Ye.data,dt,ke,dt,Ln),de===dt-1&&this._addTileFeatures(Ye.range(0,Vt,lt/dt,En),Ye.data,-1,ke,dt,Ln),Ln.features.length?Ln:null}getClusterExpansionZoom(ae){let de=this._getOriginZoom(ae)-1;for(;de<=this.options.maxZoom;){const ke=this.getChildren(ae);if(de++,1!==ke.length)break;ae=ke[0].properties.cluster_id}return de}_appendLeaves(ae,de,ke,Ye,dt){const Mt=this.getChildren(de);for(const St of Mt){const lt=St.properties;if(lt&&lt.cluster?dt+lt.point_count<=Ye?dt+=lt.point_count:dt=this._appendLeaves(ae,lt.cluster_id,ke,Ye,dt):dt<Ye?dt++:ae.push(St),ae.length===ke)break}return dt}_createTree(ae){const de=new l.KDBush(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ke=0;ke<ae.length;ke+=this.stride)de.add(ae[ke],ae[ke+1]);return de.finish(),de.data=ae,de}_addTileFeatures(ae,de,ke,Ye,dt,Mt){for(const St of ae){const lt=St*this.stride,Vt=de[lt+pr]>1;let En,Ln,Je;if(Vt)En=at(de,lt,this.clusterProps),Ln=de[lt],Je=de[lt+1];else{const He=this.points[de[lt+Wt]];En=He.properties;const[At,dn]=He.geometry.coordinates;Ln=Rt(At),Je=cn(dn)}const Ze={type:1,geometry:[[Math.round(this.options.extent*(Ln*dt-ke)),Math.round(this.options.extent*(Je*dt-Ye))]],tags:En};let Dt;Dt=Vt||this.options.generateId?de[lt+Wt]:this.points[de[lt+Wt]].id,void 0!==Dt&&(Ze.id=Dt),Mt.features.push(Ze)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,de){const{radius:ke,extent:Ye,reduce:dt,minPoints:Mt}=this.options,St=ke/(Ye*Math.pow(2,de)),lt=ae.data,Vt=[],En=this.stride;for(let Ln=0;Ln<lt.length;Ln+=En){if(lt[Ln+2]<=de)continue;lt[Ln+2]=de;const Je=lt[Ln],Ze=lt[Ln+1],Dt=ae.within(lt[Ln],lt[Ln+1],St),He=lt[Ln+pr];let At=He;for(const dn of Dt){const qn=dn*En;lt[qn+2]>de&&(At+=lt[qn+pr])}if(At>He&&At>=Mt){let dn,qn=Je*He,gr=Ze*He,Mr=-1;const $r=((Ln/En|0)<<5)+(de+1)+this.points.length;for(const Qr of Dt){const Oi=Qr*En;if(lt[Oi+2]<=de)continue;lt[Oi+2]=de;const rt=lt[Oi+pr];qn+=lt[Oi]*rt,gr+=lt[Oi+1]*rt,lt[Oi+4]=$r,dt&&(dn||(dn=this._map(lt,Ln,!0),Mr=this.clusterProps.length,this.clusterProps.push(dn)),dt(dn,this._map(lt,Oi)))}lt[Ln+4]=$r,Vt.push(qn/At,gr/At,1/0,$r,-1,At),dt&&Vt.push(Mr)}else{for(let dn=0;dn<En;dn++)Vt.push(lt[Ln+dn]);if(At>1)for(const dn of Dt){const qn=dn*En;if(!(lt[qn+2]<=de)){lt[qn+2]=de;for(let gr=0;gr<En;gr++)Vt.push(lt[qn+gr])}}}}return Vt}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,de,ke){if(ae[de+pr]>1){const Mt=this.clusterProps[ae[de+an]];return ke?Object.assign({},Mt):Mt}const Ye=this.points[ae[de+Wt]].properties,dt=this.options.map(Ye);return ke&&dt===Ye?Object.assign({},dt):dt}}function Ue(je,ae,de){return{type:"Feature",id:je[ae+Wt],properties:at(je,ae,de),geometry:{type:"Point",coordinates:[(ke=je[ae],360*(ke-.5)),un(je[ae+1])]}};var ke}function at(je,ae,de){const ke=je[ae+pr],Ye=ke>=1e4?`${Math.round(ke/1e3)}k`:ke>=1e3?Math.round(ke/100)/10+"k":ke,dt=je[ae+an],Mt=-1===dt?{}:Object.assign({},de[dt]);return Object.assign(Mt,{cluster:!0,cluster_id:je[ae+Wt],point_count:ke,point_count_abbreviated:Ye})}function Rt(je){return je/360+.5}function cn(je){const ae=Math.sin(je*Math.PI/180),de=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return de<0?0:de>1?1:de}function un(je){const ae=(180-360*je)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function Qn(je,ae,de,ke){for(var Ye,dt=ke,Mt=de-ae>>1,St=de-ae,lt=je[ae],Vt=je[ae+1],En=je[de],Ln=je[de+1],Je=ae+3;Je<de;Je+=3){var Ze=ur(je[Je],je[Je+1],lt,Vt,En,Ln);if(Ze>dt)Ye=Je,dt=Ze;else if(Ze===dt){var Dt=Math.abs(Je-Mt);Dt<St&&(Ye=Je,St=Dt)}}dt>ke&&(Ye-ae>3&&Qn(je,ae,Ye,ke),je[Ye+2]=dt,de-Ye>3&&Qn(je,Ye,de,ke))}function ur(je,ae,de,ke,Ye,dt){var Mt=Ye-de,St=dt-ke;if(0!==Mt||0!==St){var lt=((je-de)*Mt+(ae-ke)*St)/(Mt*Mt+St*St);lt>1?(de=Ye,ke=dt):lt>0&&(de+=Mt*lt,ke+=St*lt)}return(Mt=je-de)*Mt+(St=ae-ke)*St}function Mn(je,ae,de,ke){var Ye={id:void 0===je?null:je,type:ae,geometry:de,tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(dt){var Mt=dt.geometry,St=dt.type;if("Point"===St||"MultiPoint"===St||"LineString"===St)Ot(dt,Mt);else if("Polygon"===St||"MultiLineString"===St)for(var lt=0;lt<Mt.length;lt++)Ot(dt,Mt[lt]);else if("MultiPolygon"===St)for(lt=0;lt<Mt.length;lt++)for(var Vt=0;Vt<Mt[lt].length;Vt++)Ot(dt,Mt[lt][Vt])}(Ye),Ye}function Ot(je,ae){for(var de=0;de<ae.length;de+=3)je.minX=Math.min(je.minX,ae[de]),je.minY=Math.min(je.minY,ae[de+1]),je.maxX=Math.max(je.maxX,ae[de]),je.maxY=Math.max(je.maxY,ae[de+1])}function qt(je,ae,de,ke){if(ae.geometry){var Ye=ae.geometry.coordinates,dt=ae.geometry.type,Mt=Math.pow(de.tolerance/((1<<de.maxZoom)*de.extent),2),St=[],lt=ae.id;if(de.promoteId?lt=ae.properties[de.promoteId]:de.generateId&&(lt=ke||0),"Point"===dt)$t(Ye,St);else if("MultiPoint"===dt)for(var Vt=0;Vt<Ye.length;Vt++)$t(Ye[Vt],St);else if("LineString"===dt)vn(Ye,St,Mt,!1);else if("MultiLineString"===dt){if(de.lineMetrics){for(Vt=0;Vt<Ye.length;Vt++)vn(Ye[Vt],St=[],Mt,!1),je.push(Mn(lt,"LineString",St,ae.properties));return}Gn(Ye,St,Mt,!1)}else if("Polygon"===dt)Gn(Ye,St,Mt,!0);else{if("MultiPolygon"!==dt){if("GeometryCollection"===dt){for(Vt=0;Vt<ae.geometry.geometries.length;Vt++)qt(je,{id:lt,geometry:ae.geometry.geometries[Vt],properties:ae.properties},de,ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Vt=0;Vt<Ye.length;Vt++){var En=[];Gn(Ye[Vt],En,Mt,!0),St.push(En)}}je.push(Mn(lt,dt,St,ae.properties))}}function $t(je,ae){ae.push(Cr(je[0])),ae.push(Wn(je[1])),ae.push(0)}function vn(je,ae,de,ke){for(var Ye,dt,Mt=0,St=0;St<je.length;St++){var lt=Cr(je[St][0]),Vt=Wn(je[St][1]);ae.push(lt),ae.push(Vt),ae.push(0),St>0&&(Mt+=ke?(Ye*Vt-lt*dt)/2:Math.sqrt(Math.pow(lt-Ye,2)+Math.pow(Vt-dt,2))),Ye=lt,dt=Vt}var En=ae.length-3;ae[2]=1,Qn(ae,0,En,de),ae[En+2]=1,ae.size=Math.abs(Mt),ae.start=0,ae.end=ae.size}function Gn(je,ae,de,ke){for(var Ye=0;Ye<je.length;Ye++){var dt=[];vn(je[Ye],dt,de,ke),ae.push(dt)}}function Cr(je){return je/360+.5}function Wn(je){var ae=Math.sin(je*Math.PI/180),de=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return de<0?0:de>1?1:de}function Dr(je,ae,de,ke,Ye,dt,Mt,St){if(ke/=ae,dt>=(de/=ae)&&Mt<ke)return je;if(Mt<de||dt>=ke)return null;for(var lt=[],Vt=0;Vt<je.length;Vt++){var En=je[Vt],Ln=En.geometry,Je=En.type,Ze=0===Ye?En.minX:En.minY,Dt=0===Ye?En.maxX:En.maxY;if(Ze>=de&&Dt<ke)lt.push(En);else if(!(Dt<de||Ze>=ke)){var He=[];if("Point"===Je||"MultiPoint"===Je)er(Ln,He,de,ke,Ye);else if("LineString"===Je)kr(Ln,He,de,ke,Ye,!1,St.lineMetrics);else if("MultiLineString"===Je)vi(Ln,He,de,ke,Ye,!1);else if("Polygon"===Je)vi(Ln,He,de,ke,Ye,!0);else if("MultiPolygon"===Je)for(var At=0;At<Ln.length;At++){var dn=[];vi(Ln[At],dn,de,ke,Ye,!0),dn.length&&He.push(dn)}if(He.length){if(St.lineMetrics&&"LineString"===Je){for(At=0;At<He.length;At++)lt.push(Mn(En.id,Je,He[At],En.tags));continue}"LineString"!==Je&&"MultiLineString"!==Je||(1===He.length?(Je="LineString",He=He[0]):Je="MultiLineString"),"Point"!==Je&&"MultiPoint"!==Je||(Je=3===He.length?"Point":"MultiPoint"),lt.push(Mn(En.id,Je,He,En.tags))}}}return lt.length?lt:null}function er(je,ae,de,ke,Ye){for(var dt=0;dt<je.length;dt+=3){var Mt=je[dt+Ye];Mt>=de&&Mt<=ke&&(ae.push(je[dt]),ae.push(je[dt+1]),ae.push(je[dt+2]))}}function kr(je,ae,de,ke,Ye,dt,Mt){for(var St,lt,Vt=An(je),En=0===Ye?Ai:zi,Ln=je.start,Je=0;Je<je.length-3;Je+=3){var Ze=je[Je],Dt=je[Je+1],He=je[Je+2],At=je[Je+3],dn=je[Je+4],qn=0===Ye?Ze:Dt,gr=0===Ye?At:dn,Mr=!1;Mt&&(St=Math.sqrt(Math.pow(Ze-At,2)+Math.pow(Dt-dn,2))),qn<de?gr>de&&(lt=En(Vt,Ze,Dt,At,dn,de),Mt&&(Vt.start=Ln+St*lt)):qn>ke?gr<ke&&(lt=En(Vt,Ze,Dt,At,dn,ke),Mt&&(Vt.start=Ln+St*lt)):to(Vt,Ze,Dt,He),gr<de&&qn>=de&&(lt=En(Vt,Ze,Dt,At,dn,de),Mr=!0),gr>ke&&qn<=ke&&(lt=En(Vt,Ze,Dt,At,dn,ke),Mr=!0),!dt&&Mr&&(Mt&&(Vt.end=Ln+St*lt),ae.push(Vt),Vt=An(je)),Mt&&(Ln+=St)}var $r=je.length-3;Ze=je[$r],Dt=je[$r+1],He=je[$r+2],(qn=0===Ye?Ze:Dt)>=de&&qn<=ke&&to(Vt,Ze,Dt,He),$r=Vt.length-3,dt&&$r>=3&&(Vt[$r]!==Vt[0]||Vt[$r+1]!==Vt[1])&&to(Vt,Vt[0],Vt[1],Vt[2]),Vt.length&&ae.push(Vt)}function An(je){var ae=[];return ae.size=je.size,ae.start=je.start,ae.end=je.end,ae}function vi(je,ae,de,ke,Ye,dt){for(var Mt=0;Mt<je.length;Mt++)kr(je[Mt],ae,de,ke,Ye,dt,!1)}function to(je,ae,de,ke){je.push(ae),je.push(de),je.push(ke)}function Ai(je,ae,de,ke,Ye,dt){var Mt=(dt-ae)/(ke-ae);return je.push(dt),je.push(de+(Ye-de)*Mt),je.push(1),Mt}function zi(je,ae,de,ke,Ye,dt){var Mt=(dt-de)/(Ye-de);return je.push(ae+(ke-ae)*Mt),je.push(dt),je.push(1),Mt}function Ir(je,ae){for(var de=[],ke=0;ke<je.length;ke++){var Ye,dt=je[ke],Mt=dt.type;if("Point"===Mt||"MultiPoint"===Mt||"LineString"===Mt)Ye=Hr(dt.geometry,ae);else if("MultiLineString"===Mt||"Polygon"===Mt){Ye=[];for(var St=0;St<dt.geometry.length;St++)Ye.push(Hr(dt.geometry[St],ae))}else if("MultiPolygon"===Mt)for(Ye=[],St=0;St<dt.geometry.length;St++){for(var lt=[],Vt=0;Vt<dt.geometry[St].length;Vt++)lt.push(Hr(dt.geometry[St][Vt],ae));Ye.push(lt)}de.push(Mn(dt.id,Mt,Ye,dt.tags))}return de}function Hr(je,ae){var de=[];de.size=je.size,void 0!==je.start&&(de.start=je.start,de.end=je.end);for(var ke=0;ke<je.length;ke+=3)de.push(je[ke]+ae,je[ke+1],je[ke+2]);return de}function Lo(je,ae){if(je.transformed)return je;var de,ke,Ye,dt=1<<je.z,Mt=je.x,St=je.y;for(de=0;de<je.features.length;de++){var lt=je.features[de],Vt=lt.geometry,En=lt.type;if(lt.geometry=[],1===En)for(ke=0;ke<Vt.length;ke+=2)lt.geometry.push(Tr(Vt[ke],Vt[ke+1],ae,dt,Mt,St));else for(ke=0;ke<Vt.length;ke++){var Ln=[];for(Ye=0;Ye<Vt[ke].length;Ye+=2)Ln.push(Tr(Vt[ke][Ye],Vt[ke][Ye+1],ae,dt,Mt,St));lt.geometry.push(Ln)}}return je.transformed=!0,je}function Tr(je,ae,de,ke,Ye,dt){return[Math.round(de*(je*ke-Ye)),Math.round(de*(ae*ke-dt))]}function $i(je,ae,de,ke,Ye){for(var dt=ae===Ye.maxZoom?0:Ye.tolerance/((1<<ae)*Ye.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:de,y:ke,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},St=0;St<je.length;St++){Mt.numFeatures++,Lr(Mt,je[St],dt,Ye);var lt=je[St].minX,Vt=je[St].minY,En=je[St].maxX,Ln=je[St].maxY;lt<Mt.minX&&(Mt.minX=lt),Vt<Mt.minY&&(Mt.minY=Vt),En>Mt.maxX&&(Mt.maxX=En),Ln>Mt.maxY&&(Mt.maxY=Ln)}return Mt}function Lr(je,ae,de,ke){var Ye=ae.geometry,dt=ae.type,Mt=[];if("Point"===dt||"MultiPoint"===dt)for(var St=0;St<Ye.length;St+=3)Mt.push(Ye[St]),Mt.push(Ye[St+1]),je.numPoints++,je.numSimplified++;else if("LineString"===dt)si(Mt,Ye,je,de,!1,!1);else if("MultiLineString"===dt||"Polygon"===dt)for(St=0;St<Ye.length;St++)si(Mt,Ye[St],je,de,"Polygon"===dt,0===St);else if("MultiPolygon"===dt)for(var lt=0;lt<Ye.length;lt++){var Vt=Ye[lt];for(St=0;St<Vt.length;St++)si(Mt,Vt[St],je,de,!0,0===St)}if(Mt.length){var En=ae.tags||null;if("LineString"===dt&&ke.lineMetrics){for(var Ln in En={},ae.tags)En[Ln]=ae.tags[Ln];En.mapbox_clip_start=Ye.start/Ye.size,En.mapbox_clip_end=Ye.end/Ye.size}var Je={geometry:Mt,type:"Polygon"===dt||"MultiPolygon"===dt?3:"LineString"===dt||"MultiLineString"===dt?2:1,tags:En};null!==ae.id&&(Je.id=ae.id),je.features.push(Je)}}function si(je,ae,de,ke,Ye,dt){var Mt=ke*ke;if(ke>0&&ae.size<(Ye?Mt:ke))de.numPoints+=ae.length/3;else{for(var St=[],lt=0;lt<ae.length;lt+=3)(0===ke||ae[lt+2]>Mt)&&(de.numSimplified++,St.push(ae[lt]),St.push(ae[lt+1])),de.numPoints++;Ye&&function(Vt,En){for(var Ln=0,Je=0,Ze=Vt.length,Dt=Ze-2;Je<Ze;Dt=Je,Je+=2)Ln+=(Vt[Je]-Vt[Dt])*(Vt[Je+1]+Vt[Dt+1]);if(Ln>0===En)for(Je=0,Ze=Vt.length;Je<Ze/2;Je+=2){var He=Vt[Je],At=Vt[Je+1];Vt[Je]=Vt[Ze-2-Je],Vt[Je+1]=Vt[Ze-1-Je],Vt[Ze-2-Je]=He,Vt[Ze-1-Je]=At}}(St,dt),je.push(St)}}function Gi(je,ae){var de=(ae=this.options=function(Ye,dt){for(var Mt in dt)Ye[Mt]=dt[Mt];return Ye}(Object.create(this.options),ae)).debug;if(de&&console.time("preprocess data"),ae.maxZoom<0||ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ae.promoteId&&ae.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ye,dt,Mt,St,lt,Vt,ke=function(Ye,dt){var Mt=[];if("FeatureCollection"===Ye.type)for(var St=0;St<Ye.features.length;St++)qt(Mt,Ye.features[St],dt,St);else qt(Mt,"Feature"===Ye.type?Ye:{geometry:Ye},dt);return Mt}(je,ae);this.tiles={},this.tileCoords=[],de&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ae.indexMaxZoom,ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),St=Ye=ke,lt=Dr(Ye,1,-1-(Mt=(dt=ae).buffer/dt.extent),Mt,0,-1,2,dt),Vt=Dr(Ye,1,1-Mt,2+Mt,0,-1,2,dt),(lt||Vt)&&(St=Dr(Ye,1,-Mt,1+Mt,0,-1,2,dt)||[],lt&&(St=Ir(lt,1).concat(St)),Vt&&(St=St.concat(Ir(Vt,-1)))),(ke=St).length&&this.splitTile(ke,0,0,0),de&&(ke.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai(je,ae,de){return 32*((1<<je)*de+ae)+je}function Pi(je,ae){const de=je.tileID.canonical;if(!this._geoJSONIndex)return ae(null,null);const ke=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!ke)return ae(null,null);const Ye=new class{constructor(Mt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Mt.length,this._features=Mt}feature(Mt){return new class{constructor(St){this._feature=St,this.extent=l.EXTENT,this.type=St.type,this.properties=St.tags,"id"in St&&!isNaN(St.id)&&(this.id=parseInt(St.id,10))}loadGeometry(){if(1===this._feature.type){const St=[];for(const lt of this._feature.geometry)St.push([new l.Point(lt[0],lt[1])]);return St}{const St=[];for(const lt of this._feature.geometry){const Vt=[];for(const En of lt)Vt.push(new l.Point(En[0],En[1]));St.push(Vt)}return St}}toGeoJSON(St,lt,Vt){return wt.call(this,St,lt,Vt)}}(this._features[Mt])}}(ke.features);let dt=mn(Ye);0===dt.byteOffset&&dt.byteLength===dt.buffer.byteLength||(dt=new Uint8Array(dt)),ae(null,{vectorTile:Ye,rawData:dt.buffer})}Gi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gi.prototype.splitTile=function(je,ae,de,ke,Ye,dt,Mt){for(var St=[je,ae,de,ke],lt=this.options,Vt=lt.debug;St.length;){ke=St.pop(),de=St.pop(),ae=St.pop(),je=St.pop();var En=1<<ae,Ln=ai(ae,de,ke),Je=this.tiles[Ln];if(!Je&&(Vt>1&&console.time("creation"),Je=this.tiles[Ln]=$i(je,ae,de,ke,lt),this.tileCoords.push({z:ae,x:de,y:ke}),Vt)){Vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ae,de,ke,Je.numFeatures,Je.numPoints,Je.numSimplified),console.timeEnd("creation"));var Ze="z"+ae;this.stats[Ze]=(this.stats[Ze]||0)+1,this.total++}if(Je.source=je,Ye){if(ae===lt.maxZoom||ae===Ye)continue;var Dt=1<<Ye-ae;if(de!==Math.floor(dt/Dt)||ke!==Math.floor(Mt/Dt))continue}else if(ae===lt.indexMaxZoom||Je.numPoints<=lt.indexMaxPoints)continue;if(Je.source=null,0!==je.length){Vt>1&&console.time("clipping");var He,At,dn,qn,gr,Mr,$r=.5*lt.buffer/lt.extent,Qr=.5-$r,Oi=.5+$r,rt=1+$r;He=At=dn=qn=null,gr=Dr(je,En,de-$r,de+Oi,0,Je.minX,Je.maxX,lt),Mr=Dr(je,En,de+Qr,de+rt,0,Je.minX,Je.maxX,lt),je=null,gr&&(He=Dr(gr,En,ke-$r,ke+Oi,1,Je.minY,Je.maxY,lt),At=Dr(gr,En,ke+Qr,ke+rt,1,Je.minY,Je.maxY,lt),gr=null),Mr&&(dn=Dr(Mr,En,ke-$r,ke+Oi,1,Je.minY,Je.maxY,lt),qn=Dr(Mr,En,ke+Qr,ke+rt,1,Je.minY,Je.maxY,lt),Mr=null),Vt>1&&console.timeEnd("clipping"),St.push(He||[],ae+1,2*de,2*ke),St.push(At||[],ae+1,2*de,2*ke+1),St.push(dn||[],ae+1,2*de+1,2*ke),St.push(qn||[],ae+1,2*de+1,2*ke+1)}}},Gi.prototype.getTile=function(je,ae,de){var ke=this.options,Ye=ke.extent,dt=ke.debug;if(je<0||je>24)return null;var Mt=1<<je,St=ai(je,ae=(ae%Mt+Mt)%Mt,de);if(this.tiles[St])return Lo(this.tiles[St],Ye);dt>1&&console.log("drilling down to z%d-%d-%d",je,ae,de);for(var lt,Vt=je,En=ae,Ln=de;!lt&&Vt>0;)Vt--,En=Math.floor(En/2),Ln=Math.floor(Ln/2),lt=this.tiles[ai(Vt,En,Ln)];return lt&&lt.source?(dt>1&&console.log("found parent tile z%d-%d-%d",Vt,En,Ln),dt>1&&console.time("drilling down"),this.splitTile(lt.source,Vt,En,Ln,je,ae,de),dt>1&&console.timeEnd("drilling down"),this.tiles[St]?Lo(this.tiles[St],Ye):null):null};class ii extends l.VectorTileWorkerSource{constructor(ae,de,ke,Ye,dt){super(ae,de,ke,Ye,Pi),dt&&(this.loadGeoJSON=dt)}loadData(ae,de){const ke=ae&&ae.request,Ye=ke&&ke.collectResourceTiming;this.loadGeoJSON(ae,(dt,Mt)=>{if(dt||!Mt)return de(dt);if("object"!=typeof Mt)return de(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));{nt(Mt,!0);try{if(ae.filter){const lt=l.createExpression(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===lt.result)throw new Error(lt.value.map(En=>`${En.key}: ${En.message}`).join(", "));Mt={type:"FeatureCollection",features:Mt.features.filter(En=>lt.value.evaluate({zoom:0},En))}}this._geoJSONIndex=ae.cluster?new Me(function({superclusterOptions:lt,clusterProperties:Vt}){if(!Vt||!lt)return lt;const En={},Ln={},Je={accumulated:null,zoom:0},Ze={properties:null},Dt=Object.keys(Vt);for(const He of Dt){const[At,dn]=Vt[He],qn=l.createExpression(dn),gr=l.createExpression("string"==typeof At?[At,["accumulated"],["get",He]]:At);En[He]=qn.value,Ln[He]=gr.value}return lt.map=He=>{Ze.properties=He;const At={};for(const dn of Dt)At[dn]=En[dn].evaluate(Je,Ze);return At},lt.reduce=(He,At)=>{Ze.properties=At;for(const dn of Dt)Je.accumulated=He[dn],He[dn]=Ln[dn].evaluate(Je,Ze)},lt}(ae)).load(Mt.features):new Gi(lt=Mt,ae.geojsonVtOptions)}catch(lt){return de(lt)}this.loaded={};const St={};if(Ye){const lt=l.getPerformanceMeasurement(ke);lt&&(St.resourceTiming={},St.resourceTiming[ae.source]=JSON.parse(JSON.stringify(lt)))}de(null,St)}var lt})}reloadTile(ae,de){const ke=this.loaded;return ke&&ke[ae.uid]?super.reloadTile(ae,de):this.loadTile(ae,de)}loadGeoJSON(ae,de){if(ae.request)l.getJSON(ae.request,de);else{if("string"!=typeof ae.data)return de(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`));try{return de(null,JSON.parse(ae.data))}catch{return de(new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ae,de){try{de(null,this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId))}catch(ke){de(ke)}}getClusterChildren(ae,de){try{de(null,this._geoJSONIndex.getChildren(ae.clusterId))}catch(ke){de(ke)}}getClusterLeaves(ae,de){try{de(null,this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset))}catch(ke){de(ke)}}}class cs{constructor(ae){this.self=ae,this.actor=new l.Actor(ae,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=l.getProjection({name:"mercator"}),this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:ii},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(de,ke)=>{if(this.workerSourceTypes[de])throw new Error(`Worker source with name "${de}" already registered.`);this.workerSourceTypes[de]=ke},this.self.registerRTLTextPlugin=de=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=de.applyArabicShaping,l.plugin.processBidirectionalText=de.processBidirectionalText,l.plugin.processStyledBidirectionalText=de.processStyledBidirectionalText}}clearCaches(ae,de,ke){delete this.layerIndexes[ae],delete this.availableImages[ae],delete this.workerSources[ae],delete this.demWorkerSources[ae],ke()}checkIfReady(ae,de,ke){ke()}setReferrer(ae,de){this.referrer=de}spriteLoaded(ae,de){this.isSpriteLoaded[ae]=de;for(const ke in this.workerSources[ae]){const Ye=this.workerSources[ae][ke];for(const dt in Ye)Ye[dt]instanceof l.VectorTileWorkerSource&&(Ye[dt].isSpriteLoaded=de,Ye[dt].fire(new l.Event("isSpriteLoaded")))}}setImages(ae,de,ke){this.availableImages[ae]=de;for(const Ye in this.workerSources[ae]){const dt=this.workerSources[ae][Ye];for(const Mt in dt)dt[Mt].availableImages=de}ke()}enableTerrain(ae,de,ke){this.terrain=de,ke()}setProjection(ae,de){this.projections[ae]=l.getProjection(de)}setLayers(ae,de,ke){this.getLayerIndex(ae).replace(de),ke()}updateLayers(ae,de,ke){this.getLayerIndex(ae).update(de.layers,de.removedIds),ke()}loadTile(ae,de,ke){const Ye=this.enableTerrain?l.extend({enableTerrain:this.terrain},de):de;Ye.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,de.type,de.source).loadTile(Ye,ke)}loadDEMTile(ae,de,ke){const Ye=this.enableTerrain?l.extend({buildQuadTree:this.terrain},de):de;this.getDEMWorkerSource(ae,de.source).loadTile(Ye,ke)}reloadTile(ae,de,ke){const Ye=this.enableTerrain?l.extend({enableTerrain:this.terrain},de):de;Ye.projection=this.projections[ae]||this.defaultProjection,this.getWorkerSource(ae,de.type,de.source).reloadTile(Ye,ke)}abortTile(ae,de,ke){this.getWorkerSource(ae,de.type,de.source).abortTile(de,ke)}removeTile(ae,de,ke){this.getWorkerSource(ae,de.type,de.source).removeTile(de,ke)}removeSource(ae,de,ke){if(!this.workerSources[ae]||!this.workerSources[ae][de.type]||!this.workerSources[ae][de.type][de.source])return;const Ye=this.workerSources[ae][de.type][de.source];delete this.workerSources[ae][de.type][de.source],void 0!==Ye.removeSource?Ye.removeSource(de,ke):ke()}loadWorkerSource(ae,de,ke){try{this.self.importScripts(de.url),ke()}catch(Ye){ke(Ye.toString())}}syncRTLPluginState(ae,de,ke){try{l.plugin.setState(de);const Ye=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=Ye){this.self.importScripts(Ye);const dt=l.plugin.isParsed();ke(dt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ye}`),dt)}}catch(Ye){ke(Ye.toString())}}getAvailableImages(ae){let de=this.availableImages[ae];return de||(de=[]),de}getLayerIndex(ae){let de=this.layerIndexes[ae];return de||(de=this.layerIndexes[ae]=new qe),de}getWorkerSource(ae,de,ke){return this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][de]||(this.workerSources[ae][de]={}),this.workerSources[ae][de][ke]||(this.workerSources[ae][de][ke]=new this.workerSourceTypes[de]({send:(dt,Mt,St,lt,Vt,En)=>{this.actor.send(dt,Mt,St,ae,Vt,En)},scheduler:this.actor.scheduler},this.getLayerIndex(ae),this.getAvailableImages(ae),this.isSpriteLoaded[ae])),this.workerSources[ae][de][ke]}getDEMWorkerSource(ae,de){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][de]||(this.demWorkerSources[ae][de]=new Et),this.demWorkerSources[ae][de]}enforceCacheSizeLimit(ae,de){l.enforceCacheSizeLimit(de)}getWorkerPerformanceMetrics(ae,de,ke){ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new cs(self)),cs}),b(0,function(l){function Ee(h,i){if(Array.isArray(h)){if(!Array.isArray(i)||h.length!==i.length)return!1;for(let c=0;c<h.length;c++)if(!Ee(h[c],i[c]))return!1;return!0}if("object"==typeof h&&null!==h&&null!==i){if("object"!=typeof i||Object.keys(h).length!==Object.keys(i).length)return!1;for(const c in h)if(!Ee(h[c],i[c]))return!1;return!0}return h===i}var ot=qe;function qe(h){return i=h,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,_,x=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(x);try{_=new Worker(C),p=!0}catch{p=!1}return _&&_.terminate(),URL.revokeObjectURL(C),p}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var p=document.createElement("canvas");p.width=p.height=1;var _=p.getContext("2d");if(!_)return!1;var x=_.getImageData(0,0,1,1);return x&&x.width===p.width}()||(void 0===Et[c=i&&i.failIfMajorPerformanceCaveat]&&(Et[c]=function(p){var _,C,A,N,x=(C=p,A=document.createElement("canvas"),(N=Object.create(qe.webGLContextAttributes)).failIfMajorPerformanceCaveat=C,A.getContext("webgl",N)||A.getContext("experimental-webgl",N));if(!x)return!1;try{_=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!_||x.isContextLost())&&(x.shaderSource(_,"void main() {}"),x.compileShader(_),!0===x.getShaderParameter(_,x.COMPILE_STATUS))}(c)),!Et[c]||document.documentMode));var i,c}var Et={};function vt(h,i,c){const p=l.window.document.createElement(h);return void 0!==i&&(p.className=i),c&&c.appendChild(p),p}function tt(h,i,c){const p=l.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const _ of Object.keys(i))p.setAttributeNS(null,_,i[_]);return c&&c.appendChild(p),p}qe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const nt=l.window.document&&l.window.document.documentElement.style,wt=nt&&void 0!==nt.userSelect?"userSelect":"WebkitUserSelect";let ht;function et(){nt&&wt&&(ht=nt[wt],nt[wt]="none")}function xt(){nt&&wt&&(nt[wt]=ht)}function Kt(h){h.preventDefault(),h.stopPropagation(),l.window.removeEventListener("click",Kt,!0)}function It(){l.window.addEventListener("click",Kt,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",Kt,!0)},0)}function st(h,i){const c=h.getBoundingClientRect();return Ge(h,c,i)}function sn(h,i){const c=h.getBoundingClientRect(),p=[];for(let _=0;_<i.length;_++)p.push(Ge(h,c,i[_]));return p}function Tt(h){return void 0!==l.window.InstallTrigger&&2===h.button&&h.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function Ge(h,i,c){const p=h.offsetWidth===i.width?1:h.offsetWidth/i.width;return new l.Point((c.clientX-i.left)*p,(c.clientY-i.top)*p)}function Le(h,i){var c=i[0],p=i[1],_=i[2],x=i[3],C=c*x-_*p;return C?(h[0]=x*(C=1/C),h[1]=-p*C,h[2]=-_*C,h[3]=c*C,h):null}function Yt(h){const{userImage:i}=h;return!!(i&&i.render&&i.render())&&(h.data.replace(new Uint8Array(i.data.buffer)),!0)}class _n extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,c){this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),p=!1),p}_validateStretch(i,c){if(!i)return!0;let p=0;for(const _ of i){if(_[0]<p||_[1]<_[0]||c<_[1])return!1;p=_[1]}return!0}_validateContent(i,c){return!(i&&(4!==i.length||i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,c){c.version=this.images[i].version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){const c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,c){let p=!0;if(!this.isLoaded())for(const _ of i)this.images[_]||(p=!1);this.isLoaded()||p?this._notify(i,c):this.requestors.push({ids:i,callback:c})}_notify(i,c){const p={};for(const _ of i){this.images[_]||this.fire(new l.Event("styleimagemissing",{id:_}));const x=this.images[_];x?p[_]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:!(!x.userImage||!x.userImage.render)}:l.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){const c=this.patterns[i],p=this.getImage(i);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new l.ImagePosition(_,p);this.patterns[i]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(i,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const x in this.patterns)i.push(this.patterns[x].bin);const{w:c,h:p}=l.potpack(i),_=this.atlasImage;_.resize({width:c||1,height:p||1});for(const x in this.patterns){const{bin:C}=this.patterns[x],A=C.x+1,N=C.y+1,H=this.images[x].data,j=H.width,re=H.height;l.RGBAImage.copy(H,_,{x:0,y:0},{x:A,y:N},{width:j,height:re}),l.RGBAImage.copy(H,_,{x:0,y:re-1},{x:A,y:N-1},{width:j,height:1}),l.RGBAImage.copy(H,_,{x:0,y:0},{x:A,y:N+re},{width:j,height:1}),l.RGBAImage.copy(H,_,{x:j-1,y:0},{x:A-1,y:N},{width:1,height:re}),l.RGBAImage.copy(H,_,{x:0,y:0},{x:A+j,y:N},{width:1,height:re})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];Yt(p)&&this.updateImage(c,p)}}}const De=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(h,i){return function([c,p,_]){const x=l.degToRad(p+90),C=l.degToRad(_);return{x:c*Math.cos(x)*Math.sin(C),y:c*Math.sin(x)*Math.sin(C),z:c*Math.cos(C),azimuthal:p,polar:_}}(h.expression.evaluate(i))}interpolate(h,i,c){return{x:l.number(h.x,i.x,c),y:l.number(h.y,i.y,c),z:l.number(h.z,i.z,c),azimuthal:l.number(h.azimuthal,i.azimuthal,c),polar:l.number(h.polar,i.polar,c)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)});class ft extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(De),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(l.validateLight,i,c))for(const p in i){const _=i[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const Nt=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)});let yt=class extends l.Evented{constructor(h,i){super(),this._transitionable=new l.Transitionable(Nt),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(h){for(const i in h){const c=h[i];l.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),c):this._transitionable.setValue(i,c)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}};function mn(h,i,c,p){const _=l.smoothstep(45,65,c),[x,C]=hn(h,p),A=l.length(i);let N=1-Math.min(1,Math.exp((A-x)/(C-x)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*_*h.alpha}function hn(h,i){const c=.5/Math.tan(.5*i);return[h.range[0]+c,h.range[1]+c]}const Gt=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"high-color":new l.DataConstantProperty(l.spec.fog["high-color"]),"space-color":new l.DataConstantProperty(l.spec.fog["space-color"]),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"]),"star-intensity":new l.DataConstantProperty(l.spec.fog["star-intensity"])});class nr extends l.Evented{constructor(i,c){super(),this._transitionable=new l.Transitionable(Gt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const i=this._transform,c="globe"===i.projection.name,p=l.globeToMercatorTransition(i.zoom),_=this.properties.get("range"),x=[.5,3];return{range:c?[l.number(x[0],_[0],p),l.number(x[1],_[1],p)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c={}){if(!this._validate(l.validateFog,i,c)){for(const p of Object.keys(l.spec.fog))i&&void 0===i[p]&&(i[p]=l.spec.fog[p].default);for(const p in i){const _=i[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:l.smoothstep(45,65,i))*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?function(p,_,x){const C=l.MercatorCoordinate.fromLngLat(_),A=x.elevation?x.elevation.getAtPointOrZero(C):0,N=[C.x,C.y,A];return l.transformMat4(N,N,x.mercatorFogMatrix),mn(p,N,x.pitch,x._fov)}(this.state,i,c):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?hn(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class Wt{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const p=this.workerPool.acquire(this.id);for(let _=0;_<p.length;_++){const x=new Wt.Actor(p[_],c,this.id);x.name=`Worker ${_}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,c,p){l.asyncAll(this.actors,(_,x)=>{_.send(i,c,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function pr(h,i,c){return i*(l.EXTENT/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}Wt.Actor=l.Actor;class an{constructor(i,c,p,_){this.screenBounds=i,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(i,c){let p,_;if(i instanceof l.Point||"number"==typeof i[0]){const x=l.Point.convert(i);p=[x],_=c.isPointAboveHorizon(x)}else{const x=l.Point.convert(i[0]),C=l.Point.convert(i[1]);p=[x,C],_=l.polygonizeBounds(x,C).every(A=>c.isPointAboveHorizon(A))}return new an(p,c.getCameraPoint(),_,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return l.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],_=l.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),l.bufferConvexPolygon(_,i)}bufferedCameraGeometryGlobe(i){const c=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],_=l.polygonizeBounds(c,p,i),x=this.cameraPoint.clone();switch(3*((x.y>c.y)+(x.y>p.y))+((x.x>c.x)+(x.x>p.x))){case 0:_[0]=x,_[4]=x.clone();break;case 1:_.splice(1,0,x);break;case 2:_[1]=x;break;case 3:_.splice(4,0,x);break;case 5:_.splice(2,0,x);break;case 6:_[3]=x;break;case 7:_.splice(3,0,x);break;case 8:_[2]=x}return _}containsTile(i,c,p,_=0){const x=i.queryPadding/c._pixelsPerMercatorPixel+1,C=p?this._bufferedCameraMercator(x,c):this._bufferedScreenMercator(x,c);let A=i.tileID.wrap+(C.unwrapped?_:0);const N=C.polygon.map(Re=>l.getTilePoint(i.tileTransform,Re,A));if(!l.polygonIntersectsBox(N,0,0,l.EXTENT,l.EXTENT))return;A=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const H=this.screenGeometryMercator.polygon.map(Re=>l.getTileVec3(i.tileTransform,Re,A)),j=H.map(Re=>new l.Point(Re[0],Re[1])),re=c.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),fe=l.getTileVec3(i.tileTransform,re,A),ye=H.map(Re=>{const ie=l.sub(Re,Re,fe);return l.normalize(ie,ie),new l.Ray(fe,ie)}),Ie=pr(i,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:ye,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(Te=l.getBounds(N),Te.min.x=l.clamp(Te.min.x,0,l.EXTENT),Te.min.y=l.clamp(Te.min.y,0,l.EXTENT),Te.max.x=l.clamp(Te.max.x,0,l.EXTENT),Te.max.y=l.clamp(Te.max.y,0,l.EXTENT),Te),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:Ie};var Te}_bufferedScreenMercator(i,c){const p=at(i);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let _;return _="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),c):{polygon:this.bufferedScreenGeometry(i).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[p]=_,_}}_bufferedCameraMercator(i,c){const p=at(i);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let _;return _="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),c):{polygon:this.bufferedCameraGeometry(i).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[p]=_,_}}_projectAndResample(i,c){const p=function(x,C){const A=l.multiply([],C.pixelMatrix,C.globeMatrix),N=[0,-l.GLOBE_RADIUS,0,1],H=[0,l.GLOBE_RADIUS,0,1],j=[0,0,0,1];l.transformMat4$1(N,N,A),l.transformMat4$1(H,H,A),l.transformMat4$1(j,j,A);const re=new l.Point(N[0]/N[3],N[1]/N[3]),fe=new l.Point(H[0]/H[3],H[1]/H[3]),ye=l.polygonContainsPoint(x,re)&&N[3]<j[3],Ie=l.polygonContainsPoint(x,fe)&&H[3]<j[3];if(!ye&&!Ie)return null;const Te=function(gt,Bt,Ft){for(let nn=1;nn<gt.length;nn++){const Un=Ue(Bt.pointCoordinate3D(gt[nn-1]).x),Zt=Ue(Bt.pointCoordinate3D(gt[nn]).x);if(Ft<0){if(Un<Zt)return{idx:nn,t:-Un/(Zt-1-Un)}}else if(Zt<Un)return{idx:nn,t:(1-Un)/(Zt+1-Un)}}return null}(x,C,ye?-1:1);if(!Te)return null;const{idx:Re,t:ie}=Te;let ve=Re>1?Me(x.slice(0,Re),C):[],Ne=Re<x.length?Me(x.slice(Re),C):[];ve=ve.map(gt=>new l.Point(Ue(gt.x),gt.y)),Ne=Ne.map(gt=>new l.Point(Ue(gt.x),gt.y));const $e=[...ve];0===$e.length&&$e.push(Ne[Ne.length-1]);const pt=l.number($e[$e.length-1].y,(0===Ne.length?ve[0]:Ne[0]).y,ie);let mt;return mt=ye?[new l.Point(0,pt),new l.Point(0,0),new l.Point(1,0),new l.Point(1,pt)]:[new l.Point(1,pt),new l.Point(1,1),new l.Point(0,1),new l.Point(0,pt)],$e.push(...mt),0===Ne.length?$e.push(ve[0]):$e.push(...Ne),{polygon:$e.map(gt=>new l.MercatorCoordinate(gt.x,gt.y)),unwrapped:!1}}(i,c);if(p)return p;const _=function(x,C){let A=!1,N=-1/0,H=0;for(let re=0;re<x.length-1;re++)x[re].x>N&&(N=x[re].x,H=re);for(let re=0;re<x.length-1;re++){const fe=(H+re)%(x.length-1),ye=x[fe],Ie=x[fe+1];Math.abs(ye.x-Ie.x)>.5&&(ye.x<Ie.x?(ye.x+=1,0===fe&&(x[x.length-1].x+=1)):(Ie.x+=1,fe+1===x.length-1&&(x[0].x+=1)),A=!0)}const j=l.mercatorXfromLng(C.center.lng);return A&&j<Math.abs(j-1)&&x.forEach(re=>{re.x-=1}),{polygon:x,unwrapped:A}}(Me(i,c).map(x=>new l.Point(Ue(x.x),x.y)),c);return{polygon:_.polygon.map(x=>new l.MercatorCoordinate(x.x,x.y)),unwrapped:_.unwrapped}}}function Me(h,i){return l.resample(h,c=>{const p=i.pointCoordinate3D(c);c.x=p.x,c.y=p.y},1/256)}function Ue(h){return h<0?1+h%1:h%1}function at(h){return 100*h|0}function Rt(h,i,c,p,_){const x=function(C,A){if(C)return _(C);if(A){h.url&&A.tiles&&h.tiles&&delete h.tiles;const N=l.pick(l.extend(A,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);A.vector_layers&&(N.vectorLayers=A.vector_layers,N.vectorLayerIds=N.vectorLayers.map(H=>H.id)),N.tiles=i.canonicalizeTileset(N,h.url),_(null,N)}};return h.url?l.getJSON(i.transformRequest(i.normalizeSourceURL(h.url,null,c,p),l.ResourceType.Source),x):l.exported.frame(()=>x(null,h))}class cn{constructor(i,c,p){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const c=Math.pow(2,i.z),p=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*c),x=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*c),C=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*c);return i.x>=p&&i.x<x&&i.y>=_&&i.y<C}}class un{constructor(i,c,p){this.context=i;const _=i.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ur{constructor(i,c,p,_){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=i;const x=i.gl;this.buffer=x.createBuffer(),i.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let p=0;p<this.attributes.length;p++){const _=c.attributes[this.attributes[p].name];void 0!==_&&i.enableVertexAttribArray(_)}}setVertexAttribPointers(i,c,p){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],C=c.attributes[x.name];void 0!==C&&i.vertexAttribPointer(C,x.components,i[Qn[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Mn{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ot extends Mn{getDefault(){return l.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class qt extends Mn{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class $t extends Mn{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class vn extends Mn{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Gn extends Mn{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Cr extends Mn{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Wn extends Mn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Dr extends Mn{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class er extends Mn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class kr extends Mn{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class An extends Mn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class vi extends Mn{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class to extends Mn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class Ai extends Mn{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class zi extends Mn{getDefault(){return l.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Ir extends Mn{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Hr extends Mn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class Lo extends Mn{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Tr extends Mn{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}let $i,Lr=class extends Mn{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class si extends Mn{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Gi extends Mn{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class ai extends Mn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Pi extends Mn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class ii extends Mn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class cs extends Mn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class je extends Mn{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class ae extends Mn{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class de extends Mn{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class ke extends Mn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Ye extends Mn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class dt extends Mn{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Mt extends dt{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class St extends dt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class lt extends St{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Vt{constructor(i,c,p,_){this.context=i,this.width=c,this.height=p;const x=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Mt(i,x),_&&(this.depthAttachment=new St(i,x))}destroy(){const i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&i.deleteRenderbuffer(p)}i.deleteFramebuffer(this.framebuffer)}}class En{constructor(i,c=!1){if(this.gl=i,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const p=i;this.extVertexArrayObject={createVertexArrayOES:p.createVertexArray.bind(i),deleteVertexArrayOES:p.deleteVertexArray.bind(i),bindVertexArrayOES:p.bindVertexArray.bind(i)}}this.clearColor=new Ot(this),this.clearDepth=new qt(this),this.clearStencil=new $t(this),this.colorMask=new vn(this),this.depthMask=new Gn(this),this.stencilMask=new Cr(this),this.stencilFunc=new Wn(this),this.stencilOp=new Dr(this),this.stencilTest=new er(this),this.depthRange=new kr(this),this.depthTest=new An(this),this.depthFunc=new vi(this),this.blend=new to(this),this.blendFunc=new Ai(this),this.blendColor=new zi(this),this.blendEquation=new Ir(this),this.cullFace=new Hr(this),this.cullFaceSide=new Lo(this),this.frontFace=new Tr(this),this.program=new Lr(this),this.activeTexture=new si(this),this.viewport=new Gi(this),this.bindFramebuffer=new ai(this),this.bindRenderbuffer=new Pi(this),this.bindTexture=new ii(this),this.bindVertexBuffer=new cs(this),this.bindElementBuffer=new je(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ae(this),this.pixelStoreUnpack=new de(this),this.pixelStoreUnpackPremultiplyAlpha=new ke(this),this.pixelStoreUnpackFlipY=new Ye(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=i.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&i.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||i.getExtension("OES_standard_derivatives"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new un(this,i,c)}createVertexBuffer(i,c,p){return new ur(this,i,c,p)}createRenderbuffer(i,c,p){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,i,c,p),this.bindRenderbuffer.set(null),x}createFramebuffer(i,c,p){return new Vt(this,i,c,p)}clear({color:i,depth:c,stencil:p}){const _=this.gl;let x=0;i&&(x|=_.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(x|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==p&&(x|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(x)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){Ee(i.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ln extends l.Evented{constructor(i,c,p,_){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(c,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(i){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=Rt(this._options,this.map._requestManager,c,p,(_,x)=>{this._tileJSONRequest=null,this._loaded=!0,_?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),p&&2!==p.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new l.ErrorEvent(_))):x&&(l.extend(this,x),x.bounds&&(this.tileBounds=new cn(x.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(x.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(_)})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}loadTile(i,c){const p=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(p,l.ResourceType.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,i.actor&&"expired"!==i.state)"loading"===i.state?i.reloadCallback=c:i.request=i.actor.send("reloadTile",_,x.bind(this));else if(i.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",_,x.bind(this),void 0,!0);else{const C=l.loadVectorTile.call({deduped:this._deduped},_,(A,N)=>{A||!N?x.call(this,A):(_.data={cacheControl:N.cacheControl,expires:N.expires,rawData:N.rawData.slice(0)},i.actor&&i.actor.send("loadTile",_,x.bind(this),void 0,!0))},!0);i.request={cancel:C}}function x(C,A){return delete i.request,i.aborted?c(null):C&&404!==C.status?c(C):(A&&A.resourceTiming&&(i.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&i.setExpiryData(A),i.loadVectorData(A,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id})}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Je extends l.Evented{constructor(i,c,p,_){super(),this.id=i,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},c),l.extend(this,l.pick(c,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,null,null,(c,p)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):p&&(l.extend(this,p),p.bounds&&(this.tileBounds=new cn(p.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(p.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(c)})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const p=l.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);i.request=l.getImage(this.map._requestManager.transformRequest(_,l.ResourceType.Tile),(x,C,A,N)=>(delete i.request,i.aborted?(i.state="unloaded",c(null)):x?(i.state="errored",c(x)):C?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:A,expires:N}),i.setTexture(C,this.map.painter),i.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(i,c,p){i.setTexture(c,p)}static unloadTileData(i,c){i.texture&&c.saveTileTexture(i.texture)}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c()}unloadTile(i,c){i.texture&&this.map.painter.saveTileTexture(i.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ze(h,i,c,p,_,x,C,A){const N=[h,c,_,i,p,x,1,1,1],H=[C,A,1],j=l.adjoint([],N),[re,fe,ye]=l.transformMat3(H,H,l.transpose(j,j));return l.multiply$1(N,[re,0,0,0,fe,0,0,0,ye],N)}class Dt extends l.Evented{constructor(i,c,p,_){super(),this.id=i,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c,this._dirty=!1}load(i,c){this._loaded=c||!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(p,_)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new l.ErrorEvent(p));else if(_){const{HTMLImageElement:x}=l.window;this.image=_ instanceof x?l.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const c=i.map(l.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let _=1/0,x=1/0,C=-1/0,A=-1/0;for(const re of p)_=Math.min(_,re.x),x=Math.min(x,re.y),C=Math.max(C,re.x),A=Math.max(A,re.y);const N=Math.max(C-_,A-x),H=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),j=Math.pow(2,H);return new l.CanonicalTileID(H,Math.floor((_+C)/2*j),Math.floor((x+A)/2*j))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const N in this.tiles){const H=this.tiles[N];"loaded"!==H.state&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const c=l.tileTransform(this.tileID,this.map.transform.projection),[p,_,x,C]=this.coordinates.map(N=>{const H=c.projection.project(N[0],N[1]);return l.getTilePoint(c,H)._round()});this.perspectiveTransform=function(N,H,j,re,fe,ye,Ie,Te,Re,ie){const ve=Ze(0,0,N,0,0,H,N,H),Ne=Ze(j,re,fe,ye,Ie,Te,Re,ie);return l.multiply$1(Ne,l.adjoint(ve,ve),Ne),[Ne[6]/Ne[8]*N/l.EXTENT,Ne[7]/Ne[8]*H/l.EXTENT]}(this.width,this.height,p.x,p.y,_.x,_.y,C.x,C.y,x.x,x.y);const A=this._boundsArray=new l.StructArrayLayout4i8;A.emplaceBack(p.x,p.y,0,0),A.emplaceBack(_.x,_.y,l.EXTENT,0),A.emplaceBack(C.x,C.y,0,l.EXTENT),A.emplaceBack(x.x,x.y,l.EXTENT,l.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(A,l.boundsAttributes.members),this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,c=i.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new l.Texture(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(i)}loadTile(i,c){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},c(null)):(i.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const He={vector:Ln,raster:Je,"raster-dem":class extends Je{constructor(h,i,c,p){super(h,i,c,p),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(h,i){const c=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(_,x){_&&(h.state="errored",i(_)),x&&(h.dem=x,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",i(null))}h.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),function(_,x,C,A){if(delete h.request,h.aborted)h.state="unloaded",i(null);else if(_)h.state="errored",i(_);else if(x){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:C,expires:A});const N=l.window.ImageBitmap&&x instanceof l.window.ImageBitmap&&(null==$i&&($i=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof l.window.createImageBitmap),$i),H=1-(x.width-l.prevPowerOfTwo(x.width))/2;H<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const j=N?x:l.exported.getImageData(x,H),re={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:j,encoding:this.encoding,padding:H};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",re,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const i=h.canonical,c=Math.pow(2,i.z),p=(i.x-1+c)%c,_=0===i.x?h.wrap-1:h.wrap,x=(i.x+1+c)%c,C=i.x+1===c?h.wrap+1:h.wrap,A={};return A[new l.OverscaledTileID(h.overscaledZ,_,i.z,p,i.y).key]={backfilled:!1},A[new l.OverscaledTileID(h.overscaledZ,C,i.z,x,i.y).key]={backfilled:!1},i.y>0&&(A[new l.OverscaledTileID(h.overscaledZ,_,i.z,p,i.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(h.overscaledZ,h.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(h.overscaledZ,C,i.z,x,i.y-1).key]={backfilled:!1}),i.y+1<c&&(A[new l.OverscaledTileID(h.overscaledZ,_,i.z,p,i.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(h.overscaledZ,h.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(h.overscaledZ,C,i.z,x,i.y+1).key]={backfilled:!1}),A}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends l.Evented{constructor(h,i,c,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=i.data,this._options=l.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const _=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*_,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*_,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:l.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*_,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},i),this}getClusterChildren(h,i){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},i),this}getClusterLeaves(h,i,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:i,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=l.extend({},this.workerOptions),i=this._data;"string"==typeof i?(h.request=this.map._requestManager.transformRequest(l.exported.resolveURL(i),l.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new l.ErrorEvent(c));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(_.resourceTiming=p.resourceTiming[this.id]),this.fire(new l.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,i){const c=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(c,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,_)=>(delete h.request,h.unloadVectorData(),h.aborted?i(null):p?i(p):(h.loadVectorData(_,this.map.painter,"reloadTile"===c),i(null))),void 0,"loadTile"===c)}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Dt{constructor(h,i,c,p){super(h,i,c,p),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const i of h.urls)this.urls.push(this.map._requestManager.transformRequest(i,l.ResourceType.Source).url);l.getVideo(this.urls,(i,c)=>{this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const i=this.video.seekable;h<i.start(0)||h>i.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const h=this.map.painter.context,i=h.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(h,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Dt,canvas:class extends Dt{constructor(h,i,c,p){super(h,i,c,p),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(_=>!Array.isArray(_)||2!==_.length||_.some(x=>"number"!=typeof x))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends l.Evented{constructor(h,i,c,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=i,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new l.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new l.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new cn(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),l.extend(this,l.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return l.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:i,y:c,z:p}=h.canonical;return this._implementation.hasTile({x:i,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,i){const{x:c,y:p,z:_}=h.tileID.canonical,x=new l.window.AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:c,y:p,z:_},{signal:x.signal})).then(function(C){return delete h.request,h.aborted?(h.state="unloaded",i(null)):void 0===C?(h.state="errored",i(null)):null===C?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",i(null)):(A=C)instanceof l.window.ImageData||A instanceof l.window.HTMLCanvasElement||A instanceof l.window.ImageBitmap||A instanceof l.window.HTMLImageElement?(this.loadTileData(h,C),h.state="loaded",void i(null)):(h.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var A}.bind(this)).catch(C=>{20!==C.code&&(h.state="errored",i(C))}),h.request.cancel=()=>x.abort()}loadTileData(h,i){Je.loadTileData(h,i,this._map.painter)}unloadTileData(h){Je.unloadTileData(h,this._map.painter)}unloadTile(h,i){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:c,y:p,z:_}=h.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:_})}i()}abortTile(h,i){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}}},At=function(h,i,c,p){const _=new He[i.type](h,i,c,p);if(_.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${_.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],_),_};function dn(h,i){const c=l.identity([]);return l.scale(c,c,[.5*h.width,.5*-h.height,1]),l.translate(c,c,[1,-1,0]),l.multiply(c,c,h.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(c)}function qn(h,i,c,p,_,x,C,A=!1){const N=h.tilesIn(p,C,A);N.sort(Mr);const H=[];for(const re of N)H.push({wrappedTileID:re.tile.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(i,c,h._state,re,_,x,dn(h.transform,re.tile.tileID),A)});const j=function(re){const fe={},ye={};for(const Ie of re){const Te=Ie.queryResults,Re=Ie.wrappedTileID,ie=ye[Re]=ye[Re]||{};for(const ve in Te){const Ne=Te[ve],$e=ie[ve]=ie[ve]||{},pt=fe[ve]=fe[ve]||[];for(const mt of Ne)$e[mt.featureIndex]||($e[mt.featureIndex]=!0,pt.push(mt))}}return fe}(H);for(const re in j)j[re].forEach(fe=>{const ye=fe.feature,Ie=ye.layer;Ie&&"background"!==Ie.type&&"sky"!==Ie.type&&(ye.source=Ie.source,Ie["source-layer"]&&(ye.sourceLayer=Ie["source-layer"]),ye.state=void 0!==ye.id?h.getFeatureState(Ie["source-layer"],ye.id):{})});return j}function gr(h,i){const c=h.getRenderableIds().map(x=>h.getTileByID(x)),p=[],_={};for(let x=0;x<c.length;x++){const C=c[x],A=C.tileID.canonical.key;_[A]||(_[A]=!0,C.querySourceFeatures(p,i))}return p}function Mr(h,i){const c=h.tileID,p=i.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function $r(){return null!=Dl.workerClass?new Dl.workerClass:new l.window.Worker(Dl.workerUrl)}const Qr="mapboxgl_preloaded_worker_pool";class Oi{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Oi.workerCount;)this.workers.push(new $r);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qr]}numActive(){return Object.keys(this.active).length}}let rt;function Ke(){return rt||(rt=new Oi),rt}function tn(h,i){const c={};for(const p in h)"ref"!==p&&(c[p]=h[p]);return l.refProperties.forEach(p=>{p in i&&(c[p]=i[p])}),c}function Xt(h){h=h.slice();const i=Object.create(null);for(let c=0;c<h.length;c++)i[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=tn(h[c],i[h[c].ref]));return h}Oi.workerCount=2;const yn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function zn(h,i,c){c.push({command:yn.addSource,args:[h,i[h]]})}function br(h,i,c){i.push({command:yn.removeSource,args:[h]}),c[h]=!0}function or(h,i,c,p){br(h,c,p),zn(h,i,c)}function hi(h,i,c){let p;for(p in h[c])if(h[c].hasOwnProperty(p)&&"data"!==p&&!Ee(h[c][p],i[c][p]))return!1;for(p in i[c])if(i[c].hasOwnProperty(p)&&"data"!==p&&!Ee(h[c][p],i[c][p]))return!1;return!0}function Sr(h,i,c,p,_,x){let C;for(C in i=i||{},h=h||{})h.hasOwnProperty(C)&&(Ee(h[C],i[C])||c.push({command:x,args:[p,C,i[C],_]}));for(C in i)i.hasOwnProperty(C)&&!h.hasOwnProperty(C)&&(Ee(h[C],i[C])||c.push({command:x,args:[p,C,i[C],_]}))}function mi(h){return h.id}function Yr(h,i){return h[i.id]=i,h}class li{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=l.clamp(i,0,1);let c=1,p=this._distances[c];const _=i*this.paddedLength+this.padding;for(;p<_&&c<this._distances.length;)p=this._distances[++c];const x=c-1,C=this._distances[x],A=p-C,N=A>0?(_-C)/A:0;return this.points[x].mult(1-N).add(this.points[c].mult(N))}}class bi{constructor(i,c,p){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(c/p);for(let C=0;C<this.xCellCount*this.yCellCount;C++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,p,_,x){this._forEachCell(c,p,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(i,c,p,_){this._forEachCell(c-_,p-_,c+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(p),this.circles.push(_)}_insertBoxCell(i,c,p,_,x,C){this.boxCells[x].push(C)}_insertCircleCell(i,c,p,_,x,C){this.circleCells[x].push(C)}_query(i,c,p,_,x,C){if(p<0||i>this.width||_<0||c>this.height)return!x&&[];const A=[];if(i<=0&&c<=0&&this.width<=p&&this.height<=_){if(x)return!0;for(let N=0;N<this.boxKeys.length;N++)A.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const H=this.circles[3*N],j=this.circles[3*N+1],re=this.circles[3*N+2];A.push({key:this.circleKeys[N],x1:H-re,y1:j-re,x2:H+re,y2:j+re})}return C?A.filter(C):A}return this._forEachCell(i,c,p,_,this._queryCell,A,{hitTest:x,seenUids:{box:{},circle:{}}},C),x?A.length>0:A}_queryCircle(i,c,p,_,x){const C=i-p,A=i+p,N=c-p,H=c+p;if(A<0||C>this.width||H<0||N>this.height)return!_&&[];const j=[];return this._forEachCell(C,N,A,H,this._queryCellCircle,j,{hitTest:_,circle:{x:i,y:c,radius:p},seenUids:{box:{},circle:{}}},x),_?j.length>0:j}query(i,c,p,_,x){return this._query(i,c,p,_,!1,x)}hitTest(i,c,p,_,x){return this._query(i,c,p,_,!0,x)}hitTestCircle(i,c,p,_){return this._queryCircle(i,c,p,!0,_)}_queryCell(i,c,p,_,x,C,A,N){const H=A.seenUids,j=this.boxCells[x];if(null!==j){const fe=this.bboxes;for(const ye of j)if(!H.box[ye]){H.box[ye]=!0;const Ie=4*ye;if(i<=fe[Ie+2]&&c<=fe[Ie+3]&&p>=fe[Ie+0]&&_>=fe[Ie+1]&&(!N||N(this.boxKeys[ye]))){if(A.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[ye],x1:fe[Ie],y1:fe[Ie+1],x2:fe[Ie+2],y2:fe[Ie+3]})}}}const re=this.circleCells[x];if(null!==re){const fe=this.circles;for(const ye of re)if(!H.circle[ye]){H.circle[ye]=!0;const Ie=3*ye;if(this._circleAndRectCollide(fe[Ie],fe[Ie+1],fe[Ie+2],i,c,p,_)&&(!N||N(this.circleKeys[ye]))){if(A.hitTest)return C.push(!0),!0;{const Te=fe[Ie],Re=fe[Ie+1],ie=fe[Ie+2];C.push({key:this.circleKeys[ye],x1:Te-ie,y1:Re-ie,x2:Te+ie,y2:Re+ie})}}}}}_queryCellCircle(i,c,p,_,x,C,A,N){const H=A.circle,j=A.seenUids,re=this.boxCells[x];if(null!==re){const ye=this.bboxes;for(const Ie of re)if(!j.box[Ie]){j.box[Ie]=!0;const Te=4*Ie;if(this._circleAndRectCollide(H.x,H.y,H.radius,ye[Te+0],ye[Te+1],ye[Te+2],ye[Te+3])&&(!N||N(this.boxKeys[Ie])))return C.push(!0),!0}}const fe=this.circleCells[x];if(null!==fe){const ye=this.circles;for(const Ie of fe)if(!j.circle[Ie]){j.circle[Ie]=!0;const Te=3*Ie;if(this._circlesCollide(ye[Te],ye[Te+1],ye[Te+2],H.x,H.y,H.radius)&&(!N||N(this.circleKeys[Ie])))return C.push(!0),!0}}}_forEachCell(i,c,p,_,x,C,A,N){const H=this._convertToXCellCoord(i),j=this._convertToYCellCoord(c),re=this._convertToXCellCoord(p),fe=this._convertToYCellCoord(_);for(let ye=H;ye<=re;ye++)for(let Ie=j;Ie<=fe;Ie++)if(x.call(this,i,c,p,_,this.xCellCount*Ie+ye,C,A,N))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,p,_,x,C){const A=_-i,N=x-c,H=p+C;return H*H>A*A+N*N}_circleAndRectCollide(i,c,p,_,x,C,A){const N=(C-_)/2,H=Math.abs(i-(_+N));if(H>N+p)return!1;const j=(A-x)/2,re=Math.abs(c-(x+j));if(re>j+p)return!1;if(H<=N||re<=j)return!0;const fe=H-N,ye=re-j;return fe*fe+ye*ye<=p*p}}const Ur={unknown:0,flipRequired:1,flipNotRequired:2},So=Math.tan(85*Math.PI/180);function zt(h,i,c,p,_,x,C){const A=l.create();if(c)if("globe"===x.name){const N=l.calculateGlobeLabelMatrix(_,i);l.multiply(A,A,N)}else{const N=Le([],C);A[0]=N[0],A[1]=N[1],A[4]=N[2],A[5]=N[3],p||l.rotateZ(A,A,_.angle)}else l.multiply(A,_.labelPlaneMatrix,h);return A}function ei(h,i,c,p,_,x,C){const A=zt(h,i,c,p,_,x,C);return"globe"===x.name&&c||(A[2]=A[6]=A[10]=A[14]=0),A}function Ri(h,i,c,p,_,x,C){if(c){if("globe"===x.name){const A=zt(h,i,c,p,_,x,C);return l.invert(A,A),l.multiply(A,h,A),A}{const A=l.clone(h),N=l.identity([]);return N[0]=C[0],N[1]=C[1],N[4]=C[2],N[5]=C[3],l.multiply(A,A,N),p||l.rotateZ(A,A,-_.angle),A}}return _.glCoordMatrix}function Fi(h,i,c,p){const _=[h,i,c,1];c?l.transformMat4$1(_,_,p):Se(_,_,p);const x=_[3];return _[0]/=x,_[1]/=x,_[2]/=x,_}function Vi(h,i){return Math.min(.5+h/i*.5,1.5)}function Ui(h,i){const c=h[0]/h[3],p=h[1]/h[3];return c>=-i[0]&&c<=i[0]&&p>=-i[1]&&p<=i[1]}function _o(h,i,c,p,_,x,C,A,N,H){const j=c.transform,re=p?h.textSizeData:h.iconSizeData,fe=l.evaluateSizeForZoom(re,c.transform.zoom),ye="globe"===j.projection.name,Ie=[256/c.width*2+1,256/c.height*2+1],Te=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Te.clear();let Re=null;ye&&(Re=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const ie=h.lineVertexArray,ve=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,Ne=c.transform.width/c.transform.height;let $e,pt=!1;for(let mt=0;mt<ve.length;mt++){const gt=ve.get(mt),{numGlyphs:Bt,writingMode:Ft}=gt;if(Ft!==l.WritingMode.vertical||pt||$e===l.WritingMode.horizontal||(pt=!0),$e=Ft,(gt.hidden||Ft===l.WritingMode.vertical)&&!pt){pe(Bt,Te);continue}pt=!1;const nn=new l.Point(gt.tileAnchorX,gt.tileAnchorY);let{x:Un,y:Zt,z:wn}=j.projection.projectTilePoint(nn.x,nn.y,H.canonical);if(N){const[di,yr,Vr]=N(nn);Un+=di,Zt+=yr,wn+=Vr}const ln=[Un,Zt,wn,1];if(l.transformMat4$1(ln,ln,i),!Ui(ln,Ie)){pe(Bt,Te);continue}const Bn=Vi(c.transform.cameraToCenterDistance,ln[3]),Jt=l.evaluateSizeForFeature(re,fe,gt),Cn=C?Jt/Bn:Jt*Bn,$n=Fi(Un,Zt,wn,_);if($n[3]<=0){pe(Bt,Te);continue}let kn={};const Yn=C?null:N,Or=Kn(gt,Cn,!1,A,i,_,x,h.glyphOffsetArray,ie,Te,Re,$n,nn,kn,Ne,Yn,j.projection,H,C);pt=Or.useVertical,Yn&&Or.needsFlipping&&(kn={}),(Or.notEnoughRoom||pt||Or.needsFlipping&&Kn(gt,Cn,!0,A,i,_,x,h.glyphOffsetArray,ie,Te,Re,$n,nn,kn,Ne,Yn,j.projection,H,C).notEnoughRoom)&&pe(Bt,Te)}p?(h.text.dynamicLayoutVertexBuffer.updateData(Te),Re&&h.text.globeExtVertexBuffer.updateData(Re)):(h.icon.dynamicLayoutVertexBuffer.updateData(Te),Re&&h.icon.globeExtVertexBuffer.updateData(Re))}function so(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te){const{lineStartIndex:Re,glyphStartIndex:ie,segment:ve}=A,Ne=ie+A.numGlyphs,$e=Re+A.lineLength,pt=i.getoffsetX(ie),mt=i.getoffsetX(Ne-1),gt=Oe(h*pt,c,p,_,x,C,ve,Re,$e,N,H,j,re,fe,!0,ye,Ie,Te);if(!gt)return null;const Bt=Oe(h*mt,c,p,_,x,C,ve,Re,$e,N,H,j,re,fe,!0,ye,Ie,Te);return Bt?{first:gt,last:Bt}:null}function yo(h,i,c,p){return h===l.WritingMode.horizontal&&Math.abs(p)>Math.abs(c)?{useVertical:!0}:h===l.WritingMode.vertical?p>0?{needsFlipping:!0}:null:i!==Ur.unknown&&(0===(_=c)||Math.abs(p/_)>So)?i===Ur.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var _}function Kn(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te,Re,ie,ve){const Ne=i/24,$e=h.lineOffsetX*Ne,pt=h.lineOffsetY*Ne,{lineStartIndex:mt,glyphStartIndex:gt,numGlyphs:Bt,segment:Ft,writingMode:nn,flipState:Un}=h,Zt=mt+h.lineLength,wn=ln=>{if(j){const[$n,kn,Yn]=ln.up,Or=H.length;l.updateGlobeVertexNormal(j,Or+0,$n,kn,Yn),l.updateGlobeVertexNormal(j,Or+1,$n,kn,Yn),l.updateGlobeVertexNormal(j,Or+2,$n,kn,Yn),l.updateGlobeVertexNormal(j,Or+3,$n,kn,Yn)}const[Bn,Jt,Cn]=ln.point;l.addDynamicAttributes(H,Bn,Jt,Cn,ln.angle)};if(Bt>1){const ln=so(Ne,A,$e,pt,c,re,fe,h,N,x,ye,Te,!1,Re,ie,ve);if(!ln)return{notEnoughRoom:!0};if(p&&!c){let[Bn,Jt,Cn]=ln.first.point,[$n,kn,Yn]=ln.last.point;[Bn,Jt]=Fi(Bn,Jt,Cn,C),[$n,kn]=Fi($n,kn,Yn,C);const Or=yo(nn,Un,($n-Bn)*Ie,kn-Jt);if(h.flipState=Or&&Or.needsFlipping?Ur.flipRequired:Ur.flipNotRequired,Or)return Or}wn(ln.first);for(let Bn=gt+1;Bn<gt+Bt-1;Bn++){const Jt=Oe(Ne*A.getoffsetX(Bn),$e,pt,c,re,fe,Ft,mt,Zt,N,x,ye,Te,!1,!1,Re,ie,ve);if(!Jt)return H.length-=4*(Bn-gt),{notEnoughRoom:!0};wn(Jt)}wn(ln.last)}else{if(p&&!c){const Bn=Fi(fe.x,fe.y,0,_),Jt=mt+Ft+1,Cn=new l.Point(N.getx(Jt),N.gety(Jt)),$n=Fi(Cn.x,Cn.y,0,_),kn=$n[3]>0?$n:le(fe,Cn,Bn,1,_,void 0,Re,ie.canonical),Yn=yo(nn,Un,(kn[0]-Bn[0])*Ie,kn[1]-Bn[1]);if(h.flipState=Yn&&Yn.needsFlipping?Ur.flipRequired:Ur.flipNotRequired,Yn)return Yn}const ln=Oe(Ne*A.getoffsetX(gt),$e,pt,c,re,fe,Ft,mt,Zt,N,x,ye,Te,!1,!1,Re,ie,ve);if(!ln)return{notEnoughRoom:!0};wn(ln)}return{}}function Br(h,i,c,p,_){const{x,y:C,z:A}=p.projectTilePoint(h.x,h.y,i);if(!_)return Fi(x,C,A,c);const[N,H,j]=_(h);return Fi(x+N,C+H,A+j,c)}function le(h,i,c,p,_,x,C,A){const N=Br(h.sub(i)._unit()._add(h),A,_,C,x);return l.sub(N,c,N),l.normalize(N,N),l.scaleAndAdd(N,c,N,p)}function Oe(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te,Re,ie){const ve=p?h-i:h+i;let Ne=ve>0?1:-1,$e=0;p&&(Ne*=-1,$e=Math.PI),Ne<0&&($e+=Math.PI);let pt=A+C+(Ne>0?0:1)|0,mt=_,gt=_,Bt=0,Ft=0;const nn=Math.abs(ve),Un=[],Zt=[];let wn=x,ln=wn;const Bn=()=>le(ln,wn,gt,nn-Bt+1,j,fe,Te,Re.canonical);for(;Bt+Ft<=nn;){if(pt+=Ne,pt<A||pt>=N)return null;if(gt=mt,ln=wn,Un.push(gt),ye&&Zt.push(ln),wn=new l.Point(H.getx(pt),H.gety(pt)),mt=re[pt],!mt){const Vr=Br(wn,Re.canonical,j,Te,fe);mt=Vr[3]>0?re[pt]=Vr:Bn()}Bt+=Ft,Ft=l.distance(gt,mt)}Ie&&fe&&(re[pt]&&(mt=Bn(),Ft=l.distance(gt,mt)),re[pt]=mt);const Jt=(nn-Bt)/Ft,Cn=wn.sub(ln)._mult(Jt)._add(ln),$n=l.sub([],mt,gt),kn=l.scaleAndAdd([],gt,$n,Jt);let Yn=[0,0,1],Or=$n[0],di=$n[1];if(ie&&(Yn=Te.upVector(Re.canonical,Cn.x,Cn.y),0!==Yn[0]||0!==Yn[1]||1!==Yn[2])){const Vr=[Yn[2],0,-Yn[0]],ki=l.cross([],Yn,Vr);l.normalize(Vr,Vr),l.normalize(ki,ki),Or=l.dot($n,Vr),di=l.dot($n,ki)}if(c){const Vr=l.cross([],Yn,$n);l.normalize(Vr,Vr),l.scaleAndAdd(kn,kn,Vr,c*Ne)}const yr=$e+Math.atan2(di,Or);return Un.push(kn),ye&&Zt.push(Cn),{point:kn,angle:yr,path:Un,tilePath:Zt,up:Yn}}function pe(h,i){const c=i.length,p=c+4*h;i.resize(p),i.float32.fill(-1/0,4*c,4*p)}function Se(h,i,c){const p=i[0],_=i[1];return h[0]=c[0]*p+c[4]*_+c[12],h[1]=c[1]*p+c[5]*_+c[13],h[3]=c[3]*p+c[7]*_+c[15],h}const bt=100;class Pt{constructor(i,c,p=new bi(i.width+200,i.height+200,25),_=new bi(i.width+200,i.height+200,25)){this.transform=i,this.grid=p,this.ignoredGrid=_,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+bt,this.screenBottomBoundary=i.height+bt,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,p,_,x,C,A,N){let H=p.projectedAnchorX,j=p.projectedAnchorY,re=p.projectedAnchorZ;const fe=p.elevation,ye=p.tileID,Ie=i.getProjection();if(fe&&ye){const[mt,gt,Bt]=Ie.upVector(ye.canonical,p.tileAnchorX,p.tileAnchorY),Ft=Ie.upVectorScale(ye.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=mt*fe*Ft,j+=gt*fe*Ft,re+=Bt*fe*Ft}const Te=this.projectAndGetPerspectiveRatio(A,H,j,re,p.tileID,"globe"===Ie.name||!!fe||this.transform.pitch>0,Ie),Re=C*Te.perspectiveRatio,ie=(p.x1*c+_.x-p.padding)*Re+Te.point.x,ve=(p.y1*c+_.y-p.padding)*Re+Te.point.y,Ne=(p.x2*c+_.x+p.padding)*Re+Te.point.x,$e=(p.y2*c+_.y+p.padding)*Re+Te.point.y,pt=Te.perspectiveRatio<=.55||Te.occluded;return!this.isInsideGrid(ie,ve,Ne,$e)||!x&&this.grid.hitTest(ie,ve,Ne,$e,N)||pt?{box:[],offscreen:!1,occluded:Te.occluded}:{box:[ie,ve,Ne,$e],offscreen:this.isOffscreen(ie,ve,Ne,$e),occluded:!1}}placeCollisionCircles(i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te){const Re=[],ie=this.transform.elevation,ve=i.getProjection(),Ne=ie?ie.getAtTileOffsetFunc(Te,this.transform.center.lat,this.transform.worldSize,ve):null,$e=new l.Point(p.tileAnchorX,p.tileAnchorY);let{x:pt,y:mt,z:gt}=ve.projectTilePoint($e.x,$e.y,Te.canonical);if(Ne){const[Cn,$n,kn]=Ne($e);pt+=Cn,mt+=$n,gt+=kn}const Bt="globe"===ve.name,Ft=this.projectAndGetPerspectiveRatio(A,pt,mt,gt,Te,Bt||!!ie||this.transform.pitch>0,ve),{perspectiveRatio:nn}=Ft,Un=(re?C/nn:C*nn)/l.ONE_EM,Zt=Fi(pt,mt,gt,N),wn=Ft.signedDistanceFromCamera>0?so(Un,x,p.lineOffsetX*Un,p.lineOffsetY*Un,!1,Zt,$e,p,_,N,{},ie&&!re?Ne:null,re&&!!ie,ve,Te,re):null;let ln=!1,Bn=!1,Jt=!0;if(wn&&!Ft.occluded){const Cn=.5*ye*nn+Ie,$n=new l.Point(-100,-100),kn=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),Yn=new li,{first:Or,last:di}=wn,yr=Or.path.length;let Vr=[];for(let wr=yr-1;wr>=1;wr--)Vr.push(Or.path[wr]);for(let wr=1;wr<di.path.length;wr++)Vr.push(di.path[wr]);const ki=2.5*Cn;H&&(Vr=Vr.map(([wr,fo,Do],Co)=>(Ne&&!Bt&&(Do=Ne(Co<yr-1?Or.tilePath[yr-1-Co]:di.tilePath[Co-yr+2])[2]),Fi(wr,fo,Do,H))),Vr.some(wr=>wr[3]<=0)&&(Vr=[]));let Di=[];if(Vr.length>0){let wr=1/0,fo=-1/0,Do=1/0,Co=-1/0;for(const oo of Vr)wr=Math.min(wr,oo[0]),Do=Math.min(Do,oo[1]),fo=Math.max(fo,oo[0]),Co=Math.max(Co,oo[1]);fo>=$n.x&&wr<=kn.x&&Co>=$n.y&&Do<=kn.y&&(Di=[Vr.map(oo=>new l.Point(oo[0],oo[1]))],(wr<$n.x||fo>kn.x||Do<$n.y||Co>kn.y)&&(Di=l.clipLine(Di,$n.x,$n.y,kn.x,kn.y)))}for(const wr of Di){Yn.reset(wr,.25*Cn);let fo=0;fo=Yn.length<=.5*Cn?1:Math.ceil(Yn.paddedLength/ki)+1;for(let Do=0;Do<fo;Do++){const Co=Do/Math.max(fo-1,1),oo=Yn.lerp(Co),ma=oo.x+bt,bo=oo.y+bt;Re.push(ma,bo,Cn,0);const Ua=ma-Cn,Ja=bo-Cn,Vo=ma+Cn,Po=bo+Cn;if(Jt=Jt&&this.isOffscreen(Ua,Ja,Vo,Po),Bn=Bn||this.isInsideGrid(Ua,Ja,Vo,Po),!c&&this.grid.hitTestCircle(ma,bo,Cn,fe)&&(ln=!0,!j))return{circles:[],offscreen:!1,collisionDetected:ln,occluded:!1}}}}return{circles:!j&&ln||!Bn?[]:Re,offscreen:Jt,collisionDetected:ln,occluded:Ft.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let p=1/0,_=1/0,x=-1/0,C=-1/0;for(const j of i){const re=new l.Point(j.x+bt,j.y+bt);p=Math.min(p,re.x),_=Math.min(_,re.y),x=Math.max(x,re.x),C=Math.max(C,re.y),c.push(re)}const A=this.grid.query(p,_,x,C).concat(this.ignoredGrid.query(p,_,x,C)),N={},H={};for(const j of A){const re=j.key;if(void 0===N[re.bucketInstanceId]&&(N[re.bucketInstanceId]={}),N[re.bucketInstanceId][re.featureIndex])continue;const fe=[new l.Point(j.x1,j.y1),new l.Point(j.x2,j.y1),new l.Point(j.x2,j.y2),new l.Point(j.x1,j.y2)];l.polygonIntersectsPolygon(c,fe)&&(N[re.bucketInstanceId][re.featureIndex]=!0,void 0===H[re.bucketInstanceId]&&(H[re.bucketInstanceId]=[]),H[re.bucketInstanceId].push(re.featureIndex))}return H}insertCollisionBox(i,c,p,_,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:x},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,p,_,x){const C=c?this.ignoredGrid:this.grid,A={bucketInstanceId:p,featureIndex:_,collisionGroupID:x};for(let N=0;N<i.length;N+=4)C.insertCircle(A,i[N],i[N+1],i[N+2])}projectAndGetPerspectiveRatio(i,c,p,_,x,C,A){const N=[c,p,_,1];let H=!1;_||this.transform.pitch>0?(l.transformMat4$1(N,N,i),this.fogState&&x&&"globe"!==A.name&&(H=function(fe,ye,Ie,Te,Re,ie){const ve=ie.calculateFogTileMatrix(Re),Ne=[ye,Ie,Te];return l.transformMat4(Ne,Ne,ve),mn(fe,Ne,ie.pitch,ie._fov)}(this.fogState,c,p,_,x.toUnwrapped(),this.transform)>.9)):Se(N,N,i);const j=N[3];return{point:new l.Point((N[0]/j+1)/2*this.transform.width+bt,(-N[1]/j+1)/2*this.transform.height+bt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(A)/j*.5,1.5),signedDistanceFromCamera:j,occluded:C&&N[2]>j||H}}isOffscreen(i,c,p,_){return p<bt||i>=this.screenRightBoundary||_<bt||c>this.screenBottomBoundary}isInsideGrid(i,c,p,_){return p>=0&&i<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i}}function fn(h,i,c){const p=i.createTileMatrix(h,h.worldSize,c.toUnwrapped());return l.multiply(new Float32Array(16),h.projMatrix,p)}function bn(h,i,c){if(i.projection.name===c.projection.name)return h.projMatrix;const p=c.clone();return p.setProjection(i.projection),fn(p,i.getProjection(),h)}function pn(h,i,c){return i.name===c.projection.name?h.projMatrix:fn(c,i,h)}class Pn{constructor(i,c,p,_){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):_&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class lr{constructor(i,c,p,_,x,C=!1){this.text=new Pn(i?i.text:null,c,p,x),this.icon=new Pn(i?i.icon:null,c,_,x),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ar{constructor(i,c,p,_=!1){this.text=i,this.icon=c,this.skipFade=p,this.clipped=_}}class Zr{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class ji{constructor(i,c,p,_,x){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=x}}class zo{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[i]}}function Ki(h,i,c,p,_){const{horizontalAlign:x,verticalAlign:C}=l.getAnchorAlignment(h),A=-(x-.5)*i,N=-(C-.5)*c,H=l.evaluateVariableOffset(h,p);return new l.Point(A+H[0]*_,N+H[1]*_)}function Zo(h,i,c,p,_){const x=new l.Point(h,i);return c&&x._rotate(p?_:-_),x}class ao{constructor(i,c,p,_,x){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new Pt(this.transform,x),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new zo(p),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,p,_){const x=p.getBucket(c),C=p.latestFeatureIndex;if(!x||!C||c.id!==x.layerIds[0])return;const A=x.layers[0].layout,N=p.collisionBoxArray,H=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),j=p.tileSize/l.EXTENT,re=p.tileID.toUnwrapped();this.transform.setProjection(x.projection);const fe=(ye=p.tileID,Ie=x.getProjection(),Te=this.transform,Ie.name===this.projection?Te.calculateProjMatrix(ye.toUnwrapped()):fn(Te,Ie,ye));var ye,Ie,Te;const Re="map"===A.get("text-pitch-alignment"),ie="map"===A.get("text-rotation-alignment");c.compileFilter();const ve=c.dynamicFilter(),Ne=c.dynamicFilterNeedsFeature(),$e=this.transform.calculatePixelsToTileUnitsMatrix(p),pt=ei(fe,p.tileID.canonical,Re,ie,this.transform,x.getProjection(),$e);let mt=null;if(Re){const Ft=Ri(fe,p.tileID.canonical,Re,ie,this.transform,x.getProjection(),$e);mt=l.multiply([],this.transform.labelPlaneMatrix,Ft)}let gt=null;ve&&p.latestFeatureIndex&&(gt={unwrappedTileID:re,dynamicFilter:ve,dynamicFilterNeedsFeature:Ne,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[x.bucketInstanceId]=new ji(x.bucketInstanceId,C,x.sourceLayerIndex,x.index,p.tileID);const Bt={bucket:x,layout:A,posMatrix:fe,textLabelPlaneMatrix:pt,labelToScreenMatrix:mt,clippingData:gt,scale:H,textPixelRatio:j,holdingForFade:p.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(x.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(_)for(const Ft of x.sortKeyRanges){const{sortKey:nn,symbolInstanceStart:Un,symbolInstanceEnd:Zt}=Ft;i.push({sortKey:nn,symbolInstanceStart:Un,symbolInstanceEnd:Zt,parameters:Bt})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:Bt})}attemptAnchorPlacement(i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te,Re,ie,ve){const{textOffset0:Ne,textOffset1:$e,crossTileID:pt}=fe,mt=[Ne,$e],gt=Ki(i,p,_,mt,x),Bt=this.collisionIndex.placeCollisionBox(Ie,x,c,Zo(gt.x,gt.y,C,A,this.transform.angle),re,N,H,j.predicate);if(Re){const Ft=Ie.getSymbolInstanceIconSize(ve,this.transform.zoom,fe.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Ie,Ft,Re,Zo(gt.x,gt.y,C,A,this.transform.angle),re,N,H,j.predicate).box.length)return}if(Bt.box.length>0){let Ft;return this.prevPlacement&&this.prevPlacement.variableOffsets[pt]&&this.prevPlacement.placements[pt]&&this.prevPlacement.placements[pt].text&&(Ft=this.prevPlacement.variableOffsets[pt].anchor),this.variableOffsets[pt]={textOffset:mt,width:p,height:_,anchor:i,textScale:x,prevAnchor:Ft},this.markUsedJustification(Ie,i,fe,Te),Ie.allowVerticalPlacement&&(this.markUsedOrientation(Ie,Te,fe),this.placedOrientations[pt]=Te),{shift:gt,placedGlyphBoxes:Bt}}}placeLayerBucketPart(i,c,p,_){const{bucket:x,layout:C,posMatrix:A,textLabelPlaneMatrix:N,labelToScreenMatrix:H,clippingData:j,textPixelRatio:re,holdingForFade:fe,collisionBoxArray:ye,partiallyEvaluatedTextSize:Ie,partiallyEvaluatedIconSize:Te,collisionGroup:Re}=i.parameters,ie=C.get("text-optional"),ve=C.get("icon-optional"),Ne=C.get("text-allow-overlap"),$e=C.get("icon-allow-overlap"),pt="map"===C.get("text-rotation-alignment"),mt="map"===C.get("text-pitch-alignment"),gt="none"!==C.get("icon-text-fit"),Bt="viewport-y"===C.get("symbol-z-order");this.transform.setProjection(x.projection);let Ft=Ne&&($e||!x.hasIconData()||ve),nn=$e&&(Ne||!x.hasTextData()||ie);!x.collisionArrays&&ye&&x.deserializeCollisionBoxes(ye),p&&_&&x.updateCollisionDebugBuffers(this.transform.zoom,ye);const Un=(Zt,wn,ln)=>{const{crossTileID:Bn,numVerticalGlyphVertices:Jt}=Zt;if(j){const Vo={zoom:this.transform.zoom,pitch:this.transform.pitch};let Po=null;if(j.dynamicFilterNeedsFeature){const Qi=this.retainedQueryData[x.bucketInstanceId];Po=j.featureIndex.loadFeature({featureIndex:Zt.featureIndex,bucketIndex:Qi.bucketIndex,sourceLayerIndex:Qi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,j.dynamicFilter)(Vo,Po,this.retainedQueryData[x.bucketInstanceId].tileID.canonical,new l.Point(Zt.tileAnchorX,Zt.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[Bn]=new Ar(!1,!1,!1,!0),void c.add(Bn)}if(c.has(Bn))return;if(fe)return void(this.placements[Bn]=new Ar(!1,!1,!1));let Cn=!1,$n=!1,kn=!0,Yn=!1,Or=!1,di=null,yr={box:null,offscreen:null,occluded:null},Vr={box:null,offscreen:null,occluded:null},ki=null,Di=null,wr=null,fo=0,Do=0,Co=0;ln.textFeatureIndex?fo=ln.textFeatureIndex:Zt.useRuntimeCollisionCircles&&(fo=Zt.featureIndex),ln.verticalTextFeatureIndex&&(Do=ln.verticalTextFeatureIndex);const oo=Vo=>{Vo.tileID=this.retainedQueryData[x.bucketInstanceId].tileID;const Po=this.transform.elevation;(Po||Vo.elevation)&&(Vo.elevation=Po?Po.getAtTileOffset(Vo.tileID,Vo.tileAnchorX,Vo.tileAnchorY):0)},ma=ln.textBox;if(ma){oo(ma);const Vo=Qi=>{let ps=l.WritingMode.horizontal;if(x.allowVerticalPlacement&&!Qi&&this.prevPlacement){const Us=this.prevPlacement.placedOrientations[Bn];Us&&(this.placedOrientations[Bn]=Us,ps=Us,this.markUsedOrientation(x,ps,Zt))}return ps},Po=(Qi,ps)=>{if(x.allowVerticalPlacement&&Jt>0&&ln.verticalTextBox){for(const Us of x.writingModes)if(Us===l.WritingMode.vertical?(yr=ps(),Vr=yr):yr=Qi(),yr&&yr.box&&yr.box.length)break}else yr=Qi()};if(C.get("text-variable-anchor")){let Qi=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Bn]){const wo=this.prevPlacement.variableOffsets[Bn];Qi.indexOf(wo.anchor)>0&&(Qi=Qi.filter(Ys=>Ys!==wo.anchor),Qi.unshift(wo.anchor))}const ps=(wo,Ys,cu)=>{const Cl=x.getSymbolInstanceTextSize(Ie,Zt,this.transform.zoom,wn),cl=(wo.x2-wo.x1)*Cl+2*wo.padding,Nl=(wo.y2-wo.y1)*Cl+2*wo.padding,zl=gt&&!$e?Ys:null;zl&&oo(zl);let Cc={box:[],offscreen:!1,occluded:!1};const vd=Ne?2*Qi.length:Qi.length;for(let ku=0;ku<vd;++ku){const mh=this.attemptAnchorPlacement(Qi[ku%Qi.length],wo,cl,Nl,Cl,pt,mt,re,A,Re,ku>=Qi.length,Zt,wn,x,cu,zl,Ie,Te);if(mh&&(Cc=mh.placedGlyphBoxes,Cc&&Cc.box&&Cc.box.length)){Cn=!0,di=mh.shift;break}}return Cc};Po(()=>ps(ma,ln.iconBox,l.WritingMode.horizontal),()=>{const wo=ln.verticalTextBox;return wo&&oo(wo),x.allowVerticalPlacement&&!(yr&&yr.box&&yr.box.length)&&Jt>0&&wo?ps(wo,ln.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),yr&&(Cn=yr.box,kn=yr.offscreen,Yn=yr.occluded);const Us=Vo(!(!yr||!yr.box));if(!Cn&&this.prevPlacement){const wo=this.prevPlacement.variableOffsets[Bn];wo&&(this.variableOffsets[Bn]=wo,this.markUsedJustification(x,wo.anchor,Zt,Us))}}else{const Qi=(ps,Us)=>{const wo=x.getSymbolInstanceTextSize(Ie,Zt,this.transform.zoom,wn),Ys=this.collisionIndex.placeCollisionBox(x,wo,ps,new l.Point(0,0),Ne,re,A,Re.predicate);return Ys&&Ys.box&&Ys.box.length&&(this.markUsedOrientation(x,Us,Zt),this.placedOrientations[Bn]=Us),Ys};Po(()=>Qi(ma,l.WritingMode.horizontal),()=>{const ps=ln.verticalTextBox;return x.allowVerticalPlacement&&Jt>0&&ps?(oo(ps),Qi(ps,l.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Vo(!!(yr&&yr.box&&yr.box.length))}}if(ki=yr,Cn=ki&&ki.box&&ki.box.length>0,kn=ki&&ki.offscreen,Yn=ki&&ki.occluded,Zt.useRuntimeCollisionCircles){const Vo=x.text.placedSymbolArray.get(Zt.centerJustifiedTextSymbolIndex>=0?Zt.centerJustifiedTextSymbolIndex:Zt.verticalPlacedTextSymbolIndex),Po=l.evaluateSizeForFeature(x.textSizeData,Ie,Vo),Qi=C.get("text-padding");Di=this.collisionIndex.placeCollisionCircles(x,Ne,Vo,x.lineVertexArray,x.glyphOffsetArray,Po,A,N,H,p,mt,Re.predicate,Zt.collisionCircleDiameter*Po/l.ONE_EM,Qi,this.retainedQueryData[x.bucketInstanceId].tileID),Cn=Ne||Di.circles.length>0&&!Di.collisionDetected,kn=kn&&Di.offscreen,Yn=Di.occluded}if(ln.iconFeatureIndex&&(Co=ln.iconFeatureIndex),ln.iconBox){const Vo=Po=>{oo(Po);const Qi=gt&&di?Zo(di.x,di.y,pt,mt,this.transform.angle):new l.Point(0,0),ps=x.getSymbolInstanceIconSize(Te,this.transform.zoom,Zt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(x,ps,Po,Qi,$e,re,A,Re.predicate)};Vr&&Vr.box&&Vr.box.length&&ln.verticalIconBox?(wr=Vo(ln.verticalIconBox),$n=wr.box.length>0):(wr=Vo(ln.iconBox),$n=wr.box.length>0),kn=kn&&wr.offscreen,Or=wr.occluded}const bo=ie||0===Zt.numHorizontalGlyphVertices&&0===Jt,Ua=ve||0===Zt.numIconVertices;if(bo||Ua?Ua?bo||($n=$n&&Cn):Cn=$n&&Cn:$n=Cn=$n&&Cn,Cn&&ki&&ki.box&&this.collisionIndex.insertCollisionBox(ki.box,C.get("text-ignore-placement"),x.bucketInstanceId,Vr&&Vr.box&&Do?Do:fo,Re.ID),$n&&wr&&this.collisionIndex.insertCollisionBox(wr.box,C.get("icon-ignore-placement"),x.bucketInstanceId,Co,Re.ID),Di&&(Cn&&this.collisionIndex.insertCollisionCircles(Di.circles,C.get("text-ignore-placement"),x.bucketInstanceId,fo,Re.ID),p)){const Vo=x.bucketInstanceId;let Po=this.collisionCircleArrays[Vo];void 0===Po&&(Po=this.collisionCircleArrays[Vo]=new Zr);for(let Qi=0;Qi<Di.circles.length;Qi+=4)Po.circles.push(Di.circles[Qi+0]),Po.circles.push(Di.circles[Qi+1]),Po.circles.push(Di.circles[Qi+2]),Po.circles.push(Di.collisionDetected?1:0)}const Ja="globe"!==x.projection.name;Ft=Ft&&(Ja||!Yn),nn=nn&&(Ja||!Or),this.placements[Bn]=new Ar(Cn||Ft,$n||nn,kn||x.justReloaded),c.add(Bn)};if(Bt){const Zt=x.getSortedSymbolIndexes(this.transform.angle);for(let wn=Zt.length-1;wn>=0;--wn){const ln=Zt[wn];Un(x.symbolInstances.get(ln),ln,x.collisionArrays[ln])}}else for(let Zt=i.symbolInstanceStart;Zt<i.symbolInstanceEnd;Zt++)Un(x.symbolInstances.get(Zt),Zt,x.collisionArrays[Zt]);if(p&&x.bucketInstanceId in this.collisionCircleArrays){const Zt=this.collisionCircleArrays[x.bucketInstanceId];l.invert(Zt.invProjMatrix,A),Zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1}markUsedJustification(i,c,p,_){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:A,verticalPlacedTextSymbolIndex:N,crossTileID:H}=p,j=l.getAnchorJustification(c),re=_===l.WritingMode.vertical?N:"left"===j?x:"center"===j?C:"right"===j?A:-1;x>=0&&(i.text.placedSymbolArray.get(x).crossTileID=re>=0&&x!==re?0:H),C>=0&&(i.text.placedSymbolArray.get(C).crossTileID=re>=0&&C!==re?0:H),A>=0&&(i.text.placedSymbolArray.get(A).crossTileID=re>=0&&A!==re?0:H),N>=0&&(i.text.placedSymbolArray.get(N).crossTileID=re>=0&&N!==re?0:H)}markUsedOrientation(i,c,p){const _=c===l.WritingMode.horizontal||c===l.WritingMode.horizontalOnly?c:0,x=c===l.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:H}=p,j=i.text.placedSymbolArray;C>=0&&(j.get(C).placedOrientation=_),A>=0&&(j.get(A).placedOrientation=_),N>=0&&(j.get(N).placedOrientation=_),H>=0&&(j.get(H).placedOrientation=x)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(i):1,x=c?c.opacities:{},C=c?c.variableOffsets:{},A=c?c.placedOrientations:{};for(const N in this.placements){const H=this.placements[N],j=x[N];j?(this.opacities[N]=new lr(j,_,H.text,H.icon,null,H.clipped),p=p||H.text!==j.text.placed||H.icon!==j.icon.placed):(this.opacities[N]=new lr(null,_,H.text,H.icon,H.skipFade,H.clipped),p=p||H.text||H.icon)}for(const N in x){const H=x[N];if(!this.opacities[N]){const j=new lr(H,_,!1,!1);j.isHidden()||(this.opacities[N]=j,p=p||H.text.placed||H.icon.placed)}}for(const N in C)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=C[N]);for(const N in A)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=A[N]);p?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){const p=new Set;for(const _ of c){const x=_.getBucket(i);x&&_.latestFeatureIndex&&i.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,_.collisionBoxArray)}}updateBucketOpacities(i,c,p){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const _=i.layers[0].layout,x=!!i.layers[0].dynamicFilter(),C=new lr(null,0,!1,!1,!0),A=_.get("text-allow-overlap"),N=_.get("icon-allow-overlap"),H=_.get("text-variable-anchor"),j="map"===_.get("text-rotation-alignment"),re="map"===_.get("text-pitch-alignment"),fe="none"!==_.get("icon-text-fit"),ye=new lr(null,0,A&&(N||!i.hasIconData()||_.get("icon-optional")),N&&(A||!i.hasTextData()||_.get("text-optional")),!0);!i.collisionArrays&&p&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(p);const Ie=(Re,ie,ve)=>{for(let Ne=0;Ne<ie/4;Ne++)Re.opacityVertexArray.emplaceBack(ve)};let Te=0;for(let Re=0;Re<i.symbolInstances.length;Re++){const ie=i.symbolInstances.get(Re),{numHorizontalGlyphVertices:ve,numVerticalGlyphVertices:Ne,crossTileID:$e,numIconVertices:pt}=ie,mt=c.has($e);let gt=this.opacities[$e];mt?gt=C:gt||(gt=ye,this.opacities[$e]=gt),c.add($e);const Bt=ve>0||Ne>0,Ft=pt>0,nn=this.placedOrientations[$e],Un=nn===l.WritingMode.vertical,Zt=nn===l.WritingMode.horizontal||nn===l.WritingMode.horizontalOnly;if(!Bt&&!Ft||gt.isHidden()||Te++,Bt){const wn=gs(gt.text);Ie(i.text,ve,Un?xi:wn),Ie(i.text,Ne,Zt?xi:wn);const ln=gt.text.isHidden(),{leftJustifiedTextSymbolIndex:Bn,centerJustifiedTextSymbolIndex:Jt,rightJustifiedTextSymbolIndex:Cn,verticalPlacedTextSymbolIndex:$n}=ie,kn=i.text.placedSymbolArray,Yn=ln||Un?1:0;Bn>=0&&(kn.get(Bn).hidden=Yn),Jt>=0&&(kn.get(Jt).hidden=Yn),Cn>=0&&(kn.get(Cn).hidden=Yn),$n>=0&&(kn.get($n).hidden=ln||Zt?1:0);const Or=this.variableOffsets[$e];Or&&this.markUsedJustification(i,Or.anchor,ie,nn);const di=this.placedOrientations[$e];di&&(this.markUsedJustification(i,"left",ie,di),this.markUsedOrientation(i,di,ie))}if(Ft){const wn=gs(gt.icon),{placedIconSymbolIndex:ln,verticalPlacedIconSymbolIndex:Bn}=ie,Jt=i.icon.placedSymbolArray,Cn=gt.icon.isHidden()?1:0;ln>=0&&(Ie(i.icon,pt,Un?xi:wn),Jt.get(ln).hidden=Cn),Bn>=0&&(Ie(i.icon,ie.numVerticalIconVertices,Zt?xi:wn),Jt.get(Bn).hidden=Cn)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const wn=i.collisionArrays[Re];if(wn){let ln=new l.Point(0,0),Bn=!0;if(wn.textBox||wn.verticalTextBox){if(H){const Cn=this.variableOffsets[$e];Cn?(ln=Ki(Cn.anchor,Cn.width,Cn.height,Cn.textOffset,Cn.textScale),j&&ln._rotate(re?this.transform.angle:-this.transform.angle)):Bn=!1}x&&(Bn=!gt.clipped),wn.textBox&&Io(i.textCollisionBox.collisionVertexArray,gt.text.placed,!Bn||Un,ln.x,ln.y),wn.verticalTextBox&&Io(i.textCollisionBox.collisionVertexArray,gt.text.placed,!Bn||Zt,ln.x,ln.y)}const Jt=Bn&&!(Zt||!wn.verticalIconBox);wn.iconBox&&Io(i.iconCollisionBox.collisionVertexArray,gt.icon.placed,Jt,fe?ln.x:0,fe?ln.y:0),wn.verticalIconBox&&Io(i.iconCollisionBox.collisionVertexArray,gt.icon.placed,!Jt,fe?ln.x:0,fe?ln.y:0)}}}if(i.fullyClipped=0===Te,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Re.invProjMatrix,i.placementViewportMatrix=Re.viewportMatrix,i.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function Io(h,i,c,p,_){h.emplaceBack(i?1:0,c?1:0,p||0,_||0),h.emplaceBack(i?1:0,c?1:0,p||0,_||0),h.emplaceBack(i?1:0,c?1:0,p||0,_||0),h.emplaceBack(i?1:0,c?1:0,p||0,_||0)}const ro=Math.pow(2,25),Si=Math.pow(2,24),wa=Math.pow(2,17),sa=Math.pow(2,16),Gr=Math.pow(2,9),Ii=Math.pow(2,8),Fo=Math.pow(2,1);function gs(h){if(0===h.opacity&&!h.placed)return 0;if(1===h.opacity&&h.placed)return 4294967295;const i=h.placed?1:0,c=Math.floor(127*h.opacity);return c*ro+i*Si+c*wa+i*sa+c*Gr+i*Ii+c*Fo+i}const xi=0;class Js{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(i,c,p,_,x){const C=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(C,_,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((A,N)=>A.sortKey-N.sortKey));this._currentPartIndex<C.length;){const A=C[this._currentPartIndex];if(c.placeLayerBucketPart(A,this._seenCrossTileIDs,p,0===A.symbolInstanceStart),this._currentPartIndex++,x())return!0}return!1}}class Qs{constructor(i,c,p,_,x,C,A,N){this.placement=new ao(i,x,C,A,N),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(i,c,p){const _=l.exported.now(),x=()=>{const C=l.exported.now()-_;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){const C=c[i[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if("symbol"===C.type&&(!C.minzoom||C.minzoom<=A)&&(!C.maxzoom||C.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new Js(C)),this._inProgressLayer.continuePlacement(p[C.source],this.placement,this._showCollisionBoxes,C,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Is=512/l.EXTENT/2;class vo{constructor(i,c,p){this.tileID=i,this.bucketInstanceId=p,this.index=new l.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=i.canonical.x*l.EXTENT,x=i.canonical.y*l.EXTENT;for(let C=0;C<c.length;C++){const{key:A,crossTileID:N,tileAnchorX:H,tileAnchorY:j}=c.get(C),re=Math.floor((_+H)*Is),fe=Math.floor((x+j)*Is);this.index.add(re,fe),this.keys.push(A),this.crossTileIDs.push(N)}this.index.finish()}findMatches(i,c,p){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),x=Is/Math.pow(2,c.canonical.z-this.tileID.canonical.z),C=c.canonical.x*l.EXTENT,A=c.canonical.y*l.EXTENT;for(let N=0;N<i.length;N++){const H=i.get(N);if(H.crossTileID)continue;const{key:j,tileAnchorX:re,tileAnchorY:fe}=H,ye=Math.floor((C+re)*x),Ie=Math.floor((A+fe)*x),Te=this.index.range(ye-_,Ie-_,ye+_,Ie+_);for(const Re of Te){const ie=this.crossTileIDs[Re];if(this.keys[Re]===j&&!p.has(ie)){p.add(ie),H.crossTileID=ie;break}}}}}class ha{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(0!==c)for(const p in this.indexes){const _=this.indexes[p],x={};for(const C in _){const A=_[C];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+c),x[A.tileID.key]=A}this.indexes[p]=x}this.lng=i}addBucket(i,c,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let x=0;x<c.symbolInstances.length;x++)c.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]=new Set);const _=this.usedCrossTileIDs[i.overscaledZ];for(const x in this.indexes){const C=this.indexes[x];if(Number(x)>i.overscaledZ)for(const A in C){const N=C[A];N.tileID.isChildOf(i)&&N.findMatches(c.symbolInstances,i,_)}else{const A=C[i.scaledTo(Number(x)).key];A&&A.findMatches(c.symbolInstances,i,_)}}for(let x=0;x<c.symbolInstances.length;x++){const C=c.symbolInstances.get(x);C.crossTileID||(C.crossTileID=p.generate(),_.add(C.crossTileID))}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new vo(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const p of c.crossTileIDs)this.usedCrossTileIDs[i].delete(p)}removeStaleBuckets(i){let c=!1;for(const p in this.indexes){const _=this.indexes[p];for(const x in _)i[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[x]),delete _[x],c=!0)}return c}}class rr{constructor(){this.layerIndexes={},this.crossTileIDs=new ha,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,p,_){let x=this.layerIndexes[i.id];void 0===x&&(x=this.layerIndexes[i.id]=new Wi);let C=!1;const A={};"globe"!==_.name&&x.handleWrapJump(p);for(const N of c){const H=N.getBucket(i);H&&i.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(N.tileID,H,this.crossTileIDs)&&(C=!0),A[H.bucketInstanceId]=!0)}return x.removeStaleBuckets(A)&&(C=!0),C}pruneUnusedLayers(i){const c={};i.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const Rr=(h,i)=>l.emitValidationErrors(h,i&&i.filter(c=>"source.canvas"!==c.identifier)),qi=l.pick(yn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),_s=l.pick(yn,["setCenter","setZoom","setBearing","setPitch"]),rs={version:8,layers:[],sources:{}},io={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Wo extends l.Evented{constructor(i,c={}){super(),this.map=i,this.dispatcher=new Wt(Ke(),this),this.imageManager=new _n,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(i._requestManager,c.localFontFamily?l.LocalGlyphMode.all:c.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new rr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const p=this;this._rtlTextPluginCallback=Wo.registerForPluginStateChange(_=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(x,C)=>{if(l.triggerPluginCompletionEvent(x),C&&C.every(A=>A))for(const A in p._sourceCaches){const N=p._sourceCaches[A],H=N.getSource().type;"vector"!==H&&"geojson"!==H||N.reload()}})}),this.on("data",_=>{if("source"!==_.dataType||"metadata"!==_.sourceDataType)return;const x=this.getSource(_.sourceId);if(x&&x.vectorLayerIds)for(const C in this._layers){const A=this._layers[C];A.source===x.id&&this._validateLayer(A)}})}loadURL(i,c={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const p="boolean"==typeof c.validate?c.validate:!l.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,c.accessToken);const _=this.map._requestManager.transformRequest(i,l.ResourceType.Style);this._request=l.getJSON(_,(x,C)=>{this._request=null,x?this.fire(new l.ErrorEvent(x)):C&&this._load(C,p)})}loadJSON(i,c={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(i,!1!==c.validate)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(rs,!1)}_updateLayerCount(i,c){const p=c?1:-1;i.is3D()&&(this._num3DLayers+=p),"circle"===i.type&&(this._numCircleLayers+=p),"symbol"===i.type&&(this._numSymbolLayers+=p)}_load(i,c){if(c&&Rr(this,l.validateStyle(i)))return;this._loaded=!0,this.stylesheet=l.clone$1(i),this._updateMapProjection();for(const _ in i.sources)this.addSource(_,i.sources[_],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const p=Xt(this.stylesheet.layers);this._order=p.map(_=>_.id),this._layers={},this._serializedLayers={};for(const _ of p){const x=l.createStyleLayer(_);x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ft(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(i){this._spriteRequest=function(c,p,_){let x,C,A;const N=l.exported.devicePixelRatio>1?"@2x":"";let H=l.getJSON(p.transformRequest(p.normalizeSpriteURL(c,N,".json"),l.ResourceType.SpriteJSON),(fe,ye)=>{H=null,A||(A=fe,x=ye,re())}),j=l.getImage(p.transformRequest(p.normalizeSpriteURL(c,N,".png"),l.ResourceType.SpriteImage),(fe,ye)=>{j=null,A||(A=fe,C=ye,re())});function re(){if(A)_(A);else if(x&&C){const fe=l.exported.getImageData(C),ye={};for(const Ie in x){const{width:Te,height:Re,x:ie,y:ve,sdf:Ne,pixelRatio:$e,stretchX:pt,stretchY:mt,content:gt}=x[Ie],Bt=new l.RGBAImage({width:Te,height:Re});l.RGBAImage.copy(fe,Bt,{x:ie,y:ve},{x:0,y:0},{width:Te,height:Re}),ye[Ie]={data:Bt,pixelRatio:$e,sdf:Ne,stretchX:pt,stretchY:mt,content:gt}}_(null,ye)}}return{cancel(){H&&(H.cancel(),H=null),j&&(j.cancel(),j=null)}}}(i,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new l.ErrorEvent(c));else if(p)for(const _ in p)this.imageManager.addImage(_,p[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(i){const c=this.getSource(i.source);if(!c)return;const p=i.sourceLayer;p&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(p))&&this.fire(new l.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const c=[];for(const p of i){const _=this._layers[p];"custom"!==_.type&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&("function"==typeof i.isLayerDraped?i.isLayerDraped():io[i.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(_.length||x.length)&&this._updateWorkerLayers(_,x);for(const C in this._updatedSources){const A=this._updatedSources[C];"reload"===A?this._reloadSource(C):"clear"===A&&this._clearSource(C)}this._updateTilesForChangedImages();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const p={};for(const _ in this._sourceCaches){const x=this._sourceCaches[_];p[_]=x.used,x.used=!1}for(const _ of this._order){const x=this._layers[_];if(x.recalculate(i,this._availableImages),!x.isHidden(i.zoom)){const A=this._getLayerSourceCache(x);A&&(A.used=!0)}const C=this.map.painter;if(C){const A=x.getProgramIds();if(!A)continue;const N=x.getProgramConfiguration(i.zoom);for(const H of A)C.useProgram(H,N)}}for(const _ in p){const x=this._sourceCaches[_];p[_]!==x.used&&x.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Rr(this,l.validateStyle(i)))return!1;(i=l.clone$1(i)).layers=Xt(i.layers);const c=function(_,x){if(!_)return[{command:yn.setStyle,args:[x]}];let C=[];try{if(!Ee(_.version,x.version))return[{command:yn.setStyle,args:[x]}];Ee(_.center,x.center)||C.push({command:yn.setCenter,args:[x.center]}),Ee(_.zoom,x.zoom)||C.push({command:yn.setZoom,args:[x.zoom]}),Ee(_.bearing,x.bearing)||C.push({command:yn.setBearing,args:[x.bearing]}),Ee(_.pitch,x.pitch)||C.push({command:yn.setPitch,args:[x.pitch]}),Ee(_.sprite,x.sprite)||C.push({command:yn.setSprite,args:[x.sprite]}),Ee(_.glyphs,x.glyphs)||C.push({command:yn.setGlyphs,args:[x.glyphs]}),Ee(_.transition,x.transition)||C.push({command:yn.setTransition,args:[x.transition]}),Ee(_.light,x.light)||C.push({command:yn.setLight,args:[x.light]}),Ee(_.fog,x.fog)||C.push({command:yn.setFog,args:[x.fog]}),Ee(_.projection,x.projection)||C.push({command:yn.setProjection,args:[x.projection]});const A={},N=[];!function(re,fe,ye,Ie){let Te;for(Te in fe=fe||{},re=re||{})re.hasOwnProperty(Te)&&(fe.hasOwnProperty(Te)||br(Te,ye,Ie));for(Te in fe){if(!fe.hasOwnProperty(Te))continue;const Re=fe[Te];re.hasOwnProperty(Te)?Ee(re[Te],Re)||("geojson"===re[Te].type&&"geojson"===Re.type&&hi(re,fe,Te)?ye.push({command:yn.setGeoJSONSourceData,args:[Te,Re.data]}):or(Te,fe,ye,Ie)):zn(Te,fe,ye)}}(_.sources,x.sources,N,A);const H=[];_.layers&&_.layers.forEach(re=>{re.source&&A[re.source]?C.push({command:yn.removeLayer,args:[re.id]}):H.push(re)});let j=_.terrain;j&&A[j.source]&&(C.push({command:yn.setTerrain,args:[void 0]}),j=void 0),C=C.concat(N),Ee(j,x.terrain)||C.push({command:yn.setTerrain,args:[x.terrain]}),function(re,fe,ye){fe=fe||[];const Ie=(re=re||[]).map(mi),Te=fe.map(mi),Re=re.reduce(Yr,{}),ie=fe.reduce(Yr,{}),ve=Ie.slice(),Ne=Object.create(null);let $e,pt,mt,gt,Bt,Ft,nn;for($e=0,pt=0;$e<Ie.length;$e++)mt=Ie[$e],ie.hasOwnProperty(mt)?pt++:(ye.push({command:yn.removeLayer,args:[mt]}),ve.splice(ve.indexOf(mt,pt),1));for($e=0,pt=0;$e<Te.length;$e++)mt=Te[Te.length-1-$e],ve[ve.length-1-$e]!==mt&&(Re.hasOwnProperty(mt)?(ye.push({command:yn.removeLayer,args:[mt]}),ve.splice(ve.lastIndexOf(mt,ve.length-pt),1)):pt++,Ft=ve[ve.length-$e],ye.push({command:yn.addLayer,args:[ie[mt],Ft]}),ve.splice(ve.length-$e,0,mt),Ne[mt]=!0);for($e=0;$e<Te.length;$e++)if(mt=Te[$e],gt=Re[mt],Bt=ie[mt],!Ne[mt]&&!Ee(gt,Bt))if(Ee(gt.source,Bt.source)&&Ee(gt["source-layer"],Bt["source-layer"])&&Ee(gt.type,Bt.type)){for(nn in Sr(gt.layout,Bt.layout,ye,mt,null,yn.setLayoutProperty),Sr(gt.paint,Bt.paint,ye,mt,null,yn.setPaintProperty),Ee(gt.filter,Bt.filter)||ye.push({command:yn.setFilter,args:[mt,Bt.filter]}),Ee(gt.minzoom,Bt.minzoom)&&Ee(gt.maxzoom,Bt.maxzoom)||ye.push({command:yn.setLayerZoomRange,args:[mt,Bt.minzoom,Bt.maxzoom]}),gt)gt.hasOwnProperty(nn)&&"layout"!==nn&&"paint"!==nn&&"filter"!==nn&&"metadata"!==nn&&"minzoom"!==nn&&"maxzoom"!==nn&&(0===nn.indexOf("paint.")?Sr(gt[nn],Bt[nn],ye,mt,nn.slice(6),yn.setPaintProperty):Ee(gt[nn],Bt[nn])||ye.push({command:yn.setLayerProperty,args:[mt,nn,Bt[nn]]}));for(nn in Bt)Bt.hasOwnProperty(nn)&&!gt.hasOwnProperty(nn)&&"layout"!==nn&&"paint"!==nn&&"filter"!==nn&&"metadata"!==nn&&"minzoom"!==nn&&"maxzoom"!==nn&&(0===nn.indexOf("paint.")?Sr(gt[nn],Bt[nn],ye,mt,nn.slice(6),yn.setPaintProperty):Ee(gt[nn],Bt[nn])||ye.push({command:yn.setLayerProperty,args:[mt,nn,Bt[nn]]}))}else ye.push({command:yn.removeLayer,args:[mt]}),Ft=ve[ve.lastIndexOf(mt)+1],ye.push({command:yn.addLayer,args:[Bt,Ft]})}(H,x.layers,C)}catch(A){console.warn("Unable to compute style diff:",A),C=[{command:yn.setStyle,args:[x]}]}return C}(this.serialize(),i).filter(_=>!(_.command in _s));if(0===c.length)return!1;const p=c.filter(_=>!(_.command in qi));if(p.length>0)throw new Error(`Unimplemented: ${p.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{"setTransition"!==_.command&&"setProjection"!==_.command&&this[_.command].apply(this,_.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,c){return this.getImage(i)?this.fire(new l.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,c),this._afterImageUpdated(i),this)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new l.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,c,p={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(l.validateSource,`sources.${i}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=At(i,c,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:_.serialize(),sourceId:i}));const x=C=>{const A=(C?"symbol:":"other:")+i,N=this._sourceCaches[A]=new l.SourceCache(A,_,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[i]=N,N.style=this,N.onAdd(this.map)};x(!1),"vector"!==c.type&&"geojson"!==c.type||x(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const c=this.getSource(i);if(!c)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(i);for(const _ of p)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getSource(i).setData(c),this._changed=!0}getSource(i){const c=this._getSourceCache(i);return c&&c.getSource()}_getSources(){const i=[];for(const c in this._otherSourceCaches){const p=this._getSourceCache(c);p&&i.push(p.getSource())}return i}addLayer(i,c,p={}){this._checkLoaded();const _=i.id;if(this.getLayer(_))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let x;if("custom"===i.type){if(Rr(this,l.validateCustomStyleLayer(i)))return;x=l.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(_,i.source),i=l.clone$1(i),i=l.extend(i,{source:_})),this._validate(l.validateLayer,`layers.${_}`,i,{arrayIndex:-1},p))return;x=l.createStyleLayer(i),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}const C=c?this._order.indexOf(c):this._order.length;if(c&&-1===C)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(C,0,_),this._layerOrderChanged=!0,this._layers[_]=x;const A=this._getLayerSourceCache(x);if(this._removedLayers[_]&&x.source&&A&&"custom"!==x.type){const N=this._removedLayers[_];delete this._removedLayers[_],N.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",A.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;const p=this._order.indexOf(i);this._order.splice(p,1);const _=c?this._order.indexOf(c):this._order.length;c&&-1===_?this.fire(new l.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(_,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const c=this._layers[i];if(!c)return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(i);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,p){this._checkLoaded();const _=this.getLayer(i);_?_.minzoom===c&&_.maxzoom===p||(null!=c&&(_.minzoom=c),null!=p&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,c,p={}){this._checkLoaded();const _=this.getLayer(i);if(_){if(!Ee(_.filter,c))return null==c?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(l.validateFilter,`layers.${_.id}.filter`,c,{layerType:_.type},p)||(_.filter=l.clone$1(c),this._updateLayer(_)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const c=this.getLayer(i);return c&&l.clone$1(c.filter)}setLayoutProperty(i,c,p,_={}){this._checkLoaded();const x=this.getLayer(i);x?Ee(x.getLayoutProperty(c),p)||(x.setLayoutProperty(c,p,_),this._updateLayer(x)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,c){const p=this.getLayer(i);if(p)return p.getLayoutProperty(c);this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,c,p,_={}){this._checkLoaded();const x=this.getLayer(i);x?Ee(x.getPaintProperty(c),p)||(x.setPaintProperty(c,p,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,c){const p=this.getLayer(i);return p&&p.getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();const p=i.source,_=i.sourceLayer,x=this.getSource(p);if(!x)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const C=x.type;if("geojson"===C&&_)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===C&&!_)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const A=this._getSourceCaches(p);for(const N of A)N.setFeatureState(_,i.id,c)}removeFeatureState(i,c){this._checkLoaded();const p=i.source,_=this.getSource(p);if(!_)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const x=_.type,C="vector"===x?i.sourceLayer:void 0;if("vector"===x&&!C)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const A=this._getSourceCaches(p);for(const N of A)N.removeFeatureState(C,i.id,c)}getFeatureState(i){this._checkLoaded();const c=i.source,p=i.sourceLayer,_=this.getSource(c);if(_){if("vector"!==_.type||p)return void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,i.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();i[p.id]||(i[p.id]=p.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(i){this._updatedLayers[i.id]=!0;const c=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[i.source]="reload",c.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=C=>"fill-extrusion"===this._layers[C].type,p={},_=[];for(let C=this._order.length-1;C>=0;C--){const A=this._order[C];if(c(A)){p[A]=C;for(const N of i){const H=N[A];if(H)for(const j of H)_.push(j)}}}_.sort((C,A)=>A.intersectionZ-C.intersectionZ);const x=[];for(let C=this._order.length-1;C>=0;C--){const A=this._order[C];if(c(A))for(let N=_.length-1;N>=0;N--){const H=_[N].feature;if(p[H.layer.id]<C)break;x.push(H),_.pop()}else for(const N of i){const H=N[A];if(H)for(const j of H)x.push(j.feature)}}return x}queryRenderedFeatures(i,c,p){c&&c.filter&&this._validate(l.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const N of c.layers){const H=this._layers[N];if(!H)return this.fire(new l.ErrorEvent(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];_[H.source]=!0}}const x=[];c.availableImages=this._availableImages;const C=c&&c.layers?c.layers.some(N=>{const H=this.getLayer(N);return H&&H.is3D()}):this.has3DLayers(),A=an.createFromScreenPoints(i,p);for(const N in this._sourceCaches){const H=this._sourceCaches[N].getSource().id;c.layers&&!_[H]||x.push(qn(this._sourceCaches[N],this._layers,this._serializedLayers,A,c,p,C,!!this.map._showQueryGeometry))}return this.placement&&x.push(function(N,H,j,re,fe,ye,Ie){const Te={},Re=ye.queryRenderedSymbols(re),ie=[];for(const ve of Object.keys(Re).map(Number))ie.push(Ie[ve]);ie.sort(Mr);for(const ve of ie){const Ne=ve.featureIndex.lookupSymbolFeatures(Re[ve.bucketInstanceId],H,ve.bucketIndex,ve.sourceLayerIndex,fe.filter,fe.layers,fe.availableImages,N);for(const $e in Ne){const pt=Te[$e]=Te[$e]||[],mt=Ne[$e];mt.sort((gt,Bt)=>{const Ft=ve.featureSortOrder;if(Ft){const nn=Ft.indexOf(gt.featureIndex);return Ft.indexOf(Bt.featureIndex)-nn}return Bt.featureIndex-gt.featureIndex});for(const gt of mt)pt.push(gt)}}for(const ve in Te)Te[ve].forEach(Ne=>{const $e=Ne.feature,pt=j(N[ve]);if(!pt)return;const mt=pt.getFeatureState($e.layer["source-layer"],$e.id);$e.source=$e.layer.source,$e.layer["source-layer"]&&($e.sourceLayer=$e.layer["source-layer"]),$e.state=mt});return Te}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),A.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(i,c){c&&c.filter&&this._validate(l.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(i);let _=[];for(const x of p)_=_.concat(gr(x,c));return _}addSourceType(i,c,p){return Wo.getSourceType(i)?p(new Error(`A source type called "${i}" already exists.`)):(Wo.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const C in i)if(!Ee(i[C],p[C])){_=!0;break}if(!_)return;const x=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(i,c),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,c=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let p=i;if(1===c){if("object"==typeof p.source){const _="terrain-dem-src";this.addSource(_,p.source),p=l.clone$1(p),p=l.extend(p,{source:_})}if(this._validate(l.validateTerrain,"terrain",p))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,c)}else{const _=this.terrain,x=_.get();for(const C of Object.keys(l.spec.terrain))!p.hasOwnProperty(C)&&l.spec.terrain[C].default&&(p[C]=l.spec.terrain[C].default);for(const C in p)if(!Ee(p[C],x[C])){_.set(p),this.stylesheet.terrain=p;const A=this._setTransitionParameters({duration:0});_.updateTransitions(A);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new nr(i,this.map.transform);this.stylesheet.fog=i;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();0===Object.keys(i).length&&c.set(i);for(const _ in i)if(!Ee(i[_],p[_])){c.set(i),this.stylesheet.fog=i;const x=this._setTransitionParameters({duration:0});c.updateTransitions(x);break}}else this._createFog(i);this._markersNeedUpdate=!0}_setTransitionParameters(i){return{now:l.exported.now(),transition:l.extend(i,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const p=this.terrain=new yt(i,c);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});p.updateTransitions(_)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"symbol"===c.type&&this._updateLayer(c)}}_validate(i,c,p,_,x={}){return(!x||!1!==x.validate)&&Rr(this,i.call(l.validateStyle,l.extend({key:c,style:this.serialize(),value:p,styleSpec:l.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const c=this._getSourceCaches(i);for(const p of c)p.clearTiles()}_reloadSource(i){const c=this._getSourceCaches(i);for(const p of c)p.resume(),p.reload()}_reloadSources(){for(const i of this._getSources())i.reload&&i.reload()}_updateSources(i){for(const c in this._sourceCaches)this._sourceCaches[c].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,p,_,x=!1){let C=!1,A=!1;const N={};for(const H of this._order){const j=this._layers[H];if("symbol"!==j.type)continue;if(!N[j.source]){const fe=this._getLayerSourceCache(j);if(!fe)continue;N[j.source]=fe.getRenderableIds(!0).map(ye=>fe.getTileByID(ye)).sort((ye,Ie)=>Ie.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(Ie.tileID)?-1:1))}const re=this.crossTileSymbolIndex.addLayer(j,N[j.source],i.center.lng,i.projection);C=C||re}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),x=x||this._layerOrderChanged||0===p,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),i.zoom))&&(this.pauseablePlacement=new Qs(i,this._order,x,c,p,_,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),A=!0),C&&this.pauseablePlacement.placement.setStale()),A||C)for(const H of this._order){const j=this._layers[H];"symbol"===j.type&&this.placement.updateLayerOpacities(j,N[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const _=x=>{x&&x.setDependencies(c.tileID.key,c.type,c.icons)};_(this._otherSourceCaches[c.source]),_(this._symbolSourceCaches[c.source])}getGlyphs(i,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(i,c,p){return l.makeRequest(c,p)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}_isSourceCacheLoaded(i){const c=this._getSourceCaches(i);return 0===c.length?(this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):c.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Wo.getSourceType=function(h){return He[h]},Wo.setSourceType=function(h,i){He[h]=i},Wo.registerForPluginStateChange=l.registerForPluginStateChange;var no="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",$o="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Bo="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Wr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Xo="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ko={},ys={};const Ni=[];ea(no,Ni),ea(Bo,Ni),ea(Wr,Ni),ea(Xo,Ni),Ko=ci("",Bo),ys=ci(Xo,Wr);const aa=ci("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),js=no,vs="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var is={background:ci("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ci("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ci("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ci("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ci("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ci("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:ci("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ci("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ci("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ci("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ci("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ci("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ci("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ci("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ci("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ci("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ci("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ci("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:ci("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:ci("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:ci("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:ci("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ci("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",$o),skyboxGradient:ci("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",$o),skyboxCapture:ci("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ci("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:ci("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ea(h,i){const c=h.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let p of c)if(p=p.trim(),"#"===p[0]&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=p.split(" ");for(const x of _)i.includes(x)||i.push(x)}}function ci(h,i){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},x=[...Ni];return ea(h,x),ea(i,x),{fragmentSource:h=h.replace(c,(C,A,N,H,j)=>(_[j]=!0,"define"===A?`\n#ifndef HAS_UNIFORM_u_${j}\nvarying ${N} ${H} ${j};\n#else\nuniform ${N} ${H} u_${j};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${j}\n    ${N} ${H} ${j} = u_${j};\n#endif\n`)),vertexSource:i=i.replace(c,(C,A,N,H,j)=>{const re="float"===H?"vec2":"vec4",fe=j.match(/color/)?"color":re;return _[j]?"define"===A?`\n#ifndef HAS_UNIFORM_u_${j}\nuniform lowp float u_${j}_t;\nattribute ${N} ${re} a_${j};\nvarying ${N} ${H} ${j};\n#else\nuniform ${N} ${H} u_${j};\n#endif\n`:"vec4"===fe?`\n#ifndef HAS_UNIFORM_u_${j}\n    ${j} = a_${j};\n#else\n    ${N} ${H} ${j} = u_${j};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${j}\n    ${j} = unpack_mix_${fe}(a_${j}, u_${j}_t);\n#else\n    ${N} ${H} ${j} = u_${j};\n#endif\n`:"define"===A?`\n#ifndef HAS_UNIFORM_u_${j}\nuniform lowp float u_${j}_t;\nattribute ${N} ${re} a_${j};\n#else\nuniform ${N} ${H} u_${j};\n#endif\n`:"vec4"===fe?`\n#ifndef HAS_UNIFORM_u_${j}\n    ${N} ${H} ${j} = a_${j};\n#else\n    ${N} ${H} ${j} = u_${j};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${j}\n    ${N} ${H} ${j} = unpack_mix_${fe}(a_${j}, u_${j}_t);\n#else\n    ${N} ${H} ${j} = u_${j};\n#endif\n`}),staticAttributes:p,usedDefines:x}}class Ms{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,c,p,_,x,C,A){this.context=i;let N=this.boundPaintVertexBuffers.length!==_.length;for(let j=0;!N&&j<_.length;j++)this.boundPaintVertexBuffers[j]!==_[j]&&(N=!0);let H=this.boundDynamicVertexBuffers.length!==A.length;for(let j=0;!H&&j<A.length;j++)this.boundDynamicVertexBuffers[j]!==A[j]&&(H=!0);if(!i.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||N||H||this.boundIndexBuffer!==x||this.boundVertexOffset!==C)this.freshBind(c,p,_,x,C,A);else{i.bindVertexArrayOES.set(this.vao);for(const j of A)j&&j.bind();x&&x.dynamicDraw&&x.bind()}}freshBind(i,c,p,_,x,C){let A;const N=i.numAttributes,H=this.context,j=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),A=0,this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=C;else{A=H.currentNumAttributes||0;for(let re=N;re<A;re++)j.disableVertexAttribArray(re)}c.enableAttributes(j,i),c.bind(),c.setVertexAttribPointers(j,i,x);for(const re of p)re.enableAttributes(j,i),re.bind(),re.setVertexAttribPointers(j,i,x);for(const re of C)re&&(re.enableAttributes(j,i),re.bind(),re.setVertexAttribPointers(j,i,x));_&&_.bind(),H.currentNumAttributes=N}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ta(h,i){const c=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new l.MercatorCoordinate(0,p/c).toLngLat().lat,new l.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function Jo(h,i,c,p,_,x,C){const A=h.context,N=A.gl,H=c.fbo;if(!H)return;h.prepareDrawTile();const j=h.useProgram("hillshade");A.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.colorAttachment.get());const re=((Te,Re,ie,ve)=>{const Ne=ie.paint.get("hillshade-shadow-color"),$e=ie.paint.get("hillshade-highlight-color"),pt=ie.paint.get("hillshade-accent-color");let mt=ie.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ie.paint.get("hillshade-illumination-anchor")&&(mt-=Te.transform.angle);const gt=!Te.options.moving;return{u_matrix:ve||Te.transform.calculateProjMatrix(Re.tileID.toUnwrapped(),gt),u_image:0,u_latrange:ta(0,Re.tileID),u_light:[ie.paint.get("hillshade-exaggeration"),mt],u_shadow:Ne,u_highlight:$e,u_accent:pt}})(h,c,p,h.terrain?i.projMatrix:null);h.prepareDrawProgram(A,j,i.toUnwrapped());const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:ye,tileBoundsSegments:Ie}=h.getTileBoundsBuffers(c);j.draw(A,N.TRIANGLES,_,x,C,l.CullFaceMode.disabled,re,p.id,fe,ye,Ie)}function fi(h,i,c){if(!i.needsDEMTextureUpload)return;const p=h.context,_=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||h.getTileTexture(c.stride);const x=c.getPixels();i.demTexture?i.demTexture.update(x,{premultiply:!1}):i.demTexture=new l.Texture(p,x,_.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function la(h,i,c,p,_,x){const C=h.context,A=C.gl;if(!i.dem)return;const N=i.dem;if(C.activeTexture.set(A.TEXTURE1),fi(h,i,N),!i.demTexture)return;i.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);const H=N.dim;C.activeTexture.set(A.TEXTURE0);let j=i.fbo;if(!j){const Ie=new l.Texture(C,{width:H,height:H,data:null},A.RGBA);Ie.bind(A.LINEAR,A.CLAMP_TO_EDGE),j=i.fbo=C.createFramebuffer(H,H,!0),j.colorAttachment.set(Ie.texture)}C.bindFramebuffer.set(j.framebuffer),C.viewport.set([0,0,H,H]);const{tileBoundsBuffer:re,tileBoundsIndexBuffer:fe,tileBoundsSegments:ye}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(C,A.TRIANGLES,p,_,x,l.CullFaceMode.disabled,((Ie,Te)=>{const Re=Te.stride,ie=l.create();return l.ortho(ie,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(ie,ie,[0,-l.EXTENT,0]),{u_matrix:ie,u_image:1,u_dimension:[Re,Re],u_zoom:Ie.overscaledZ,u_unpack:Te.unpackVector}})(i.tileID,N),c.id,re,fe,ye),i.needsHillshadePrepare=!1}const Qo=h=>({u_matrix:new l.UniformMatrix4f(h),u_image0:new l.Uniform1i(h),u_skirt_height:new l.Uniform1f(h)}),xs=(h,i)=>({u_matrix:h,u_image0:0,u_skirt_height:i}),os=(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:_,u_merc_center:x,u_image0:0,u_frustum_tl:C,u_frustum_tr:A,u_frustum_br:N,u_frustum_bl:H,u_globe_pos:j,u_globe_radius:re,u_viewport:fe,u_grid_matrix:Ie?Float32Array.from(Ie):new Float32Array(9),u_skirt_height:ye});function na(h,i){return null!=h&&null!=i&&!(!h.hasData()||!i.hasData())&&null!=h.demTexture&&null!=i.demTexture&&h.tileID.key!==i.tileID.key}const Ho=new class{constructor(){this.operations={}}newMorphing(h,i,c,p,_){if(h in this.operations){const x=this.operations[h];x.to.tileID.key!==c.tileID.key&&(x.queued=c)}else this.operations[h]={startTime:p,phase:0,duration:_,from:i,to:c,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const i=this.operations[h];return{from:i.from,to:i.to,phase:i.phase}}update(h){for(const i in this.operations){const c=this.operations[i];for(c.phase=(h-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,h)){delete this.operations[i];break}}}_nextOp(h,i){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=i,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Fs={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Eo(h){return 6*Math.pow(1.5,22-h)}function Hs(h,i){const c=1<<h.z;return!i&&(0===h.x||h.x===c-1)||0===h.y||h.y===c-1}const xo=h=>({u_matrix:h});function us(h,i,c,p,_){if(_>0){const x=l.exported.now(),C=(x-h.timeAdded)/_,A=i?(x-i.timeAdded)/_:-1,N=c.getSource(),H=p.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),j=!i||Math.abs(i.tileID.overscaledZ-H)>Math.abs(h.tileID.overscaledZ-H),re=j&&h.refreshedUponExpiration?1:l.clamp(j?C:1-A,0,1);return h.refreshedUponExpiration&&C>=1&&(h.refreshedUponExpiration=!1),i?{opacity:1,mix:1-re}:{opacity:re,mix:0}}return{opacity:1,mix:0}}class ya extends l.SourceCache{constructor(i){const c={type:"raster-dem",maxzoom:i.transform.maxZoom},p=new Wt(Ke(),null),_=At("mock-dem",c,p,i.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class ds extends l.SourceCache{constructor(i){const c=At("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new Wt(Ke(),null),i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,p){if(i.freezeTileCoverage)return;this.transform=i;const _=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,C)=>{if(x[C.key]="",!this._tiles[C.key]){const A=new l.Tile(C,this._source.tileSize*C.overscaleFactor(),i.tileZoom);A.state="loaded",this._tiles[C.key]=A}return x},{});for(const x in this._tiles)x in _||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(i){const c=this.proxyCachedFBO[i];if(void 0!==c){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class bs extends l.OverscaledTileID{constructor(i,c,p){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class S extends l.Elevation{constructor(i,c){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,_,x]=function(N){const H=new l.StructArrayLayout2i4,j=new l.StructArrayLayout3ui6;H.reserve(17161),j.reserve(33800);const fe=l.EXTENT/128,ye=l.EXTENT+fe/2,Ie=ye+fe;for(let Re=-fe;Re<Ie;Re+=fe)for(let ie=-fe;ie<Ie;ie+=fe){const ve=ie<0||ie>ye||Re<0||Re>ye?24575:0,Ne=l.clamp(Math.round(ie),0,l.EXTENT),$e=l.clamp(Math.round(Re),0,l.EXTENT);H.emplaceBack(Ne+ve,$e)}const Te=(Re,ie)=>{const ve=131*ie+Re;j.emplaceBack(ve+1,ve,ve+131),j.emplaceBack(ve+131,ve+131+1,ve+1)};for(let Re=1;Re<129;Re++)for(let ie=1;ie<129;ie++)Te(ie,Re);return[0,129].forEach(Re=>{for(let ie=0;ie<130;ie++)Te(ie,Re),Te(Re,ie)}),[H,j,32768]}(),C=i.context;this.gridBuffer=C.createVertexBuffer(p,l.posAttributes.members),this.gridIndexBuffer=C.createIndexBuffer(_),this.gridSegments=l.SegmentVector.simpleSegment(0,0,p.length,_.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,p.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ds(c.map),this.orthoMatrix=l.create(),l.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,l.EXTENT,0,l.EXTENT,0,1);const A=C.gl;this._overlapStencilMode=new l.StencilMode({func:A.GEQUAL,mask:255},0,255,A.KEEP,A.KEEP,A.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ya(c.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(i,c,p){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const _=i.terrain.properties;this.sourceCache=0===i.terrain.drapeRenderMode?this._mockSourceCache:i._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const x=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const C=this.getScaledDemTileSize();this.sourceCache.update(c,C,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),c.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&l.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=0===p._centerAltitude&&-1===this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(p.center),-1),this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=c.getIds().map(N=>{const H=c.getTileByID(N).tileID;return H.projMatrix=p.calculateProjMatrix(H.toUnwrapped()),H});(function(N,H){const j=H.transform.pointCoordinate(H.transform.getCameraPoint()),re=new l.Point(j.x,j.y);N.sort((fe,ye)=>{if(ye.overscaledZ-fe.overscaledZ)return ye.overscaledZ-fe.overscaledZ;const Ie=new l.Point(fe.canonical.x+(1<<fe.canonical.z)*fe.wrap,fe.canonical.y),Te=new l.Point(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),Re=re.mult(1<<fe.canonical.z);return Re.x-=.5,Re.y-=.5,Re.distSqr(Ie)-Re.distSqr(Te)})})(_,this.painter),this._previousZoom=p.zoom;const x=this.proxyToSource||{};this.proxyToSource={},_.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const C=this._style._sourceCaches;for(const N in C){const H=C[N];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,i[N],x),H.usedForTerrain))continue;const j=i[N];H.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[c.id]=_.map(N=>new bs(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const A={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const H=this.terrainTileForTile[N.key];if(!H)continue;const j=H.tileID.key;j in A||(this._visibleDemTiles.push(H),A[j]=j)}}_assignTerrainTiles(i){this._initializing||i.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const p in this.terrainTileForTile){const _=this.terrainTileForTile[p],x=_.dem;!x||_.demTexture&&!_.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),fi(this.painter,_,x))}}_prepareDemTileUniforms(i,c,p,_){if(!c||null==c.demTexture)return!1;const x=i.tileID.canonical,C=Math.pow(2,c.tileID.canonical.z-x.z),A=_||"";return p[`u_dem_tl${A}`]=[x.x*C%1,x.y*C%1],p[`u_dem_scale${A}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,c=i.gl;if(!this._emptyDepthBufferTexture){const p=new l.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new l.Texture(i,p,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const c=this._visibleDemTiles.reduce((p,_)=>{if(!_.dem)return p;const x=_.dem.tree.minimums[0];return x>0&&i++,p+x},0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),_=new l.RGBAImage({width:1,height:1},new Uint8Array(l.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(_,{premultiply:!1}):x=this._emptyDEMTexture=new l.Texture(i,_,c.RGBA,{premultiply:!1}),x}setupElevationDraw(i,c,p){const _=this.painter.context,x=_.gl,C=(A=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(A),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var A;C.u_dem_size=this.sourceCache.getSource().tileSize,C.u_exaggeration=this.exaggeration();let N=null,H=null,j=1;if(p&&p.morphing&&this._useVertexMorphing){const re=p.morphing.srcDemTile,fe=p.morphing.dstDemTile;j=p.morphing.phase,re&&fe&&(this._prepareDemTileUniforms(i,re,C,"_prev")&&(H=re),this._prepareDemTileUniforms(i,fe,C)&&(N=fe))}if(H&&N?(_.activeTexture.set(x.TEXTURE2),N.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),_.activeTexture.set(x.TEXTURE4),H.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),C.u_dem_lerp=j):(N=this.terrainTileForTile[i.tileID.key],_.activeTexture.set(x.TEXTURE2),(this._prepareDemTileUniforms(i,N,C)?N.demTexture:this.emptyDEMTexture).bind(x.NEAREST,x.CLAMP_TO_EDGE)),_.activeTexture.set(x.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),this._depthFBO&&(C.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),C.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&N){const re=(1<<N.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=re}if(p&&p.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(_,C),"globe"===this.painter.transform.projection.name){const re=this.globeUniformValues(this.painter.transform,i.tileID.canonical,p&&p.useDenormalizedUpVectorScale);c.setGlobeUniformValues(_,re)}}globeUniformValues(i,c,p){const _=i.projection;return{u_tile_tl_up:_.upVector(c,0,0),u_tile_tr_up:_.upVector(c,l.EXTENT,0),u_tile_br_up:_.upVector(c,l.EXTENT,l.EXTENT),u_tile_bl_up:_.upVector(c,0,l.EXTENT),u_tile_up_scale:p?l.globeMetersToEcef(1):_.upVectorScale(c,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const c=this.painter,p=this.painter.context;0!==i.length&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,x,C,A,N){if("globe"===_.transform.projection.name)!function(H,j,re,fe,ye){const Ie=H.context,Te=Ie.gl;let Re,ie;const ve=H.options.showTerrainWireframe?2:0,Ne=H.transform,$e=l.globeUseCustomAntiAliasing(H,Ie,Ne),pt=(Bn,Jt)=>{if(ie===Bn)return;const Cn=[Fs[Bn],"PROJECTION_GLOBE_VIEW"];$e&&Cn.push("CUSTOM_ANTIALIASING"),Jt&&Cn.push(Fs[ve]),Re=H.useProgram("globeRaster",null,Cn),ie=Bn},mt=H.colorModeForRenderPass(),gt=new l.DepthMode(Te.LEQUAL,l.DepthMode.ReadWrite,H.depthRangeFor3D);Ho.update(ye);const Bt=l.calculateGlobeMercatorMatrix(Ne),Ft=[l.mercatorXfromLng(Ne.center.lng),l.mercatorYfromLat(Ne.center.lat)],nn=ve?[!1,!0]:[!1],Un=H.globeSharedBuffers,Zt=[Ne.width*l.exported.devicePixelRatio,Ne.height*l.exported.devicePixelRatio],wn=Float32Array.from(Ne.globeMatrix),ln={useDenormalizedUpVectorScale:!0};if(nn.forEach(Bn=>{const Jt=H.transform,Cn=Eo(Jt.zoom)*j.exaggeration();ie=-1;const $n=Bn?Te.LINES:Te.TRIANGLES;for(const kn of fe){const Yn=re.getTile(kn),Or=l.StencilMode.disabled,di=j.prevTerrainTileForTile[kn.key],yr=j.terrainTileForTile[kn.key];na(di,yr)&&Ho.newMorphing(kn.key,di,yr,ye,250),Ie.activeTexture.set(Te.TEXTURE0),Yn.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE);const Vr=Ho.getMorphValuesForProxy(kn.key),ki=Vr?1:0;Vr&&l.extend$1(ln,{morphing:{srcDemTile:Vr.from,dstDemTile:Vr.to,phase:l.easeCubicInOut(Vr.phase)}});const Di=l.tileCornersToBounds(kn.canonical),wr=l.getLatitudinalLod(Di.getCenter().lat),fo=l.getGridMatrix(kn.canonical,Di,wr,Jt.worldSize/Jt._pixelsPerMercatorPixel),Do=l.globeNormalizeECEF(l.globeTileBounds(kn.canonical)),Co=os(Jt.projMatrix,wn,Bt,Do,l.globeToMercatorTransition(Jt.zoom),Ft,Jt.frustumCorners.TL,Jt.frustumCorners.TR,Jt.frustumCorners.BR,Jt.frustumCorners.BL,Jt.globeCenterInViewSpace,Jt.globeRadius,Zt,Cn,fo);if(pt(ki,Bn),j.setupElevationDraw(Yn,Re,ln),H.prepareDrawProgram(Ie,Re,kn.toUnwrapped()),Un){const[oo,ma,bo]=Bn?Un.getWirefameBuffers(H.context,wr):Un.getGridBuffers(wr,0!==Cn);Re.draw(Ie,$n,gt,Or,mt,l.CullFaceMode.backCCW,Co,"globe_raster",oo,ma,bo)}}}),Un){const Bn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];$e&&Bn.push("CUSTOM_ANTIALIASING"),Re=H.useProgram("globeRaster",null,Bn);for(const Jt of fe){const{x:Cn,y:$n,z:kn}=Jt.canonical,Yn=0===$n,Or=$n===(1<<kn)-1,[di,yr,Vr,ki]=Un.getPoleBuffers(kn);if(ki&&(Yn||Or)){const Di=re.getTile(Jt);Ie.activeTexture.set(Te.TEXTURE0),Di.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE);let wr=l.globePoleMatrixForTile(kn,Cn,Ne);const fo=l.globeNormalizeECEF(l.globeTileBounds(Jt.canonical)),Do=(Co,oo)=>Co.draw(Ie,Te.TRIANGLES,gt,l.StencilMode.disabled,mt,l.CullFaceMode.disabled,os(Ne.projMatrix,wr,wr,fo,0,Ft,Ne.frustumCorners.TL,Ne.frustumCorners.TR,Ne.frustumCorners.BR,Ne.frustumCorners.BL,Ne.globeCenterInViewSpace,Ne.globeRadius,Zt,0),"globe_pole_raster",oo,Vr,ki);j.setupElevationDraw(Di,Re,ln),H.prepareDrawProgram(Ie,Re,Jt.toUnwrapped()),Yn&&Do(Re,di),Or&&(wr=l.scale(l.create(),wr,[1,-1,1]),Do(Re,yr))}}}}(_,x,C,A,N);else{const H=_.context,j=H.gl;let re,fe;const ye=_.options.showTerrainWireframe?2:0,Ie=(Ne,$e)=>{if(fe===Ne)return;const pt=[Fs[Ne]];$e&&pt.push(Fs[ye]),re=_.useProgram("terrainRaster",null,pt),fe=Ne},Te=_.colorModeForRenderPass(),Re=new l.DepthMode(j.LEQUAL,l.DepthMode.ReadWrite,_.depthRangeFor3D);Ho.update(N);const ie=_.transform,ve=Eo(ie.zoom)*x.exaggeration();(ye?[!1,!0]:[!1]).forEach(Ne=>{fe=-1;const $e=Ne?j.LINES:j.TRIANGLES,[pt,mt]=Ne?x.getWirefameBuffer():[x.gridIndexBuffer,x.gridSegments];for(const gt of A){const Bt=C.getTile(gt),Ft=l.StencilMode.disabled,nn=x.prevTerrainTileForTile[gt.key],Un=x.terrainTileForTile[gt.key];na(nn,Un)&&Ho.newMorphing(gt.key,nn,Un,N,250),H.activeTexture.set(j.TEXTURE0),Bt.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const Zt=Ho.getMorphValuesForProxy(gt.key),wn=Zt?1:0;let ln;Zt&&(ln={morphing:{srcDemTile:Zt.from,dstDemTile:Zt.to,phase:l.easeCubicInOut(Zt.phase)}});const Bn=xs(gt.projMatrix,Hs(gt.canonical,ie.renderWorldCopies)?ve/10:ve);Ie(wn,Ne),x.setupElevationDraw(Bt,re,ln),_.prepareDrawProgram(H,re,gt.toUnwrapped()),re.draw(H,$e,Re,Ft,Te,l.CullFaceMode.backCCW,Bn,"terrain_raster",x.gridBuffer,pt,mt)}})}}(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,_=this.proxySourceCache,x=this.proxiedCoords[_.id],C=this._drapedRenderBatches.shift(),A=[],N=c.style.order;let H=0;for(const j of x){const re=_.getTileByID(j.proxyTileKey),fe=_.proxyCachedFBO[j.key]?_.proxyCachedFBO[j.key][i]:void 0,ye=void 0!==fe?_.renderCache[fe]:this.pool[H++],Ie=void 0!==fe;if(re.texture=ye.tex,Ie&&!ye.dirty){A.push(re.tileID);continue}let Te;p.bindFramebuffer.set(ye.fb.framebuffer),this.renderedToTile=!1,ye.dirty&&(p.clear({color:l.Color.transparent,stencil:0}),ye.dirty=!1);for(let Re=C.start;Re<=C.end;++Re){const ie=c.style._layers[N[Re]];if(ie.isHidden(c.transform.zoom))continue;const ve=c.style._getLayerSourceCache(ie),Ne=ve?this.proxyToSource[j.key][ve.id]:[j];if(!Ne)continue;const $e=Ne;p.viewport.set([0,0,ye.fb.width,ye.fb.height]),Te!==(ve?ve.id:null)&&(this._setupStencil(ye,Ne,ie,ve),Te=ve?ve.id:null),c.renderLayer(c,ve,ie,$e)}this.renderedToTile?(ye.dirty=!0,A.push(re.tileID)):Ie||--H,5===H&&(H=0,this.renderToBackBuffer(A))}return this.renderToBackBuffer(A),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),C.end+1}postRender(){}renderCacheEfficiency(i){const c=i.order.length;if(0===c)return{efficiency:100};let p,_=0,x=0,C=!1;for(let A=0;A<c;++A){const N=i._layers[i.order[A]];this._style.isLayerDraped(N)?(C&&++_,++x):C||(C=!0,p=N.id)}return 0===x?{efficiency:100}:{efficiency:100*(1-_/x),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{i=Math.min(i,c.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,c,p){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const C=x.tileID,A=1<<C.overscaledZ,{x:N,y:H}=C.canonical,j=N/A,re=(N+1)/A,fe=H/A,ye=(H+1)/A;return{minx:j,miny:fe,maxx:re,maxy:ye,t:x.dem.tree.raycastRoot(j,fe,re,ye,i,c,p),tile:x}});_.sort((x,C)=>(null!==x.t?x.t:Number.MAX_VALUE)-(null!==C.t?C.t:Number.MAX_VALUE));for(const x of _){if(null==x.t)return null;const C=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,i,c,p);if(null!=C)return C}return null}_createFBO(){const i=this.painter.context,c=i.gl,p=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const _=new l.Texture(i,{width:p[0],height:p[1],data:null},c.RGBA);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);const x=i.createFramebuffer(p[0],p[1],!1);return x.colorAttachment.set(_.texture),x.depthAttachment=new lt(i,x.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:x,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const c=this._style._layers[i],p=c.isHidden(this.painter.transform.zoom);return"custom"===c.type?!p&&c.shouldRedrape():!p&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let i=!1;for(const p of this._style._getSources())if(p instanceof Ln){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const _=this._style._layers[this._style.order[p]],x=this._style._getLayerSourceCache(_);if(x&&!c[x.id]&&!_.isHidden(this.painter.transform.zoom)&&"line"===_.type&&_.widthExpression()instanceof l.ZoomDependentExpression){c[x.id]=!0;for(const C of this.proxyCoords){const A=this.proxyToSource[C.key][x.id];if(A)for(const N of A)this._clearRenderCacheForTile(x.id,N)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const p in this._style._sourceCaches)if(this._style._sourceCaches[p]._source instanceof Je){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const _=this._style._layers[this._style.order[p]],x=this._style._getLayerSourceCache(_);if(!x||c[x.id]||_.isHidden(this.painter.transform.zoom)||"raster"!==_.type)continue;const C=_.paint.get("raster-fade-duration");for(const A of this.proxyCoords){const N=this.proxyToSource[A.key][x.id];if(N)for(const H of N){const j=us(x.getTile(H),x.findLoadedParent(H,0),x,this.painter.transform,C);(1!==j.opacity||0!==j.mix)&&this._clearRenderCacheForTile(x.id,H)}}}}_setupDrapedRenderBatches(){const i=this._style.order,c=i.length;if(0===c)return;const p=[];let _,x=0,C=this._style._layers[i[x]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++x<c;)C=this._style._layers[i[x]];for(;x<c;++x){const A=this._style._layers[i[x]];A.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(A)?void 0===_&&(_=x):void 0!==_&&(p.push({start:_,end:x-1}),_=void 0))}void 0!==_&&p.push({start:_,end:x-1}),this._drapedRenderBatches=p}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const C=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let A=0;A<C.length;++A){const N=Object.values(C[A]);c.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,_=this._tilesDirty;for(let C=p.length-1;C>=0;C--){const A=p[C];if(c.getTileByID(A.key),void 0!==c.proxyCachedFBO[A.key]){const N=i[A.key],H=this.proxyToSource[A.key];let j=0;for(const re in H){const fe=H[re],ye=N[re];if(!ye||ye.length!==fe.length||fe.some((Ie,Te)=>Ie!==ye[Te]||_[re]&&_[re].hasOwnProperty(Ie.key))){j=-1;break}++j}for(const re in c.proxyCachedFBO[A.key])c.renderCache[c.proxyCachedFBO[A.key][re]].dirty=j<0||j!==Object.values(N).length}}const x=[...this._drapedRenderBatches];x.sort((C,A)=>A.end-A.start-(C.end-C.start));for(const C of x)for(const A of p){if(c.proxyCachedFBO[A.key])continue;let N=c.renderCachePool.pop();void 0===N&&c.renderCache.length<50&&(N=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==N&&(c.proxyCachedFBO[A.key]={},c.proxyCachedFBO[A.key][C.start]=N,c.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,p,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,C=x.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let A;if(p.isTileClipped())A=c.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);A=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+A>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=A,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(i,c){const p=this.painter,_=this.painter.context,x=_.gl;p._tileClippingMaskIDs={},_.setColorMode(l.ColorMode.disabled),_.setDepthMode(l.DepthMode.disabled);const C=p.useProgram("clippingMask");for(const A of i){const N=p._tileClippingMaskIDs[A.key]=--c;C.draw(_,x.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:x.ALWAYS,mask:0},N,255,x.KEEP,x.KEEP,x.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,xo(A.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const p=[i.x,i.y,1,1];l.transformMat4$1(p,p,c.pixelMatrixInverse),l.scale$1(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const _=c._camera.position,x=l.mercatorZfromAltitude(1,c.center.lat),C=[_[0],_[1],_[2]/x,0],A=l.subtract([],p.slice(0,3),C);l.normalize(A,A);const N=this.raycast(C,A,this._exaggeration);return null!==N&&N?(l.scaleAndAdd(C,C,A,N),C[3]=C[2],C[2]*=x,C):null}drawDepth(){const i=this.painter,c=i.context,p=this.proxySourceCache,_=Math.ceil(i.width),x=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===x||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const C=c.gl,A=c.createFramebuffer(_,x,!0);c.activeTexture.set(C.TEXTURE0);const N=new l.Texture(c,{width:_,height:x,data:null},C.RGBA);N.bind(C.NEAREST,C.CLAMP_TO_EDGE),A.colorAttachment.set(N.texture);const H=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,_,x);A.depthAttachment.set(H),this._depthFBO=A,this._depthTexture=N}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,_,x]),function(C,A,N,H){if("globe"===C.transform.projection.name)return;const j=C.context,re=j.gl;j.clear({depth:1});const fe=C.useProgram("terrainDepth"),ye=new l.DepthMode(re.LESS,l.DepthMode.ReadWrite,C.depthRangeFor3D);for(const Ie of H){const Te=N.getTile(Ie),Re=xs(Ie.projMatrix,0);A.setupElevationDraw(Te,fe),fe.draw(j,re.TRIANGLES,ye,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,Re,"terrain_depth",A.gridBuffer,A.gridIndexBuffer,A.gridNoSkirtSegments)}}(i,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,c,p){if(i.getSource()instanceof Dt)return this._setupProxiedCoordsForImageSource(i,c,p);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const _=this.proxiedCoords[i.id]=[],x=this.proxyCoords;for(let A=0;A<x.length;A++){const N=x[A],H=this._findTileCoveringTileID(N,i);if(H){const j=this._createProxiedId(N,H,p[N.key]&&p[N.key][i.id]);_.push(j),this.proxyToSource[N.key][i.id]=[j]}}let C=!1;for(let A=0;A<c.length;A++){const N=i.getTile(c[A]);if(!N||!N.hasData())continue;const H=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==N.tileID.canonical.z){const j=this.proxyToSource[H.tileID.key][i.id],re=this._createProxiedId(H.tileID,N,p[H.tileID.key]&&p[H.tileID.key][i.id]);j?j.splice(j.length-1,0,re):this.proxyToSource[H.tileID.key][i.id]=[re],_.push(re),C=!0}}this._sourceTilesOverlap[i.id]=C}_setupProxiedCoordsForImageSource(i,c,p){if(!i.getSource().loaded())return;const _=this.proxiedCoords[i.id]=[],x=this.proxyCoords,C=i.getSource(),A=new l.Point(C.tileID.x,C.tileID.y)._div(1<<C.tileID.z),N=C.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((j,re)=>(j.min.x=Math.min(j.min.x,re.x-A.x),j.min.y=Math.min(j.min.y,re.y-A.y),j.max.x=Math.max(j.max.x,re.x-A.x),j.max.y=Math.max(j.max.y,re.y-A.y),j),{min:new l.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(j,re)=>{const fe=j.wrap+j.canonical.x/(1<<j.canonical.z),ye=j.canonical.y/(1<<j.canonical.z),Ie=l.EXTENT/(1<<j.canonical.z),Te=re.wrap+re.canonical.x/(1<<re.canonical.z),Re=re.canonical.y/(1<<re.canonical.z);return fe+Ie<Te+N.min.x||fe>Te+N.max.x||ye+Ie<Re+N.min.y||ye>Re+N.max.y};for(let j=0;j<x.length;j++){const re=x[j];for(let fe=0;fe<c.length;fe++){const ye=i.getTile(c[fe]);if(!ye||!ye.hasData()||H(re,ye.tileID))continue;const Ie=this._createProxiedId(re,ye,p[re.key]&&p[re.key][i.id]),Te=this.proxyToSource[re.key][i.id];Te?Te.push(Ie):this.proxyToSource[re.key][i.id]=[Ie],_.push(Ie)}}}_createProxiedId(i,c,p){let _=this.orthoMatrix;if(p){const x=p.find(C=>C.key===c.tileID.key);if(x)return x}if(c.tileID.key!==i.key){const x=i.canonical.z-c.tileID.canonical.z;let C,A,N;_=l.create();const H=c.tileID.wrap-i.wrap<<i.overscaledZ;x>0?(C=l.EXTENT>>x,A=C*((c.tileID.canonical.x<<x)-i.canonical.x+H),N=C*((c.tileID.canonical.y<<x)-i.canonical.y)):(C=l.EXTENT<<-x,A=l.EXTENT*(c.tileID.canonical.x-(i.canonical.x+H<<-x)),N=l.EXTENT*(c.tileID.canonical.y-(i.canonical.y<<-x))),l.ortho(_,0,C,0,C,0,1),l.translate(_,_,[A,N,0])}return new bs(c.tileID,i.key,_)}_findTileCoveringTileID(i,c){let p=c.getTile(i);if(p&&p.hasData())return p;const _=this._findCoveringTileCache[c.id],x=_[i.key];if(p=x?c.getTileByID(x):null,p&&p.hasData()||null===x)return p;let C=p?p.tileID:i,A=C.overscaledZ;const N=c.getSource().minzoom,H=[];if(!x){const re=c.getSource().maxzoom;if(i.canonical.z>=re){const fe=i.canonical.z-re;c.getSource().reparseOverscaled?(A=Math.max(i.canonical.z+2,c.transform.tileZoom),C=new l.OverscaledTileID(A,i.wrap,re,i.canonical.x>>fe,i.canonical.y>>fe)):0!==fe&&(A=re,C=new l.OverscaledTileID(A,i.wrap,re,i.canonical.x>>fe,i.canonical.y>>fe))}C.key!==i.key&&(H.push(C.key),p=c.getTile(C))}const j=re=>{H.forEach(fe=>{_[fe]=re}),H.length=0};for(A-=1;A>=N&&(!p||!p.hasData());A--){p&&j(p.tileID.key);const re=C.calculateScaledKey(A);if(p=c.getTileByID(re),p&&p.hasData())break;const fe=_[re];if(null===fe)break;void 0===fe?H.push(re):p=c.getTileByID(fe)}return j(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let p=this._tilesDirty[i];p||(p=this._tilesDirty[i]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(c){let p=0;const _=new l.StructArrayLayout2ui4,x=131;for(let C=1;C<129;C++){for(let A=1;A<129;A++)p=C*x+A,_.emplaceBack(p,p+1),_.emplaceBack(p,p+x),_.emplaceBack(p+1,p+x),128===C&&_.emplaceBack(p+x,p+x+1);_.emplaceBack(p+1,p+1+x)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class K{static cacheKey(i,c,p,_){let x=`${c}${_?_.cacheKey:""}`;for(const C of p)i.usedDefines.includes(C)&&(x+=`/${C}`);return x}constructor(i,c,p,_,x,C){const A=i.gl;this.program=A.createProgram();const N=function(ie){const ve=[];for(let Ne=0;Ne<ie.length;Ne++){if(null===ie[Ne])continue;const $e=ie[Ne].split(" ");ve.push($e.pop())}return ve}(p.staticAttributes),H=_?_.getBinderAttributes():[],j=N.concat(H);let re=_?_.defines():[];re=re.concat(C.map(ie=>`#define ${ie}`));const fe=i.isWebGL2?"#version 300 es\n":"",ye=fe+re.concat(i.extStandardDerivatives&&0===fe.length?"#extension GL_OES_standard_derivatives : enable\n".concat(vs):vs,vs,js,aa.fragmentSource,ys.fragmentSource,p.fragmentSource).join("\n"),Ie=fe+re.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",js,aa.vertexSource,ys.vertexSource,Ko.vertexSource,p.vertexSource).join("\n"),Te=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(Te,ye),A.compileShader(Te),A.attachShader(this.program,Te);const Re=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(Re,Ie),A.compileShader(Re),A.attachShader(this.program,Re),this.attributes={},this.numAttributes=j.length;for(let ie=0;ie<this.numAttributes;ie++)j[ie]&&(A.bindAttribLocation(this.program,ie,j[ie]),this.attributes[j[ie]]=ie);A.linkProgram(this.program),A.deleteShader(Re),A.deleteShader(Te),this.fixedUniforms=x(i),this.binderUniforms=_?_.getUniforms(i):[],C.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new l.Uniform1i(ie=i),u_dem_prev:new l.Uniform1i(ie),u_dem_unpack:new l.Uniform4f(ie),u_dem_tl:new l.Uniform2f(ie),u_dem_scale:new l.Uniform1f(ie),u_dem_tl_prev:new l.Uniform2f(ie),u_dem_scale_prev:new l.Uniform1f(ie),u_dem_size:new l.Uniform1f(ie),u_dem_lerp:new l.Uniform1f(ie),u_exaggeration:new l.Uniform1f(ie),u_depth:new l.Uniform1i(ie),u_depth_size_inv:new l.Uniform2f(ie),u_meter_to_dem:new l.Uniform1f(ie),u_label_plane_matrix_inv:new l.UniformMatrix4f(ie)}),C.includes("GLOBE")&&(this.globeUniforms=(ie=>({u_tile_tl_up:new l.Uniform3f(ie),u_tile_tr_up:new l.Uniform3f(ie),u_tile_br_up:new l.Uniform3f(ie),u_tile_bl_up:new l.Uniform3f(ie),u_tile_up_scale:new l.Uniform1f(ie)}))(i)),C.includes("FOG")&&(this.fogUniforms=(ie=>({u_fog_matrix:new l.UniformMatrix4f(ie),u_fog_range:new l.Uniform2f(ie),u_fog_color:new l.Uniform4f(ie),u_fog_horizon_blend:new l.Uniform1f(ie),u_fog_temporal_offset:new l.Uniform1f(ie),u_frustum_tl:new l.Uniform3f(ie),u_frustum_tr:new l.Uniform3f(ie),u_frustum_br:new l.Uniform3f(ie),u_frustum_bl:new l.Uniform3f(ie),u_globe_pos:new l.Uniform3f(ie),u_globe_radius:new l.Uniform1f(ie),u_globe_transition:new l.Uniform1f(ie),u_is_globe:new l.Uniform1i(ie),u_viewport:new l.Uniform2f(ie)}))(i))}var ie}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const _ in c)p[_]&&p[_].set(this.program,_,c[_])}}setGlobeUniformValues(i,c){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const _ in c)p[_]&&p[_].set(this.program,_,c[_])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const _ in c)p[_].set(this.program,_,c[_])}}draw(i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te){const Re=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(p),i.setStencilMode(_),i.setColorMode(x),i.setCullFace(C);for(const ve of Object.keys(this.fixedUniforms))this.fixedUniforms[ve].set(this.program,ve,A[ve]);Ie&&Ie.setUniforms(this.program,i,this.binderUniforms,fe,{zoom:ye});const ie={[Re.LINES]:2,[Re.TRIANGLES]:3,[Re.LINE_STRIP]:1}[c];for(const ve of re.get()){const Ne=ve.vaos||(ve.vaos={});(Ne[N]||(Ne[N]=new Ms)).bind(i,this,H,Ie?Ie.getPaintVertexBuffers():[],j,ve.vertexOffset,Te||[]),Re.drawElements(c,ve.primitiveLength*ie,Re.UNSIGNED_SHORT,ve.primitiveOffset*ie*2)}}}function I(h,i){const c=Math.pow(2,i.tileID.overscaledZ),p=i.tileSize*Math.pow(2,h.transform.tileZoom)/c,_=p*(i.tileID.canonical.x+i.tileID.wrap*c),x=p*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_tile_units_to_pixels:1/pr(i,1,h.transform.tileZoom),u_pixel_coord_upper:[_>>16,x>>16],u_pixel_coord_lower:[65535&_,65535&x]}}const ee=l.create(),xe=(h,i,c,p,_,x,C,A,N,H,j)=>{const re=i.style.light,fe=re.properties.get("position"),ye=[fe.x,fe.y,fe.z],Ie=l.create$1();"viewport"===re.properties.get("anchor")&&(l.fromRotation(Ie,-i.transform.angle),l.transformMat3(ye,ye,Ie));const Te=re.properties.get("color"),Re=i.transform,ie={u_matrix:h,u_lightpos:ye,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ee,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:x};return"globe"===Re.projection.name&&(ie.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],ie.u_zoom_transition=N,ie.u_inv_rot_matrix=j,ie.u_merc_center=H,ie.u_up_dir=Re.projection.upVector(new l.CanonicalTileID(0,0,0),H[0]*l.EXTENT,H[1]*l.EXTENT),ie.u_height_lift=A),ie},Tn=(h,i,c,p,_,x,C,A,N,H,j,re)=>{const fe=xe(h,i,c,p,_,x,C,N,H,j,re),ye={u_height_factor:-Math.pow(2,C.overscaledZ)/A.tileSize/8};return l.extend(fe,I(i,A),ye)},hr=h=>({u_matrix:h}),dr=(h,i,c)=>l.extend(hr(h),I(i,c)),Hi=(h,i)=>({u_matrix:h,u_world:i}),lo=(h,i,c,p)=>l.extend(dr(h,i,c),{u_world:p}),Q=l.create(),Z=(h,i,c,p,_,x)=>{const C=h.transform,A="globe"===C.projection.name;let N;if("map"===x.paint.get("circle-pitch-alignment"))if(A){const j=l.globePixelsToTileUnits(C.zoom,i.canonical)*C._pixelsPerMercatorPixel;N=Float32Array.from([j,0,0,j])}else N=C.calculatePixelsToTileUnitsMatrix(c);else N=new Float32Array([C.pixelsToGLUnits[0],0,0,C.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:C.cameraToCenterDistance,u_matrix:h.translatePosMatrix(i.projMatrix,c,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:Q,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(A){H.u_inv_rot_matrix=p,H.u_merc_center=_,H.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],H.u_zoom_transition=l.globeToMercatorTransition(C.zoom);const j=_[0]*l.EXTENT,re=_[1]*l.EXTENT;H.u_up_dir=C.projection.upVector(new l.CanonicalTileID(0,0,0),j,re)}return H},ge=h=>{const i=[];return"map"===h.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===h.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},te=(h,i,c,p)=>{const _=l.EXTENT/c.tileSize;return{u_matrix:h,u_camera_to_center_distance:i.getCameraToCenterDistance(p),u_extrude_scale:[i.pixelsToGLUnits[0]/_,i.pixelsToGLUnits[1]/_]}},Fe=(h,i,c=1)=>({u_matrix:h,u_color:i,u_overlay:0,u_overlay_scale:c}),Zn=l.create(),Xr=(h,i,c,p,_,x,C)=>{const A=h.transform,N="globe"===A.projection.name,H=N?l.globePixelsToTileUnits(A.zoom,i.canonical)*A._pixelsPerMercatorPixel:pr(c,1,x),j={u_matrix:i.projMatrix,u_extrude_scale:H,u_intensity:C,u_inv_rot_matrix:Zn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){j.u_inv_rot_matrix=p,j.u_merc_center=_,j.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],j.u_zoom_transition=l.globeToMercatorTransition(A.zoom);const re=_[0]*l.EXTENT,fe=_[1]*l.EXTENT;j.u_up_dir=A.projection.upVector(new l.CanonicalTileID(0,0,0),re,fe)}return j},qo=(h,i,c,p,_,x,C)=>{const A=h.transform,N=A.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:Gs(h,i,c,p),u_pixels_to_tile_units:N,u_device_pixel_ratio:x,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:Aa(c)?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ws(i,h.transform),u_alpha_discard_threshold:0,u_trim_offset:C}},hs=(h,i,c,p,_)=>{const x=h.transform;return{u_matrix:Gs(h,i,c,p),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:ws(i,x),u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ws(h,i){return 1/pr(h,1,i.tileZoom)}function Gs(h,i,c,p){return h.translatePosMatrix(p||i.tileID.projMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Aa(h){const i=h.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const Ea=(h,i,c,p,_,x)=>{return{u_matrix:h,u_tl_parent:i,u_scale_parent:c,u_fade_t:p.mix,u_opacity:p.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(A=_.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(C=_.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:Bs(_.paint.get("raster-hue-rotate")),u_perspective_transform:x};var C,A};function Bs(h){h*=Math.PI/180;const i=Math.sin(h),c=Math.cos(h);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const Ns=l.create(),al=(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te)=>{const Re=_.transform,ie={u_is_size_zoom_constant:+("constant"===h||"source"===h),u_is_size_feature_constant:+("constant"===h||"camera"===h),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:Re.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:Re.width/Re.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:C,u_coord_matrix:A,u_is_text:+N,u_pitch_with_map:+p,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ns,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ns,u_up_vector:[0,-1,0]};return"globe"===Te.name&&(ie.u_tile_id=[j.canonical.x,j.canonical.y,1<<j.canonical.z],ie.u_zoom_transition=re,ie.u_inv_rot_matrix=ye,ie.u_merc_center=fe,ie.u_camera_forward=Re._camera.forward(),ie.u_ecef_origin=l.globeECEFOrigin(Re.globeMatrix,j.toUnwrapped()),ie.u_tile_matrix=Float32Array.from(Re.globeMatrix),ie.u_up_vector=Ie),ie},ll=(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te,Re)=>l.extend(al(h,i,c,p,_,x,C,A,N,H,re,fe,ye,Ie,Te,Re),{u_gamma_scale:p?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+j}),Ya=(h,i,c,p,_,x,C,A,N,H,j,re,fe,ye,Ie,Te)=>l.extend(ll(h,i,c,p,_,x,C,A,!0,N,!0,j,re,fe,ye,Ie,Te),{u_texsize_icon:H,u_texture_icon:1}),xl=(h,i,c)=>({u_matrix:h,u_opacity:i,u_color:c}),ce=(h,i,c,p,_)=>l.extend(function(x,C,A){const N=C.imageManager.getPattern(x.toString()),{width:H,height:j}=C.imageManager.getPixelSize(),re=Math.pow(2,A.tileID.overscaledZ),fe=A.tileSize*Math.pow(2,C.transform.tileZoom)/re,ye=fe*(A.tileID.canonical.x+A.tileID.wrap*re),Ie=fe*A.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[H,j],u_pattern_size:N.displaySize,u_tile_units_to_pixels:1/pr(A,1,C.transform.tileZoom),u_pixel_coord_upper:[ye>>16,Ie>>16],u_pixel_coord_lower:[65535&ye,65535&Ie]}}(p,c,_),{u_matrix:h,u_opacity:i}),M={fillExtrusion:h=>({u_matrix:new l.UniformMatrix4f(h),u_lightpos:new l.Uniform3f(h),u_lightintensity:new l.Uniform1f(h),u_lightcolor:new l.Uniform3f(h),u_vertical_gradient:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_edge_radius:new l.Uniform1f(h),u_ao:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_up_dir:new l.Uniform3f(h),u_height_lift:new l.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_lightpos:new l.Uniform3f(h),u_lightintensity:new l.Uniform1f(h),u_lightcolor:new l.Uniform3f(h),u_vertical_gradient:new l.Uniform1f(h),u_height_factor:new l.Uniform1f(h),u_edge_radius:new l.Uniform1f(h),u_ao:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_up_dir:new l.Uniform3f(h),u_height_lift:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h)}),fill:h=>({u_matrix:new l.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),fillOutline:h=>({u_matrix:new l.UniformMatrix4f(h),u_world:new l.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_world:new l.Uniform2f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new l.Uniform1f(h),u_extrude_scale:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_up_dir:new l.Uniform3f(h)}),collisionBox:h=>({u_matrix:new l.UniformMatrix4f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_extrude_scale:new l.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new l.UniformMatrix4f(h),u_inv_matrix:new l.UniformMatrix4f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_viewport_size:new l.Uniform2f(h)}),debug:h=>({u_color:new l.UniformColor(h),u_matrix:new l.UniformMatrix4f(h),u_overlay:new l.Uniform1i(h),u_overlay_scale:new l.Uniform1f(h)}),clippingMask:h=>({u_matrix:new l.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new l.Uniform1f(h),u_intensity:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_up_dir:new l.Uniform3f(h)}),heatmapTexture:h=>({u_image:new l.Uniform1i(h),u_color_ramp:new l.Uniform1i(h),u_opacity:new l.Uniform1f(h)}),hillshade:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_latrange:new l.Uniform2f(h),u_light:new l.Uniform2f(h),u_shadow:new l.UniformColor(h),u_highlight:new l.UniformColor(h),u_accent:new l.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_dimension:new l.Uniform2f(h),u_zoom:new l.Uniform1f(h),u_unpack:new l.Uniform4f(h)}),line:h=>({u_matrix:new l.UniformMatrix4f(h),u_pixels_to_tile_units:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_units_to_pixels:new l.Uniform2f(h),u_dash_image:new l.Uniform1i(h),u_gradient_image:new l.Uniform1i(h),u_image_height:new l.Uniform1f(h),u_texsize:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_alpha_discard_threshold:new l.Uniform1f(h),u_trim_offset:new l.Uniform2f(h)}),linePattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_texsize:new l.Uniform2f(h),u_pixels_to_tile_units:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_units_to_pixels:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_alpha_discard_threshold:new l.Uniform1f(h)}),raster:h=>({u_matrix:new l.UniformMatrix4f(h),u_tl_parent:new l.Uniform2f(h),u_scale_parent:new l.Uniform1f(h),u_fade_t:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_image0:new l.Uniform1i(h),u_image1:new l.Uniform1i(h),u_brightness_low:new l.Uniform1f(h),u_brightness_high:new l.Uniform1f(h),u_saturation_factor:new l.Uniform1f(h),u_contrast_factor:new l.Uniform1f(h),u_spin_weights:new l.Uniform3f(h),u_perspective_transform:new l.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_camera_forward:new l.Uniform3f(h),u_tile_matrix:new l.UniformMatrix4f(h),u_up_vector:new l.Uniform3f(h),u_ecef_origin:new l.Uniform3f(h),u_texture:new l.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_texture:new l.Uniform1i(h),u_gamma_scale:new l.Uniform1f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_camera_forward:new l.Uniform3f(h),u_tile_matrix:new l.UniformMatrix4f(h),u_up_vector:new l.Uniform3f(h),u_ecef_origin:new l.Uniform3f(h),u_is_halo:new l.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_texsize_icon:new l.Uniform2f(h),u_texture:new l.Uniform1i(h),u_texture_icon:new l.Uniform1i(h),u_gamma_scale:new l.Uniform1f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_is_halo:new l.Uniform1i(h)}),background:h=>({u_matrix:new l.UniformMatrix4f(h),u_opacity:new l.Uniform1f(h),u_color:new l.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_opacity:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_pattern_tl:new l.Uniform2f(h),u_pattern_br:new l.Uniform2f(h),u_texsize:new l.Uniform2f(h),u_pattern_size:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),terrainRaster:Qo,terrainDepth:Qo,skybox:h=>({u_matrix:new l.UniformMatrix4f(h),u_sun_direction:new l.Uniform3f(h),u_cubemap:new l.Uniform1i(h),u_opacity:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new l.UniformMatrix4f(h),u_color_ramp:new l.Uniform1i(h),u_center_direction:new l.Uniform3f(h),u_radius:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new l.UniformMatrix3f(h),u_sun_direction:new l.Uniform3f(h),u_sun_intensity:new l.Uniform1f(h),u_color_tint_r:new l.Uniform4f(h),u_color_tint_m:new l.Uniform4f(h),u_luminance:new l.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new l.UniformMatrix4f(h),u_globe_matrix:new l.UniformMatrix4f(h),u_normalize_matrix:new l.UniformMatrix4f(h),u_merc_matrix:new l.UniformMatrix4f(h),u_zoom_transition:new l.Uniform1f(h),u_merc_center:new l.Uniform2f(h),u_image0:new l.Uniform1i(h),u_grid_matrix:new l.UniformMatrix3f(h),u_skirt_height:new l.Uniform1f(h),u_frustum_tl:new l.Uniform3f(h),u_frustum_tr:new l.Uniform3f(h),u_frustum_br:new l.Uniform3f(h),u_frustum_bl:new l.Uniform3f(h),u_globe_pos:new l.Uniform3f(h),u_globe_radius:new l.Uniform1f(h),u_viewport:new l.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new l.Uniform3f(h),u_frustum_tr:new l.Uniform3f(h),u_frustum_br:new l.Uniform3f(h),u_frustum_bl:new l.Uniform3f(h),u_horizon:new l.Uniform1f(h),u_transition:new l.Uniform1f(h),u_fadeout_range:new l.Uniform1f(h),u_color:new l.Uniform4f(h),u_high_color:new l.Uniform4f(h),u_space_color:new l.Uniform4f(h),u_star_intensity:new l.Uniform1f(h),u_star_density:new l.Uniform1f(h),u_star_size:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h),u_horizon_angle:new l.Uniform1f(h),u_rotation_matrix:new l.UniformMatrix4f(h)})};let F;function G(h,i,c,p,_,x,C){const A=h.context,N=A.gl,H=h.transform,j=h.useProgram("collisionBox"),re=[];let fe=0,ye=0;for(let $e=0;$e<p.length;$e++){const pt=p[$e],mt=i.getTile(pt),gt=mt.getBucket(c);if(!gt)continue;const Bt=bn(pt,gt,H);let Ft=Bt;0===_[0]&&0===_[1]||(Ft=h.translatePosMatrix(Bt,mt,_,x));const nn=C?gt.textCollisionBox:gt.iconCollisionBox,Un=gt.collisionCircleArray;if(Un.length>0){const Zt=l.create(),wn=Ft;l.mul(Zt,gt.placementInvProjMatrix,H.glCoordMatrix),l.mul(Zt,Zt,gt.placementViewportMatrix),re.push({circleArray:Un,circleOffset:ye,transform:wn,invTransform:Zt,projection:gt.getProjection()}),fe+=Un.length/4,ye=fe}nn&&(h.terrain&&h.terrain.setupElevationDraw(mt,j),j.draw(A,N.LINES,l.DepthMode.disabled,l.StencilMode.disabled,h.colorModeForRenderPass(),l.CullFaceMode.disabled,te(Ft,H,mt,gt.getProjection()),c.id,nn.layoutVertexBuffer,nn.indexBuffer,nn.segments,null,H.zoom,null,[nn.collisionVertexBuffer,nn.collisionVertexBufferExt]))}if(!C||!re.length)return;const Ie=h.useProgram("collisionCircle"),Te=new l.StructArrayLayout2f1f2i16;Te.resize(4*fe),Te._trim();let Re=0;for(const $e of re)for(let pt=0;pt<$e.circleArray.length/4;pt++){const mt=4*pt,gt=$e.circleArray[mt+0],Bt=$e.circleArray[mt+1],Ft=$e.circleArray[mt+2],nn=$e.circleArray[mt+3];Te.emplace(Re++,gt,Bt,Ft,nn,0),Te.emplace(Re++,gt,Bt,Ft,nn,1),Te.emplace(Re++,gt,Bt,Ft,nn,2),Te.emplace(Re++,gt,Bt,Ft,nn,3)}(!F||F.length<2*fe)&&(F=function($e){const pt=2*$e,mt=new l.StructArrayLayout3ui6;mt.resize(pt),mt._trim();for(let gt=0;gt<pt;gt++){const Bt=6*gt;mt.uint16[Bt+0]=4*gt+0,mt.uint16[Bt+1]=4*gt+1,mt.uint16[Bt+2]=4*gt+2,mt.uint16[Bt+3]=4*gt+2,mt.uint16[Bt+4]=4*gt+3,mt.uint16[Bt+5]=4*gt+0}return mt}(fe));const ie=A.createIndexBuffer(F,!0),ve=A.createVertexBuffer(Te,l.collisionCircleLayout.members,!0);for(const $e of re){const pt={u_matrix:$e.transform,u_inv_matrix:$e.invTransform,u_camera_to_center_distance:(Ne=H).getCameraToCenterDistance($e.projection),u_viewport_size:[Ne.width,Ne.height]};Ie.draw(A,N.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,h.colorModeForRenderPass(),l.CullFaceMode.disabled,pt,c.id,ve,ie,l.SegmentVector.simpleSegment(0,2*$e.circleOffset,$e.circleArray.length,$e.circleArray.length/2),null,H.zoom)}var Ne;ve.destroy(),ie.destroy()}const ue=l.create();function Ce({width:h,height:i,anchor:c,textOffset:p,textScale:_},x){const{horizontalAlign:C,verticalAlign:A}=l.getAnchorAlignment(c),N=-(C-.5)*h,H=-(A-.5)*i,j=l.evaluateVariableOffset(c,p);return new l.Point((N/_+j[0])*x,(H/_+j[1])*x)}function ct(h,i,c,p,_,x,C,A,N,H,j){const re=h.text.placedSymbolArray,fe=h.text.dynamicLayoutVertexArray,ye=h.icon.dynamicLayoutVertexArray,Ie={},Te=h.getProjection(),Re=pn(A,Te,x),ie=x.elevation,ve=Te.upVectorScale(A.canonical,x.center.lat,x.worldSize).metersToTile;fe.clear();for(let Ne=0;Ne<re.length;Ne++){const $e=re.get(Ne),{tileAnchorX:pt,tileAnchorY:mt,numGlyphs:gt}=$e,Bt=$e.hidden||!$e.crossTileID||h.allowVerticalPlacement&&!$e.placedOrientation?null:p[$e.crossTileID];if(Bt){let Ft=0,nn=0,Un=0;if(ie){const Yn=ie?ie.getAtTileOffset(A,pt,mt):0,[Or,di,yr]=Te.upVector(A.canonical,pt,mt);Ft=Yn*Or*ve,nn=Yn*di*ve,Un=Yn*yr*ve}let[Zt,wn,ln,Bn]=Fi($e.projectedAnchorX+Ft,$e.projectedAnchorY+nn,$e.projectedAnchorZ+Un,c?Re:C);const Jt=Vi(x.getCameraToCenterDistance(Te),Bn);let Cn=_.evaluateSizeForFeature(h.textSizeData,H,$e)*Jt/l.ONE_EM;c&&(Cn*=h.tilePixelRatio/N);const $n=Ce(Bt,Cn);c?(({x:Zt,y:wn,z:ln}=Te.projectTilePoint(pt+$n.x,mt+$n.y,A.canonical)),[Zt,wn,ln]=Fi(Zt+Ft,wn+nn,ln+Un,C)):(i&&$n._rotate(-x.angle),Zt+=$n.x,wn+=$n.y,ln=0);const kn=h.allowVerticalPlacement&&$e.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let Yn=0;Yn<gt;Yn++)l.addDynamicAttributes(fe,Zt,wn,ln,kn);j&&$e.associatedIconIndex>=0&&(Ie[$e.associatedIconIndex]={x:Zt,y:wn,z:ln,angle:kn})}else pe(gt,fe)}if(j){ye.clear();const Ne=h.icon.placedSymbolArray;for(let $e=0;$e<Ne.length;$e++){const pt=Ne.get($e),{numGlyphs:mt}=pt,gt=Ie[$e];if(pt.hidden||!gt)pe(mt,ye);else{const{x:Bt,y:Ft,z:nn,angle:Un}=gt;for(let Zt=0;Zt<mt;Zt++)l.addDynamicAttributes(ye,Bt,Ft,nn,Un)}}h.icon.dynamicLayoutVertexBuffer.updateData(ye)}h.text.dynamicLayoutVertexBuffer.updateData(fe)}function ut(h,i,c){return c.iconsInText&&i?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Qt(h,i,c,p,_,x,C,A,N,H,j,re){const fe=h.context,ye=fe.gl,Ie=h.transform,Te="map"===A,Re="map"===N,ie=Te&&"point"!==c.layout.get("symbol-placement"),ve=Te&&!Re&&!ie,Ne=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let $e=!1;const pt=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),mt=[l.mercatorXfromLng(Ie.center.lng),l.mercatorYfromLat(Ie.center.lat)],gt=c.layout.get("text-variable-anchor"),Bt="globe"===Ie.projection.name,Ft=[],nn=[0,-1,0];let Un=nn;!Bt&&!Ie.mercatorFromTransition||Te||(Un=function(Zt){const wn=Zt._camera.getWorldToCamera(Zt.worldSize,1),ln=l.multiply([],wn,Zt.globeMatrix);l.invert(ln,ln);const Bn=[0,0,0],Jt=[0,1,0,0];return l.transformMat4$1(Jt,Jt,ln),Bn[0]=Jt[0],Bn[1]=Jt[1],Bn[2]=Jt[2],l.normalize(Bn,Bn),Bn}(Ie));for(const Zt of p){const wn=i.getTile(Zt),ln=wn.getBucket(c);if(!ln||"mercator"===ln.projection.name&&Bt)continue;const Bn=_?ln.text:ln.icon;if(!Bn||ln.fullyClipped||!Bn.segments.get().length)continue;const Jt=Bn.programConfigurations.get(c.id),Cn=_||ln.sdfIcons,$n=_?ln.textSizeData:ln.iconSizeData,kn=Re||0!==Ie.pitch,Yn=l.evaluateSizeForZoom($n,Ie.zoom);let Or,di,yr,Vr,ki=[0,0],Di=null;if(_)di=wn.glyphAtlasTexture,yr=ye.LINEAR,Or=wn.glyphAtlasTexture.size,ln.iconsInText&&(ki=wn.imageAtlasTexture.size,Di=wn.imageAtlasTexture,Vr=kn||h.options.rotating||h.options.zooming||"composite"===$n.kind||"camera"===$n.kind?ye.LINEAR:ye.NEAREST);else{const Nl=1!==c.layout.get("icon-size").constantOr(0)||ln.iconsNeedLinear;di=wn.imageAtlasTexture,yr=Cn||h.options.rotating||h.options.zooming||Nl||kn?ye.LINEAR:ye.NEAREST,Or=wn.imageAtlasTexture.size}const wr="globe"===ln.projection.name,fo=wr?Un:nn,Do=wr?l.globeToMercatorTransition(Ie.zoom):0,Co=pn(Zt,ln.getProjection(),Ie),oo=Ie.calculatePixelsToTileUnitsMatrix(wn),ma=zt(Co,wn.tileID.canonical,Re,Te,Ie,ln.getProjection(),oo),bo=h.terrain&&Re&&ie?l.invert(l.create(),ma):ue,Ua=Ri(Co,wn.tileID.canonical,Re,Te,Ie,ln.getProjection(),oo),Ja=gt&&ln.hasTextData(),Vo="none"!==c.layout.get("icon-text-fit")&&Ja&&ln.hasIconData();if(ie){const Nl=Ie.elevation,zl=Nl?Nl.getAtTileOffsetFunc(Zt,Ie.center.lat,Ie.worldSize,ln.getProjection()):null,Cc=ei(Co,wn.tileID.canonical,Re,Te,Ie,ln.getProjection(),oo);_o(ln,Co,h,_,Cc,Ua,Re,H,zl,Zt)}const Po=ie||_&&gt||Vo,Qi=h.translatePosMatrix(Co,wn,x,C),ps=Po?ue:ma,Us=h.translatePosMatrix(Ua,wn,x,C,!0),wo=ln.getProjection().createInversionMatrix(Ie,Zt.canonical),Ys=[];h.terrainRenderModeElevated()&&Re&&Ys.push("PITCH_WITH_MAP_TERRAIN"),wr&&Ys.push("PROJECTION_GLOBE_VIEW"),Po&&Ys.push("PROJECTED_POS_ON_VIEWPORT");const cu=Cn&&0!==c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1);let Cl;Cl=Cn?ln.iconsInText?Ya($n.kind,Yn,ve,Re,h,Qi,ps,Us,Or,ki,Zt,Do,mt,wo,fo,ln.getProjection()):ll($n.kind,Yn,ve,Re,h,Qi,ps,Us,_,Or,!0,Zt,Do,mt,wo,fo,ln.getProjection()):al($n.kind,Yn,ve,Re,h,Qi,ps,Us,_,Or,Zt,Do,mt,wo,fo,ln.getProjection());const cl={program:h.useProgram(ut(Cn,_,ln),Jt,Ys),buffers:Bn,uniformValues:Cl,atlasTexture:di,atlasTextureIcon:Di,atlasInterpolation:yr,atlasInterpolationIcon:Vr,isSDF:Cn,hasHalo:cu,tile:wn,labelPlaneMatrixInv:bo};if(Ne&&ln.canOverlap){$e=!0;const Nl=Bn.segments.get();for(const zl of Nl)Ft.push({segments:new l.SegmentVector([zl]),sortKey:zl.sortKey,state:cl})}else Ft.push({segments:Bn.segments,sortKey:0,state:cl})}$e&&Ft.sort((Zt,wn)=>Zt.sortKey-wn.sortKey);for(const Zt of Ft){const wn=Zt.state;if(h.terrain&&h.terrain.setupElevationDraw(wn.tile,wn.program,{useDepthForOcclusion:!Bt,labelPlaneMatrixInv:wn.labelPlaneMatrixInv}),fe.activeTexture.set(ye.TEXTURE0),wn.atlasTexture.bind(wn.atlasInterpolation,ye.CLAMP_TO_EDGE),wn.atlasTextureIcon&&(fe.activeTexture.set(ye.TEXTURE1),wn.atlasTextureIcon&&wn.atlasTextureIcon.bind(wn.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),wn.isSDF){const ln=wn.uniformValues;wn.hasHalo&&(ln.u_is_halo=1,Dn(wn.buffers,Zt.segments,c,h,wn.program,pt,j,re,ln)),ln.u_is_halo=0}Dn(wn.buffers,Zt.segments,c,h,wn.program,pt,j,re,wn.uniformValues)}}function Dn(h,i,c,p,_,x,C,A,N){const H=p.context,j=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];_.draw(H,H.gl.TRIANGLES,x,C,A,l.CullFaceMode.disabled,N,c.id,h.layoutVertexBuffer,h.indexBuffer,i,c.paint,p.transform.zoom,h.programConfigurations.get(c.id),j)}function Er(h,i,c,p,_,x,C){const A=h.context.gl,N=c.paint.get("fill-pattern"),H=N&&N.constantOr(1);let j,re,fe,ye,Ie;C?(re=H&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=A.LINES):(re=H?"fillPattern":"fill",j=A.TRIANGLES);for(const Te of p){const Re=i.getTile(Te);if(H&&!Re.patternsLoaded())continue;const ie=Re.getBucket(c);if(!ie)continue;h.prepareDrawTile();const ve=ie.programConfigurations.get(c.id),Ne=h.useProgram(re,ve);H&&(h.context.activeTexture.set(A.TEXTURE0),Re.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),ve.updatePaintBuffers());const $e=N.constantOr(null);if($e&&Re.imageAtlas){const mt=Re.imageAtlas.patternPositions[$e.toString()];mt&&ve.setConstantPatternPositions(mt)}const pt=h.translatePosMatrix(Te.projMatrix,Re,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(C){ye=ie.indexBuffer2,Ie=ie.segments2;const mt=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[A.drawingBufferWidth,A.drawingBufferHeight];fe="fillOutlinePattern"===re&&H?lo(pt,h,Re,mt):Hi(pt,mt)}else ye=ie.indexBuffer,Ie=ie.segments,fe=H?dr(pt,h,Re):hr(pt);h.prepareDrawProgram(h.context,Ne,Te.toUnwrapped()),Ne.draw(h.context,j,_,h.stencilModeForClipping(Te),x,l.CullFaceMode.disabled,fe,c.id,ie.layoutVertexBuffer,ye,Ie,c.paint,h.transform.zoom,ve)}}function ar(h,i,c,p,_,x,C){const A=h.context,N=A.gl,H=h.transform,j=c.paint.get("fill-extrusion-pattern"),re=j.constantOr(1),fe=c.paint.get("fill-extrusion-opacity"),ye=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],Ie=c.layout.get("fill-extrusion-edge-radius"),Te=Ie>0&&!c.paint.get("fill-extrusion-rounded-roof"),Re=Te?0:Ie,ie="globe"===H.projection.name?l.fillExtrusionHeightLift():0,ve="globe"===H.projection.name,Ne=ve?l.globeToMercatorTransition(H.zoom):0,$e=[l.mercatorXfromLng(H.center.lng),l.mercatorYfromLat(H.center.lat)],pt=[];ve&&pt.push("PROJECTION_GLOBE_VIEW"),ye[0]>0&&pt.push("FAUX_AO"),Te&&pt.push("ZERO_ROOF_RADIUS");for(const mt of p){const gt=i.getTile(mt),Bt=gt.getBucket(c);if(!Bt||Bt.projection.name!==H.projection.name)continue;const Ft=Bt.programConfigurations.get(c.id),nn=h.useProgram(re?"fillExtrusionPattern":"fillExtrusion",Ft,pt);if(h.terrain){const Cn=h.terrain;if(h.style.terrainSetForDrapingOnly())Cn.setupElevationDraw(gt,nn,{useMeterToDem:!0});else{if(!Bt.enableTerrain)continue;if(Cn.setupElevationDraw(gt,nn,{useMeterToDem:!0}),Ei(A,i,mt,Bt,c,Cn),!Bt.centroidVertexBuffer){const $n=nn.attributes.a_centroid_pos;void 0!==$n&&N.vertexAttrib2f($n,0,0)}}}re&&(h.context.activeTexture.set(N.TEXTURE0),gt.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ft.updatePaintBuffers());const Un=j.constantOr(null);if(Un&&gt.imageAtlas){const Cn=gt.imageAtlas.patternPositions[Un.toString()];Cn&&Ft.setConstantPatternPositions(Cn)}const Zt=h.translatePosMatrix(mt.projMatrix,gt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),wn=H.projection.createInversionMatrix(H,mt.canonical),ln=c.paint.get("fill-extrusion-vertical-gradient"),Bn=re?Tn(Zt,h,ln,fe,ye,Re,mt,gt,ie,Ne,$e,wn):xe(Zt,h,ln,fe,ye,Re,mt,ie,Ne,$e,wn);h.prepareDrawProgram(A,nn,mt.toUnwrapped());const Jt=[];h.terrain&&Jt.push(Bt.centroidVertexBuffer),ve&&Jt.push(Bt.layoutVertexExtBuffer),nn.draw(A,A.gl.TRIANGLES,_,x,C,l.CullFaceMode.backCCW,Bn,c.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,c.paint,h.transform.zoom,Ft,Jt)}}function Ei(h,i,c,p,_,x){const C=[ie=>{let ve=ie.canonical.x-1,Ne=ie.wrap;return ve<0&&(ve=(1<<ie.canonical.z)-1,Ne--),new l.OverscaledTileID(ie.overscaledZ,Ne,ie.canonical.z,ve,ie.canonical.y)},ie=>{let ve=ie.canonical.x+1,Ne=ie.wrap;return ve===1<<ie.canonical.z&&(ve=0,Ne++),new l.OverscaledTileID(ie.overscaledZ,Ne,ie.canonical.z,ve,ie.canonical.y)},ie=>new l.OverscaledTileID(ie.overscaledZ,ie.wrap,ie.canonical.z,ie.canonical.x,(0===ie.canonical.y?1<<ie.canonical.z:ie.canonical.y)-1),ie=>new l.OverscaledTileID(ie.overscaledZ,ie.wrap,ie.canonical.z,ie.canonical.x,ie.canonical.y===(1<<ie.canonical.z)-1?0:ie.canonical.y+1)],A=ie=>{const ve=i.getSource().minzoom,Ne=pt=>{const mt=i.getTileByID(pt);if(mt&&mt.hasData())return mt.getBucket(_)},$e=[0,-1,1];for(const pt of $e){if(ie.overscaledZ+pt<ve)continue;const mt=Ne(ie.calculateScaledKey(ie.overscaledZ+pt));if(mt)return mt}},N=[0,0,0],H=(ie,ve)=>(N[0]=Math.min(ie.min.y,ve.min.y),N[1]=Math.max(ie.max.y,ve.max.y),N[2]=l.EXTENT-ve.min.x>ie.max.x?ve.min.x-l.EXTENT:ie.max.x,N),j=(ie,ve)=>(N[0]=Math.min(ie.min.x,ve.min.x),N[1]=Math.max(ie.max.x,ve.max.x),N[2]=l.EXTENT-ve.min.y>ie.max.y?ve.min.y-l.EXTENT:ie.max.y,N),re=[(ie,ve)=>H(ie,ve),(ie,ve)=>H(ve,ie),(ie,ve)=>j(ie,ve),(ie,ve)=>j(ve,ie)],fe=new l.Point(0,0);let ye,Ie,Te;const Re=(ie,ve,Ne,$e,pt)=>{const mt=[[$e?Ne:ie,$e?ie:Ne,0],[$e?Ne:ve,$e?ve:Ne,0]],gt=pt<0?l.EXTENT+pt:pt,Bt=[$e?gt:(ie+ve)/2,$e?(ie+ve)/2:gt,0];return 0===Ne&&pt<0||0!==Ne&&pt>0?x.getForTilePoints(Te,[Bt],!0,Ie):mt.push(Bt),x.getForTilePoints(c,mt,!0,ye),Math.max(mt[0][2],mt[1][2],Bt[2])/x.exaggeration()};for(let ie=0;ie<4;ie++){const ve=(ie<2?1:5)-ie,Ne=p.borders[ie];if(0===Ne.length)continue;const $e=Te=C[ie](c),pt=A($e);if(!(pt&&pt instanceof l.FillExtrusionBucket&&pt.enableTerrain)||p.borderDoneWithNeighborZ[ie]===pt.canonical.z&&pt.borderDoneWithNeighborZ[ve]===p.canonical.z||(Ie=x.findDEMTileFor($e),!Ie||!Ie.dem))continue;if(!ye){const Ft=x.findDEMTileFor(c);if(!Ft||!Ft.dem)return;ye=Ft}const mt=pt.borders[ve];let gt=0;const Bt=pt.borderDoneWithNeighborZ[ve]!==p.canonical.z;if(p.canonical.z===pt.canonical.z){for(let Ft=0;Ft<Ne.length;Ft++){const nn=p.featuresOnBorder[Ne[Ft]],Un=nn.borders[ie];let Zt;for(;gt<mt.length&&(Zt=pt.featuresOnBorder[mt[gt]],!(Zt.borders[ve][1]>Un[0]+3));)Bt&&pt.encodeCentroid(void 0,Zt,!1),gt++;if(Zt&&gt<mt.length){const wn=gt;let ln=0;for(;!(Zt.borders[ve][0]>Un[1]-3)&&(ln++,++gt!==mt.length);)Zt=pt.featuresOnBorder[mt[gt]];if(Zt=pt.featuresOnBorder[mt[wn]],nn.intersectsCount()>1||Zt.intersectsCount()>1||1!==ln){1!==ln&&(gt=wn),p.encodeCentroid(void 0,nn,!1),Bt&&pt.encodeCentroid(void 0,Zt,!1);continue}const Bn=re[ie](nn,Zt),Jt=ie%2?l.EXTENT-1:0;fe.x=Re(Bn[0],Math.min(l.EXTENT-1,Bn[1]),Jt,ie<2,Bn[2]),fe.y=0,p.encodeCentroid(fe,nn,!1),Bt&&pt.encodeCentroid(fe,Zt,!1)}else p.encodeCentroid(void 0,nn,!1)}p.borderDoneWithNeighborZ[ie]=pt.canonical.z,p.needsCentroidUpdate=!0,Bt&&(pt.borderDoneWithNeighborZ[ve]=p.canonical.z,pt.needsCentroidUpdate=!0)}else{for(const Ft of Ne)p.encodeCentroid(void 0,p.featuresOnBorder[Ft],!1);if(Bt){for(const Ft of mt)pt.encodeCentroid(void 0,pt.featuresOnBorder[Ft],!1);pt.borderDoneWithNeighborZ[ve]=p.canonical.z,pt.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[ie]=pt.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&0!==p.centroidVertexArray.length)&&p.uploadCentroid(h)}const ui=new l.Color(1,0,0,1),Jr=new l.Color(0,1,0,1),pi=new l.Color(0,0,1,1),Mo=new l.Color(1,0,1,1),es=new l.Color(0,1,1,1);function Go(h,i,c){const p=h.context,_=h.transform,x=p.gl,C="globe"===_.projection.name,A=C?["PROJECTION_GLOBE_VIEW"]:null;let N=c.projMatrix;if(C&&l.globeToMercatorTransition(_.zoom)>0){const nn=l.transitionTileAABBinECEF(c.canonical,_),Un=l.globeDenormalizeECEF(nn);N=l.multiply(new Float32Array(16),_.globeMatrix,Un),l.multiply(N,_.projMatrix,N)}const H=h.useProgram("debug",null,A),j=i.getTileByID(c.key);h.terrain&&h.terrain.setupElevationDraw(j,H);const re=l.DepthMode.disabled,fe=l.StencilMode.disabled,ye=h.colorModeForRenderPass();p.activeTexture.set(x.TEXTURE0),h.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),C?j._makeGlobeTileDebugBuffers(h.context,_):j._makeDebugTileBoundsBuffers(h.context,_.projection);const Te=j._tileDebugBuffer||h.debugBuffer,Re=j._tileDebugIndexBuffer||h.debugIndexBuffer,ie=j._tileDebugSegments||h.debugSegments;H.draw(p,x.LINE_STRIP,re,fe,ye,l.CullFaceMode.disabled,Fe(N,l.Color.red),"$debug",Te,Re,ie,null,null,null,[j._globeTileDebugBorderBuffer]);const ve=j.latestRawTileData,Ne=Math.floor((ve&&ve.byteLength||0)/1024),$e=i.getTile(c).tileSize,pt=512/Math.min($e,512)*(c.overscaledZ/_.zoom)*.5;let mt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(mt+=` => ${c.overscaledZ}`),mt+=` ${Ne}kb`,function(nn,Un){nn.initDebugOverlayCanvas();const Zt=nn.debugOverlayCanvas,wn=nn.context.gl,ln=nn.debugOverlayCanvas.getContext("2d");ln.clearRect(0,0,Zt.width,Zt.height),ln.shadowColor="white",ln.shadowBlur=2,ln.lineWidth=1.5,ln.strokeStyle="white",ln.textBaseline="top",ln.font="bold 36px Open Sans, sans-serif",ln.fillText(Un,5,5),ln.strokeText(Un,5,5),nn.debugOverlayTexture.update(Zt),nn.debugOverlayTexture.bind(wn.LINEAR,wn.CLAMP_TO_EDGE)}(h,mt);const gt=j._tileDebugTextBuffer||h.debugBuffer,Bt=j._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Ft=j._tileDebugTextSegments||h.debugSegments;H.draw(p,x.TRIANGLES,re,fe,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,Fe(N,l.Color.transparent,pt),"$debug",gt,Bt,Ft,null,null,null,[j._globeTileDebugTextBuffer])}function As(h,i,c,p){va(h,0,i+c/2,h.transform.width,c,p)}function ss(h,i,c,p){va(h,i-c/2,0,c,h.transform.height,p)}function va(h,i,c,p,_,x){const C=h.context,A=C.gl;A.enable(A.SCISSOR_TEST),A.scissor(i*l.exported.devicePixelRatio,c*l.exported.devicePixelRatio,p*l.exported.devicePixelRatio,_*l.exported.devicePixelRatio),C.clear({color:x}),A.disable(A.SCISSOR_TEST)}const fa=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Es}=fa;function Ds(h,i,c,p){h.emplaceBack(i,c,p)}class Cs{constructor(i){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,Ds(this.vertexArray,-1,-1,1),Ds(this.vertexArray,1,-1,1),Ds(this.vertexArray,-1,1,1),Ds(this.vertexArray,1,1,1),Ds(this.vertexArray,-1,-1,-1),Ds(this.vertexArray,1,-1,-1),Ds(this.vertexArray,-1,1,-1),Ds(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Es),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function k(h,i,c,p,_,x){const C=h.gl,A=i.paint.get("sky-atmosphere-color"),N=i.paint.get("sky-atmosphere-halo-color"),H=i.paint.get("sky-atmosphere-sun-intensity"),j={u_matrix_3f:l.fromMat4(l.create$1(),p),u_sun_direction:_,u_sun_intensity:H,u_color_tint_r:[(Ie=A).r,Ie.g,Ie.b,Ie.a],u_color_tint_m:[(Te=N).r,Te.g,Te.b,Te.a],u_luminance:5e-5};var Ie,Te;C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+x,i.skyboxTexture,0),c.draw(h,C.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,j,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const X=l.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Be{constructor(i){const c=new l.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new l.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(c,X.members),this.indexBuffer=i.createIndexBuffer(p),this.segments=l.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const W={symbol:function(h,i,c,p,_){if("translucent"!==h.renderPass)return;const x=l.StencilMode.disabled,C=h.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(A,N,H,j,re,fe,ye){const Ie=N.transform,Te="map"===re,Re="map"===fe;for(const ie of A){const ve=j.getTile(ie),Ne=ve.getBucket(H);if(!Ne||!Ne.text||!Ne.text.segments.get().length)continue;const $e=l.evaluateSizeForZoom(Ne.textSizeData,Ie.zoom),pt=pn(ie,Ne.getProjection(),Ie),mt=Ie.calculatePixelsToTileUnitsMatrix(ve),gt=zt(pt,ve.tileID.canonical,Re,Te,Ie,Ne.getProjection(),mt),Bt="none"!==H.layout.get("icon-text-fit")&&Ne.hasIconData();if($e){const Ft=Math.pow(2,Ie.zoom-ve.tileID.overscaledZ);ct(Ne,Te,Re,ye,l.symbolSize,Ie,gt,ie,Ft,$e,Bt)}}}(p,h,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),0!==c.paint.get("icon-opacity").constantOr(1)&&Qt(h,i,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),x,C),0!==c.paint.get("text-opacity").constantOr(1)&&Qt(h,i,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),x,C),i.map.showCollisionBoxes&&(G(h,i,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),G(h,i,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(h,i,c,p){if("translucent"!==h.renderPass)return;const _=c.paint.get("circle-opacity"),x=c.paint.get("circle-stroke-width"),C=c.paint.get("circle-stroke-opacity"),A=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===_.constantOr(1)&&(0===x.constantOr(1)||0===C.constantOr(1)))return;const N=h.context,H=N.gl,j=h.transform,re=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),fe=l.StencilMode.disabled,ye=h.colorModeForRenderPass(),Ie="globe"===j.projection.name,Te=[l.mercatorXfromLng(j.center.lng),l.mercatorYfromLat(j.center.lat)],Re=[];for(let ve=0;ve<p.length;ve++){const Ne=p[ve],$e=i.getTile(Ne),pt=$e.getBucket(c);if(!pt||pt.projection.name!==j.projection.name)continue;const mt=pt.programConfigurations.get(c.id),gt=ge(c);Ie&&gt.push("PROJECTION_GLOBE_VIEW");const Bt=h.useProgram("circle",mt,gt),Ft=pt.layoutVertexBuffer,nn=pt.globeExtVertexBuffer,Un=pt.indexBuffer,Zt=j.projection.createInversionMatrix(j,Ne.canonical),wn={programConfiguration:mt,program:Bt,layoutVertexBuffer:Ft,globeExtVertexBuffer:nn,indexBuffer:Un,uniformValues:Z(h,Ne,$e,Zt,Te,c),tile:$e};if(A){const ln=pt.segments.get();for(const Bn of ln)Re.push({segments:new l.SegmentVector([Bn]),sortKey:Bn.sortKey,state:wn})}else Re.push({segments:pt.segments,sortKey:0,state:wn})}A&&Re.sort((ve,Ne)=>ve.sortKey-Ne.sortKey);const ie={useDepthForOcclusion:!Ie};for(const ve of Re){const{programConfiguration:Ne,program:$e,layoutVertexBuffer:pt,globeExtVertexBuffer:mt,indexBuffer:gt,uniformValues:Bt,tile:Ft}=ve.state,nn=ve.segments;h.terrain&&h.terrain.setupElevationDraw(Ft,$e,ie),h.prepareDrawProgram(N,$e,Ft.tileID.toUnwrapped()),$e.draw(N,H.TRIANGLES,re,fe,ye,l.CullFaceMode.disabled,Bt,c.id,pt,gt,nn,c.paint,j.zoom,Ne,[mt])}},heatmap:function(h,i,c,p){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===h.renderPass){const _=h.context,x=_.gl,C=l.StencilMode.disabled,A=new l.ColorMode([x.ONE,x.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(ye,Ie,Te,Re){const ie=ye.gl,ve=Ie.width*Re,Ne=Ie.height*Re;ye.activeTexture.set(ie.TEXTURE1),ye.viewport.set([0,0,ve,Ne]);let $e=Te.heatmapFbo;if(!$e||$e&&($e.width!==ve||$e.height!==Ne)){$e&&$e.destroy();const pt=ie.createTexture();ie.bindTexture(ie.TEXTURE_2D,pt),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,ie.LINEAR),$e=Te.heatmapFbo=ye.createFramebuffer(ve,Ne,!1),function(mt,gt,Bt,Ft,nn,Un){const Zt=mt.gl;Zt.texImage2D(Zt.TEXTURE_2D,0,mt.isWebGL2&&mt.extRenderToTextureHalfFloat?Zt.RGBA16F:Zt.RGBA,nn,Un,0,Zt.RGBA,mt.extRenderToTextureHalfFloat?mt.isWebGL2?Zt.HALF_FLOAT:mt.extTextureHalfFloat.HALF_FLOAT_OES:Zt.UNSIGNED_BYTE,null),Ft.colorAttachment.set(Bt)}(ye,0,pt,$e,ve,Ne)}else ie.bindTexture(ie.TEXTURE_2D,$e.colorAttachment.get()),ye.bindFramebuffer.set($e.framebuffer)})(_,h,c,"globe"===h.transform.projection.name?.5:.25),_.clear({color:l.Color.transparent});const N=h.transform,H="globe"===N.projection.name,j=H?["PROJECTION_GLOBE_VIEW"]:null,re=H?l.CullFaceMode.frontCCW:l.CullFaceMode.disabled,fe=[l.mercatorXfromLng(N.center.lng),l.mercatorYfromLat(N.center.lat)];for(let ye=0;ye<p.length;ye++){const Ie=p[ye];if(i.hasRenderableParent(Ie))continue;const Te=i.getTile(Ie),Re=Te.getBucket(c);if(!Re||Re.projection.name!==N.projection.name)continue;const ie=Re.programConfigurations.get(c.id),ve=h.useProgram("heatmap",ie,j),{zoom:Ne}=h.transform;h.terrain&&h.terrain.setupElevationDraw(Te,ve),h.prepareDrawProgram(_,ve,Ie.toUnwrapped());const $e=N.projection.createInversionMatrix(N,Ie.canonical);ve.draw(_,x.TRIANGLES,l.DepthMode.disabled,C,A,re,Xr(h,Ie,Te,$e,fe,Ne,c.paint.get("heatmap-intensity")),c.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,c.paint,h.transform.zoom,ie,H?[Re.globeExtVertexBuffer]:null)}_.viewport.set([0,0,h.width,h.height])}else"translucent"===h.renderPass&&(h.context.setColorMode(h.colorModeForRenderPass()),function(_,x){const C=_.context,A=C.gl,N=x.heatmapFbo;if(!N)return;C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,N.colorAttachment.get()),C.activeTexture.set(A.TEXTURE1);let H=x.colorRampTexture;H||(H=x.colorRampTexture=new l.Texture(C,x.colorRamp,A.RGBA)),H.bind(A.LINEAR,A.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(C,A.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,_.colorModeForRenderPass(),l.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:x.paint.get("heatmap-opacity")},x.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,x.paint,_.transform.zoom)}(h,c))},line:function(h,i,c,p){if("translucent"!==h.renderPass)return;const _=c.paint.get("line-opacity"),x=c.paint.get("line-width");if(0===_.constantOr(1)||0===x.constantOr(1))return;const C=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),A=h.colorModeForRenderPass(),N=h.terrain&&h.terrain.renderingToTexture?1:l.exported.devicePixelRatio,H=c.paint.get("line-dasharray"),j=H.constantOr(1),re=c.layout.get("line-cap"),fe=c.paint.get("line-pattern"),ye=fe.constantOr(1),Ie=c.paint.get("line-gradient"),Te=ye?"linePattern":"line",Re=h.context,ie=Re.gl,ve=($e=>{const pt=[];Aa($e)&&pt.push("RENDER_LINE_DASH"),$e.paint.get("line-gradient")&&pt.push("RENDER_LINE_GRADIENT");const mt=$e.paint.get("line-trim-offset");0===mt[0]&&0===mt[1]||pt.push("RENDER_LINE_TRIM_OFFSET");const gt=$e.paint.get("line-pattern").constantOr(1),Bt=1!==$e.paint.get("line-opacity").constantOr(1);return!gt&&Bt&&pt.push("RENDER_LINE_ALPHA_DISCARD"),pt})(c);let Ne=ve.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(Ne=!1);for(const $e of p){const pt=i.getTile($e);if(ye&&!pt.patternsLoaded())continue;const mt=pt.getBucket(c);if(!mt)continue;h.prepareDrawTile();const gt=mt.programConfigurations.get(c.id),Bt=h.useProgram(Te,gt,ve),Ft=fe.constantOr(null);if(Ft&&pt.imageAtlas){const Cn=pt.imageAtlas.patternPositions[Ft.toString()];Cn&&gt.setConstantPatternPositions(Cn)}const nn=H.constantOr(null),Un=re.constantOr(null);if(!ye&&nn&&Un&&pt.lineAtlas){const Cn=pt.lineAtlas.getDash(nn,Un);Cn&&gt.setConstantPatternPositions(Cn)}let[Zt,wn]=c.paint.get("line-trim-offset");("round"===Un||"square"===Un)&&Zt!==wn&&(0===Zt&&(Zt-=1),1===wn&&(wn+=1));const ln=h.terrain?$e.projMatrix:null,Bn=ye?hs(h,pt,c,ln,N):qo(h,pt,c,ln,mt.lineClipsArray.length,N,[Zt,wn]);if(Ie){const Cn=mt.gradients[c.id];let $n=Cn.texture;if(c.gradientVersion!==Cn.version){let kn=256;if(c.stepInterpolant){const Yn=i.getSource().maxzoom,Or=$e.canonical.z===Yn?Math.ceil(1<<h.transform.maxZoom-$e.canonical.z):1;kn=l.clamp(l.nextPowerOfTwo(mt.maxLineLength/l.EXTENT*1024*Or),256,Re.maxTextureSize)}Cn.gradient=l.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:Cn.gradient||void 0,clips:mt.lineClipsArray}),Cn.texture?Cn.texture.update(Cn.gradient):Cn.texture=new l.Texture(Re,Cn.gradient,ie.RGBA),Cn.version=c.gradientVersion,$n=Cn.texture}Re.activeTexture.set(ie.TEXTURE1),$n.bind(c.stepInterpolant?ie.NEAREST:ie.LINEAR,ie.CLAMP_TO_EDGE)}j&&(Re.activeTexture.set(ie.TEXTURE0),pt.lineAtlasTexture.bind(ie.LINEAR,ie.REPEAT),gt.updatePaintBuffers()),ye&&(Re.activeTexture.set(ie.TEXTURE0),pt.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),gt.updatePaintBuffers()),h.prepareDrawProgram(Re,Bt,$e.toUnwrapped());const Jt=Cn=>{Bt.draw(Re,ie.TRIANGLES,C,Cn,A,l.CullFaceMode.disabled,Bn,c.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,c.paint,h.transform.zoom,gt,[mt.layoutVertexBuffer2])};if(Ne){const Cn=h.stencilModeForClipping($e).ref;0===Cn&&h.terrain&&Re.clear({stencil:0});const $n={func:ie.EQUAL,mask:255};Bn.u_alpha_discard_threshold=.8,Jt(new l.StencilMode($n,Cn,255,ie.KEEP,ie.KEEP,ie.INVERT)),Bn.u_alpha_discard_threshold=0,Jt(new l.StencilMode($n,Cn,255,ie.KEEP,ie.KEEP,ie.KEEP))}else Jt(h.stencilModeForClipping($e))}Ne&&(h.resetStencilClippingMasks(),h.terrain&&Re.clear({stencil:0}))},fill:function(h,i,c,p){const _=c.paint.get("fill-color"),x=c.paint.get("fill-opacity");if(0===x.constantOr(1))return;const C=h.colorModeForRenderPass(),A=c.paint.get("fill-pattern"),N=h.opaquePassEnabledForLayer()&&!A.constantOr(1)&&1===_.constantOr(l.Color.transparent).a&&1===x.constantOr(0)?"opaque":"translucent";if(h.renderPass===N){const H=h.depthModeForSublayer(1,"opaque"===h.renderPass?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);Er(h,i,c,p,H,C,!1)}if("translucent"===h.renderPass&&c.paint.get("fill-antialias")){const H=h.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);Er(h,i,c,p,H,C,!0)}},"fill-extrusion":function(h,i,c,p){const _=c.paint.get("fill-extrusion-opacity");if(0!==_&&"translucent"===h.renderPass){const x=new l.DepthMode(h.context.gl.LEQUAL,l.DepthMode.ReadWrite,h.depthRangeFor3D);if(1!==_||c.paint.get("fill-extrusion-pattern").constantOr(1))ar(h,i,c,p,x,l.StencilMode.disabled,l.ColorMode.disabled),ar(h,i,c,p,x,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const C=h.colorModeForRenderPass();ar(h,i,c,p,x,l.StencilMode.disabled,C)}}},hillshade:function(h,i,c,p){if("offscreen"!==h.renderPass&&"translucent"!==h.renderPass)return;const _=h.context,x=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),C=h.colorModeForRenderPass(),A=h.terrain&&h.terrain.renderingToTexture,[N,H]="translucent"!==h.renderPass||A?[{},p]:h.stencilConfigForOverlap(p);for(const j of H){const re=i.getTile(j);if(re.needsHillshadePrepare&&"offscreen"===h.renderPass)la(h,re,c,x,l.StencilMode.disabled,C);else if("translucent"===h.renderPass){const fe=A&&h.terrain?h.terrain.stencilModeForRTTOverlap(j):N[j.overscaledZ];Jo(h,j,re,c,x,fe,C)}}_.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,i,c,p,_,x){if("translucent"!==h.renderPass||0===c.paint.get("raster-opacity")||!p.length)return;const C=h.context,A=C.gl,N=i.getSource(),H=h.useProgram("raster"),j=h.colorModeForRenderPass(),re=h.terrain&&h.terrain.renderingToTexture,[fe,ye]=N instanceof Dt||re?[{},p]:h.stencilConfigForOverlap(p),Ie=ye[ye.length-1].overscaledZ,Te=!h.options.moving;for(const Re of ye){const ie=re?l.DepthMode.disabled:h.depthModeForSublayer(Re.overscaledZ-Ie,1===c.paint.get("raster-opacity")?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,A.LESS),ve=Re.toUnwrapped(),Ne=i.getTile(Re);if(re&&(!Ne||!Ne.hasData()))continue;const $e=re?Re.projMatrix:h.transform.calculateProjMatrix(ve,Te),pt=h.terrain&&re?h.terrain.stencilModeForRTTOverlap(Re):fe[Re.overscaledZ],mt=x?0:c.paint.get("raster-fade-duration");Ne.registerFadeDuration(mt);const gt=i.findLoadedParent(Re,0),Bt=us(Ne,gt,i,h.transform,mt);let Ft,nn;h.terrain&&h.terrain.prepareDrawTile();const Un="nearest"===c.paint.get("raster-resampling")?A.NEAREST:A.LINEAR;C.activeTexture.set(A.TEXTURE0),Ne.texture.bind(Un,A.CLAMP_TO_EDGE),C.activeTexture.set(A.TEXTURE1),gt?(gt.texture.bind(Un,A.CLAMP_TO_EDGE),Ft=Math.pow(2,gt.tileID.overscaledZ-Ne.tileID.overscaledZ),nn=[Ne.tileID.canonical.x*Ft%1,Ne.tileID.canonical.y*Ft%1]):Ne.texture.bind(Un,A.CLAMP_TO_EDGE),Ne.texture.useMipmap&&C.extTextureFilterAnisotropic&&h.transform.pitch>20&&A.texParameterf(A.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax);const Zt=Ea($e,nn||[0,0],Ft||1,Bt,c,N instanceof Dt?N.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(C,H,ve),N instanceof Dt)N.boundsBuffer&&N.boundsSegments&&H.draw(C,A.TRIANGLES,ie,l.StencilMode.disabled,j,l.CullFaceMode.disabled,Zt,c.id,N.boundsBuffer,h.quadTriangleIndexBuffer,N.boundsSegments);else{const{tileBoundsBuffer:wn,tileBoundsIndexBuffer:ln,tileBoundsSegments:Bn}=h.getTileBoundsBuffers(Ne);H.draw(C,A.TRIANGLES,ie,pt,j,l.CullFaceMode.disabled,Zt,c.id,wn,ln,Bn)}}h.resetStencilClippingMasks()},background:function(h,i,c,p){const _=c.paint.get("background-color"),x=c.paint.get("background-opacity");if(0===x)return;const C=h.context,A=C.gl,N=h.transform,H=N.tileSize,j=c.paint.get("background-pattern");if(h.isPatternMissing(j))return;const re=!j&&1===_.a&&1===x&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==re)return;const fe=l.StencilMode.disabled,ye=h.depthModeForSublayer(0,"opaque"===re?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),Ie=h.colorModeForRenderPass(),Te=h.useProgram(j?"backgroundPattern":"background");let Re,ie=p;ie||(Re=h.getBackgroundTiles(),ie=Object.values(Re).map(ve=>ve.tileID)),j&&(C.activeTexture.set(A.TEXTURE0),h.imageManager.bind(h.context));for(const ve of ie){const Ne=ve.toUnwrapped(),$e=p?ve.projMatrix:h.transform.calculateProjMatrix(Ne);h.prepareDrawTile();const pt=i?i.getTile(ve):Re?Re[ve.key]:new l.Tile(ve,H,N.zoom,h),mt=j?ce($e,x,h,j,{tileID:ve,tileSize:H}):xl($e,x,_);h.prepareDrawProgram(C,Te,Ne);const{tileBoundsBuffer:gt,tileBoundsIndexBuffer:Bt,tileBoundsSegments:Ft}=h.getTileBoundsBuffers(pt);Te.draw(C,A.TRIANGLES,ye,fe,Ie,l.CullFaceMode.disabled,mt,c.id,gt,Bt,Ft)}},sky:function(h,i,c){const p=h.transform,_="mercator"===p.projection.name||"globe"===p.projection.name?1:l.smoothstep(7,8,p.zoom),x=c.paint.get("sky-opacity")*_;if(0===x)return;const C=h.context,A=c.paint.get("sky-type"),N=new l.DepthMode(C.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),H=h.frameCounter/1e3%1;"atmosphere"===A?"offscreen"===h.renderPass?c.needsSkyboxCapture(h)&&(function(j,re,fe,ye){const Ie=j.context,Te=Ie.gl;let Re=re.skyboxFbo;if(!Re){Re=re.skyboxFbo=Ie.createFramebuffer(32,32,!1),re.skyboxGeometry=new Cs(Ie),re.skyboxTexture=Ie.gl.createTexture(),Te.bindTexture(Te.TEXTURE_CUBE_MAP,re.skyboxTexture),Te.texParameteri(Te.TEXTURE_CUBE_MAP,Te.TEXTURE_WRAP_S,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_CUBE_MAP,Te.TEXTURE_WRAP_T,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_CUBE_MAP,Te.TEXTURE_MIN_FILTER,Te.LINEAR),Te.texParameteri(Te.TEXTURE_CUBE_MAP,Te.TEXTURE_MAG_FILTER,Te.LINEAR);for(let $e=0;$e<6;++$e)Te.texImage2D(Te.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,Te.RGBA,32,32,0,Te.RGBA,Te.UNSIGNED_BYTE,null)}Ie.bindFramebuffer.set(Re.framebuffer),Ie.viewport.set([0,0,32,32]);const ie=re.getCenter(j,!0),ve=j.useProgram("skyboxCapture"),Ne=new Float64Array(16);l.identity(Ne),l.rotateY(Ne,Ne,.5*-Math.PI),k(Ie,re,ve,Ne,ie,0),l.identity(Ne),l.rotateY(Ne,Ne,.5*Math.PI),k(Ie,re,ve,Ne,ie,1),l.identity(Ne),l.rotateX(Ne,Ne,.5*-Math.PI),k(Ie,re,ve,Ne,ie,2),l.identity(Ne),l.rotateX(Ne,Ne,.5*Math.PI),k(Ie,re,ve,Ne,ie,3),l.identity(Ne),k(Ie,re,ve,Ne,ie,4),l.identity(Ne),l.rotateY(Ne,Ne,Math.PI),k(Ie,re,ve,Ne,ie,5),Ie.viewport.set([0,0,j.width,j.height])}(h,c),c.markSkyboxValid(h)):"sky"===h.renderPass&&function(j,re,fe,ye,Ie){const Te=j.context,Re=Te.gl,ie=j.transform,ve=j.useProgram("skybox");Te.activeTexture.set(Re.TEXTURE0),Re.bindTexture(Re.TEXTURE_CUBE_MAP,re.skyboxTexture);const Ne={u_matrix:ie.skyboxMatrix,u_sun_direction:re.getCenter(j,!1),u_cubemap:0,u_opacity:ye,u_temporal_offset:Ie};j.prepareDrawProgram(Te,ve),ve.draw(Te,Re.TRIANGLES,fe,l.StencilMode.disabled,j.colorModeForRenderPass(),l.CullFaceMode.backCW,Ne,"skybox",re.skyboxGeometry.vertexBuffer,re.skyboxGeometry.indexBuffer,re.skyboxGeometry.segment)}(h,c,N,x,H):"gradient"===A&&"sky"===h.renderPass&&function(j,re,fe,ye,Ie){const Te=j.context,Re=Te.gl,ie=j.transform,ve=j.useProgram("skyboxGradient");re.skyboxGeometry||(re.skyboxGeometry=new Cs(Te)),Te.activeTexture.set(Re.TEXTURE0);let Ne=re.colorRampTexture;Ne||(Ne=re.colorRampTexture=new l.Texture(Te,re.colorRamp,Re.RGBA)),Ne.bind(Re.LINEAR,Re.CLAMP_TO_EDGE);const $e=(pt=ie.skyboxMatrix,mt=re.getCenter(j,!1),gt=re.paint.get("sky-gradient-radius"),Bt=ye,Ft=Ie,{u_matrix:pt,u_color_ramp:0,u_center_direction:mt,u_radius:l.degToRad(gt),u_opacity:Bt,u_temporal_offset:Ft});var pt,mt,gt,Bt,Ft;j.prepareDrawProgram(Te,ve),ve.draw(Te,Re.TRIANGLES,fe,l.StencilMode.disabled,j.colorModeForRenderPass(),l.CullFaceMode.backCW,$e,"skyboxGradient",re.skyboxGeometry.vertexBuffer,re.skyboxGeometry.indexBuffer,re.skyboxGeometry.segment)}(h,c,N,x,H)},debug:function(h,i,c){for(let p=0;p<c.length;p++)Go(h,i,c[p])},custom:function(h,i,c,p){const _=h.context,x=c.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||"offscreen"===h.renderPass)&&c.isLayerDraped()){if("offscreen"===h.renderPass){const C=x.prerender;if(C){if(h.setCustomLayerDefaults(),_.setColorMode(h.colorModeForRenderPass()),"globe"===h.transform.projection.name){const A=h.transform.pointMerc;C.call(x,_.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(h.transform.zoom),[A.x,A.y],h.transform.pixelsPerMeterRatio)}else C.call(x,_.gl,h.transform.customLayerMatrix());_.setDirty(),h.setBaseState()}}else if("translucent"===h.renderPass){if(h.terrain&&h.terrain.renderingToTexture){const A=x.renderToTile;if(A){const N=p[0].canonical,H=new l.MercatorCoordinate(N.x+p[0].wrap*(1<<N.z),N.y,N.z);_.setDepthMode(l.DepthMode.disabled),_.setStencilMode(l.StencilMode.disabled),_.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),A.call(x,_.gl,H),_.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),_.setColorMode(h.colorModeForRenderPass()),_.setStencilMode(l.StencilMode.disabled);const C="3d"===x.renderingMode?new l.DepthMode(h.context.gl.LEQUAL,l.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,l.DepthMode.ReadOnly);if(_.setDepthMode(C),"globe"===h.transform.projection.name){const A=h.transform.pointMerc;x.render(_.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(h.transform.zoom),[A.x,A.y],h.transform.pixelsPerMeterRatio)}else x.render(_.gl,h.transform.customLayerMatrix());_.setDirty(),h.setBaseState(),_.bindFramebuffer.set(null)}}else l.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class be{constructor(i,c,p=!1){this.context=new En(i,p),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,c){const p=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new S(this,i));const _=this._terrain;this.transform.elevation=p?_:null,_.update(i,this.transform,c)}_updateFog(i){const c=i.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,_]=c.getFovAdjustedRange(this.transform._fov);if(p>_)return void(this.transform.fogCullDistSq=null);const x=p+.78*(_-p);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,c){if(this.width=i*l.exported.devicePixelRatio,this.height=c*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const i=this.context,c=new l.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(c,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const p=new l.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(l.EXTENT,0),p.emplaceBack(0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(p,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const _=new l.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(_,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const x=new l.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(l.EXTENT,0,l.EXTENT,0),x.emplaceBack(0,l.EXTENT,0,l.EXTENT),x.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(x,l.boundsAttributes.members),this.mercatorBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const C=new l.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(C);const A=new l.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])A.emplaceBack(H);this.debugIndexBuffer=i.createIndexBuffer(A),this.emptyTexture=new l.Texture(i,new l.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=l.create();const N=this.context.gl;this.stencilClearMode=new l.StencilMode({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(l.window.performance.now()),this.atmosphereBuffer=new Be(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,c.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,xo(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,p){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!p||0===p.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let A=!1;for(const N of p)if(void 0===this._tileClippingMaskIDs[N.key]){A=!0;break}if(!A)return}this.currentStencilSource=c.id;const _=this.context,x=_.gl;this.nextStencilID+p.length>256&&this.clearStencil(),_.setColorMode(l.ColorMode.disabled),_.setDepthMode(l.DepthMode.disabled);const C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const A of p){const N=c.getTile(A),H=this._tileClippingMaskIDs[A.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:re,tileBoundsSegments:fe}=this.getTileBoundsBuffers(N);C.draw(_,x.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:x.ALWAYS,mask:0},H,255,x.KEEP,x.KEEP,x.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,xo(A.projMatrix),"$clipping",j,re,fe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new l.StencilMode({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new l.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,p=i.sort((C,A)=>A.overscaledZ-C.overscaledZ),_=p[p.length-1].overscaledZ,x=p[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const C={};for(let A=0;A<x;A++)C[A+_]=new l.StencilMode({func:c.GEQUAL,mask:255},A+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=x,[C,p]}return[{[_]:l.StencilMode.disabled},p]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new l.ColorMode([i.CONSTANT_COLOR,i.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(i,c,p){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new l.DepthMode(p||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){this.style=i,this.options=c,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const p=this.style.order,_=this.style._sourceCaches;for(const H in _){const j=_[H];j.used&&j.prepare(this.context)}const x={},C={},A={};for(const H in _){const j=_[H];x[H]=j.getVisibleCoordinates(),C[H]=x[H].slice().reverse(),A[H]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<p.length;H++)if(this.style._layers[p[H]].is3D()){this.opaquePassCutoff=H;break}if(this.terrain&&(this.terrain.updateTileBinding(A),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new l.GlobeSharedBuffers(this.context)),!l.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const H of p){const j=this.style._layers[H],re=i._getLayerSourceCache(j);if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;const fe=re?C[re.id]:void 0;("custom"===j.type||j.isSky()||fe&&fe.length)&&this.renderLayer(this,re,j,fe)}this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon];const N=this.terrain;if(N&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&N.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[p[this.currentLayer]],j=i._getLayerSourceCache(H);if(H.isSky())continue;const re=j?C[j.id]:void 0;this._renderTileClippingMasks(H,j,re),this.renderLayer(this,j,H,re)}if(this.style.fog&&this.transform.projection.supportsFog&&function(H,j){const re=H.context,fe=re.gl,ye=H.transform,Ie=new l.DepthMode(fe.LEQUAL,l.DepthMode.ReadOnly,[0,1]),Te=H.useProgram("globeAtmosphere",null,"globe"===ye.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Re=l.globeToMercatorTransition(ye.zoom),ie=j.properties.get("color").toArray01(),ve=j.properties.get("high-color").toArray01(),Ne=j.properties.get("space-color").toArray01PremultipliedAlpha(),$e=l.identity$1([]);l.rotateY$1($e,$e,-l.degToRad(ye._center.lng)),l.rotateX$1($e,$e,l.degToRad(ye._center.lat)),l.rotateZ$1($e,$e,ye.angle),l.rotateX$1($e,$e,-ye._pitch);const pt=l.fromQuat(new Float32Array(16),$e),mt=l.mapValue(j.properties.get("star-intensity"),0,1,0,.25),Bt=l.mapValue(j.properties.get("horizon-blend"),0,1,5e-4,.25),Ft=l.globeUseCustomAntiAliasing(H,re,ye)&&5e-4===Bt?ye.worldSize/(2*Math.PI*1.025)-1:ye.globeRadius,nn=H.frameCounter/1e3%1,Un=l.length(ye.globeCenterInViewSpace),Zt=Math.sqrt(Math.pow(Un,2)-Math.pow(Ft,2)),wn=Math.acos(Zt/Un),ln={u_frustum_tl:ye.frustumCorners.TL,u_frustum_tr:ye.frustumCorners.TR,u_frustum_br:ye.frustumCorners.BR,u_frustum_bl:ye.frustumCorners.BL,u_horizon:ye.frustumCorners.horizon,u_transition:Re,u_fadeout_range:Bt,u_color:ie,u_high_color:ve,u_space_color:Ne,u_star_intensity:mt,u_star_size:5*l.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:nn,u_horizon_angle:wn,u_rotation_matrix:pt};H.prepareDrawProgram(re,Te);const Bn=H.atmosphereBuffer;Bn&&Te.draw(re,fe.TRIANGLES,Ie,l.StencilMode.disabled,l.ColorMode.alphaBlended,l.CullFaceMode.backCW,ln,"skybox",Bn.vertexBuffer,Bn.indexBuffer,Bn.segments)}(this,this.style.fog),this.renderPass="sky",(l.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const H=this.style._layers[p[this.currentLayer]],j=i._getLayerSourceCache(H);H.isSky()&&this.renderLayer(this,j,H,j?C[j.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const H=this.style._layers[p[this.currentLayer]],j=i._getLayerSourceCache(H);if(H.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(H)){if(H.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const re=j?("symbol"===H.type?A:C)[j.id]:void 0;this._renderTileClippingMasks(H,j,j?x[j.id]:void 0),this.renderLayer(this,j,H,re),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let H=null;l.values(this.style._layers).forEach(j=>{const re=i._getLayerSourceCache(j);re&&!j.isHidden(this.transform.zoom)&&(!H||H.getSource().maxzoom<re.getSource().maxzoom)&&(H=re)}),H&&this.options.showTileBoundaries&&W.debug(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const j=H.transform.padding;As(H,H.transform.height-(j.top||0),3,ui),As(H,j.bottom||0,3,Jr),ss(H,j.left||0,3,pi),ss(H,H.transform.width-(j.right||0),3,Mo);const re=H.transform.centerPoint;var fe,ye,Ie,Te;va(fe=H,(ye=re.x)-1,(Ie=H.transform.height-re.y)-10,2,20,Te=es),va(fe,ye-10,Ie-1,20,2,Te)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}renderLayer(i,c,p,_){p.isHidden(this.transform.zoom)||("background"===p.type||"sky"===p.type||"custom"===p.type||_&&_.length)&&(this.id=p.id,this.gpuTimingStart(p),(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes(p.type)||i.terrain&&"custom"===p.type)&&W[p.type](i,c,p,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[i.id];p||(p=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,c=i.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),i.beginQueryEXT(i.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const c={};for(const p in i){const _=i[p],x=this.context.extTimerQuery,C=x.getQueryObjectEXT(_.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(_.query),c[p]=C}return c}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let p=0;for(const _ of i)p+=c.getQueryObjectEXT(_,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(_);return p}translatePosMatrix(i,c,p,_,x){if(!p[0]&&!p[1])return i;const C=x?"map"===_?this.transform.angle:0:"viewport"===_?-this.transform.angle:0;if(C){const H=Math.sin(C),j=Math.cos(C);p=[p[0]*j-p[1]*H,p[0]*H+p[1]*j]}const A=[x?p[0]:pr(c,p[0],this.transform.zoom),x?p[1]:pr(c,p[1],this.transform.zoom),0],N=new Float32Array(16);return l.translate(N,i,A),N}saveTileTexture(i){const c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){return null===i||void 0!==i&&!this.imageManager.getPattern(i.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),p=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),"globe"===this.transform.projection.name&&_.push("GLOBE"),c&&_.push("ZERO_EXAGGERATION"),p&&!i&&0!==p.getOpacity(this.transform.pitch)&&_.push("FOG"),i&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(i,c,p){this.cache=this.cache||{};const _=p||[],x=this.currentGlobalDefines().concat(_),C=K.cacheKey(is[i],i,x,c);return this.cache[C]||(this.cache[C]=new K(this.context,i,is[i],c,M[i],x)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const x=_.getOpacity(this.transform.pitch),C=((A,N,H,j,re,fe,ye,Ie,Te,Re,ie)=>{const ve=A.transform,Ne=N.properties.get("color").toArray01();Ne[3]=j;const $e=A.frameCounter/1e3%1;return{u_fog_matrix:H?ve.calculateFogTileMatrix(H):A.identityMat,u_fog_range:N.getFovAdjustedRange(ve._fov),u_fog_color:Ne,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_temporal_offset:$e,u_frustum_tl:re,u_frustum_tr:fe,u_frustum_br:ye,u_frustum_bl:Ie,u_globe_pos:Te,u_globe_radius:Re,u_viewport:ie,u_globe_transition:l.globeToMercatorTransition(ve.zoom),u_is_globe:+("globe"===ve.projection.name)}})(this,_,p,x,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*l.exported.devicePixelRatio,this.transform.height*l.exported.devicePixelRatio]);c.setFogUniformValues(i,C)}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const _ of p)c[_.key]=i[_.key]||new l.Tile(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class _t{constructor(i=0,c=0,p=0,_=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=p,this.right=_}interpolate(i,c,p){return null!=c.top&&null!=i.top&&(this.top=l.number(i.top,c.top,p)),null!=c.bottom&&null!=i.bottom&&(this.bottom=l.number(i.bottom,c.bottom,p)),null!=c.left&&null!=i.left&&(this.left=l.number(i.left,c.left,p)),null!=c.right&&null!=i.right&&(this.right=l.number(i.right,c.right,p)),this}getCenter(i,c){const p=l.clamp((this.left+i-this.right)/2,0,i),_=l.clamp((this.top+c-this.bottom)/2,0,c);return new l.Point(p,_)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new _t(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function kt(h,i){const c=l.getColumn(h,3);l.fromQuat(h,i),l.setColumn(h,3,c)}function Ut(h,i){const c=l.identity$1([]);return l.rotateZ$1(c,c,-i),l.rotateX$1(c,c,-h),c}function tr(h,i){const c=[h[0],h[1],0],p=[i[0],i[1],0];if(l.length(c)>=1e-15){const C=l.normalize([],c);l.scale$2(p,C,l.dot(p,C)),i[0]=p[0],i[1]=p[1]}const _=l.cross([],i,h);if(l.len(_)<1e-15)return null;const x=Math.atan2(-_[1],_[0]);return Ut(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),x)}class _r{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){if(i){const c=i instanceof l.MercatorCoordinate?i:new l.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(c.x=l.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const p=this.position,_=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(i)):0,x=l.MercatorCoordinate.fromLngLat(i,_),C=[x.x-p.x,x.y-p.y,x.z-p.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=tr(C,c)}setPitchBearing(i,c){this.orientation=Ut(l.degToRad(i),l.degToRad(-c))}}class ti{constructor(i,c){this._transform=l.identity([]),this.orientation=c,this.position=i}get mercatorPosition(){const i=this.position;return new l.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=l.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var c;i&&l.setColumn(this._transform,3,[(c=i)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||l.identity$1([]),i&&kt(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=Ut(i,c),kt(this._transform,this._orientation)}forward(){const i=l.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=l.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=l.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const p=new Float64Array(16);return l.invert(p,this.getWorldToCamera(i,c)),p}getWorldToCameraPosition(i,c,p){const _=this.position;l.scale$2(_,_,-i);const x=new Float64Array(16);return l.fromScaling(x,[p,p,p]),l.translate(x,x,_),x[10]*=c,x}getWorldToCamera(i,c){const p=new Float64Array(16),_=new Float64Array(4),x=this.position;return l.conjugate(_,this._orientation),l.scale$2(x,x,-i),l.fromQuat(p,_),l.translate(p,p,x),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(i,c,p,_){const x=new Float64Array(16);return l.perspective(x,i,c,p,_),x}getDistanceToElevation(i,c=!1){const p=0===i?0:l.mercatorZfromAltitude(i,c?l.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(p-this.position[2])/_[2]}clone(){return new ti([...this.position],[...this.orientation])}}function Kr(h,i){const c=Bi(h.projection,h.zoom,h.width,h.height),p=function(x,C,A,N,H){const j=new l.LngLat(A.lng-180*ni,A.lat),re=new l.LngLat(A.lng+180*ni,A.lat),fe=x.project(j.lng,j.lat),ye=x.project(re.lng,re.lat),Ie=-Math.atan2(ye.y-fe.y,ye.x-fe.x),Te=l.MercatorCoordinate.fromLngLat(A);Te.y=l.clamp(Te.y,-1+ni,1-ni);const Re=Te.toLngLat(),ie=x.project(Re.lng,Re.lat),ve=l.MercatorCoordinate.fromLngLat(Re);ve.x+=ni;const Ne=ve.toLngLat(),$e=x.project(Ne.lng,Ne.lat),pt=Ws($e.x-ie.x,$e.y-ie.y,Ie),mt=l.MercatorCoordinate.fromLngLat(Re);mt.y+=ni;const gt=mt.toLngLat(),Bt=x.project(gt.lng,gt.lat),Ft=Ws(Bt.x-ie.x,Bt.y-ie.y,Ie),nn=Math.abs(pt.x)/Math.abs(Ft.y),Un=l.identity([]);l.rotateZ(Un,Un,-Ie*(1-(H?0:N)));const Zt=l.identity([]);return l.scale(Zt,Zt,[1,1-(1-nn)*N,1]),Zt[4]=-Ft.x/Ft.y*N,l.rotateZ(Zt,Zt,Ie),l.multiply(Zt,Un,Zt),Zt}(h.projection,0,h.center,c,i),_=Pr(h);return l.scale(p,p,[_,_,1]),p}function Pr(h){const i=h.projection,c=Bi(h.projection,h.zoom,h.width,h.height),p=co(i,h.center),_=co(i,l.LngLat.convert(i.center));return Math.pow(2,p*c+(1-c)*_)}function Bi(h,i,c,p,_=1/0){const x=h.range;if(!x)return 0;const C=Math.min(_,Math.max(c,p)),A=Math.log(C/1024)/Math.LN2;return l.smoothstep(x[0]+A,x[1]+A,i)}const ni=1/4e4;function co(h,i){const c=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=new l.LngLat(i.lng-180*ni,c),_=new l.LngLat(i.lng+180*ni,c),x=h.project(p.lng,c),C=h.project(_.lng,c),A=l.MercatorCoordinate.fromLngLat(p),N=l.MercatorCoordinate.fromLngLat(_),H=C.x-x.x,j=C.y-x.y,re=N.x-A.x,fe=N.y-A.y,ye=Math.sqrt((re*re+fe*fe)/(H*H+j*j));return Math.log(ye)/Math.LN2}function Ws(h,i,c){const p=Math.cos(c),_=Math.sin(c);return{x:h*p-i*_,y:h*_+i*p}}class uo{constructor(i,c,p,_,x,C,A){this.tileSize=512,this._renderWorldCopies=void 0===x||x,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=_??60,this.setProjection(C),this.setMaxBounds(A),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new _t,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ti,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const i=new uo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i,c=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||p)&&this._updateCameraOnTerrain(),(i||p)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return l.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=l.getProjection(this.projectionOptions);const p=!Ee(c,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=l.getProjection({name:"mercator"});const c=i!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return l.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;var p,_,x,C,A,N,H,j,re,fe;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),_=this.rotationMatrix,C=this.angle,A=(x=this.rotationMatrix)[0],N=x[1],H=x[2],j=x[3],re=Math.sin(C),fe=Math.cos(C),_[0]=A*fe+H*re,_[1]=N*fe+j*re,_[2]=A*-re+H*fe,_[3]=N*-re+j*fe)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=l.degToRad(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let _=0,x=0;for(let C=0;C<c.length;C++){const A=new l.Point(c[C][0]*this.width,p+c[C][1]*(this.height-p)),N=i.pointCoordinate(A);if(!N)continue;const H=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);_+=N[3]*H,x+=H}return 0===x?NaN:_/x}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,_=this._mercatorZfromZoom(i),x=this._mercatorZfromZoom(this._maxZoom),C=Math.max(_-p,x);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let p;p=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const _=l.length(l.sub([],this._camera.position,p));return l.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!l.exactEquals(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const p=[i.position.x,i.position.y,i.position.z];l.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new _r;return c.position=new l.MercatorCoordinate(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!l.length$1(i))return!1;l.normalize$1(i,i);const c=l.transformQuat([],[0,0,-1],i),p=l.transformQuat([],[0,-1,0],i);if(p[2]<0)return!1;const _=tr(c,p);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;i[2]=l.clamp(i[2],_/p,_/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,p){this._unmodified=!1,this._edgeInsets.interpolate(i,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new l.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const p=this.pointCoordinate(new l.Point(0,0)),_=this.pointCoordinate(new l.Point(this.width,0)),x=this.pointCoordinate(new l.Point(this.width,this.height)),C=this.pointCoordinate(new l.Point(0,this.height)),A=Math.floor(Math.min(p.x,_.x,x.x,C.x)),N=Math.floor(Math.max(p.x,_.x,x.x,C.x)),H=1;for(let j=A-H;j<=N+H;j++)0!==j&&c.push(new l.UnwrappedTileID(j,i))}return c}coveringTiles(i){let c=this.coveringZoomLevel(i);const p=c,_=this.elevation&&!i.isTerrainDEM,x="mercator"===this.projection.name;if(void 0!==i.minzoom&&c<i.minzoom)return[];void 0!==i.maxzoom&&c>i.maxzoom&&(c=i.maxzoom);const C=this.locationCoordinate(this.center),A=this.center.lat,N=1<<c,H=[N*C.x,N*C.y,0],j="globe"===this.projection.name,re=!j,fe=l.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,re),ye=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ie=N*l.mercatorZfromAltitude(1,this.center.lat),Te=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),Re=[N*ye.x,N*ye.y,Te*(re?1:Ie)],ie=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),ve=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,Ne=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,$e=i.isTerrainDEM?-Ne:this._elevation?this._elevation.getMinElevationBelowMSL():0,pt=this.projection.isReprojectedInTileSpace?Pr(this):1,mt=Jt=>{const $n=new l.MercatorCoordinate(Jt.x+25e-6,Jt.y,Jt.z),kn=new l.MercatorCoordinate(Jt.x,Jt.y+25e-6,Jt.z),Yn=Jt.toLngLat(),Or=$n.toLngLat(),di=kn.toLngLat(),yr=this.locationCoordinate(Yn),Vr=this.locationCoordinate(Or),ki=this.locationCoordinate(di),Di=Math.hypot(Vr.x-yr.x,Vr.y-yr.y),wr=Math.hypot(ki.x-yr.x,ki.y-yr.y);return Math.sqrt(Di*wr)*pt/25e-6},gt=Jt=>{const Cn=Ne,$n=$e;return{aabb:l.tileAABB(this,N,0,0,0,Jt,$n,Cn,this.projection),zoom:0,x:0,y:0,minZ:$n,maxZ:Cn,wrap:Jt,fullyVisible:!1}},Bt=[];let Ft=[];const nn=c,Un=i.reparseOverscaled?p:c,Zt=Jt=>Jt*Jt,wn=Zt((Te-this._centerAltitude)*Ie),ln=Jt=>{if(!this._elevation||!Jt.tileID||!x)return;const Cn=this._elevation.getMinMaxForTile(Jt.tileID),$n=Jt.aabb;Cn?($n.min[2]=Cn.min,$n.max[2]=Cn.max,$n.center[2]=($n.min[2]+$n.max[2])/2):(Jt.shouldSplit=Bn(Jt),Jt.shouldSplit||($n.min[2]=$n.max[2]=$n.center[2]=this._centerAltitude))},Bn=Jt=>{if(Jt.zoom<ve)return!0;if(Jt.zoom===nn)return!1;if(null!=Jt.shouldSplit)return Jt.shouldSplit;const Cn=Jt.aabb.distanceX(Re),$n=Jt.aabb.distanceY(Re);let kn=wn,Yn=1;if(j){kn=Zt(Jt.aabb.distanceZ(Re));const yr=Math.pow(2,Jt.zoom),Vr=l.latFromMercatorY((Jt.y+1)/yr),ki=l.latFromMercatorY(Jt.y/yr),Di=Math.min(Math.max(A,Vr),ki),wr=l.circumferenceAtLatitude(Di)/l.circumferenceAtLatitude(A);if(Yn=Di===A?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,wr/this._mercatorScaleRatio),this.zoom<=l.GLOBE_ZOOM_THRESHOLD_MIN&&Jt.zoom===nn-1&&wr>=.9)return!0}else if(_&&(kn=Zt(Jt.aabb.distanceZ(Re)*Ie)),this.projection.isReprojectedInTileSpace&&p<=5){const yr=Math.pow(2,Jt.zoom),Vr=mt(new l.MercatorCoordinate((Jt.x+.5)/yr,(Jt.y+.5)/yr));Yn=Vr>.85?1:Vr}const Or=Cn*Cn+$n*$n+kn;return Or<Zt((1<<nn-Jt.zoom)*ie*Yn*((yr,Vr)=>{if(Vr*Zt(.707)<yr)return 1;const ki=Math.sqrt(Vr/yr);return ki/(1.4144271570014144+(Math.pow(1.1,ki-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(kn,wn),Or))};if(this.renderWorldCopies)for(let Jt=1;Jt<=3;Jt++)Bt.push(gt(-Jt)),Bt.push(gt(Jt));for(Bt.push(gt(0));Bt.length>0;){const Jt=Bt.pop(),Cn=Jt.x,$n=Jt.y;let kn=Jt.fullyVisible;if(!kn){const Yn=Jt.aabb.intersects(fe);if(0===Yn)continue;kn=2===Yn}if(Jt.zoom!==nn&&Bn(Jt))for(let Yn=0;Yn<4;Yn++){const Or=(Cn<<1)+Yn%2,di=($n<<1)+(Yn>>1),yr={aabb:x?Jt.aabb.quadrant(Yn):l.tileAABB(this,N,Jt.zoom+1,Or,di,Jt.wrap,Jt.minZ,Jt.maxZ,this.projection),zoom:Jt.zoom+1,x:Or,y:di,wrap:Jt.wrap,fullyVisible:kn,tileID:void 0,shouldSplit:void 0,minZ:Jt.minZ,maxZ:Jt.maxZ};_&&!j&&(yr.tileID=new l.OverscaledTileID(Jt.zoom+1===nn?Un:Jt.zoom+1,Jt.wrap,Jt.zoom+1,Or,di),ln(yr)),Bt.push(yr)}else{const Yn=Jt.zoom===nn?Un:Jt.zoom;if(i.minzoom&&i.minzoom>Yn)continue;const Or=H[0]-(.5+Cn+(Jt.wrap<<Jt.zoom))*(1<<c-Jt.zoom),di=H[1]-.5-$n,yr=Jt.tileID?Jt.tileID:new l.OverscaledTileID(Yn,Jt.wrap,Jt.zoom,Cn,$n);Ft.push({tileID:yr,distanceSq:Or*Or+di*di})}}if(this.fogCullDistSq){const Jt=this.fogCullDistSq,Cn=this.horizonLineFromTop();Ft=Ft.filter($n=>{const kn=[0,0,0,1],Yn=[l.EXTENT,l.EXTENT,0,1],Or=this.calculateFogTileMatrix($n.tileID.toUnwrapped());l.transformMat4$1(kn,kn,Or),l.transformMat4$1(Yn,Yn,Or);const di=l.getAABBPointSquareDist(kn,Yn);if(0===di)return!0;let yr=!1;const Vr=this._elevation;if(Vr&&di>Jt&&0!==Cn){const ki=this.calculateProjMatrix($n.tileID.toUnwrapped());let Di;i.isTerrainDEM||(Di=Vr.getMinMaxForTile($n.tileID)),Di||(Di={min:$e,max:Ne});const wr=l.furthestTileCorner(this.rotation),fo=[wr[0]*l.EXTENT,wr[1]*l.EXTENT,Di.max];l.transformMat4(fo,fo,ki),yr=(1-fo[1])*this.height*.5<Cn}return di<Jt||yr})}return Ft.sort((Jt,Cn)=>Jt.distanceSq-Cn.distanceSq).map(Jt=>Jt.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const c=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=this.projection.project(i.lng,c);return new l.Point(p.x*this.worldSize,p.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/l.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,c){let p,_;const x=this.centerPoint;if("globe"===this.projection.name){const A=this.worldSize;p=(c.x-x.x)/A,_=(c.y-x.y)/A}else{const A=this.pointCoordinate(c),N=this.pointCoordinate(x);p=A.x-N.x,_=A.y-N.y}const C=this.locationCoordinate(i);this.setLocation(new l.MercatorCoordinate(C.x-p,C.y-_))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,c){const p=c?l.mercatorZfromAltitude(c,i.lat):void 0,_=this.projection.project(i.lng,i.lat);return new l.MercatorCoordinate(_.x,_.y,p)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const p=c??this._centerAltitude,_=[i.x,i.y,0,1],x=[i.x,i.y,1,1];l.transformMat4$1(_,_,this.pixelMatrixInverse),l.transformMat4$1(x,x,this.pixelMatrixInverse);const C=x[3];l.scale$1(_,_,1/_[3]),l.scale$1(x,x,1/C);const A=_[2],N=x[2];return{p0:_,p1:x,t:A===N?0:(p-A)/(N-A)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],p=[i.x,i.y,1,1];return l.transformMat4$1(c,c,this.pixelMatrixInverse),l.transformMat4$1(p,p,this.pixelMatrixInverse),l.scale$1(c,c,1/c[3]),l.scale$1(p,p,1/p[3]),c[2]=l.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=l.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,l.scale$1(c,c,1/this.worldSize),l.scale$1(p,p,1/this.worldSize),new l.Ray([c[0],c[1],c[2]],l.normalize([],l.sub([],p,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:p,t:_}=i,x=l.mercatorZfromAltitude(c[2],this._center.lat),C=l.mercatorZfromAltitude(p[2],this._center.lat);return new l.MercatorCoordinate(l.number(c[0],p[0],_)/this.worldSize,l.number(c[1],p[1],_)/this.worldSize,l.number(x,C,_))}pointCoordinate(i,c=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,c)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let c=this.projection.pointCoordinate3D(this,i.x,i.y);if(c)return new l.MercatorCoordinate(c[0],c[1],c[2]);let p=0,_=this.horizonLineFromTop();if(i.y>_)return this.pointCoordinate(i);const x=.02*_,C=i.clone();for(let A=0;A<10&&_-p>x;A++){C.y=l.number(p,_,.66);const N=this.projection.pointCoordinate3D(this,C.x,C.y);N?(_=C.y,c=N):p=C.y}return c?new l.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}isPointOnSurface(i){if(i.y<0||i.y>this.height||i.x<0||i.x>this.width)return!1;if(this.elevation||this.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(i);const c=this.pointCoordinate(i);return c.y>=0&&c.y<=1}_coordinatePoint(i,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,_=[i.x*this.worldSize,i.y*this.worldSize,p+i.toAltitude(),1];return l.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new l.Point(_[0]/_[3],_[1]/_[3]):new l.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:c}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,x=this.pointLocation3D(new l.Point(c,i)),C=this.pointLocation3D(new l.Point(_,i)),A=this.pointLocation3D(new l.Point(_,p)),N=this.pointLocation3D(new l.Point(c,p));let H=Math.min(x.lng,C.lng,A.lng,N.lng),j=Math.max(x.lng,C.lng,A.lng,N.lng),re=Math.min(x.lat,C.lat,A.lat,N.lat),fe=Math.max(x.lat,C.lat,A.lat,N.lat);const ye=Math.pow(2,-this.zoom)/16*270,Ie="globe"===this.projection.name?1:4,Te=(Re,ie,ve,Ne,$e)=>{const pt=(Re+ve)/2,mt=(ie+Ne)/2,gt=new l.Point(pt,mt),{lng:Bt,lat:Ft}=this.pointLocation3D(gt),nn=Math.max(0,H-Bt,re-Ft,Bt-j,Ft-fe);H=Math.min(H,Bt),j=Math.max(j,Bt),re=Math.min(re,Ft),fe=Math.max(fe,Ft),($e<Ie||nn>ye)&&(Te(Re,ie,pt,mt,$e+1),Te(pt,mt,ve,Ne,$e+1))};if(Te(c,i,_,i,1),Te(_,i,_,p,1),Te(_,p,c,p,1),Te(c,p,c,i,1),"globe"===this.projection.name){const[Re,ie]=l.polesInViewport(this);Re?(fe=90,j=180,H=-180):ie&&(re=-90,j=180,H=-180)}return new l.LngLatBounds(new l.LngLat(H,re),new l.LngLat(j,fe))}_getBoundsRectangular(i,c){const{top:p,left:_}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,A=new l.Point(_,p),N=new l.Point(C,p),H=new l.Point(C,x),j=new l.Point(_,x);let re=this.pointCoordinate(A,i),fe=this.pointCoordinate(N,i);const ye=this.pointCoordinate(H,c),Ie=this.pointCoordinate(j,c),Te=(Re,ie)=>(ie.y-Re.y)/(ie.x-Re.x);return re.y>1&&fe.y>=0?re=new l.MercatorCoordinate((1-Ie.y)/Te(Ie,re)+Ie.x,1):re.y<0&&fe.y<=1&&(re=new l.MercatorCoordinate(-Ie.y/Te(Ie,re)+Ie.x,0)),fe.y>1&&re.y>=0?fe=new l.MercatorCoordinate((1-ye.y)/Te(ye,fe)+ye.x,1):fe.y<0&&re.y<=1&&(fe=new l.MercatorCoordinate(-ye.y/Te(ye,fe)+ye.x,0)),(new l.LngLatBounds).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(Ie)).extend(this.coordinateLocation(ye))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=i.visibleDemTiles.reduce((p,_)=>{if(_.dem){const x=_.dem.tree;p.min=Math.min(p.min,x.minimums[0]),p.max=Math.max(p.max,x.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-l.MAX_MERCATOR_LATITUDE,this.maxLat=l.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=l.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=l.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=l.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=l.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileMatrix(this,c,i)}calculateDistanceTileData(i){const c=i.key,p=this._distanceTileDataCache;if(p[c])return p[c];const _=i.canonical,x=1/this.height,C=this.cameraWorldSize,A=C/this.zoomScale(_.z),N=(_.x+Math.pow(2,_.z)*i.wrap)*A,H=_.y*A,j=this.point;j.x*=C/this.worldSize,j.y*=C/this.worldSize;const re=this.angle,fe=Math.sin(-re),ye=-Math.cos(-re);return p[c]={bearing:[fe,ye],center:[(j.x-N)*x,(j.y-H)*x],scale:A/l.EXTENT*x},p[c]}calculateFogTileMatrix(i){const c=i.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return l.multiply(_,this.worldToFogMatrix,_),p[c]=new Float32Array(_),p[c]}calculateProjMatrix(i,c=!1){const p=i.key,_=c?this._alignedProjMatrixCache:this._projMatrixCache;if(_[p])return _[p];const x=this.calculatePosMatrix(i,this.worldSize);return l.multiply(x,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,x),_[p]=new Float32Array(x),_[p]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const _=function(x,C){const{scale:A}=x.tileTransform,N=A*l.EXTENT/(x.tileSize*Math.pow(2,C.zoom-x.tileID.overscaledZ+x.tileID.canonical.z));return H=new Float32Array(4),fe=(j=C.inverseAdjustmentMatrix)[1],ye=j[2],Ie=j[3],Re=(re=[N,N])[1],H[0]=j[0]*(Te=re[0]),H[1]=fe*Te,H[2]=ye*Re,H[3]=Ie*Re,H;var H,j,re,fe,ye,Ie,Te,Re}(i,this);return p[c]=_,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const i=1/this.worldSize,c=l.fromScaling([],[i,i,i]);return l.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const c=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),_=this._camera.forward(),x=l.mercatorZfromAltitude(1,this._center.lat);p[2]/=x,_[2]/=x,l.normalize(_,_);const C=i.raycast(p,_,i.exaggeration());if(C){const A=l.scaleAndAdd([],p,_,C),N=new l.MercatorCoordinate(A[0],A[1],l.mercatorZfromAltitude(A[2],l.latFromMercatorY(A[1]))),H=(N.z+l.length([N.x-p[0],N.y-p[1],N.z-p[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const c=this._elevation,p=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(p),x=c.getAtPointOrZero(new l.MercatorCoordinate(..._)),C=this.pixelsPerMeter/this.worldSize*x,A=this._minimumHeightOverTerrain(),N=_[2]-C;if(N<=A)if(N<0||i){const H=this.locationCoordinate(this._center,this._centerAltitude),j=[_[0],_[1],H.z-_[2]],re=l.length(j);j[2]-=(A-N)/this._pixelsPerMercatorPixel;const fe=l.length(j);if(0===fe)return;l.scale$2(j,j,re/fe*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],H.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const fe=this.center;return fe.lat=l.clamp(fe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(fe.lng=l.clamp(fe.lng,this.minLng,this.maxLng)),this.center=fe,void(this._constraining=!1)}const c=this._unmodified,{x:p,y:_}=this.point;let x=0,C=p,A=_;const N=this.width/2,H=this.height/2,j=this.worldMinY*this.scale,re=this.worldMaxY*this.scale;if(_-H<j&&(A=j+H),_+H>re&&(A=re-H),re-j<this.height&&(x=Math.max(x,this.height/(re-j)),A=(re+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const fe=this.worldMinX*this.scale,ye=this.worldMaxX*this.scale,Ie=this.worldSize/2-(fe+ye)/2;C=(p+Ie+this.worldSize)%this.worldSize-Ie,C-N<fe&&(C=fe+N),C+N>ye&&(C=ye-N),ye-fe<this.width&&(x=Math.max(x,this.width/(ye-fe)),C=(ye+fe)/2)}C===p&&A===_||(this.center=this.unproject(new l.Point(C,A))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=l.mercatorZfromAltitude(1,this.center.lat)/l.mercatorZfromAltitude(1,l.GLOBE_SCALE_MATCH_LATITUDE));const p=Bi(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _="meters"===this.projection.zAxisUnit?c:1,x=this._camera.getWorldToCamera(this.worldSize,_),C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);C[8]=2*-i.x/this.width,C[9]=2*i.y/this.height;let A=l.mul([],C,x);if(this.projection.isReprojectedInTileSpace){const mt=this.locationCoordinate(this.center),gt=l.identity([]);l.translate(gt,gt,[mt.x*this.worldSize,mt.y*this.worldSize,0]),l.multiply(gt,gt,Kr(this)),l.translate(gt,gt,[-mt.x*this.worldSize,-mt.y*this.worldSize,0]),l.multiply(A,A,gt),this.inverseAdjustmentMatrix=function(Bt){const Ft=Kr(Bt,!0);return Le([],[Ft[0],Ft[1],Ft[4],Ft[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=l.scale([],A,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=A,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const N=l.invert([],C);this.frustumCorners=l.FrustumCorners.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);l.identity(H),l.scale(H,H,[1,-1,1]),l.rotateX(H,H,this._pitch),l.rotateZ(H,H,this.angle);const j=l.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),re=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;j[8]=2*-i.x/this.width,j[9]=2*(i.y+re)/this.height,this.skyboxMatrix=l.multiply(H,j,H);const fe=this.point,ye=fe.x,Ie=fe.y,Te=this.width%2/2,Re=this.height%2/2,ie=Math.cos(this.angle),ve=Math.sin(this.angle),Ne=ye-Math.round(ye)+ie*Te+ve*Re,$e=Ie-Math.round(Ie)+ie*Re+ve*Te,pt=new Float64Array(A);if(l.translate(pt,pt,[Ne>.5?Ne-1:Ne,$e>.5?$e-1:$e,0]),this.alignedProjMatrix=pt,A=l.create(),l.scale(A,A,[this.width/2,-this.height/2,1]),l.translate(A,A,[1,-1,0]),this.labelPlaneMatrix=A,A=l.create(),l.scale(A,A,[1,-1,1]),l.translate(A,A,[-1,-1,0]),l.scale(A,A,[2/this.width,2/this.height,1]),this.glCoordMatrix=A,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},A=l.invert(new Float64Array(16),this.pixelMatrix),!A)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=A,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=l.calculateGlobeMatrix(this);const mt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=l.transformMat4(mt,mt,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=A;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,p=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,x=[i,i,c];l.scale$2(x,x,_),l.scale$2(p,p,-1),l.multiply$2(p,p,x);const C=l.create();l.translate(C,C,p),l.scale(C,C,x),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,_)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),_=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-p[0]*x,_.y/this.worldSize-p[1]*x,i/this.worldSize*this._centerAltitude-p[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],_=i[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(x=Math.min((c-p)/_,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,i,x),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:_}=this._camera.getPitchBearing(),x=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),A=Math.max((i[2]-x)/Math.cos(p),C),N=this._zoomFromMercatorZ(A);l.scaleAndAdd(i,i,c,A),this._pitch=l.clamp(p,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(_,-Math.PI,Math.PI),this._setZoom(l.clamp(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new l.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){let c=0,p=l.GLOBE_ZOOM_THRESHOLD_MAX,_=0,x=1/0;for(;p-c>1e-6&&p>c;){const C=c+.5*(p-c),A=this.tileSize*Math.pow(2,C),N=this.getCameraToCenterDistance(this.projection,C,A),H=this.scaleZoom(N/(i*this.tileSize)),j=Math.abs(C-H);j<x&&(x=j,_=C),C<H?c=C:p=C}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(l.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,c){const p=Math.min(i.x,c.x),_=Math.max(i.x,c.x),x=Math.min(i.y,c.y),C=Math.max(i.y,c.y);if(x<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const A=[new l.Point(p,x),new l.Point(_,C),new l.Point(p,C),new l.Point(_,x)],N=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const j of A){const re=this.pointRayIntersection(j);if(re.t<0)return!0;const fe=this.rayIntersectionCoordinate(re);if(fe.x<N||fe.y<0||fe.x>H||fe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new l.Point(0,0),new l.Point(this.width,this.height))}zoomDeltaToMovement(i,c){const p=l.length(l.sub([],this._camera.position,i)),_=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(_)}getCameraPoint(){if("globe"===this.projection.name){const i=function([c,p,_],x){const C=[c,p,_,1];l.transformMat4$1(C,C,x);const A=C[3]=Math.max(C[3],1e-6);return C[0]/=A,C[1]/=A,C[2]/=A,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new l.Point(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,i))}}getCameraToCenterDistance(i,c=this.zoom,p=this.worldSize){const _=Bi(i,c,this.width,this.height,1024),x=i.pixelSpaceConversion(this.center.lat,p,_);return.5/Math.tan(.5*this._fov)*this.height*x}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&l.multiply(i,i,this.globeMatrix),i}}function ho(h,i){let c=!1,p=null;const _=()=>{p=null,c&&(h(),p=setTimeout(_,i),c=!1)};return()=>(c=!0,p||_(),p)}class Yi{constructor(i){this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ho(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),l.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const c=zs(i);if(this._hashName){const p=this._hashName;let _=!1;const x=l.window.location.hash.slice(1).split("&").map(C=>{const A=C.split("=")[0];return A===p?(_=!0,`${A}=${c}`):C}).filter(C=>C);return _||x.push(`${p}=${c}`),`#${x.join("&")}`}return`#${c}`}_getCurrentHash(){const i=l.window.location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){const p=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(c[3]||0):i.getBearing();return i.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,i)}}function zs(h,i){const c=h.getCenter(),p=Math.round(100*h.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),C=Math.round(c.lng*x)/x,A=Math.round(c.lat*x)/x,N=h.getBearing(),H=h.getPitch();let j=i?`/${C}/${A}/${p}`:`${p}/${A}/${C}`;return(N||H)&&(j+="/"+Math.round(10*N)/10),H&&(j+=`/${Math.round(H)}`),j}const Ao={linearity:.3,easing:l.bezier(0,0,.3,1)},wc=l.extend({deceleration:2500,maxSpeed:1400},Ao),pa=l.extend({deceleration:20,maxSpeed:1400},Ao),cr=l.extend({deceleration:1e3,maxSpeed:360},Ao),Pa=l.extend({deceleration:1e3,maxSpeed:90},Ao);class Ec{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=l.exported.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)c.zoom+=x.zoomDelta||0,c.bearing+=x.bearingDelta||0,c.pitch+=x.pitchDelta||0,x.panDelta&&c.pan._add(x.panDelta),x.around&&(c.around=x.around),x.pinchAround&&(c.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const x=tc(c.pan.mag(),p,l.extend({},wc,i||{}));_.offset=c.pan.mult(x.amount/c.pan.mag()),_.center=this._map.transform.center,Rl(_,x)}if(c.zoom){const x=tc(c.zoom,p,pa);_.zoom=this._map.transform.zoom+x.amount,Rl(_,x)}if(c.bearing){const x=tc(c.bearing,p,cr);_.bearing=this._map.transform.bearing+l.clamp(x.amount,-179,179),Rl(_,x)}if(c.pitch){const x=tc(c.pitch,p,Pa);_.pitch=this._map.transform.pitch+x.amount,Rl(_,x)}if(_.zoom||_.bearing){const x=void 0===c.pinchAround?c.around:c.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Rl(h,i){(!h.duration||h.duration<i.duration)&&(h.duration=i.duration,h.easing=i.easing)}function tc(h,i,c){const{maxSpeed:p,linearity:_,deceleration:x}=c,C=l.clamp(h*_/(i/1e3),-p,p),A=Math.abs(C)/(x*_);return{easing:c.easing,duration:1e3*A,amount:C*(A/2)}}class $s extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p,_={}){const x=st(c.getCanvasContainer(),p),C=c.unproject(x);super(i,l.extend({point:x,lngLat:C,originalEvent:p},_)),this._defaultPrevented=!1,this.target=c}}class ri extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){const _="touchend"===i?p.changedTouches:p.touches,x=sn(c.getCanvasContainer(),_),C=x.map(N=>c.unproject(N)),A=x.reduce((N,H,j,re)=>N.add(H.div(re.length)),new l.Point(0,0));super(i,{points:x,point:A,lngLats:C,lngLat:c.unproject(A),originalEvent:p}),this._defaultPrevented=!1}}class Ol extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){super(i,{originalEvent:p}),this._defaultPrevented=!1}}class yd{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new Ol(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new $s(i.type,this._map,i))}mouseup(i){this._map.fire(new $s(i.type,this._map,i))}preclick(i){const c=l.extend({},i);c.type="preclick",this._map.fire(new $s(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new $s(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new $s(i.type,this._map,i))}mouseover(i){this._map.fire(new $s(i.type,this._map,i))}mouseout(i){this._map.fire(new $s(i.type,this._map,i))}touchstart(i){return this._firePreventable(new ri(i.type,this._map,i))}touchmove(i){this._map.fire(new ri(i.type,this._map,i))}touchend(i){this._map.fire(new ri(i.type,this._map,i))}touchcancel(i){this._map.fire(new ri(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nc{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new $s(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $s("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new $s(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $a{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&0===i.button&&(et(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const p=c,_=this._startPos,x=this._lastPos;if(!_||!x||x.equals(p)||!this._box&&p.dist(_)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=vt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const C=Math.min(_.x,p.x),A=Math.max(_.x,p.x),N=Math.min(_.y,p.y),H=Math.max(_.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${N}px)`,this._box.style.width=A-C+"px",this._box.style.height=H-N+"px")})}mouseupWindow(i,c){if(!this._active)return;const p=this._startPos,_=c;if(p&&0===i.button){if(this.reset(),It(),p.x!==_.x||p.y!==_.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:x=>x.fitScreenCoordinates(p,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),xt(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new l.Event(i,{originalEvent:c}))}}function Dc(h,i){const c={};for(let p=0;p<h.length;p++)c[h[p].identifier]=i[p];return c}class kl{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const x=new l.Point(0,0);for(const C of _)x._add(C);return x.div(_.length)}(c),this.touches=Dc(p,c)))}touchmove(i,c,p){if(this.aborted||!this.centroid)return;const _=Dc(p,c);for(const x in this.touches){const C=_[x];(!C||C.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(i,c,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class bl{constructor(i){this.singleTap=new kl(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,c,p){this.singleTap.touchstart(i,c,p)}touchmove(i,c,p){this.singleTap.touchmove(i,c,p)}touchend(i,c,p){const _=this.singleTap.touchend(i,c,p);if(_){const x=i.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(_)<30;if(x&&C||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class hh{constructor(){this._zoomIn=new bl({numTouches:1,numTaps:2}),this._zoomOut=new bl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,p){this._zoomIn.touchstart(i,c,p),this._zoomOut.touchstart(i,c,p)}touchmove(i,c,p){this._zoomIn.touchmove(i,c,p),this._zoomOut.touchmove(i,c,p)}touchend(i,c,p){const _=this._zoomIn.touchend(i,c,p),x=this._zoomOut.touchend(i,c,p);return _?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(_)},{originalEvent:i})}):x?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(x)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ru={0:1,2:2};class wl{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const p=Tt(i);this._correctButton(i,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(i,c){const p=this._lastPoint;if(p)if(i.preventDefault(),null!=this._eventButton&&function(_,x){const C=ru[x];return void 0===_.buttons||(_.buttons&C)!==C}(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}mouseupWindow(i){this._lastPoint&&Tt(i)===this._eventButton&&(this._moved&&It(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rc extends wl{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return 0===c&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class iu extends wl{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const p=.8*(c.x-i.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(i){i.preventDefault()}}class Vn extends wl{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const p=-.5*(c.y-i.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(i){i.preventDefault()}}class Zi{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),l.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)}touchstart(i,c,p){return this._calculateTransform(i,c,p)}touchmove(i,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===p.length&&!l.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,c,p)}}touchend(i,c,p){this._calculateTransform(i,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,p){p.length>0&&(this._active=!0);const _=Dc(p,c),x=new l.Point(0,0),C=new l.Point(0,0);let A=0;for(const H in _){const j=_[H],re=this._touches[H];re&&(x._add(j),C._add(j.sub(re)),A++,_[H]=j)}if(this._touches=_,A<this._minTouches||!C.mag())return;const N=C.div(A);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(A),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=vt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class El{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,c,p){return{}}touchstart(i,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,p){const _=this._firstTwoTouches;if(!_)return;i.preventDefault();const[x,C]=_,A=Ll(p,c,x),N=Ll(p,c,C);if(!A||!N)return;const H=this._aroundCenter?null:A.add(N).div(2);return this._move([A,N],H,i)}touchend(i,c,p){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,C=Ll(p,c,_),A=Ll(p,c,x);C&&A||(this._active&&It(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ll(h,i,c){for(let p=0;p<h.length;p++)if(h[p].identifier===c)return i[p]}function Vs(h,i){return Math.log(h/i)/Math.LN2}class Mu extends El{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Vs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Vs(this._distance,p),pinchAround:c}}}function Fl(h,i){return 180*h.angleWith(i)/Math.PI}class Ra extends El{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const p=this._vector;if(this._vector=i[0].sub(i[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Fl(this._vector,p),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const _=Fl(i,p);return Math.abs(_)<c}}function Za(h){return Math.abs(h.y)>Math.abs(h.x)}class ic extends El{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Za(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,p){const _=this._lastPoints;if(!_)return;const x=i[0].sub(_[0]),C=i[1].sub(_[1]);return this._map._cooperativeGestures&&!l.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(x,C,p.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(x.y+C.y)/2*-.5})}gestureBeginsVertically(i,c,p){if(void 0!==this._valid)return this._valid;const _=i.mag()>=2,x=c.mag()>=2;if(!_&&!x)return;if(!_||!x)return null==this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const C=i.y>0==c.y>0;return Za(i)&&Za(c)&&C}}const Au={panStep:100,bearingStep:15,pitchStep:10};class fh{constructor(){const i=Au;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,p=0,_=0,x=0,C=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),x=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),x=1);break;case 38:i.shiftKey?_=1:(i.preventDefault(),C=-1);break;case 40:i.shiftKey?_=-1:(i.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:A=>{const N=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:ou,zoom:c?Math.round(N)+c*(i.shiftKey?2:1):N,bearing:A.getBearing()+p*this._bearingStep,pitch:A.getPitch()+_*this._pitchStep,offset:[-x*this._panStep,-C*this._panStep],center:A.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ou(h){return h*(2-h)}const qs=4.000244140625;class Va{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||l.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const p=l.exported.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==c&&c%qs==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=st(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;"wheel"===this._type&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const N="wheel"===this._type&&Math.abs(this._delta)>qs?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&0!==H&&(H=1/H);const j=c(),re=Math.pow(2,j),fe="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):re;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(fe*H))),"wheel"===this._type&&(this._startZoom=j,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:c(),_=this._startZoom,x=this._easing;let C,A=!1;if("wheel"===this._type&&_&&x){const N=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),H=x(N);C=l.number(_,p,H),N<1?this._frameId||(this._frameId=!0):A=!0}else C=p,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!A,zoomDelta:C-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=l.ease;if(this._prevEase){const p=this._prevEase,_=(l.exported.now()-p.start)/p.duration,x=p.easing(_+.01)-p.easing(_),C=.27/Math.sqrt(x*x+1e-4)*.01,A=Math.sqrt(.0729-C*C);c=l.bezier(C,A,.25,1)}return this._prevEase={start:l.exported.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=vt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(l.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class su{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(i.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xa{constructor(){this._tap=new bl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,c,p){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(i,c,p))}touchmove(i,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=c[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,i.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(i,c,p)}touchend(i,c,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(i,c,p)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class au{constructor(i,c,p){this._el=i,this._mousePan=c,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Pu{constructor(i,c,p){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ph{constructor(i,c,p,_){this._el=i,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Oa=h=>h.zoom||h.drag||h.pitch||h.rotate;class lu extends l.Event{}class Ru{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const p=l.sub([],c,i);this.radius=l.length(p[2]<0?l.div([],p,this.constants):[p[0],p[1],0])}projectRay(i){l.div(i,i,this.constants),l.normalize(i,i),l.mul$1(i,i,this.constants);const c=l.scale$2([],i,this.radius);if(c[2]>0){const p=l.scale$2([],[0,0,1],l.dot(c,[0,0,1])),_=l.scale$2([],l.normalize([],[c[0],c[1],0]),this.radius),x=l.add([],c,l.scale$2([],l.sub([],l.add([],_,p),c),2));c[0]=x[0],c[1]=x[1]}return c}}function ka(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class La{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ec(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ru,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),l.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[_,x,C]of this._listeners)_.addEventListener(x,_===l.window.document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[i,c,p]of this._listeners)i.removeEventListener(c,i===l.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(i){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new yd(c,i));const _=c.boxZoom=new $a(c,i);this._add("boxZoom",_);const x=new hh,C=new fs;c.doubleClickZoom=new su(C,x),this._add("tapZoom",x),this._add("clickZoom",C);const A=new Xa;this._add("tapDragZoom",A);const N=c.touchPitch=new ic(c);this._add("touchPitch",N);const H=new iu(i),j=new Vn(i);c.dragRotate=new Pu(i,H,j),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const re=new rc(i),fe=new Zi(c,i);c.dragPan=new au(p,re,fe),this._add("mousePan",re),this._add("touchPan",fe,["touchZoom","touchRotate"]);const ye=new Ra,Ie=new Mu;c.touchZoomRotate=new ph(p,Ie,ye,A),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",Ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new nc(c));const Te=c.scrollZoom=new Va(c,this);this._add("scrollZoom",Te,["mousePan"]);const Re=c.keyboard=new fh;this._add("keyboard",Re);for(const ie of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[ie]&&c[ie].enable(i[ie])}_add(i,c,p){this._handlers.push({handlerName:i,handler:c,allowed:p}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Oa(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,c,p){for(const _ in i)if(_!==p&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const p of i)this._el.contains(p.target)&&c.push(p);return c}handleEvent(i,c){this._updatingCamera=!0;const p="renderFrame"===i.type,_=p?void 0:i,x={needsRenderFrame:!1},C={},A={},N=i.touches?this._getMapTouches(i.touches):void 0,H=N?sn(this._el,N):p?void 0:st(this._el,i);for(const{handlerName:fe,handler:ye,allowed:Ie}of this._handlers){if(!ye.isEnabled())continue;let Te;this._blockedByActive(A,Ie,fe)?ye.reset():ye[c||i.type]&&(Te=ye[c||i.type](i,H,N),this.mergeHandlerResult(x,C,Te,fe,_),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()),(Te||ye.isActive())&&(A[fe]=ye)}const j={};for(const fe in this._previousActiveHandlers)A[fe]||(j[fe]=_);this._previousActiveHandlers=A,(Object.keys(j).length||ka(x))&&(this._changes.push([x,C,j]),this._triggerRenderFrame()),(Object.keys(A).length||ka(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=x;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))}mergeHandlerResult(i,c,p,_,x){if(!p)return;l.extend(i,p);const C={handlerName:_,originalEvent:p.originalEvent||x};void 0!==p.zoomDelta&&(c.zoom=C),void 0!==p.panDelta&&(c.drag=C),void 0!==p.pitchDelta&&(c.pitch=C),void 0!==p.bearingDelta&&(c.rotate=C)}_applyChanges(){const i={},c={},p={};for(const[_,x,C]of this._changes)_.panDelta&&(i.panDelta=(i.panDelta||new l.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+_.pitchDelta),void 0!==_.around&&(i.around=_.around),void 0!==_.aroundCoord&&(i.aroundCoord=_.aroundCoord),void 0!==_.pinchAround&&(i.pinchAround=_.pinchAround),_.noInertia&&(i.noInertia=_.noInertia),l.extend(c,x),l.extend(p,C);this._updateMapTransform(i,c,p),this._changes=[]}_updateMapTransform(i,c,p){const _=this._map,x=_.transform,C=ve=>[ve.x,ve.y,ve.z];if((ve=>{const Ne=this._eventsInProgress.drag;return Ne&&!this._handlersById[Ne.handlerName].isActive()})()&&!ka(i)){const ve=x.zoom;x.cameraElevationReference="sea",x.recenterOnTerrain(),x.cameraElevationReference="ground",ve!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&_._stop(!0),!ka(i))return void this._fireEvents(c,p,!0);let{panDelta:A,zoomDelta:N,bearingDelta:H,pitchDelta:j,around:re,aroundCoord:fe,pinchAround:ye}=i;x._isCameraConstrained&&(N>0&&(N=0),x._isCameraConstrained=!1),void 0!==ye&&(re=ye),(N||(ve=>c.drag&&!this._eventsInProgress.drag)())&&re&&(this._dragOrigin=C(x.pointCoordinate3D(re)),this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",_._stop(!0),re=re||_.transform.centerPoint,H&&(x.bearing+=H),j&&(x.pitch+=j),x._updateCameraState();const Ie=[0,0,0];if(A)if("mercator"===x.projection.name){const ve=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(re).dir),Ne=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(re.sub(A)).dir);Ie[0]=Ne[0]-ve[0],Ie[1]=Ne[1]-ve[1]}else{const ve=x.pointCoordinate(re);if("globe"===x.projection.name){A=A.rotate(-x.angle);const Ne=x._pixelsPerMercatorPixel/x.worldSize;Ie[0]=-A.x*l.mercatorScale(l.latFromMercatorY(ve.y))*Ne,Ie[1]=-A.y*l.mercatorScale(x.center.lat)*Ne}else{const Ne=x.pointCoordinate(re.sub(A));ve&&Ne&&(Ie[0]=Ne.x-ve.x,Ie[1]=Ne.y-ve.y)}}const Te=x.zoom,Re=[0,0,0];if(N){const ve=C(fe||x.pointCoordinate3D(re)),Ne={dir:l.normalize([],l.sub([],ve,x._camera.position))};if(Ne.dir[2]<0){const $e=x.zoomDeltaToMovement(ve,N);l.scale$2(Re,Ne.dir,$e)}}const ie=l.add(Ie,Ie,Re);x._translateCameraConstrained(ie),N&&Math.abs(x.zoom-Te)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,p,!0)}_fireEvents(i,c,p){const _=Oa(this._eventsInProgress),x=Oa(i),C={};for(const j in i){const{originalEvent:re}=i[j];this._eventsInProgress[j]||(C[`${j}start`]=re),this._eventsInProgress[j]=i[j]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const j in C)this._fireEvent(j,C[j]);x&&this._fireEvent("move",x.originalEvent);for(const j in i){const{originalEvent:re}=i[j];this._fireEvent(j,re)}const A={};let N;for(const j in this._eventsInProgress){const{handlerName:re,originalEvent:fe}=this._eventsInProgress[j];this._handlersById[re].isActive()||(delete this._eventsInProgress[j],N=c[re]||fe,A[`${j}end`]=N)}for(const j in A)this._fireEvent(j,A[j]);const H=Oa(this._eventsInProgress);if(p&&(_||x)&&!H){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=fe=>0!==fe&&-this._bearingSnap<fe&&fe<this._bearingSnap;j?(re(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:N})):(this._map.fire(new l.Event("moveend",{originalEvent:N})),re(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new l.Event(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new lu("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const R="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class B extends l.Evented{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=!1!==c.respectPrefersReducedMotion,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,p){return i=l.Point.convert(i).mult(-1),this.panTo(this.transform.center,l.extend({offset:i},c),p)}panTo(i,c,p){return this.easeTo(l.extend({center:i},c),p)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,p){return this.easeTo(l.extend({zoom:i},c),p)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,p){return this.easeTo(l.extend({bearing:i},c),p)}resetNorth(i,c){return this.rotateTo(0,l.extend({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=l.LngLatBounds.convert(i);const p=c&&c.bearing||0,_=c&&c.pitch||0,x=i.getNorthWest(),C=i.getSouthEast();return this._cameraForBounds(this.transform,x,C,p,_,c)}_extendCameraOptions(i){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=l.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const p=i.padding;i.padding={top:p,bottom:p,right:p,left:p}}return i.padding=l.extend(c,i.padding),i}_minimumAABBFrustumDistance(i,c){const p=c.max[0]-c.min[0],_=c.max[1]-c.min[1];return p/_>i.aspect?p/(2*Math.tan(.5*i.fovX)*i.aspect):_/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,c,p,_,x,C){const A=i.clone(),N=this._extendCameraOptions(C);A.bearing=_,A.pitch=x;const H=l.LngLat.convert(c),j=l.LngLat.convert(p),re=.5*(H.lat+j.lat),fe=.5*(H.lng+j.lng),ye=l.latLngToECEF(re,fe),Ie=l.normalize([],ye),Te=l.normalize([],l.cross([],Ie,[0,1,0])),Re=l.cross([],Te,Ie),ie=[Te[0],Te[1],Te[2],0,Re[0],Re[1],Re[2],0,Ie[0],Ie[1],Ie[2],0,0,0,0,1],ve=[ye,l.latLngToECEF(H.lat,H.lng),l.latLngToECEF(j.lat,H.lng),l.latLngToECEF(j.lat,j.lng),l.latLngToECEF(H.lat,j.lng),l.latLngToECEF(re,H.lng),l.latLngToECEF(re,j.lng),l.latLngToECEF(H.lat,fe),l.latLngToECEF(j.lat,fe)];let Ne=l.Aabb.fromPoints(ve.map(kn=>[l.dot(Te,kn),l.dot(Re,kn),l.dot(Ie,kn)]));const $e=l.transformMat4([],Ne.center,ie);0===l.squaredLength($e)&&l.set($e,0,0,1),l.normalize($e,$e),l.scale$2($e,$e,l.GLOBE_RADIUS),A.center=l.ecefToLatLng($e);const pt=A.getWorldToCameraMatrix(),mt=l.invert(new Float64Array(16),pt);Ne=l.Aabb.applyTransform(Ne,l.multiply([],pt,ie)),l.transformMat4($e,$e,pt);const gt=.5*(Ne.max[2]-Ne.min[2]),Bt=this._minimumAABBFrustumDistance(A,Ne),Ft=l.scale$2([],[0,0,1],gt),nn=l.add(Ft,$e,Ft),Un=Bt+(0===A.pitch?0:l.distance($e,nn)),Zt=A.globeCenterInViewSpace,wn=l.sub([],$e,[Zt[0],Zt[1],Zt[2]]);l.normalize(wn,wn),l.scale$2(wn,wn,Un);const ln=l.add([],$e,wn);l.transformMat4(ln,ln,mt);const Bn=l.earthRadius/l.GLOBE_RADIUS,Jt=l.length(ln),Cn=l.mercatorZfromAltitude(Math.max(Jt*Bn-l.earthRadius,Number.EPSILON),0),$n=Math.min(A.zoomFromMercatorZAdjusted(Cn),N.maxZoom);return $n>.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(A.setProjection({name:"mercator"}),A.zoom=$n,this._cameraForBounds(A,c,p,_,x,C)):{center:A.center,zoom:$n,bearing:_,pitch:x}}queryTerrainElevation(i,c){const p=this.transform.elevation;return p?(c=l.extend({},{exaggerated:!0},c),p.getAtPoint(l.MercatorCoordinate.fromLngLat(i),null,c.exaggerated)):null}_cameraForBounds(i,c,p,_,x,C){if("globe"===i.projection.name)return this._cameraForBoundsOnGlobe(i,c,p,_,x,C);const A=i.clone(),N=this._extendCameraOptions(C),H=A.padding;A.bearing=_,A.pitch=x;const j=l.LngLat.convert(c),re=l.LngLat.convert(p),fe=new l.LngLat(j.lng,re.lat),ye=new l.LngLat(re.lng,j.lat),Ie=A.project(j),Te=A.project(re),Re=this.queryTerrainElevation(j),ie=this.queryTerrainElevation(re),ve=this.queryTerrainElevation(fe),Ne=this.queryTerrainElevation(ye),$e=[[Ie.x,Ie.y,Math.min(Re||0,ie||0,ve||0,Ne||0)],[Te.x,Te.y,Math.max(Re||0,ie||0,ve||0,Ne||0)]];let pt=l.Aabb.fromPoints($e);const mt=A.getWorldToCameraMatrix(),gt=l.invert(new Float64Array(16),mt);pt=l.Aabb.applyTransform(pt,mt);const Bt=l.sub([],pt.max,pt.min),Ft=H.left||0,nn=H.right||0,Un=H.bottom||0,Zt=H.top||0,{left:wn,right:ln,top:Bn,bottom:Jt}=N.padding,Cn=.5*(Ft+nn),$n=.5*(Zt+Un),kn=Math.min(A.scaleZoom(A.scale*Math.min((A.width-(Ft+nn+wn+ln))/Bt[0],(A.height-(Un+Zt+Jt+Bn))/Bt[1])),N.maxZoom),Yn=A.scale/A.zoomScale(kn);pt=new l.Aabb([pt.min[0]-(wn+Cn)*Yn,pt.min[1]-(Jt+$n)*Yn,pt.min[2]],[pt.max[0]+(ln+Cn)*Yn,pt.max[1]+(Bn+$n)*Yn,pt.max[2]]);const Or=.5*Bt[2],di=this._minimumAABBFrustumDistance(A,pt),yr=[0,0,1,0];l.transformMat4$1(yr,yr,mt),l.normalize$2(yr,yr);const Vr=l.scale$2([],yr,di+Or),ki=l.add([],pt.center,Vr),Di=("number"==typeof N.offset.x&&"number"==typeof N.offset.y?new l.Point(N.offset.x,N.offset.y):l.Point.convert(N.offset)).rotate(-l.degToRad(_));pt.center[0]-=Di.x*Yn,pt.center[1]+=Di.y*Yn,l.transformMat4(pt.center,pt.center,gt),l.transformMat4(ki,ki,gt);const wr=[pt.center[0],pt.center[1],ki[2]*A.pixelsPerMeter];l.scale$2(wr,wr,1/A.worldSize);const fo=l.lngFromMercatorX(wr[0]),Do=l.latFromMercatorY(wr[1]),Co=Math.min(A._zoomFromMercatorZ(wr[2]),N.maxZoom),oo=new l.LngLat(fo,Do);return A.mercatorFromTransition&&Co<.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(A.setProjection({name:"globe"}),A.zoom=Co,this._cameraForBounds(A,c,p,_,x,C)):{center:oo,zoom:Co,bearing:_,pitch:x}}fitBounds(i,c,p){const _=this.cameraForBounds(i,c);return this._fitInternal(_,c,p)}fitScreenCoordinates(i,c,p,_,x){const C=l.Point.convert(i),A=l.Point.convert(c),N=new l.Point(Math.min(C.x,A.x),Math.min(C.y,A.y)),H=new l.Point(Math.max(C.x,A.x),Math.max(C.y,A.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(C,A))return this;const j=this.transform.pointLocation3D(N),re=this.transform.pointLocation3D(H),fe=this.transform.pointLocation3D(new l.Point(N.x,H.y)),ye=this.transform.pointLocation3D(new l.Point(H.x,N.y)),Ie=[Math.min(j.lng,re.lng,fe.lng,ye.lng),Math.min(j.lat,re.lat,fe.lat,ye.lat)],Te=[Math.max(j.lng,re.lng,fe.lng,ye.lng),Math.max(j.lat,re.lat,fe.lat,ye.lat)],Re=_&&_.pitch?_.pitch:this.getPitch(),ie=this._cameraForBounds(this.transform,Ie,Te,p,Re,_);return this._fitInternal(ie,_,x)}_fitInternal(i,c,p){return i?(delete(c=l.extend(i,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(i,c){this.stop();const p=i.preloadOnly?this.transform.clone():this.transform;let _=!1,x=!1,C=!1;return"zoom"in i&&p.zoom!==+i.zoom&&(_=!0,p.zoom=+i.zoom),void 0!==i.center&&(p.center=l.LngLat.convert(i.center)),"bearing"in i&&p.bearing!==+i.bearing&&(x=!0,p.bearing=+i.bearing),"pitch"in i&&p.pitch!==+i.pitch&&(C=!0,p.pitch=+i.pitch),null==i.padding||p.isPaddingEqual(i.padding)||(p.padding=i.padding),i.preloadOnly?(this._preloadTiles(p),this):(this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),_&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),x&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),C&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||l.warnOnce(R),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return l.warnOnce(R),this;this.stop();const _=p.zoom,x=p.pitch,C=p.bearing;p.setFreeCameraOptions(i);const A=_!==p.zoom,N=x!==p.pitch,H=C!==p.bearing;return this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),A&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),H&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),N&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),(!1===(i=l.extend({offset:[0,0],duration:500,easing:l.ease},i)).animate||this._prefersReducedMotion(i))&&(i.duration=0);const p=this.transform,_=this.getZoom(),x=this.getBearing(),C=this.getPitch(),A=this.getPadding(),N="zoom"in i?+i.zoom:_,H="bearing"in i?this._normalizeBearing(i.bearing,x):x,j="pitch"in i?+i.pitch:C,re="padding"in i?i.padding:p.padding,fe=l.Point.convert(i.offset);let ye,Ie,Te;if("globe"===p.projection.name){const Ft=l.MercatorCoordinate.fromLngLat(p.center),nn=fe.rotate(-p.angle);Ft.x+=nn.x/p.worldSize,Ft.y+=nn.y/p.worldSize;const Un=Ft.toLngLat(),Zt=l.LngLat.convert(i.center||Un);this._normalizeCenter(Zt),ye=p.centerPoint.add(nn),Ie=new l.Point(Ft.x,Ft.y).mult(p.worldSize),Te=new l.Point(l.mercatorXfromLng(Zt.lng),l.mercatorYfromLat(Zt.lat)).mult(p.worldSize).sub(Ie)}else{ye=p.centerPoint.add(fe);const Ft=p.pointLocation(ye),nn=l.LngLat.convert(i.center||Ft);this._normalizeCenter(nn),Ie=p.project(Ft),Te=p.project(nn).sub(Ie)}const Re=p.zoomScale(N-_);let ie,ve;i.around&&(ie=l.LngLat.convert(i.around),ve=p.locationPoint(ie));const Ne=this._zooming||N!==_,$e=this._rotating||x!==H,pt=this._pitching||j!==C,mt=!p.isPaddingEqual(re),gt=Ft=>nn=>{if(Ne&&(Ft.zoom=l.number(_,N,nn)),$e&&(Ft.bearing=l.number(x,H,nn)),pt&&(Ft.pitch=l.number(C,j,nn)),mt&&(Ft.interpolatePadding(A,re,nn),ye=Ft.centerPoint.add(fe)),ie)Ft.setLocationAtPoint(ie,ve);else{const Un=Ft.zoomScale(Ft.zoom-_),Zt=N>_?Math.min(2,Re):Math.max(.5,Re),wn=Math.pow(Zt,1-nn),ln=Ft.unproject(Ie.add(Te.mult(nn*wn)).mult(Un));Ft.setLocationAtPoint(Ft.renderWorldCopies?ln.wrap():ln,ye)}return i.preloadOnly||this._fireMoveEvents(c),Ft};if(i.preloadOnly){const Ft=this._emulate(gt,i.duration,p);return this._preloadTiles(Ft),this}const Bt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ne,this._rotating=$e,this._pitching=pt,this._padding=mt,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,Bt),this._ease(gt(p),Ft=>{p.recenterOnTerrain(),this._afterEase(c,Ft)},i),this}_prepareEase(i,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new l.Event("movestart",i)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new l.Event("move",i)),this._zooming&&this.fire(new l.Event("zoom",i)),this._rotating&&this.fire(new l.Event("rotate",i)),this._pitching&&this.fire(new l.Event("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",i)),_&&this.fire(new l.Event("rotateend",i)),x&&this.fire(new l.Event("pitchend",i)),this.fire(new l.Event("moveend",i))}flyTo(i,c){if(this._prefersReducedMotion(i)){const kn=l.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(kn,c)}this.stop(),i=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},i);const p=this.transform,_=this.getZoom(),x=this.getBearing(),C=this.getPitch(),A=this.getPadding(),N="zoom"in i?l.clamp(+i.zoom,p.minZoom,p.maxZoom):_,H="bearing"in i?this._normalizeBearing(i.bearing,x):x,j="pitch"in i?+i.pitch:C,re="padding"in i?i.padding:p.padding,fe=p.zoomScale(N-_),ye=l.Point.convert(i.offset);let Ie=p.centerPoint.add(ye);const Te=p.pointLocation(Ie),Re=l.LngLat.convert(i.center||Te);this._normalizeCenter(Re);const ie=p.project(Te),ve=p.project(Re).sub(ie);let Ne=i.curve;const $e=Math.max(p.width,p.height),pt=$e/fe,mt=ve.mag();if("minZoom"in i){const kn=l.clamp(Math.min(i.minZoom,_,N),p.minZoom,p.maxZoom),Yn=$e/p.zoomScale(kn-_);Ne=Math.sqrt(Yn/mt*2)}const gt=Ne*Ne;function Bt(kn){const Yn=(pt*pt-$e*$e+(kn?-1:1)*gt*gt*mt*mt)/(2*(kn?pt:$e)*gt*mt);return Math.log(Math.sqrt(Yn*Yn+1)-Yn)}function Ft(kn){return(Math.exp(kn)-Math.exp(-kn))/2}function nn(kn){return(Math.exp(kn)+Math.exp(-kn))/2}const Un=Bt(0);let Zt=function(kn){return nn(Un)/nn(Un+Ne*kn)},wn=function(kn){return $e*((nn(Un)*(Ft(Yn=Un+Ne*kn)/nn(Yn))-Ft(Un))/gt)/mt;var Yn},ln=(Bt(1)-Un)/Ne;if(Math.abs(mt)<1e-6||!isFinite(ln)){if(Math.abs($e-pt)<1e-6)return this.easeTo(i,c);const kn=pt<$e?-1:1;ln=Math.abs(Math.log(pt/$e))/Ne,wn=function(){return 0},Zt=function(Yn){return Math.exp(kn*Ne*Yn)}}i.duration="duration"in i?+i.duration:1e3*ln/("screenSpeed"in i?+i.screenSpeed/Ne:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Bn=x!==H,Jt=j!==C,Cn=!p.isPaddingEqual(re),$n=kn=>Yn=>{const Or=Yn*ln,di=1/Zt(Or);kn.zoom=1===Yn?N:_+kn.scaleZoom(di),Bn&&(kn.bearing=l.number(x,H,Yn)),Jt&&(kn.pitch=l.number(C,j,Yn)),Cn&&(kn.interpolatePadding(A,re,Yn),Ie=kn.centerPoint.add(ye));const yr=1===Yn?Re:kn.unproject(ie.add(ve.mult(wn(Or))).mult(di));return kn.setLocationAtPoint(kn.renderWorldCopies?yr.wrap():yr,Ie),kn._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(c),kn};if(i.preloadOnly){const kn=this._emulate($n,i.duration,p);return this._preloadTiles(kn),this}return this._zooming=!0,this._rotating=Bn,this._pitching=Jt,this._padding=Cn,this._prepareEase(c,!1),this._ease($n(p),()=>this._afterEase(c),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!i){const p=this.handlers;p&&p.stop(!1)}return this}_ease(i,c,p){!1===p.animate||0===p.duration?(i(1),c()):(this._easeStart=l.exported.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=l.wrap(i,-180,180);const p=Math.abs(i-c);return Math.abs(i-360-c)<p&&(i-=360),Math.abs(i+360-c)<p&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=i.lng-c.center.lng;i.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(i){return this._respectPrefersReducedMotion&&l.exported.prefersReducedMotion&&!(i&&i.essential)}_emulate(i,c,p){const _=Math.ceil(15*c/1e3),x=[],C=i(p.clone());for(let A=0;A<=_;A++){const N=C(A/_);x.push(N.clone())}return x}}class ${constructor(i={}){this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact;return this._map=i,this._container=vt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=vt("button","mapboxgl-ctrl-attrib-button",this._container),vt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=vt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,c){const p=this._map._getUIString(`AttributionControl.${c}`);i.setAttribute("aria-label",p),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){const p=c.reduce((_,x,C)=>(x.value&&(_+=`${x.key}=${x.value}${C<c.length-1?"&":""}`),_),"?");i.href=`${l.config.FEEDBACK_URL}/${p}#${zs(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style._sourceCaches;for(const _ in c){const x=c[_];if(x.used){const C=x.getSource();C.attribution&&i.indexOf(C.attribution)<0&&i.push(C.attribution)}}i.sort((_,x)=>_.length-x.length),i=i.filter((_,x)=>{for(let C=x+1;C<i.length;C++)if(i[C].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class L{constructor(){l.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=vt("div","mapboxgl-ctrl");const c=vt("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const c in i){const p=i[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Y{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const _ of p)if(_.id===i)return void(_.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function _e(h,i,c){if(h=new l.LngLat(h.lng,h.lat),i){const p=new l.LngLat(h.lng-360,h.lat),_=new l.LngLat(h.lng+360,h.lat),x=360*Math.ceil(Math.abs(h.lng-c.center.lng)/360),C=c.locationPoint(h).distSqr(i),A=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint(p).distSqr(i)<C&&(A||Math.abs(p.lng-c.center.lng)<x)?h=p:c.locationPoint(_).distSqr(i)<C&&(A||Math.abs(_.lng-c.center.lng)<x)&&(h=_)}for(;Math.abs(h.lng-c.center.lng)>180;){const p=c.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;h.lng>c.center.lng?h.lng-=360:h.lng+=360}return h}const ze={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class we extends l.Evented{constructor(i,c){if(super(),(i instanceof l.window.HTMLElement||c)&&(i=l.extend({element:i},c)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=l.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=vt("div");const _=41,x=27,C=tt("svg",{display:"block",height:_*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${_}`},this._element),A=tt("radialGradient",{id:"shadowGradient"},tt("defs",{},C));tt("stop",{offset:"10%","stop-opacity":.4},A),tt("stop",{offset:"100%","stop-opacity":.05},A),tt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),tt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),tt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),tt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=l.Point.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const p=this._element.classList;for(const _ in ze)p.remove(`mapboxgl-marker-anchor-${_}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(24.6+_)],"bottom-right":[-_,-1*(24.6+_)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,p=i.charCode||i.keyCode;"Space"!==c&&"Enter"!==c&&32!==p&&13!==p||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,c=this._pos;if(!i||!c)return!1;const p=i.unproject(c),_=i.getFreeCameraOptions();if(!_.position)return!1;const x=_.position.toLngLat();return x.distanceTo(p)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const c=this._pos;if(!c||c.x<0||c.x>i.transform.width||c.y<0||c.y>i.transform.height)return void this._clearFadeTimer();const p=i.unproject(c);let _;i._showingGlobe()&&l.isLngLatBehindGlobe(i.transform,this._lngLat)?_=0:(_=1-i._queryFogOpacity(p),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${ze[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const i=this._pos,c=this._map,p=this.getPitchAlignment();if(!c||!i||"map"!==p)return"";if(!c._showingGlobe()){const N=c.getPitch();return N?`rotateX(${N}deg)`:""}const _=l.radToDeg(l.globeTiltAtLngLat(c.transform,this._lngLat)),x=i.sub(l.globeCenterToScreenPoint(c.transform)),C=Math.abs(x.x)+Math.abs(x.y);if(0===C)return"";const A=_/C;return`rotateX(${-x.y*A}deg) rotateY(${x.x*A}deg)`}_calculateZTransform(){const i=this._pos,c=this._map;if(!c||!i)return"";let p=0;const _=this.getRotationAlignment();if("map"===_)if(c._showingGlobe()){const x=c.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),C=c.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);p=l.radToDeg(Math.atan2(C.y,C.x))-90}else p=-c.getBearing();else if("horizon"===_){const x=l.smoothstep(4,6,c.getZoom()),C=l.globeCenterToScreenPoint(c.transform);C.y+=x*c.transform.height;const A=i.sub(C),N=l.radToDeg(Math.atan2(A.y,A.x));p=(N>90?N-270:N+90)*(1-x)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(i){l.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=_e(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===i?this._updateFrameId=l.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=l.Point.convert(i),this._update(),this}_onMove(i){const c=this._map;if(!c)return;const p=this._pointerdownPos,_=this._positionDelta;if(p&&_){if(!this._isDragging){const x=this._clickTolerance||c._clickTolerance;if(i.point.dist(p)<x)return;this._isDragging=!0}this._pos=i.point.sub(_),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(i){const c=this._map,p=this._pos;c&&p&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(p),this._pointerdownPos=i.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const c=this._map;return c&&(i?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Rn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function oi(h=new l.Point(0,0),i="bottom"){if("number"==typeof h){const c=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(i){case"top":return new l.Point(0,h);case"top-left":return new l.Point(c,c);case"top-right":return new l.Point(-c,c);case"bottom":return new l.Point(0,-h);case"bottom-left":return new l.Point(c,-c);case"bottom-right":return new l.Point(-c,-c);case"left":return new l.Point(h,0);case"right":return new l.Point(-h,0)}return new l.Point(0,0)}return h instanceof l.Point||Array.isArray(h)?l.Point.convert(h):l.Point.convert(h[i]||[0,0])}class Nr{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=l.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,p){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+p}}const Mi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Da={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},oc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Bl{constructor(i,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new iu({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,p&&(this.mousePitch=new Vn({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),et()}move(i,c){const p=this.map,_=this.mouseRotate.mousemoveWindow(i,c),x=_&&_.bearingDelta;if(x&&p.setBearing(p.getBearing()+x),this.mousePitch){const C=this.mousePitch.mousemoveWindow(i,c),A=C&&C.pitchDelta;A&&p.setPitch(p.getPitch()+A)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){xt(),l.window.removeEventListener("mousemove",this.mousemove),l.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),st(this.element,i)),l.window.addEventListener("mousemove",this.mousemove),l.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,st(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=sn(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=sn(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const sc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ka={maxWidth:100,unit:"metric"},Ou={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Dl={version:l.version,supported:ot,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends B{constructor(h){if(l.LivePerformanceUtils.mark(l.PerformanceMarkers.create),null!=(h=l.extend({},Da,h)).minZoom&&null!=h.maxZoom&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=h.minPitch&&null!=h.maxPitch&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=h.minPitch&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=h.maxPitch&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&l.isSafariWithAntialiasingBug(l.window)&&(h.antialias=!1,l.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new uo(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._useWebGL2=h.useWebGL2,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new Y,this._domRenderTaskQueue=new Y,this._controls=[],this._markers=[],this._popups=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Mi,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Nr(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new l.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,"string"==typeof h.container){if(this._container=l.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof l.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&l.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new La(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new Yi("string"==typeof h.hash&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,l.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new $({customAttribution:h.customAttribution})),this._logoControl=new L,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new l.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new l.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(h,i){if(void 0===i&&(i=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[i];return-1!==i.indexOf("bottom")?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(h);return i>-1&&this._controls.splice(i,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new l.Event("movestart",h)).fire(new l.Event("move",h)),this.fire(new l.Event("resize",h)),i&&this.fire(new l.Event("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(l.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return"auto"===h?l.window.navigator.language:Array.isArray(h)?0===h.length?void 0:h.map(i=>"auto"===i?l.window.navigator.language:i):h}setLanguage(h){const i=this._parseLanguage(h);if(!this.style||i===this._language)return this;this._language=i,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(h){return this._lazyInitEmptyStyle(),h?"string"==typeof h&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const h=this.transform,i=h.projection.name;let c;"globe"===i&&h.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),c=!0):"mercator"===i&&h.zoom<l.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,i){return this._updateProjection(h||i||{name:"mercator"})}_updateProjection(h){let i;if(i="globe"===h.name&&this.transform.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(h){return this.transform.locationPoint3D(l.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(l.Point.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,i,c){if("mouseenter"===h||"mouseover"===h){let p=!1;const _=C=>{const A=i.filter(H=>this.getLayer(H)),N=A.length?this.queryRenderedFeatures(C.point,{layers:A}):[];N.length?p||(p=!0,c.call(this,new $s(h,this,C.originalEvent,{features:N}))):p=!1},x=()=>{p=!1};return{layers:new Set(i),listener:c,delegates:{mousemove:_,mouseout:x}}}if("mouseleave"===h||"mouseout"===h){let p=!1;const _=C=>{const A=i.filter(N=>this.getLayer(N));(A.length?this.queryRenderedFeatures(C.point,{layers:A}):[]).length?p=!0:p&&(p=!1,c.call(this,new $s(h,this,C.originalEvent)))},x=C=>{p&&(p=!1,c.call(this,new $s(h,this,C.originalEvent)))};return{layers:new Set(i),listener:c,delegates:{mousemove:_,mouseout:x}}}{const p=_=>{const x=i.filter(A=>this.getLayer(A)),C=x.length?this.queryRenderedFeatures(_.point,{layers:x}):[];C.length&&(_.features=C,c.call(this,_),delete _.features)};return{layers:new Set(i),listener:c,delegates:{[h]:p}}}}on(h,i,c){if(void 0===c)return super.on(h,i);Array.isArray(i)||(i=[i]);const p=this._createDelegatedListener(h,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(h,i,c){if(void 0===c)return super.once(h,i);Array.isArray(i)||(i=[i]);const p=this._createDelegatedListener(h,i,c);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(h,i,c){if(void 0===c)return super.off(h,i);i=new Set(Array.isArray(i)?i:[i]);const p=(x,C)=>{if(x.size!==C.size)return!1;for(const A of x)if(!C.has(A))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[h]:void 0;return _&&(x=>{for(let C=0;C<x.length;C++){const A=x[C];if(A.listener===c&&p(A.layers,i)){for(const N in A.delegates)this.off(N,A.delegates[N]);return x.splice(C,1),this}}})(_),this}queryRenderedFeatures(h,i){return this.style?(void 0!==i||void 0===h||h instanceof l.Point||Array.isArray(h)||(i=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(h,i){return this.style.querySourceFeatures(h,i)}isPointOnSurface(h){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&l.warnOnce(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(l.Point.convert(h))}setStyle(h,i){return!1!==(i=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(h,i))}_getUIString(h){const i=this._locale[h];if(null==i)throw new Error(`Missing UI string '${h}'`);return i}_updateStyle(h,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new Wo(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof h?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Wo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,i){if("string"==typeof h){const c=this._requestManager.normalizeStyleURL(h),p=this._requestManager.transformRequest(c,l.ResourceType.Style);l.getJSON(p,(_,x)=>{_?this.fire(new l.ErrorEvent(_)):x&&this._updateDiff(x,i)})}else"object"==typeof h&&this._updateDiff(h,i)}_updateDiff(h,i){try{this.style.setState(h)&&this._update(!0)}catch(c){l.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(h,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(l.warnOnce("There is no style added to the map."),!1)}addSource(h,i){return this._lazyInitEmptyStyle(),this.style.addSource(h,i),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const i in h){const c=h[i]._tiles;for(const p in c){const _=c[p];if("loaded"!==_.state&&"errored"!==_.state)return!1}}return!0}addSourceType(h,i,c){this._lazyInitEmptyStyle(),this.style.addSourceType(h,i,c)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,i,{pixelRatio:c=1,sdf:p=!1,stretchX:_,stretchY:x,content:C}={}){if(this._lazyInitEmptyStyle(),i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap){const{width:A,height:N,data:H}=l.exported.getImageData(i);this.style.addImage(h,{data:new l.RGBAImage({width:A,height:N},H),pixelRatio:c,stretchX:_,stretchY:x,content:C,sdf:p,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:A,height:N}=i,H=i;this.style.addImage(h,{data:new l.RGBAImage({width:A,height:N},new Uint8Array(H.data)),pixelRatio:c,stretchX:_,stretchY:x,content:C,sdf:p,version:0,userImage:H}),H.onAdd&&H.onAdd(this,h)}}updateImage(h,i){const c=this.style.getImage(h);if(!c)return void this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap?l.exported.getImageData(i):i,{width:_,height:x}=p;void 0!==_&&void 0!==x?_===c.data.width&&x===c.data.height?(c.data.replace(p.data,!(i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap)),this.style.updateImage(h,c)):this.fire(new l.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${x})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,i){l.getImage(this._requestManager.transformRequest(h,l.ResourceType.Image),(c,p)=>{i(c,p instanceof l.window.HTMLImageElement?l.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(h,i){return this._lazyInitEmptyStyle(),this.style.addLayer(h,i),this._update(!0)}moveLayer(h,i){return this.style.moveLayer(h,i),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,i,c){return this.style.setLayerZoomRange(h,i,c),this._update(!0)}setFilter(h,i,c={}){return this.style.setFilter(h,i,c),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,i,c,p={}){return this.style.setPaintProperty(h,i,c,p),this._update(!0)}getPaintProperty(h,i){return this.style.getPaintProperty(h,i)}setLayoutProperty(h,i,c,p={}){return this.style.setLayoutProperty(h,i,c,p),this._update(!0)}getLayoutProperty(h,i){return this.style.getLayoutProperty(h,i)}setLight(h,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(h),this.transform):0}setFeatureState(h,i){return this.style.setFeatureState(h,i),this._update()}removeFeatureState(h,i){return this.style.removeFeatureState(h,i),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,p,_,x=this._container;for(;x&&(!p||!_);){const C=l.window.getComputedStyle(x).transform;C&&"none"!==C&&(c=C.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(p=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(_=c[3])),x=x.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=_?Math.abs(i/_):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=vt("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=vt("div","mapboxgl-canvas-container",h);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=vt("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=vt("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{p[_]=vt("div",`mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,i){const c=l.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(h),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${i}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const i=this._markers.indexOf(h);-1!==i&&this._markers.splice(i,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const i=this._popups.indexOf(h);-1!==i&&this._popups.splice(i,1)}_setupPainter(){const h=l.extend({},ot.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._useWebGL2&&this._canvas.getContext("webgl2",h),c=i||this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);c?(this._useWebGL2&&!i&&l.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),l.storeAuthState(c,!0),this.painter=new be(c,this.transform,!!i),this.on("data",p=>{"source"===p.dataType&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(c)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let i;const c=this.painter.context.extTimerQuery,p=l.exported.now();if(this.listens("gpu-timing-frame")&&(i=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],l.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],l.window.performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const A=this.transform.zoom,N=this.transform.pitch,H=l.exported.now(),j=new l.EvaluationParameters(A,{now:H,fadeDuration:_,pitch:N,transition:this.style.getTransition()});this.style.update(j)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let x=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),x=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):x=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const A=l.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,i),setTimeout(()=>{const N=c.getQueryObjectEXT(i,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(i),this.fire(new l.Event("gpu-timing-frame",{cpuTime:A,gpuTime:N})),l.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:N}})},50)}if(this.listens("gpu-timing-layer")){const A=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(A);this.fire(new l.Event("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const A=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(A);this.fire(new l.Event("gpu-timing-deferred-render",{gpuTime:N}))},50)}const C=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(C||this._repaint)this.triggerRepaint();else{const A=!this.isMoving()&&this.loaded();if(A&&(x=this._updateAverageElevation(p,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),A&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||C||(this._fullyLoaded=!0,l.LivePerformanceUtils.mark(l.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&l.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const i of this._markers)h&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!h||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(h,i=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((i||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const p=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),x=!1;this.transform.elevation&&(x=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=h;const C=Math.abs(p-_);if(C>1){if(this._isInitialLoad||x)return this._averageElevation.jumpTo(_),c(_);this._averageElevation.easeTo(_,h,300)}else if(C>1e-4)return this._averageElevation.jumpTo(_),c(_)}return!!this._averageElevation.isEasing(h)&&c(this._averageElevation.getValue(h))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===l.AUTH_ERR_MSG||401===h.status)){const i=this.painter.context.gl;l.storeAuthState(i,!1),this._logoControl instanceof L&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function _(x){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0);const C=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,C),C}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(_(h),i.canvasCopies.map(_),i.timeStamps)}_canvasPixelComparison(h,i,c){let p=c[1]-c[0];const _=h.length/4;for(let x=0;x<i.length;x++){const C=i[x];let A=0;for(let N=0;N<C.length;N+=4)C[N]===h[N]&&C[N+1]===h[N+1]&&C[N+2]===h[N+2]&&C[N+3]===h[N+3]&&(A+=1);p+=(c[x+2]-c[x+1])*(1-A/_)}return p}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1),l.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=l.exported.frame(i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)}))}_preloadTiles(h){const i=this.style?Object.values(this.style._sourceCaches):[];return l.asyncAll(i,(c,p)=>c._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){"hidden"===l.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,h&&this._update())}_setCacheLimits(h,i){l.setCacheLimits(h,i)}get version(){return l.version}},NavigationControl:class{constructor(h){this.options=l.extend({},oc,h),this._container=vt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),vt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),vt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:i}):c.resetNorth({},{originalEvent:i}))}),this._compassIcon=vt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const i=h.getZoom(),c=i===h.getMaxZoom(),p=i===h.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Bl(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,i){const c=vt("button",h,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(h,i){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${i}`);h.setAttribute("aria-label",c),h.firstElementChild&&h.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends l.Evented{constructor(h){super(),this.options=l.extend({geolocation:l.window.navigator.geolocation},sc,h),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ho(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=vt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const i=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,h(c)};void 0!==this._supportsGeolocation?h(this._supportsGeolocation):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(c=>i("denied"!==c.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(h){const i=this._map.getMaxBounds(),c=h.coords;return!!i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",h)),this._finish()}}_updateCamera(h){const i=new l.LngLat(h.coords.longitude,h.coords.latitude),c=h.coords.accuracy,p=this._map.getBearing(),_=l.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),_,{geolocateSource:!0})}_updateMarker(h){if(h){const i=new l.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,i=l.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,c=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=vt("button","mapboxgl-ctrl-geolocate",this._container),vt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===h){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=vt("div","mapboxgl-user-location"),this._dotElement.appendChild(vt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(vt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new we({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=vt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new we({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:!0===h.absolute&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==l.window.DeviceMotionEvent&&"function"==typeof l.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientation),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:$,ScaleControl:class{constructor(h){this.options=l.extend({},Ka,h),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),l.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,i=this._map,c=i._containerHeight/2,p=i._containerWidth/2-h/2,_=i.unproject([p,c]),x=i.unproject([p+h,c]),C=_.distanceTo(x);if("imperial"===this.options.unit){const A=3.2808*C;A>5280?this._setScale(h,A/5280,"mile"):this._setScale(h,A,"foot")}else"nautical"===this.options.unit?this._setScale(h,C/1852,"nautical-mile"):C>=1e3?this._setScale(h,C/1e3,"kilometer"):this._setScale(h,C,"meter")}_setScale(h,i,c){this._map._requestDomTask(()=>{const p=function(x){const C=Math.pow(10,`${Math.floor(x)}`.length-1);let A=x/C;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(N){const H=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*H)/H}(A),C*A}(i),_=p/i;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(p):`${p}&nbsp;${Ou[c]}`,this._container.style.width=h*_+"px"})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=vt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof l.window.HTMLElement?this._container=h.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=vt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=vt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);vt("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(h){super(),this.options=l.extend(Object.create(Rn),h),l.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=l.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(l.window.document.createTextNode(h))}setHTML(h){const i=l.window.document.createDocumentFragment(),c=l.window.document.createElement("body");let p;for(c.innerHTML=h;p=c.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=vt("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(h),this.options.closeButton){const c=this._closeButton=vt("button","mapboxgl-popup-close-button",i);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let i;return this._classList.delete(h)?i=!1:(this._classList.add(h),i=!0),this._updateClassList(),i}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const i=this._map,c=this._container,p=this._pos;if(!i||!c||!p)return"bottom";const _=c.offsetWidth,x=c.offsetHeight,C=p.x<_/2,A=p.x>i.transform.width-_/2;if(p.y+h<x)return C?"top-left":A?"top-right":"top";if(p.y>i.transform.height-x){if(C)return"bottom-left";if(A)return"bottom-right"}return C?"left":A?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),h.className=i.join(" ")}_update(h){const i=this._map,c=this._content;if(!i||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=vt("div","mapboxgl-popup",i.getContainer()),this._tip=vt("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=_e(this._lngLat,this._pos,i.transform)),!this._trackPointer||h){const _=this._pos=this._trackPointer&&h?h:i.project(this._lngLat),x=oi(this.options.offset),C=this._anchor=this._getAnchor(x.y),A=oi(this.options.offset,C),N=_.add(A).round();i._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${ze[C]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&i._showingGlobe()){const _=l.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(mr);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:we,Style:Wo,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:_r,Evented:l.Evented,config:l.config,prewarm:function(){Ke().acquire(Qr)},clearPrewarmedResources:function(){const h=rt;h&&(h.isPreloaded()&&1===h.numActive()?(h.release(Qr),rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(h){l.config.ACCESS_TOKEN=h},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(h){l.config.API_URL=h},get workerCount(){return Oi.workerCount},set workerCount(h){Oi.workerCount=h},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){l.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){l.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return Dl}),T}()},5619:(fr,en,oe)=>{"use strict";oe.d(en,{X:()=>b});var T=oe(8645);class b extends T.x{constructor(l){super(),this._value=l}get value(){return this.getValue()}_subscribe(l){const Ee=super._subscribe(l);return!Ee.closed&&l.next(this._value),Ee}getValue(){const{hasError:l,thrownError:Ee,_value:ot}=this;if(l)throw Ee;return this._throwIfClosed(),ot}next(l){super.next(this._value=l)}}},5592:(fr,en,oe)=>{"use strict";oe.d(en,{y:()=>Et});var T=oe(305),b=oe(7394),Lt=oe(4850),l=oe(8407),Ee=oe(2653),ot=oe(4674),qe=oe(1441);let Et=(()=>{class wt{constructor(et){et&&(this._subscribe=et)}lift(et){const xt=new wt;return xt.source=this,xt.operator=et,xt}subscribe(et,xt,Kt){const It=function nt(wt){return wt&&wt instanceof T.Lv||function tt(wt){return wt&&(0,ot.m)(wt.next)&&(0,ot.m)(wt.error)&&(0,ot.m)(wt.complete)}(wt)&&(0,b.Nn)(wt)}(et)?et:new T.Hp(et,xt,Kt);return(0,qe.x)(()=>{const{operator:st,source:sn}=this;It.add(st?st.call(It,sn):sn?this._subscribe(It):this._trySubscribe(It))}),It}_trySubscribe(et){try{return this._subscribe(et)}catch(xt){et.error(xt)}}forEach(et,xt){return new(xt=vt(xt))((Kt,It)=>{const st=new T.Hp({next:sn=>{try{et(sn)}catch(Tt){It(Tt),st.unsubscribe()}},error:It,complete:Kt});this.subscribe(st)})}_subscribe(et){var xt;return null===(xt=this.source)||void 0===xt?void 0:xt.subscribe(et)}[Lt.L](){return this}pipe(...et){return(0,l.U)(et)(this)}toPromise(et){return new(et=vt(et))((xt,Kt)=>{let It;this.subscribe(st=>It=st,st=>Kt(st),()=>xt(It))})}}return wt.create=ht=>new wt(ht),wt})();function vt(wt){var ht;return null!==(ht=wt??Ee.config.Promise)&&void 0!==ht?ht:Promise}},8645:(fr,en,oe)=>{"use strict";oe.d(en,{x:()=>qe});var T=oe(5592),b=oe(7394);const l=(0,oe(2306).d)(vt=>function(){vt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ee=oe(9039),ot=oe(1441);let qe=(()=>{class vt extends T.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(nt){const wt=new Et(this,this);return wt.operator=nt,wt}_throwIfClosed(){if(this.closed)throw new l}next(nt){(0,ot.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const wt of this.currentObservers)wt.next(nt)}})}error(nt){(0,ot.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=nt;const{observers:wt}=this;for(;wt.length;)wt.shift().error(nt)}})}complete(){(0,ot.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:nt}=this;for(;nt.length;)nt.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var nt;return(null===(nt=this.observers)||void 0===nt?void 0:nt.length)>0}_trySubscribe(nt){return this._throwIfClosed(),super._trySubscribe(nt)}_subscribe(nt){return this._throwIfClosed(),this._checkFinalizedStatuses(nt),this._innerSubscribe(nt)}_innerSubscribe(nt){const{hasError:wt,isStopped:ht,observers:et}=this;return wt||ht?b.Lc:(this.currentObservers=null,et.push(nt),new b.w0(()=>{this.currentObservers=null,(0,Ee.P)(et,nt)}))}_checkFinalizedStatuses(nt){const{hasError:wt,thrownError:ht,isStopped:et}=this;wt?nt.error(ht):et&&nt.complete()}asObservable(){const nt=new T.y;return nt.source=this,nt}}return vt.create=(tt,nt)=>new Et(tt,nt),vt})();class Et extends qe{constructor(tt,nt){super(),this.destination=tt,this.source=nt}next(tt){var nt,wt;null===(wt=null===(nt=this.destination)||void 0===nt?void 0:nt.next)||void 0===wt||wt.call(nt,tt)}error(tt){var nt,wt;null===(wt=null===(nt=this.destination)||void 0===nt?void 0:nt.error)||void 0===wt||wt.call(nt,tt)}complete(){var tt,nt;null===(nt=null===(tt=this.destination)||void 0===tt?void 0:tt.complete)||void 0===nt||nt.call(tt)}_subscribe(tt){var nt,wt;return null!==(wt=null===(nt=this.source)||void 0===nt?void 0:nt.subscribe(tt))&&void 0!==wt?wt:b.Lc}}},305:(fr,en,oe)=>{"use strict";oe.d(en,{Hp:()=>Kt,Lv:()=>wt});var T=oe(4674),b=oe(7394),Lt=oe(2653),l=oe(3894),Ee=oe(2420);const ot=vt("C",void 0,void 0);function vt(Ge,Le,Yt){return{kind:Ge,value:Le,error:Yt}}var tt=oe(7599),nt=oe(1441);class wt extends b.w0{constructor(Le){super(),this.isStopped=!1,Le?(this.destination=Le,(0,b.Nn)(Le)&&Le.add(this)):this.destination=Tt}static create(Le,Yt,_n){return new Kt(Le,Yt,_n)}next(Le){this.isStopped?sn(function Et(Ge){return vt("N",Ge,void 0)}(Le),this):this._next(Le)}error(Le){this.isStopped?sn(function qe(Ge){return vt("E",void 0,Ge)}(Le),this):(this.isStopped=!0,this._error(Le))}complete(){this.isStopped?sn(ot,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Le){this.destination.next(Le)}_error(Le){try{this.destination.error(Le)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ht=Function.prototype.bind;function et(Ge,Le){return ht.call(Ge,Le)}class xt{constructor(Le){this.partialObserver=Le}next(Le){const{partialObserver:Yt}=this;if(Yt.next)try{Yt.next(Le)}catch(_n){It(_n)}}error(Le){const{partialObserver:Yt}=this;if(Yt.error)try{Yt.error(Le)}catch(_n){It(_n)}else It(Le)}complete(){const{partialObserver:Le}=this;if(Le.complete)try{Le.complete()}catch(Yt){It(Yt)}}}class Kt extends wt{constructor(Le,Yt,_n){let De;if(super(),(0,T.m)(Le)||!Le)De={next:Le??void 0,error:Yt??void 0,complete:_n??void 0};else{let ft;this&&Lt.config.useDeprecatedNextContext?(ft=Object.create(Le),ft.unsubscribe=()=>this.unsubscribe(),De={next:Le.next&&et(Le.next,ft),error:Le.error&&et(Le.error,ft),complete:Le.complete&&et(Le.complete,ft)}):De=Le}this.destination=new xt(De)}}function It(Ge){Lt.config.useDeprecatedSynchronousErrorHandling?(0,nt.O)(Ge):(0,l.h)(Ge)}function sn(Ge,Le){const{onStoppedNotification:Yt}=Lt.config;Yt&&tt.z.setTimeout(()=>Yt(Ge,Le))}const Tt={closed:!0,next:Ee.Z,error:function st(Ge){throw Ge},complete:Ee.Z}},7394:(fr,en,oe)=>{"use strict";oe.d(en,{Lc:()=>ot,w0:()=>Ee,Nn:()=>qe});var T=oe(4674);const Lt=(0,oe(2306).d)(vt=>function(nt){vt(this),this.message=nt?`${nt.length} errors occurred during unsubscription:\n${nt.map((wt,ht)=>`${ht+1}) ${wt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=nt});var l=oe(9039);class Ee{constructor(tt){this.initialTeardown=tt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let tt;if(!this.closed){this.closed=!0;const{_parentage:nt}=this;if(nt)if(this._parentage=null,Array.isArray(nt))for(const et of nt)et.remove(this);else nt.remove(this);const{initialTeardown:wt}=this;if((0,T.m)(wt))try{wt()}catch(et){tt=et instanceof Lt?et.errors:[et]}const{_finalizers:ht}=this;if(ht){this._finalizers=null;for(const et of ht)try{Et(et)}catch(xt){tt=tt??[],xt instanceof Lt?tt=[...tt,...xt.errors]:tt.push(xt)}}if(tt)throw new Lt(tt)}}add(tt){var nt;if(tt&&tt!==this)if(this.closed)Et(tt);else{if(tt instanceof Ee){if(tt.closed||tt._hasParent(this))return;tt._addParent(this)}(this._finalizers=null!==(nt=this._finalizers)&&void 0!==nt?nt:[]).push(tt)}}_hasParent(tt){const{_parentage:nt}=this;return nt===tt||Array.isArray(nt)&&nt.includes(tt)}_addParent(tt){const{_parentage:nt}=this;this._parentage=Array.isArray(nt)?(nt.push(tt),nt):nt?[nt,tt]:tt}_removeParent(tt){const{_parentage:nt}=this;nt===tt?this._parentage=null:Array.isArray(nt)&&(0,l.P)(nt,tt)}remove(tt){const{_finalizers:nt}=this;nt&&(0,l.P)(nt,tt),tt instanceof Ee&&tt._removeParent(this)}}Ee.EMPTY=(()=>{const vt=new Ee;return vt.closed=!0,vt})();const ot=Ee.EMPTY;function qe(vt){return vt instanceof Ee||vt&&"closed"in vt&&(0,T.m)(vt.remove)&&(0,T.m)(vt.add)&&(0,T.m)(vt.unsubscribe)}function Et(vt){(0,T.m)(vt)?vt():vt.unsubscribe()}},2653:(fr,en,oe)=>{"use strict";oe.d(en,{config:()=>T});const T={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(fr,en,oe)=>{"use strict";oe.d(en,{a:()=>tt});var T=oe(5592),b=oe(7453),Lt=oe(7715),l=oe(2737),Ee=oe(7400),ot=oe(9940),qe=oe(2714),Et=oe(8251),vt=oe(7103);function tt(...ht){const et=(0,ot.yG)(ht),xt=(0,ot.jO)(ht),{args:Kt,keys:It}=(0,b.D)(ht);if(0===Kt.length)return(0,Lt.D)([],et);const st=new T.y(function nt(ht,et,xt=l.y){return Kt=>{wt(et,()=>{const{length:It}=ht,st=new Array(It);let sn=It,Tt=It;for(let Ge=0;Ge<It;Ge++)wt(et,()=>{const Le=(0,Lt.D)(ht[Ge],et);let Yt=!1;Le.subscribe((0,Et.x)(Kt,_n=>{st[Ge]=_n,Yt||(Yt=!0,Tt--),Tt||Kt.next(xt(st.slice()))},()=>{--sn||Kt.complete()}))},Kt)},Kt)}}(Kt,et,It?sn=>(0,qe.n)(It,sn):l.y));return xt?st.pipe((0,Ee.Z)(xt)):st}function wt(ht,et,xt){ht?(0,vt.f)(xt,ht,et):et()}},5211:(fr,en,oe)=>{"use strict";oe.d(en,{z:()=>Ee});var T=oe(7537),Lt=oe(9940),l=oe(7715);function Ee(...ot){return function b(){return(0,T.J)(1)}()((0,l.D)(ot,(0,Lt.yG)(ot)))}},4911:(fr,en,oe)=>{"use strict";oe.d(en,{P:()=>Lt});var T=oe(5592),b=oe(4829);function Lt(l){return new T.y(Ee=>{(0,b.Xf)(l()).subscribe(Ee)})}},6232:(fr,en,oe)=>{"use strict";oe.d(en,{E:()=>b});const b=new(oe(5592).y)(Ee=>Ee.complete())},7715:(fr,en,oe)=>{"use strict";oe.d(en,{D:()=>_n});var T=oe(4829),b=oe(7103),Lt=oe(9360),l=oe(8251);function Ee(De,ft=0){return(0,Lt.e)((Nt,yt)=>{Nt.subscribe((0,l.x)(yt,mn=>(0,b.f)(yt,De,()=>yt.next(mn),ft),()=>(0,b.f)(yt,De,()=>yt.complete(),ft),mn=>(0,b.f)(yt,De,()=>yt.error(mn),ft)))})}function ot(De,ft=0){return(0,Lt.e)((Nt,yt)=>{yt.add(De.schedule(()=>Nt.subscribe(yt),ft))})}var vt=oe(5592),nt=oe(4971),wt=oe(4674);function et(De,ft){if(!De)throw new Error("Iterable cannot be null");return new vt.y(Nt=>{(0,b.f)(Nt,ft,()=>{const yt=De[Symbol.asyncIterator]();(0,b.f)(Nt,ft,()=>{yt.next().then(mn=>{mn.done?Nt.complete():Nt.next(mn.value)})},0,!0)})})}var xt=oe(8382),Kt=oe(4026),It=oe(4266),st=oe(3664),sn=oe(5726),Tt=oe(9853),Ge=oe(541);function _n(De,ft){return ft?function Yt(De,ft){if(null!=De){if((0,xt.c)(De))return function qe(De,ft){return(0,T.Xf)(De).pipe(ot(ft),Ee(ft))}(De,ft);if((0,It.z)(De))return function tt(De,ft){return new vt.y(Nt=>{let yt=0;return ft.schedule(function(){yt===De.length?Nt.complete():(Nt.next(De[yt++]),Nt.closed||this.schedule())})})}(De,ft);if((0,Kt.t)(De))return function Et(De,ft){return(0,T.Xf)(De).pipe(ot(ft),Ee(ft))}(De,ft);if((0,sn.D)(De))return et(De,ft);if((0,st.T)(De))return function ht(De,ft){return new vt.y(Nt=>{let yt;return(0,b.f)(Nt,ft,()=>{yt=De[nt.h](),(0,b.f)(Nt,ft,()=>{let mn,hn;try{({value:mn,done:hn}=yt.next())}catch(Gt){return void Nt.error(Gt)}hn?Nt.complete():Nt.next(mn)},0,!0)}),()=>(0,wt.m)(yt?.return)&&yt.return()})}(De,ft);if((0,Ge.L)(De))return function Le(De,ft){return et((0,Ge.Q)(De),ft)}(De,ft)}throw(0,Tt.z)(De)}(De,ft):(0,T.Xf)(De)}},2438:(fr,en,oe)=>{"use strict";oe.d(en,{R:()=>tt});var T=oe(4829),b=oe(5592),Lt=oe(1631),l=oe(4266),Ee=oe(4674),ot=oe(7400);const qe=["addListener","removeListener"],Et=["addEventListener","removeEventListener"],vt=["on","off"];function tt(xt,Kt,It,st){if((0,Ee.m)(It)&&(st=It,It=void 0),st)return tt(xt,Kt,It).pipe((0,ot.Z)(st));const[sn,Tt]=function et(xt){return(0,Ee.m)(xt.addEventListener)&&(0,Ee.m)(xt.removeEventListener)}(xt)?Et.map(Ge=>Le=>xt[Ge](Kt,Le,It)):function wt(xt){return(0,Ee.m)(xt.addListener)&&(0,Ee.m)(xt.removeListener)}(xt)?qe.map(nt(xt,Kt)):function ht(xt){return(0,Ee.m)(xt.on)&&(0,Ee.m)(xt.off)}(xt)?vt.map(nt(xt,Kt)):[];if(!sn&&(0,l.z)(xt))return(0,Lt.z)(Ge=>tt(Ge,Kt,It))((0,T.Xf)(xt));if(!sn)throw new TypeError("Invalid event target");return new b.y(Ge=>{const Le=(...Yt)=>Ge.next(1<Yt.length?Yt:Yt[0]);return sn(Le),()=>Tt(Le)})}function nt(xt,Kt){return It=>st=>xt[It](Kt,st)}},4829:(fr,en,oe)=>{"use strict";oe.d(en,{Xf:()=>ht});var T=oe(7582),b=oe(4266),Lt=oe(4026),l=oe(5592),Ee=oe(8382),ot=oe(5726),qe=oe(9853),Et=oe(3664),vt=oe(541),tt=oe(4674),nt=oe(3894),wt=oe(4850);function ht(Ge){if(Ge instanceof l.y)return Ge;if(null!=Ge){if((0,Ee.c)(Ge))return function et(Ge){return new l.y(Le=>{const Yt=Ge[wt.L]();if((0,tt.m)(Yt.subscribe))return Yt.subscribe(Le);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ge);if((0,b.z)(Ge))return function xt(Ge){return new l.y(Le=>{for(let Yt=0;Yt<Ge.length&&!Le.closed;Yt++)Le.next(Ge[Yt]);Le.complete()})}(Ge);if((0,Lt.t)(Ge))return function Kt(Ge){return new l.y(Le=>{Ge.then(Yt=>{Le.closed||(Le.next(Yt),Le.complete())},Yt=>Le.error(Yt)).then(null,nt.h)})}(Ge);if((0,ot.D)(Ge))return st(Ge);if((0,Et.T)(Ge))return function It(Ge){return new l.y(Le=>{for(const Yt of Ge)if(Le.next(Yt),Le.closed)return;Le.complete()})}(Ge);if((0,vt.L)(Ge))return function sn(Ge){return st((0,vt.Q)(Ge))}(Ge)}throw(0,qe.z)(Ge)}function st(Ge){return new l.y(Le=>{(function Tt(Ge,Le){var Yt,_n,De,ft;return(0,T.mG)(this,void 0,void 0,function*(){try{for(Yt=(0,T.KL)(Ge);!(_n=yield Yt.next()).done;)if(Le.next(_n.value),Le.closed)return}catch(Nt){De={error:Nt}}finally{try{_n&&!_n.done&&(ft=Yt.return)&&(yield ft.call(Yt))}finally{if(De)throw De.error}}Le.complete()})})(Ge,Le).catch(Yt=>Le.error(Yt))})}},3019:(fr,en,oe)=>{"use strict";oe.d(en,{T:()=>ot});var T=oe(7537),b=oe(4829),Lt=oe(6232),l=oe(9940),Ee=oe(7715);function ot(...qe){const Et=(0,l.yG)(qe),vt=(0,l._6)(qe,1/0),tt=qe;return tt.length?1===tt.length?(0,b.Xf)(tt[0]):(0,T.J)(vt)((0,Ee.D)(tt,Et)):Lt.E}},2096:(fr,en,oe)=>{"use strict";oe.d(en,{of:()=>Lt});var T=oe(9940),b=oe(7715);function Lt(...l){const Ee=(0,T.yG)(l);return(0,b.D)(l,Ee)}},8251:(fr,en,oe)=>{"use strict";oe.d(en,{x:()=>b});var T=oe(305);function b(l,Ee,ot,qe,Et){return new Lt(l,Ee,ot,qe,Et)}class Lt extends T.Lv{constructor(Ee,ot,qe,Et,vt,tt){super(Ee),this.onFinalize=vt,this.shouldUnsubscribe=tt,this._next=ot?function(nt){try{ot(nt)}catch(wt){Ee.error(wt)}}:super._next,this._error=Et?function(nt){try{Et(nt)}catch(wt){Ee.error(wt)}finally{this.unsubscribe()}}:super._error,this._complete=qe?function(){try{qe()}catch(nt){Ee.error(nt)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ee;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ot}=this;super.unsubscribe(),!ot&&(null===(Ee=this.onFinalize)||void 0===Ee||Ee.call(this))}}}},6306:(fr,en,oe)=>{"use strict";oe.d(en,{K:()=>l});var T=oe(4829),b=oe(8251),Lt=oe(9360);function l(Ee){return(0,Lt.e)((ot,qe)=>{let tt,Et=null,vt=!1;Et=ot.subscribe((0,b.x)(qe,void 0,void 0,nt=>{tt=(0,T.Xf)(Ee(nt,l(Ee)(ot))),Et?(Et.unsubscribe(),Et=null,tt.subscribe(qe)):vt=!0})),vt&&(Et.unsubscribe(),Et=null,tt.subscribe(qe))})}},6328:(fr,en,oe)=>{"use strict";oe.d(en,{b:()=>Lt});var T=oe(1631),b=oe(4674);function Lt(l,Ee){return(0,b.m)(Ee)?(0,T.z)(l,Ee,1):(0,T.z)(l,1)}},3997:(fr,en,oe)=>{"use strict";oe.d(en,{x:()=>l});var T=oe(2737),b=oe(9360),Lt=oe(8251);function l(ot,qe=T.y){return ot=ot??Ee,(0,b.e)((Et,vt)=>{let tt,nt=!0;Et.subscribe((0,Lt.x)(vt,wt=>{const ht=qe(wt);(nt||!ot(tt,ht))&&(nt=!1,tt=ht,vt.next(wt))}))})}function Ee(ot,qe){return ot===qe}},2181:(fr,en,oe)=>{"use strict";oe.d(en,{h:()=>Lt});var T=oe(9360),b=oe(8251);function Lt(l,Ee){return(0,T.e)((ot,qe)=>{let Et=0;ot.subscribe((0,b.x)(qe,vt=>l.call(Ee,vt,Et++)&&qe.next(vt)))})}},4716:(fr,en,oe)=>{"use strict";oe.d(en,{x:()=>b});var T=oe(9360);function b(Lt){return(0,T.e)((l,Ee)=>{try{l.subscribe(Ee)}finally{Ee.add(Lt)}})}},7398:(fr,en,oe)=>{"use strict";oe.d(en,{U:()=>Lt});var T=oe(9360),b=oe(8251);function Lt(l,Ee){return(0,T.e)((ot,qe)=>{let Et=0;ot.subscribe((0,b.x)(qe,vt=>{qe.next(l.call(Ee,vt,Et++))}))})}},7537:(fr,en,oe)=>{"use strict";oe.d(en,{J:()=>Lt});var T=oe(1631),b=oe(2737);function Lt(l=1/0){return(0,T.z)(b.y,l)}},1631:(fr,en,oe)=>{"use strict";oe.d(en,{z:()=>Et});var T=oe(7398),b=oe(4829),Lt=oe(9360),l=oe(7103),Ee=oe(8251),qe=oe(4674);function Et(vt,tt,nt=1/0){return(0,qe.m)(tt)?Et((wt,ht)=>(0,T.U)((et,xt)=>tt(wt,et,ht,xt))((0,b.Xf)(vt(wt,ht))),nt):("number"==typeof tt&&(nt=tt),(0,Lt.e)((wt,ht)=>function ot(vt,tt,nt,wt,ht,et,xt,Kt){const It=[];let st=0,sn=0,Tt=!1;const Ge=()=>{Tt&&!It.length&&!st&&tt.complete()},Le=_n=>st<wt?Yt(_n):It.push(_n),Yt=_n=>{et&&tt.next(_n),st++;let De=!1;(0,b.Xf)(nt(_n,sn++)).subscribe((0,Ee.x)(tt,ft=>{ht?.(ft),et?Le(ft):tt.next(ft)},()=>{De=!0},void 0,()=>{if(De)try{for(st--;It.length&&st<wt;){const ft=It.shift();xt?(0,l.f)(tt,xt,()=>Yt(ft)):Yt(ft)}Ge()}catch(ft){tt.error(ft)}}))};return vt.subscribe((0,Ee.x)(tt,Le,()=>{Tt=!0,Ge()})),()=>{Kt?.()}}(wt,ht,vt,nt)))}},7921:(fr,en,oe)=>{"use strict";oe.d(en,{O:()=>l});var T=oe(5211),b=oe(9940),Lt=oe(9360);function l(...Ee){const ot=(0,b.yG)(Ee);return(0,Lt.e)((qe,Et)=>{(ot?(0,T.z)(Ee,qe,ot):(0,T.z)(Ee,qe)).subscribe(Et)})}},4664:(fr,en,oe)=>{"use strict";oe.d(en,{w:()=>l});var T=oe(4829),b=oe(9360),Lt=oe(8251);function l(Ee,ot){return(0,b.e)((qe,Et)=>{let vt=null,tt=0,nt=!1;const wt=()=>nt&&!vt&&Et.complete();qe.subscribe((0,Lt.x)(Et,ht=>{vt?.unsubscribe();let et=0;const xt=tt++;(0,T.Xf)(Ee(ht,xt)).subscribe(vt=(0,Lt.x)(Et,Kt=>Et.next(ot?ot(ht,Kt,xt,et++):Kt),()=>{vt=null,wt()}))},()=>{nt=!0,wt()}))})}},8180:(fr,en,oe)=>{"use strict";oe.d(en,{q:()=>l});var T=oe(6232),b=oe(9360),Lt=oe(8251);function l(Ee){return Ee<=0?()=>T.E:(0,b.e)((ot,qe)=>{let Et=0;ot.subscribe((0,Lt.x)(qe,vt=>{++Et<=Ee&&(qe.next(vt),Ee<=Et&&qe.complete())}))})}},9397:(fr,en,oe)=>{"use strict";oe.d(en,{b:()=>Ee});var T=oe(4674),b=oe(9360),Lt=oe(8251),l=oe(2737);function Ee(ot,qe,Et){const vt=(0,T.m)(ot)||qe||Et?{next:ot,error:qe,complete:Et}:ot;return vt?(0,b.e)((tt,nt)=>{var wt;null===(wt=vt.subscribe)||void 0===wt||wt.call(vt);let ht=!0;tt.subscribe((0,Lt.x)(nt,et=>{var xt;null===(xt=vt.next)||void 0===xt||xt.call(vt,et),nt.next(et)},()=>{var et;ht=!1,null===(et=vt.complete)||void 0===et||et.call(vt),nt.complete()},et=>{var xt;ht=!1,null===(xt=vt.error)||void 0===xt||xt.call(vt,et),nt.error(et)},()=>{var et,xt;ht&&(null===(et=vt.unsubscribe)||void 0===et||et.call(vt)),null===(xt=vt.finalize)||void 0===xt||xt.call(vt)}))}):l.y}},7599:(fr,en,oe)=>{"use strict";oe.d(en,{z:()=>T});const T={setTimeout(b,Lt,...l){const{delegate:Ee}=T;return Ee?.setTimeout?Ee.setTimeout(b,Lt,...l):setTimeout(b,Lt,...l)},clearTimeout(b){const{delegate:Lt}=T;return(Lt?.clearTimeout||clearTimeout)(b)},delegate:void 0}},4971:(fr,en,oe)=>{"use strict";oe.d(en,{h:()=>b});const b=function T(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(fr,en,oe)=>{"use strict";oe.d(en,{L:()=>T});const T="function"==typeof Symbol&&Symbol.observable||"@@observable"},9940:(fr,en,oe)=>{"use strict";oe.d(en,{_6:()=>ot,jO:()=>l,yG:()=>Ee});var T=oe(4674),b=oe(671);function Lt(qe){return qe[qe.length-1]}function l(qe){return(0,T.m)(Lt(qe))?qe.pop():void 0}function Ee(qe){return(0,b.K)(Lt(qe))?qe.pop():void 0}function ot(qe,Et){return"number"==typeof Lt(qe)?qe.pop():Et}},7453:(fr,en,oe)=>{"use strict";oe.d(en,{D:()=>Ee});const{isArray:T}=Array,{getPrototypeOf:b,prototype:Lt,keys:l}=Object;function Ee(qe){if(1===qe.length){const Et=qe[0];if(T(Et))return{args:Et,keys:null};if(function ot(qe){return qe&&"object"==typeof qe&&b(qe)===Lt}(Et)){const vt=l(Et);return{args:vt.map(tt=>Et[tt]),keys:vt}}}return{args:qe,keys:null}}},9039:(fr,en,oe)=>{"use strict";function T(b,Lt){if(b){const l=b.indexOf(Lt);0<=l&&b.splice(l,1)}}oe.d(en,{P:()=>T})},2306:(fr,en,oe)=>{"use strict";function T(b){const l=b(Ee=>{Error.call(Ee),Ee.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}oe.d(en,{d:()=>T})},2714:(fr,en,oe)=>{"use strict";function T(b,Lt){return b.reduce((l,Ee,ot)=>(l[Ee]=Lt[ot],l),{})}oe.d(en,{n:()=>T})},1441:(fr,en,oe)=>{"use strict";oe.d(en,{O:()=>l,x:()=>Lt});var T=oe(2653);let b=null;function Lt(Ee){if(T.config.useDeprecatedSynchronousErrorHandling){const ot=!b;if(ot&&(b={errorThrown:!1,error:null}),Ee(),ot){const{errorThrown:qe,error:Et}=b;if(b=null,qe)throw Et}}else Ee()}function l(Ee){T.config.useDeprecatedSynchronousErrorHandling&&b&&(b.errorThrown=!0,b.error=Ee)}},7103:(fr,en,oe)=>{"use strict";function T(b,Lt,l,Ee=0,ot=!1){const qe=Lt.schedule(function(){l(),ot?b.add(this.schedule(null,Ee)):this.unsubscribe()},Ee);if(b.add(qe),!ot)return qe}oe.d(en,{f:()=>T})},2737:(fr,en,oe)=>{"use strict";function T(b){return b}oe.d(en,{y:()=>T})},4266:(fr,en,oe)=>{"use strict";oe.d(en,{z:()=>T});const T=b=>b&&"number"==typeof b.length&&"function"!=typeof b},5726:(fr,en,oe)=>{"use strict";oe.d(en,{D:()=>b});var T=oe(4674);function b(Lt){return Symbol.asyncIterator&&(0,T.m)(Lt?.[Symbol.asyncIterator])}},4674:(fr,en,oe)=>{"use strict";function T(b){return"function"==typeof b}oe.d(en,{m:()=>T})},8382:(fr,en,oe)=>{"use strict";oe.d(en,{c:()=>Lt});var T=oe(4850),b=oe(4674);function Lt(l){return(0,b.m)(l[T.L])}},3664:(fr,en,oe)=>{"use strict";oe.d(en,{T:()=>Lt});var T=oe(4971),b=oe(4674);function Lt(l){return(0,b.m)(l?.[T.h])}},4026:(fr,en,oe)=>{"use strict";oe.d(en,{t:()=>b});var T=oe(4674);function b(Lt){return(0,T.m)(Lt?.then)}},541:(fr,en,oe)=>{"use strict";oe.d(en,{L:()=>l,Q:()=>Lt});var T=oe(7582),b=oe(4674);function Lt(Ee){return(0,T.FC)(this,arguments,function*(){const qe=Ee.getReader();try{for(;;){const{value:Et,done:vt}=yield(0,T.qq)(qe.read());if(vt)return yield(0,T.qq)(void 0);yield yield(0,T.qq)(Et)}}finally{qe.releaseLock()}})}function l(Ee){return(0,b.m)(Ee?.getReader)}},671:(fr,en,oe)=>{"use strict";oe.d(en,{K:()=>b});var T=oe(4674);function b(Lt){return Lt&&(0,T.m)(Lt.schedule)}},9360:(fr,en,oe)=>{"use strict";oe.d(en,{A:()=>b,e:()=>Lt});var T=oe(4674);function b(l){return(0,T.m)(l?.lift)}function Lt(l){return Ee=>{if(b(Ee))return Ee.lift(function(ot){try{return l(ot,this)}catch(qe){this.error(qe)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(fr,en,oe)=>{"use strict";oe.d(en,{Z:()=>l});var T=oe(7398);const{isArray:b}=Array;function l(Ee){return(0,T.U)(ot=>function Lt(Ee,ot){return b(ot)?Ee(...ot):Ee(ot)}(Ee,ot))}},2420:(fr,en,oe)=>{"use strict";function T(){}oe.d(en,{Z:()=>T})},8407:(fr,en,oe)=>{"use strict";oe.d(en,{U:()=>Lt,z:()=>b});var T=oe(2737);function b(...l){return Lt(l)}function Lt(l){return 0===l.length?T.y:1===l.length?l[0]:function(ot){return l.reduce((qe,Et)=>Et(qe),ot)}}},3894:(fr,en,oe)=>{"use strict";oe.d(en,{h:()=>Lt});var T=oe(2653),b=oe(7599);function Lt(l){b.z.setTimeout(()=>{const{onUnhandledError:Ee}=T.config;if(!Ee)throw l;Ee(l)})}},9853:(fr,en,oe)=>{"use strict";function T(b){return new TypeError(`You provided ${null!==b&&"object"==typeof b?"an invalid object":`'${b}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}oe.d(en,{z:()=>T})},863:(fr,en,oe)=>{var T={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,982,433],"./ion-datetime_3.entry.js":[7059,982,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function b(Lt){if(!oe.o(T,Lt))return Promise.resolve().then(()=>{var ot=new Error("Cannot find module '"+Lt+"'");throw ot.code="MODULE_NOT_FOUND",ot});var l=T[Lt],Ee=l[0];return Promise.all(l.slice(1).map(oe.e)).then(()=>oe(Ee))}b.keys=()=>Object.keys(T),b.id=863,fr.exports=b},6825:(fr,en,oe)=>{"use strict";oe.d(en,{IO:()=>xt,LC:()=>b,SB:()=>vt,X$:()=>l,ZE:()=>st,ZN:()=>It,_j:()=>T,eR:()=>nt,jt:()=>Ee,k1:()=>sn,l3:()=>Lt,oB:()=>Et,pV:()=>ht,vP:()=>qe});class T{}class b{}const Lt="*";function l(Tt,Ge){return{type:7,name:Tt,definitions:Ge,options:{}}}function Ee(Tt,Ge=null){return{type:4,styles:Ge,timings:Tt}}function qe(Tt,Ge=null){return{type:2,steps:Tt,options:Ge}}function Et(Tt){return{type:6,styles:Tt,offset:null}}function vt(Tt,Ge,Le){return{type:0,name:Tt,styles:Ge,options:Le}}function nt(Tt,Ge,Le=null){return{type:1,expr:Tt,animation:Ge,options:Le}}function ht(Tt=null){return{type:9,options:Tt}}function xt(Tt,Ge,Le=null){return{type:11,selector:Tt,animation:Ge,options:Le}}class It{constructor(Ge=0,Le=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=Ge+Le}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Ge=>Ge()),this._onDoneFns=[])}onStart(Ge){this._originalOnStartFns.push(Ge),this._onStartFns.push(Ge)}onDone(Ge){this._originalOnDoneFns.push(Ge),this._onDoneFns.push(Ge)}onDestroy(Ge){this._onDestroyFns.push(Ge)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(Ge=>Ge()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(Ge=>Ge()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(Ge){this._position=this.totalTime?Ge*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(Ge){const Le="start"==Ge?this._onStartFns:this._onDoneFns;Le.forEach(Yt=>Yt()),Le.length=0}}class st{constructor(Ge){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=Ge;let Le=0,Yt=0,_n=0;const De=this.players.length;0==De?queueMicrotask(()=>this._onFinish()):this.players.forEach(ft=>{ft.onDone(()=>{++Le==De&&this._onFinish()}),ft.onDestroy(()=>{++Yt==De&&this._onDestroy()}),ft.onStart(()=>{++_n==De&&this._onStart()})}),this.totalTime=this.players.reduce((ft,Nt)=>Math.max(ft,Nt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Ge=>Ge()),this._onDoneFns=[])}init(){this.players.forEach(Ge=>Ge.init())}onStart(Ge){this._onStartFns.push(Ge)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(Ge=>Ge()),this._onStartFns=[])}onDone(Ge){this._onDoneFns.push(Ge)}onDestroy(Ge){this._onDestroyFns.push(Ge)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(Ge=>Ge.play())}pause(){this.players.forEach(Ge=>Ge.pause())}restart(){this.players.forEach(Ge=>Ge.restart())}finish(){this._onFinish(),this.players.forEach(Ge=>Ge.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(Ge=>Ge.destroy()),this._onDestroyFns.forEach(Ge=>Ge()),this._onDestroyFns=[])}reset(){this.players.forEach(Ge=>Ge.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(Ge){const Le=Ge*this.totalTime;this.players.forEach(Yt=>{const _n=Yt.totalTime?Math.min(1,Le/Yt.totalTime):1;Yt.setPosition(_n)})}getPosition(){const Ge=this.players.reduce((Le,Yt)=>null===Le||Yt.totalTime>Le.totalTime?Yt:Le,null);return null!=Ge?Ge.getPosition():0}beforeDestroy(){this.players.forEach(Ge=>{Ge.beforeDestroy&&Ge.beforeDestroy()})}triggerCallback(Ge){const Le="start"==Ge?this._onStartFns:this._onDoneFns;Le.forEach(Yt=>Yt()),Le.length=0}}const sn="!"},6814:(fr,en,oe)=>{"use strict";oe.d(en,{Do:()=>Kt,ED:()=>pe,EM:()=>ys,HT:()=>l,JF:()=>vs,K0:()=>ot,Mx:()=>bi,NF:()=>$o,O5:()=>so,PM:()=>Bo,RF:()=>le,S$:()=>ht,V_:()=>Et,Ye:()=>It,b0:()=>xt,bD:()=>rs,ez:()=>_s,mk:()=>zt,n9:()=>Oe,q:()=>Lt,sg:()=>Vi,tP:()=>bn,w_:()=>Ee});var T=oe(9468);let b=null;function Lt(){return b}function l(k){b||(b=k)}class Ee{}const ot=new T.OlP("DocumentToken");let qe=(()=>{var k;class X{historyGo(W){throw new Error("Not implemented")}}return(k=X).\u0275fac=function(W){return new(W||k)},k.\u0275prov=T.Yz7({token:k,factory:function(){return(0,T.f3M)(vt)},providedIn:"platform"}),X})();const Et=new T.OlP("Location Initialized");let vt=(()=>{var k;class X extends qe{constructor(){super(),this._doc=(0,T.f3M)(ot),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Lt().getBaseHref(this._doc)}onPopState(W){const be=Lt().getGlobalEventTarget(this._doc,"window");return be.addEventListener("popstate",W,!1),()=>be.removeEventListener("popstate",W)}onHashChange(W){const be=Lt().getGlobalEventTarget(this._doc,"window");return be.addEventListener("hashchange",W,!1),()=>be.removeEventListener("hashchange",W)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(W){this._location.pathname=W}pushState(W,be,_t){this._history.pushState(W,be,_t)}replaceState(W,be,_t){this._history.replaceState(W,be,_t)}forward(){this._history.forward()}back(){this._history.back()}historyGo(W=0){this._history.go(W)}getState(){return this._history.state}}return(k=X).\u0275fac=function(W){return new(W||k)},k.\u0275prov=T.Yz7({token:k,factory:function(){return new k},providedIn:"platform"}),X})();function tt(k,X){if(0==k.length)return X;if(0==X.length)return k;let Be=0;return k.endsWith("/")&&Be++,X.startsWith("/")&&Be++,2==Be?k+X.substring(1):1==Be?k+X:k+"/"+X}function nt(k){const X=k.match(/#|\?|$/),Be=X&&X.index||k.length;return k.slice(0,Be-("/"===k[Be-1]?1:0))+k.slice(Be)}function wt(k){return k&&"?"!==k[0]?"?"+k:k}let ht=(()=>{var k;class X{historyGo(W){throw new Error("Not implemented")}}return(k=X).\u0275fac=function(W){return new(W||k)},k.\u0275prov=T.Yz7({token:k,factory:function(){return(0,T.f3M)(xt)},providedIn:"root"}),X})();const et=new T.OlP("appBaseHref");let xt=(()=>{var k;class X extends ht{constructor(W,be){super(),this._platformLocation=W,this._removeListenerFns=[],this._baseHref=be??this._platformLocation.getBaseHrefFromDOM()??(0,T.f3M)(ot).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(W){this._removeListenerFns.push(this._platformLocation.onPopState(W),this._platformLocation.onHashChange(W))}getBaseHref(){return this._baseHref}prepareExternalUrl(W){return tt(this._baseHref,W)}path(W=!1){const be=this._platformLocation.pathname+wt(this._platformLocation.search),_t=this._platformLocation.hash;return _t&&W?`${be}${_t}`:be}pushState(W,be,_t,kt){const Ut=this.prepareExternalUrl(_t+wt(kt));this._platformLocation.pushState(W,be,Ut)}replaceState(W,be,_t,kt){const Ut=this.prepareExternalUrl(_t+wt(kt));this._platformLocation.replaceState(W,be,Ut)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(W=0){this._platformLocation.historyGo?.(W)}}return(k=X).\u0275fac=function(W){return new(W||k)(T.LFG(qe),T.LFG(et,8))},k.\u0275prov=T.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"}),X})(),Kt=(()=>{var k;class X extends ht{constructor(W,be){super(),this._platformLocation=W,this._baseHref="",this._removeListenerFns=[],null!=be&&(this._baseHref=be)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(W){this._removeListenerFns.push(this._platformLocation.onPopState(W),this._platformLocation.onHashChange(W))}getBaseHref(){return this._baseHref}path(W=!1){let be=this._platformLocation.hash;return null==be&&(be="#"),be.length>0?be.substring(1):be}prepareExternalUrl(W){const be=tt(this._baseHref,W);return be.length>0?"#"+be:be}pushState(W,be,_t,kt){let Ut=this.prepareExternalUrl(_t+wt(kt));0==Ut.length&&(Ut=this._platformLocation.pathname),this._platformLocation.pushState(W,be,Ut)}replaceState(W,be,_t,kt){let Ut=this.prepareExternalUrl(_t+wt(kt));0==Ut.length&&(Ut=this._platformLocation.pathname),this._platformLocation.replaceState(W,be,Ut)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(W=0){this._platformLocation.historyGo?.(W)}}return(k=X).\u0275fac=function(W){return new(W||k)(T.LFG(qe),T.LFG(et,8))},k.\u0275prov=T.Yz7({token:k,factory:k.\u0275fac}),X})(),It=(()=>{var k;class X{constructor(W){this._subject=new T.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=W;const be=this._locationStrategy.getBaseHref();this._basePath=function Ge(k){if(new RegExp("^(https?:)?//").test(k)){const[,Be]=k.split(/\/\/[^\/]+/);return Be}return k}(nt(Tt(be))),this._locationStrategy.onPopState(_t=>{this._subject.emit({url:this.path(!0),pop:!0,state:_t.state,type:_t.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(W=!1){return this.normalize(this._locationStrategy.path(W))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(W,be=""){return this.path()==this.normalize(W+wt(be))}normalize(W){return X.stripTrailingSlash(function sn(k,X){if(!k||!X.startsWith(k))return X;const Be=X.substring(k.length);return""===Be||["/",";","?","#"].includes(Be[0])?Be:X}(this._basePath,Tt(W)))}prepareExternalUrl(W){return W&&"/"!==W[0]&&(W="/"+W),this._locationStrategy.prepareExternalUrl(W)}go(W,be="",_t=null){this._locationStrategy.pushState(_t,"",W,be),this._notifyUrlChangeListeners(this.prepareExternalUrl(W+wt(be)),_t)}replaceState(W,be="",_t=null){this._locationStrategy.replaceState(_t,"",W,be),this._notifyUrlChangeListeners(this.prepareExternalUrl(W+wt(be)),_t)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(W=0){this._locationStrategy.historyGo?.(W)}onUrlChange(W){return this._urlChangeListeners.push(W),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(be=>{this._notifyUrlChangeListeners(be.url,be.state)})),()=>{const be=this._urlChangeListeners.indexOf(W);this._urlChangeListeners.splice(be,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(W="",be){this._urlChangeListeners.forEach(_t=>_t(W,be))}subscribe(W,be,_t){return this._subject.subscribe({next:W,error:be,complete:_t})}}return(k=X).normalizeQueryParams=wt,k.joinWithSlash=tt,k.stripTrailingSlash=nt,k.\u0275fac=function(W){return new(W||k)(T.LFG(ht))},k.\u0275prov=T.Yz7({token:k,factory:function(){return function st(){return new It((0,T.LFG)(ht))}()},providedIn:"root"}),X})();function Tt(k){return k.replace(/\/index.html$/,"")}function bi(k,X){X=encodeURIComponent(X);for(const Be of k.split(";")){const W=Be.indexOf("="),[be,_t]=-1==W?[Be,""]:[Be.slice(0,W),Be.slice(W+1)];if(be.trim()===X)return decodeURIComponent(_t)}return null}const Ur=/\s+/,So=[];let zt=(()=>{var k;class X{constructor(W,be,_t,kt){this._iterableDiffers=W,this._keyValueDiffers=be,this._ngEl=_t,this._renderer=kt,this.initialClasses=So,this.stateMap=new Map}set klass(W){this.initialClasses=null!=W?W.trim().split(Ur):So}set ngClass(W){this.rawClass="string"==typeof W?W.trim().split(Ur):W}ngDoCheck(){for(const be of this.initialClasses)this._updateState(be,!0);const W=this.rawClass;if(Array.isArray(W)||W instanceof Set)for(const be of W)this._updateState(be,!0);else if(null!=W)for(const be of Object.keys(W))this._updateState(be,!!W[be]);this._applyStateDiff()}_updateState(W,be){const _t=this.stateMap.get(W);void 0!==_t?(_t.enabled!==be&&(_t.changed=!0,_t.enabled=be),_t.touched=!0):this.stateMap.set(W,{enabled:be,changed:!0,touched:!0})}_applyStateDiff(){for(const W of this.stateMap){const be=W[0],_t=W[1];_t.changed?(this._toggleClass(be,_t.enabled),_t.changed=!1):_t.touched||(_t.enabled&&this._toggleClass(be,!1),this.stateMap.delete(be)),_t.touched=!1}}_toggleClass(W,be){(W=W.trim()).length>0&&W.split(Ur).forEach(_t=>{be?this._renderer.addClass(this._ngEl.nativeElement,_t):this._renderer.removeClass(this._ngEl.nativeElement,_t)})}}return(k=X).\u0275fac=function(W){return new(W||k)(T.Y36(T.ZZ4),T.Y36(T.aQg),T.Y36(T.SBq),T.Y36(T.Qsj))},k.\u0275dir=T.lG2({type:k,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),X})();class Fi{constructor(X,Be,W,be){this.$implicit=X,this.ngForOf=Be,this.index=W,this.count=be}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Vi=(()=>{var k;class X{set ngForOf(W){this._ngForOf=W,this._ngForOfDirty=!0}set ngForTrackBy(W){this._trackByFn=W}get ngForTrackBy(){return this._trackByFn}constructor(W,be,_t){this._viewContainer=W,this._template=be,this._differs=_t,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(W){W&&(this._template=W)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const W=this._ngForOf;!this._differ&&W&&(this._differ=this._differs.find(W).create(this.ngForTrackBy))}if(this._differ){const W=this._differ.diff(this._ngForOf);W&&this._applyChanges(W)}}_applyChanges(W){const be=this._viewContainer;W.forEachOperation((_t,kt,Ut)=>{if(null==_t.previousIndex)be.createEmbeddedView(this._template,new Fi(_t.item,this._ngForOf,-1,-1),null===Ut?void 0:Ut);else if(null==Ut)be.remove(null===kt?void 0:kt);else if(null!==kt){const tr=be.get(kt);be.move(tr,Ut),Ui(tr,_t)}});for(let _t=0,kt=be.length;_t<kt;_t++){const tr=be.get(_t).context;tr.index=_t,tr.count=kt,tr.ngForOf=this._ngForOf}W.forEachIdentityChange(_t=>{Ui(be.get(_t.currentIndex),_t)})}static ngTemplateContextGuard(W,be){return!0}}return(k=X).\u0275fac=function(W){return new(W||k)(T.Y36(T.s_b),T.Y36(T.Rgc),T.Y36(T.ZZ4))},k.\u0275dir=T.lG2({type:k,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),X})();function Ui(k,X){k.context.$implicit=X.item}let so=(()=>{var k;class X{constructor(W,be){this._viewContainer=W,this._context=new yo,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=be}set ngIf(W){this._context.$implicit=this._context.ngIf=W,this._updateView()}set ngIfThen(W){Kn("ngIfThen",W),this._thenTemplateRef=W,this._thenViewRef=null,this._updateView()}set ngIfElse(W){Kn("ngIfElse",W),this._elseTemplateRef=W,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(W,be){return!0}}return(k=X).\u0275fac=function(W){return new(W||k)(T.Y36(T.s_b),T.Y36(T.Rgc))},k.\u0275dir=T.lG2({type:k,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),X})();class yo{constructor(){this.$implicit=null,this.ngIf=null}}function Kn(k,X){if(X&&!X.createEmbeddedView)throw new Error(`${k} must be a TemplateRef, but received '${(0,T.AaK)(X)}'.`)}class Br{constructor(X,Be){this._viewContainerRef=X,this._templateRef=Be,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(X){X&&!this._created?this.create():!X&&this._created&&this.destroy()}}let le=(()=>{var k;class X{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(W){this._ngSwitch=W,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(W){this._defaultViews.push(W)}_matchCase(W){const be=W==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||be,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),be}_updateDefaultCases(W){if(this._defaultViews.length>0&&W!==this._defaultUsed){this._defaultUsed=W;for(const be of this._defaultViews)be.enforceState(W)}}}return(k=X).\u0275fac=function(W){return new(W||k)},k.\u0275dir=T.lG2({type:k,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),X})(),Oe=(()=>{var k;class X{constructor(W,be,_t){this.ngSwitch=_t,_t._addCase(),this._view=new Br(W,be)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return(k=X).\u0275fac=function(W){return new(W||k)(T.Y36(T.s_b),T.Y36(T.Rgc),T.Y36(le,9))},k.\u0275dir=T.lG2({type:k,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),X})(),pe=(()=>{var k;class X{constructor(W,be,_t){_t._addDefault(new Br(W,be))}}return(k=X).\u0275fac=function(W){return new(W||k)(T.Y36(T.s_b),T.Y36(T.Rgc),T.Y36(le,9))},k.\u0275dir=T.lG2({type:k,selectors:[["","ngSwitchDefault",""]],standalone:!0}),X})(),bn=(()=>{var k;class X{constructor(W){this._viewContainerRef=W,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(W){if(W.ngTemplateOutlet||W.ngTemplateOutletInjector){const be=this._viewContainerRef;if(this._viewRef&&be.remove(be.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:_t,ngTemplateOutletContext:kt,ngTemplateOutletInjector:Ut}=this;this._viewRef=be.createEmbeddedView(_t,kt,Ut?{injector:Ut}:void 0)}else this._viewRef=null}else this._viewRef&&W.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return(k=X).\u0275fac=function(W){return new(W||k)(T.Y36(T.s_b))},k.\u0275dir=T.lG2({type:k,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[T.TTD]}),X})(),_s=(()=>{var k;class X{}return(k=X).\u0275fac=function(W){return new(W||k)},k.\u0275mod=T.oAB({type:k}),k.\u0275inj=T.cJS({}),X})();const rs="browser",io="server";function $o(k){return k===rs}function Bo(k){return k===io}let ys=(()=>{var k;class X{}return(k=X).\u0275prov=(0,T.Yz7)({token:k,providedIn:"root",factory:()=>new Ni((0,T.LFG)(ot),window)}),X})();class Ni{constructor(X,Be){this.document=X,this.window=Be,this.offset=()=>[0,0]}setOffset(X){this.offset=Array.isArray(X)?()=>X:X}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(X){this.supportsScrolling()&&this.window.scrollTo(X[0],X[1])}scrollToAnchor(X){if(!this.supportsScrolling())return;const Be=function aa(k,X){const Be=k.getElementById(X)||k.getElementsByName(X)[0];if(Be)return Be;if("function"==typeof k.createTreeWalker&&k.body&&"function"==typeof k.body.attachShadow){const W=k.createTreeWalker(k.body,NodeFilter.SHOW_ELEMENT);let be=W.currentNode;for(;be;){const _t=be.shadowRoot;if(_t){const kt=_t.getElementById(X)||_t.querySelector(`[name="${X}"]`);if(kt)return kt}be=W.nextNode()}}return null}(this.document,X);Be&&(this.scrollToElement(Be),Be.focus())}setHistoryScrollRestoration(X){this.supportsScrolling()&&(this.window.history.scrollRestoration=X)}scrollToElement(X){const Be=X.getBoundingClientRect(),W=Be.left+this.window.pageXOffset,be=Be.top+this.window.pageYOffset,_t=this.offset();this.window.scrollTo(W-_t[0],be-_t[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class vs{}},9862:(fr,en,oe)=>{"use strict";oe.d(en,{JF:()=>He,WM:()=>ht,eN:()=>Me});var T=oe(9468),b=oe(2096),Lt=oe(7715),l=oe(5592),Ee=oe(6328),ot=oe(2181),qe=oe(7398),Et=oe(4716),vt=oe(4664),tt=oe(6814);class nt{}class wt{}class ht{constructor(Ke){this.normalizedNames=new Map,this.lazyUpdate=null,Ke?"string"==typeof Ke?this.lazyInit=()=>{this.headers=new Map,Ke.split("\n").forEach(tn=>{const Xt=tn.indexOf(":");if(Xt>0){const yn=tn.slice(0,Xt),zn=yn.toLowerCase(),br=tn.slice(Xt+1).trim();this.maybeSetNormalizedName(yn,zn),this.headers.has(zn)?this.headers.get(zn).push(br):this.headers.set(zn,[br])}})}:typeof Headers<"u"&&Ke instanceof Headers?(this.headers=new Map,Ke.forEach((tn,Xt)=>{this.setHeaderEntries(Xt,tn)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(Ke).forEach(([tn,Xt])=>{this.setHeaderEntries(tn,Xt)})}:this.headers=new Map}has(Ke){return this.init(),this.headers.has(Ke.toLowerCase())}get(Ke){this.init();const tn=this.headers.get(Ke.toLowerCase());return tn&&tn.length>0?tn[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Ke){return this.init(),this.headers.get(Ke.toLowerCase())||null}append(Ke,tn){return this.clone({name:Ke,value:tn,op:"a"})}set(Ke,tn){return this.clone({name:Ke,value:tn,op:"s"})}delete(Ke,tn){return this.clone({name:Ke,value:tn,op:"d"})}maybeSetNormalizedName(Ke,tn){this.normalizedNames.has(tn)||this.normalizedNames.set(tn,Ke)}init(){this.lazyInit&&(this.lazyInit instanceof ht?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Ke=>this.applyUpdate(Ke)),this.lazyUpdate=null))}copyFrom(Ke){Ke.init(),Array.from(Ke.headers.keys()).forEach(tn=>{this.headers.set(tn,Ke.headers.get(tn)),this.normalizedNames.set(tn,Ke.normalizedNames.get(tn))})}clone(Ke){const tn=new ht;return tn.lazyInit=this.lazyInit&&this.lazyInit instanceof ht?this.lazyInit:this,tn.lazyUpdate=(this.lazyUpdate||[]).concat([Ke]),tn}applyUpdate(Ke){const tn=Ke.name.toLowerCase();switch(Ke.op){case"a":case"s":let Xt=Ke.value;if("string"==typeof Xt&&(Xt=[Xt]),0===Xt.length)return;this.maybeSetNormalizedName(Ke.name,tn);const yn=("a"===Ke.op?this.headers.get(tn):void 0)||[];yn.push(...Xt),this.headers.set(tn,yn);break;case"d":const zn=Ke.value;if(zn){let br=this.headers.get(tn);if(!br)return;br=br.filter(or=>-1===zn.indexOf(or)),0===br.length?(this.headers.delete(tn),this.normalizedNames.delete(tn)):this.headers.set(tn,br)}else this.headers.delete(tn),this.normalizedNames.delete(tn)}}setHeaderEntries(Ke,tn){const Xt=(Array.isArray(tn)?tn:[tn]).map(zn=>zn.toString()),yn=Ke.toLowerCase();this.headers.set(yn,Xt),this.maybeSetNormalizedName(Ke,yn)}forEach(Ke){this.init(),Array.from(this.normalizedNames.keys()).forEach(tn=>Ke(this.normalizedNames.get(tn),this.headers.get(tn)))}}class xt{encodeKey(Ke){return sn(Ke)}encodeValue(Ke){return sn(Ke)}decodeKey(Ke){return decodeURIComponent(Ke)}decodeValue(Ke){return decodeURIComponent(Ke)}}const It=/%(\d[a-f0-9])/gi,st={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function sn(rt){return encodeURIComponent(rt).replace(It,(Ke,tn)=>st[tn]??Ke)}function Tt(rt){return`${rt}`}class Ge{constructor(Ke={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Ke.encoder||new xt,Ke.fromString){if(Ke.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Kt(rt,Ke){const tn=new Map;return rt.length>0&&rt.replace(/^\?/,"").split("&").forEach(yn=>{const zn=yn.indexOf("="),[br,or]=-1==zn?[Ke.decodeKey(yn),""]:[Ke.decodeKey(yn.slice(0,zn)),Ke.decodeValue(yn.slice(zn+1))],hi=tn.get(br)||[];hi.push(or),tn.set(br,hi)}),tn}(Ke.fromString,this.encoder)}else Ke.fromObject?(this.map=new Map,Object.keys(Ke.fromObject).forEach(tn=>{const Xt=Ke.fromObject[tn],yn=Array.isArray(Xt)?Xt.map(Tt):[Tt(Xt)];this.map.set(tn,yn)})):this.map=null}has(Ke){return this.init(),this.map.has(Ke)}get(Ke){this.init();const tn=this.map.get(Ke);return tn?tn[0]:null}getAll(Ke){return this.init(),this.map.get(Ke)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Ke,tn){return this.clone({param:Ke,value:tn,op:"a"})}appendAll(Ke){const tn=[];return Object.keys(Ke).forEach(Xt=>{const yn=Ke[Xt];Array.isArray(yn)?yn.forEach(zn=>{tn.push({param:Xt,value:zn,op:"a"})}):tn.push({param:Xt,value:yn,op:"a"})}),this.clone(tn)}set(Ke,tn){return this.clone({param:Ke,value:tn,op:"s"})}delete(Ke,tn){return this.clone({param:Ke,value:tn,op:"d"})}toString(){return this.init(),this.keys().map(Ke=>{const tn=this.encoder.encodeKey(Ke);return this.map.get(Ke).map(Xt=>tn+"="+this.encoder.encodeValue(Xt)).join("&")}).filter(Ke=>""!==Ke).join("&")}clone(Ke){const tn=new Ge({encoder:this.encoder});return tn.cloneFrom=this.cloneFrom||this,tn.updates=(this.updates||[]).concat(Ke),tn}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Ke=>this.map.set(Ke,this.cloneFrom.map.get(Ke))),this.updates.forEach(Ke=>{switch(Ke.op){case"a":case"s":const tn=("a"===Ke.op?this.map.get(Ke.param):void 0)||[];tn.push(Tt(Ke.value)),this.map.set(Ke.param,tn);break;case"d":if(void 0===Ke.value){this.map.delete(Ke.param);break}{let Xt=this.map.get(Ke.param)||[];const yn=Xt.indexOf(Tt(Ke.value));-1!==yn&&Xt.splice(yn,1),Xt.length>0?this.map.set(Ke.param,Xt):this.map.delete(Ke.param)}}}),this.cloneFrom=this.updates=null)}}class Yt{constructor(){this.map=new Map}set(Ke,tn){return this.map.set(Ke,tn),this}get(Ke){return this.map.has(Ke)||this.map.set(Ke,Ke.defaultValue()),this.map.get(Ke)}delete(Ke){return this.map.delete(Ke),this}has(Ke){return this.map.has(Ke)}keys(){return this.map.keys()}}function De(rt){return typeof ArrayBuffer<"u"&&rt instanceof ArrayBuffer}function ft(rt){return typeof Blob<"u"&&rt instanceof Blob}function Nt(rt){return typeof FormData<"u"&&rt instanceof FormData}class mn{constructor(Ke,tn,Xt,yn){let zn;if(this.url=tn,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Ke.toUpperCase(),function _n(rt){switch(rt){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||yn?(this.body=void 0!==Xt?Xt:null,zn=yn):zn=Xt,zn&&(this.reportProgress=!!zn.reportProgress,this.withCredentials=!!zn.withCredentials,zn.responseType&&(this.responseType=zn.responseType),zn.headers&&(this.headers=zn.headers),zn.context&&(this.context=zn.context),zn.params&&(this.params=zn.params)),this.headers||(this.headers=new ht),this.context||(this.context=new Yt),this.params){const br=this.params.toString();if(0===br.length)this.urlWithParams=tn;else{const or=tn.indexOf("?");this.urlWithParams=tn+(-1===or?"?":or<tn.length-1?"&":"")+br}}else this.params=new Ge,this.urlWithParams=tn}serializeBody(){return null===this.body?null:De(this.body)||ft(this.body)||Nt(this.body)||function yt(rt){return typeof URLSearchParams<"u"&&rt instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ge?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Nt(this.body)?null:ft(this.body)?this.body.type||null:De(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ge?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Ke={}){const tn=Ke.method||this.method,Xt=Ke.url||this.url,yn=Ke.responseType||this.responseType,zn=void 0!==Ke.body?Ke.body:this.body,br=void 0!==Ke.withCredentials?Ke.withCredentials:this.withCredentials,or=void 0!==Ke.reportProgress?Ke.reportProgress:this.reportProgress;let hi=Ke.headers||this.headers,Sr=Ke.params||this.params;const mi=Ke.context??this.context;return void 0!==Ke.setHeaders&&(hi=Object.keys(Ke.setHeaders).reduce((Yr,li)=>Yr.set(li,Ke.setHeaders[li]),hi)),Ke.setParams&&(Sr=Object.keys(Ke.setParams).reduce((Yr,li)=>Yr.set(li,Ke.setParams[li]),Sr)),new mn(tn,Xt,zn,{params:Sr,headers:hi,context:mi,reportProgress:or,responseType:yn,withCredentials:br})}}var hn=function(rt){return rt[rt.Sent=0]="Sent",rt[rt.UploadProgress=1]="UploadProgress",rt[rt.ResponseHeader=2]="ResponseHeader",rt[rt.DownloadProgress=3]="DownloadProgress",rt[rt.Response=4]="Response",rt[rt.User=5]="User",rt}(hn||{});class Gt{constructor(Ke,tn=200,Xt="OK"){this.headers=Ke.headers||new ht,this.status=void 0!==Ke.status?Ke.status:tn,this.statusText=Ke.statusText||Xt,this.url=Ke.url||null,this.ok=this.status>=200&&this.status<300}}class nr extends Gt{constructor(Ke={}){super(Ke),this.type=hn.ResponseHeader}clone(Ke={}){return new nr({headers:Ke.headers||this.headers,status:void 0!==Ke.status?Ke.status:this.status,statusText:Ke.statusText||this.statusText,url:Ke.url||this.url||void 0})}}class Wt extends Gt{constructor(Ke={}){super(Ke),this.type=hn.Response,this.body=void 0!==Ke.body?Ke.body:null}clone(Ke={}){return new Wt({body:void 0!==Ke.body?Ke.body:this.body,headers:Ke.headers||this.headers,status:void 0!==Ke.status?Ke.status:this.status,statusText:Ke.statusText||this.statusText,url:Ke.url||this.url||void 0})}}class pr extends Gt{constructor(Ke){super(Ke,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Ke.url||"(unknown url)"}`:`Http failure response for ${Ke.url||"(unknown url)"}: ${Ke.status} ${Ke.statusText}`,this.error=Ke.error||null}}function an(rt,Ke){return{body:Ke,headers:rt.headers,context:rt.context,observe:rt.observe,params:rt.params,reportProgress:rt.reportProgress,responseType:rt.responseType,withCredentials:rt.withCredentials}}let Me=(()=>{var rt;class Ke{constructor(Xt){this.handler=Xt}request(Xt,yn,zn={}){let br;if(Xt instanceof mn)br=Xt;else{let Sr,mi;Sr=zn.headers instanceof ht?zn.headers:new ht(zn.headers),zn.params&&(mi=zn.params instanceof Ge?zn.params:new Ge({fromObject:zn.params})),br=new mn(Xt,yn,void 0!==zn.body?zn.body:null,{headers:Sr,context:zn.context,params:mi,reportProgress:zn.reportProgress,responseType:zn.responseType||"json",withCredentials:zn.withCredentials})}const or=(0,b.of)(br).pipe((0,Ee.b)(Sr=>this.handler.handle(Sr)));if(Xt instanceof mn||"events"===zn.observe)return or;const hi=or.pipe((0,ot.h)(Sr=>Sr instanceof Wt));switch(zn.observe||"body"){case"body":switch(br.responseType){case"arraybuffer":return hi.pipe((0,qe.U)(Sr=>{if(null!==Sr.body&&!(Sr.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Sr.body}));case"blob":return hi.pipe((0,qe.U)(Sr=>{if(null!==Sr.body&&!(Sr.body instanceof Blob))throw new Error("Response is not a Blob.");return Sr.body}));case"text":return hi.pipe((0,qe.U)(Sr=>{if(null!==Sr.body&&"string"!=typeof Sr.body)throw new Error("Response is not a string.");return Sr.body}));default:return hi.pipe((0,qe.U)(Sr=>Sr.body))}case"response":return hi;default:throw new Error(`Unreachable: unhandled observe type ${zn.observe}}`)}}delete(Xt,yn={}){return this.request("DELETE",Xt,yn)}get(Xt,yn={}){return this.request("GET",Xt,yn)}head(Xt,yn={}){return this.request("HEAD",Xt,yn)}jsonp(Xt,yn){return this.request("JSONP",Xt,{params:(new Ge).append(yn,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Xt,yn={}){return this.request("OPTIONS",Xt,yn)}patch(Xt,yn,zn={}){return this.request("PATCH",Xt,an(zn,yn))}post(Xt,yn,zn={}){return this.request("POST",Xt,an(zn,yn))}put(Xt,yn,zn={}){return this.request("PUT",Xt,an(zn,yn))}}return(rt=Ke).\u0275fac=function(Xt){return new(Xt||rt)(T.LFG(nt))},rt.\u0275prov=T.Yz7({token:rt,factory:rt.\u0275fac}),Ke})();function Mn(rt,Ke){return Ke(rt)}function Ot(rt,Ke){return(tn,Xt)=>Ke.intercept(tn,{handle:yn=>rt(yn,Xt)})}const $t=new T.OlP(""),vn=new T.OlP(""),Gn=new T.OlP("");function Cr(){let rt=null;return(Ke,tn)=>{null===rt&&(rt=((0,T.f3M)($t,{optional:!0})??[]).reduceRight(Ot,Mn));const Xt=(0,T.f3M)(T.HDt),yn=Xt.add();return rt(Ke,tn).pipe((0,Et.x)(()=>Xt.remove(yn)))}}let Wn=(()=>{var rt;class Ke extends nt{constructor(Xt,yn){super(),this.backend=Xt,this.injector=yn,this.chain=null,this.pendingTasks=(0,T.f3M)(T.HDt)}handle(Xt){if(null===this.chain){const zn=Array.from(new Set([...this.injector.get(vn),...this.injector.get(Gn,[])]));this.chain=zn.reduceRight((br,or)=>function qt(rt,Ke,tn){return(Xt,yn)=>tn.runInContext(()=>Ke(Xt,zn=>rt(zn,yn)))}(br,or,this.injector),Mn)}const yn=this.pendingTasks.add();return this.chain(Xt,zn=>this.backend.handle(zn)).pipe((0,Et.x)(()=>this.pendingTasks.remove(yn)))}}return(rt=Ke).\u0275fac=function(Xt){return new(Xt||rt)(T.LFG(wt),T.LFG(T.lqb))},rt.\u0275prov=T.Yz7({token:rt,factory:rt.\u0275fac}),Ke})();const Tr=/^\)\]\}',?\n/;let Lr=(()=>{var rt;class Ke{constructor(Xt){this.xhrFactory=Xt}handle(Xt){if("JSONP"===Xt.method)throw new T.vHH(-2800,!1);const yn=this.xhrFactory;return(yn.\u0275loadImpl?(0,Lt.D)(yn.\u0275loadImpl()):(0,b.of)(null)).pipe((0,vt.w)(()=>new l.y(br=>{const or=yn.build();if(or.open(Xt.method,Xt.urlWithParams),Xt.withCredentials&&(or.withCredentials=!0),Xt.headers.forEach((zt,ei)=>or.setRequestHeader(zt,ei.join(","))),Xt.headers.has("Accept")||or.setRequestHeader("Accept","application/json, text/plain, */*"),!Xt.headers.has("Content-Type")){const zt=Xt.detectContentTypeHeader();null!==zt&&or.setRequestHeader("Content-Type",zt)}if(Xt.responseType){const zt=Xt.responseType.toLowerCase();or.responseType="json"!==zt?zt:"text"}const hi=Xt.serializeBody();let Sr=null;const mi=()=>{if(null!==Sr)return Sr;const zt=or.statusText||"OK",ei=new ht(or.getAllResponseHeaders()),Ri=function $i(rt){return"responseURL"in rt&&rt.responseURL?rt.responseURL:/^X-Request-URL:/m.test(rt.getAllResponseHeaders())?rt.getResponseHeader("X-Request-URL"):null}(or)||Xt.url;return Sr=new nr({headers:ei,status:or.status,statusText:zt,url:Ri}),Sr},Yr=()=>{let{headers:zt,status:ei,statusText:Ri,url:Fi}=mi(),Vi=null;204!==ei&&(Vi=typeof or.response>"u"?or.responseText:or.response),0===ei&&(ei=Vi?200:0);let Ui=ei>=200&&ei<300;if("json"===Xt.responseType&&"string"==typeof Vi){const _o=Vi;Vi=Vi.replace(Tr,"");try{Vi=""!==Vi?JSON.parse(Vi):null}catch(so){Vi=_o,Ui&&(Ui=!1,Vi={error:so,text:Vi})}}Ui?(br.next(new Wt({body:Vi,headers:zt,status:ei,statusText:Ri,url:Fi||void 0})),br.complete()):br.error(new pr({error:Vi,headers:zt,status:ei,statusText:Ri,url:Fi||void 0}))},li=zt=>{const{url:ei}=mi(),Ri=new pr({error:zt,status:or.status||0,statusText:or.statusText||"Unknown Error",url:ei||void 0});br.error(Ri)};let bi=!1;const Ur=zt=>{bi||(br.next(mi()),bi=!0);let ei={type:hn.DownloadProgress,loaded:zt.loaded};zt.lengthComputable&&(ei.total=zt.total),"text"===Xt.responseType&&or.responseText&&(ei.partialText=or.responseText),br.next(ei)},So=zt=>{let ei={type:hn.UploadProgress,loaded:zt.loaded};zt.lengthComputable&&(ei.total=zt.total),br.next(ei)};return or.addEventListener("load",Yr),or.addEventListener("error",li),or.addEventListener("timeout",li),or.addEventListener("abort",li),Xt.reportProgress&&(or.addEventListener("progress",Ur),null!==hi&&or.upload&&or.upload.addEventListener("progress",So)),or.send(hi),br.next({type:hn.Sent}),()=>{or.removeEventListener("error",li),or.removeEventListener("abort",li),or.removeEventListener("load",Yr),or.removeEventListener("timeout",li),Xt.reportProgress&&(or.removeEventListener("progress",Ur),null!==hi&&or.upload&&or.upload.removeEventListener("progress",So)),or.readyState!==or.DONE&&or.abort()}})))}}return(rt=Ke).\u0275fac=function(Xt){return new(Xt||rt)(T.LFG(tt.JF))},rt.\u0275prov=T.Yz7({token:rt,factory:rt.\u0275fac}),Ke})();const si=new T.OlP("XSRF_ENABLED"),ai=new T.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),ii=new T.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class cs{}let je=(()=>{var rt;class Ke{constructor(Xt,yn,zn){this.doc=Xt,this.platform=yn,this.cookieName=zn,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Xt=this.doc.cookie||"";return Xt!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,tt.Mx)(Xt,this.cookieName),this.lastCookieString=Xt),this.lastToken}}return(rt=Ke).\u0275fac=function(Xt){return new(Xt||rt)(T.LFG(tt.K0),T.LFG(T.Lbi),T.LFG(ai))},rt.\u0275prov=T.Yz7({token:rt,factory:rt.\u0275fac}),Ke})();function ae(rt,Ke){const tn=rt.url.toLowerCase();if(!(0,T.f3M)(si)||"GET"===rt.method||"HEAD"===rt.method||tn.startsWith("http://")||tn.startsWith("https://"))return Ke(rt);const Xt=(0,T.f3M)(cs).getToken(),yn=(0,T.f3M)(ii);return null!=Xt&&!rt.headers.has(yn)&&(rt=rt.clone({headers:rt.headers.set(yn,Xt)})),Ke(rt)}var ke=function(rt){return rt[rt.Interceptors=0]="Interceptors",rt[rt.LegacyInterceptors=1]="LegacyInterceptors",rt[rt.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",rt[rt.NoXsrfProtection=3]="NoXsrfProtection",rt[rt.JsonpSupport=4]="JsonpSupport",rt[rt.RequestsMadeViaParent=5]="RequestsMadeViaParent",rt[rt.Fetch=6]="Fetch",rt}(ke||{});function Ye(rt,Ke){return{\u0275kind:rt,\u0275providers:Ke}}function dt(...rt){const Ke=[Me,Lr,Wn,{provide:nt,useExisting:Wn},{provide:wt,useExisting:Lr},{provide:vn,useValue:ae,multi:!0},{provide:si,useValue:!0},{provide:cs,useClass:je}];for(const tn of rt)Ke.push(...tn.\u0275providers);return(0,T.MR2)(Ke)}const St=new T.OlP("LEGACY_INTERCEPTOR_FN");let He=(()=>{var rt;class Ke{}return(rt=Ke).\u0275fac=function(Xt){return new(Xt||rt)},rt.\u0275mod=T.oAB({type:rt}),rt.\u0275inj=T.cJS({providers:[dt(Ye(ke.LegacyInterceptors,[{provide:St,useFactory:Cr},{provide:vn,useExisting:St,multi:!0}]))]}),Ke})()},9468:(fr,en,oe)=>{"use strict";oe.d(en,{QbO:()=>F_,tb:()=>ov,AFp:()=>jd,ip1:()=>ab,hGG:()=>hC,z2F:()=>kf,Ojb:()=>B_,sBO:()=>XD,Sil:()=>hD,_Vd:()=>qd,EJc:()=>cD,Xts:()=>kc,SBq:()=>da,lqb:()=>Wa,qLn:()=>sd,vpe:()=>nu,tBr:()=>Cm,XFs:()=>Tr,OlP:()=>To,zs3:()=>ml,ZZ4:()=>dv,aQg:()=>hv,soG:()=>n_,YKP:()=>dx,h0i:()=>uh,PXZ:()=>VD,R0b:()=>sl,FiY:()=>as,Lbi:()=>ef,g9A:()=>Dp,n_E:()=>Kg,Qsj:()=>il,FYo:()=>Op,JOm:()=>Nu,tp0:()=>Tl,Rgc:()=>vm,dDg:()=>BD,eoX:()=>xb,GfV:()=>Eu,s_b:()=>e_,ifc:()=>Sr,VuI:()=>EC,LMc:()=>CC,MMx:()=>fx,Lck:()=>Gw,eFA:()=>Db,G48:()=>ZD,Gpc:()=>sn,f3M:()=>rt,$WT:()=>gs,MR2:()=>xu,_c5:()=>dC,qFp:()=>TC,rg0:()=>fa,c2e:()=>lb,zSh:()=>wp,HDt:()=>cb,wAp:()=>Af,vHH:()=>De,lri:()=>yb,rWj:()=>vb,cg1:()=>Ay,kL8:()=>F0,dqk:()=>Pi,Z0I:()=>An,eJc:()=>qy,QGY:()=>xy,F4k:()=>Bv,RDi:()=>dc,AaK:()=>Kt,qOj:()=>sh,Xq5:()=>O,TTD:()=>k,_Bn:()=>ux,jDz:()=>px,xp6:()=>bg,uIk:()=>rn,Gre:()=>C0,ekj:()=>Ty,Suo:()=>$x,Xpm:()=>zo,lG2:()=>wa,Yz7:()=>Wn,cJS:()=>er,oAB:()=>Io,Yjl:()=>sa,Y36:()=>ud,_UZ:()=>gy,GkF:()=>vy,qZA:()=>ec,TgZ:()=>ah,EpF:()=>Fv,n5z:()=>Ja,Ikx:()=>My,LFG:()=>Qr,$8M:()=>ps,$Z:()=>dd,NdJ:()=>by,CRH:()=>Vx,kcU:()=>Bl,O4$:()=>Da,oxw:()=>Uv,Hsn:()=>Hv,F$t:()=>jv,Q6J:()=>Ma,DdM:()=>bx,iGM:()=>Nx,MAs:()=>za,KtG:()=>Ll,CHM:()=>El,P3R:()=>_p,YNc:()=>Jc,_uU:()=>m0,Oqu:()=>Iy,hij:()=>Wg,Gf:()=>zx});var T=oe(8645),b=oe(7394),Lt=oe(5619),l=oe(5592),Ee=oe(3019),ot=oe(2096),qe=oe(4829),Et=oe(305),vt=oe(9360);function tt(t={}){const{connector:o=(()=>new T.x),resetOnError:a=!0,resetOnComplete:d=!0,resetOnRefCountZero:m=!0}=t;return v=>{let D,P,V,ne=0,he=!1,Ve=!1;const Ct=()=>{P?.unsubscribe(),P=void 0},jt=()=>{Ct(),D=V=void 0,he=Ve=!1},On=()=>{const Jn=D;jt(),Jn?.unsubscribe()};return(0,vt.e)((Jn,xr)=>{ne++,!Ve&&!he&&Ct();const qr=V=V??o();xr.add(()=>{ne--,0===ne&&!Ve&&!he&&(P=nt(On,m))}),qr.subscribe(xr),!D&&ne>0&&(D=new Et.Hp({next:Hn=>qr.next(Hn),error:Hn=>{Ve=!0,Ct(),P=nt(jt,a,Hn),qr.error(Hn)},complete:()=>{he=!0,Ct(),P=nt(jt,d),qr.complete()}}),(0,qe.Xf)(Jn).subscribe(D))})(v)}}function nt(t,o,...a){if(!0===o)return void t();if(!1===o)return;const d=new Et.Hp({next:()=>{d.unsubscribe(),t()}});return(0,qe.Xf)(o(...a)).subscribe(d)}var wt=oe(4664),ht=oe(3997);function et(t){for(let o in t)if(t[o]===et)return o;throw Error("Could not find renamed property on target object.")}function xt(t,o){for(const a in o)o.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=o[a])}function Kt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Kt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const o=t.toString();if(null==o)return""+o;const a=o.indexOf("\n");return-1===a?o:o.substring(0,a)}function It(t,o){return null==t||""===t?null===o?"":o:null==o||""===o?t:t+" "+o}const st=et({__forward_ref__:et});function sn(t){return t.__forward_ref__=sn,t.toString=function(){return Kt(this())},t}function Tt(t){return Ge(t)?t():t}function Ge(t){return"function"==typeof t&&t.hasOwnProperty(st)&&t.__forward_ref__===sn}function Le(t){return t&&!!t.\u0275providers}const _n="https://g.co/ng/security#xss";class De extends Error{constructor(o,a){super(function ft(t,o){return`NG0${Math.abs(t)}${o?": "+o:""}`}(o,a)),this.code=o}}function Nt(t){return"string"==typeof t?t:null==t?"":String(t)}function nr(t,o){throw new De(-201,!1)}function qt(t,o){null==t&&function $t(t,o,a,d){throw new Error(`ASSERTION ERROR: ${t}`+(null==d?"":` [Expected=> ${a} ${d} ${o} <=Actual]`))}(o,t,null,"!=")}function Wn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function er(t){return{providers:t.providers||[],imports:t.imports||[]}}function kr(t){return vi(t,zi)||vi(t,Hr)}function An(t){return null!==kr(t)}function vi(t,o){return t.hasOwnProperty(o)?t[o]:null}function Ai(t){return t&&(t.hasOwnProperty(Ir)||t.hasOwnProperty(Lo))?t[Ir]:null}const zi=et({\u0275prov:et}),Ir=et({\u0275inj:et}),Hr=et({ngInjectableDef:et}),Lo=et({ngInjectorDef:et});var Tr=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(Tr||{});let $i;function si(t){const o=$i;return $i=t,o}function Gi(t,o,a){const d=kr(t);return d&&"root"==d.providedIn?void 0===d.value?d.value=d.factory():d.value:a&Tr.Optional?null:void 0!==o?o:void nr(Kt(t))}const Pi=globalThis,Ln={},Je="__NG_DI_FLAG__",Ze="ngTempTokenPath",He=/\n/gm,dn="__source";let qn;function Mr(t){const o=qn;return qn=t,o}function $r(t,o=Tr.Default){if(void 0===qn)throw new De(-203,!1);return null===qn?Gi(t,void 0,o):qn.get(t,o&Tr.Optional?null:void 0,o)}function Qr(t,o=Tr.Default){return(function Lr(){return $i}()||$r)(Tt(t),o)}function rt(t,o=Tr.Default){return Qr(t,Ke(o))}function Ke(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function tn(t){const o=[];for(let a=0;a<t.length;a++){const d=Tt(t[a]);if(Array.isArray(d)){if(0===d.length)throw new De(900,!1);let m,v=Tr.Default;for(let D=0;D<d.length;D++){const P=d[D],V=yn(P);"number"==typeof V?-1===V?m=P.token:v|=V:m=P}o.push(Qr(m,v))}else o.push(Qr(d))}return o}function Xt(t,o){return t[Je]=o,t.prototype[Je]=o,t}function yn(t){return t[Je]}function or(t){return{toString:t}.toString()}var hi=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(hi||{}),Sr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Sr||{});const mi={},Yr=[],li=et({\u0275cmp:et}),bi=et({\u0275dir:et}),Ur=et({\u0275pipe:et}),So=et({\u0275mod:et}),zt=et({\u0275fac:et}),ei=et({__NG_ELEMENT_ID__:et}),Ri=et({__NG_ENV_ID__:et});function Fi(t,o,a){let d=t.length;for(;;){const m=t.indexOf(o,a);if(-1===m)return m;if(0===m||t.charCodeAt(m-1)<=32){const v=o.length;if(m+v===d||t.charCodeAt(m+v)<=32)return m}a=m+1}}function Vi(t,o,a){let d=0;for(;d<a.length;){const m=a[d];if("number"==typeof m){if(0!==m)break;d++;const v=a[d++],D=a[d++],P=a[d++];t.setAttribute(o,D,P,v)}else{const v=m,D=a[++d];_o(v)?t.setProperty(o,v,D):t.setAttribute(o,v,D),d++}}return d}function Ui(t){return 3===t||4===t||6===t}function _o(t){return 64===t.charCodeAt(0)}function so(t,o){if(null!==o&&0!==o.length)if(null===t||0===t.length)t=o.slice();else{let a=-1;for(let d=0;d<o.length;d++){const m=o[d];"number"==typeof m?a=m:0===a||yo(t,a,m,null,-1===a||2===a?o[++d]:null)}}return t}function yo(t,o,a,d,m){let v=0,D=t.length;if(-1===o)D=-1;else for(;v<t.length;){const P=t[v++];if("number"==typeof P){if(P===o){D=-1;break}if(P>o){D=v-1;break}}}for(;v<t.length;){const P=t[v];if("number"==typeof P)break;if(P===a){if(null===d)return void(null!==m&&(t[v+1]=m));if(d===t[v+1])return void(t[v+2]=m)}v++,null!==d&&v++,null!==m&&v++}-1!==D&&(t.splice(D,0,o),v=D+1),t.splice(v++,0,a),null!==d&&t.splice(v++,0,d),null!==m&&t.splice(v++,0,m)}const Kn="ng-template";function Br(t,o,a){let d=0,m=!0;for(;d<t.length;){let v=t[d++];if("string"==typeof v&&m){const D=t[d++];if(a&&"class"===v&&-1!==Fi(D.toLowerCase(),o,0))return!0}else{if(1===v){for(;d<t.length&&"string"==typeof(v=t[d++]);)if(v.toLowerCase()===o)return!0;return!1}"number"==typeof v&&(m=!1)}}return!1}function le(t){return 4===t.type&&t.value!==Kn}function Oe(t,o,a){return o===(4!==t.type||a?t.value:Kn)}function pe(t,o,a){let d=4;const m=t.attrs||[],v=function bn(t){for(let o=0;o<t.length;o++)if(Ui(t[o]))return o;return t.length}(m);let D=!1;for(let P=0;P<o.length;P++){const V=o[P];if("number"!=typeof V){if(!D)if(4&d){if(d=2|1&d,""!==V&&!Oe(t,V,a)||""===V&&1===o.length){if(Se(d))return!1;D=!0}}else{const ne=8&d?V:o[++P];if(8&d&&null!==t.attrs){if(!Br(t.attrs,ne,a)){if(Se(d))return!1;D=!0}continue}const Ve=bt(8&d?"class":V,m,le(t),a);if(-1===Ve){if(Se(d))return!1;D=!0;continue}if(""!==ne){let Ct;Ct=Ve>v?"":m[Ve+1].toLowerCase();const jt=8&d?Ct:null;if(jt&&-1!==Fi(jt,ne,0)||2&d&&ne!==Ct){if(Se(d))return!1;D=!0}}}}else{if(!D&&!Se(d)&&!Se(V))return!1;if(D&&Se(V))continue;D=!1,d=V|1&d}}return Se(d)||D}function Se(t){return 0==(1&t)}function bt(t,o,a,d){if(null===o)return-1;let m=0;if(d||!a){let v=!1;for(;m<o.length;){const D=o[m];if(D===t)return m;if(3===D||6===D)v=!0;else{if(1===D||2===D){let P=o[++m];for(;"string"==typeof P;)P=o[++m];continue}if(4===D)break;if(0===D){m+=4;continue}}m+=v?1:2}return-1}return function pn(t,o){let a=t.indexOf(4);if(a>-1)for(a++;a<t.length;){const d=t[a];if("number"==typeof d)return-1;if(d===o)return a;a++}return-1}(o,t)}function Pt(t,o,a=!1){for(let d=0;d<o.length;d++)if(pe(t,o[d],a))return!0;return!1}function Pn(t,o){e:for(let a=0;a<o.length;a++){const d=o[a];if(t.length===d.length){for(let m=0;m<t.length;m++)if(t[m]!==d[m])continue e;return!0}}return!1}function lr(t,o){return t?":not("+o.trim()+")":o}function Ar(t){let o=t[0],a=1,d=2,m="",v=!1;for(;a<t.length;){let D=t[a];if("string"==typeof D)if(2&d){const P=t[++a];m+="["+D+(P.length>0?'="'+P+'"':"")+"]"}else 8&d?m+="."+D:4&d&&(m+=" "+D);else""!==m&&!Se(D)&&(o+=lr(v,m),m=""),d=D,v=v||!Se(d);a++}return""!==m&&(o+=lr(v,m)),o}function zo(t){return or(()=>{const o=Js(t),a={...o,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===hi.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Sr.Emulated,styles:t.styles||Yr,_:null,schemas:t.schemas||null,tView:null,id:""};Qs(a);const d=t.dependencies;return a.directiveDefs=Is(d,!1),a.pipeDefs=Is(d,!0),a.id=function ha(t){let o=0;const a=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const m of a)o=Math.imul(31,o)+m.charCodeAt(0)<<0;return o+=2147483648,"c"+o}(a),a})}function Zo(t){return Gr(t)||Ii(t)}function ao(t){return null!==t}function Io(t){return or(()=>({type:t.type,bootstrap:t.bootstrap||Yr,declarations:t.declarations||Yr,imports:t.imports||Yr,exports:t.exports||Yr,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Si(t,o){if(null==t)return mi;const a={};for(const d in t)if(t.hasOwnProperty(d)){let m=t[d],v=m;Array.isArray(m)&&(v=m[1],m=m[0]),a[m]=d,o&&(o[m]=v)}return a}function wa(t){return or(()=>{const o=Js(t);return Qs(o),o})}function sa(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Gr(t){return t[li]||null}function Ii(t){return t[bi]||null}function Fo(t){return t[Ur]||null}function gs(t){const o=Gr(t)||Ii(t)||Fo(t);return null!==o&&o.standalone}function xi(t,o){const a=t[So]||null;if(!a&&!0===o)throw new Error(`Type ${Kt(t)} does not have '\u0275mod' property.`);return a}function Js(t){const o={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:o,inputTransforms:null,inputConfig:t.inputs||mi,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Yr,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Si(t.inputs,o),outputs:Si(t.outputs)}}function Qs(t){t.features?.forEach(o=>o(t))}function Is(t,o){if(!t)return null;const a=o?Fo:Zo;return()=>("function"==typeof t?t():t).map(d=>a(d)).filter(ao)}const Wi=0,rr=1,Rr=2,qi=3,_s=4,rs=5,io=6,Wo=7,no=8,$o=9,Bo=10,Wr=11,Xo=12,Ko=13,ys=14,Ni=15,aa=16,js=17,vs=18,is=19,ea=20,ci=21,Ms=22,ta=23,Jo=24,fi=25,Qo=1,xs=2,os=7,Ho=9,Eo=11;function xo(t){return Array.isArray(t)&&"object"==typeof t[Qo]}function us(t){return Array.isArray(t)&&!0===t[Qo]}function ya(t){return 0!=(4&t.flags)}function ds(t){return t.componentOffset>-1}function bs(t){return 1==(1&t.flags)}function S(t){return!!t.template}function K(t){return 0!=(512&t[Rr])}function Ns(t,o){return t.hasOwnProperty(zt)?t[zt]:null}let M=Pi.WeakRef??class ce{constructor(o){this.ref=o}deref(){return this.ref}},ue=0,Ce=null,ct=!1;function ut(t){const o=Ce;return Ce=t,o}class Qt{constructor(){this.id=ue++,this.ref=function F(t){return new M(t)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[o,a]of this.producers){const d=a.producerNode.deref();if(null!=d&&a.atTrackingVersion===this.trackingVersion){if(d.producerPollStatus(a.seenValueVersion))return!0}else this.producers.delete(o),d?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const o=ct;ct=!0;try{for(const[a,d]of this.consumers){const m=d.consumerNode.deref();null!=m&&m.trackingVersion===d.atTrackingVersion?m.onConsumerDependencyMayHaveChanged():(this.consumers.delete(a),m?.producers.delete(this.id))}}finally{ct=o}}producerAccessed(){if(ct)throw new Error("");if(null===Ce)return;let o=Ce.producers.get(this.id);void 0===o?(o={consumerNode:Ce.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Ce.trackingVersion},Ce.producers.set(this.id,o),this.consumers.set(Ce.id,o)):(o.seenValueVersion=this.valueVersion,o.atTrackingVersion=Ce.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Ce?.consumerAllowSignalWrites}producerPollStatus(o){return this.valueVersion!==o||(this.onProducerUpdateValueVersion(),this.valueVersion!==o)}}let pi=null;function fa(t){const o=ut(null);try{return t()}finally{ut(o)}}const Es=()=>{};class Ds extends Qt{constructor(o,a,d){super(),this.watch=o,this.schedule=a,this.dirty=!1,this.cleanupFn=Es,this.registerOnCleanup=m=>{this.cleanupFn=m},this.consumerAllowSignalWrites=d}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const o=ut(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Es,this.watch(this.registerOnCleanup)}finally{ut(o)}}cleanup(){this.cleanupFn()}}class Cs{constructor(o,a,d){this.previousValue=o,this.currentValue=a,this.firstChange=d}isFirstChange(){return this.firstChange}}function k(){return X}function X(t){return t.type.prototype.ngOnChanges&&(t.setInput=W),Be}function Be(){const t=_t(this),o=t?.current;if(o){const a=t.previous;if(a===mi)t.previous=o;else for(let d in o)a[d]=o[d];t.current=null,this.ngOnChanges(o)}}function W(t,o,a,d){const m=this.declaredInputs[a],v=_t(t)||function kt(t,o){return t[be]=o}(t,{previous:mi,current:null}),D=v.current||(v.current={}),P=v.previous,V=P[m];D[m]=new Cs(V&&V.currentValue,o,P===mi),t[d]=o}k.ngInherit=!0;const be="__ngSimpleChanges__";function _t(t){return t[be]||null}const _r=function(t,o,a){},ti="svg";function Pr(t){for(;Array.isArray(t);)t=t[Wi];return t}function ni(t,o){return Pr(o[t])}function co(t,o){return Pr(o[t.index])}function uo(t,o){return t.data[o]}function Yi(t,o){const a=o[t];return xo(a)?a:a[Wi]}function pa(t,o){return null==o?null:t[o]}function cr(t){t[js]=0}function Pa(t){1024&t[Rr]||(t[Rr]|=1024,Rl(t,1))}function Ec(t){1024&t[Rr]&&(t[Rr]&=-1025,Rl(t,-1))}function Rl(t,o){let a=t[qi];if(null===a)return;a[rs]+=o;let d=a;for(a=a[qi];null!==a&&(1===o&&1===d[rs]||-1===o&&0===d[rs]);)a[rs]+=o,d=a,a=a[qi]}const ri={lFrame:Y(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function kl(){return ri.bindingsEnabled}function bl(){return null!==ri.skipHydrationRootTNode}function Vn(){return ri.lFrame.lView}function Zi(){return ri.lFrame.tView}function El(t){return ri.lFrame.contextLView=t,t[no]}function Ll(t){return ri.lFrame.contextLView=null,t}function Vs(){let t=Mu();for(;null!==t&&64===t.type;)t=t.parent;return t}function Mu(){return ri.lFrame.currentTNode}function Ra(t,o){const a=ri.lFrame;a.currentTNode=t,a.isParent=o}function Za(){return ri.lFrame.isParent}function ic(){ri.lFrame.isParent=!1}function fs(){return ri.lFrame.bindingIndex++}function Xa(t){const o=ri.lFrame,a=o.bindingIndex;return o.bindingIndex=o.bindingIndex+t,a}function ph(t,o){const a=ri.lFrame;a.bindingIndex=a.bindingRootIndex=t,lu(o)}function lu(t){ri.lFrame.currentDirectiveIndex=t}function ka(){return ri.lFrame.currentQueryIndex}function La(t){ri.lFrame.currentQueryIndex=t}function R(t){const o=t[rr];return 2===o.type?o.declTNode:1===o.type?t[io]:null}function B(t,o,a){if(a&Tr.SkipSelf){let m=o,v=t;for(;!(m=m.parent,null!==m||a&Tr.Host||(m=R(v),null===m||(v=v[ys],10&m.type))););if(null===m)return!1;o=m,t=v}const d=ri.lFrame=L();return d.currentTNode=o,d.lView=t,!0}function $(t){const o=L(),a=t[rr];ri.lFrame=o,o.currentTNode=a.firstChild,o.lView=t,o.tView=a,o.contextLView=t,o.bindingIndex=a.bindingStartIndex,o.inI18n=!1}function L(){const t=ri.lFrame,o=null===t?null:t.child;return null===o?Y(t):o}function Y(t){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=o),o}function _e(){const t=ri.lFrame;return ri.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ze=_e;function we(){const t=_e();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function oi(){return ri.lFrame.selectedIndex}function Nr(t){ri.lFrame.selectedIndex=t}function Mi(){const t=ri.lFrame;return uo(t.tView,t.selectedIndex)}function Da(){ri.lFrame.currentNamespace=ti}function Bl(){!function sc(){ri.lFrame.currentNamespace=null}()}let Ou=!0;function Dl(){return Ou}function h(t){Ou=t}function c(t,o){for(let a=o.directiveStart,d=o.directiveEnd;a<d;a++){const v=t.data[a].type.prototype,{ngAfterContentInit:D,ngAfterContentChecked:P,ngAfterViewInit:V,ngAfterViewChecked:ne,ngOnDestroy:he}=v;D&&(t.contentHooks??=[]).push(-a,D),P&&((t.contentHooks??=[]).push(a,P),(t.contentCheckHooks??=[]).push(a,P)),V&&(t.viewHooks??=[]).push(-a,V),ne&&((t.viewHooks??=[]).push(a,ne),(t.viewCheckHooks??=[]).push(a,ne)),null!=he&&(t.destroyHooks??=[]).push(a,he)}}function p(t,o,a){C(t,o,3,a)}function _(t,o,a,d){(3&t[Rr])===a&&C(t,o,a,d)}function x(t,o){let a=t[Rr];(3&a)===o&&(a&=8191,a+=1,t[Rr]=a)}function C(t,o,a,d){const v=d??-1,D=o.length-1;let P=0;for(let V=void 0!==d?65535&t[js]:0;V<D;V++)if("number"==typeof o[V+1]){if(P=o[V],null!=d&&P>=d)break}else o[V]<0&&(t[js]+=65536),(P<v||-1==v)&&(N(t,a,o,V),t[js]=(4294901760&t[js])+V+2),V++}function A(t,o){_r(4,t,o);const a=ut(null);try{o.call(t)}finally{ut(a),_r(5,t,o)}}function N(t,o,a,d){const m=a[d]<0,v=a[d+1],P=t[m?-a[d]:a[d]];m?t[Rr]>>13<t[js]>>16&&(3&t[Rr])===o&&(t[Rr]+=8192,A(P,v)):A(P,v)}const H=-1;class j{constructor(o,a,d){this.factory=o,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=d}}function Ne(t){return t!==H}function $e(t){return 32767&t}function mt(t,o){let a=function pt(t){return t>>16}(t),d=o;for(;a>0;)d=d[ys],a--;return d}let gt=!0;function Bt(t){const o=gt;return gt=t,o}const nn=255,Un=5;let Zt=0;const wn={};function Bn(t,o){const a=Cn(t,o);if(-1!==a)return a;const d=o[rr];d.firstCreatePass&&(t.injectorIndex=o.length,Jt(d.data,t),Jt(o,null),Jt(d.blueprint,null));const m=$n(t,o),v=t.injectorIndex;if(Ne(m)){const D=$e(m),P=mt(m,o),V=P[rr].data;for(let ne=0;ne<8;ne++)o[v+ne]=P[D+ne]|V[D+ne]}return o[v+8]=m,v}function Jt(t,o){t.push(0,0,0,0,0,0,0,0,o)}function Cn(t,o){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===o[t.injectorIndex+8]?-1:t.injectorIndex}function $n(t,o){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let a=0,d=null,m=o;for(;null!==m;){if(d=Qi(m),null===d)return H;if(a++,m=m[ys],-1!==d.injectorIndex)return d.injectorIndex|a<<16}return H}function kn(t,o,a){!function ln(t,o,a){let d;"string"==typeof a?d=a.charCodeAt(0)||0:a.hasOwnProperty(ei)&&(d=a[ei]),null==d&&(d=a[ei]=Zt++);const m=d&nn;o.data[t+(m>>Un)]|=1<<m}(t,o,a)}function Or(t,o,a){if(a&Tr.Optional||void 0!==t)return t;nr()}function di(t,o,a,d){if(a&Tr.Optional&&void 0===d&&(d=null),!(a&(Tr.Self|Tr.Host))){const m=t[$o],v=si(void 0);try{return m?m.get(o,d,a&Tr.Optional):Gi(o,d,a&Tr.Optional)}finally{si(v)}}return Or(d,0,a)}function yr(t,o,a,d=Tr.Default,m){if(null!==t){if(2048&o[Rr]&&!(d&Tr.Self)){const D=function Po(t,o,a,d,m){let v=t,D=o;for(;null!==v&&null!==D&&2048&D[Rr]&&!(512&D[Rr]);){const P=Vr(v,D,a,d|Tr.Self,wn);if(P!==wn)return P;let V=v.parent;if(!V){const ne=D[ea];if(ne){const he=ne.get(a,wn,d);if(he!==wn)return he}V=Qi(D),D=D[ys]}v=V}return m}(t,o,a,d,wn);if(D!==wn)return D}const v=Vr(t,o,a,d,wn);if(v!==wn)return v}return di(o,a,d,m)}function Vr(t,o,a,d,m){const v=function fo(t){if("string"==typeof t)return t.charCodeAt(0)||0;const o=t.hasOwnProperty(ei)?t[ei]:void 0;return"number"==typeof o?o>=0?o&nn:Ua:o}(a);if("function"==typeof v){if(!B(o,t,d))return d&Tr.Host?Or(m,0,d):di(o,a,d,m);try{let D;if(D=v(d),null!=D||d&Tr.Optional)return D;nr()}finally{ze()}}else if("number"==typeof v){let D=null,P=Cn(t,o),V=H,ne=d&Tr.Host?o[Ni][io]:null;for((-1===P||d&Tr.SkipSelf)&&(V=-1===P?$n(t,o):o[P+8],V!==H&&Co(d,!1)?(D=o[rr],P=$e(V),o=mt(V,o)):P=-1);-1!==P;){const he=o[rr];if(Do(v,P,he.data)){const Ve=ki(P,o,a,D,d,ne);if(Ve!==wn)return Ve}V=o[P+8],V!==H&&Co(d,o[rr].data[P+8]===ne)&&Do(v,P,o)?(D=he,P=$e(V),o=mt(V,o)):P=-1}}return m}function ki(t,o,a,d,m,v){const D=o[rr],P=D.data[t+8],he=Di(P,D,a,null==d?ds(P)&&gt:d!=D&&0!=(3&P.type),m&Tr.Host&&v===P);return null!==he?wr(o,D,he,P):wn}function Di(t,o,a,d,m){const v=t.providerIndexes,D=o.data,P=1048575&v,V=t.directiveStart,he=v>>20,Ct=m?P+he:t.directiveEnd;for(let jt=d?P:P+he;jt<Ct;jt++){const On=D[jt];if(jt<V&&a===On||jt>=V&&On.type===a)return jt}if(m){const jt=D[V];if(jt&&S(jt)&&jt.type===a)return V}return null}function wr(t,o,a,d){let m=t[a];const v=o.data;if(function re(t){return t instanceof j}(m)){const D=m;D.resolving&&function mn(t,o){const a=o?`. Dependency path: ${o.join(" > ")} > ${t}`:"";throw new De(-200,`Circular dependency in DI detected for ${t}${a}`)}(function yt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Nt(t)}(v[a]));const P=Bt(D.canSeeViewProviders);D.resolving=!0;const ne=D.injectImpl?si(D.injectImpl):null;B(t,d,Tr.Default);try{m=t[a]=D.factory(void 0,v,t,d),o.firstCreatePass&&a>=d.directiveStart&&function i(t,o,a){const{ngOnChanges:d,ngOnInit:m,ngDoCheck:v}=o.type.prototype;if(d){const D=X(o);(a.preOrderHooks??=[]).push(t,D),(a.preOrderCheckHooks??=[]).push(t,D)}m&&(a.preOrderHooks??=[]).push(0-t,m),v&&((a.preOrderHooks??=[]).push(t,v),(a.preOrderCheckHooks??=[]).push(t,v))}(a,v[a],o)}finally{null!==ne&&si(ne),Bt(P),D.resolving=!1,ze()}}return m}function Do(t,o,a){return!!(a[o+(t>>Un)]&1<<t)}function Co(t,o){return!(t&Tr.Self||t&Tr.Host&&o)}class bo{constructor(o,a){this._tNode=o,this._lView=a}get(o,a,d){return yr(this._tNode,this._lView,o,Ke(d),a)}}function Ua(){return new bo(Vs(),Vn())}function Ja(t){return or(()=>{const o=t.prototype.constructor,a=o[zt]||Vo(o),d=Object.prototype;let m=Object.getPrototypeOf(t.prototype).constructor;for(;m&&m!==d;){const v=m[zt]||Vo(m);if(v&&v!==a)return v;m=Object.getPrototypeOf(m)}return v=>new v})}function Vo(t){return Ge(t)?()=>{const o=Vo(Tt(t));return o&&o()}:Ns(t)}function Qi(t){const o=t[rr],a=o.type;return 2===a?o.declTNode:1===a?t[io]:null}function ps(t){return function Yn(t,o){if("class"===o)return t.classes;if("style"===o)return t.styles;const a=t.attrs;if(a){const d=a.length;let m=0;for(;m<d;){const v=a[m];if(Ui(v))break;if(0===v)m+=2;else if("number"==typeof v)for(m++;m<d&&"string"==typeof a[m];)m++;else{if(v===o)return a[m+1];m+=2}}}return null}(Vs(),t)}const wo="__parameters__";function cl(t,o,a){return or(()=>{const d=function Cl(t){return function(...a){if(t){const d=t(...a);for(const m in d)this[m]=d[m]}}}(o);function m(...v){if(this instanceof m)return d.apply(this,v),this;const D=new m(...v);return P.annotation=D,P;function P(V,ne,he){const Ve=V.hasOwnProperty(wo)?V[wo]:Object.defineProperty(V,wo,{value:[]})[wo];for(;Ve.length<=he;)Ve.push(null);return(Ve[he]=Ve[he]||[]).push(D),V}}return a&&(m.prototype=Object.create(a.prototype)),m.prototype.ngMetadataName=t,m.annotationCls=m,m})}function uu(t,o){t.forEach(a=>Array.isArray(a)?uu(a,o):o(a))}function Nf(t,o,a){o>=t.length?t.push(a):t.splice(o,0,a)}function _h(t,o){return o>=t.length-1?t.pop():t.splice(o,1)[0]}function xd(t,o){const a=[];for(let d=0;d<t;d++)a.push(o);return a}function Zs(t,o,a){let d=el(t,o);return d>=0?t[1|d]=a:(d=~d,function bd(t,o,a,d){let m=t.length;if(m==o)t.push(a,d);else if(1===m)t.push(d,t[0]),t[0]=a;else{for(m--,t.push(t[m-1],t[m]);m>o;)t[m]=t[m-2],m--;t[o]=a,t[o+1]=d}}(t,d,o,a)),d}function Qa(t,o){const a=el(t,o);if(a>=0)return t[1|a]}function el(t,o){return function Sc(t,o,a){let d=0,m=t.length>>a;for(;m!==d;){const v=d+(m-d>>1),D=t[v<<a];if(o===D)return v<<a;D>o?m=v:d=v+1}return~(m<<a)}(t,o,1)}const Cm=Xt(cl("Inject",t=>({token:t})),-1),as=Xt(cl("Optional"),8),Tl=Xt(cl("SkipSelf"),4);function Sd(t){return 128==(128&t.flags)}var Nu=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Nu||{});const Xf=/^>|^->|<!--|-->|--!>|<!-$/g,Kf=/(<|>)/,Ta="\u200b$1\u200b";const Ch=new Map;let Hl=0;const Qf="__ngContext__";function ga(t,o){xo(o)?(t[Qf]=o[is],function fu(t){Ch.set(t[is],t)}(o)):t[Qf]=o}let Mh;function mu(t,o){return Mh(t,o)}function Uu(t){const o=t[qi];return us(o)?o[qi]:o}function Ah(t){return km(t[Xo])}function np(t){return km(t[_s])}function km(t){for(;null!==t&&!us(t);)t=t[_s];return t}function Hu(t,o,a,d,m){if(null!=d){let v,D=!1;us(d)?v=d:xo(d)&&(D=!0,d=d[Wi]);const P=Pr(d);0===t&&null!==a?null==m?ap(o,a,P):cc(o,a,P,m||null,!0):1===t&&null!==a?cc(o,a,P,m||null,!0):2===t?function Pd(t,o,a){const d=gu(t,o);d&&function uc(t,o,a,d){t.removeChild(o,a,d)}(t,d,o,a)}(o,P,D):3===t&&o.destroyNode(P),null!=v&&function $m(t,o,a,d,m){const v=a[os];v!==Pr(a)&&Hu(o,t,d,v,m);for(let P=Eo;P<a.length;P++){const V=a[P];Rd(V[rr],V,t,o,d,v)}}(o,t,v,a,m)}}function Gl(t,o){return t.createComment(function Dh(t){return t.replace(Xf,o=>o.replace(Kf,Ta))}(o))}function po(t,o,a){return t.createElement(o,a)}function op(t,o){const a=t[Ho],d=a.indexOf(o);Ec(o),a.splice(d,1)}function Xs(t,o){if(t.length<=Eo)return;const a=Eo+o,d=t[a];if(d){const m=d[aa];null!==m&&m!==t&&op(m,d),o>0&&(t[a-1][_s]=d[_s]);const v=_h(t,Eo+o);!function ip(t,o){Rd(t,o,o[Wr],2,null,null),o[Wi]=null,o[io]=null}(d[rr],d);const D=v[vs];null!==D&&D.detachView(v[rr]),d[qi]=null,d[_s]=null,d[Rr]&=-129}return d}function Ph(t,o){if(!(256&o[Rr])){const a=o[Wr];o[ta]?.destroy(),o[Jo]?.destroy(),a.destroyNode&&Rd(t,o,a,3,null,null),function Il(t){let o=t[Xo];if(!o)return Pc(t[rr],t);for(;o;){let a=null;if(xo(o))a=o[Xo];else{const d=o[Eo];d&&(a=d)}if(!a){for(;o&&!o[_s]&&o!==t;)xo(o)&&Pc(o[rr],o),o=o[qi];null===o&&(o=t),xo(o)&&Pc(o[rr],o),a=o&&o[_s]}o=a}}(o)}}function Pc(t,o){if(!(256&o[Rr])){o[Rr]&=-129,o[Rr]|=256,function Lm(t,o){let a;if(null!=t&&null!=(a=t.destroyHooks))for(let d=0;d<a.length;d+=2){const m=o[a[d]];if(!(m instanceof j)){const v=a[d+1];if(Array.isArray(v))for(let D=0;D<v.length;D+=2){const P=m[v[D]],V=v[D+1];_r(4,P,V);try{V.call(P)}finally{_r(5,P,V)}}else{_r(4,m,v);try{v.call(m)}finally{_r(5,m,v)}}}}}(t,o),function sp(t,o){const a=t.cleanup,d=o[Wo];if(null!==a)for(let v=0;v<a.length-1;v+=2)if("string"==typeof a[v]){const D=a[v+3];D>=0?d[D]():d[-D].unsubscribe(),v+=2}else a[v].call(d[a[v+1]]);null!==d&&(o[Wo]=null);const m=o[ci];if(null!==m){o[ci]=null;for(let v=0;v<m.length;v++)(0,m[v])()}}(t,o),1===o[rr].type&&o[Wr].destroy();const a=o[aa];if(null!==a&&us(o[qi])){a!==o[qi]&&op(a,o);const d=o[vs];null!==d&&d.detachView(t)}!function hl(t){Ch.delete(t[is])}(o)}}function Md(t,o,a){return function Fm(t,o,a){let d=o;for(;null!==d&&40&d.type;)d=(o=d).parent;if(null===d)return a[Wi];{const{componentOffset:m}=d;if(m>-1){const{encapsulation:v}=t.data[d.directiveStart+m];if(v===Sr.None||v===Sr.Emulated)return null}return co(d,a)}}(t,o.parent,a)}function cc(t,o,a,d,m){t.insertBefore(o,a,d,m)}function ap(t,o,a){t.appendChild(o,a)}function Bm(t,o,a,d,m){null!==d?cc(t,o,a,d,m):ap(t,o,a)}function gu(t,o){return t.parentNode(o)}function Oh(t,o,a){return Nm(t,o,a)}let kh,kd,$h,Nm=function lp(t,o,a){return 40&t.type?co(t,a):null};function Wu(t,o,a,d){const m=Md(t,d,o),v=o[Wr],P=Oh(d.parent||o[io],d,o);if(null!=m)if(Array.isArray(a))for(let V=0;V<a.length;V++)Bm(v,m,a[V],P,!1);else Bm(v,m,a,P,!1);void 0!==kh&&kh(v,d,o,a,m)}function Ad(t,o){if(null!==o){const a=o.type;if(3&a)return co(o,t);if(4&a)return Fh(-1,t[o.index]);if(8&a){const d=o.child;if(null!==d)return Ad(t,d);{const m=t[o.index];return us(m)?Fh(-1,m):Pr(m)}}if(32&a)return mu(o,t)()||Pr(t[o.index]);{const d=Lh(t,o);return null!==d?Array.isArray(d)?d[0]:Ad(Uu(t[Ni]),d):Ad(t,o.next)}}return null}function Lh(t,o){return null!==o?t[Ni][io].projection[o.projection]:null}function Fh(t,o){const a=Eo+t+1;if(a<o.length){const d=o[a],m=d[rr].firstChild;if(null!==m)return Ad(d,m)}return o[os]}function Bh(t,o,a,d,m,v,D){for(;null!=a;){const P=d[a.index],V=a.type;if(D&&0===o&&(P&&ga(Pr(P),d),a.flags|=2),32!=(32&a.flags))if(8&V)Bh(t,o,a.child,d,m,v,!1),Hu(o,t,m,P,v);else if(32&V){const ne=mu(a,d);let he;for(;he=ne();)Hu(o,t,m,he,v);Hu(o,t,m,P,v)}else 16&V?Od(t,o,d,a,m,v):Hu(o,t,m,P,v);a=D?a.projectionNext:a.next}}function Rd(t,o,a,d,m,v){Bh(a,d,t.firstChild,o,m,v,!1)}function Od(t,o,a,d,m,v){const D=a[Ni],V=D[io].projection[d.projection];if(Array.isArray(V))for(let ne=0;ne<V.length;ne++)Hu(o,t,m,V[ne],v);else{let ne=V;const he=D[qi];Sd(d)&&(ne.flags|=128),Bh(t,o,ne,he,m,v,!0)}}function Um(t,o,a){""===a?t.removeAttribute(o,"class"):t.setAttribute(o,"class",a)}function cp(t,o,a){const{mergedAttrs:d,classes:m,styles:v}=a;null!==d&&Vi(t,o,d),null!==m&&Um(t,o,m),null!==v&&function __(t,o,a){t.setAttribute(o,"style",a)}(t,o,v)}function dc(t){kd=t}function qm(t){return function Ld(){if(void 0===$h&&($h=null,Pi.trustedTypes))try{$h=Pi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return $h}()?.createScriptURL(t)||t}class Vh{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${_n})`}}function Oc(t){return t instanceof Vh?t.changingThisBreaksApplicationSecurity:t}function Bd(t,o){const a=function b_(t){return t instanceof Vh&&t.getTypeName()||null}(t);if(null!=a&&a!==o){if("ResourceURL"===a&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${a} (see ${_n})`)}return a===o}const Xm=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Ku=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Ku||{});function gp(t){const o=Nd();return o?o.sanitize(Ku.URL,t)||"":Bd(t,"URL")?Oc(t):function Zu(t){return(t=String(t)).match(Xm)?t:"unsafe:"+t}(Nt(t))}function vu(t){const o=Nd();if(o)return qm(o.sanitize(Ku.RESOURCE_URL,t)||"");if(Bd(t,"ResourceURL"))return qm(Oc(t));throw new De(904,!1)}function _p(t,o,a){return function tg(t,o){return"src"===o&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===o&&("base"===t||"link"===t)?vu:gp}(o,a)(t)}function Nd(){const t=Vn();return t&&t[Bo].sanitizer}class To{constructor(o,a){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=Wn({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const kc=new To("ENVIRONMENT_INITIALIZER"),zd=new To("INJECTOR",-1),ng=new To("INJECTOR_DEF_TYPES");class yp{get(o,a=Ln){if(a===Ln){const d=new Error(`NullInjectorError: No provider for ${Kt(o)}!`);throw d.name="NullInjectorError",d}return a}}function xu(t){return{\u0275providers:t}}function $d(...t){return{\u0275providers:vp(0,t),\u0275fromNgModule:!0}}function vp(t,...o){const a=[],d=new Set;let m;const v=D=>{a.push(D)};return uu(o,D=>{const P=D;Vd(P,v,[],d)&&(m||=[],m.push(P))}),void 0!==m&&Ju(m,v),a}function Ju(t,o){for(let a=0;a<t.length;a++){const{ngModule:d,providers:m}=t[a];Xh(m,v=>{o(v,d)})}}function Vd(t,o,a,d){if(!(t=Tt(t)))return!1;let m=null,v=Ai(t);const D=!v&&Gr(t);if(v||D){if(D&&!D.standalone)return!1;m=t}else{const V=t.ngModule;if(v=Ai(V),!v)return!1;m=V}const P=d.has(m);if(D){if(P)return!1;if(d.add(m),D.dependencies){const V="function"==typeof D.dependencies?D.dependencies():D.dependencies;for(const ne of V)Vd(ne,o,a,d)}}else{if(!v)return!1;{if(null!=v.imports&&!P){let ne;d.add(m);try{uu(v.imports,he=>{Vd(he,o,a,d)&&(ne||=[],ne.push(he))})}finally{}void 0!==ne&&Ju(ne,o)}if(!P){const ne=Ns(m)||(()=>new m);o({provide:m,useFactory:ne,deps:Yr},m),o({provide:ng,useValue:m,multi:!0},m),o({provide:kc,useValue:()=>Qr(m),multi:!0},m)}const V=v.providers;if(null!=V&&!P){const ne=t;Xh(V,he=>{o(he,ne)})}}}return m!==t&&void 0!==t.providers}function Xh(t,o){for(let a of t)Le(a)&&(a=a.\u0275providers),Array.isArray(a)?Xh(a,o):o(a)}const rg=et({provide:String,useValue:et});function Kh(t){return null!==t&&"object"==typeof t&&rg in t}function Lc(t){return"function"==typeof t}const wp=new To("Set Injector scope."),Ud={},Jh={};let Qh;function ua(){return void 0===Qh&&(Qh=new yp),Qh}class Wa{}class fc extends Wa{get destroyed(){return this._destroyed}constructor(o,a,d,m){super(),this.parent=a,this.source=d,this.scopes=m,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ep(o,D=>this.processProvider(D)),this.records.set(zd,Qu(void 0,this)),m.has("environment")&&this.records.set(Wa,Qu(void 0,this));const v=this.records.get(wp);null!=v&&"string"==typeof v.value&&this.scopes.add(v.value),this.injectorDefTypes=new Set(this.get(ng.multi,Yr,Tr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const a of this._ngOnDestroyHooks)a.ngOnDestroy();const o=this._onDestroyHooks;this._onDestroyHooks=[];for(const a of o)a()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(o){return this.assertNotDestroyed(),this._onDestroyHooks.push(o),()=>this.removeOnDestroy(o)}runInContext(o){this.assertNotDestroyed();const a=Mr(this),d=si(void 0);try{return o()}finally{Mr(a),si(d)}}get(o,a=Ln,d=Tr.Default){if(this.assertNotDestroyed(),o.hasOwnProperty(Ri))return o[Ri](this);d=Ke(d);const v=Mr(this),D=si(void 0);try{if(!(d&Tr.SkipSelf)){let V=this.records.get(o);if(void 0===V){const ne=function O_(t){return"function"==typeof t||"object"==typeof t&&t instanceof To}(o)&&kr(o);V=ne&&this.injectableDefInScope(ne)?Qu(bu(o),Ud):null,this.records.set(o,V)}if(null!=V)return this.hydrate(o,V)}return(d&Tr.Self?ua():this.parent).get(o,a=d&Tr.Optional&&a===Ln?null:a)}catch(P){if("NullInjectorError"===P.name){if((P[Ze]=P[Ze]||[]).unshift(Kt(o)),v)throw P;return function zn(t,o,a,d){const m=t[Ze];throw o[dn]&&m.unshift(o[dn]),t.message=function br(t,o,a,d=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let m=Kt(o);if(Array.isArray(o))m=o.map(Kt).join(" -> ");else if("object"==typeof o){let v=[];for(let D in o)if(o.hasOwnProperty(D)){let P=o[D];v.push(D+":"+("string"==typeof P?JSON.stringify(P):Kt(P)))}m=`{${v.join(", ")}}`}return`${a}${d?"("+d+")":""}[${m}]: ${t.replace(He,"\n  ")}`}("\n"+t.message,m,a,d),t.ngTokenPath=m,t[Ze]=null,t}(P,o,"R3InjectorError",this.source)}throw P}finally{si(D),Mr(v)}}resolveInjectorInitializers(){const o=Mr(this),a=si(void 0);try{const m=this.get(kc.multi,Yr,Tr.Self);for(const v of m)v()}finally{Mr(o),si(a)}}toString(){const o=[],a=this.records;for(const d of a.keys())o.push(Kt(d));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new De(205,!1)}processProvider(o){let a=Lc(o=Tt(o))?o:Tt(o&&o.provide);const d=function og(t){return Kh(t)?Qu(void 0,t.useValue):Qu(sg(t),Ud)}(o);if(Lc(o)||!0!==o.multi)this.records.get(a);else{let m=this.records.get(a);m||(m=Qu(void 0,Ud,!0),m.factory=()=>tn(m.multi),this.records.set(a,m)),a=o,m.multi.push(o)}this.records.set(a,d)}hydrate(o,a){return a.value===Ud&&(a.value=Jh,a.value=a.factory()),"object"==typeof a.value&&a.value&&function R_(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(a.value)&&this._ngOnDestroyHooks.add(a.value),a.value}injectableDefInScope(o){if(!o.providedIn)return!1;const a=Tt(o.providedIn);return"string"==typeof a?"any"===a||this.scopes.has(a):this.injectorDefTypes.has(a)}removeOnDestroy(o){const a=this._onDestroyHooks.indexOf(o);-1!==a&&this._onDestroyHooks.splice(a,1)}}function bu(t){const o=kr(t),a=null!==o?o.factory:Ns(t);if(null!==a)return a;if(t instanceof To)throw new De(204,!1);if(t instanceof Function)return function ig(t){const o=t.length;if(o>0)throw xd(o,"?"),new De(204,!1);const a=function to(t){return t&&(t[zi]||t[Hr])||null}(t);return null!==a?()=>a.factory(t):()=>new t}(t);throw new De(204,!1)}function sg(t,o,a){let d;if(Lc(t)){const m=Tt(t);return Ns(m)||bu(m)}if(Kh(t))d=()=>Tt(t.useValue);else if(function bp(t){return!(!t||!t.useFactory)}(t))d=()=>t.useFactory(...tn(t.deps||[]));else if(function xp(t){return!(!t||!t.useExisting)}(t))d=()=>Qr(Tt(t.useExisting));else{const m=Tt(t&&(t.useClass||t.provide));if(!function P_(t){return!!t.deps}(t))return Ns(m)||bu(m);d=()=>new m(...tn(t.deps))}return d}function Qu(t,o,a=!1){return{factory:t,value:o,multi:a?[]:void 0}}function Ep(t,o){for(const a of t)Array.isArray(a)?Ep(a,o):a&&Le(a)?Ep(a.\u0275providers,o):o(a)}const jd=new To("AppId",{providedIn:"root",factory:()=>k_}),k_="ng",Dp=new To("Platform Initializer"),ef=new To("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),F_=new To("AnimationModuleType"),B_=new To("CSP nonce",{providedIn:"root",factory:()=>function ca(){if(void 0!==kd)return kd;if(typeof document<"u")return document;throw new De(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Sp=(t,o,a)=>null;function Nc(t,o,a=!1){return Sp(t,o,a)}class td{}class Pp{}class G_{resolveComponentFactory(o){throw function sf(t){const o=Error(`No component factory found for ${Kt(t)}.`);return o.ngComponent=t,o}(o)}}let qd=(()=>{class o{}return o.NULL=new G_,o})();function ug(){return zc(Vs(),Vn())}function zc(t,o){return new da(co(t,o))}let da=(()=>{class o{constructor(d){this.nativeElement=d}}return o.__NG_ELEMENT_ID__=ug,o})();function Rp(t){return t instanceof da?t.nativeElement:t}class Op{}let il=(()=>{class o{constructor(){this.destroyNode=null}}return o.__NG_ELEMENT_ID__=()=>function dg(){const t=Vn(),a=Yi(Vs().index,t);return(xo(a)?a:t)[Wr]}(),o})(),Yd=(()=>{var t;class o{}return(t=o).\u0275prov=Wn({token:t,providedIn:"root",factory:()=>null}),o})();class Eu{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const kp=new Eu("16.2.0"),nd={};function zp(t,o=null,a=null,d){const m=$p(t,o,a,d);return m.resolveInjectorInitializers(),m}function $p(t,o=null,a=null,d,m=new Set){const v=[a||Yr,$d(t)];return d=d||("object"==typeof t?void 0:Kt(t)),new fc(v,o||ua(),d||null,m)}let ml=(()=>{var t;class o{static create(d,m){if(Array.isArray(d))return zp({name:""},m,d,"");{const v=d.name??"";return zp({name:v},d.parent,d.providers,v)}}}return(t=o).THROW_IF_NOT_FOUND=Ln,t.NULL=new yp,t.\u0275prov=Wn({token:t,providedIn:"any",factory:()=>Qr(zd)}),t.__NG_ELEMENT_ID__=-1,o})();function Yl(t){return t instanceof Function?t():t}let uf=(()=>{var t;class o{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new De(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const d of this.callbacks)d.invoke()}finally{this.runningCallbacks=!1;for(const d of this.deferredCallbacks)this.callbacks.add(d);this.deferredCallbacks.clear()}}register(d){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(d)}unregister(d){this.callbacks.delete(d),this.deferredCallbacks.delete(d)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(t=o).\u0275prov=Wn({token:t,providedIn:"root",factory:()=>new t}),o})();function Vc(t){for(;t;){t[Rr]|=64;const o=Uu(t);if(K(t)&&!o)return t;t=o}return null}function od(t){return t.ngOriginalError}class sd{constructor(){this._console=console}handleError(o){const a=this._findOriginalError(o);this._console.error("ERROR",o),a&&this._console.error("ORIGINAL ERROR",a)}_findOriginalError(o){let a=o&&od(o);for(;a&&od(a);)a=od(a);return a||null}}const _g=new To("",{providedIn:"root",factory:()=>!1});class Gp extends Qt{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(o){this._lView=o}onConsumerDependencyMayHaveChanged(){Vc(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(o,a,d){const m=ut(this);this.trackingVersion++;try{o(a,d)}finally{ut(m)}}destroy(){this.trackingVersion++}}let Tu=null;function hf(){return Tu??=new Gp,Tu}function xg(t,o){return t[o]??hf()}function Wp(t,o){const a=hf();a.hasReadASignal&&(t[o]=Tu,a.lView=t,Tu=new Gp)}const wi={};function bg(t){_c(Zi(),Vn(),oi()+t,!1)}function _c(t,o,a,d){if(!d)if(3==(3&o[Rr])){const v=t.preOrderCheckHooks;null!==v&&p(o,v,a)}else{const v=t.preOrderHooks;null!==v&&_(o,v,0,a)}Nr(a)}function ud(t,o=Tr.Default){const a=Vn();return null===a?Qr(t,o):yr(Vs(),a,Tt(t),o)}function dd(){throw new Error("invalid")}function Uc(t,o,a,d,m,v,D,P,V,ne,he){const Ve=o.blueprint.slice();return Ve[Wi]=m,Ve[Rr]=140|d,(null!==ne||t&&2048&t[Rr])&&(Ve[Rr]|=2048),cr(Ve),Ve[qi]=Ve[ys]=t,Ve[no]=a,Ve[Bo]=D||t&&t[Bo],Ve[Wr]=P||t&&t[Wr],Ve[$o]=V||t&&t[$o]||null,Ve[io]=v,Ve[is]=function g_(){return Hl++}(),Ve[Ms]=he,Ve[ea]=ne,Ve[Ni]=2==o.type?t[Ni]:Ve,Ve}function Zl(t,o,a,d,m){let v=t.data[o];if(null===v)v=function hd(t,o,a,d,m){const v=Mu(),D=Za(),V=t.data[o]=function ry(t,o,a,d,m,v){let D=o?o.injectorIndex:-1,P=0;return bl()&&(P|=128),{type:a,index:d,insertBeforeIndex:null,injectorIndex:D,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:P,providerIndexes:0,value:m,attrs:v,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,D?v:v&&v.parent,a,o,d,m);return null===t.firstChild&&(t.firstChild=V),null!==v&&(D?null==v.child&&null!==V.parent&&(v.child=V):null===v.next&&(v.next=V,V.prev=v)),V}(t,o,a,d,m),function au(){return ri.lFrame.inI18n}()&&(v.flags|=32);else if(64&v.type){v.type=a,v.value=d,v.attrs=m;const D=function Fl(){const t=ri.lFrame,o=t.currentTNode;return t.isParent?o:o.parent}();v.injectorIndex=null===D?-1:D.injectorIndex}return Ra(v,!0),v}function Xd(t,o,a,d){if(0===a)return-1;const m=o.length;for(let v=0;v<a;v++)o.push(d),t.blueprint.push(d),t.data.push(null);return m}function wg(t,o,a,d,m){const v=xg(o,ta),D=oi(),P=2&d;try{if(Nr(-1),P&&o.length>fi&&_c(t,o,fi,!1),_r(P?2:0,m),P)v.runInContext(a,d,m);else{const ne=ut(null);try{a(d,m)}finally{ut(ne)}}}finally{P&&null===o[ta]&&Wp(o,ta),Nr(D),_r(P?3:1,m)}}function jc(t,o,a){if(ya(o)){const d=ut(null);try{const v=o.directiveEnd;for(let D=o.directiveStart;D<v;D++){const P=t.data[D];P.contentQueries&&P.contentQueries(1,a[D],D)}}finally{ut(d)}}}function fd(t,o,a){kl()&&(function sy(t,o,a,d){const m=a.directiveStart,v=a.directiveEnd;ds(a)&&function uy(t,o,a){const d=co(o,t),m=Yp(a);let D=16;a.signals?D=4096:a.onPush&&(D=64);const P=nh(t,Uc(t,m,null,D,d,o,null,t[Bo].rendererFactory.createRenderer(d,a),null,null,null));t[o.index]=P}(o,a,t.data[m+a.componentOffset]),t.firstCreatePass||Bn(a,o),ga(d,o);const D=a.initialInputs;for(let P=m;P<v;P++){const V=t.data[P],ne=wr(o,t,P,a);ga(ne,o),null!==D&&Xl(0,P-m,ne,V,0,D),S(V)&&(Yi(a.index,o)[no]=wr(o,t,P,a))}}(t,o,a,co(a,o)),64==(64&a.flags)&&Cg(t,o,a))}function qp(t,o,a=co){const d=o.localNames;if(null!==d){let m=o.index+1;for(let v=0;v<d.length;v+=2){const D=d[v+1],P=-1===D?a(o,t):t[D];t[m++]=P}}}function Yp(t){const o=t.tView;return null===o||o.incompleteFirstPass?t.tView=ff(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):o}function ff(t,o,a,d,m,v,D,P,V,ne,he){const Ve=fi+d,Ct=Ve+m,jt=function Q_(t,o){const a=[];for(let d=0;d<o;d++)a.push(d<t?null:wi);return a}(Ve,Ct),On="function"==typeof ne?ne():ne;return jt[rr]={type:t,blueprint:jt,template:a,queries:null,viewQuery:P,declTNode:o,data:jt.slice().fill(null,Ve),bindingStartIndex:Ve,expandoStartIndex:Ct,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof v?v():v,pipeRegistry:"function"==typeof D?D():D,firstChild:null,schemas:V,consts:On,incompleteFirstPass:!1,ssrId:he}}let Zp=t=>null;function Kd(t,o,a,d){for(let m in t)if(t.hasOwnProperty(m)){a=null===a?{}:a;const v=t[m];null===d?Jd(a,o,m,v):d.hasOwnProperty(m)&&Jd(a,o,d[m],v)}return a}function Jd(t,o,a,d){t.hasOwnProperty(a)?t[a].push(o,d):t[a]=[o,d]}function Na(t,o,a,d,m,v,D,P){const V=co(o,a);let he,ne=o.inputs;!P&&null!=ne&&(he=ne[d])?(yf(t,a,he,d,m),ds(o)&&function Xp(t,o){const a=Yi(o,t);16&a[Rr]||(a[Rr]|=64)}(a,o.index)):3&o.type&&(d=function iy(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(d),m=null!=D?D(m,o.value||"",d):m,v.setProperty(V,d,m))}function Qd(t,o,a,d){if(kl()){const m=null===d?null:{"":-1},v=function Jp(t,o){const a=t.directiveRegistry;let d=null,m=null;if(a)for(let v=0;v<a.length;v++){const D=a[v];if(Pt(o,D.selectors,!1))if(d||(d=[]),S(D))if(null!==D.findHostDirectiveDefs){const P=[];m=m||new Map,D.findHostDirectiveDefs(D,P,m),d.unshift(...P,D),Qp(t,o,P.length)}else d.unshift(D),Qp(t,o,0);else m=m||new Map,D.findHostDirectiveDefs?.(D,d,m),d.push(D)}return null===d?null:[d,m]}(t,a);let D,P;null===v?D=P=null:[D,P]=v,null!==D&&Kp(t,o,a,D,m,P),m&&function eh(t,o,a){if(o){const d=t.localNames=[];for(let m=0;m<o.length;m+=2){const v=a[o[m+1]];if(null==v)throw new De(-301,!1);d.push(o[m],v)}}}(a,d,m)}a.mergedAttrs=so(a.mergedAttrs,a.attrs)}function Kp(t,o,a,d,m,v){for(let ne=0;ne<d.length;ne++)kn(Bn(a,o),t,d[ne].type);!function cy(t,o,a){t.flags|=1,t.directiveStart=o,t.directiveEnd=o+a,t.providerIndexes=o}(a,t.data.length,d.length);for(let ne=0;ne<d.length;ne++){const he=d[ne];he.providersResolver&&he.providersResolver(he)}let D=!1,P=!1,V=Xd(t,o,d.length,null);for(let ne=0;ne<d.length;ne++){const he=d[ne];a.mergedAttrs=so(a.mergedAttrs,he.hostAttrs),Tg(t,a,o,V,he),ly(V,he,m),null!==he.contentQueries&&(a.flags|=4),(null!==he.hostBindings||null!==he.hostAttrs||0!==he.hostVars)&&(a.flags|=64);const Ve=he.type.prototype;!D&&(Ve.ngOnChanges||Ve.ngOnInit||Ve.ngDoCheck)&&((t.preOrderHooks??=[]).push(a.index),D=!0),!P&&(Ve.ngOnChanges||Ve.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(a.index),P=!0),V++}!function pf(t,o,a){const m=o.directiveEnd,v=t.data,D=o.attrs,P=[];let V=null,ne=null;for(let he=o.directiveStart;he<m;he++){const Ve=v[he],Ct=a?a.get(Ve):null,On=Ct?Ct.outputs:null;V=Kd(Ve.inputs,he,V,Ct?Ct.inputs:null),ne=Kd(Ve.outputs,he,ne,On);const Jn=null===V||null===D||le(o)?null:Kl(V,he,D);P.push(Jn)}null!==V&&(V.hasOwnProperty("class")&&(o.flags|=8),V.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=P,o.inputs=V,o.outputs=ne}(t,a,v)}function Cg(t,o,a){const d=a.directiveStart,m=a.directiveEnd,v=a.index,D=function Oa(){return ri.lFrame.currentDirectiveIndex}();try{Nr(v);for(let P=d;P<m;P++){const V=t.data[P],ne=o[P];lu(P),(null!==V.hostBindings||0!==V.hostVars||null!==V.hostAttrs)&&ay(V,ne)}}finally{Nr(-1),lu(D)}}function ay(t,o){null!==t.hostBindings&&t.hostBindings(1,o)}function Qp(t,o,a){o.componentOffset=a,(t.components??=[]).push(o.index)}function ly(t,o,a){if(a){if(o.exportAs)for(let d=0;d<o.exportAs.length;d++)a[o.exportAs[d]]=t;S(o)&&(a[""]=t)}}function Tg(t,o,a,d,m){t.data[d]=m;const v=m.factory||(m.factory=Ns(m.type)),D=new j(v,S(m),ud);t.blueprint[d]=D,a[d]=D,function mf(t,o,a,d,m){const v=m.hostBindings;if(v){let D=t.hostBindingOpCodes;null===D&&(D=t.hostBindingOpCodes=[]);const P=~o.index;(function oy(t){let o=t.length;for(;o>0;){const a=t[--o];if("number"==typeof a&&a<0)return a}return 0})(D)!=P&&D.push(P),D.push(a,d,v)}}(t,o,d,Xd(t,a,m.hostVars,wi),m)}function Ml(t,o,a,d,m,v){const D=co(t,o);!function qa(t,o,a,d,m,v,D){if(null==v)t.removeAttribute(o,m,a);else{const P=null==D?Nt(v):D(v,d||"",m);t.setAttribute(o,m,P,a)}}(o[Wr],D,v,t.value,a,d,m)}function Xl(t,o,a,d,m,v){const D=v[o];if(null!==D)for(let P=0;P<D.length;)yc(d,a,D[P++],D[P++],D[P++])}function yc(t,o,a,d,m){const v=ut(null);try{const D=t.inputTransforms;null!==D&&D.hasOwnProperty(d)&&(m=D[d].call(o,m)),null!==t.setInput?t.setInput(o,m,a,d):o[d]=m}finally{ut(v)}}function Kl(t,o,a){let d=null,m=0;for(;m<a.length;){const v=a[m];if(0!==v)if(5!==v){if("number"==typeof v)break;if(t.hasOwnProperty(v)){null===d&&(d=[]);const D=t[v];for(let P=0;P<D.length;P+=2)if(D[P]===o){d.push(v,D[P+1],a[m+1]);break}}m+=2}else m+=2;else m+=4}return d}function vc(t,o,a,d){return[t,!0,!1,o,null,0,d,a,null,null,null]}function th(t,o){const a=t.contentQueries;if(null!==a)for(let d=0;d<a.length;d+=2){const v=a[d+1];if(-1!==v){const D=t.data[v];La(a[d]),D.contentQueries(2,o[v],v)}}}function nh(t,o){return t[Xo]?t[Ko][_s]=o:t[Xo]=o,t[Ko]=o,o}function gf(t,o,a){La(0);const d=ut(null);try{o(t,a)}finally{ut(d)}}function _f(t){return t[Wo]||(t[Wo]=[])}function Sg(t){return t.cleanup||(t.cleanup=[])}function tm(t,o){const a=t[$o],d=a?a.get(sd,null):null;d&&d.handleError(o)}function yf(t,o,a,d,m){for(let v=0;v<a.length;){const D=a[v++],P=a[v++];yc(t.data[D],o[D],d,P,m)}}function Ig(t,o){const a=Yi(o,t),d=a[rr];!function Mg(t,o){for(let a=o.length;a<t.blueprint.length;a++)o.push(t.blueprint[a])}(d,a);const m=a[Wi];null!==m&&null===a[Ms]&&(a[Ms]=Nc(m,a[$o])),vf(d,a,a[no])}function vf(t,o,a){$(o);try{const d=t.viewQuery;null!==d&&gf(1,d,a);const m=t.template;null!==m&&wg(t,o,m,1,a),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&th(t,o),t.staticViewQueries&&gf(2,t.viewQuery,a);const v=t.components;null!==v&&function Gc(t,o){for(let a=0;a<o.length;a++)Ig(t,o[a])}(o,v)}catch(d){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),d}finally{o[Rr]&=-5,we()}}let nm=(()=>{var t;class o{constructor(){this.all=new Set,this.queue=new Map}create(d,m,v){const D=typeof Zone>"u"?null:Zone.current,P=new Ds(d,he=>{this.all.has(he)&&this.queue.set(he,D)},v);let V;this.all.add(P),P.notify();const ne=()=>{P.cleanup(),V?.(),this.all.delete(P),this.queue.delete(P)};return V=m?.onDestroy(ne),{destroy:ne}}flush(){if(0!==this.queue.size)for(const[d,m]of this.queue)this.queue.delete(d),m?m.run(()=>d.run()):d.run()}get isQueueEmpty(){return 0===this.queue.size}}return(t=o).\u0275prov=Wn({token:t,providedIn:"root",factory:()=>new t}),o})();function xf(t,o,a){let d=a?t.styles:null,m=a?t.classes:null,v=0;if(null!==o)for(let D=0;D<o.length;D++){const P=o[D];"number"==typeof P?v=P:1==v?m=It(m,P):2==v&&(d=It(d,P+": "+o[++D]+";"))}a?t.styles=d:t.stylesWithoutHost=d,a?t.classes=m:t.classesWithoutHost=m}function Wc(t,o,a,d,m=!1){for(;null!==a;){const v=o[a.index];if(null!==v&&d.push(Pr(v)),us(v)){for(let P=Eo;P<v.length;P++){const V=v[P],ne=V[rr].firstChild;null!==ne&&Wc(V[rr],V,ne,d)}v[os]!==v[Wi]&&d.push(v[os])}const D=a.type;if(8&D)Wc(t,o,a.child,d);else if(32&D){const P=mu(a,o);let V;for(;V=P();)d.push(V)}else if(16&D){const P=Lh(o,a);if(Array.isArray(P))d.push(...P);else{const V=Uu(o[Ni]);Wc(V[rr],V,P,d,!0)}}a=m?a.projectionNext:a.next}return d}function bf(t,o,a,d=!0){const m=o[Bo],v=m.rendererFactory,D=m.afterRenderEventManager;v.begin?.(),D?.begin();try{wf(t,o,t.template,a)}catch(V){throw d&&tm(o,V),V}finally{v.end?.(),m.effectManager?.flush(),D?.end()}}function wf(t,o,a,d){const m=o[Rr];if(256!=(256&m)){o[Bo].effectManager?.flush(),$(o);try{cr(o),function su(t){return ri.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==a&&wg(t,o,a,2,d);const D=3==(3&m);if(D){const ne=t.preOrderCheckHooks;null!==ne&&p(o,ne,null)}else{const ne=t.preOrderHooks;null!==ne&&_(o,ne,0,null),x(o,0)}if(function im(t){for(let o=Ah(t);null!==o;o=np(o)){if(!o[xs])continue;const a=o[Ho];for(let d=0;d<a.length;d++){Pa(a[d])}}}(o),Al(o,2),null!==t.contentQueries&&th(t,o),D){const ne=t.contentCheckHooks;null!==ne&&p(o,ne)}else{const ne=t.contentHooks;null!==ne&&_(o,ne,1),x(o,1)}!function Zd(t,o){const a=t.hostBindingOpCodes;if(null===a)return;const d=xg(o,Jo);try{for(let m=0;m<a.length;m++){const v=a[m];if(v<0)Nr(~v);else{const D=v,P=a[++m],V=a[++m];ph(P,D),d.runInContext(V,2,o[D])}}}finally{null===o[Jo]&&Wp(o,Jo),Nr(-1)}}(t,o);const P=t.components;null!==P&&qc(o,P,0);const V=t.viewQuery;if(null!==V&&gf(2,V,d),D){const ne=t.viewCheckHooks;null!==ne&&p(o,ne)}else{const ne=t.viewHooks;null!==ne&&_(o,ne,2),x(o,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o[Rr]&=-73,Ec(o)}finally{we()}}}function Al(t,o){for(let a=Ah(t);null!==a;a=np(a))for(let d=Eo;d<a.length;d++)gl(a[d],o)}function om(t,o,a){gl(Yi(o,t),a)}function gl(t,o){if(!function Ao(t){return 128==(128&t[Rr])}(t))return;const a=t[rr];if(80&t[Rr]&&0===o||1024&t[Rr]||2===o)wf(a,t,a.template,t[no]);else if(t[rs]>0){Al(t,1);const m=t[rr].components;null!==m&&qc(t,m,1)}}function qc(t,o,a){for(let d=0;d<o.length;d++)om(t,o[d],a)}class pd{get rootNodes(){const o=this._lView,a=o[rr];return Wc(a,o,a.firstChild,[])}constructor(o,a){this._lView=o,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[no]}set context(o){this._lView[no]=o}get destroyed(){return 256==(256&this._lView[Rr])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[qi];if(us(o)){const a=o[8],d=a?a.indexOf(this):-1;d>-1&&(Xs(o,d),_h(a,d))}this._attachedToViewContainer=!1}Ph(this._lView[rr],this._lView)}onDestroy(o){!function tc(t,o){if(256==(256&t[Rr]))throw new De(911,!1);null===t[ci]&&(t[ci]=[]),t[ci].push(o)}(this._lView,o)}markForCheck(){Vc(this._cdRefInjectingView||this._lView)}detach(){this._lView[Rr]&=-129}reattach(){this._lView[Rr]|=128}detectChanges(){bf(this._lView[rr],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new De(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ql(t,o){Rd(t,o,o[Wr],2,null,null)}(this._lView[rr],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new De(902,!1);this._appRef=o}}class Ag extends pd{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;bf(o[rr],o,o[no],!1)}checkNoChanges(){}get context(){return null}}class md extends qd{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const a=Gr(o);return new oh(a,this.ngModule)}}function ih(t){const o=[];for(let a in t)t.hasOwnProperty(a)&&o.push({propName:t[a],templateName:a});return o}class Rg{constructor(o,a){this.injector=o,this.parentInjector=a}get(o,a,d){d=Ke(d);const m=this.injector.get(o,nd,d);return m!==nd||a===nd?m:this.parentInjector.get(o,a,d)}}class oh extends Pp{get inputs(){const o=this.componentDef,a=o.inputTransforms,d=ih(o.inputs);if(null!==a)for(const m of d)a.hasOwnProperty(m.propName)&&(m.transform=a[m.propName]);return d}get outputs(){return ih(this.componentDef.outputs)}constructor(o,a){super(),this.componentDef=o,this.ngModule=a,this.componentType=o.type,this.selector=function Zr(t){return t.map(Ar).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!a}create(o,a,d,m){let v=(m=m||this.ngModule)instanceof Wa?m:m?.injector;v&&null!==this.componentDef.getStandaloneInjector&&(v=this.componentDef.getStandaloneInjector(v)||v);const D=v?new Rg(o,v):o,P=D.get(Op,null);if(null===P)throw new De(407,!1);const Ve={rendererFactory:P,sanitizer:D.get(Yd,null),effectManager:D.get(nm,null),afterRenderEventManager:D.get(uf,null)},Ct=P.createRenderer(null,this.componentDef),jt=this.componentDef.selectors[0][0]||"div",On=d?function Eg(t,o,a,d){const v=d.get(_g,!1)||a===Sr.ShadowDom,D=t.selectRootElement(o,v);return function ey(t){Zp(t)}(D),D}(Ct,d,this.componentDef.encapsulation,D):po(Ct,jt,function Pg(t){const o=t.toLowerCase();return"svg"===o?ti:"math"===o?"math":null}(jt)),qr=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Hn=null;null!==On&&(Hn=Nc(On,D,!0));const Li=ff(0,null,null,1,0,null,null,null,null,null,null),eo=Uc(null,Li,null,qr,null,null,Ve,Ct,D,null,Hn);let ns,vl;$(eo);try{const Iu=this.componentDef;let Lf,pv=null;Iu.findHostDirectiveDefs?(Lf=[],pv=new Map,Iu.findHostDirectiveDefs(Iu,Lf,pv),Lf.push(Iu)):Lf=[Iu];const SC=function kg(t,o){const a=t[rr],d=fi;return t[d]=o,Zl(a,d,2,"#host",null)}(eo,On),IC=function Lg(t,o,a,d,m,v,D){const P=m[rr];!function fy(t,o,a,d){for(const m of t)o.mergedAttrs=so(o.mergedAttrs,m.hostAttrs);null!==o.mergedAttrs&&(xf(o,o.mergedAttrs,!0),null!==a&&cp(d,a,o))}(d,t,o,D);let V=null;null!==o&&(V=Nc(o,m[$o]));const ne=v.rendererFactory.createRenderer(o,a);let he=16;a.signals?he=4096:a.onPush&&(he=64);const Ve=Uc(m,Yp(a),null,he,m[t.index],t,v,ne,null,null,V);return P.firstCreatePass&&Qp(P,t,d.length-1),nh(m,Ve),m[t.index]=Ve}(SC,On,Iu,Lf,eo,Ve,Ct);vl=uo(Li,fi),On&&function Fg(t,o,a,d){if(d)Vi(t,a,["ng-version",kp.full]);else{const{attrs:m,classes:v}=function ji(t){const o=[],a=[];let d=1,m=2;for(;d<t.length;){let v=t[d];if("string"==typeof v)2===m?""!==v&&o.push(v,t[++d]):8===m&&a.push(v);else{if(!Se(m))break;m=v}d++}return{attrs:o,classes:a}}(o.selectors[0]);m&&Vi(t,a,m),v&&v.length>0&&Um(t,a,v.join(" "))}}(Ct,Iu,On,d),void 0!==a&&function Bg(t,o,a){const d=t.projection=[];for(let m=0;m<o.length;m++){const v=a[m];d.push(null!=v?Array.from(v):null)}}(vl,this.ngContentSelectors,a),ns=function sm(t,o,a,d,m,v){const D=Vs(),P=m[rr],V=co(D,m);Kp(P,m,D,a,null,d);for(let he=0;he<a.length;he++)ga(wr(m,P,D.directiveStart+he,D),m);Cg(P,m,D),V&&ga(V,m);const ne=wr(m,P,D.directiveStart+D.componentOffset,D);if(t[no]=m[no]=ne,null!==v)for(const he of v)he(ne,o);return jc(P,D,t),ne}(IC,Iu,Lf,pv,eo,[Ng]),vf(Li,eo,null)}finally{we()}return new Og(this.componentType,ns,zc(vl,eo),eo,vl)}}class Og extends td{constructor(o,a,d,m,v){super(),this.location=d,this._rootLView=m,this._tNode=v,this.previousInputValues=null,this.instance=a,this.hostView=this.changeDetectorRef=new Ag(m),this.componentType=o}setInput(o,a){const d=this._tNode.inputs;let m;if(null!==d&&(m=d[o])){if(this.previousInputValues??=new Map,this.previousInputValues.has(o)&&Object.is(this.previousInputValues.get(o),a))return;const v=this._rootLView;yf(v[rr],v,m,o,a),this.previousInputValues.set(o,a),Vc(Yi(this._tNode.index,v))}}get injector(){return new bo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function Ng(){const t=Vs();c(Vn()[rr],t)}function sh(t){let o=function Ef(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),a=!0;const d=[t];for(;o;){let m;if(S(t))m=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new De(903,!1);m=o.\u0275dir}if(m){if(a){d.push(m);const D=t;D.inputs=Yc(t.inputs),D.inputTransforms=Yc(t.inputTransforms),D.declaredInputs=Yc(t.declaredInputs),D.outputs=Yc(t.outputs);const P=m.hostBindings;P&&n(t,P);const V=m.viewQuery,ne=m.contentQueries;if(V&&am(t,V),ne&&$g(t,ne),xt(t.inputs,m.inputs),xt(t.declaredInputs,m.declaredInputs),xt(t.outputs,m.outputs),null!==m.inputTransforms&&(null===D.inputTransforms&&(D.inputTransforms={}),xt(D.inputTransforms,m.inputTransforms)),S(m)&&m.data.animation){const he=t.data;he.animation=(he.animation||[]).concat(m.data.animation)}}const v=m.features;if(v)for(let D=0;D<v.length;D++){const P=v[D];P&&P.ngInherit&&P(t),P===sh&&(a=!1)}}o=Object.getPrototypeOf(o)}!function zg(t){let o=0,a=null;for(let d=t.length-1;d>=0;d--){const m=t[d];m.hostVars=o+=m.hostVars,m.hostAttrs=so(m.hostAttrs,a=so(a,m.hostAttrs))}}(d)}function Yc(t){return t===mi?{}:t===Yr?[]:t}function am(t,o){const a=t.viewQuery;t.viewQuery=a?(d,m)=>{o(d,m),a(d,m)}:o}function $g(t,o){const a=t.contentQueries;t.contentQueries=a?(d,m,v)=>{o(d,m,v),a(d,m,v)}:o}function n(t,o){const a=t.hostBindings;t.hostBindings=a?(d,m)=>{o(d,m),a(d,m)}:o}function O(t){const o=t.inputConfig,a={};for(const d in o)if(o.hasOwnProperty(d)){const m=o[d];Array.isArray(m)&&m[2]&&(a[d]=m[2])}t.inputTransforms=a}function U(t){return!!se(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function se(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Ae(t,o,a){return!Object.is(t[o],a)&&(t[o]=a,!0)}function rn(t,o,a,d){const m=Vn();return Ae(m,fs(),o)&&(Zi(),Ml(Mi(),m,t,o,a,d)),rn}function xn(t,o,a,d){return Ae(t,fs(),a)?o+Nt(a)+d:wi}function Jc(t,o,a,d,m,v,D,P){const V=Vn(),ne=Zi(),he=t+fi,Ve=ne.firstCreatePass?function jg(t,o,a,d,m,v,D,P,V){const ne=o.consts,he=Zl(o,t,4,D||null,pa(ne,P));Qd(o,a,he,pa(ne,V)),c(o,he);const Ve=he.tView=ff(2,he,d,m,v,o.directiveRegistry,o.pipeRegistry,null,o.schemas,ne,null);return null!==o.queries&&(o.queries.template(o,he),Ve.queries=o.queries.embeddedTView(he)),he}(he,ne,V,o,a,d,m,v,D):ne.data[he];Ra(Ve,!1);const Ct=Tf(ne,V,Ve,t);Dl()&&Wu(ne,V,Ct,Ve),ga(Ct,V),nh(V,V[he]=vc(Ct,V,Ct,Ve)),bs(Ve)&&fd(ne,V,Ve),null!=D&&qp(V,Ve,P)}let Tf=function Sf(t,o,a,d){return h(!0),o[Wr].createComment("")};function za(t){return function ho(t,o){return t[o]}(function Au(){return ri.lFrame.contextLView}(),fi+t)}function Ma(t,o,a){const d=Vn();return Ae(d,fs(),o)&&Na(Zi(),Mi(),d,t,o,d[Wr],a,!1),Ma}function Su(t,o,a,d,m){const D=m?"class":"style";yf(t,a,o.inputs[D],D,d)}function ah(t,o,a,d){const m=Vn(),v=Zi(),D=fi+t,P=m[Wr],V=v.firstCreatePass?function um(t,o,a,d,m,v){const D=o.consts,V=Zl(o,t,2,d,pa(D,m));return Qd(o,a,V,pa(D,v)),null!==V.attrs&&xf(V,V.attrs,!1),null!==V.mergedAttrs&&xf(V,V.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,V),V}(D,v,m,o,a,d):v.data[D],ne=kv(v,m,V,P,o,t);m[D]=ne;const he=bs(V);return Ra(V,!0),cp(P,ne,V),32!=(32&V.flags)&&Dl()&&Wu(v,m,ne,V),0===function nc(){return ri.lFrame.elementDepthCount}()&&ga(ne,m),function $a(){ri.lFrame.elementDepthCount++}(),he&&(fd(v,m,V),jc(v,V,m)),null!==d&&qp(m,V),ah}function ec(){let t=Vs();Za()?ic():(t=t.parent,Ra(t,!1));const o=t;(function hh(t){return ri.skipHydrationRootTNode===t})(o)&&function iu(){ri.skipHydrationRootTNode=null}(),function Dc(){ri.lFrame.elementDepthCount--}();const a=Zi();return a.firstCreatePass&&(c(a,t),ya(t)&&a.queries.elementEnd(t)),null!=o.classesWithoutHost&&function Te(t){return 0!=(8&t.flags)}(o)&&Su(a,o,Vn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Re(t){return 0!=(16&t.flags)}(o)&&Su(a,o,Vn(),o.stylesWithoutHost,!1),ec}function gy(t,o,a,d){return ah(t,o,a,d),ec(),gy}let kv=(t,o,a,d,m,v)=>(h(!0),po(d,m,function Ka(){return ri.lFrame.currentNamespace}()));function _y(t,o,a){const d=Vn(),m=Zi(),v=t+fi,D=m.firstCreatePass?function Jb(t,o,a,d,m){const v=o.consts,D=pa(v,d),P=Zl(o,t,8,"ng-container",D);return null!==D&&xf(P,D,!0),Qd(o,a,P,pa(v,m)),null!==o.queries&&o.queries.elementStart(o,P),P}(v,m,d,o,a):m.data[v];Ra(D,!0);const P=Lv(m,d,D,t);return d[v]=P,Dl()&&Wu(m,d,P,D),ga(P,d),bs(D)&&(fd(m,d,D),jc(m,D,d)),null!=a&&qp(d,D),_y}function yy(){let t=Vs();const o=Zi();return Za()?ic():(t=t.parent,Ra(t,!1)),o.firstCreatePass&&(c(o,t),ya(t)&&o.queries.elementEnd(t)),yy}function vy(t,o,a){return _y(t,o,a),yy(),vy}let Lv=(t,o,a,d)=>(h(!0),Gl(o[Wr],""));function Fv(){return Vn()}function xy(t){return!!t&&"function"==typeof t.then}function Bv(t){return!!t&&"function"==typeof t.subscribe}function by(t,o,a,d){const m=Vn(),v=Zi(),D=Vs();return function zv(t,o,a,d,m,v,D){const P=bs(d),ne=t.firstCreatePass&&Sg(t),he=o[no],Ve=_f(o);let Ct=!0;if(3&d.type||D){const Jn=co(d,o),xr=D?D(Jn):Jn,qr=Ve.length,Hn=D?eo=>D(Pr(eo[d.index])):d.index;let Li=null;if(!D&&P&&(Li=function t1(t,o,a,d){const m=t.cleanup;if(null!=m)for(let v=0;v<m.length-1;v+=2){const D=m[v];if(D===a&&m[v+1]===d){const P=o[Wo],V=m[v+2];return P.length>V?P[V]:null}"string"==typeof D&&(v+=2)}return null}(t,o,m,d.index)),null!==Li)(Li.__ngLastListenerFn__||Li).__ngNextListenerFn__=v,Li.__ngLastListenerFn__=v,Ct=!1;else{v=Vv(d,o,he,v,!1);const eo=a.listen(xr,m,v);Ve.push(v,eo),ne&&ne.push(m,Hn,qr,qr+1)}}else v=Vv(d,o,he,v,!1);const jt=d.outputs;let On;if(Ct&&null!==jt&&(On=jt[m])){const Jn=On.length;if(Jn)for(let xr=0;xr<Jn;xr+=2){const ns=o[On[xr]][On[xr+1]].subscribe(v),vl=Ve.length;Ve.push(v,ns),ne&&ne.push(m,d.index,vl,-(vl+1))}}}(v,m,m[Wr],D,t,o,d),by}function $v(t,o,a,d){try{return _r(6,o,a),!1!==a(d)}catch(m){return tm(t,m),!1}finally{_r(7,o,a)}}function Vv(t,o,a,d,m){return function v(D){if(D===Function)return d;Vc(t.componentOffset>-1?Yi(t.index,o):o);let V=$v(o,a,d,D),ne=v.__ngNextListenerFn__;for(;ne;)V=$v(o,a,ne,D)&&V,ne=ne.__ngNextListenerFn__;return m&&!1===V&&D.preventDefault(),V}}function Uv(t=1){return function Rn(t){return(ri.lFrame.contextLView=function mr(t,o){for(;t>0;)o=o[ys],t--;return o}(t,ri.lFrame.contextLView))[no]}(t)}function n1(t,o){let a=null;const d=function fn(t){const o=t.attrs;if(null!=o){const a=o.indexOf(5);if(!(1&a))return o[a+1]}return null}(t);for(let m=0;m<o.length;m++){const v=o[m];if("*"!==v){if(null===d?Pt(t,v,!0):Pn(d,v))return m}else a=m}return a}function jv(t){const o=Vn()[Ni][io];if(!o.projection){const d=o.projection=xd(t?t.length:1,null),m=d.slice();let v=o.child;for(;null!==v;){const D=t?n1(v,t):0;null!==D&&(m[D]?m[D].projectionNext=v:d[D]=v,m[D]=v),v=v.next}}}function Hv(t,o=0,a){const d=Vn(),m=Zi(),v=Zl(m,fi+t,16,null,a||null);null===v.projection&&(v.projection=o),ic(),(!d[Ms]||bl())&&32!=(32&v.flags)&&function qu(t,o,a){Od(o[Wr],0,o,a,Md(t,a,o),Oh(a.parent||o[io],a,o))}(m,d,v)}function Hg(t,o){return t<<17|o<<2}function gd(t){return t>>17&32767}function Ey(t){return 2|t}function lh(t){return(131068&t)>>2}function Dy(t,o){return-131069&t|o<<2}function Cy(t){return 1|t}function e0(t,o,a,d,m){const v=t[a+1],D=null===o;let P=d?gd(v):lh(v),V=!1;for(;0!==P&&(!1===V||D);){const he=t[P+1];l1(t[P],o)&&(V=!0,t[P+1]=d?Cy(he):Ey(he)),P=d?gd(he):lh(he)}V&&(t[a+1]=d?Ey(v):Cy(v))}function l1(t,o){return null===t||null==o||(Array.isArray(t)?t[1]:t)===o||!(!Array.isArray(t)||"string"!=typeof o)&&el(t,o)>=0}const ba={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function t0(t){return t.substring(ba.key,ba.keyEnd)}function n0(t,o){const a=ba.textEnd;return a===o?-1:(o=ba.keyEnd=function h1(t,o,a){for(;o<a&&t.charCodeAt(o)>32;)o++;return o}(t,ba.key=o,a),If(t,o,a))}function If(t,o,a){for(;o<a&&t.charCodeAt(o)<=32;)o++;return o}function Ty(t,o){return function xc(t,o,a,d){const m=Vn(),v=Zi(),D=Xa(2);v.firstUpdatePass&&u0(v,t,D,d),o!==wi&&Ae(m,D,o)&&h0(v,v.data[oi()],m,m[Wr],t,m[D+1]=function D1(t,o){return null==t||""===t||("string"==typeof o?t+=o:"object"==typeof t&&(t=Kt(Oc(t)))),t}(o,a),d,D)}(t,o,null,!0),Ty}function tu(t,o){for(let a=function u1(t){return function o0(t){ba.key=0,ba.keyEnd=0,ba.value=0,ba.valueEnd=0,ba.textEnd=t.length}(t),n0(t,If(t,0,ba.textEnd))}(o);a>=0;a=n0(o,a))Zs(t,t0(o),!0)}function c0(t,o){return o>=t.expandoStartIndex}function u0(t,o,a,d){const m=t.data;if(null===m[a+1]){const v=m[oi()],D=c0(t,a);p0(v,d)&&null===o&&!D&&(o=!1),o=function _1(t,o,a,d){const m=function Ru(t){const o=ri.lFrame.currentDirectiveIndex;return-1===o?null:t[o]}(t);let v=d?o.residualClasses:o.residualStyles;if(null===m)0===(d?o.classBindings:o.styleBindings)&&(a=dm(a=Sy(null,t,o,a,d),o.attrs,d),v=null);else{const D=o.directiveStylingLast;if(-1===D||t[D]!==m)if(a=Sy(m,t,o,a,d),null===v){let V=function y1(t,o,a){const d=a?o.classBindings:o.styleBindings;if(0!==lh(d))return t[gd(d)]}(t,o,d);void 0!==V&&Array.isArray(V)&&(V=Sy(null,t,o,V[1],d),V=dm(V,o.attrs,d),function v1(t,o,a,d){t[gd(a?o.classBindings:o.styleBindings)]=d}(t,o,d,V))}else v=function x1(t,o,a){let d;const m=o.directiveEnd;for(let v=1+o.directiveStylingLast;v<m;v++)d=dm(d,t[v].hostAttrs,a);return dm(d,o.attrs,a)}(t,o,d)}return void 0!==v&&(d?o.residualClasses=v:o.residualStyles=v),a}(m,v,o,d),function s1(t,o,a,d,m,v){let D=v?o.classBindings:o.styleBindings,P=gd(D),V=lh(D);t[d]=a;let he,ne=!1;if(Array.isArray(a)?(he=a[1],(null===he||el(a,he)>0)&&(ne=!0)):he=a,m)if(0!==V){const Ct=gd(t[P+1]);t[d+1]=Hg(Ct,P),0!==Ct&&(t[Ct+1]=Dy(t[Ct+1],d)),t[P+1]=function i1(t,o){return 131071&t|o<<17}(t[P+1],d)}else t[d+1]=Hg(P,0),0!==P&&(t[P+1]=Dy(t[P+1],d)),P=d;else t[d+1]=Hg(V,0),0===P?P=d:t[V+1]=Dy(t[V+1],d),V=d;ne&&(t[d+1]=Ey(t[d+1])),e0(t,he,d,!0),e0(t,he,d,!1),function a1(t,o,a,d,m){const v=m?t.residualClasses:t.residualStyles;null!=v&&"string"==typeof o&&el(v,o)>=0&&(a[d+1]=Cy(a[d+1]))}(o,he,t,d,v),D=Hg(P,V),v?o.classBindings=D:o.styleBindings=D}(m,v,o,a,D,d)}}function Sy(t,o,a,d,m){let v=null;const D=a.directiveEnd;let P=a.directiveStylingLast;for(-1===P?P=a.directiveStart:P++;P<D&&(v=o[P],d=dm(d,v.hostAttrs,m),v!==t);)P++;return null!==t&&(a.directiveStylingLast=P),d}function dm(t,o,a){const d=a?1:2;let m=-1;if(null!==o)for(let v=0;v<o.length;v++){const D=o[v];"number"==typeof D?m=D:m===d&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Zs(t,D,!!a||o[++v]))}return void 0===t?null:t}function h0(t,o,a,d,m,v,D,P){if(!(3&o.type))return;const V=t.data,ne=V[P+1],he=function o1(t){return 1==(1&t)}(ne)?f0(V,o,a,m,lh(ne),D):void 0;Gg(he)||(Gg(v)||function r1(t){return 2==(2&t)}(ne)&&(v=f0(V,null,a,m,P,D)),function Vm(t,o,a,d,m){if(o)m?t.addClass(a,d):t.removeClass(a,d);else{let v=-1===d.indexOf("-")?void 0:Nu.DashCase;null==m?t.removeStyle(a,d,v):("string"==typeof m&&m.endsWith("!important")&&(m=m.slice(0,-10),v|=Nu.Important),t.setStyle(a,d,m,v))}}(d,D,ni(oi(),a),m,v))}function f0(t,o,a,d,m,v){const D=null===o;let P;for(;m>0;){const V=t[m],ne=Array.isArray(V),he=ne?V[1]:V,Ve=null===he;let Ct=a[m+1];Ct===wi&&(Ct=Ve?Yr:void 0);let jt=Ve?Qa(Ct,d):he===d?Ct:void 0;if(ne&&!Gg(jt)&&(jt=Qa(V,d)),Gg(jt)&&(P=jt,D))return P;const On=t[m+1];m=D?gd(On):lh(On)}if(null!==o){let V=v?o.residualClasses:o.residualStyles;null!=V&&(P=Qa(V,d))}return P}function Gg(t){return void 0!==t}function p0(t,o){return 0!=(t.flags&(o?8:16))}function m0(t,o=""){const a=Vn(),d=Zi(),m=t+fi,v=d.firstCreatePass?Zl(d,m,1,o,null):d.data[m],D=g0(d,a,v,o,t);a[m]=D,Dl()&&Wu(d,a,D,v),Ra(v,!1)}let g0=(t,o,a,d,m)=>(h(!0),function Ac(t,o){return t.createText(o)}(o[Wr],d));function Iy(t){return Wg("",t,""),Iy}function Wg(t,o,a){const d=Vn(),m=xn(d,t,o,a);return m!==wi&&function Jl(t,o,a){const d=ni(o,t);!function rp(t,o,a){t.setValue(o,a)}(t[Wr],d,a)}(d,oi(),m),Wg}function C0(t,o,a){!function bc(t,o,a,d){const m=Zi(),v=Xa(2);m.firstUpdatePass&&u0(m,null,v,d);const D=Vn();if(a!==wi&&Ae(D,v,a)){const P=m.data[oi()];if(p0(P,d)&&!c0(m,v)){let V=d?P.classesWithoutHost:P.stylesWithoutHost;null!==V&&(a=It(V,a||"")),Su(m,P,D,a,d)}else!function E1(t,o,a,d,m,v,D,P){m===wi&&(m=Yr);let V=0,ne=0,he=0<m.length?m[0]:null,Ve=0<v.length?v[0]:null;for(;null!==he||null!==Ve;){const Ct=V<m.length?m[V+1]:void 0,jt=ne<v.length?v[ne+1]:void 0;let Jn,On=null;he===Ve?(V+=2,ne+=2,Ct!==jt&&(On=Ve,Jn=jt)):null===Ve||null!==he&&he<Ve?(V+=2,On=he):(ne+=2,On=Ve,Jn=jt),null!==On&&h0(t,o,a,d,On,Jn,D,P),he=V<m.length?m[V]:null,Ve=ne<v.length?v[ne]:null}}(m,P,D,D[Wr],D[v+1],D[v+1]=function b1(t,o,a){if(null==a||""===a)return Yr;const d=[],m=Oc(a);if(Array.isArray(m))for(let v=0;v<m.length;v++)t(d,m[v],!0);else if("object"==typeof m)for(const v in m)m.hasOwnProperty(v)&&t(d,v,m[v]);else"string"==typeof m&&o(d,m);return d}(t,o,a),d,v)}}(Zs,tu,xn(Vn(),t,o,a),!0)}function My(t,o,a){const d=Vn();return Ae(d,fs(),o)&&Na(Zi(),Mi(),d,t,o,d[Wr],a,!0),My}const ch=void 0;var G1=["en",[["a","p"],["AM","PM"],ch],[["AM","PM"],ch,ch],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ch,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ch,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ch,"{1} 'at' {0}",ch],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function H1(t){const a=Math.floor(Math.abs(t)),d=t.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===d?1:5}];let Mf={};function Ay(t){const o=function W1(t){return t.toLowerCase().replace(/_/g,"-")}(t);let a=B0(o);if(a)return a;const d=o.split("-")[0];if(a=B0(d),a)return a;if("en"===d)return G1;throw new De(701,!1)}function F0(t){return Ay(t)[Af.PluralCase]}function B0(t){return t in Mf||(Mf[t]=Pi.ng&&Pi.ng.common&&Pi.ng.common.locales&&Pi.ng.common.locales[t]),Mf[t]}var Af=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(Af||{});const Pf="en-US";let N0=Pf;function Oy(t,o,a,d,m){if(t=Tt(t),Array.isArray(t))for(let v=0;v<t.length;v++)Oy(t[v],o,a,d,m);else{const v=Zi(),D=Vn(),P=Vs();let V=Lc(t)?t:Tt(t.provide);const ne=sg(t),he=1048575&P.providerIndexes,Ve=P.directiveStart,Ct=P.providerIndexes>>20;if(Lc(t)||!t.multi){const jt=new j(ne,m,ud),On=Ly(V,o,m?he:he+Ct,Ve);-1===On?(kn(Bn(P,D),v,V),ky(v,t,o.length),o.push(V),P.directiveStart++,P.directiveEnd++,m&&(P.providerIndexes+=1048576),a.push(jt),D.push(jt)):(a[On]=jt,D[On]=jt)}else{const jt=Ly(V,o,he+Ct,Ve),On=Ly(V,o,he,he+Ct),xr=On>=0&&a[On];if(m&&!xr||!m&&!(jt>=0&&a[jt])){kn(Bn(P,D),v,V);const qr=function Hw(t,o,a,d,m){const v=new j(t,a,ud);return v.multi=[],v.index=o,v.componentProviders=0,cx(v,m,d&&!a),v}(m?jw:Uw,a.length,m,d,ne);!m&&xr&&(a[On].providerFactory=qr),ky(v,t,o.length,0),o.push(V),P.directiveStart++,P.directiveEnd++,m&&(P.providerIndexes+=1048576),a.push(qr),D.push(qr)}else ky(v,t,jt>-1?jt:On,cx(a[m?On:jt],ne,!m&&d));!m&&d&&xr&&a[On].componentProviders++}}}function ky(t,o,a,d){const m=Lc(o),v=function A_(t){return!!t.useClass}(o);if(m||v){const V=(v?Tt(o.useClass):o).prototype.ngOnDestroy;if(V){const ne=t.destroyHooks||(t.destroyHooks=[]);if(!m&&o.multi){const he=ne.indexOf(a);-1===he?ne.push(a,[d,V]):ne[he+1].push(d,V)}else ne.push(a,V)}}}function cx(t,o,a){return a&&t.componentProviders++,t.multi.push(o)-1}function Ly(t,o,a,d){for(let m=a;m<d;m++)if(o[m]===t)return m;return-1}function Uw(t,o,a,d){return Fy(this.multi,[])}function jw(t,o,a,d){const m=this.multi;let v;if(this.providerFactory){const D=this.providerFactory.componentProviders,P=wr(a,a[rr],this.providerFactory.index,d);v=P.slice(0,D),Fy(m,v);for(let V=D;V<P.length;V++)v.push(P[V])}else v=[],Fy(m,v);return v}function Fy(t,o){for(let a=0;a<t.length;a++)o.push((0,t[a])());return o}function ux(t,o=[]){return a=>{a.providersResolver=(d,m)=>function Vw(t,o,a){const d=Zi();if(d.firstCreatePass){const m=S(t);Oy(a,d.data,d.blueprint,m,!0),Oy(o,d.data,d.blueprint,m,!1)}}(d,m?m(t):t,o)}}class uh{}class dx{}function Gw(t,o){return new By(t,o??null,[])}class By extends uh{constructor(o,a,d){super(),this._parent=a,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new md(this);const m=xi(o);this._bootstrapComponents=Yl(m.bootstrap),this._r3Injector=$p(o,a,[{provide:uh,useValue:this},{provide:qd,useValue:this.componentFactoryResolver},...d],Kt(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Ny extends dx{constructor(o){super(),this.moduleType=o}create(o){return new By(this.moduleType,o,[])}}class hx extends uh{constructor(o){super(),this.componentFactoryResolver=new md(this),this.instance=null;const a=new fc([...o.providers,{provide:uh,useValue:this},{provide:qd,useValue:this.componentFactoryResolver}],o.parent||ua(),o.debugName,new Set(["environment"]));this.injector=a,o.runEnvironmentInitializers&&a.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function fx(t,o,a=null){return new hx({providers:t,parent:o,debugName:a,runEnvironmentInitializers:!0}).injector}let qw=(()=>{var t;class o{constructor(d){this._injector=d,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(d){if(!d.standalone)return null;if(!this.cachedInjectors.has(d)){const m=vp(0,d.type),v=m.length>0?fx([m],this._injector,`Standalone[${d.type.name}]`):null;this.cachedInjectors.set(d,v)}return this.cachedInjectors.get(d)}ngOnDestroy(){try{for(const d of this.cachedInjectors.values())null!==d&&d.destroy()}finally{this.cachedInjectors.clear()}}}return(t=o).\u0275prov=Wn({token:t,providedIn:"environment",factory:()=>new t(Qr(Wa))}),o})();function px(t){t.getStandaloneInjector=o=>o.get(qw).getOrCreateStandaloneInjector(t)}function bx(t,o,a){const d=function qs(){const t=ri.lFrame;let o=t.bindingRootIndex;return-1===o&&(o=t.bindingRootIndex=t.tView.bindingStartIndex),o}()+t,m=Vn();return m[d]===wi?function Pe(t,o,a){return t[o]=a}(m,d,a?o.call(a):o()):function Xe(t,o){return t[o]}(m,d)}function $y(t){return o=>{setTimeout(t,void 0,o)}}const nu=class yE extends T.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,a,d){let m=o,v=a||(()=>null),D=d;if(o&&"object"==typeof o){const V=o;m=V.next?.bind(V),v=V.error?.bind(V),D=V.complete?.bind(V)}this.__isAsync&&(v=$y(v),m&&(m=$y(m)),D&&(D=$y(D)));const P=super.subscribe({next:m,error:v,complete:D});return o instanceof b.w0&&o.add(P),P}};function vE(){return this._results[Symbol.iterator]()}class Kg{get changes(){return this._changes||(this._changes=new nu)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=Kg.prototype;a[Symbol.iterator]||(a[Symbol.iterator]=vE)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,a){return this._results.reduce(o,a)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,a){const d=this;d.dirty=!1;const m=function Fa(t){return t.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function ac(t,o,a){if(t.length!==o.length)return!1;for(let d=0;d<t.length;d++){let m=t[d],v=o[d];if(a&&(m=a(m),v=a(v)),v!==m)return!1}return!0}(d._results,m,a))&&(d._results=m,d.length=m.length,d.last=m[this.length-1],d.first=m[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function bE(t,o,a,d=!0){const m=o[rr];if(function nl(t,o,a,d){const m=Eo+d,v=a.length;d>0&&(a[m-1][_s]=o),d<v-Eo?(o[_s]=a[m],Nf(a,Eo+d,o)):(a.push(o),o[_s]=null),o[qi]=a;const D=o[aa];null!==D&&a!==D&&function _a(t,o){const a=t[Ho];o[Ni]!==o[qi][qi][Ni]&&(t[xs]=!0),null===a?t[Ho]=[o]:a.push(o)}(D,o);const P=o[vs];null!==P&&P.insertView(t),o[Rr]|=128}(m,o,t,a),d){const v=Fh(a,t),D=o[Wr],P=gu(D,t[os]);null!==P&&function Wl(t,o,a,d,m,v){d[Wi]=m,d[io]=o,Rd(t,d,a,1,m,v)}(m,t[io],D,o,P,v)}}let vm=(()=>{class o{}return o.__NG_ELEMENT_ID__=DE,o})();const wE=vm,EE=class extends wE{constructor(o,a,d){super(),this._declarationLView=o,this._declarationTContainer=a,this.elementRef=d}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(o,a){return this.createEmbeddedViewImpl(o,a)}createEmbeddedViewImpl(o,a,d){const m=function xE(t,o,a,d){const m=o.tView,P=Uc(t,m,a,4096&t[Rr]?4096:16,null,o,null,null,null,d?.injector??null,d?.hydrationInfo??null);P[aa]=t[o.index];const ne=t[vs];return null!==ne&&(P[vs]=ne.createEmbeddedView(m)),vf(m,P,a),P}(this._declarationLView,this._declarationTContainer,o,{injector:a,hydrationInfo:d});return new pd(m)}};function DE(){return Jg(Vs(),Vn())}function Jg(t,o){return 4&t.type?new EE(o,t,zc(t,o)):null}let e_=(()=>{class o{}return o.__NG_ELEMENT_ID__=AE,o})();function AE(){return Ox(Vs(),Vn())}const PE=e_,Px=class extends PE{constructor(o,a,d){super(),this._lContainer=o,this._hostTNode=a,this._hostLView=d}get element(){return zc(this._hostTNode,this._hostLView)}get injector(){return new bo(this._hostTNode,this._hostLView)}get parentInjector(){const o=$n(this._hostTNode,this._hostLView);if(Ne(o)){const a=mt(o,this._hostLView),d=$e(o);return new bo(a[rr].data[d+8],a)}return new bo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const a=Rx(this._lContainer);return null!==a&&a[o]||null}get length(){return this._lContainer.length-Eo}createEmbeddedView(o,a,d){let m,v;"number"==typeof d?m=d:null!=d&&(m=d.index,v=d.injector);const P=o.createEmbeddedViewImpl(a||{},v,null);return this.insertImpl(P,m,false),P}createComponent(o,a,d,m,v){const D=o&&!function Tc(t){return"function"==typeof t}(o);let P;if(D)P=a;else{const Jn=a||{};P=Jn.index,d=Jn.injector,m=Jn.projectableNodes,v=Jn.environmentInjector||Jn.ngModuleRef}const V=D?o:new oh(Gr(o)),ne=d||this.parentInjector;if(!v&&null==V.ngModule){const xr=(D?ne:this.parentInjector).get(Wa,null);xr&&(v=xr)}Gr(V.componentType??{});const jt=V.create(ne,m,null,v);return this.insertImpl(jt.hostView,P,false),jt}insert(o,a){return this.insertImpl(o,a,!1)}insertImpl(o,a,d){const m=o._lView;if(function wc(t){return us(t[qi])}(m)){const V=this.indexOf(o);if(-1!==V)this.detach(V);else{const ne=m[qi],he=new Px(ne,ne[io],ne[qi]);he.detach(he.indexOf(o))}}const D=this._adjustIndex(a),P=this._lContainer;return bE(P,m,D,!d),o.attachToViewContainerRef(),Nf(Vy(P),D,o),o}move(o,a){return this.insert(o,a)}indexOf(o){const a=Rx(this._lContainer);return null!==a?a.indexOf(o):-1}remove(o){const a=this._adjustIndex(o,-1),d=Xs(this._lContainer,a);d&&(_h(Vy(this._lContainer),a),Ph(d[rr],d))}detach(o){const a=this._adjustIndex(o,-1),d=Xs(this._lContainer,a);return d&&null!=_h(Vy(this._lContainer),a)?new pd(d):null}_adjustIndex(o,a=0){return o??this.length+a}};function Rx(t){return t[8]}function Vy(t){return t[8]||(t[8]=[])}function Ox(t,o){let a;const d=o[t.index];return us(d)?a=d:(a=vc(d,o,null,t),o[t.index]=a,nh(o,a)),kx(a,o,t,d),new Px(a,t,o)}let kx=function Lx(t,o,a,d){if(t[os])return;let m;m=8&a.type?Pr(d):function RE(t,o){const a=t[Wr],d=a.createComment(""),m=co(o,t);return cc(a,gu(a,m),d,function Rh(t,o){return t.nextSibling(o)}(a,m),!1),d}(o,a),t[os]=m};class Uy{constructor(o){this.queryList=o,this.matches=null}clone(){return new Uy(this.queryList)}setDirty(){this.queryList.setDirty()}}class jy{constructor(o=[]){this.queries=o}createEmbeddedView(o){const a=o.queries;if(null!==a){const d=null!==o.contentQueries?o.contentQueries[0]:a.length,m=[];for(let v=0;v<d;v++){const D=a.getByIndex(v);m.push(this.queries[D.indexInDeclarationView].clone())}return new jy(m)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let a=0;a<this.queries.length;a++)null!==Hx(o,a).matches&&this.queries[a].setDirty()}}class Fx{constructor(o,a,d=null){this.predicate=o,this.flags=a,this.read=d}}class Hy{constructor(o=[]){this.queries=o}elementStart(o,a){for(let d=0;d<this.queries.length;d++)this.queries[d].elementStart(o,a)}elementEnd(o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(o)}embeddedTView(o){let a=null;for(let d=0;d<this.length;d++){const m=null!==a?a.length:0,v=this.getByIndex(d).embeddedTView(o,m);v&&(v.indexInDeclarationView=d,null!==a?a.push(v):a=[v])}return null!==a?new Hy(a):null}template(o,a){for(let d=0;d<this.queries.length;d++)this.queries[d].template(o,a)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Gy{constructor(o,a=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(o,a){this.isApplyingToNode(a)&&this.matchTNode(o,a)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,a){this.elementStart(o,a)}embeddedTView(o,a){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,a),new Gy(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let d=o.parent;for(;null!==d&&8&d.type&&d.index!==a;)d=d.parent;return a===(null!==d?d.index:-1)}return this._appliesToNextNode}matchTNode(o,a){const d=this.metadata.predicate;if(Array.isArray(d))for(let m=0;m<d.length;m++){const v=d[m];this.matchTNodeWithReadOption(o,a,LE(a,v)),this.matchTNodeWithReadOption(o,a,Di(a,o,v,!1,!1))}else d===vm?4&a.type&&this.matchTNodeWithReadOption(o,a,-1):this.matchTNodeWithReadOption(o,a,Di(a,o,d,!1,!1))}matchTNodeWithReadOption(o,a,d){if(null!==d){const m=this.metadata.read;if(null!==m)if(m===da||m===e_||m===vm&&4&a.type)this.addMatch(a.index,-2);else{const v=Di(a,o,m,!1,!1);null!==v&&this.addMatch(a.index,v)}else this.addMatch(a.index,d)}}addMatch(o,a){null===this.matches?this.matches=[o,a]:this.matches.push(o,a)}}function LE(t,o){const a=t.localNames;if(null!==a)for(let d=0;d<a.length;d+=2)if(a[d]===o)return a[d+1];return null}function BE(t,o,a,d){return-1===a?function FE(t,o){return 11&t.type?zc(t,o):4&t.type?Jg(t,o):null}(o,t):-2===a?function NE(t,o,a){return a===da?zc(o,t):a===vm?Jg(o,t):a===e_?Ox(o,t):void 0}(t,o,d):wr(t,t[rr],a,o)}function Bx(t,o,a,d){const m=o[vs].queries[d];if(null===m.matches){const v=t.data,D=a.matches,P=[];for(let V=0;V<D.length;V+=2){const ne=D[V];P.push(ne<0?null:BE(o,v[ne],D[V+1],a.metadata.read))}m.matches=P}return m.matches}function Wy(t,o,a,d){const m=t.queries.getByIndex(a),v=m.matches;if(null!==v){const D=Bx(t,o,m,a);for(let P=0;P<v.length;P+=2){const V=v[P];if(V>0)d.push(D[P/2]);else{const ne=v[P+1],he=o[-V];for(let Ve=Eo;Ve<he.length;Ve++){const Ct=he[Ve];Ct[aa]===Ct[qi]&&Wy(Ct[rr],Ct,ne,d)}if(null!==he[Ho]){const Ve=he[Ho];for(let Ct=0;Ct<Ve.length;Ct++){const jt=Ve[Ct];Wy(jt[rr],jt,ne,d)}}}}}return d}function Nx(t){const o=Vn(),a=Zi(),d=ka();La(d+1);const m=Hx(a,d);if(t.dirty&&function zs(t){return 4==(4&t[Rr])}(o)===(2==(2&m.metadata.flags))){if(null===m.matches)t.reset([]);else{const v=m.crossesNgTemplate?Wy(a,o,d,[]):Bx(a,o,m,d);t.reset(v,Rp),t.notifyOnChanges()}return!0}return!1}function zx(t,o,a){const d=Zi();d.firstCreatePass&&(jx(d,new Fx(t,o,a),-1),2==(2&o)&&(d.staticViewQueries=!0)),Ux(d,Vn(),o)}function $x(t,o,a,d){const m=Zi();if(m.firstCreatePass){const v=Vs();jx(m,new Fx(o,a,d),v.index),function $E(t,o){const a=t.contentQueries||(t.contentQueries=[]);o!==(a.length?a[a.length-1]:-1)&&a.push(t.queries.length-1,o)}(m,t),2==(2&a)&&(m.staticContentQueries=!0)}Ux(m,Vn(),a)}function Vx(){return function zE(t,o){return t[vs].queries[o].queryList}(Vn(),ka())}function Ux(t,o,a){const d=new Kg(4==(4&a));(function ny(t,o,a,d){const m=_f(o);m.push(a),t.firstCreatePass&&Sg(t).push(d,m.length-1)})(t,o,d,d.destroy),null===o[vs]&&(o[vs]=new jy),o[vs].queries.push(new Uy(d))}function jx(t,o,a){null===t.queries&&(t.queries=new Hy),t.queries.track(new Gy(o,a))}function Hx(t,o){return t.queries.getByIndex(o)}function qy(t){return!!xi(t)}const ab=new To("Application Initializer");let Jy=(()=>{var t;class o{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((d,m)=>{this.resolve=d,this.reject=m}),this.appInits=rt(ab,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const d=[];for(const v of this.appInits){const D=v();if(xy(D))d.push(D);else if(Bv(D)){const P=new Promise((V,ne)=>{D.subscribe({complete:V,error:ne})});d.push(P)}}const m=()=>{this.done=!0,this.resolve()};Promise.all(d).then(()=>{m()}).catch(v=>{this.reject(v)}),0===d.length&&m(),this.initialized=!0}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"root"}),o})(),lb=(()=>{var t;class o{log(d){console.log(d)}warn(d){console.warn(d)}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})();const n_=new To("LocaleId",{providedIn:"root",factory:()=>rt(n_,Tr.Optional|Tr.SkipSelf)||function lD(){return typeof $localize<"u"&&$localize.locale||Pf}()}),cD=new To("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let cb=(()=>{var t;class o{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Lt.X(!1)}add(){this.hasPendingTasks.next(!0);const d=this.taskId++;return this.pendingTasks.add(d),d}remove(d){this.pendingTasks.delete(d),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();class dD{constructor(o,a){this.ngModuleFactory=o,this.componentFactories=a}}let hD=(()=>{var t;class o{compileModuleSync(d){return new Ny(d)}compileModuleAsync(d){return Promise.resolve(this.compileModuleSync(d))}compileModuleAndAllComponentsSync(d){const m=this.compileModuleSync(d),D=Yl(xi(d).declarations).reduce((P,V)=>{const ne=Gr(V);return ne&&P.push(new oh(ne)),P},[]);return new dD(m,D)}compileModuleAndAllComponentsAsync(d){return Promise.resolve(this.compileModuleAndAllComponentsSync(d))}clearCache(){}clearCacheFor(d){}getModuleId(d){}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function fb(...t){}class sl{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:d=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new nu(!1),this.onMicrotaskEmpty=new nu(!1),this.onStable=new nu(!1),this.onError=new nu(!1),typeof Zone>"u")throw new De(908,!1);Zone.assertZonePatched();const m=this;m._nesting=0,m._outer=m._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(m._inner=m._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(m._inner=m._inner.fork(Zone.longStackTraceZoneSpec)),m.shouldCoalesceEventChangeDetection=!d&&a,m.shouldCoalesceRunChangeDetection=d,m.lastRequestAnimationFrameId=-1,m.nativeRequestAnimationFrame=function RD(){const t="function"==typeof Pi.requestAnimationFrame;let o=Pi[t?"requestAnimationFrame":"setTimeout"],a=Pi[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&o&&a){const d=o[Zone.__symbol__("OriginalDelegate")];d&&(o=d);const m=a[Zone.__symbol__("OriginalDelegate")];m&&(a=m)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:a}}().nativeRequestAnimationFrame,function LD(t){const o=()=>{!function kD(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Pi,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,nv(t),t.isCheckStableRunning=!0,tv(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),nv(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,d,m,v,D,P)=>{try{return pb(t),a.invokeTask(m,v,D,P)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===v.type||t.shouldCoalesceRunChangeDetection)&&o(),mb(t)}},onInvoke:(a,d,m,v,D,P,V)=>{try{return pb(t),a.invoke(m,v,D,P,V)}finally{t.shouldCoalesceRunChangeDetection&&o(),mb(t)}},onHasTask:(a,d,m,v)=>{a.hasTask(m,v),d===m&&("microTask"==v.change?(t._hasPendingMicrotasks=v.microTask,nv(t),tv(t)):"macroTask"==v.change&&(t.hasPendingMacrotasks=v.macroTask))},onHandleError:(a,d,m,v)=>(a.handleError(m,v),t.runOutsideAngular(()=>t.onError.emit(v)),!1)})}(m)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!sl.isInAngularZone())throw new De(909,!1)}static assertNotInAngularZone(){if(sl.isInAngularZone())throw new De(909,!1)}run(o,a,d){return this._inner.run(o,a,d)}runTask(o,a,d,m){const v=this._inner,D=v.scheduleEventTask("NgZoneEvent: "+m,o,OD,fb,fb);try{return v.runTask(D,a,d)}finally{v.cancelTask(D)}}runGuarded(o,a,d){return this._inner.runGuarded(o,a,d)}runOutsideAngular(o){return this._outer.run(o)}}const OD={};function tv(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function nv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function pb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function mb(t){t._nesting--,tv(t)}class FD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new nu,this.onMicrotaskEmpty=new nu,this.onStable=new nu,this.onError=new nu}run(o,a,d){return o.apply(a,d)}runGuarded(o,a,d){return o.apply(a,d)}runOutsideAngular(o){return o()}runTask(o,a,d,m){return o.apply(a,d)}}const gb=new To("",{providedIn:"root",factory:_b});function _b(){const t=rt(sl);let o=!0;const a=new l.y(m=>{o=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{m.next(o),m.complete()})}),d=new l.y(m=>{let v;t.runOutsideAngular(()=>{v=t.onStable.subscribe(()=>{sl.assertNotInAngularZone(),queueMicrotask(()=>{!o&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(o=!0,m.next(!0))})})});const D=t.onUnstable.subscribe(()=>{sl.assertInAngularZone(),o&&(o=!1,t.runOutsideAngular(()=>{m.next(!1)}))});return()=>{v.unsubscribe(),D.unsubscribe()}});return(0,Ee.T)(a,d.pipe(tt()))}const yb=new To(""),vb=new To("");let rv,BD=(()=>{var t;class o{constructor(d,m,v){this._ngZone=d,this.registry=m,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,rv||(function ND(t){rv=t}(v),v.addToWindow(m)),this._watchAngularEvents(),d.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{sl.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let d=this._callbacks.pop();clearTimeout(d.timeoutId),d.doneCb(this._didWork)}this._didWork=!1});else{let d=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(d)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(d=>({source:d.source,creationLocation:d.creationLocation,data:d.data})):[]}addCallback(d,m,v){let D=-1;m&&m>0&&(D=setTimeout(()=>{this._callbacks=this._callbacks.filter(P=>P.timeoutId!==D),d(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:d,timeoutId:D,updateCb:v})}whenStable(d,m,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(d,m,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(d){this.registry.registerApplication(d,this)}unregisterApplication(d){this.registry.unregisterApplication(d)}findProviders(d,m,v){return[]}}return(t=o).\u0275fac=function(d){return new(d||t)(Qr(sl),Qr(xb),Qr(vb))},t.\u0275prov=Wn({token:t,factory:t.\u0275fac}),o})(),xb=(()=>{var t;class o{constructor(){this._applications=new Map}registerApplication(d,m){this._applications.set(d,m)}unregisterApplication(d){this._applications.delete(d)}unregisterAllApplications(){this._applications.clear()}getTestability(d){return this._applications.get(d)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(d,m=!0){return rv?.findTestabilityInTree(this,d,m)??null}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})(),_d=null;const bb=new To("AllowMultipleToken"),iv=new To("PlatformDestroyListeners"),ov=new To("appBootstrapListener");class VD{constructor(o,a){this.name=o,this.token=a}}function Db(t,o,a=[]){const d=`Platform: ${o}`,m=new To(d);return(v=[])=>{let D=sv();if(!D||D.injector.get(bb,!1)){const P=[...a,...v,{provide:m,useValue:!0}];t?t(P):function UD(t){if(_d&&!_d.get(bb,!1))throw new De(400,!1);(function wb(){!function es(t){pi=t}(()=>{throw new De(600,!1)})})(),_d=t;const o=t.get(Tb);(function Eb(t){t.get(Dp,null)?.forEach(a=>a())})(t)}(function Cb(t=[],o){return ml.create({name:o,providers:[{provide:wp,useValue:"platform"},{provide:iv,useValue:new Set([()=>_d=null])},...t]})}(P,d))}return function HD(t){const o=sv();if(!o)throw new De(401,!1);return o}()}}function sv(){return _d?.get(Tb)??null}let Tb=(()=>{var t;class o{constructor(d){this._injector=d,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(d,m){const v=function GD(t="zone.js",o){return"noop"===t?new FD:"zone.js"===t?new sl(o):t}(m?.ngZone,function Sb(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:m?.ngZoneEventCoalescing,runCoalescing:m?.ngZoneRunCoalescing}));return v.run(()=>{const D=function Ww(t,o,a){return new By(t,o,a)}(d.moduleType,this.injector,function Rb(t){return[{provide:sl,useFactory:t},{provide:kc,multi:!0,useFactory:()=>{const o=rt(qD,{optional:!0});return()=>o.initialize()}},{provide:Pb,useFactory:WD},{provide:gb,useFactory:_b}]}(()=>v)),P=D.injector.get(sd,null);return v.runOutsideAngular(()=>{const V=v.onError.subscribe({next:ne=>{P.handleError(ne)}});D.onDestroy(()=>{i_(this._modules,D),V.unsubscribe()})}),function Ib(t,o,a){try{const d=a();return xy(d)?d.catch(m=>{throw o.runOutsideAngular(()=>t.handleError(m)),m}):d}catch(d){throw o.runOutsideAngular(()=>t.handleError(d)),d}}(P,v,()=>{const V=D.injector.get(Jy);return V.runInitializers(),V.donePromise.then(()=>(function z0(t){qt(t,"Expected localeId to be defined"),"string"==typeof t&&(N0=t.toLowerCase().replace(/_/g,"-"))}(D.injector.get(n_,Pf)||Pf),this._moduleDoBootstrap(D),D))})})}bootstrapModule(d,m=[]){const v=Mb({},m);return function zD(t,o,a){const d=new Ny(a);return Promise.resolve(d)}(0,0,d).then(D=>this.bootstrapModuleFactory(D,v))}_moduleDoBootstrap(d){const m=d.injector.get(kf);if(d._bootstrapComponents.length>0)d._bootstrapComponents.forEach(v=>m.bootstrap(v));else{if(!d.instance.ngDoBootstrap)throw new De(-403,!1);d.instance.ngDoBootstrap(m)}this._modules.push(d)}onDestroy(d){this._destroyListeners.push(d)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new De(404,!1);this._modules.slice().forEach(m=>m.destroy()),this._destroyListeners.forEach(m=>m());const d=this._injector.get(iv,null);d&&(d.forEach(m=>m()),d.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(t=o).\u0275fac=function(d){return new(d||t)(Qr(ml))},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})();function Mb(t,o){return Array.isArray(o)?o.reduce(Mb,t):{...t,...o}}let kf=(()=>{var t;class o{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=rt(Pb),this.zoneIsStable=rt(gb),this.componentTypes=[],this.components=[],this.isStable=rt(cb).hasPendingTasks.pipe((0,wt.w)(d=>d?(0,ot.of)(!1):this.zoneIsStable),(0,ht.x)(),tt()),this._injector=rt(Wa)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(d,m){const v=d instanceof Pp;if(!this._injector.get(Jy).done)throw!v&&gs(d),new De(405,!1);let P;P=v?d:this._injector.get(qd).resolveComponentFactory(d),this.componentTypes.push(P.componentType);const V=function $D(t){return t.isBoundToModule}(P)?void 0:this._injector.get(uh),he=P.create(ml.NULL,[],m||P.selector,V),Ve=he.location.nativeElement,Ct=he.injector.get(yb,null);return Ct?.registerApplication(Ve),he.onDestroy(()=>{this.detachView(he.hostView),i_(this.components,he),Ct?.unregisterApplication(Ve)}),this._loadComponent(he),he}tick(){if(this._runningTick)throw new De(101,!1);try{this._runningTick=!0;for(let d of this._views)d.detectChanges()}catch(d){this.internalErrorHandler(d)}finally{this._runningTick=!1}}attachView(d){const m=d;this._views.push(m),m.attachToAppRef(this)}detachView(d){const m=d;i_(this._views,m),m.detachFromAppRef()}_loadComponent(d){this.attachView(d.hostView),this.tick(),this.components.push(d);const m=this._injector.get(ov,[]);m.push(...this._bootstrapListeners),m.forEach(v=>v(d))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(d=>d()),this._views.slice().forEach(d=>d.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(d){return this._destroyListeners.push(d),()=>i_(this._destroyListeners,d)}destroy(){if(this._destroyed)throw new De(406,!1);const d=this._injector;d.destroy&&!d.destroyed&&d.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function i_(t,o){const a=t.indexOf(o);a>-1&&t.splice(a,1)}const Pb=new To("",{providedIn:"root",factory:()=>rt(sd).handleError.bind(void 0)});function WD(){const t=rt(sl),o=rt(sd);return a=>t.runOutsideAngular(()=>o.handleError(a))}let qD=(()=>{var t;class o{constructor(){this.zone=rt(sl),this.applicationRef=rt(kf)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=Wn({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function ZD(){}let XD=(()=>{class o{}return o.__NG_ELEMENT_ID__=KD,o})();function KD(t){return function JD(t,o,a){if(ds(t)&&!a){const d=Yi(t.index,o);return new pd(d,d)}return 47&t.type?new pd(o[Ni],o):null}(Vs(),Vn(),16==(16&t))}class Fb{constructor(){}supports(o){return U(o)}create(o){return new iC(o)}}const rC=(t,o)=>o;class iC{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||rC}forEachItem(o){let a;for(a=this._itHead;null!==a;a=a._next)o(a)}forEachOperation(o){let a=this._itHead,d=this._removalsHead,m=0,v=null;for(;a||d;){const D=!d||a&&a.currentIndex<Nb(d,m,v)?a:d,P=Nb(D,m,v),V=D.currentIndex;if(D===d)m--,d=d._nextRemoved;else if(a=a._next,null==D.previousIndex)m++;else{v||(v=[]);const ne=P-m,he=V-m;if(ne!=he){for(let Ct=0;Ct<ne;Ct++){const jt=Ct<v.length?v[Ct]:v[Ct]=0,On=jt+Ct;he<=On&&On<ne&&(v[Ct]=jt+1)}v[D.previousIndex]=he-ne}}P!==V&&o(D,P,V)}}forEachPreviousItem(o){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachMovedItem(o){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}forEachIdentityChange(o){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)o(a)}diff(o){if(null==o&&(o=[]),!U(o))throw new De(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let m,v,D,a=this._itHead,d=!1;if(Array.isArray(o)){this.length=o.length;for(let P=0;P<this.length;P++)v=o[P],D=this._trackByFn(P,v),null!==a&&Object.is(a.trackById,D)?(d&&(a=this._verifyReinsertion(a,v,D,P)),Object.is(a.item,v)||this._addIdentityChange(a,v)):(a=this._mismatch(a,v,D,P),d=!0),a=a._next}else m=0,function J(t,o){if(Array.isArray(t))for(let a=0;a<t.length;a++)o(t[a]);else{const a=t[Symbol.iterator]();let d;for(;!(d=a.next()).done;)o(d.value)}}(o,P=>{D=this._trackByFn(m,P),null!==a&&Object.is(a.trackById,D)?(d&&(a=this._verifyReinsertion(a,P,D,m)),Object.is(a.item,P)||this._addIdentityChange(a,P)):(a=this._mismatch(a,P,D,m),d=!0),a=a._next,m++}),this.length=m;return this._truncate(a),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,a,d,m){let v;return null===o?v=this._itTail:(v=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._reinsertAfter(o,v,m)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(d,m))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._moveAfter(o,v,m)):o=this._addAfter(new oC(a,d),v,m),o}_verifyReinsertion(o,a,d,m){let v=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null);return null!==v?o=this._reinsertAfter(v,o._prev,m):o.currentIndex!=m&&(o.currentIndex=m,this._addToMoves(o,m)),o}_truncate(o){for(;null!==o;){const a=o._next;this._addToRemovals(this._unlink(o)),o=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,a,d){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const m=o._prevRemoved,v=o._nextRemoved;return null===m?this._removalsHead=v:m._nextRemoved=v,null===v?this._removalsTail=m:v._prevRemoved=m,this._insertAfter(o,a,d),this._addToMoves(o,d),o}_moveAfter(o,a,d){return this._unlink(o),this._insertAfter(o,a,d),this._addToMoves(o,d),o}_addAfter(o,a,d){return this._insertAfter(o,a,d),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,a,d){const m=null===a?this._itHead:a._next;return o._next=m,o._prev=a,null===m?this._itTail=o:m._prev=o,null===a?this._itHead=o:a._next=o,null===this._linkedRecords&&(this._linkedRecords=new Bb),this._linkedRecords.put(o),o.currentIndex=d,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const a=o._prev,d=o._next;return null===a?this._itHead=d:a._next=d,null===d?this._itTail=a:d._prev=a,o}_addToMoves(o,a){return o.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Bb),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,a){return o.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class oC{constructor(o,a){this.item=o,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class sC{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,a){let d;for(d=this._head;null!==d;d=d._nextDup)if((null===a||a<=d.currentIndex)&&Object.is(d.trackById,o))return d;return null}remove(o){const a=o._prevDup,d=o._nextDup;return null===a?this._head=d:a._nextDup=d,null===d?this._tail=a:d._prevDup=a,null===this._head}}class Bb{constructor(){this.map=new Map}put(o){const a=o.trackById;let d=this.map.get(a);d||(d=new sC,this.map.set(a,d)),d.add(o)}get(o,a){const m=this.map.get(o);return m?m.get(o,a):null}remove(o){const a=o.trackById;return this.map.get(a).remove(o)&&this.map.delete(a),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Nb(t,o,a){const d=t.previousIndex;if(null===d)return d;let m=0;return a&&d<a.length&&(m=a[d]),d+o+m}class zb{constructor(){}supports(o){return o instanceof Map||se(o)}create(){return new aC}}class aC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let a;for(a=this._mapHead;null!==a;a=a._next)o(a)}forEachPreviousItem(o){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)o(a)}forEachChangedItem(o){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}diff(o){if(o){if(!(o instanceof Map||se(o)))throw new De(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(o,(d,m)=>{if(a&&a.key===m)this._maybeAddToChanges(a,d),this._appendAfter=a,a=a._next;else{const v=this._getOrCreateRecordForKey(m,d);a=this._insertBeforeOrAppend(a,v)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let d=a;null!==d;d=d._nextRemoved)d===this._mapHead&&(this._mapHead=null),this._records.delete(d.key),d._nextRemoved=d._next,d.previousValue=d.currentValue,d.currentValue=null,d._prev=null,d._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,a){if(o){const d=o._prev;return a._next=o,a._prev=d,o._prev=a,d&&(d._next=a),o===this._mapHead&&(this._mapHead=a),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(o,a){if(this._records.has(o)){const m=this._records.get(o);this._maybeAddToChanges(m,a);const v=m._prev,D=m._next;return v&&(v._next=D),D&&(D._prev=v),m._next=null,m._prev=null,m}const d=new lC(o);return this._records.set(o,d),d.currentValue=a,this._addToAdditions(d),d}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,a){Object.is(a,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=a,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,a){o instanceof Map?o.forEach(a):Object.keys(o).forEach(d=>a(o[d],d))}}class lC{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function $b(){return new dv([new Fb])}let dv=(()=>{var t;class o{constructor(d){this.factories=d}static create(d,m){if(null!=m){const v=m.factories.slice();d=d.concat(v)}return new o(d)}static extend(d){return{provide:o,useFactory:m=>o.create(d,m||$b()),deps:[[o,new Tl,new as]]}}find(d){const m=this.factories.find(v=>v.supports(d));if(null!=m)return m;throw new De(901,!1)}}return(t=o).\u0275prov=Wn({token:t,providedIn:"root",factory:$b}),o})();function Vb(){return new hv([new zb])}let hv=(()=>{var t;class o{constructor(d){this.factories=d}static create(d,m){if(m){const v=m.factories.slice();d=d.concat(v)}return new o(d)}static extend(d){return{provide:o,useFactory:m=>o.create(d,m||Vb()),deps:[[o,new Tl,new as]]}}find(d){const m=this.factories.find(v=>v.supports(d));if(m)return m;throw new De(901,!1)}}return(t=o).\u0275prov=Wn({token:t,providedIn:"root",factory:Vb}),o})();const dC=Db(null,"core",[]);let hC=(()=>{var t;class o{constructor(d){}}return(t=o).\u0275fac=function(d){return new(d||t)(Qr(kf))},t.\u0275mod=Io({type:t}),t.\u0275inj=er({}),o})();function EC(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function CC(t,o){const a=Gr(t),d=o.elementInjector||ua();return new oh(a).create(d,o.projectableNodes,o.hostElement,o.environmentInjector)}function TC(t){const o=Gr(t);if(!o)return null;const a=new oh(o);return{get selector(){return a.selector},get type(){return a.componentType},get inputs(){return a.inputs},get outputs(){return a.outputs},get ngContentSelectors(){return a.ngContentSelectors},get isStandalone(){return o.standalone},get isSignal(){return o.signals}}}},95:(fr,en,oe)=>{"use strict";oe.d(en,{sg:()=>vo,u5:()=>Hi,JU:()=>xt,a5:()=>vi,JJ:()=>Ir,F:()=>Oe,On:()=>Zo,kI:()=>Nt});var T=oe(9468),b=oe(6814),Lt=oe(7715),l=oe(5592),Ee=oe(7453),ot=oe(4829),qe=oe(9940),Et=oe(8251),vt=oe(7400),tt=oe(2714),wt=oe(7398);let ht=(()=>{var Q;class Z{constructor(te,Fe){this._renderer=te,this._elementRef=Fe,this.onChange=Zn=>{},this.onTouched=()=>{}}setProperty(te,Fe){this._renderer.setProperty(this._elementRef.nativeElement,te,Fe)}registerOnTouched(te){this.onTouched=te}registerOnChange(te){this.onChange=te}setDisabledState(te){this.setProperty("disabled",te)}}return(Q=Z).\u0275fac=function(te){return new(te||Q)(T.Y36(T.Qsj),T.Y36(T.SBq))},Q.\u0275dir=T.lG2({type:Q}),Z})(),et=(()=>{var Q;class Z extends ht{}return(Q=Z).\u0275fac=function(){let ge;return function(Fe){return(ge||(ge=T.n5z(Q)))(Fe||Q)}}(),Q.\u0275dir=T.lG2({type:Q,features:[T.qOj]}),Z})();const xt=new T.OlP("NgValueAccessor"),st={provide:xt,useExisting:(0,T.Gpc)(()=>Ge),multi:!0},Tt=new T.OlP("CompositionEventMode");let Ge=(()=>{var Q;class Z extends ht{constructor(te,Fe,Zn){super(te,Fe),this._compositionMode=Zn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function sn(){const Q=(0,b.q)()?(0,b.q)().getUserAgent():"";return/android (\d+)/.test(Q.toLowerCase())}())}writeValue(te){this.setProperty("value",te??"")}_handleInput(te){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(te)}_compositionStart(){this._composing=!0}_compositionEnd(te){this._composing=!1,this._compositionMode&&this.onChange(te)}}return(Q=Z).\u0275fac=function(te){return new(te||Q)(T.Y36(T.Qsj),T.Y36(T.SBq),T.Y36(Tt,8))},Q.\u0275dir=T.lG2({type:Q,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(te,Fe){1&te&&T.NdJ("input",function(Xr){return Fe._handleInput(Xr.target.value)})("blur",function(){return Fe.onTouched()})("compositionstart",function(){return Fe._compositionStart()})("compositionend",function(Xr){return Fe._compositionEnd(Xr.target.value)})},features:[T._Bn([st]),T.qOj]}),Z})();function Le(Q){return null==Q||("string"==typeof Q||Array.isArray(Q))&&0===Q.length}function Yt(Q){return null!=Q&&"number"==typeof Q.length}const _n=new T.OlP("NgValidators"),De=new T.OlP("NgAsyncValidators"),ft=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Nt{static min(Z){return function yt(Q){return Z=>{if(Le(Z.value)||Le(Q))return null;const ge=parseFloat(Z.value);return!isNaN(ge)&&ge<Q?{min:{min:Q,actual:Z.value}}:null}}(Z)}static max(Z){return function mn(Q){return Z=>{if(Le(Z.value)||Le(Q))return null;const ge=parseFloat(Z.value);return!isNaN(ge)&&ge>Q?{max:{max:Q,actual:Z.value}}:null}}(Z)}static required(Z){return function hn(Q){return Le(Q.value)?{required:!0}:null}(Z)}static requiredTrue(Z){return function Gt(Q){return!0===Q.value?null:{required:!0}}(Z)}static email(Z){return function nr(Q){return Le(Q.value)||ft.test(Q.value)?null:{email:!0}}(Z)}static minLength(Z){return function Wt(Q){return Z=>Le(Z.value)||!Yt(Z.value)?null:Z.value.length<Q?{minlength:{requiredLength:Q,actualLength:Z.value.length}}:null}(Z)}static maxLength(Z){return function pr(Q){return Z=>Yt(Z.value)&&Z.value.length>Q?{maxlength:{requiredLength:Q,actualLength:Z.value.length}}:null}(Z)}static pattern(Z){return function an(Q){if(!Q)return Me;let Z,ge;return"string"==typeof Q?(ge="","^"!==Q.charAt(0)&&(ge+="^"),ge+=Q,"$"!==Q.charAt(Q.length-1)&&(ge+="$"),Z=new RegExp(ge)):(ge=Q.toString(),Z=Q),te=>{if(Le(te.value))return null;const Fe=te.value;return Z.test(Fe)?null:{pattern:{requiredPattern:ge,actualValue:Fe}}}}(Z)}static nullValidator(Z){return null}static compose(Z){return ur(Z)}static composeAsync(Z){return Ot(Z)}}function Me(Q){return null}function Ue(Q){return null!=Q}function at(Q){return(0,T.QGY)(Q)?(0,Lt.D)(Q):Q}function Rt(Q){let Z={};return Q.forEach(ge=>{Z=null!=ge?{...Z,...ge}:Z}),0===Object.keys(Z).length?null:Z}function cn(Q,Z){return Z.map(ge=>ge(Q))}function Qn(Q){return Q.map(Z=>function un(Q){return!Q.validate}(Z)?Z:ge=>Z.validate(ge))}function ur(Q){if(!Q)return null;const Z=Q.filter(Ue);return 0==Z.length?null:function(ge){return Rt(cn(ge,Z))}}function Mn(Q){return null!=Q?ur(Qn(Q)):null}function Ot(Q){if(!Q)return null;const Z=Q.filter(Ue);return 0==Z.length?null:function(ge){return function nt(...Q){const Z=(0,qe.jO)(Q),{args:ge,keys:te}=(0,Ee.D)(Q),Fe=new l.y(Zn=>{const{length:Xr}=ge;if(!Xr)return void Zn.complete();const qo=new Array(Xr);let hs=Xr,ws=Xr;for(let Gs=0;Gs<Xr;Gs++){let Aa=!1;(0,ot.Xf)(ge[Gs]).subscribe((0,Et.x)(Zn,Ea=>{Aa||(Aa=!0,ws--),qo[Gs]=Ea},()=>hs--,void 0,()=>{(!hs||!Aa)&&(ws||Zn.next(te?(0,tt.n)(te,qo):qo),Zn.complete())}))}});return Z?Fe.pipe((0,vt.Z)(Z)):Fe}(cn(ge,Z).map(at)).pipe((0,wt.U)(Rt))}}function qt(Q){return null!=Q?Ot(Qn(Q)):null}function $t(Q,Z){return null===Q?[Z]:Array.isArray(Q)?[...Q,Z]:[Q,Z]}function vn(Q){return Q._rawValidators}function Gn(Q){return Q._rawAsyncValidators}function Cr(Q){return Q?Array.isArray(Q)?Q:[Q]:[]}function Wn(Q,Z){return Array.isArray(Q)?Q.includes(Z):Q===Z}function Dr(Q,Z){const ge=Cr(Z);return Cr(Q).forEach(Fe=>{Wn(ge,Fe)||ge.push(Fe)}),ge}function er(Q,Z){return Cr(Z).filter(ge=>!Wn(Q,ge))}class kr{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(Z){this._rawValidators=Z||[],this._composedValidatorFn=Mn(this._rawValidators)}_setAsyncValidators(Z){this._rawAsyncValidators=Z||[],this._composedAsyncValidatorFn=qt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(Z){this._onDestroyCallbacks.push(Z)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(Z=>Z()),this._onDestroyCallbacks=[]}reset(Z=void 0){this.control&&this.control.reset(Z)}hasError(Z,ge){return!!this.control&&this.control.hasError(Z,ge)}getError(Z,ge){return this.control?this.control.getError(Z,ge):null}}class An extends kr{get formDirective(){return null}get path(){return null}}class vi extends kr{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class to{constructor(Z){this._cd=Z}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Ir=(()=>{var Q;class Z extends to{constructor(te){super(te)}}return(Q=Z).\u0275fac=function(te){return new(te||Q)(T.Y36(vi,2))},Q.\u0275dir=T.lG2({type:Q,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(te,Fe){2&te&&T.ekj("ng-untouched",Fe.isUntouched)("ng-touched",Fe.isTouched)("ng-pristine",Fe.isPristine)("ng-dirty",Fe.isDirty)("ng-valid",Fe.isValid)("ng-invalid",Fe.isInvalid)("ng-pending",Fe.isPending)},features:[T.qOj]}),Z})();const St="VALID",lt="INVALID",Vt="PENDING",En="DISABLED";function Ln(Q){return(He(Q)?Q.validators:Q)||null}function Ze(Q,Z){return(He(Z)?Z.asyncValidators:Q)||null}function He(Q){return null!=Q&&!Array.isArray(Q)&&"object"==typeof Q}class qn{constructor(Z,ge){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(Z),this._assignAsyncValidators(ge)}get validator(){return this._composedValidatorFn}set validator(Z){this._rawValidators=this._composedValidatorFn=Z}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(Z){this._rawAsyncValidators=this._composedAsyncValidatorFn=Z}get parent(){return this._parent}get valid(){return this.status===St}get invalid(){return this.status===lt}get pending(){return this.status==Vt}get disabled(){return this.status===En}get enabled(){return this.status!==En}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(Z){this._assignValidators(Z)}setAsyncValidators(Z){this._assignAsyncValidators(Z)}addValidators(Z){this.setValidators(Dr(Z,this._rawValidators))}addAsyncValidators(Z){this.setAsyncValidators(Dr(Z,this._rawAsyncValidators))}removeValidators(Z){this.setValidators(er(Z,this._rawValidators))}removeAsyncValidators(Z){this.setAsyncValidators(er(Z,this._rawAsyncValidators))}hasValidator(Z){return Wn(this._rawValidators,Z)}hasAsyncValidator(Z){return Wn(this._rawAsyncValidators,Z)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(Z={}){this.touched=!0,this._parent&&!Z.onlySelf&&this._parent.markAsTouched(Z)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(Z=>Z.markAllAsTouched())}markAsUntouched(Z={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(ge=>{ge.markAsUntouched({onlySelf:!0})}),this._parent&&!Z.onlySelf&&this._parent._updateTouched(Z)}markAsDirty(Z={}){this.pristine=!1,this._parent&&!Z.onlySelf&&this._parent.markAsDirty(Z)}markAsPristine(Z={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(ge=>{ge.markAsPristine({onlySelf:!0})}),this._parent&&!Z.onlySelf&&this._parent._updatePristine(Z)}markAsPending(Z={}){this.status=Vt,!1!==Z.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!Z.onlySelf&&this._parent.markAsPending(Z)}disable(Z={}){const ge=this._parentMarkedDirty(Z.onlySelf);this.status=En,this.errors=null,this._forEachChild(te=>{te.disable({...Z,onlySelf:!0})}),this._updateValue(),!1!==Z.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...Z,skipPristineCheck:ge}),this._onDisabledChange.forEach(te=>te(!0))}enable(Z={}){const ge=this._parentMarkedDirty(Z.onlySelf);this.status=St,this._forEachChild(te=>{te.enable({...Z,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:Z.emitEvent}),this._updateAncestors({...Z,skipPristineCheck:ge}),this._onDisabledChange.forEach(te=>te(!1))}_updateAncestors(Z){this._parent&&!Z.onlySelf&&(this._parent.updateValueAndValidity(Z),Z.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(Z){this._parent=Z}getRawValue(){return this.value}updateValueAndValidity(Z={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===St||this.status===Vt)&&this._runAsyncValidator(Z.emitEvent)),!1!==Z.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!Z.onlySelf&&this._parent.updateValueAndValidity(Z)}_updateTreeValidity(Z={emitEvent:!0}){this._forEachChild(ge=>ge._updateTreeValidity(Z)),this.updateValueAndValidity({onlySelf:!0,emitEvent:Z.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?En:St}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(Z){if(this.asyncValidator){this.status=Vt,this._hasOwnPendingAsyncValidator=!0;const ge=at(this.asyncValidator(this));this._asyncValidationSubscription=ge.subscribe(te=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(te,{emitEvent:Z})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(Z,ge={}){this.errors=Z,this._updateControlsErrors(!1!==ge.emitEvent)}get(Z){let ge=Z;return null==ge||(Array.isArray(ge)||(ge=ge.split(".")),0===ge.length)?null:ge.reduce((te,Fe)=>te&&te._find(Fe),this)}getError(Z,ge){const te=ge?this.get(ge):this;return te&&te.errors?te.errors[Z]:null}hasError(Z,ge){return!!this.getError(Z,ge)}get root(){let Z=this;for(;Z._parent;)Z=Z._parent;return Z}_updateControlsErrors(Z){this.status=this._calculateStatus(),Z&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(Z)}_initObservables(){this.valueChanges=new T.vpe,this.statusChanges=new T.vpe}_calculateStatus(){return this._allControlsDisabled()?En:this.errors?lt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Vt)?Vt:this._anyControlsHaveStatus(lt)?lt:St}_anyControlsHaveStatus(Z){return this._anyControls(ge=>ge.status===Z)}_anyControlsDirty(){return this._anyControls(Z=>Z.dirty)}_anyControlsTouched(){return this._anyControls(Z=>Z.touched)}_updatePristine(Z={}){this.pristine=!this._anyControlsDirty(),this._parent&&!Z.onlySelf&&this._parent._updatePristine(Z)}_updateTouched(Z={}){this.touched=this._anyControlsTouched(),this._parent&&!Z.onlySelf&&this._parent._updateTouched(Z)}_registerOnCollectionChange(Z){this._onCollectionChange=Z}_setUpdateStrategy(Z){He(Z)&&null!=Z.updateOn&&(this._updateOn=Z.updateOn)}_parentMarkedDirty(Z){return!Z&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(Z){return null}_assignValidators(Z){this._rawValidators=Array.isArray(Z)?Z.slice():Z,this._composedValidatorFn=function Je(Q){return Array.isArray(Q)?Mn(Q):Q||null}(this._rawValidators)}_assignAsyncValidators(Z){this._rawAsyncValidators=Array.isArray(Z)?Z.slice():Z,this._composedAsyncValidatorFn=function Dt(Q){return Array.isArray(Q)?qt(Q):Q||null}(this._rawAsyncValidators)}}class gr extends qn{constructor(Z,ge,te){super(Ln(ge),Ze(te,ge)),this.controls=Z,this._initObservables(),this._setUpdateStrategy(ge),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(Z,ge){return this.controls[Z]?this.controls[Z]:(this.controls[Z]=ge,ge.setParent(this),ge._registerOnCollectionChange(this._onCollectionChange),ge)}addControl(Z,ge,te={}){this.registerControl(Z,ge),this.updateValueAndValidity({emitEvent:te.emitEvent}),this._onCollectionChange()}removeControl(Z,ge={}){this.controls[Z]&&this.controls[Z]._registerOnCollectionChange(()=>{}),delete this.controls[Z],this.updateValueAndValidity({emitEvent:ge.emitEvent}),this._onCollectionChange()}setControl(Z,ge,te={}){this.controls[Z]&&this.controls[Z]._registerOnCollectionChange(()=>{}),delete this.controls[Z],ge&&this.registerControl(Z,ge),this.updateValueAndValidity({emitEvent:te.emitEvent}),this._onCollectionChange()}contains(Z){return this.controls.hasOwnProperty(Z)&&this.controls[Z].enabled}setValue(Z,ge={}){(function dn(Q,Z,ge){Q._forEachChild((te,Fe)=>{if(void 0===ge[Fe])throw new T.vHH(1002,"")})})(this,0,Z),Object.keys(Z).forEach(te=>{(function At(Q,Z,ge){const te=Q.controls;if(!(Z?Object.keys(te):te).length)throw new T.vHH(1e3,"");if(!te[ge])throw new T.vHH(1001,"")})(this,!0,te),this.controls[te].setValue(Z[te],{onlySelf:!0,emitEvent:ge.emitEvent})}),this.updateValueAndValidity(ge)}patchValue(Z,ge={}){null!=Z&&(Object.keys(Z).forEach(te=>{const Fe=this.controls[te];Fe&&Fe.patchValue(Z[te],{onlySelf:!0,emitEvent:ge.emitEvent})}),this.updateValueAndValidity(ge))}reset(Z={},ge={}){this._forEachChild((te,Fe)=>{te.reset(Z[Fe],{onlySelf:!0,emitEvent:ge.emitEvent})}),this._updatePristine(ge),this._updateTouched(ge),this.updateValueAndValidity(ge)}getRawValue(){return this._reduceChildren({},(Z,ge,te)=>(Z[te]=ge.getRawValue(),Z))}_syncPendingControls(){let Z=this._reduceChildren(!1,(ge,te)=>!!te._syncPendingControls()||ge);return Z&&this.updateValueAndValidity({onlySelf:!0}),Z}_forEachChild(Z){Object.keys(this.controls).forEach(ge=>{const te=this.controls[ge];te&&Z(te,ge)})}_setUpControls(){this._forEachChild(Z=>{Z.setParent(this),Z._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(Z){for(const[ge,te]of Object.entries(this.controls))if(this.contains(ge)&&Z(te))return!0;return!1}_reduceValue(){return this._reduceChildren({},(ge,te,Fe)=>((te.enabled||this.disabled)&&(ge[Fe]=te.value),ge))}_reduceChildren(Z,ge){let te=Z;return this._forEachChild((Fe,Zn)=>{te=ge(te,Fe,Zn)}),te}_allControlsDisabled(){for(const Z of Object.keys(this.controls))if(this.controls[Z].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(Z){return this.controls.hasOwnProperty(Z)?this.controls[Z]:null}}const rt=new T.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Ke}),Ke="always";function Xt(Q,Z,ge=Ke){or(Q,Z),Z.valueAccessor.writeValue(Q.value),(Q.disabled||"always"===ge)&&Z.valueAccessor.setDisabledState?.(Q.disabled),function Sr(Q,Z){Z.valueAccessor.registerOnChange(ge=>{Q._pendingValue=ge,Q._pendingChange=!0,Q._pendingDirty=!0,"change"===Q.updateOn&&Yr(Q,Z)})}(Q,Z),function li(Q,Z){const ge=(te,Fe)=>{Z.valueAccessor.writeValue(te),Fe&&Z.viewToModelUpdate(te)};Q.registerOnChange(ge),Z._registerOnDestroy(()=>{Q._unregisterOnChange(ge)})}(Q,Z),function mi(Q,Z){Z.valueAccessor.registerOnTouched(()=>{Q._pendingTouched=!0,"blur"===Q.updateOn&&Q._pendingChange&&Yr(Q,Z),"submit"!==Q.updateOn&&Q.markAsTouched()})}(Q,Z),function br(Q,Z){if(Z.valueAccessor.setDisabledState){const ge=te=>{Z.valueAccessor.setDisabledState(te)};Q.registerOnDisabledChange(ge),Z._registerOnDestroy(()=>{Q._unregisterOnDisabledChange(ge)})}}(Q,Z)}function yn(Q,Z,ge=!0){const te=()=>{};Z.valueAccessor&&(Z.valueAccessor.registerOnChange(te),Z.valueAccessor.registerOnTouched(te)),hi(Q,Z),Q&&(Z._invokeOnDestroyCallbacks(),Q._registerOnCollectionChange(()=>{}))}function zn(Q,Z){Q.forEach(ge=>{ge.registerOnValidatorChange&&ge.registerOnValidatorChange(Z)})}function or(Q,Z){const ge=vn(Q);null!==Z.validator?Q.setValidators($t(ge,Z.validator)):"function"==typeof ge&&Q.setValidators([ge]);const te=Gn(Q);null!==Z.asyncValidator?Q.setAsyncValidators($t(te,Z.asyncValidator)):"function"==typeof te&&Q.setAsyncValidators([te]);const Fe=()=>Q.updateValueAndValidity();zn(Z._rawValidators,Fe),zn(Z._rawAsyncValidators,Fe)}function hi(Q,Z){let ge=!1;if(null!==Q){if(null!==Z.validator){const Fe=vn(Q);if(Array.isArray(Fe)&&Fe.length>0){const Zn=Fe.filter(Xr=>Xr!==Z.validator);Zn.length!==Fe.length&&(ge=!0,Q.setValidators(Zn))}}if(null!==Z.asyncValidator){const Fe=Gn(Q);if(Array.isArray(Fe)&&Fe.length>0){const Zn=Fe.filter(Xr=>Xr!==Z.asyncValidator);Zn.length!==Fe.length&&(ge=!0,Q.setAsyncValidators(Zn))}}}const te=()=>{};return zn(Z._rawValidators,te),zn(Z._rawAsyncValidators,te),ge}function Yr(Q,Z){Q._pendingDirty&&Q.markAsDirty(),Q.setValue(Q._pendingValue,{emitModelToViewChange:!1}),Z.viewToModelUpdate(Q._pendingValue),Q._pendingChange=!1}function bi(Q,Z){or(Q,Z)}function _o(Q,Z){Q._syncPendingControls(),Z.forEach(ge=>{const te=ge.control;"submit"===te.updateOn&&te._pendingChange&&(ge.viewToModelUpdate(te._pendingValue),te._pendingChange=!1)})}const Br={provide:An,useExisting:(0,T.Gpc)(()=>Oe)},le=(()=>Promise.resolve())();let Oe=(()=>{var Q;class Z extends An{constructor(te,Fe,Zn){super(),this.callSetDisabledState=Zn,this.submitted=!1,this._directives=new Set,this.ngSubmit=new T.vpe,this.form=new gr({},Mn(te),qt(Fe))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(te){le.then(()=>{const Fe=this._findContainer(te.path);te.control=Fe.registerControl(te.name,te.control),Xt(te.control,te,this.callSetDisabledState),te.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(te)})}getControl(te){return this.form.get(te.path)}removeControl(te){le.then(()=>{const Fe=this._findContainer(te.path);Fe&&Fe.removeControl(te.name),this._directives.delete(te)})}addFormGroup(te){le.then(()=>{const Fe=this._findContainer(te.path),Zn=new gr({});bi(Zn,te),Fe.registerControl(te.name,Zn),Zn.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(te){le.then(()=>{const Fe=this._findContainer(te.path);Fe&&Fe.removeControl(te.name)})}getFormGroup(te){return this.form.get(te.path)}updateModel(te,Fe){le.then(()=>{this.form.get(te.path).setValue(Fe)})}setValue(te){this.control.setValue(te)}onSubmit(te){return this.submitted=!0,_o(this.form,this._directives),this.ngSubmit.emit(te),"dialog"===te?.target?.method}onReset(){this.resetForm()}resetForm(te=void 0){this.form.reset(te),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(te){return te.pop(),te.length?this.form.get(te):this.form}}return(Q=Z).\u0275fac=function(te){return new(te||Q)(T.Y36(_n,10),T.Y36(De,10),T.Y36(rt,8))},Q.\u0275dir=T.lG2({type:Q,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(te,Fe){1&te&&T.NdJ("submit",function(Xr){return Fe.onSubmit(Xr)})("reset",function(){return Fe.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[T._Bn([Br]),T.qOj]}),Z})();function pe(Q,Z){const ge=Q.indexOf(Z);ge>-1&&Q.splice(ge,1)}function Se(Q){return"object"==typeof Q&&null!==Q&&2===Object.keys(Q).length&&"value"in Q&&"disabled"in Q}const bt=class extends qn{constructor(Z=null,ge,te){super(Ln(ge),Ze(te,ge)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(Z),this._setUpdateStrategy(ge),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),He(ge)&&(ge.nonNullable||ge.initialValueIsDefault)&&(this.defaultValue=Se(Z)?Z.value:Z)}setValue(Z,ge={}){this.value=this._pendingValue=Z,this._onChange.length&&!1!==ge.emitModelToViewChange&&this._onChange.forEach(te=>te(this.value,!1!==ge.emitViewToModelChange)),this.updateValueAndValidity(ge)}patchValue(Z,ge={}){this.setValue(Z,ge)}reset(Z=this.defaultValue,ge={}){this._applyFormState(Z),this.markAsPristine(ge),this.markAsUntouched(ge),this.setValue(this.value,ge),this._pendingChange=!1}_updateValue(){}_anyControls(Z){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(Z){this._onChange.push(Z)}_unregisterOnChange(Z){pe(this._onChange,Z)}registerOnDisabledChange(Z){this._onDisabledChange.push(Z)}_unregisterOnDisabledChange(Z){pe(this._onDisabledChange,Z)}_forEachChild(Z){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(Z){Se(Z)?(this.value=this._pendingValue=Z.value,Z.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=Z}},zo={provide:vi,useExisting:(0,T.Gpc)(()=>Zo)},Ki=(()=>Promise.resolve())();let Zo=(()=>{var Q;class Z extends vi{constructor(te,Fe,Zn,Xr,qo,hs){super(),this._changeDetectorRef=qo,this.callSetDisabledState=hs,this.control=new bt,this._registered=!1,this.name="",this.update=new T.vpe,this._parent=te,this._setValidators(Fe),this._setAsyncValidators(Zn),this.valueAccessor=function so(Q,Z){if(!Z)return null;let ge,te,Fe;return Array.isArray(Z),Z.forEach(Zn=>{Zn.constructor===Ge?ge=Zn:function Ui(Q){return Object.getPrototypeOf(Q.constructor)===et}(Zn)?te=Zn:Fe=Zn}),Fe||te||ge||null}(0,Xr)}ngOnChanges(te){if(this._checkForErrors(),!this._registered||"name"in te){if(this._registered&&(this._checkName(),this.formDirective)){const Fe=te.name.previousValue;this.formDirective.removeControl({name:Fe,path:this._getPath(Fe)})}this._setUpControl()}"isDisabled"in te&&this._updateDisabled(te),function Vi(Q,Z){if(!Q.hasOwnProperty("model"))return!1;const ge=Q.model;return!!ge.isFirstChange()||!Object.is(Z,ge.currentValue)}(te,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(te){this.viewModel=te,this.update.emit(te)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Xt(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(te){Ki.then(()=>{this.control.setValue(te,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(te){const Fe=te.isDisabled.currentValue,Zn=0!==Fe&&(0,T.VuI)(Fe);Ki.then(()=>{Zn&&!this.control.disabled?this.control.disable():!Zn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(te){return this._parent?function tn(Q,Z){return[...Z.path,Q]}(te,this._parent):[te]}}return(Q=Z).\u0275fac=function(te){return new(te||Q)(T.Y36(An,9),T.Y36(_n,10),T.Y36(De,10),T.Y36(xt,10),T.Y36(T.sBO,8),T.Y36(rt,8))},Q.\u0275dir=T.lG2({type:Q,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[T._Bn([zo]),T.qOj,T.TTD]}),Z})(),sa=(()=>{var Q;class Z{}return(Q=Z).\u0275fac=function(te){return new(te||Q)},Q.\u0275mod=T.oAB({type:Q}),Q.\u0275inj=T.cJS({}),Z})();const Is={provide:An,useExisting:(0,T.Gpc)(()=>vo)};let vo=(()=>{var Q;class Z extends An{constructor(te,Fe,Zn){super(),this.callSetDisabledState=Zn,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new T.vpe,this._setValidators(te),this._setAsyncValidators(Fe)}ngOnChanges(te){this._checkFormPresent(),te.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(hi(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(te){const Fe=this.form.get(te.path);return Xt(Fe,te,this.callSetDisabledState),Fe.updateValueAndValidity({emitEvent:!1}),this.directives.push(te),Fe}getControl(te){return this.form.get(te.path)}removeControl(te){yn(te.control||null,te,!1),function yo(Q,Z){const ge=Q.indexOf(Z);ge>-1&&Q.splice(ge,1)}(this.directives,te)}addFormGroup(te){this._setUpFormContainer(te)}removeFormGroup(te){this._cleanUpFormContainer(te)}getFormGroup(te){return this.form.get(te.path)}addFormArray(te){this._setUpFormContainer(te)}removeFormArray(te){this._cleanUpFormContainer(te)}getFormArray(te){return this.form.get(te.path)}updateModel(te,Fe){this.form.get(te.path).setValue(Fe)}onSubmit(te){return this.submitted=!0,_o(this.form,this.directives),this.ngSubmit.emit(te),"dialog"===te?.target?.method}onReset(){this.resetForm()}resetForm(te=void 0){this.form.reset(te),this.submitted=!1}_updateDomValue(){this.directives.forEach(te=>{const Fe=te.control,Zn=this.form.get(te.path);Fe!==Zn&&(yn(Fe||null,te),(Q=>Q instanceof bt)(Zn)&&(Xt(Zn,te,this.callSetDisabledState),te.control=Zn))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(te){const Fe=this.form.get(te.path);bi(Fe,te),Fe.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(te){if(this.form){const Fe=this.form.get(te.path);Fe&&function Ur(Q,Z){return hi(Q,Z)}(Fe,te)&&Fe.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){or(this.form,this),this._oldForm&&hi(this._oldForm,this)}_checkFormPresent(){}}return(Q=Z).\u0275fac=function(te){return new(te||Q)(T.Y36(_n,10),T.Y36(De,10),T.Y36(rt,8))},Q.\u0275dir=T.lG2({type:Q,selectors:[["","formGroup",""]],hostBindings:function(te,Fe){1&te&&T.NdJ("submit",function(Xr){return Fe.onSubmit(Xr)})("reset",function(){return Fe.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[T._Bn([Is]),T.qOj,T.TTD]}),Z})(),bs=(()=>{var Q;class Z{}return(Q=Z).\u0275fac=function(te){return new(te||Q)},Q.\u0275mod=T.oAB({type:Q}),Q.\u0275inj=T.cJS({imports:[sa]}),Z})(),Hi=(()=>{var Q;class Z{static withConfig(te){return{ngModule:Z,providers:[{provide:rt,useValue:te.callSetDisabledState??Ke}]}}}return(Q=Z).\u0275fac=function(te){return new(te||Q)},Q.\u0275mod=T.oAB({type:Q}),Q.\u0275inj=T.cJS({imports:[bs]}),Z})()},6593:(fr,en,oe)=>{"use strict";oe.d(en,{Dx:()=>vi,b2:()=>Wn,q6:()=>$t,se:()=>ft});var T=oe(9468),b=oe(6814);class Lt extends b.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class l extends Lt{static makeCurrent(){(0,b.HT)(new l)}onAndCancel(Ze,Dt,He){return Ze.addEventListener(Dt,He),()=>{Ze.removeEventListener(Dt,He)}}dispatchEvent(Ze,Dt){Ze.dispatchEvent(Dt)}remove(Ze){Ze.parentNode&&Ze.parentNode.removeChild(Ze)}createElement(Ze,Dt){return(Dt=Dt||this.getDefaultDocument()).createElement(Ze)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Ze){return Ze.nodeType===Node.ELEMENT_NODE}isShadowRoot(Ze){return Ze instanceof DocumentFragment}getGlobalEventTarget(Ze,Dt){return"window"===Dt?window:"document"===Dt?Ze:"body"===Dt?Ze.body:null}getBaseHref(Ze){const Dt=function ot(){return Ee=Ee||document.querySelector("base"),Ee?Ee.getAttribute("href"):null}();return null==Dt?null:function Et(Je){qe=qe||document.createElement("a"),qe.setAttribute("href",Je);const Ze=qe.pathname;return"/"===Ze.charAt(0)?Ze:`/${Ze}`}(Dt)}resetBaseElement(){Ee=null}getUserAgent(){return window.navigator.userAgent}getCookie(Ze){return(0,b.Mx)(document.cookie,Ze)}}let qe,Ee=null,tt=(()=>{var Je;class Ze{build(){return new XMLHttpRequest}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)},Je.\u0275prov=T.Yz7({token:Je,factory:Je.\u0275fac}),Ze})();const nt=new T.OlP("EventManagerPlugins");let wt=(()=>{var Je;class Ze{constructor(He,At){this._zone=At,this._eventNameToPlugin=new Map,He.forEach(dn=>{dn.manager=this}),this._plugins=He.slice().reverse()}addEventListener(He,At,dn){return this._findPluginFor(At).addEventListener(He,At,dn)}getZone(){return this._zone}_findPluginFor(He){let At=this._eventNameToPlugin.get(He);if(At)return At;if(At=this._plugins.find(qn=>qn.supports(He)),!At)throw new T.vHH(5101,!1);return this._eventNameToPlugin.set(He,At),At}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(nt),T.LFG(T.R0b))},Je.\u0275prov=T.Yz7({token:Je,factory:Je.\u0275fac}),Ze})();class ht{constructor(Ze){this._doc=Ze}}const et="ng-app-id";let xt=(()=>{var Je;class Ze{constructor(He,At,dn,qn={}){this.doc=He,this.appId=At,this.nonce=dn,this.platformId=qn,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,b.PM)(qn),this.resetHostNodes()}addStyles(He){for(const At of He)1===this.changeUsageCount(At,1)&&this.onStyleAdded(At)}removeStyles(He){for(const At of He)this.changeUsageCount(At,-1)<=0&&this.onStyleRemoved(At)}ngOnDestroy(){const He=this.styleNodesInDOM;He&&(He.forEach(At=>At.remove()),He.clear());for(const At of this.getAllStyles())this.onStyleRemoved(At);this.resetHostNodes()}addHost(He){this.hostNodes.add(He);for(const At of this.getAllStyles())this.addStyleToHost(He,At)}removeHost(He){this.hostNodes.delete(He)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(He){for(const At of this.hostNodes)this.addStyleToHost(At,He)}onStyleRemoved(He){const At=this.styleRef;At.get(He)?.elements?.forEach(dn=>dn.remove()),At.delete(He)}collectServerRenderedStyles(){const He=this.doc.head?.querySelectorAll(`style[${et}="${this.appId}"]`);if(He?.length){const At=new Map;return He.forEach(dn=>{null!=dn.textContent&&At.set(dn.textContent,dn)}),At}return null}changeUsageCount(He,At){const dn=this.styleRef;if(dn.has(He)){const qn=dn.get(He);return qn.usage+=At,qn.usage}return dn.set(He,{usage:At,elements:[]}),At}getStyleElement(He,At){const dn=this.styleNodesInDOM,qn=dn?.get(At);if(qn?.parentNode===He)return dn.delete(At),qn.removeAttribute(et),qn;{const gr=this.doc.createElement("style");return this.nonce&&gr.setAttribute("nonce",this.nonce),gr.textContent=At,this.platformIsServer&&gr.setAttribute(et,this.appId),gr}}addStyleToHost(He,At){const dn=this.getStyleElement(He,At);He.appendChild(dn);const qn=this.styleRef,gr=qn.get(At)?.elements;gr?gr.push(dn):qn.set(At,{elements:[dn],usage:1})}resetHostNodes(){const He=this.hostNodes;He.clear(),He.add(this.doc.head)}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(b.K0),T.LFG(T.AFp),T.LFG(T.Ojb,8),T.LFG(T.Lbi))},Je.\u0275prov=T.Yz7({token:Je,factory:Je.\u0275fac}),Ze})();const Kt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},It=/%COMP%/g,Le=new T.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function De(Je,Ze){return Ze.map(Dt=>Dt.replace(It,Je))}let ft=(()=>{var Je;class Ze{constructor(He,At,dn,qn,gr,Mr,$r,Qr=null){this.eventManager=He,this.sharedStylesHost=At,this.appId=dn,this.removeStylesOnCompDestroy=qn,this.doc=gr,this.platformId=Mr,this.ngZone=$r,this.nonce=Qr,this.rendererByCompId=new Map,this.platformIsServer=(0,b.PM)(Mr),this.defaultRenderer=new Nt(He,gr,$r,this.platformIsServer)}createRenderer(He,At){if(!He||!At)return this.defaultRenderer;this.platformIsServer&&At.encapsulation===T.ifc.ShadowDom&&(At={...At,encapsulation:T.ifc.Emulated});const dn=this.getOrCreateRenderer(He,At);return dn instanceof Wt?dn.applyToHost(He):dn instanceof nr&&dn.applyStyles(),dn}getOrCreateRenderer(He,At){const dn=this.rendererByCompId;let qn=dn.get(At.id);if(!qn){const gr=this.doc,Mr=this.ngZone,$r=this.eventManager,Qr=this.sharedStylesHost,Oi=this.removeStylesOnCompDestroy,rt=this.platformIsServer;switch(At.encapsulation){case T.ifc.Emulated:qn=new Wt($r,Qr,At,this.appId,Oi,gr,Mr,rt);break;case T.ifc.ShadowDom:return new Gt($r,Qr,He,At,gr,Mr,this.nonce,rt);default:qn=new nr($r,Qr,At,Oi,gr,Mr,rt)}dn.set(At.id,qn)}return qn}ngOnDestroy(){this.rendererByCompId.clear()}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(wt),T.LFG(xt),T.LFG(T.AFp),T.LFG(Le),T.LFG(b.K0),T.LFG(T.Lbi),T.LFG(T.R0b),T.LFG(T.Ojb))},Je.\u0275prov=T.Yz7({token:Je,factory:Je.\u0275fac}),Ze})();class Nt{constructor(Ze,Dt,He,At){this.eventManager=Ze,this.doc=Dt,this.ngZone=He,this.platformIsServer=At,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Ze,Dt){return Dt?this.doc.createElementNS(Kt[Dt]||Dt,Ze):this.doc.createElement(Ze)}createComment(Ze){return this.doc.createComment(Ze)}createText(Ze){return this.doc.createTextNode(Ze)}appendChild(Ze,Dt){(hn(Ze)?Ze.content:Ze).appendChild(Dt)}insertBefore(Ze,Dt,He){Ze&&(hn(Ze)?Ze.content:Ze).insertBefore(Dt,He)}removeChild(Ze,Dt){Ze&&Ze.removeChild(Dt)}selectRootElement(Ze,Dt){let He="string"==typeof Ze?this.doc.querySelector(Ze):Ze;if(!He)throw new T.vHH(-5104,!1);return Dt||(He.textContent=""),He}parentNode(Ze){return Ze.parentNode}nextSibling(Ze){return Ze.nextSibling}setAttribute(Ze,Dt,He,At){if(At){Dt=At+":"+Dt;const dn=Kt[At];dn?Ze.setAttributeNS(dn,Dt,He):Ze.setAttribute(Dt,He)}else Ze.setAttribute(Dt,He)}removeAttribute(Ze,Dt,He){if(He){const At=Kt[He];At?Ze.removeAttributeNS(At,Dt):Ze.removeAttribute(`${He}:${Dt}`)}else Ze.removeAttribute(Dt)}addClass(Ze,Dt){Ze.classList.add(Dt)}removeClass(Ze,Dt){Ze.classList.remove(Dt)}setStyle(Ze,Dt,He,At){At&(T.JOm.DashCase|T.JOm.Important)?Ze.style.setProperty(Dt,He,At&T.JOm.Important?"important":""):Ze.style[Dt]=He}removeStyle(Ze,Dt,He){He&T.JOm.DashCase?Ze.style.removeProperty(Dt):Ze.style[Dt]=""}setProperty(Ze,Dt,He){Ze[Dt]=He}setValue(Ze,Dt){Ze.nodeValue=Dt}listen(Ze,Dt,He){if("string"==typeof Ze&&!(Ze=(0,b.q)().getGlobalEventTarget(this.doc,Ze)))throw new Error(`Unsupported event target ${Ze} for event ${Dt}`);return this.eventManager.addEventListener(Ze,Dt,this.decoratePreventDefault(He))}decoratePreventDefault(Ze){return Dt=>{if("__ngUnwrap__"===Dt)return Ze;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>Ze(Dt)):Ze(Dt))&&Dt.preventDefault()}}}function hn(Je){return"TEMPLATE"===Je.tagName&&void 0!==Je.content}class Gt extends Nt{constructor(Ze,Dt,He,At,dn,qn,gr,Mr){super(Ze,dn,qn,Mr),this.sharedStylesHost=Dt,this.hostEl=He,this.shadowRoot=He.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const $r=De(At.id,At.styles);for(const Qr of $r){const Oi=document.createElement("style");gr&&Oi.setAttribute("nonce",gr),Oi.textContent=Qr,this.shadowRoot.appendChild(Oi)}}nodeOrShadowRoot(Ze){return Ze===this.hostEl?this.shadowRoot:Ze}appendChild(Ze,Dt){return super.appendChild(this.nodeOrShadowRoot(Ze),Dt)}insertBefore(Ze,Dt,He){return super.insertBefore(this.nodeOrShadowRoot(Ze),Dt,He)}removeChild(Ze,Dt){return super.removeChild(this.nodeOrShadowRoot(Ze),Dt)}parentNode(Ze){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Ze)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class nr extends Nt{constructor(Ze,Dt,He,At,dn,qn,gr,Mr){super(Ze,dn,qn,gr),this.sharedStylesHost=Dt,this.removeStylesOnCompDestroy=At,this.styles=Mr?De(Mr,He.styles):He.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Wt extends nr{constructor(Ze,Dt,He,At,dn,qn,gr,Mr){const $r=At+"-"+He.id;super(Ze,Dt,He,dn,qn,gr,Mr,$r),this.contentAttr=function Yt(Je){return"_ngcontent-%COMP%".replace(It,Je)}($r),this.hostAttr=function _n(Je){return"_nghost-%COMP%".replace(It,Je)}($r)}applyToHost(Ze){this.applyStyles(),this.setAttribute(Ze,this.hostAttr,"")}createElement(Ze,Dt){const He=super.createElement(Ze,Dt);return super.setAttribute(He,this.contentAttr,""),He}}let pr=(()=>{var Je;class Ze extends ht{constructor(He){super(He)}supports(He){return!0}addEventListener(He,At,dn){return He.addEventListener(At,dn,!1),()=>this.removeEventListener(He,At,dn)}removeEventListener(He,At,dn){return He.removeEventListener(At,dn)}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(b.K0))},Je.\u0275prov=T.Yz7({token:Je,factory:Je.\u0275fac}),Ze})();const an=["alt","control","meta","shift"],Me={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ue={alt:Je=>Je.altKey,control:Je=>Je.ctrlKey,meta:Je=>Je.metaKey,shift:Je=>Je.shiftKey};let at=(()=>{var Je;class Ze extends ht{constructor(He){super(He)}supports(He){return null!=Ze.parseEventName(He)}addEventListener(He,At,dn){const qn=Ze.parseEventName(At),gr=Ze.eventCallback(qn.fullKey,dn,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,b.q)().onAndCancel(He,qn.domEventName,gr))}static parseEventName(He){const At=He.toLowerCase().split("."),dn=At.shift();if(0===At.length||"keydown"!==dn&&"keyup"!==dn)return null;const qn=Ze._normalizeKey(At.pop());let gr="",Mr=At.indexOf("code");if(Mr>-1&&(At.splice(Mr,1),gr="code."),an.forEach(Qr=>{const Oi=At.indexOf(Qr);Oi>-1&&(At.splice(Oi,1),gr+=Qr+".")}),gr+=qn,0!=At.length||0===qn.length)return null;const $r={};return $r.domEventName=dn,$r.fullKey=gr,$r}static matchEventFullKeyCode(He,At){let dn=Me[He.key]||He.key,qn="";return At.indexOf("code.")>-1&&(dn=He.code,qn="code."),!(null==dn||!dn)&&(dn=dn.toLowerCase()," "===dn?dn="space":"."===dn&&(dn="dot"),an.forEach(gr=>{gr!==dn&&(0,Ue[gr])(He)&&(qn+=gr+".")}),qn+=dn,qn===At)}static eventCallback(He,At,dn){return qn=>{Ze.matchEventFullKeyCode(qn,He)&&dn.runGuarded(()=>At(qn))}}static _normalizeKey(He){return"esc"===He?"escape":He}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(b.K0))},Je.\u0275prov=T.Yz7({token:Je,factory:Je.\u0275fac}),Ze})();const $t=(0,T.eFA)(T._c5,"browser",[{provide:T.Lbi,useValue:b.bD},{provide:T.g9A,useValue:function ur(){l.makeCurrent()},multi:!0},{provide:b.K0,useFactory:function Ot(){return(0,T.RDi)(document),document},deps:[]}]),vn=new T.OlP(""),Gn=[{provide:T.rWj,useClass:class vt{addToWindow(Ze){T.dqk.getAngularTestability=(He,At=!0)=>{const dn=Ze.findTestabilityInTree(He,At);if(null==dn)throw new T.vHH(5103,!1);return dn},T.dqk.getAllAngularTestabilities=()=>Ze.getAllTestabilities(),T.dqk.getAllAngularRootElements=()=>Ze.getAllRootElements(),T.dqk.frameworkStabilizers||(T.dqk.frameworkStabilizers=[]),T.dqk.frameworkStabilizers.push(He=>{const At=T.dqk.getAllAngularTestabilities();let dn=At.length,qn=!1;const gr=function(Mr){qn=qn||Mr,dn--,0==dn&&He(qn)};At.forEach(Mr=>{Mr.whenStable(gr)})})}findTestabilityInTree(Ze,Dt,He){return null==Dt?null:Ze.getTestability(Dt)??(He?(0,b.q)().isShadowRoot(Dt)?this.findTestabilityInTree(Ze,Dt.host,!0):this.findTestabilityInTree(Ze,Dt.parentElement,!0):null)}},deps:[]},{provide:T.lri,useClass:T.dDg,deps:[T.R0b,T.eoX,T.rWj]},{provide:T.dDg,useClass:T.dDg,deps:[T.R0b,T.eoX,T.rWj]}],Cr=[{provide:T.zSh,useValue:"root"},{provide:T.qLn,useFactory:function Mn(){return new T.qLn},deps:[]},{provide:nt,useClass:pr,multi:!0,deps:[b.K0,T.R0b,T.Lbi]},{provide:nt,useClass:at,multi:!0,deps:[b.K0]},ft,xt,wt,{provide:T.FYo,useExisting:ft},{provide:b.JF,useClass:tt,deps:[]},[]];let Wn=(()=>{var Je;class Ze{constructor(He){}static withServerTransition(He){return{ngModule:Ze,providers:[{provide:T.AFp,useValue:He.appId}]}}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(vn,12))},Je.\u0275mod=T.oAB({type:Je}),Je.\u0275inj=T.cJS({providers:[...Cr,...Gn],imports:[b.ez,T.hGG]}),Ze})(),vi=(()=>{var Je;class Ze{constructor(He){this._doc=He}getTitle(){return this._doc.title}setTitle(He){this._doc.title=He||""}}return(Je=Ze).\u0275fac=function(He){return new(He||Je)(T.LFG(b.K0))},Je.\u0275prov=T.Yz7({token:Je,factory:function(He){let At=null;return At=He?new He:function An(){return new vi((0,T.LFG)(b.K0))}(),At},providedIn:"root"}),Ze})();typeof window<"u"&&window},3874:(fr,en,oe)=>{"use strict";oe.d(en,{gz:()=>Ii,y6:()=>Ki,OD:()=>so,eC:()=>Ot,wm:()=>Rl,wN:()=>_r,F0:()=>Ao,rH:()=>pa,Bz:()=>ou,Hx:()=>ii});var T=oe(9468),b=oe(5592),Lt=oe(4674),Ee=oe(7715),ot=oe(2096),qe=oe(5619),Et=oe(2572);const tt=(0,oe(2306).d)(R=>function(){R(this),this.name="EmptyError",this.message="no elements in sequence"});var nt=oe(5211),wt=oe(4911),ht=oe(8407);function et(R,B){const $=(0,Lt.m)(R)?R:()=>R,L=Y=>Y.error($());return new b.y(B?Y=>B.schedule(L,0,Y):L)}var xt=oe(6232),Kt=oe(7394),It=oe(9360),st=oe(8251);function sn(){return(0,It.e)((R,B)=>{let $=null;R._refCount++;const L=(0,st.x)(B,void 0,void 0,void 0,()=>{if(!R||R._refCount<=0||0<--R._refCount)return void($=null);const Y=R._connection,_e=$;$=null,Y&&(!_e||Y===_e)&&Y.unsubscribe(),B.unsubscribe()});R.subscribe(L),L.closed||($=R.connect())})}class Tt extends b.y{constructor(B,$){super(),this.source=B,this.subjectFactory=$,this._subject=null,this._refCount=0,this._connection=null,(0,It.A)(B)&&(this.lift=B.lift)}_subscribe(B){return this.getSubject().subscribe(B)}getSubject(){const B=this._subject;return(!B||B.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:B}=this;this._subject=this._connection=null,B?.unsubscribe()}connect(){let B=this._connection;if(!B){B=this._connection=new Kt.w0;const $=this.getSubject();B.add(this.source.subscribe((0,st.x)($,void 0,()=>{this._teardown(),$.complete()},L=>{this._teardown(),$.error(L)},()=>this._teardown()))),B.closed&&(this._connection=null,B=Kt.w0.EMPTY)}return B}refCount(){return sn()(this)}}var Ge=oe(8645),Le=oe(6814),Yt=oe(7398),_n=oe(4664),De=oe(8180),ft=oe(7921),Nt=oe(2181),yt=oe(1631);function mn(R){return(0,It.e)((B,$)=>{let L=!1;B.subscribe((0,st.x)($,Y=>{L=!0,$.next(Y)},()=>{L||$.next(R),$.complete()}))})}function hn(R=Gt){return(0,It.e)((B,$)=>{let L=!1;B.subscribe((0,st.x)($,Y=>{L=!0,$.next(Y)},()=>L?$.complete():$.error(R())))})}function Gt(){return new tt}var nr=oe(2737);function Wt(R,B){const $=arguments.length>=2;return L=>L.pipe(R?(0,Nt.h)((Y,_e)=>R(Y,_e,L)):nr.y,(0,De.q)(1),$?mn(B):hn(()=>new tt))}var pr=oe(6328),an=oe(9397),Me=oe(6306);function Rt(R){return R<=0?()=>xt.E:(0,It.e)((B,$)=>{let L=[];B.subscribe((0,st.x)($,Y=>{L.push(Y),R<L.length&&L.shift()},()=>{for(const Y of L)$.next(Y);$.complete()},void 0,()=>{L=null}))})}var Qn=oe(4716),ur=oe(7537),Mn=oe(6593);const Ot="primary",qt=Symbol("RouteTitle");class $t{constructor(B){this.params=B||{}}has(B){return Object.prototype.hasOwnProperty.call(this.params,B)}get(B){if(this.has(B)){const $=this.params[B];return Array.isArray($)?$[0]:$}return null}getAll(B){if(this.has(B)){const $=this.params[B];return Array.isArray($)?$:[$]}return[]}get keys(){return Object.keys(this.params)}}function vn(R){return new $t(R)}function Gn(R,B,$){const L=$.path.split("/");if(L.length>R.length||"full"===$.pathMatch&&(B.hasChildren()||L.length<R.length))return null;const Y={};for(let _e=0;_e<L.length;_e++){const ze=L[_e],we=R[_e];if(ze.startsWith(":"))Y[ze.substring(1)]=we;else if(ze!==we.path)return null}return{consumed:R.slice(0,L.length),posParams:Y}}function Wn(R,B){const $=R?Object.keys(R):void 0,L=B?Object.keys(B):void 0;if(!$||!L||$.length!=L.length)return!1;let Y;for(let _e=0;_e<$.length;_e++)if(Y=$[_e],!Dr(R[Y],B[Y]))return!1;return!0}function Dr(R,B){if(Array.isArray(R)&&Array.isArray(B)){if(R.length!==B.length)return!1;const $=[...R].sort(),L=[...B].sort();return $.every((Y,_e)=>L[_e]===Y)}return R===B}function er(R){return R.length>0?R[R.length-1]:null}function kr(R){return function l(R){return!!R&&(R instanceof b.y||(0,Lt.m)(R.lift)&&(0,Lt.m)(R.subscribe))}(R)?R:(0,T.QGY)(R)?(0,Ee.D)(Promise.resolve(R)):(0,ot.of)(R)}const An={exact:function zi(R,B,$){if(!ai(R.segments,B.segments)||!Tr(R.segments,B.segments,$)||R.numberOfChildren!==B.numberOfChildren)return!1;for(const L in B.children)if(!R.children[L]||!zi(R.children[L],B.children[L],$))return!1;return!0},subset:Hr},vi={exact:function Ai(R,B){return Wn(R,B)},subset:function Ir(R,B){return Object.keys(B).length<=Object.keys(R).length&&Object.keys(B).every($=>Dr(R[$],B[$]))},ignored:()=>!0};function to(R,B,$){return An[$.paths](R.root,B.root,$.matrixParams)&&vi[$.queryParams](R.queryParams,B.queryParams)&&!("exact"===$.fragment&&R.fragment!==B.fragment)}function Hr(R,B,$){return Lo(R,B,B.segments,$)}function Lo(R,B,$,L){if(R.segments.length>$.length){const Y=R.segments.slice(0,$.length);return!(!ai(Y,$)||B.hasChildren()||!Tr(Y,$,L))}if(R.segments.length===$.length){if(!ai(R.segments,$)||!Tr(R.segments,$,L))return!1;for(const Y in B.children)if(!R.children[Y]||!Hr(R.children[Y],B.children[Y],L))return!1;return!0}{const Y=$.slice(0,R.segments.length),_e=$.slice(R.segments.length);return!!(ai(R.segments,Y)&&Tr(R.segments,Y,L)&&R.children[Ot])&&Lo(R.children[Ot],B,_e,L)}}function Tr(R,B,$){return B.every((L,Y)=>vi[$](R[Y].parameters,L.parameters))}class $i{constructor(B=new Lr([],{}),$={},L=null){this.root=B,this.queryParams=$,this.fragment=L}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vn(this.queryParams)),this._queryParamMap}toString(){return je.serialize(this)}}class Lr{constructor(B,$){this.segments=B,this.children=$,this.parent=null,Object.values($).forEach(L=>L.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ae(this)}}class si{constructor(B,$){this.path=B,this.parameters=$}get parameterMap(){return this._parameterMap||(this._parameterMap=vn(this.parameters)),this._parameterMap}toString(){return Vt(this)}}function ai(R,B){return R.length===B.length&&R.every(($,L)=>$.path===B[L].path)}let ii=(()=>{var R;class B{}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:function(){return new cs},providedIn:"root"}),B})();class cs{parse(B){const $=new Mr(B);return new $i($.parseRootSegment(),$.parseQueryParams(),$.parseFragment())}serialize(B){const $=`/${de(B.root,!0)}`,L=function Ln(R){const B=Object.keys(R).map($=>{const L=R[$];return Array.isArray(L)?L.map(Y=>`${Ye($)}=${Ye(Y)}`).join("&"):`${Ye($)}=${Ye(L)}`}).filter($=>!!$);return B.length?`?${B.join("&")}`:""}(B.queryParams);return`${$}${L}${"string"==typeof B.fragment?`#${function dt(R){return encodeURI(R)}(B.fragment)}`:""}`}}const je=new cs;function ae(R){return R.segments.map(B=>Vt(B)).join("/")}function de(R,B){if(!R.hasChildren())return ae(R);if(B){const $=R.children[Ot]?de(R.children[Ot],!1):"",L=[];return Object.entries(R.children).forEach(([Y,_e])=>{Y!==Ot&&L.push(`${Y}:${de(_e,!1)}`)}),L.length>0?`${$}(${L.join("//")})`:$}{const $=function Pi(R,B){let $=[];return Object.entries(R.children).forEach(([L,Y])=>{L===Ot&&($=$.concat(B(Y,L)))}),Object.entries(R.children).forEach(([L,Y])=>{L!==Ot&&($=$.concat(B(Y,L)))}),$}(R,(L,Y)=>Y===Ot?[de(R.children[Ot],!1)]:[`${Y}:${de(L,!1)}`]);return 1===Object.keys(R.children).length&&null!=R.children[Ot]?`${ae(R)}/${$[0]}`:`${ae(R)}/(${$.join("//")})`}}function ke(R){return encodeURIComponent(R).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ye(R){return ke(R).replace(/%3B/gi,";")}function Mt(R){return ke(R).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function St(R){return decodeURIComponent(R)}function lt(R){return St(R.replace(/\+/g,"%20"))}function Vt(R){return`${Mt(R.path)}${function En(R){return Object.keys(R).map(B=>`;${Mt(B)}=${Mt(R[B])}`).join("")}(R.parameters)}`}const Je=/^[^\/()?;#]+/;function Ze(R){const B=R.match(Je);return B?B[0]:""}const Dt=/^[^\/()?;=#]+/,At=/^[^=?&#]+/,qn=/^[^&#]+/;class Mr{constructor(B){this.url=B,this.remaining=B}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Lr([],{}):new Lr([],this.parseChildren())}parseQueryParams(){const B={};if(this.consumeOptional("?"))do{this.parseQueryParam(B)}while(this.consumeOptional("&"));return B}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const B=[];for(this.peekStartsWith("(")||B.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),B.push(this.parseSegment());let $={};this.peekStartsWith("/(")&&(this.capture("/"),$=this.parseParens(!0));let L={};return this.peekStartsWith("(")&&(L=this.parseParens(!1)),(B.length>0||Object.keys($).length>0)&&(L[Ot]=new Lr(B,$)),L}parseSegment(){const B=Ze(this.remaining);if(""===B&&this.peekStartsWith(";"))throw new T.vHH(4009,!1);return this.capture(B),new si(St(B),this.parseMatrixParams())}parseMatrixParams(){const B={};for(;this.consumeOptional(";");)this.parseParam(B);return B}parseParam(B){const $=function He(R){const B=R.match(Dt);return B?B[0]:""}(this.remaining);if(!$)return;this.capture($);let L="";if(this.consumeOptional("=")){const Y=Ze(this.remaining);Y&&(L=Y,this.capture(L))}B[St($)]=St(L)}parseQueryParam(B){const $=function dn(R){const B=R.match(At);return B?B[0]:""}(this.remaining);if(!$)return;this.capture($);let L="";if(this.consumeOptional("=")){const ze=function gr(R){const B=R.match(qn);return B?B[0]:""}(this.remaining);ze&&(L=ze,this.capture(L))}const Y=lt($),_e=lt(L);if(B.hasOwnProperty(Y)){let ze=B[Y];Array.isArray(ze)||(ze=[ze],B[Y]=ze),ze.push(_e)}else B[Y]=_e}parseParens(B){const $={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const L=Ze(this.remaining),Y=this.remaining[L.length];if("/"!==Y&&")"!==Y&&";"!==Y)throw new T.vHH(4010,!1);let _e;L.indexOf(":")>-1?(_e=L.slice(0,L.indexOf(":")),this.capture(_e),this.capture(":")):B&&(_e=Ot);const ze=this.parseChildren();$[_e]=1===Object.keys(ze).length?ze[Ot]:new Lr([],ze),this.consumeOptional("//")}return $}peekStartsWith(B){return this.remaining.startsWith(B)}consumeOptional(B){return!!this.peekStartsWith(B)&&(this.remaining=this.remaining.substring(B.length),!0)}capture(B){if(!this.consumeOptional(B))throw new T.vHH(4011,!1)}}function $r(R){return R.segments.length>0?new Lr([],{[Ot]:R}):R}function Qr(R){const B={};for(const L of Object.keys(R.children)){const _e=Qr(R.children[L]);if(L===Ot&&0===_e.segments.length&&_e.hasChildren())for(const[ze,we]of Object.entries(_e.children))B[ze]=we;else(_e.segments.length>0||_e.hasChildren())&&(B[L]=_e)}return function Oi(R){if(1===R.numberOfChildren&&R.children[Ot]){const B=R.children[Ot];return new Lr(R.segments.concat(B.segments),B.children)}return R}(new Lr(R.segments,B))}function rt(R){return R instanceof $i}function tn(R){let B;const Y=$r(function $(_e){const ze={};for(const Rn of _e.children){const mr=$(Rn);ze[Rn.outlet]=mr}const we=new Lr(_e.url,ze);return _e===R&&(B=we),we}(R.root));return B??Y}function Xt(R,B,$,L){let Y=R;for(;Y.parent;)Y=Y.parent;if(0===B.length)return br(Y,Y,Y,$,L);const _e=function Sr(R){if("string"==typeof R[0]&&1===R.length&&"/"===R[0])return new hi(!0,0,R);let B=0,$=!1;const L=R.reduce((Y,_e,ze)=>{if("object"==typeof _e&&null!=_e){if(_e.outlets){const we={};return Object.entries(_e.outlets).forEach(([Rn,mr])=>{we[Rn]="string"==typeof mr?mr.split("/"):mr}),[...Y,{outlets:we}]}if(_e.segmentPath)return[...Y,_e.segmentPath]}return"string"!=typeof _e?[...Y,_e]:0===ze?(_e.split("/").forEach((we,Rn)=>{0==Rn&&"."===we||(0==Rn&&""===we?$=!0:".."===we?B++:""!=we&&Y.push(we))}),Y):[...Y,_e]},[]);return new hi($,B,L)}(B);if(_e.toRoot())return br(Y,Y,new Lr([],{}),$,L);const ze=function Yr(R,B,$){if(R.isAbsolute)return new mi(B,!0,0);if(!$)return new mi(B,!1,NaN);if(null===$.parent)return new mi($,!0,0);const L=yn(R.commands[0])?0:1;return function li(R,B,$){let L=R,Y=B,_e=$;for(;_e>Y;){if(_e-=Y,L=L.parent,!L)throw new T.vHH(4005,!1);Y=L.segments.length}return new mi(L,!1,Y-_e)}($,$.segments.length-1+L,R.numberOfDoubleDots)}(_e,Y,R),we=ze.processChildren?So(ze.segmentGroup,ze.index,_e.commands):Ur(ze.segmentGroup,ze.index,_e.commands);return br(Y,ze.segmentGroup,we,$,L)}function yn(R){return"object"==typeof R&&null!=R&&!R.outlets&&!R.segmentPath}function zn(R){return"object"==typeof R&&null!=R&&R.outlets}function br(R,B,$,L,Y){let ze,_e={};L&&Object.entries(L).forEach(([Rn,mr])=>{_e[Rn]=Array.isArray(mr)?mr.map(oi=>`${oi}`):`${mr}`}),ze=R===B?$:or(R,B,$);const we=$r(Qr(ze));return new $i(we,_e,Y)}function or(R,B,$){const L={};return Object.entries(R.children).forEach(([Y,_e])=>{L[Y]=_e===B?$:or(_e,B,$)}),new Lr(R.segments,L)}class hi{constructor(B,$,L){if(this.isAbsolute=B,this.numberOfDoubleDots=$,this.commands=L,B&&L.length>0&&yn(L[0]))throw new T.vHH(4003,!1);const Y=L.find(zn);if(Y&&Y!==er(L))throw new T.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class mi{constructor(B,$,L){this.segmentGroup=B,this.processChildren=$,this.index=L}}function Ur(R,B,$){if(R||(R=new Lr([],{})),0===R.segments.length&&R.hasChildren())return So(R,B,$);const L=function zt(R,B,$){let L=0,Y=B;const _e={match:!1,pathIndex:0,commandIndex:0};for(;Y<R.segments.length;){if(L>=$.length)return _e;const ze=R.segments[Y],we=$[L];if(zn(we))break;const Rn=`${we}`,mr=L<$.length-1?$[L+1]:null;if(Y>0&&void 0===Rn)break;if(Rn&&mr&&"object"==typeof mr&&void 0===mr.outlets){if(!Vi(Rn,mr,ze))return _e;L+=2}else{if(!Vi(Rn,{},ze))return _e;L++}Y++}return{match:!0,pathIndex:Y,commandIndex:L}}(R,B,$),Y=$.slice(L.commandIndex);if(L.match&&L.pathIndex<R.segments.length){const _e=new Lr(R.segments.slice(0,L.pathIndex),{});return _e.children[Ot]=new Lr(R.segments.slice(L.pathIndex),R.children),So(_e,0,Y)}return L.match&&0===Y.length?new Lr(R.segments,{}):L.match&&!R.hasChildren()?ei(R,B,$):L.match?So(R,0,Y):ei(R,B,$)}function So(R,B,$){if(0===$.length)return new Lr(R.segments,{});{const L=function bi(R){return zn(R[0])?R[0].outlets:{[Ot]:R}}($),Y={};if(!L[Ot]&&R.children[Ot]&&1===R.numberOfChildren&&0===R.children[Ot].segments.length){const _e=So(R.children[Ot],B,$);return new Lr(R.segments,_e.children)}return Object.entries(L).forEach(([_e,ze])=>{"string"==typeof ze&&(ze=[ze]),null!==ze&&(Y[_e]=Ur(R.children[_e],B,ze))}),Object.entries(R.children).forEach(([_e,ze])=>{void 0===L[_e]&&(Y[_e]=ze)}),new Lr(R.segments,Y)}}function ei(R,B,$){const L=R.segments.slice(0,B);let Y=0;for(;Y<$.length;){const _e=$[Y];if(zn(_e)){const Rn=Ri(_e.outlets);return new Lr(L,Rn)}if(0===Y&&yn($[0])){L.push(new si(R.segments[B].path,Fi($[0]))),Y++;continue}const ze=zn(_e)?_e.outlets[Ot]:`${_e}`,we=Y<$.length-1?$[Y+1]:null;ze&&we&&yn(we)?(L.push(new si(ze,Fi(we))),Y+=2):(L.push(new si(ze,{})),Y++)}return new Lr(L,{})}function Ri(R){const B={};return Object.entries(R).forEach(([$,L])=>{"string"==typeof L&&(L=[L]),null!==L&&(B[$]=ei(new Lr([],{}),0,L))}),B}function Fi(R){const B={};return Object.entries(R).forEach(([$,L])=>B[$]=`${L}`),B}function Vi(R,B,$){return R==$.path&&Wn(B,$.parameters)}const Ui="imperative";class _o{constructor(B,$){this.id=B,this.url=$}}class so extends _o{constructor(B,$,L="imperative",Y=null){super(B,$),this.type=0,this.navigationTrigger=L,this.restoredState=Y}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class yo extends _o{constructor(B,$,L){super(B,$),this.urlAfterRedirects=L,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Kn extends _o{constructor(B,$,L,Y){super(B,$),this.reason=L,this.code=Y,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Br extends _o{constructor(B,$,L,Y){super(B,$),this.reason=L,this.code=Y,this.type=16}}class le extends _o{constructor(B,$,L,Y){super(B,$),this.error=L,this.target=Y,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Oe extends _o{constructor(B,$,L,Y){super(B,$),this.urlAfterRedirects=L,this.state=Y,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pe extends _o{constructor(B,$,L,Y){super(B,$),this.urlAfterRedirects=L,this.state=Y,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Se extends _o{constructor(B,$,L,Y,_e){super(B,$),this.urlAfterRedirects=L,this.state=Y,this.shouldActivate=_e,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class bt extends _o{constructor(B,$,L,Y){super(B,$),this.urlAfterRedirects=L,this.state=Y,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pt extends _o{constructor(B,$,L,Y){super(B,$),this.urlAfterRedirects=L,this.state=Y,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fn{constructor(B){this.route=B,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class bn{constructor(B){this.route=B,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class pn{constructor(B){this.snapshot=B,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pn{constructor(B){this.snapshot=B,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class lr{constructor(B){this.snapshot=B,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ar{constructor(B){this.snapshot=B,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zr{constructor(B,$,L){this.routerEvent=B,this.position=$,this.anchor=L,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class zo{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ki,this.attachRef=null}}let Ki=(()=>{var R;class B{constructor(){this.contexts=new Map}onChildOutletCreated(L,Y){const _e=this.getOrCreateContext(L);_e.outlet=Y,this.contexts.set(L,_e)}onChildOutletDestroyed(L){const Y=this.getContext(L);Y&&(Y.outlet=null,Y.attachRef=null)}onOutletDeactivated(){const L=this.contexts;return this.contexts=new Map,L}onOutletReAttached(L){this.contexts=L}getOrCreateContext(L){let Y=this.getContext(L);return Y||(Y=new zo,this.contexts.set(L,Y)),Y}getContext(L){return this.contexts.get(L)||null}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})();class Zo{constructor(B){this._root=B}get root(){return this._root.value}parent(B){const $=this.pathFromRoot(B);return $.length>1?$[$.length-2]:null}children(B){const $=ao(B,this._root);return $?$.children.map(L=>L.value):[]}firstChild(B){const $=ao(B,this._root);return $&&$.children.length>0?$.children[0].value:null}siblings(B){const $=Io(B,this._root);return $.length<2?[]:$[$.length-2].children.map(Y=>Y.value).filter(Y=>Y!==B)}pathFromRoot(B){return Io(B,this._root).map($=>$.value)}}function ao(R,B){if(R===B.value)return B;for(const $ of B.children){const L=ao(R,$);if(L)return L}return null}function Io(R,B){if(R===B.value)return[B];for(const $ of B.children){const L=Io(R,$);if(L.length)return L.unshift(B),L}return[]}class ro{constructor(B,$){this.value=B,this.children=$}toString(){return`TreeNode(${this.value})`}}function Si(R){const B={};return R&&R.children.forEach($=>B[$.value.outlet]=$),B}class wa extends Zo{constructor(B,$){super(B),this.snapshot=$,Qs(this,B)}toString(){return this.snapshot.toString()}}function sa(R,B){const $=function Gr(R,B){const ze=new xi([],{},{},"",{},Ot,B,null,{});return new Js("",new ro(ze,[]))}(0,B),L=new qe.X([new si("",{})]),Y=new qe.X({}),_e=new qe.X({}),ze=new qe.X({}),we=new qe.X(""),Rn=new Ii(L,Y,ze,we,_e,Ot,B,$.root);return Rn.snapshot=$.root,new wa(new ro(Rn,[]),$)}class Ii{constructor(B,$,L,Y,_e,ze,we,Rn){this.urlSubject=B,this.paramsSubject=$,this.queryParamsSubject=L,this.fragmentSubject=Y,this.dataSubject=_e,this.outlet=ze,this.component=we,this._futureSnapshot=Rn,this.title=this.dataSubject?.pipe((0,Yt.U)(mr=>mr[qt]))??(0,ot.of)(void 0),this.url=B,this.params=$,this.queryParams=L,this.fragment=Y,this.data=_e}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Yt.U)(B=>vn(B)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Yt.U)(B=>vn(B)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Fo(R,B="emptyOnly"){const $=R.pathFromRoot;let L=0;if("always"!==B)for(L=$.length-1;L>=1;){const Y=$[L],_e=$[L-1];if(Y.routeConfig&&""===Y.routeConfig.path)L--;else{if(_e.component)break;L--}}return function gs(R){return R.reduce((B,$)=>({params:{...B.params,...$.params},data:{...B.data,...$.data},resolve:{...$.data,...B.resolve,...$.routeConfig?.data,...$._resolvedData}}),{params:{},data:{},resolve:{}})}($.slice(L))}class xi{get title(){return this.data?.[qt]}constructor(B,$,L,Y,_e,ze,we,Rn,mr){this.url=B,this.params=$,this.queryParams=L,this.fragment=Y,this.data=_e,this.outlet=ze,this.component=we,this.routeConfig=Rn,this._resolve=mr}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=vn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(L=>L.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Js extends Zo{constructor(B,$){super($),this.url=B,Qs(this,$)}toString(){return Is(this._root)}}function Qs(R,B){B.value._routerState=R,B.children.forEach($=>Qs(R,$))}function Is(R){const B=R.children.length>0?` { ${R.children.map(Is).join(", ")} } `:"";return`${R.value}${B}`}function vo(R){if(R.snapshot){const B=R.snapshot,$=R._futureSnapshot;R.snapshot=$,Wn(B.queryParams,$.queryParams)||R.queryParamsSubject.next($.queryParams),B.fragment!==$.fragment&&R.fragmentSubject.next($.fragment),Wn(B.params,$.params)||R.paramsSubject.next($.params),function Cr(R,B){if(R.length!==B.length)return!1;for(let $=0;$<R.length;++$)if(!Wn(R[$],B[$]))return!1;return!0}(B.url,$.url)||R.urlSubject.next($.url),Wn(B.data,$.data)||R.dataSubject.next($.data)}else R.snapshot=R._futureSnapshot,R.dataSubject.next(R._futureSnapshot.data)}function ha(R,B){const $=Wn(R.params,B.params)&&function Gi(R,B){return ai(R,B)&&R.every(($,L)=>Wn($.parameters,B[L].parameters))}(R.url,B.url);return $&&!(!R.parent!=!B.parent)&&(!R.parent||ha(R.parent,B.parent))}let Wi=(()=>{var R;class B{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ot,this.activateEvents=new T.vpe,this.deactivateEvents=new T.vpe,this.attachEvents=new T.vpe,this.detachEvents=new T.vpe,this.parentContexts=(0,T.f3M)(Ki),this.location=(0,T.f3M)(T.s_b),this.changeDetector=(0,T.f3M)(T.sBO),this.environmentInjector=(0,T.f3M)(T.lqb),this.inputBinder=(0,T.f3M)(Rr,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(L){if(L.name){const{firstChange:Y,previousValue:_e}=L.name;if(Y)return;this.isTrackedInParentContexts(_e)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(_e)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(L){return this.parentContexts.getContext(L)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const L=this.parentContexts.getContext(this.name);L?.route&&(L.attachRef?this.attach(L.attachRef,L.route):this.activateWith(L.route,L.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new T.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new T.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new T.vHH(4012,!1);this.location.detach();const L=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(L.instance),L}attach(L,Y){this.activated=L,this._activatedRoute=Y,this.location.insert(L.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(L.instance)}deactivate(){if(this.activated){const L=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(L)}}activateWith(L,Y){if(this.isActivated)throw new T.vHH(4013,!1);this._activatedRoute=L;const _e=this.location,we=L.snapshot.component,Rn=this.parentContexts.getOrCreateContext(this.name).children,mr=new rr(L,Rn,_e.injector);this.activated=_e.createComponent(we,{index:_e.length,injector:mr,environmentInjector:Y??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275dir=T.lG2({type:R,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[T.TTD]}),B})();class rr{constructor(B,$,L){this.route=B,this.childContexts=$,this.parent=L}get(B,$){return B===Ii?this.route:B===Ki?this.childContexts:this.parent.get(B,$)}}const Rr=new T.OlP("");let qi=(()=>{var R;class B{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(L){this.unsubscribeFromRouteData(L),this.subscribeToRouteData(L)}unsubscribeFromRouteData(L){this.outletDataSubscriptions.get(L)?.unsubscribe(),this.outletDataSubscriptions.delete(L)}subscribeToRouteData(L){const{activatedRoute:Y}=L,_e=(0,Et.a)([Y.queryParams,Y.params,Y.data]).pipe((0,_n.w)(([ze,we,Rn],mr)=>(Rn={...ze,...we,...Rn},0===mr?(0,ot.of)(Rn):Promise.resolve(Rn)))).subscribe(ze=>{if(!L.isActivated||!L.activatedComponentRef||L.activatedRoute!==Y||null===Y.component)return void this.unsubscribeFromRouteData(L);const we=(0,T.qFp)(Y.component);if(we)for(const{templateName:Rn}of we.inputs)L.activatedComponentRef.setInput(Rn,ze[Rn]);else this.unsubscribeFromRouteData(L)});this.outletDataSubscriptions.set(L,_e)}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac}),B})();function rs(R,B,$){if($&&R.shouldReuseRoute(B.value,$.value.snapshot)){const L=$.value;L._futureSnapshot=B.value;const Y=function io(R,B,$){return B.children.map(L=>{for(const Y of $.children)if(R.shouldReuseRoute(L.value,Y.value.snapshot))return rs(R,L,Y);return rs(R,L)})}(R,B,$);return new ro(L,Y)}{if(R.shouldAttach(B.value)){const _e=R.retrieve(B.value);if(null!==_e){const ze=_e.route;return ze.value._futureSnapshot=B.value,ze.children=B.children.map(we=>rs(R,we)),ze}}const L=function Wo(R){return new Ii(new qe.X(R.url),new qe.X(R.params),new qe.X(R.queryParams),new qe.X(R.fragment),new qe.X(R.data),R.outlet,R.component,R)}(B.value),Y=B.children.map(_e=>rs(R,_e));return new ro(L,Y)}}const no="ngNavigationCancelingError";function $o(R,B){const{redirectTo:$,navigationBehaviorOptions:L}=rt(B)?{redirectTo:B,navigationBehaviorOptions:void 0}:B,Y=Bo(!1,0,B);return Y.url=$,Y.navigationBehaviorOptions=L,Y}function Bo(R,B,$){const L=new Error("NavigationCancelingError: "+(R||""));return L[no]=!0,L.cancellationCode=B,$&&(L.url=$),L}function Wr(R){return Xo(R)&&rt(R.url)}function Xo(R){return R&&R[no]}let Ko=(()=>{var R;class B{}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275cmp=T.Xpm({type:R,selectors:[["ng-component"]],standalone:!0,features:[T.jDz],decls:1,vars:0,template:function(L,Y){1&L&&T._UZ(0,"router-outlet")},dependencies:[Wi],encapsulation:2}),B})();function ta(R){const B=R.children&&R.children.map(ta),$=B?{...R,children:B}:{...R};return!$.component&&!$.loadComponent&&(B||$.loadChildren)&&$.outlet&&$.outlet!==Ot&&($.component=Ko),$}function Jo(R){return R.outlet||Ot}function la(R){if(!R)return null;if(R.routeConfig?._injector)return R.routeConfig._injector;for(let B=R.parent;B;B=B.parent){const $=B.routeConfig;if($?._loadedInjector)return $._loadedInjector;if($?._injector)return $._injector}return null}class os{constructor(B,$,L,Y,_e){this.routeReuseStrategy=B,this.futureState=$,this.currState=L,this.forwardEvent=Y,this.inputBindingEnabled=_e}activate(B){const $=this.futureState._root,L=this.currState?this.currState._root:null;this.deactivateChildRoutes($,L,B),vo(this.futureState.root),this.activateChildRoutes($,L,B)}deactivateChildRoutes(B,$,L){const Y=Si($);B.children.forEach(_e=>{const ze=_e.value.outlet;this.deactivateRoutes(_e,Y[ze],L),delete Y[ze]}),Object.values(Y).forEach(_e=>{this.deactivateRouteAndItsChildren(_e,L)})}deactivateRoutes(B,$,L){const Y=B.value,_e=$?$.value:null;if(Y===_e)if(Y.component){const ze=L.getContext(Y.outlet);ze&&this.deactivateChildRoutes(B,$,ze.children)}else this.deactivateChildRoutes(B,$,L);else _e&&this.deactivateRouteAndItsChildren($,L)}deactivateRouteAndItsChildren(B,$){B.value.component&&this.routeReuseStrategy.shouldDetach(B.value.snapshot)?this.detachAndStoreRouteSubtree(B,$):this.deactivateRouteAndOutlet(B,$)}detachAndStoreRouteSubtree(B,$){const L=$.getContext(B.value.outlet),Y=L&&B.value.component?L.children:$,_e=Si(B);for(const ze of Object.keys(_e))this.deactivateRouteAndItsChildren(_e[ze],Y);if(L&&L.outlet){const ze=L.outlet.detach(),we=L.children.onOutletDeactivated();this.routeReuseStrategy.store(B.value.snapshot,{componentRef:ze,route:B,contexts:we})}}deactivateRouteAndOutlet(B,$){const L=$.getContext(B.value.outlet),Y=L&&B.value.component?L.children:$,_e=Si(B);for(const ze of Object.keys(_e))this.deactivateRouteAndItsChildren(_e[ze],Y);L&&(L.outlet&&(L.outlet.deactivate(),L.children.onOutletDeactivated()),L.attachRef=null,L.route=null)}activateChildRoutes(B,$,L){const Y=Si($);B.children.forEach(_e=>{this.activateRoutes(_e,Y[_e.value.outlet],L),this.forwardEvent(new Ar(_e.value.snapshot))}),B.children.length&&this.forwardEvent(new Pn(B.value.snapshot))}activateRoutes(B,$,L){const Y=B.value,_e=$?$.value:null;if(vo(Y),Y===_e)if(Y.component){const ze=L.getOrCreateContext(Y.outlet);this.activateChildRoutes(B,$,ze.children)}else this.activateChildRoutes(B,$,L);else if(Y.component){const ze=L.getOrCreateContext(Y.outlet);if(this.routeReuseStrategy.shouldAttach(Y.snapshot)){const we=this.routeReuseStrategy.retrieve(Y.snapshot);this.routeReuseStrategy.store(Y.snapshot,null),ze.children.onOutletReAttached(we.contexts),ze.attachRef=we.componentRef,ze.route=we.route.value,ze.outlet&&ze.outlet.attach(we.componentRef,we.route.value),vo(we.route.value),this.activateChildRoutes(B,null,ze.children)}else{const we=la(Y.snapshot);ze.attachRef=null,ze.route=Y,ze.injector=we,ze.outlet&&ze.outlet.activateWith(Y,ze.injector),this.activateChildRoutes(B,null,ze.children)}}else this.activateChildRoutes(B,null,L)}}class na{constructor(B){this.path=B,this.route=this.path[this.path.length-1]}}class Ho{constructor(B,$){this.component=B,this.route=$}}function Fs(R,B,$){const L=R._root;return xo(L,B?B._root:null,$,[L.value])}function Hs(R,B){const $=Symbol(),L=B.get(R,$);return L===$?"function"!=typeof R||(0,T.Z0I)(R)?B.get(R):R:L}function xo(R,B,$,L,Y={canDeactivateChecks:[],canActivateChecks:[]}){const _e=Si(B);return R.children.forEach(ze=>{(function us(R,B,$,L,Y={canDeactivateChecks:[],canActivateChecks:[]}){const _e=R.value,ze=B?B.value:null,we=$?$.getContext(R.value.outlet):null;if(ze&&_e.routeConfig===ze.routeConfig){const Rn=function ya(R,B,$){if("function"==typeof $)return $(R,B);switch($){case"pathParamsChange":return!ai(R.url,B.url);case"pathParamsOrQueryParamsChange":return!ai(R.url,B.url)||!Wn(R.queryParams,B.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ha(R,B)||!Wn(R.queryParams,B.queryParams);default:return!ha(R,B)}}(ze,_e,_e.routeConfig.runGuardsAndResolvers);Rn?Y.canActivateChecks.push(new na(L)):(_e.data=ze.data,_e._resolvedData=ze._resolvedData),xo(R,B,_e.component?we?we.children:null:$,L,Y),Rn&&we&&we.outlet&&we.outlet.isActivated&&Y.canDeactivateChecks.push(new Ho(we.outlet.component,ze))}else ze&&ds(B,we,Y),Y.canActivateChecks.push(new na(L)),xo(R,null,_e.component?we?we.children:null:$,L,Y)})(ze,_e[ze.value.outlet],$,L.concat([ze.value]),Y),delete _e[ze.value.outlet]}),Object.entries(_e).forEach(([ze,we])=>ds(we,$.getContext(ze),Y)),Y}function ds(R,B,$){const L=Si(R),Y=R.value;Object.entries(L).forEach(([_e,ze])=>{ds(ze,Y.component?B?B.children.getContext(_e):null:B,$)}),$.canDeactivateChecks.push(new Ho(Y.component&&B&&B.outlet&&B.outlet.isActivated?B.outlet.component:null,Y))}function bs(R){return"function"==typeof R}function Hi(R){return R instanceof tt||"EmptyError"===R?.name}const lo=Symbol("INITIAL_VALUE");function Q(){return(0,_n.w)(R=>(0,Et.a)(R.map(B=>B.pipe((0,De.q)(1),(0,ft.O)(lo)))).pipe((0,Yt.U)(B=>{for(const $ of B)if(!0!==$){if($===lo)return lo;if(!1===$||$ instanceof $i)return $}return!0}),(0,Nt.h)(B=>B!==lo),(0,De.q)(1)))}function Gs(R){return(0,ht.z)((0,an.b)(B=>{if(rt(B))throw $o(0,B)}),(0,Yt.U)(B=>!0===B))}class Ea{constructor(B){this.segmentGroup=B||null}}class Bs{constructor(B){this.urlTree=B}}function Ns(R){return et(new Ea(R))}function al(R){return et(new Bs(R))}class xl{constructor(B,$){this.urlSerializer=B,this.urlTree=$}noMatchError(B){return new T.vHH(4002,!1)}lineralizeSegments(B,$){let L=[],Y=$.root;for(;;){if(L=L.concat(Y.segments),0===Y.numberOfChildren)return(0,ot.of)(L);if(Y.numberOfChildren>1||!Y.children[Ot])return et(new T.vHH(4e3,!1));Y=Y.children[Ot]}}applyRedirectCommands(B,$,L){return this.applyRedirectCreateUrlTree($,this.urlSerializer.parse($),B,L)}applyRedirectCreateUrlTree(B,$,L,Y){const _e=this.createSegmentGroup(B,$.root,L,Y);return new $i(_e,this.createQueryParams($.queryParams,this.urlTree.queryParams),$.fragment)}createQueryParams(B,$){const L={};return Object.entries(B).forEach(([Y,_e])=>{if("string"==typeof _e&&_e.startsWith(":")){const we=_e.substring(1);L[Y]=$[we]}else L[Y]=_e}),L}createSegmentGroup(B,$,L,Y){const _e=this.createSegments(B,$.segments,L,Y);let ze={};return Object.entries($.children).forEach(([we,Rn])=>{ze[we]=this.createSegmentGroup(B,Rn,L,Y)}),new Lr(_e,ze)}createSegments(B,$,L,Y){return $.map(_e=>_e.path.startsWith(":")?this.findPosParam(B,_e,Y):this.findOrReturn(_e,L))}findPosParam(B,$,L){const Y=L[$.path.substring(1)];if(!Y)throw new T.vHH(4001,!1);return Y}findOrReturn(B,$){let L=0;for(const Y of $){if(Y.path===B.path)return $.splice(L),Y;L++}return B}}const ce={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function M(R,B,$,L,Y){const _e=F(R,B,$);return _e.matched?(L=function ys(R,B){return R.providers&&!R._injector&&(R._injector=(0,T.MMx)(R.providers,B,`Route: ${R.path}`)),R._injector??B}(B,L),function Aa(R,B,$,L){const Y=B.canMatch;if(!Y||0===Y.length)return(0,ot.of)(!0);const _e=Y.map(ze=>{const we=Hs(ze,R);return kr(function Tn(R){return R&&bs(R.canMatch)}(we)?we.canMatch(B,$):R.runInContext(()=>we(B,$)))});return(0,ot.of)(_e).pipe(Q(),Gs())}(L,B,$).pipe((0,Yt.U)(ze=>!0===ze?_e:{...ce}))):(0,ot.of)(_e)}function F(R,B,$){if(""===B.path)return"full"===B.pathMatch&&(R.hasChildren()||$.length>0)?{...ce}:{matched:!0,consumedSegments:[],remainingSegments:$,parameters:{},positionalParamSegments:{}};const Y=(B.matcher||Gn)($,R,B);if(!Y)return{...ce};const _e={};Object.entries(Y.posParams??{}).forEach(([we,Rn])=>{_e[we]=Rn.path});const ze=Y.consumed.length>0?{..._e,...Y.consumed[Y.consumed.length-1].parameters}:_e;return{matched:!0,consumedSegments:Y.consumed,remainingSegments:$.slice(Y.consumed.length),parameters:ze,positionalParamSegments:Y.posParams??{}}}function G(R,B,$,L){return $.length>0&&function ct(R,B,$){return $.some(L=>Qt(R,B,L)&&Jo(L)!==Ot)}(R,$,L)?{segmentGroup:new Lr(B,Ce(L,new Lr($,R.children))),slicedSegments:[]}:0===$.length&&function ut(R,B,$){return $.some(L=>Qt(R,B,L))}(R,$,L)?{segmentGroup:new Lr(R.segments,ue(R,0,$,L,R.children)),slicedSegments:$}:{segmentGroup:new Lr(R.segments,R.children),slicedSegments:$}}function ue(R,B,$,L,Y){const _e={};for(const ze of L)if(Qt(R,$,ze)&&!Y[Jo(ze)]){const we=new Lr([],{});_e[Jo(ze)]=we}return{...Y,..._e}}function Ce(R,B){const $={};$[Ot]=B;for(const L of R)if(""===L.path&&Jo(L)!==Ot){const Y=new Lr([],{});$[Jo(L)]=Y}return $}function Qt(R,B,$){return(!(R.hasChildren()||B.length>0)||"full"!==$.pathMatch)&&""===$.path}class Ei{constructor(B,$,L,Y,_e,ze,we){this.injector=B,this.configLoader=$,this.rootComponentType=L,this.config=Y,this.urlTree=_e,this.paramsInheritanceStrategy=ze,this.urlSerializer=we,this.allowRedirects=!0,this.applyRedirects=new xl(this.urlSerializer,this.urlTree)}noMatchError(B){return new T.vHH(4002,!1)}recognize(){const B=G(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,B,Ot).pipe((0,Me.K)($=>{if($ instanceof Bs)return this.allowRedirects=!1,this.urlTree=$.urlTree,this.match($.urlTree);throw $ instanceof Ea?this.noMatchError($):$}),(0,Yt.U)($=>{const L=new xi([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ot,this.rootComponentType,null,{}),Y=new ro(L,$),_e=new Js("",Y),ze=function Ke(R,B,$=null,L=null){return Xt(tn(R),B,$,L)}(L,[],this.urlTree.queryParams,this.urlTree.fragment);return ze.queryParams=this.urlTree.queryParams,_e.url=this.urlSerializer.serialize(ze),this.inheritParamsAndData(_e._root),{state:_e,tree:ze}}))}match(B){return this.processSegmentGroup(this.injector,this.config,B.root,Ot).pipe((0,Me.K)(L=>{throw L instanceof Ea?this.noMatchError(L):L}))}inheritParamsAndData(B){const $=B.value,L=Fo($,this.paramsInheritanceStrategy);$.params=Object.freeze(L.params),$.data=Object.freeze(L.data),B.children.forEach(Y=>this.inheritParamsAndData(Y))}processSegmentGroup(B,$,L,Y){return 0===L.segments.length&&L.hasChildren()?this.processChildren(B,$,L):this.processSegment(B,$,L,L.segments,Y,!0)}processChildren(B,$,L){const Y=[];for(const _e of Object.keys(L.children))"primary"===_e?Y.unshift(_e):Y.push(_e);return(0,Ee.D)(Y).pipe((0,pr.b)(_e=>{const ze=L.children[_e],we=function fi(R,B){const $=R.filter(L=>Jo(L)===B);return $.push(...R.filter(L=>Jo(L)!==B)),$}($,_e);return this.processSegmentGroup(B,we,ze,_e)}),function at(R,B){return(0,It.e)(function Ue(R,B,$,L,Y){return(_e,ze)=>{let we=$,Rn=B,mr=0;_e.subscribe((0,st.x)(ze,oi=>{const Nr=mr++;Rn=we?R(Rn,oi,Nr):(we=!0,oi),L&&ze.next(Rn)},Y&&(()=>{we&&ze.next(Rn),ze.complete()})))}}(R,B,arguments.length>=2,!0))}((_e,ze)=>(_e.push(...ze),_e)),mn(null),function cn(R,B){const $=arguments.length>=2;return L=>L.pipe(R?(0,Nt.h)((Y,_e)=>R(Y,_e,L)):nr.y,Rt(1),$?mn(B):hn(()=>new tt))}(),(0,yt.z)(_e=>{if(null===_e)return Ns(L);const ze=pi(_e);return function ui(R){R.sort((B,$)=>B.value.outlet===Ot?-1:$.value.outlet===Ot?1:B.value.outlet.localeCompare($.value.outlet))}(ze),(0,ot.of)(ze)}))}processSegment(B,$,L,Y,_e,ze){return(0,Ee.D)($).pipe((0,pr.b)(we=>this.processSegmentAgainstRoute(we._injector??B,$,we,L,Y,_e,ze).pipe((0,Me.K)(Rn=>{if(Rn instanceof Ea)return(0,ot.of)(null);throw Rn}))),Wt(we=>!!we),(0,Me.K)(we=>{if(Hi(we))return function Er(R,B,$){return 0===B.length&&!R.children[$]}(L,Y,_e)?(0,ot.of)([]):Ns(L);throw we}))}processSegmentAgainstRoute(B,$,L,Y,_e,ze,we){return function Dn(R,B,$,L){return!!(Jo(R)===L||L!==Ot&&Qt(B,$,R))&&("**"===R.path||F(B,R,$).matched)}(L,Y,_e,ze)?void 0===L.redirectTo?this.matchSegmentAgainstRoute(B,Y,L,_e,ze,we):we&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(B,Y,$,L,_e,ze):Ns(Y):Ns(Y)}expandSegmentAgainstRouteUsingRedirect(B,$,L,Y,_e,ze){return"**"===Y.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(B,L,Y,ze):this.expandRegularSegmentAgainstRouteUsingRedirect(B,$,L,Y,_e,ze)}expandWildCardWithParamsAgainstRouteUsingRedirect(B,$,L,Y){const _e=this.applyRedirects.applyRedirectCommands([],L.redirectTo,{});return L.redirectTo.startsWith("/")?al(_e):this.applyRedirects.lineralizeSegments(L,_e).pipe((0,yt.z)(ze=>{const we=new Lr(ze,{});return this.processSegment(B,$,we,ze,Y,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(B,$,L,Y,_e,ze){const{matched:we,consumedSegments:Rn,remainingSegments:mr,positionalParamSegments:oi}=F($,Y,_e);if(!we)return Ns($);const Nr=this.applyRedirects.applyRedirectCommands(Rn,Y.redirectTo,oi);return Y.redirectTo.startsWith("/")?al(Nr):this.applyRedirects.lineralizeSegments(Y,Nr).pipe((0,yt.z)(Mi=>this.processSegment(B,L,$,Mi.concat(mr),ze,!1)))}matchSegmentAgainstRoute(B,$,L,Y,_e,ze){let we;if("**"===L.path){const Rn=Y.length>0?er(Y).parameters:{},mr=new xi(Y,Rn,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,es(L),Jo(L),L.component??L._loadedComponent??null,L,Go(L));we=(0,ot.of)({snapshot:mr,consumedSegments:[],remainingSegments:[]}),$.children={}}else we=M($,L,Y,B).pipe((0,Yt.U)(({matched:Rn,consumedSegments:mr,remainingSegments:oi,parameters:Nr})=>Rn?{snapshot:new xi(mr,Nr,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,es(L),Jo(L),L.component??L._loadedComponent??null,L,Go(L)),consumedSegments:mr,remainingSegments:oi}:null));return we.pipe((0,_n.w)(Rn=>null===Rn?Ns($):this.getChildConfig(B=L._injector??B,L,Y).pipe((0,_n.w)(({routes:mr})=>{const oi=L._loadedInjector??B,{snapshot:Nr,consumedSegments:Mi,remainingSegments:Da}=Rn,{segmentGroup:oc,slicedSegments:Bl}=G($,Mi,Da,mr);if(0===Bl.length&&oc.hasChildren())return this.processChildren(oi,mr,oc).pipe((0,Yt.U)(Ka=>null===Ka?null:[new ro(Nr,Ka)]));if(0===mr.length&&0===Bl.length)return(0,ot.of)([new ro(Nr,[])]);const sc=Jo(L)===_e;return this.processSegment(oi,mr,oc,Bl,sc?Ot:_e,!0).pipe((0,Yt.U)(Ka=>[new ro(Nr,Ka)]))}))))}getChildConfig(B,$,L){return $.children?(0,ot.of)({routes:$.children,injector:B}):$.loadChildren?void 0!==$._loadedRoutes?(0,ot.of)({routes:$._loadedRoutes,injector:$._loadedInjector}):function ws(R,B,$,L){const Y=B.canLoad;if(void 0===Y||0===Y.length)return(0,ot.of)(!0);const _e=Y.map(ze=>{const we=Hs(ze,R);return kr(function K(R){return R&&bs(R.canLoad)}(we)?we.canLoad(B,$):R.runInContext(()=>we(B,$)))});return(0,ot.of)(_e).pipe(Q(),Gs())}(B,$,L).pipe((0,yt.z)(Y=>Y?this.configLoader.loadChildren(B,$).pipe((0,an.b)(_e=>{$._loadedRoutes=_e.routes,$._loadedInjector=_e.injector})):function Ya(R){return et(Bo(!1,3))}())):(0,ot.of)({routes:[],injector:B})}}function Jr(R){const B=R.value.routeConfig;return B&&""===B.path}function pi(R){const B=[],$=new Set;for(const L of R){if(!Jr(L)){B.push(L);continue}const Y=B.find(_e=>L.value.routeConfig===_e.value.routeConfig);void 0!==Y?(Y.children.push(...L.children),$.add(Y)):B.push(L)}for(const L of $){const Y=pi(L.children);B.push(new ro(L.value,Y))}return B.filter(L=>!$.has(L))}function es(R){return R.data||{}}function Go(R){return R.resolve||{}}function Cs(R){return"string"==typeof R.title||null===R.title}function k(R){return(0,_n.w)(B=>{const $=R(B);return $?(0,Ee.D)($).pipe((0,Yt.U)(()=>B)):(0,ot.of)(B)})}const X=new T.OlP("ROUTES");let Be=(()=>{var R;class B{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,T.f3M)(T.Sil)}loadComponent(L){if(this.componentLoaders.get(L))return this.componentLoaders.get(L);if(L._loadedComponent)return(0,ot.of)(L._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(L);const Y=kr(L.loadComponent()).pipe((0,Yt.U)(be),(0,an.b)(ze=>{this.onLoadEndListener&&this.onLoadEndListener(L),L._loadedComponent=ze}),(0,Qn.x)(()=>{this.componentLoaders.delete(L)})),_e=new Tt(Y,()=>new Ge.x).pipe(sn());return this.componentLoaders.set(L,_e),_e}loadChildren(L,Y){if(this.childrenLoaders.get(Y))return this.childrenLoaders.get(Y);if(Y._loadedRoutes)return(0,ot.of)({routes:Y._loadedRoutes,injector:Y._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(Y);const ze=this.loadModuleFactoryOrRoutes(Y.loadChildren).pipe((0,Yt.U)(Rn=>{this.onLoadEndListener&&this.onLoadEndListener(Y);let mr,oi;return Array.isArray(Rn)?oi=Rn:(mr=Rn.create(L).injector,oi=mr.get(X,[],T.XFs.Self|T.XFs.Optional).flat()),{routes:oi.map(ta),injector:mr}}),(0,Qn.x)(()=>{this.childrenLoaders.delete(Y)})),we=new Tt(ze,()=>new Ge.x).pipe(sn());return this.childrenLoaders.set(Y,we),we}loadModuleFactoryOrRoutes(L){return kr(L()).pipe((0,Yt.U)(be),(0,yt.z)(Y=>Y instanceof T.YKP||Array.isArray(Y)?(0,ot.of)(Y):(0,Ee.D)(this.compiler.compileModuleAsync(Y))))}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})();function be(R){return function W(R){return R&&"object"==typeof R&&"default"in R}(R)?R.default:R}let _t=(()=>{var R;class B{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ge.x,this.configLoader=(0,T.f3M)(Be),this.environmentInjector=(0,T.f3M)(T.lqb),this.urlSerializer=(0,T.f3M)(ii),this.rootContexts=(0,T.f3M)(Ki),this.inputBindingEnabled=null!==(0,T.f3M)(Rr,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,ot.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=_e=>this.events.next(new bn(_e)),this.configLoader.onLoadStartListener=_e=>this.events.next(new fn(_e))}complete(){this.transitions?.complete()}handleNavigationRequest(L){const Y=++this.navigationId;this.transitions?.next({...this.transitions.value,...L,id:Y})}setupNavigations(L){return this.transitions=new qe.X({id:0,currentUrlTree:L.currentUrlTree,currentRawUrl:L.currentUrlTree,extractedUrl:L.urlHandlingStrategy.extract(L.currentUrlTree),urlAfterRedirects:L.urlHandlingStrategy.extract(L.currentUrlTree),rawUrl:L.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ui,restoredState:null,currentSnapshot:L.routerState.snapshot,targetSnapshot:null,currentRouterState:L.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Nt.h)(Y=>0!==Y.id),(0,Yt.U)(Y=>({...Y,extractedUrl:L.urlHandlingStrategy.extract(Y.rawUrl)})),(0,_n.w)(Y=>{let _e=!1,ze=!1;return(0,ot.of)(Y).pipe((0,an.b)(we=>{this.currentNavigation={id:we.id,initialUrl:we.rawUrl,extractedUrl:we.extractedUrl,trigger:we.source,extras:we.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,_n.w)(we=>{const Rn=L.browserUrlTree.toString(),mr=!L.navigated||we.extractedUrl.toString()!==Rn||Rn!==L.currentUrlTree.toString();if(!mr&&"reload"!==(we.extras.onSameUrlNavigation??L.onSameUrlNavigation)){const Nr="";return this.events.next(new Br(we.id,L.serializeUrl(Y.rawUrl),Nr,0)),L.rawUrlTree=we.rawUrl,we.resolve(null),xt.E}if(L.urlHandlingStrategy.shouldProcessUrl(we.rawUrl))return kt(we.source)&&(L.browserUrlTree=we.extractedUrl),(0,ot.of)(we).pipe((0,_n.w)(Nr=>{const Mi=this.transitions?.getValue();return this.events.next(new so(Nr.id,this.urlSerializer.serialize(Nr.extractedUrl),Nr.source,Nr.restoredState)),Mi!==this.transitions?.getValue()?xt.E:Promise.resolve(Nr)}),function As(R,B,$,L,Y,_e){return(0,yt.z)(ze=>function ar(R,B,$,L,Y,_e,ze="emptyOnly"){return new Ei(R,B,$,L,Y,ze,_e).recognize()}(R,B,$,L,ze.extractedUrl,Y,_e).pipe((0,Yt.U)(({state:we,tree:Rn})=>({...ze,targetSnapshot:we,urlAfterRedirects:Rn}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,L.config,this.urlSerializer,L.paramsInheritanceStrategy),(0,an.b)(Nr=>{if(Y.targetSnapshot=Nr.targetSnapshot,Y.urlAfterRedirects=Nr.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Nr.urlAfterRedirects},"eager"===L.urlUpdateStrategy){if(!Nr.extras.skipLocationChange){const Da=L.urlHandlingStrategy.merge(Nr.urlAfterRedirects,Nr.rawUrl);L.setBrowserUrl(Da,Nr)}L.browserUrlTree=Nr.urlAfterRedirects}const Mi=new Oe(Nr.id,this.urlSerializer.serialize(Nr.extractedUrl),this.urlSerializer.serialize(Nr.urlAfterRedirects),Nr.targetSnapshot);this.events.next(Mi)}));if(mr&&L.urlHandlingStrategy.shouldProcessUrl(L.rawUrlTree)){const{id:Nr,extractedUrl:Mi,source:Da,restoredState:oc,extras:Bl}=we,sc=new so(Nr,this.urlSerializer.serialize(Mi),Da,oc);this.events.next(sc);const Ka=sa(0,this.rootComponentType).snapshot;return Y={...we,targetSnapshot:Ka,urlAfterRedirects:Mi,extras:{...Bl,skipLocationChange:!1,replaceUrl:!1}},(0,ot.of)(Y)}{const Nr="";return this.events.next(new Br(we.id,L.serializeUrl(Y.extractedUrl),Nr,1)),L.rawUrlTree=we.rawUrl,we.resolve(null),xt.E}}),(0,an.b)(we=>{const Rn=new pe(we.id,this.urlSerializer.serialize(we.extractedUrl),this.urlSerializer.serialize(we.urlAfterRedirects),we.targetSnapshot);this.events.next(Rn)}),(0,Yt.U)(we=>Y={...we,guards:Fs(we.targetSnapshot,we.currentSnapshot,this.rootContexts)}),function Z(R,B){return(0,yt.z)($=>{const{targetSnapshot:L,currentSnapshot:Y,guards:{canActivateChecks:_e,canDeactivateChecks:ze}}=$;return 0===ze.length&&0===_e.length?(0,ot.of)({...$,guardsResult:!0}):function ge(R,B,$,L){return(0,Ee.D)(R).pipe((0,yt.z)(Y=>function hs(R,B,$,L,Y){const _e=B&&B.routeConfig?B.routeConfig.canDeactivate:null;if(!_e||0===_e.length)return(0,ot.of)(!0);const ze=_e.map(we=>{const Rn=la(B)??Y,mr=Hs(we,Rn);return kr(function xe(R){return R&&bs(R.canDeactivate)}(mr)?mr.canDeactivate(R,B,$,L):Rn.runInContext(()=>mr(R,B,$,L))).pipe(Wt())});return(0,ot.of)(ze).pipe(Q())}(Y.component,Y.route,$,B,L)),Wt(Y=>!0!==Y,!0))}(ze,L,Y,R).pipe((0,yt.z)(we=>we&&function S(R){return"boolean"==typeof R}(we)?function te(R,B,$,L){return(0,Ee.D)(B).pipe((0,pr.b)(Y=>(0,nt.z)(function Zn(R,B){return null!==R&&B&&B(new pn(R)),(0,ot.of)(!0)}(Y.route.parent,L),function Fe(R,B){return null!==R&&B&&B(new lr(R)),(0,ot.of)(!0)}(Y.route,L),function qo(R,B,$){const L=B[B.length-1],_e=B.slice(0,B.length-1).reverse().map(ze=>function Eo(R){const B=R.routeConfig?R.routeConfig.canActivateChild:null;return B&&0!==B.length?{node:R,guards:B}:null}(ze)).filter(ze=>null!==ze).map(ze=>(0,wt.P)(()=>{const we=ze.guards.map(Rn=>{const mr=la(ze.node)??$,oi=Hs(Rn,mr);return kr(function ee(R){return R&&bs(R.canActivateChild)}(oi)?oi.canActivateChild(L,R):mr.runInContext(()=>oi(L,R))).pipe(Wt())});return(0,ot.of)(we).pipe(Q())}));return(0,ot.of)(_e).pipe(Q())}(R,Y.path,$),function Xr(R,B,$){const L=B.routeConfig?B.routeConfig.canActivate:null;if(!L||0===L.length)return(0,ot.of)(!0);const Y=L.map(_e=>(0,wt.P)(()=>{const ze=la(B)??$,we=Hs(_e,ze);return kr(function I(R){return R&&bs(R.canActivate)}(we)?we.canActivate(B,R):ze.runInContext(()=>we(B,R))).pipe(Wt())}));return(0,ot.of)(Y).pipe(Q())}(R,Y.route,$))),Wt(Y=>!0!==Y,!0))}(L,_e,R,B):(0,ot.of)(we)),(0,Yt.U)(we=>({...$,guardsResult:we})))})}(this.environmentInjector,we=>this.events.next(we)),(0,an.b)(we=>{if(Y.guardsResult=we.guardsResult,rt(we.guardsResult))throw $o(0,we.guardsResult);const Rn=new Se(we.id,this.urlSerializer.serialize(we.extractedUrl),this.urlSerializer.serialize(we.urlAfterRedirects),we.targetSnapshot,!!we.guardsResult);this.events.next(Rn)}),(0,Nt.h)(we=>!!we.guardsResult||(L.restoreHistory(we),this.cancelNavigationTransition(we,"",3),!1)),k(we=>{if(we.guards.canActivateChecks.length)return(0,ot.of)(we).pipe((0,an.b)(Rn=>{const mr=new bt(Rn.id,this.urlSerializer.serialize(Rn.extractedUrl),this.urlSerializer.serialize(Rn.urlAfterRedirects),Rn.targetSnapshot);this.events.next(mr)}),(0,_n.w)(Rn=>{let mr=!1;return(0,ot.of)(Rn).pipe(function ss(R,B){return(0,yt.z)($=>{const{targetSnapshot:L,guards:{canActivateChecks:Y}}=$;if(!Y.length)return(0,ot.of)($);let _e=0;return(0,Ee.D)(Y).pipe((0,pr.b)(ze=>function va(R,B,$,L){const Y=R.routeConfig,_e=R._resolve;return void 0!==Y?.title&&!Cs(Y)&&(_e[qt]=Y.title),function fa(R,B,$,L){const Y=function Es(R){return[...Object.keys(R),...Object.getOwnPropertySymbols(R)]}(R);if(0===Y.length)return(0,ot.of)({});const _e={};return(0,Ee.D)(Y).pipe((0,yt.z)(ze=>function Ds(R,B,$,L){const Y=la(B)??L,_e=Hs(R,Y);return kr(_e.resolve?_e.resolve(B,$):Y.runInContext(()=>_e(B,$)))}(R[ze],B,$,L).pipe(Wt(),(0,an.b)(we=>{_e[ze]=we}))),Rt(1),function un(R){return(0,Yt.U)(()=>R)}(_e),(0,Me.K)(ze=>Hi(ze)?xt.E:et(ze)))}(_e,R,B,L).pipe((0,Yt.U)(ze=>(R._resolvedData=ze,R.data=Fo(R,$).resolve,Y&&Cs(Y)&&(R.data[qt]=Y.title),null)))}(ze.route,L,R,B)),(0,an.b)(()=>_e++),Rt(1),(0,yt.z)(ze=>_e===Y.length?(0,ot.of)($):xt.E))})}(L.paramsInheritanceStrategy,this.environmentInjector),(0,an.b)({next:()=>mr=!0,complete:()=>{mr||(L.restoreHistory(Rn),this.cancelNavigationTransition(Rn,"",2))}}))}),(0,an.b)(Rn=>{const mr=new Pt(Rn.id,this.urlSerializer.serialize(Rn.extractedUrl),this.urlSerializer.serialize(Rn.urlAfterRedirects),Rn.targetSnapshot);this.events.next(mr)}))}),k(we=>{const Rn=mr=>{const oi=[];mr.routeConfig?.loadComponent&&!mr.routeConfig._loadedComponent&&oi.push(this.configLoader.loadComponent(mr.routeConfig).pipe((0,an.b)(Nr=>{mr.component=Nr}),(0,Yt.U)(()=>{})));for(const Nr of mr.children)oi.push(...Rn(Nr));return oi};return(0,Et.a)(Rn(we.targetSnapshot.root)).pipe(mn(),(0,De.q)(1))}),k(()=>this.afterPreactivation()),(0,Yt.U)(we=>{const Rn=function _s(R,B,$){const L=rs(R,B._root,$?$._root:void 0);return new wa(L,B)}(L.routeReuseStrategy,we.targetSnapshot,we.currentRouterState);return Y={...we,targetRouterState:Rn}}),(0,an.b)(we=>{L.currentUrlTree=we.urlAfterRedirects,L.rawUrlTree=L.urlHandlingStrategy.merge(we.urlAfterRedirects,we.rawUrl),L.routerState=we.targetRouterState,"deferred"===L.urlUpdateStrategy&&(we.extras.skipLocationChange||L.setBrowserUrl(L.rawUrlTree,we),L.browserUrlTree=we.urlAfterRedirects)}),((R,B,$,L)=>(0,Yt.U)(Y=>(new os(B,Y.targetRouterState,Y.currentRouterState,$,L).activate(R),Y)))(this.rootContexts,L.routeReuseStrategy,we=>this.events.next(we),this.inputBindingEnabled),(0,De.q)(1),(0,an.b)({next:we=>{_e=!0,this.lastSuccessfulNavigation=this.currentNavigation,L.navigated=!0,this.events.next(new yo(we.id,this.urlSerializer.serialize(we.extractedUrl),this.urlSerializer.serialize(L.currentUrlTree))),L.titleStrategy?.updateTitle(we.targetRouterState.snapshot),we.resolve(!0)},complete:()=>{_e=!0}}),(0,Qn.x)(()=>{_e||ze||this.cancelNavigationTransition(Y,"",1),this.currentNavigation?.id===Y.id&&(this.currentNavigation=null)}),(0,Me.K)(we=>{if(ze=!0,Xo(we)){Wr(we)||(L.navigated=!0,L.restoreHistory(Y,!0));const Rn=new Kn(Y.id,this.urlSerializer.serialize(Y.extractedUrl),we.message,we.cancellationCode);if(this.events.next(Rn),Wr(we)){const mr=L.urlHandlingStrategy.merge(we.url,L.rawUrlTree),oi={skipLocationChange:Y.extras.skipLocationChange,replaceUrl:"eager"===L.urlUpdateStrategy||kt(Y.source)};L.scheduleNavigation(mr,Ui,null,oi,{resolve:Y.resolve,reject:Y.reject,promise:Y.promise})}else Y.resolve(!1)}else{L.restoreHistory(Y,!0);const Rn=new le(Y.id,this.urlSerializer.serialize(Y.extractedUrl),we,Y.targetSnapshot??void 0);this.events.next(Rn);try{Y.resolve(L.errorHandler(we))}catch(mr){Y.reject(mr)}}return xt.E}))}))}cancelNavigationTransition(L,Y,_e){const ze=new Kn(L.id,this.urlSerializer.serialize(L.extractedUrl),Y,_e);this.events.next(ze),L.resolve(!1)}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})();function kt(R){return R!==Ui}let Ut=(()=>{var R;class B{buildTitle(L){let Y,_e=L.root;for(;void 0!==_e;)Y=this.getResolvedTitleForRoute(_e)??Y,_e=_e.children.find(ze=>ze.outlet===Ot);return Y}getResolvedTitleForRoute(L){return L.data[qt]}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:function(){return(0,T.f3M)(tr)},providedIn:"root"}),B})(),tr=(()=>{var R;class B extends Ut{constructor(L){super(),this.title=L}updateTitle(L){const Y=this.buildTitle(L);void 0!==Y&&this.title.setTitle(Y)}}return(R=B).\u0275fac=function(L){return new(L||R)(T.LFG(Mn.Dx))},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})(),_r=(()=>{var R;class B{}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:function(){return(0,T.f3M)(Kr)},providedIn:"root"}),B})();class ti{shouldDetach(B){return!1}store(B,$){}shouldAttach(B){return!1}retrieve(B){return null}shouldReuseRoute(B,$){return B.routeConfig===$.routeConfig}}let Kr=(()=>{var R;class B extends ti{}return(R=B).\u0275fac=function(){let $;return function(Y){return($||($=T.n5z(R)))(Y||R)}}(),R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})();const Pr=new T.OlP("",{providedIn:"root",factory:()=>({})});let Bi=(()=>{var R;class B{}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:function(){return(0,T.f3M)(ni)},providedIn:"root"}),B})(),ni=(()=>{var R;class B{shouldProcessUrl(L){return!0}extract(L){return L}merge(L,Y){return L}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})();var co=function(R){return R[R.COMPLETE=0]="COMPLETE",R[R.FAILED=1]="FAILED",R[R.REDIRECTING=2]="REDIRECTING",R}(co||{});function Ws(R,B){R.events.pipe((0,Nt.h)($=>$ instanceof yo||$ instanceof Kn||$ instanceof le||$ instanceof Br),(0,Yt.U)($=>$ instanceof yo||$ instanceof Br?co.COMPLETE:$ instanceof Kn&&(0===$.code||1===$.code)?co.REDIRECTING:co.FAILED),(0,Nt.h)($=>$!==co.REDIRECTING),(0,De.q)(1)).subscribe(()=>{B()})}function uo(R){throw R}function ho(R,B,$){return B.parse("/")}const Yi={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},zs={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ao=(()=>{var R;class B{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,T.f3M)(T.c2e),this.isNgZoneEnabled=!1,this.options=(0,T.f3M)(Pr,{optional:!0})||{},this.pendingTasks=(0,T.f3M)(T.HDt),this.errorHandler=this.options.errorHandler||uo,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||ho,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,T.f3M)(Bi),this.routeReuseStrategy=(0,T.f3M)(_r),this.titleStrategy=(0,T.f3M)(Ut),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,T.f3M)(X,{optional:!0})?.flat()??[],this.navigationTransitions=(0,T.f3M)(_t),this.urlSerializer=(0,T.f3M)(ii),this.location=(0,T.f3M)(Le.Ye),this.componentInputBindingEnabled=!!(0,T.f3M)(Rr,{optional:!0}),this.isNgZoneEnabled=(0,T.f3M)(T.R0b)instanceof T.R0b&&T.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new $i,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=sa(0,null),this.navigationTransitions.setupNavigations(this).subscribe(L=>{this.lastSuccessfulId=L.id,this.currentPageId=this.browserPageId??0},L=>{this.console.warn(`Unhandled Navigation Error: ${L}`)})}resetRootComponentType(L){this.routerState.root.component=L,this.navigationTransitions.rootComponentType=L}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const L=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ui,L)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(L=>{const Y="popstate"===L.type?"popstate":"hashchange";"popstate"===Y&&setTimeout(()=>{this.navigateToSyncWithBrowser(L.url,Y,L.state)},0)}))}navigateToSyncWithBrowser(L,Y,_e){const ze={replaceUrl:!0},we=_e?.navigationId?_e:null;if(_e){const mr={..._e};delete mr.navigationId,delete mr.\u0275routerPageId,0!==Object.keys(mr).length&&(ze.state=mr)}const Rn=this.parseUrl(L);this.scheduleNavigation(Rn,Y,we,ze)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(L){this.config=L.map(ta),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(L,Y={}){const{relativeTo:_e,queryParams:ze,fragment:we,queryParamsHandling:Rn,preserveFragment:mr}=Y,oi=mr?this.currentUrlTree.fragment:we;let Mi,Nr=null;switch(Rn){case"merge":Nr={...this.currentUrlTree.queryParams,...ze};break;case"preserve":Nr=this.currentUrlTree.queryParams;break;default:Nr=ze||null}null!==Nr&&(Nr=this.removeEmptyProps(Nr));try{Mi=tn(_e?_e.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof L[0]||!L[0].startsWith("/"))&&(L=[]),Mi=this.currentUrlTree.root}return Xt(Mi,L,Nr,oi??null)}navigateByUrl(L,Y={skipLocationChange:!1}){const _e=rt(L)?L:this.parseUrl(L),ze=this.urlHandlingStrategy.merge(_e,this.rawUrlTree);return this.scheduleNavigation(ze,Ui,null,Y)}navigate(L,Y={skipLocationChange:!1}){return function wc(R){for(let B=0;B<R.length;B++)if(null==R[B])throw new T.vHH(4008,!1)}(L),this.navigateByUrl(this.createUrlTree(L,Y),Y)}serializeUrl(L){return this.urlSerializer.serialize(L)}parseUrl(L){let Y;try{Y=this.urlSerializer.parse(L)}catch(_e){Y=this.malformedUriErrorHandler(_e,this.urlSerializer,L)}return Y}isActive(L,Y){let _e;if(_e=!0===Y?{...Yi}:!1===Y?{...zs}:Y,rt(L))return to(this.currentUrlTree,L,_e);const ze=this.parseUrl(L);return to(this.currentUrlTree,ze,_e)}removeEmptyProps(L){return Object.keys(L).reduce((Y,_e)=>{const ze=L[_e];return null!=ze&&(Y[_e]=ze),Y},{})}scheduleNavigation(L,Y,_e,ze,we){if(this.disposed)return Promise.resolve(!1);let Rn,mr,oi;we?(Rn=we.resolve,mr=we.reject,oi=we.promise):oi=new Promise((Mi,Da)=>{Rn=Mi,mr=Da});const Nr=this.pendingTasks.add();return Ws(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(Nr))}),this.navigationTransitions.handleNavigationRequest({source:Y,restoredState:_e,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:L,extras:ze,resolve:Rn,reject:mr,promise:oi,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),oi.catch(Mi=>Promise.reject(Mi))}setBrowserUrl(L,Y){const _e=this.urlSerializer.serialize(L);if(this.location.isCurrentPathEqualTo(_e)||Y.extras.replaceUrl){const we={...Y.extras.state,...this.generateNgRouterState(Y.id,this.browserPageId)};this.location.replaceState(_e,"",we)}else{const ze={...Y.extras.state,...this.generateNgRouterState(Y.id,(this.browserPageId??0)+1)};this.location.go(_e,"",ze)}}restoreHistory(L,Y=!1){if("computed"===this.canceledNavigationResolution){const ze=this.currentPageId-(this.browserPageId??this.currentPageId);0!==ze?this.location.historyGo(ze):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===ze&&(this.resetState(L),this.browserUrlTree=L.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(Y&&this.resetState(L),this.resetUrlToCurrentUrlTree())}resetState(L){this.routerState=L.currentRouterState,this.currentUrlTree=L.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,L.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(L,Y){return"computed"===this.canceledNavigationResolution?{navigationId:L,\u0275routerPageId:Y}:{navigationId:L}}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})(),pa=(()=>{var R;class B{constructor(L,Y,_e,ze,we,Rn){this.router=L,this.route=Y,this.tabIndexAttribute=_e,this.renderer=ze,this.el=we,this.locationStrategy=Rn,this.href=null,this.commands=null,this.onChanges=new Ge.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const mr=we.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===mr||"area"===mr,this.isAnchorElement?this.subscription=L.events.subscribe(oi=>{oi instanceof yo&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(L){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",L)}ngOnChanges(L){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(L){null!=L?(this.commands=Array.isArray(L)?L:[L],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(L,Y,_e,ze,we){return!!(null===this.urlTree||this.isAnchorElement&&(0!==L||Y||_e||ze||we||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const L=null===this.href?null:(0,T.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",L)}applyAttributeValue(L,Y){const _e=this.renderer,ze=this.el.nativeElement;null!==Y?_e.setAttribute(ze,L,Y):_e.removeAttribute(ze,L)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(R=B).\u0275fac=function(L){return new(L||R)(T.Y36(Ao),T.Y36(Ii),T.$8M("tabindex"),T.Y36(T.Qsj),T.Y36(T.SBq),T.Y36(Le.S$))},R.\u0275dir=T.lG2({type:R,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(L,Y){1&L&&T.NdJ("click",function(ze){return Y.onClick(ze.button,ze.ctrlKey,ze.shiftKey,ze.altKey,ze.metaKey)}),2&L&&T.uIk("target",Y.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",T.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",T.VuI],replaceUrl:["replaceUrl","replaceUrl",T.VuI],routerLink:"routerLink"},standalone:!0,features:[T.Xq5,T.TTD]}),B})();class Ec{}let Rl=(()=>{var R;class B{preload(L,Y){return Y().pipe((0,Me.K)(()=>(0,ot.of)(null)))}}return(R=B).\u0275fac=function(L){return new(L||R)},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})(),$s=(()=>{var R;class B{constructor(L,Y,_e,ze,we){this.router=L,this.injector=_e,this.preloadingStrategy=ze,this.loader=we}setUpPreloading(){this.subscription=this.router.events.pipe((0,Nt.h)(L=>L instanceof yo),(0,pr.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(L,Y){const _e=[];for(const ze of Y){ze.providers&&!ze._injector&&(ze._injector=(0,T.MMx)(ze.providers,L,`Route: ${ze.path}`));const we=ze._injector??L,Rn=ze._loadedInjector??we;(ze.loadChildren&&!ze._loadedRoutes&&void 0===ze.canLoad||ze.loadComponent&&!ze._loadedComponent)&&_e.push(this.preloadConfig(we,ze)),(ze.children||ze._loadedRoutes)&&_e.push(this.processRoutes(Rn,ze.children??ze._loadedRoutes))}return(0,Ee.D)(_e).pipe((0,ur.J)())}preloadConfig(L,Y){return this.preloadingStrategy.preload(Y,()=>{let _e;_e=Y.loadChildren&&void 0===Y.canLoad?this.loader.loadChildren(L,Y):(0,ot.of)(null);const ze=_e.pipe((0,yt.z)(we=>null===we?(0,ot.of)(void 0):(Y._loadedRoutes=we.routes,Y._loadedInjector=we.injector,this.processRoutes(we.injector??L,we.routes))));if(Y.loadComponent&&!Y._loadedComponent){const we=this.loader.loadComponent(Y);return(0,Ee.D)([ze,we]).pipe((0,ur.J)())}return ze})}}return(R=B).\u0275fac=function(L){return new(L||R)(T.LFG(Ao),T.LFG(T.Sil),T.LFG(T.lqb),T.LFG(Ec),T.LFG(Be))},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),B})();const ri=new T.OlP("");let Ol=(()=>{var R;class B{constructor(L,Y,_e,ze,we={}){this.urlSerializer=L,this.transitions=Y,this.viewportScroller=_e,this.zone=ze,this.options=we,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},we.scrollPositionRestoration=we.scrollPositionRestoration||"disabled",we.anchorScrolling=we.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(L=>{L instanceof so?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=L.navigationTrigger,this.restoredId=L.restoredState?L.restoredState.navigationId:0):L instanceof yo?(this.lastId=L.id,this.scheduleScrollEvent(L,this.urlSerializer.parse(L.urlAfterRedirects).fragment)):L instanceof Br&&0===L.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(L,this.urlSerializer.parse(L.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(L=>{L instanceof Zr&&(L.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(L.position):L.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(L.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(L,Y){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Zr(L,"popstate"===this.lastSource?this.store[this.restoredId]:null,Y))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(R=B).\u0275fac=function(L){T.$Z()},R.\u0275prov=T.Yz7({token:R,factory:R.\u0275fac}),B})();function $a(R,B){return{\u0275kind:R,\u0275providers:B}}function ru(){const R=(0,T.f3M)(T.zs3);return B=>{const $=R.get(T.z2F);if(B!==$.components[0])return;const L=R.get(Ao),Y=R.get(wl);1===R.get(rc)&&L.initialNavigation(),R.get(El,null,T.XFs.Optional)?.setUpPreloading(),R.get(ri,null,T.XFs.Optional)?.init(),L.resetRootComponentType($.componentTypes[0]),Y.closed||(Y.next(),Y.complete(),Y.unsubscribe())}}const wl=new T.OlP("",{factory:()=>new Ge.x}),rc=new T.OlP("",{providedIn:"root",factory:()=>1}),El=new T.OlP("");function Ll(R){return $a(0,[{provide:El,useExisting:$s},{provide:Ec,useExisting:R}])}const ic=new T.OlP("ROUTER_FORROOT_GUARD"),Au=[Le.Ye,{provide:ii,useClass:cs},Ao,Ki,{provide:Ii,useFactory:function nc(R){return R.routerState.root},deps:[Ao]},Be,[]];function fh(){return new T.PXZ("Router",Ao)}let ou=(()=>{var R;class B{constructor(L){}static forRoot(L,Y){return{ngModule:B,providers:[Au,[],{provide:X,multi:!0,useValue:L},{provide:ic,useFactory:fs,deps:[[Ao,new T.FiY,new T.tp0]]},{provide:Pr,useValue:Y||{}},Y?.useHash?{provide:Le.S$,useClass:Le.Do}:{provide:Le.S$,useClass:Le.b0},{provide:ri,useFactory:()=>{const R=(0,T.f3M)(Le.EM),B=(0,T.f3M)(T.R0b),$=(0,T.f3M)(Pr),L=(0,T.f3M)(_t),Y=(0,T.f3M)(ii);return $.scrollOffset&&R.setOffset($.scrollOffset),new Ol(Y,L,R,B,$)}},Y?.preloadingStrategy?Ll(Y.preloadingStrategy).\u0275providers:[],{provide:T.PXZ,multi:!0,useFactory:fh},Y?.initialNavigation?Xa(Y):[],Y?.bindToComponentInputs?$a(8,[qi,{provide:Rr,useExisting:qi}]).\u0275providers:[],[{provide:au,useFactory:ru},{provide:T.tb,multi:!0,useExisting:au}]]}}static forChild(L){return{ngModule:B,providers:[{provide:X,multi:!0,useValue:L}]}}}return(R=B).\u0275fac=function(L){return new(L||R)(T.LFG(ic,8))},R.\u0275mod=T.oAB({type:R}),R.\u0275inj=T.cJS({}),B})();function fs(R){return"guarded"}function Xa(R){return["disabled"===R.initialNavigation?$a(3,[{provide:T.ip1,multi:!0,useFactory:()=>{const B=(0,T.f3M)(Ao);return()=>{B.setUpLocationChangeListener()}}},{provide:rc,useValue:2}]).\u0275providers:[],"enabledBlocking"===R.initialNavigation?$a(2,[{provide:rc,useValue:0},{provide:T.ip1,multi:!0,deps:[T.zs3],useFactory:B=>{const $=B.get(Le.V_,Promise.resolve());return()=>$.then(()=>new Promise(L=>{const Y=B.get(Ao),_e=B.get(wl);Ws(Y,()=>{L(!0)}),B.get(_t).afterPreactivation=()=>(L(!0),_e.closed?(0,ot.of)(void 0):_e),Y.initialNavigation()}))}}]).\u0275providers:[]]}const au=new T.OlP("")},7852:(fr,en,oe)=>{"use strict";oe.d(en,{w:()=>qt,dr:()=>Ir,oU:()=>Lo,cs:()=>Ni,YG:()=>Gi,Sm:()=>ai,PM:()=>Pi,FN:()=>ii,Zi:()=>cs,tO:()=>je,Dq:()=>ae,wI:()=>Ye,W2:()=>dt,fr:()=>Ln,Gu:()=>Ze,gu:()=>Dt,pK:()=>qn,Ie:()=>gr,Q$:()=>Ke,q_:()=>tn,z0:()=>zn,fG:()=>br,jP:()=>Bo,Nd:()=>Ui,cJ:()=>so,GO:()=>yo,CK:()=>le,wd:()=>pn,ho:()=>lr,sr:()=>Ar,Pc:()=>ds,r4:()=>Hs,SH:()=>Io,YI:()=>js,QI:()=>Gn,j9:()=>Cr,yF:()=>os});var T=oe(5861),b=oe(9468),Lt=oe(95),l=oe(7582),Ee=oe(2438),ot=oe(8645),qe=oe(5619),Et=oe(2572),vt=oe(2096),tt=oe(3874),xt=(oe(6506),oe(8899),oe(5298),oe(8077),oe(7876)),Kt=oe(544),It=oe(1273),st=oe(8354),Tt=(oe(1767),oe(8946)),Yt=(oe(7643),oe(4587),oe(6953)),De=oe(2181),ft=oe(4664),Nt=oe(3997),yt=oe(6814);const hn=xt.i,Wt=["*"],cn=S=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(S):"function"==typeof requestAnimationFrame?requestAnimationFrame(S):setTimeout(S);let un=(()=>{class S{constructor(I,ee){this.injector=I,this.el=ee,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(I){this.el.nativeElement.value=this.lastValue=I,Qn(this.el)}handleValueChange(I,ee){I===this.el.nativeElement&&(ee!==this.lastValue&&(this.lastValue=ee,this.onChange(ee)),Qn(this.el))}_handleBlurEvent(I){I===this.el.nativeElement&&(this.onTouched(),Qn(this.el))}registerOnChange(I){this.onChange=I}registerOnTouched(I){this.onTouched=I}setDisabledState(I){this.el.nativeElement.disabled=I}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let I;try{I=this.injector.get(Lt.a5)}catch{}if(!I)return;I.statusChanges&&(this.statusChanges=I.statusChanges.subscribe(()=>Qn(this.el)));const ee=I.control;ee&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Tn=>{if(typeof ee[Tn]<"u"){const hr=ee[Tn].bind(ee);ee[Tn]=(...dr)=>{hr(...dr),Qn(this.el)}}})}}return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.zs3),b.Y36(b.SBq))},S.\u0275dir=b.lG2({type:S,hostBindings:function(I,ee){1&I&&b.NdJ("ionBlur",function(Tn){return ee._handleBlurEvent(Tn.target)})}}),S})();const Qn=S=>{cn(()=>{const K=S.nativeElement,I=null!=K.value&&K.value.toString().length>0,ee=ur(K);Mn(K,ee);const xe=K.closest("ion-item");xe&&Mn(xe,I?[...ee,"item-has-value"]:ee)})},ur=S=>{const K=S.classList,I=[];for(let ee=0;ee<K.length;ee++){const xe=K.item(ee);null!==xe&&Ot(xe,"ng-")&&I.push(`ion-${xe.substring(3)}`)}return I},Mn=(S,K)=>{const I=S.classList;I.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),I.add(...K)},Ot=(S,K)=>S.substring(0,K.length)===K;let qt=(()=>{class S extends un{constructor(I,ee){super(I,ee)}writeValue(I){this.el.nativeElement.checked=this.lastValue=I,Qn(this.el)}_handleIonChange(I){this.handleValueChange(I,I.checked)}}return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.zs3),b.Y36(b.SBq))},S.\u0275dir=b.lG2({type:S,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(I,ee){1&I&&b.NdJ("ionChange",function(Tn){return ee._handleIonChange(Tn.target)})},features:[b._Bn([{provide:Lt.JU,useExisting:S,multi:!0}]),b.qOj]}),S})(),Gn=(()=>{class S extends un{constructor(I,ee){super(I,ee)}_handleChangeEvent(I){this.handleValueChange(I,I.value)}}return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.zs3),b.Y36(b.SBq))},S.\u0275dir=b.lG2({type:S,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(I,ee){1&I&&b.NdJ("ionChange",function(Tn){return ee._handleChangeEvent(Tn.target)})},features:[b._Bn([{provide:Lt.JU,useExisting:S,multi:!0}]),b.qOj]}),S})(),Cr=(()=>{class S extends un{constructor(I,ee){super(I,ee)}_handleInputEvent(I){this.handleValueChange(I,I.value)}}return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.zs3),b.Y36(b.SBq))},S.\u0275dir=b.lG2({type:S,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(I,ee){1&I&&b.NdJ("ionInput",function(Tn){return ee._handleInputEvent(Tn.target)})},features:[b._Bn([{provide:Lt.JU,useExisting:S,multi:!0}]),b.qOj]}),S})();const Wn=(S,K)=>{const I=S.prototype;K.forEach(ee=>{Object.defineProperty(I,ee,{get(){return this.el[ee]},set(xe){this.z.runOutsideAngular(()=>this.el[ee]=xe)}})})},Dr=(S,K)=>{const I=S.prototype;K.forEach(ee=>{I[ee]=function(){const xe=arguments;return this.z.runOutsideAngular(()=>this.el[ee].apply(this.el,xe))}})},er=(S,K,I)=>{I.forEach(ee=>S[ee]=(0,Ee.R)(K,ee))};function An(S){return function(I){const{defineCustomElementFn:ee,inputs:xe,methods:Tn}=S;return void 0!==ee&&ee(),xe&&Wn(I,xe),Tn&&Dr(I,Tn),I}}let Ir=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-app"]],ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({})],S),S})(),Lo=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],S),S})(),Gi=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement,er(this,this.el,["ionFocus","ionBlur"])}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],S),S})(),ai=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["collapse"]})],S),S})(),Pi=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],S),S})(),ii=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["mode"]})],S),S})(),cs=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","mode","translucent"]})],S),S})(),je=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-card-subtitle"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","mode"]})],S),S})(),ae=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-card-title"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","mode"]})],S),S})(),Ye=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],S),S})(),dt=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement,er(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],S),S})(),Ln=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["collapse","mode","translucent"]})],S),S})(),Ze=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["collapse","mode","translucent"]})],S),S})(),Dt=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],S),S})(),qn=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement,er(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",shape:"shape",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","shape","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],S),S})(),gr=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],S),S})(),Ke=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","mode","position"]})],S),S})(),tn=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],S),S})(),zn=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement,er(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],S),S})(),br=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["autoHide","color","disabled","menu","mode","type"]})],S),S})(),Ui=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-row"]],ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({})],S),S})(),so=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement,er(this,this.el,["ionChange"])}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],S),S})(),yo=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["disabled","layout","mode","type","value"]})],S),S})(),le=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-skeleton-text"]],inputs:{animated:"animated"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["animated"]})],S),S})(),pn=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","size"]})],S),S})(),lr=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement,er(this,this.el,["ionChange","ionFocus","ionBlur"])}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",justify:"justify",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",name:"name",value:"value"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["checked","color","disabled","enableOnOffLabels","justify","labelPlacement","legacy","mode","name","value"]})],S),S})(),Ar=(()=>{let S=class{constructor(I,ee,xe){this.z=xe,I.detach(),this.el=ee.nativeElement}};return S.\u0275fac=function(I){return new(I||S)(b.Y36(b.sBO),b.Y36(b.SBq),b.Y36(b.R0b))},S.\u0275cmp=b.Xpm({type:S,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Wt,decls:1,vars:0,template:function(I,ee){1&I&&(b.F$t(),b.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,l.gn)([An({inputs:["color","mode"]})],S),S})(),Zr=(()=>{class S{get(I,ee){const xe=zo();return xe?xe.get(I,ee):null}getBoolean(I,ee){const xe=zo();return!!xe&&xe.getBoolean(I,ee)}getNumber(I,ee){const xe=zo();return xe?xe.getNumber(I,ee):0}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const ji=new b.OlP("USERCONFIG"),zo=()=>{if(typeof window<"u"){const S=window.Ionic;if(S?.config)return S.config}return null};let Ki=(()=>{class S{constructor(I,ee){this.doc=I,this.backButton=new ot.x,this.keyboardDidShow=new ot.x,this.keyboardDidHide=new ot.x,this.pause=new ot.x,this.resume=new ot.x,this.resize=new ot.x,ee.run(()=>{let xe;this.win=I.defaultView,this.backButton.subscribeWithPriority=function(Tn,hr){return this.subscribe(dr=>dr.register(Tn,Hi=>ee.run(()=>hr(Hi))))},ao(this.pause,I,"pause"),ao(this.resume,I,"resume"),ao(this.backButton,I,"ionBackButton"),ao(this.resize,this.win,"resize"),ao(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),ao(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Tn=>{xe=Tn}),this.win?.cordova?I.addEventListener("deviceready",()=>{xe("cordova")},{once:!0}):xe("dom")})}is(I){return(0,xt.a)(this.win,I)}platforms(){return(0,xt.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(I){return Zo(this.win.location.href,I)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia?.("(orientation: portrait)").matches}testUserAgent(I){const ee=this.win.navigator;return!!(ee?.userAgent&&ee.userAgent.indexOf(I)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return S.\u0275fac=function(I){return new(I||S)(b.LFG(yt.K0),b.LFG(b.R0b))},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const Zo=(S,K)=>{K=K.replace(/[[\]\\]/g,"\\$&");const ee=new RegExp("[\\?&]"+K+"=([^&#]*)").exec(S);return ee?decodeURIComponent(ee[1].replace(/\+/g," ")):null},ao=(S,K,I)=>{K&&K.addEventListener(I,ee=>{const xe=ee?.detail;S.next(xe)})};let Io=(()=>{class S{constructor(I,ee,xe,Tn){this.location=ee,this.serializer=xe,this.router=Tn,this.direction=Si,this.animated=wa,this.guessDirection="forward",this.lastNavId=-1,Tn&&Tn.events.subscribe(hr=>{if(hr instanceof tt.OD){const dr=hr.restoredState?hr.restoredState.navigationId:hr.id;this.guessDirection=dr<this.lastNavId?"back":"forward",this.guessAnimation=hr.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?hr.id:dr}}),I.backButton.subscribeWithPriority(0,hr=>{this.pop(),hr()})}navigateForward(I,ee={}){return this.setDirection("forward",ee.animated,ee.animationDirection,ee.animation),this.navigate(I,ee)}navigateBack(I,ee={}){return this.setDirection("back",ee.animated,ee.animationDirection,ee.animation),this.navigate(I,ee)}navigateRoot(I,ee={}){return this.setDirection("root",ee.animated,ee.animationDirection,ee.animation),this.navigate(I,ee)}back(I={animated:!0,animationDirection:"back"}){return this.setDirection("back",I.animated,I.animationDirection,I.animation),this.location.back()}pop(){var I=this;return(0,T.Z)(function*(){let ee=I.topOutlet;for(;ee;){if(yield ee.pop())return!0;ee=ee.parentOutlet}return!1})()}setDirection(I,ee,xe,Tn){this.direction=I,this.animated=ro(I,ee,xe),this.animationBuilder=Tn}setTopOutlet(I){this.topOutlet=I}consumeTransition(){let ee,I="root";const xe=this.animationBuilder;return"auto"===this.direction?(I=this.guessDirection,ee=this.guessAnimation):(ee=this.animated,I=this.direction),this.direction=Si,this.animated=wa,this.animationBuilder=void 0,{direction:I,animation:ee,animationBuilder:xe}}navigate(I,ee){if(Array.isArray(I))return this.router.navigate(I,ee);{const xe=this.serializer.parse(I.toString());return void 0!==ee.queryParams&&(xe.queryParams={...ee.queryParams}),void 0!==ee.fragment&&(xe.fragment=ee.fragment),this.router.navigateByUrl(xe,ee)}}}return S.\u0275fac=function(I){return new(I||S)(b.LFG(Ki),b.LFG(yt.Ye),b.LFG(tt.Hx),b.LFG(tt.F0,8))},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const ro=(S,K,I)=>{if(!1!==K){if(void 0!==I)return I;if("forward"===S||"back"===S)return S;if("root"===S&&!0===K)return"forward"}},Si="auto",wa=void 0;class sa{constructor(K={}){this.data=K}get(K){return this.data[K]}}let Gr=(()=>{class S{constructor(){this.zone=(0,b.f3M)(b.R0b),this.applicationRef=(0,b.f3M)(b.z2F)}create(I,ee,xe){return new Ii(I,ee,this.applicationRef,this.zone,xe)}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac}),S})();class Ii{constructor(K,I,ee,xe,Tn){this.environmentInjector=K,this.injector=I,this.applicationRef=ee,this.zone=xe,this.elementReferenceKey=Tn,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(K,I,ee,xe){return this.zone.run(()=>new Promise(Tn=>{const hr={...ee};void 0!==this.elementReferenceKey&&(hr[this.elementReferenceKey]=K),Tn(Fo(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,K,I,hr,xe,this.elementReferenceKey))}))}removeViewFromDom(K,I){return this.zone.run(()=>new Promise(ee=>{const xe=this.elRefMap.get(I);if(xe){xe.destroy(),this.elRefMap.delete(I);const Tn=this.elEventsMap.get(I);Tn&&(Tn(),this.elEventsMap.delete(I))}ee()}))}}const Fo=(S,K,I,ee,xe,Tn,hr,dr,Hi,lo,Q)=>{const Z=b.zs3.create({providers:Qs(Hi),parent:I}),ge=(0,b.LMc)(dr,{environmentInjector:K,elementInjector:Z}),te=ge.instance,Fe=ge.location.nativeElement;if(Hi&&(Q&&void 0!==te[Q]&&console.error(`[Ionic Error]: ${Q} is a reserved property when using ${hr.tagName.toLowerCase()}. Rename or remove the "${Q}" property from ${dr.name}.`),Object.assign(te,Hi)),lo)for(const Xr of lo)Fe.classList.add(Xr);const Zn=xi(S,te,Fe);return hr.appendChild(Fe),ee.attachView(ge.hostView),xe.set(Fe,ge),Tn.set(Fe,Zn),Fe},gs=[st.L,st.a,st.b,st.c,st.d],xi=(S,K,I)=>S.run(()=>{const ee=gs.filter(xe=>"function"==typeof K[xe]).map(xe=>{const Tn=hr=>K[xe](hr.detail);return I.addEventListener(xe,Tn),()=>I.removeEventListener(xe,Tn)});return()=>ee.forEach(xe=>xe())}),Js=new b.OlP("NavParamsToken"),Qs=S=>[{provide:Js,useValue:S},{provide:sa,useFactory:Is,deps:[Js]}],Is=S=>new sa(S),ha=(S,K)=>((S=S.filter(I=>I.stackId!==K.stackId)).push(K),S),Rr=(S,K)=>{const I=S.createUrlTree(["."],{relativeTo:K});return S.serializeUrl(I)},_s=(S,K)=>{if(!S)return;const I=rs(K);for(let ee=0;ee<I.length;ee++){if(ee>=S.length)return I[ee];if(I[ee]!==S[ee])return}},rs=S=>S.split("/").map(K=>K.trim()).filter(K=>""!==K),io=S=>{S&&(S.ref.destroy(),S.unlistenEvents())};class Wo{constructor(K,I,ee,xe,Tn,hr){this.containerEl=I,this.router=ee,this.navCtrl=xe,this.zone=Tn,this.location=hr,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==K?rs(K):void 0}createView(K,I){const ee=Rr(this.router,I),xe=K?.location?.nativeElement,Tn=xi(this.zone,K.instance,xe);return{id:this.nextId++,stackId:_s(this.tabsPrefix,ee),unlistenEvents:Tn,element:xe,ref:K,url:ee}}getExistingView(K){const I=Rr(this.router,K),ee=this.views.find(xe=>xe.url===I);return ee&&ee.ref.changeDetectorRef.reattach(),ee}setActive(K){const I=this.navCtrl.consumeTransition();let{direction:ee,animation:xe,animationBuilder:Tn}=I;const hr=this.activeView,dr=((S,K)=>!K||S.stackId!==K.stackId)(K,hr);dr&&(ee="back",xe=void 0);const Hi=this.views.slice();let lo;const Q=this.router;Q.getCurrentNavigation?lo=Q.getCurrentNavigation():Q.navigations?.value&&(lo=Q.navigations.value),lo?.extras?.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const Z=this.views.includes(K),ge=this.insertView(K,ee);Z||K.ref.changeDetectorRef.detectChanges();const te=K.animationBuilder;return void 0===Tn&&"back"===ee&&!dr&&void 0!==te&&(Tn=te),hr&&(hr.animationBuilder=Tn),this.zone.runOutsideAngular(()=>this.wait(()=>(hr&&hr.ref.changeDetectorRef.detach(),K.ref.changeDetectorRef.reattach(),this.transition(K,hr,xe,this.canGoBack(1),!1,Tn).then(()=>no(K,ge,Hi,this.location,this.zone)).then(()=>({enteringView:K,direction:ee,animation:xe,tabSwitch:dr})))))}canGoBack(K,I=this.getActiveStackId()){return this.getStack(I).length>K}pop(K,I=this.getActiveStackId()){return this.zone.run(()=>{const ee=this.getStack(I);if(ee.length<=K)return Promise.resolve(!1);const xe=ee[ee.length-K-1];let Tn=xe.url;const hr=xe.savedData;if(hr){const Hi=hr.get("primary");Hi?.route?._routerState?.snapshot.url&&(Tn=Hi.route._routerState.snapshot.url)}const{animationBuilder:dr}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Tn,{...xe.savedExtras,animation:dr}).then(()=>!0)})}startBackTransition(){const K=this.activeView;if(K){const I=this.getStack(K.stackId),ee=I[I.length-2],xe=ee.animationBuilder;return this.wait(()=>this.transition(ee,K,"back",this.canGoBack(2),!0,xe))}return Promise.resolve()}endBackTransition(K){K?(this.skipTransition=!0,this.pop(1)):this.activeView&&$o(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(K){const I=this.getStack(K);return I.length>0?I[I.length-1]:void 0}getRootUrl(K){const I=this.getStack(K);return I.length>0?I[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(io),this.activeView=void 0,this.views=[]}getStack(K){return this.views.filter(I=>I.stackId===K)}insertView(K,I){return this.activeView=K,this.views=((S,K,I)=>"root"===I?ha(S,K):"forward"===I?((S,K)=>(S.indexOf(K)>=0?S=S.filter(ee=>ee.stackId!==K.stackId||ee.id<=K.id):S.push(K),S))(S,K):((S,K)=>S.indexOf(K)>=0?S.filter(ee=>ee.stackId!==K.stackId||ee.id<=K.id):ha(S,K))(S,K))(this.views,K,I),this.views.slice()}transition(K,I,ee,xe,Tn,hr){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(I===K)return Promise.resolve(!1);const dr=K?K.element:void 0,Hi=I?I.element:void 0,lo=this.containerEl;return dr&&dr!==Hi&&(dr.classList.add("ion-page"),dr.classList.add("ion-page-invisible"),dr.parentElement!==lo&&lo.appendChild(dr),lo.commit)?lo.commit(dr,Hi,{duration:void 0===ee?0:void 0,direction:ee,showGoBack:xe,progressAnimation:Tn,animationBuilder:hr}):Promise.resolve(!1)}wait(K){var I=this;return(0,T.Z)(function*(){void 0!==I.runningTask&&(yield I.runningTask,I.runningTask=void 0);const ee=I.runningTask=K();return ee.finally(()=>I.runningTask=void 0),ee})()}}const no=(S,K,I,ee,xe)=>"function"==typeof requestAnimationFrame?new Promise(Tn=>{requestAnimationFrame(()=>{$o(S,K,I,ee,xe),Tn()})}):Promise.resolve(),$o=(S,K,I,ee,xe)=>{xe.run(()=>I.filter(Tn=>!K.includes(Tn)).forEach(io)),K.forEach(Tn=>{const dr=ee.path().split("?")[0].split("#")[0];if(Tn!==S&&Tn.url!==dr){const Hi=Tn.element;Hi.setAttribute("aria-hidden","true"),Hi.classList.add("ion-page-hidden"),Tn.ref.changeDetectorRef.detach()}})};let Bo=(()=>{class S{constructor(I,ee,xe,Tn,hr,dr,Hi,lo){this.parentOutlet=lo,this.activatedView=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new qe.X(null),this.activated=null,this._activatedRoute=null,this.name=tt.eC,this.stackEvents=new b.vpe,this.activateEvents=new b.vpe,this.deactivateEvents=new b.vpe,this.parentContexts=(0,b.f3M)(tt.y6),this.location=(0,b.f3M)(b.s_b),this.environmentInjector=(0,b.f3M)(b.lqb),this.inputBinder=(0,b.f3M)(Xo,{optional:!0}),this.supportsBindingToComponentInputs=!0,this.config=(0,b.f3M)(Zr),this.navCtrl=(0,b.f3M)(Io),this.nativeEl=Tn.nativeElement,this.name=I||tt.eC,this.tabsPrefix="true"===ee?Rr(hr,Hi):void 0,this.stackCtrl=new Wo(this.tabsPrefix,this.nativeEl,hr,this.navCtrl,dr,xe),this.parentContexts.onChildOutletCreated(this.name,this)}get activatedComponentRef(){return this.activated}set animation(I){this.nativeEl.animation=I}set animated(I){this.nativeEl.animated=I}set swipeGesture(I){this._swipeGesture=I,this.nativeEl.swipeHandler=I?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ee=>this.stackCtrl.endBackTransition(ee)}:void 0}ngOnDestroy(){this.stackCtrl.destroy(),this.inputBinder?.unsubscribeFromRouteData(this)}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const I=this.getContext();I?.route&&this.activateWith(I.route,I.injector)}new Promise(I=>(0,Kt.c)(this.nativeEl,I)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(I,ee){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ee=this.getContext();this.activatedView.savedData=new Map(ee.children.contexts);const xe=this.activatedView.savedData.get("primary");if(xe&&ee.route&&(xe.route={...ee.route}),this.activatedView.savedExtras={},ee.route){const Tn=ee.route.snapshot;this.activatedView.savedExtras.queryParams=Tn.queryParams,this.activatedView.savedExtras.fragment=Tn.fragment}}const I=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(I)}}activateWith(I,ee){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=I;let xe,Tn=this.stackCtrl.getExistingView(I);if(Tn){xe=this.activated=Tn.ref;const hr=Tn.savedData;hr&&(this.getContext().children.contexts=hr),this.updateActivatedRouteProxy(xe.instance,I)}else{const hr=I._futureSnapshot,dr=this.parentContexts.getOrCreateContext(this.name).children,Hi=new qe.X(null),lo=this.createActivatedRouteProxy(Hi,I),Q=new Wr(lo,dr,this.location.injector);xe=this.activated=this.location.createComponent(hr.routeConfig.component??hr.component,{index:this.location.length,injector:Q,environmentInjector:ee??this.environmentInjector}),Hi.next(xe.instance),Tn=this.stackCtrl.createView(this.activated,I),this.proxyMap.set(xe.instance,lo),this.currentActivatedRoute$.next({component:xe.instance,activatedRoute:I})}this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activatedView=Tn,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(Tn).then(hr=>{this.activateEvents.emit(xe.instance),this.stackEvents.emit(hr)})}canGoBack(I=1,ee){return this.stackCtrl.canGoBack(I,ee)}pop(I=1,ee){return this.stackCtrl.pop(I,ee)}getLastUrl(I){const ee=this.stackCtrl.getLastUrl(I);return ee?ee.url:void 0}getLastRouteView(I){return this.stackCtrl.getLastUrl(I)}getRootView(I){return this.stackCtrl.getRootUrl(I)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(I,ee){const xe=new tt.gz;return xe._futureSnapshot=ee._futureSnapshot,xe._routerState=ee._routerState,xe.snapshot=ee.snapshot,xe.outlet=ee.outlet,xe.component=ee.component,xe._paramMap=this.proxyObservable(I,"paramMap"),xe._queryParamMap=this.proxyObservable(I,"queryParamMap"),xe.url=this.proxyObservable(I,"url"),xe.params=this.proxyObservable(I,"params"),xe.queryParams=this.proxyObservable(I,"queryParams"),xe.fragment=this.proxyObservable(I,"fragment"),xe.data=this.proxyObservable(I,"data"),xe}proxyObservable(I,ee){return I.pipe((0,De.h)(xe=>!!xe),(0,ft.w)(xe=>this.currentActivatedRoute$.pipe((0,De.h)(Tn=>null!==Tn&&Tn.component===xe),(0,ft.w)(Tn=>Tn&&Tn.activatedRoute[ee]),(0,Nt.x)())))}updateActivatedRouteProxy(I,ee){const xe=this.proxyMap.get(I);if(!xe)throw new Error("Could not find activated route proxy for view");xe._futureSnapshot=ee._futureSnapshot,xe._routerState=ee._routerState,xe.snapshot=ee.snapshot,xe.outlet=ee.outlet,xe.component=ee.component,this.currentActivatedRoute$.next({component:I,activatedRoute:ee})}}return S.\u0275fac=function(I){return new(I||S)(b.$8M("name"),b.$8M("tabs"),b.Y36(yt.Ye),b.Y36(b.SBq),b.Y36(tt.F0),b.Y36(b.R0b),b.Y36(tt.gz),b.Y36(S,12))},S.\u0275dir=b.lG2({type:S,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",name:"name"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),S})();class Wr{constructor(K,I,ee){this.route=K,this.childContexts=I,this.parent=ee}get(K,I){return K===tt.gz?this.route:K===tt.y6?this.childContexts:this.parent.get(K,I)}}const Xo=new b.OlP("");let Ko=(()=>{class S{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(I){this.unsubscribeFromRouteData(I),this.subscribeToRouteData(I)}unsubscribeFromRouteData(I){this.outletDataSubscriptions.get(I)?.unsubscribe(),this.outletDataSubscriptions.delete(I)}subscribeToRouteData(I){const{activatedRoute:ee}=I,xe=(0,Et.a)([ee.queryParams,ee.params,ee.data]).pipe((0,ft.w)(([Tn,hr,dr],Hi)=>(dr={...Tn,...hr,...dr},0===Hi?(0,vt.of)(dr):Promise.resolve(dr)))).subscribe(Tn=>{if(!I.isActivated||!I.activatedComponentRef||I.activatedRoute!==ee||null===ee.component)return void this.unsubscribeFromRouteData(I);const hr=(0,b.qFp)(ee.component);if(hr)for(const{templateName:dr}of hr.inputs)I.activatedComponentRef.setInput(dr,Tn[dr]);else this.unsubscribeFromRouteData(I)});this.outletDataSubscriptions.set(I,xe)}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac}),S})(),Ni=(()=>{class S{constructor(I,ee,xe){this.routerOutlet=I,this.navCtrl=ee,this.config=xe}onClick(I){const ee=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet?.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),I.preventDefault()):null!=ee&&(this.navCtrl.navigateBack(ee,{animation:this.routerAnimation}),I.preventDefault())}}return S.\u0275fac=function(I){return new(I||S)(b.Y36(Bo,8),b.Y36(Io),b.Y36(Zr))},S.\u0275dir=b.lG2({type:S,selectors:[["ion-back-button"]],hostBindings:function(I,ee){1&I&&b.NdJ("click",function(Tn){return ee.onClick(Tn)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),S})(),js=(()=>{class S{constructor(I,ee,xe,Tn,hr){this.locationStrategy=I,this.navCtrl=ee,this.elementRef=xe,this.router=Tn,this.routerLink=hr,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const I=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=I}}onClick(I){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),I.preventDefault()}}return S.\u0275fac=function(I){return new(I||S)(b.Y36(yt.S$),b.Y36(Io),b.Y36(b.SBq),b.Y36(tt.F0),b.Y36(tt.rH,8))},S.\u0275dir=b.lG2({type:S,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(I,ee){1&I&&b.NdJ("click",function(Tn){return ee.onClick(Tn)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[b.TTD]}),S})();class ci{constructor(K){this.ctrl=K}create(K){return this.ctrl.create(K||{})}dismiss(K,I,ee){return this.ctrl.dismiss(K,I,ee)}getTop(){return this.ctrl.getTop()}}let Qo=(()=>{class S extends ci{constructor(){super(Tt.m),this.angularDelegate=(0,b.f3M)(Gr),this.injector=(0,b.f3M)(b.zs3),this.environmentInjector=(0,b.f3M)(b.lqb)}create(I){return super.create({...I,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac}),S})(),xs=(()=>{class S extends ci{constructor(){super(Tt.c),this.angularDelegate=(0,b.f3M)(Gr),this.injector=(0,b.f3M)(b.zs3),this.environmentInjector=(0,b.f3M)(b.lqb)}create(I){return super.create({...I,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac}),S})(),os=(()=>{class S extends ci{constructor(){super(Tt.t)}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275prov=b.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();class Hs{shouldDetach(K){return!1}shouldAttach(K){return!1}store(K,I){}retrieve(K){return null}shouldReuseRoute(K,I){if(K.routeConfig!==I.routeConfig)return!1;const ee=K.params,xe=I.params,Tn=Object.keys(ee),hr=Object.keys(xe);if(Tn.length!==hr.length)return!1;for(const dr of Tn)if(xe[dr]!==ee[dr])return!1;return!0}}const xo=(S,K,I)=>()=>{if(K.defaultView&&typeof window<"u"){(0,It.s)({...S,_zoneGate:Tn=>I.run(Tn)});const xe="__zone_symbol__addEventListener"in K.body?"__zone_symbol__addEventListener":"addEventListener";return function mn(){var S=[];if(typeof window<"u"){var K=window;(!K.customElements||K.Element&&(!K.Element.prototype.closest||!K.Element.prototype.matches||!K.Element.prototype.remove||!K.Element.prototype.getRootNode))&&S.push(oe.e(6748).then(oe.t.bind(oe,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||K.NodeList&&!K.NodeList.prototype.forEach||!K.fetch||!function(){try{var ee=new URL("b","http://a");return ee.pathname="c%20d","http://a/c%20d"===ee.href&&ee.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&S.push(oe.e(2214).then(oe.t.bind(oe,2668,23)))}return Promise.all(S)}().then(()=>((S,K)=>typeof window>"u"?Promise.resolve():(0,Yt.p)().then(()=>(hn(),(0,Yt.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"activated":[32]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"legacy":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),K))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:cn,jmp:Tn=>I.runOutsideAngular(Tn),ael(Tn,hr,dr,Hi){Tn[xe](hr,dr,Hi)},rel(Tn,hr,dr,Hi){Tn.removeEventListener(hr,dr,Hi)}}))}};let ds=(()=>{class S{static forRoot(I){return{ngModule:S,providers:[{provide:ji,useValue:I},{provide:b.ip1,useFactory:xo,multi:!0,deps:[ji,yt.K0,b.R0b]},{provide:Xo,useFactory:bs,deps:[tt.F0]}]}}}return S.\u0275fac=function(I){return new(I||S)},S.\u0275mod=b.oAB({type:S}),S.\u0275inj=b.cJS({providers:[Gr,Qo,xs],imports:[yt.ez]}),S})();function bs(S){return S?.componentInputBindingEnabled?new Ko:null}},5861:(fr,en,oe)=>{"use strict";function T(Lt,l,Ee,ot,qe,Et,vt){try{var tt=Lt[Et](vt),nt=tt.value}catch(wt){return void Ee(wt)}tt.done?l(nt):Promise.resolve(nt).then(ot,qe)}function b(Lt){return function(){var l=this,Ee=arguments;return new Promise(function(ot,qe){var Et=Lt.apply(l,Ee);function vt(nt){T(Et,ot,qe,vt,tt,"next",nt)}function tt(nt){T(Et,ot,qe,vt,tt,"throw",nt)}vt(void 0)})}}oe.d(en,{Z:()=>b})},7582:(fr,en,oe)=>{"use strict";function Ee(Me,Ue,at,Rt){var Qn,cn=arguments.length,un=cn<3?Ue:null===Rt?Rt=Object.getOwnPropertyDescriptor(Ue,at):Rt;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)un=Reflect.decorate(Me,Ue,at,Rt);else for(var ur=Me.length-1;ur>=0;ur--)(Qn=Me[ur])&&(un=(cn<3?Qn(un):cn>3?Qn(Ue,at,un):Qn(Ue,at))||un);return cn>3&&un&&Object.defineProperty(Ue,at,un),un}function wt(Me,Ue,at,Rt){return new(at||(at=Promise))(function(un,Qn){function ur(qt){try{Ot(Rt.next(qt))}catch($t){Qn($t)}}function Mn(qt){try{Ot(Rt.throw(qt))}catch($t){Qn($t)}}function Ot(qt){qt.done?un(qt.value):function cn(un){return un instanceof at?un:new at(function(Qn){Qn(un)})}(qt.value).then(ur,Mn)}Ot((Rt=Rt.apply(Me,Ue||[])).next())})}function Ge(Me){return this instanceof Ge?(this.v=Me,this):new Ge(Me)}function Le(Me,Ue,at){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var cn,Rt=at.apply(Me,Ue||[]),un=[];return cn={},Qn("next"),Qn("throw"),Qn("return"),cn[Symbol.asyncIterator]=function(){return this},cn;function Qn(vn){Rt[vn]&&(cn[vn]=function(Gn){return new Promise(function(Cr,Wn){un.push([vn,Gn,Cr,Wn])>1||ur(vn,Gn)})})}function ur(vn,Gn){try{!function Mn(vn){vn.value instanceof Ge?Promise.resolve(vn.value.v).then(Ot,qt):$t(un[0][2],vn)}(Rt[vn](Gn))}catch(Cr){$t(un[0][3],Cr)}}function Ot(vn){ur("next",vn)}function qt(vn){ur("throw",vn)}function $t(vn,Gn){vn(Gn),un.shift(),un.length&&ur(un[0][0],un[0][1])}}function _n(Me){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var at,Ue=Me[Symbol.asyncIterator];return Ue?Ue.call(Me):(Me=function Kt(Me){var Ue="function"==typeof Symbol&&Symbol.iterator,at=Ue&&Me[Ue],Rt=0;if(at)return at.call(Me);if(Me&&"number"==typeof Me.length)return{next:function(){return Me&&Rt>=Me.length&&(Me=void 0),{value:Me&&Me[Rt++],done:!Me}}};throw new TypeError(Ue?"Object is not iterable.":"Symbol.iterator is not defined.")}(Me),at={},Rt("next"),Rt("throw"),Rt("return"),at[Symbol.asyncIterator]=function(){return this},at);function Rt(un){at[un]=Me[un]&&function(Qn){return new Promise(function(ur,Mn){!function cn(un,Qn,ur,Mn){Promise.resolve(Mn).then(function(Ot){un({value:Ot,done:ur})},Qn)}(ur,Mn,(Qn=Me[un](Qn)).done,Qn.value)})}}}oe.d(en,{FC:()=>Le,KL:()=>_n,gn:()=>Ee,mG:()=>wt,qq:()=>Ge}),"function"==typeof SuppressedError&&SuppressedError}},fr=>{fr(fr.s=5048)}]);