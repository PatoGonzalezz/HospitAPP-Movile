(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{9058:(Hn,It,X)=>{"use strict";X.d(It,{BH:()=>ct,G6:()=>zt,L:()=>Ke,LL:()=>nn,P0:()=>Pt,Pz:()=>Ie,Sg:()=>St,UG:()=>Wt,ZB:()=>Ze,ZR:()=>jt,aH:()=>Ce,b$:()=>Qt,eu:()=>ze,hl:()=>Se,jU:()=>Nt,m9:()=>pn,ne:()=>mr,pd:()=>wr,q4:()=>Ot,r3:()=>nr,ru:()=>an,tV:()=>ye,uI:()=>gt,vZ:()=>yn,w1:()=>Jn,xO:()=>ui,xb:()=>Xn,z$:()=>Ye,zd:()=>hr});const l=function(ke){const se=[];let ce=0;for(let Fe=0;Fe<ke.length;Fe++){let fe=ke.charCodeAt(Fe);fe<128?se[ce++]=fe:fe<2048?(se[ce++]=fe>>6|192,se[ce++]=63&fe|128):55296==(64512&fe)&&Fe+1<ke.length&&56320==(64512&ke.charCodeAt(Fe+1))?(fe=65536+((1023&fe)<<10)+(1023&ke.charCodeAt(++Fe)),se[ce++]=fe>>18|240,se[ce++]=fe>>12&63|128,se[ce++]=fe>>6&63|128,se[ce++]=63&fe|128):(se[ce++]=fe>>12|224,se[ce++]=fe>>6&63|128,se[ce++]=63&fe|128)}return se},Ne={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ke,se){if(!Array.isArray(ke))throw Error("encodeByteArray takes an array as a parameter");this.init_();const ce=se?this.byteToCharMapWebSafe_:this.byteToCharMap_,Fe=[];for(let fe=0;fe<ke.length;fe+=3){const nt=ke[fe],Ft=fe+1<ke.length,mn=Ft?ke[fe+1]:0,Zn=fe+2<ke.length,Gn=Zn?ke[fe+2]:0;let Hr=(15&mn)<<2|Gn>>6,ti=63&Gn;Zn||(ti=64,Ft||(Hr=64)),Fe.push(ce[nt>>2],ce[(3&nt)<<4|mn>>4],ce[Hr],ce[ti])}return Fe.join("")},encodeString(ke,se){return this.HAS_NATIVE_SUPPORT&&!se?btoa(ke):this.encodeByteArray(l(ke),se)},decodeString(ke,se){return this.HAS_NATIVE_SUPPORT&&!se?atob(ke):function(ke){const se=[];let ce=0,Fe=0;for(;ce<ke.length;){const fe=ke[ce++];if(fe<128)se[Fe++]=String.fromCharCode(fe);else if(fe>191&&fe<224){const nt=ke[ce++];se[Fe++]=String.fromCharCode((31&fe)<<6|63&nt)}else if(fe>239&&fe<365){const Zn=((7&fe)<<18|(63&ke[ce++])<<12|(63&ke[ce++])<<6|63&ke[ce++])-65536;se[Fe++]=String.fromCharCode(55296+(Zn>>10)),se[Fe++]=String.fromCharCode(56320+(1023&Zn))}else{const nt=ke[ce++],Ft=ke[ce++];se[Fe++]=String.fromCharCode((15&fe)<<12|(63&nt)<<6|63&Ft)}}return se.join("")}(this.decodeStringToByteArray(ke,se))},decodeStringToByteArray(ke,se){this.init_();const ce=se?this.charToByteMapWebSafe_:this.charToByteMap_,Fe=[];for(let fe=0;fe<ke.length;){const nt=ce[ke.charAt(fe++)],mn=fe<ke.length?ce[ke.charAt(fe)]:0;++fe;const Gn=fe<ke.length?ce[ke.charAt(fe)]:64;++fe;const yr=fe<ke.length?ce[ke.charAt(fe)]:64;if(++fe,null==nt||null==mn||null==Gn||null==yr)throw new Le;Fe.push(nt<<2|mn>>4),64!==Gn&&(Fe.push(mn<<4&240|Gn>>2),64!==yr&&Fe.push(Gn<<6&192|yr))}return Fe},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ke=0;ke<this.ENCODED_VALS.length;ke++)this.byteToCharMap_[ke]=this.ENCODED_VALS.charAt(ke),this.charToByteMap_[this.byteToCharMap_[ke]]=ke,this.byteToCharMapWebSafe_[ke]=this.ENCODED_VALS_WEBSAFE.charAt(ke),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ke]]=ke,ke>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ke)]=ke,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ke)]=ke)}}};class Le extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ke=function(ke){return function(ke){const se=l(ke);return Ne.encodeByteArray(se,!0)}(ke).replace(/\./g,"")},ye=function(ke){try{return Ne.decodeString(ke,!0)}catch(se){console.error("base64Decode failed: ",se)}return null};function Ze(ke,se){if(!(se instanceof Object))return se;switch(se.constructor){case Date:return new Date(se.getTime());case Object:void 0===ke&&(ke={});break;case Array:ke=[];break;default:return se}for(const ce in se)!se.hasOwnProperty(ce)||!Qe(ce)||(ke[ce]=Ze(ke[ce],se[ce]));return ke}function Qe(ke){return"__proto__"!==ke}const et=()=>{try{return function ot(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ke=process.env.__FIREBASE_DEFAULTS__;return ke?JSON.parse(ke):void 0})()||(()=>{if(typeof document>"u")return;let ke;try{ke=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const se=ke&&ye(ke[1]);return se&&JSON.parse(se)})()}catch(ke){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ke}`)}},Ot=ke=>{var se,ce;return null===(ce=null===(se=et())||void 0===se?void 0:se.emulatorHosts)||void 0===ce?void 0:ce[ke]},Pt=ke=>{const se=Ot(ke);if(!se)return;const ce=se.lastIndexOf(":");if(ce<=0||ce+1===se.length)throw new Error(`Invalid host ${se} with no separate hostname and port!`);const Fe=parseInt(se.substring(ce+1),10);return"["===se[0]?[se.substring(1,ce-1),Fe]:[se.substring(0,ce),Fe]},Ce=()=>{var ke;return null===(ke=et())||void 0===ke?void 0:ke.config},Ie=ke=>{var se;return null===(se=et())||void 0===se?void 0:se[`_${ke}`]};class ct{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((se,ce)=>{this.resolve=se,this.reject=ce})}wrapCallback(se){return(ce,Fe)=>{ce?this.reject(ce):this.resolve(Fe),"function"==typeof se&&(this.promise.catch(()=>{}),1===se.length?se(ce):se(ce,Fe))}}}function St(ke,se){if(ke.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Fe=se||"demo-project",fe=ke.iat||0,nt=ke.sub||ke.user_id;if(!nt)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Ft=Object.assign({iss:`https://securetoken.google.com/${Fe}`,aud:Fe,iat:fe,exp:fe+3600,auth_time:fe,sub:nt,user_id:nt,firebase:{sign_in_provider:"custom",identities:{}}},ke);return[Ke(JSON.stringify({alg:"none",type:"JWT"})),Ke(JSON.stringify(Ft)),""].join(".")}function Ye(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function gt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ye())}function Wt(){var ke;const se=null===(ke=et())||void 0===ke?void 0:ke.forceEnvironment;if("node"===se)return!0;if("browser"===se)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Nt(){return"object"==typeof self&&self.self===self}function an(){const ke="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ke&&void 0!==ke.id}function Qt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Jn(){const ke=Ye();return ke.indexOf("MSIE ")>=0||ke.indexOf("Trident/")>=0}function zt(){return!Wt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Se(){try{return"object"==typeof indexedDB}catch{return!1}}function ze(){return new Promise((ke,se)=>{try{let ce=!0;const Fe="validate-browser-context-for-indexeddb-analytics-module",fe=self.indexedDB.open(Fe);fe.onsuccess=()=>{fe.result.close(),ce||self.indexedDB.deleteDatabase(Fe),ke(!0)},fe.onupgradeneeded=()=>{ce=!1},fe.onerror=()=>{var nt;se((null===(nt=fe.error)||void 0===nt?void 0:nt.message)||"")}}catch(ce){se(ce)}})}class jt extends Error{constructor(se,ce,Fe){super(ce),this.code=se,this.customData=Fe,this.name="FirebaseError",Object.setPrototypeOf(this,jt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nn.prototype.create)}}class nn{constructor(se,ce,Fe){this.service=se,this.serviceName=ce,this.errors=Fe}create(se,...ce){const Fe=ce[0]||{},fe=`${this.service}/${se}`,nt=this.errors[se],Ft=nt?function ln(ke,se){return ke.replace(_n,(ce,Fe)=>{const fe=se[Fe];return null!=fe?String(fe):`<${Fe}?>`})}(nt,Fe):"Error";return new jt(fe,`${this.serviceName}: ${Ft} (${fe}).`,Fe)}}const _n=/\{\$([^}]+)}/g;function nr(ke,se){return Object.prototype.hasOwnProperty.call(ke,se)}function Xn(ke){for(const se in ke)if(Object.prototype.hasOwnProperty.call(ke,se))return!1;return!0}function yn(ke,se){if(ke===se)return!0;const ce=Object.keys(ke),Fe=Object.keys(se);for(const fe of ce){if(!Fe.includes(fe))return!1;const nt=ke[fe],Ft=se[fe];if(Jr(nt)&&Jr(Ft)){if(!yn(nt,Ft))return!1}else if(nt!==Ft)return!1}for(const fe of Fe)if(!ce.includes(fe))return!1;return!0}function Jr(ke){return null!==ke&&"object"==typeof ke}function ui(ke){const se=[];for(const[ce,Fe]of Object.entries(ke))Array.isArray(Fe)?Fe.forEach(fe=>{se.push(encodeURIComponent(ce)+"="+encodeURIComponent(fe))}):se.push(encodeURIComponent(ce)+"="+encodeURIComponent(Fe));return se.length?"&"+se.join("&"):""}function hr(ke){const se={};return ke.replace(/^\?/,"").split("&").forEach(Fe=>{if(Fe){const[fe,nt]=Fe.split("=");se[decodeURIComponent(fe)]=decodeURIComponent(nt)}}),se}function wr(ke){const se=ke.indexOf("?");if(!se)return"";const ce=ke.indexOf("#",se);return ke.substring(se,ce>0?ce:void 0)}function mr(ke,se){const ce=new Di(ke,se);return ce.subscribe.bind(ce)}class Di{constructor(se,ce){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ce,this.task.then(()=>{se(this)}).catch(Fe=>{this.error(Fe)})}next(se){this.forEachObserver(ce=>{ce.next(se)})}error(se){this.forEachObserver(ce=>{ce.error(se)}),this.close(se)}complete(){this.forEachObserver(se=>{se.complete()}),this.close()}subscribe(se,ce,Fe){let fe;if(void 0===se&&void 0===ce&&void 0===Fe)throw new Error("Missing Observer.");fe=function Tr(ke,se){if("object"!=typeof ke||null===ke)return!1;for(const ce of se)if(ce in ke&&"function"==typeof ke[ce])return!0;return!1}(se,["next","error","complete"])?se:{next:se,error:ce,complete:Fe},void 0===fe.next&&(fe.next=Mi),void 0===fe.error&&(fe.error=Mi),void 0===fe.complete&&(fe.complete=Mi);const nt=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?fe.error(this.finalError):fe.complete()}catch{}}),this.observers.push(fe),nt}unsubscribeOne(se){void 0===this.observers||void 0===this.observers[se]||(delete this.observers[se],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(se){if(!this.finalized)for(let ce=0;ce<this.observers.length;ce++)this.sendOne(ce,se)}sendOne(se,ce){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[se])try{ce(this.observers[se])}catch(Fe){typeof console<"u"&&console.error&&console.error(Fe)}})}close(se){this.finalized||(this.finalized=!0,void 0!==se&&(this.finalError=se),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Mi(){}function pn(ke){return ke&&ke._delegate?ke._delegate:ke}},6506:(Hn,It,X)=>{"use strict";X.d(It,{c:()=>xt});var M=X(7643),w=X(544);let lt;const _e=pt=>pt.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ne=pt=>(void 0===lt&&(lt=void 0===pt.style.animationName&&void 0!==pt.style.webkitAnimationName?"-webkit-":""),lt),Le=(pt,et,Ot)=>{const Pt=et.startsWith("animation")?Ne(pt):"";pt.style.setProperty(Pt+et,Ot)},tt=(pt,et)=>{const Ot=et.startsWith("animation")?Ne(pt):"";pt.style.removeProperty(Ot+et)},Ae=[],mt=(pt=[],et)=>{if(void 0!==et){const Ot=Array.isArray(et)?et:[et];return[...pt,...Ot]}return pt},xt=pt=>{let et,Ot,Pt,Ce,Ie,ct,Nt,Se,ze,ut,Dt,_n,bn,St=[],Ye=[],gt=[],Wt=!1,an={},Qt=[],Vt=[],Jn={},Zt=0,Pn=!1,zt=!1,jt=!0,nn=!1,ln=!0,rn=!1;const Jt=pt,en=[],dn=[],Fn=[],pr=[],nr=[],gr=[],Xn=[],Lr=[],yn=[],Jr=[],Li="function"==typeof AnimationEffect||void 0!==M.w&&"function"==typeof M.w.AnimationEffect,ui="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Li,wr=()=>Jr,Tr=(we,Be)=>((Be?.oneTimeCallback?dn:en).push({c:we,o:Be}),bn),yi=()=>{if(ui)Jr.forEach(we=>{we.cancel()}),Jr.length=0;else{const we=Fn.slice();(0,w.r)(()=>{we.forEach(Be=>{tt(Be,"animation-name"),tt(Be,"animation-duration"),tt(Be,"animation-timing-function"),tt(Be,"animation-iteration-count"),tt(Be,"animation-delay"),tt(Be,"animation-play-state"),tt(Be,"animation-fill-mode"),tt(Be,"animation-direction")})})}},Yr=()=>{nr.forEach(we=>{we?.parentNode&&we.parentNode.removeChild(we)}),nr.length=0},Bt=()=>void 0!==Ie?Ie:Nt?Nt.getFill():"both",pn=()=>void 0!==ze?ze:void 0!==ct?ct:Nt?Nt.getDirection():"normal",ke=()=>Pn?"linear":void 0!==Pt?Pt:Nt?Nt.getEasing():"linear",se=()=>zt?0:void 0!==ut?ut:void 0!==Ot?Ot:Nt?Nt.getDuration():0,ce=()=>void 0!==Ce?Ce:Nt?Nt.getIterations():1,Fe=()=>void 0!==Dt?Dt:void 0!==et?et:Nt?Nt.getDelay():0,wn=()=>{0!==Zt&&(Zt--,0===Zt&&((()=>{ii(),Lr.forEach(cn=>cn()),yn.forEach(cn=>cn());const we=jt?1:0,Be=Qt,Ct=Vt,kt=Jn;Fn.forEach(cn=>{const gn=cn.classList;Be.forEach(un=>gn.add(un)),Ct.forEach(un=>gn.remove(un));for(const un in kt)kt.hasOwnProperty(un)&&Le(cn,un,kt[un])}),en.forEach(cn=>cn.c(we,bn)),dn.forEach(cn=>cn.c(we,bn)),dn.length=0,ln=!0,jt&&(nn=!0),jt=!0})(),Nt&&Nt.animationFinish()))},cr=(we=!0)=>{Yr();const Be=(pt=>(pt.forEach(et=>{for(const Ot in et)if(et.hasOwnProperty(Ot)){const Pt=et[Ot];if("easing"===Ot)et["animation-timing-function"]=Pt,delete et[Ot];else{const Ce=_e(Ot);Ce!==Ot&&(et[Ce]=Pt,delete et[Ot])}}}),pt))(St);Fn.forEach(Ct=>{if(Be.length>0){const kt=((pt=[])=>pt.map(et=>{const Ot=et.offset,Pt=[];for(const Ce in et)et.hasOwnProperty(Ce)&&"offset"!==Ce&&Pt.push(`${Ce}: ${et[Ce]};`);return`${100*Ot}% { ${Pt.join(" ")} }`}).join(" "))(Be);_n=void 0!==pt?pt:(pt=>{let et=Ae.indexOf(pt);return et<0&&(et=Ae.push(pt)-1),`ion-animation-${et}`})(kt);const cn=((pt,et,Ot)=>{var Pt;const Ce=(pt=>{const et=void 0!==pt.getRootNode?pt.getRootNode():pt;return et.head||et})(Ot),Ie=Ne(Ot),ct=Ce.querySelector("#"+pt);if(ct)return ct;const St=(null!==(Pt=Ot.ownerDocument)&&void 0!==Pt?Pt:document).createElement("style");return St.id=pt,St.textContent=`@${Ie}keyframes ${pt} { ${et} } @${Ie}keyframes ${pt}-alt { ${et} }`,Ce.appendChild(St),St})(_n,kt,Ct);nr.push(cn),Le(Ct,"animation-duration",`${se()}ms`),Le(Ct,"animation-timing-function",ke()),Le(Ct,"animation-delay",`${Fe()}ms`),Le(Ct,"animation-fill-mode",Bt()),Le(Ct,"animation-direction",pn());const gn=ce()===1/0?"infinite":ce().toString();Le(Ct,"animation-iteration-count",gn),Le(Ct,"animation-play-state","paused"),we&&Le(Ct,"animation-name",`${cn.id}-alt`),(0,w.r)(()=>{Le(Ct,"animation-name",cn.id||null)})}})},Rr=(we=!0)=>{(()=>{gr.forEach(kt=>kt()),Xn.forEach(kt=>kt());const we=Ye,Be=gt,Ct=an;Fn.forEach(kt=>{const cn=kt.classList;we.forEach(gn=>cn.add(gn)),Be.forEach(gn=>cn.remove(gn));for(const gn in Ct)Ct.hasOwnProperty(gn)&&Le(kt,gn,Ct[gn])})})(),St.length>0&&(ui?(Fn.forEach(we=>{const Be=we.animate(St,{id:Jt,delay:Fe(),duration:se(),easing:ke(),iterations:ce(),fill:Bt(),direction:pn()});Be.pause(),Jr.push(Be)}),Jr.length>0&&(Jr[0].onfinish=()=>{wn()})):cr(we)),Wt=!0},Fr=we=>{if(we=Math.min(Math.max(we,0),.9999),ui)Jr.forEach(Be=>{Be.currentTime=Be.effect.getComputedTiming().delay+se()*we,Be.pause()});else{const Be=`-${se()*we}ms`;Fn.forEach(Ct=>{St.length>0&&(Le(Ct,"animation-delay",Be),Le(Ct,"animation-play-state","paused"))})}},di=we=>{Jr.forEach(Be=>{Be.effect.updateTiming({delay:Fe(),duration:se(),easing:ke(),iterations:ce(),fill:Bt(),direction:pn()})}),void 0!==we&&Fr(we)},Ci=(we=!0,Be)=>{(0,w.r)(()=>{Fn.forEach(Ct=>{Le(Ct,"animation-name",_n||null),Le(Ct,"animation-duration",`${se()}ms`),Le(Ct,"animation-timing-function",ke()),Le(Ct,"animation-delay",void 0!==Be?`-${Be*se()}ms`:`${Fe()}ms`),Le(Ct,"animation-fill-mode",Bt()||null),Le(Ct,"animation-direction",pn()||null);const kt=ce()===1/0?"infinite":ce().toString();Le(Ct,"animation-iteration-count",kt),we&&Le(Ct,"animation-name",`${_n}-alt`),(0,w.r)(()=>{Le(Ct,"animation-name",_n||null)})})})},Qr=(we=!1,Be=!0,Ct)=>(we&&pr.forEach(kt=>{kt.update(we,Be,Ct)}),ui?di(Ct):Ci(Be,Ct),bn),on=()=>{Wt&&(ui?Jr.forEach(we=>{we.pause()}):Fn.forEach(we=>{Le(we,"animation-play-state","paused")}),rn=!0)},bi=()=>{Se=void 0,wn()},ii=()=>{Se&&clearTimeout(Se)},No=we=>new Promise(Be=>{we?.sync&&(zt=!0,Tr(()=>zt=!1,{oneTimeCallback:!0})),Wt||Rr(),nn&&(ui?(Fr(0),di()):Ci(),nn=!1),ln&&(Zt=pr.length+1,ln=!1),Tr(()=>Be(),{oneTimeCallback:!0}),pr.forEach(Ct=>{Ct.play()}),ui?(Jr.forEach(we=>{we.play()}),(0===St.length||0===Fn.length)&&wn()):(()=>{if(ii(),(0,w.r)(()=>{Fn.forEach(we=>{St.length>0&&Le(we,"animation-play-state","running")})}),0===St.length||0===Fn.length)wn();else{const we=Fe()||0,Be=se()||0,Ct=ce()||1;isFinite(Ct)&&(Se=setTimeout(bi,we+Be*Ct+100)),((pt,et)=>{let Ot;const Pt={passive:!0},Ie=ct=>{pt===ct.target&&(Ot&&Ot(),ii(),(0,w.r)(()=>{Fn.forEach(we=>{tt(we,"animation-duration"),tt(we,"animation-delay"),tt(we,"animation-play-state")}),(0,w.r)(wn)}))};pt&&(pt.addEventListener("webkitAnimationEnd",Ie,Pt),pt.addEventListener("animationend",Ie,Pt),Ot=()=>{pt.removeEventListener("webkitAnimationEnd",Ie,Pt),pt.removeEventListener("animationend",Ie,Pt)})})(Fn[0])}})(),rn=!1}),Dr=(we,Be)=>{const Ct=St[0];return void 0===Ct||void 0!==Ct.offset&&0!==Ct.offset?St=[{offset:0,[we]:Be},...St]:Ct[we]=Be,bn};return bn={parentAnimation:Nt,elements:Fn,childAnimations:pr,id:Jt,animationFinish:wn,from:Dr,to:(we,Be)=>{const Ct=St[St.length-1];return void 0===Ct||void 0!==Ct.offset&&1!==Ct.offset?St=[...St,{offset:1,[we]:Be}]:Ct[we]=Be,bn},fromTo:(we,Be,Ct)=>Dr(we,Be).to(we,Ct),parent:we=>(Nt=we,bn),play:No,pause:()=>(pr.forEach(we=>{we.pause()}),on(),bn),stop:()=>{pr.forEach(we=>{we.stop()}),Wt&&(yi(),Wt=!1),Pn=!1,zt=!1,ln=!0,ze=void 0,ut=void 0,Dt=void 0,Zt=0,nn=!1,jt=!0,rn=!1},destroy:we=>(pr.forEach(Be=>{Be.destroy(we)}),(we=>{yi(),we&&Yr()})(we),Fn.length=0,pr.length=0,St.length=0,en.length=0,dn.length=0,Wt=!1,ln=!0,bn),keyframes:we=>{const Be=St!==we;return St=we,Be&&(we=>{ui?wr().forEach(Be=>{if(Be.effect.setKeyframes)Be.effect.setKeyframes(we);else{const Ct=new KeyframeEffect(Be.effect.target,we,Be.effect.getTiming());Be.effect=Ct}}):cr()})(St),bn},addAnimation:we=>{if(null!=we)if(Array.isArray(we))for(const Be of we)Be.parent(bn),pr.push(Be);else we.parent(bn),pr.push(we);return bn},addElement:we=>{if(null!=we)if(1===we.nodeType)Fn.push(we);else if(we.length>=0)for(let Be=0;Be<we.length;Be++)Fn.push(we[Be]);else console.error("Invalid addElement value");return bn},update:Qr,fill:we=>(Ie=we,Qr(!0),bn),direction:we=>(ct=we,Qr(!0),bn),iterations:we=>(Ce=we,Qr(!0),bn),duration:we=>(!ui&&0===we&&(we=1),Ot=we,Qr(!0),bn),easing:we=>(Pt=we,Qr(!0),bn),delay:we=>(et=we,Qr(!0),bn),getWebAnimations:wr,getKeyframes:()=>St,getFill:Bt,getDirection:pn,getDelay:Fe,getIterations:ce,getEasing:ke,getDuration:se,afterAddRead:we=>(Lr.push(we),bn),afterAddWrite:we=>(yn.push(we),bn),afterClearStyles:(we=[])=>{for(const Be of we)Jn[Be]="";return bn},afterStyles:(we={})=>(Jn=we,bn),afterRemoveClass:we=>(Vt=mt(Vt,we),bn),afterAddClass:we=>(Qt=mt(Qt,we),bn),beforeAddRead:we=>(gr.push(we),bn),beforeAddWrite:we=>(Xn.push(we),bn),beforeClearStyles:(we=[])=>{for(const Be of we)an[Be]="";return bn},beforeStyles:(we={})=>(an=we,bn),beforeRemoveClass:we=>(gt=mt(gt,we),bn),beforeAddClass:we=>(Ye=mt(Ye,we),bn),onFinish:Tr,isRunning:()=>0!==Zt&&!rn,progressStart:(we=!1,Be)=>(pr.forEach(Ct=>{Ct.progressStart(we,Be)}),on(),Pn=we,Wt||Rr(),Qr(!1,!0,Be),bn),progressStep:we=>(pr.forEach(Be=>{Be.progressStep(we)}),Fr(we),bn),progressEnd:(we,Be,Ct)=>(Pn=!1,pr.forEach(kt=>{kt.progressEnd(we,Be,Ct)}),void 0!==Ct&&(ut=Ct),nn=!1,jt=!0,0===we?(ze="reverse"===pn()?"normal":"reverse","reverse"===ze&&(jt=!1),ui?(Qr(),Fr(1-Be)):(Dt=(1-Be)*se()*-1,Qr(!1,!1))):1===we&&(ui?(Qr(),Fr(Be)):(Dt=Be*se()*-1,Qr(!1,!1))),void 0!==we&&(Tr(()=>{ut=void 0,ze=void 0,Dt=void 0},{oneTimeCallback:!0}),Nt||No()),bn)}}},1273:(Hn,It,X)=>{"use strict";X.d(It,{E:()=>ye,a:()=>M,s:()=>tt});const M=Ae=>{try{if(Ae instanceof Le)return Ae.value;if(!l()||"string"!=typeof Ae||""===Ae)return Ae;if(Ae.includes("onload="))return"";const Ze=document.createDocumentFragment(),Qe=document.createElement("div");Ze.appendChild(Qe),Qe.innerHTML=Ae,Ne.forEach(pt=>{const et=Ze.querySelectorAll(pt);for(let Ot=et.length-1;Ot>=0;Ot--){const Pt=et[Ot];Pt.parentNode?Pt.parentNode.removeChild(Pt):Ze.removeChild(Pt);const Ce=lt(Pt);for(let Ie=0;Ie<Ce.length;Ie++)w(Ce[Ie])}});const ot=lt(Ze);for(let pt=0;pt<ot.length;pt++)w(ot[pt]);const mt=document.createElement("div");mt.appendChild(Ze);const xt=mt.querySelector("div");return null!==xt?xt.innerHTML:mt.innerHTML}catch(Ze){return console.error(Ze),""}},w=Ae=>{if(Ae.nodeType&&1!==Ae.nodeType)return;if(typeof NamedNodeMap<"u"&&!(Ae.attributes instanceof NamedNodeMap))return void Ae.remove();for(let Qe=Ae.attributes.length-1;Qe>=0;Qe--){const ot=Ae.attributes.item(Qe),mt=ot.name;if(!_e.includes(mt.toLowerCase())){Ae.removeAttribute(mt);continue}const xt=ot.value,pt=Ae[mt];(null!=xt&&xt.toLowerCase().includes("javascript:")||null!=pt&&pt.toLowerCase().includes("javascript:"))&&Ae.removeAttribute(mt)}const Ze=lt(Ae);for(let Qe=0;Qe<Ze.length;Qe++)w(Ze[Qe])},lt=Ae=>null!=Ae.children?Ae.children:Ae.childNodes,l=()=>{var Ae;const Ze=window,Qe=null===(Ae=Ze?.Ionic)||void 0===Ae?void 0:Ae.config;return!Qe||(Qe.get?Qe.get("sanitizerEnabled",!0):!0===Qe.sanitizerEnabled||void 0===Qe.sanitizerEnabled)},_e=["class","id","href","src","name","slot"],Ne=["script","style","iframe","meta","link","object","embed"];class Le{constructor(Ze){this.value=Ze}}const tt=Ae=>{const Ze=window,Qe=Ze.Ionic;if(!Qe||!Qe.config||"Object"===Qe.config.constructor.name)return Ze.Ionic=Ze.Ionic||{},Ze.Ionic.config=Object.assign(Object.assign({},Ze.Ionic.config),Ae),Ze.Ionic.config},ye=!1},9439:(Hn,It,X)=>{"use strict";X.d(It,{C:()=>_e,a:()=>lt,d:()=>l});var M=X(5861),w=X(544);const lt=function(){var Ne=(0,M.Z)(function*(Le,tt,Ke,ye,Ae,Ze){var Qe;if(Le)return Le.attachViewToDom(tt,Ke,Ae,ye);if(!(Ze||"string"==typeof Ke||Ke instanceof HTMLElement))throw new Error("framework delegate is missing");const ot="string"==typeof Ke?null===(Qe=tt.ownerDocument)||void 0===Qe?void 0:Qe.createElement(Ke):Ke;return ye&&ye.forEach(mt=>ot.classList.add(mt)),Ae&&Object.assign(ot,Ae),tt.appendChild(ot),yield new Promise(mt=>(0,w.c)(ot,mt)),ot});return function(tt,Ke,ye,Ae,Ze,Qe){return Ne.apply(this,arguments)}}(),l=(Ne,Le)=>{if(Le){if(Ne)return Ne.removeViewFromDom(Le.parentElement,Le);Le.remove()}return Promise.resolve()},_e=()=>{let Ne,Le;return{attachViewToDom:function(){var ye=(0,M.Z)(function*(Ae,Ze,Qe={},ot=[]){var mt,xt;if(Ne=Ae,Ze){const et="string"==typeof Ze?null===(mt=Ne.ownerDocument)||void 0===mt?void 0:mt.createElement(Ze):Ze;ot.forEach(Ot=>et.classList.add(Ot)),Object.assign(et,Qe),Ne.appendChild(et),yield new Promise(Ot=>(0,w.c)(et,Ot))}else if(Ne.children.length>0&&("ION-MODAL"===Ne.tagName||"ION-POPOVER"===Ne.tagName)&&!Ne.children[0].classList.contains("ion-delegate-host")){const Ot=null===(xt=Ne.ownerDocument)||void 0===xt?void 0:xt.createElement("div");Ot.classList.add("ion-delegate-host"),ot.forEach(Pt=>Ot.classList.add(Pt)),Ot.append(...Ne.children),Ne.appendChild(Ot)}const pt=document.querySelector("ion-app")||document.body;return Le=document.createComment("ionic teleport"),Ne.parentNode.insertBefore(Le,Ne),pt.appendChild(Ne),Ne});return function(Ze,Qe){return ye.apply(this,arguments)}}(),removeViewFromDom:()=>(Ne&&Le&&(Le.parentNode.insertBefore(Ne,Le),Le.remove()),Promise.resolve())}}},4587:(Hn,It,X)=>{"use strict";X.d(It,{G:()=>_e});class w{constructor(Le,tt,Ke,ye,Ae){this.id=tt,this.name=Ke,this.disableScroll=Ae,this.priority=1e6*ye+tt,this.ctrl=Le}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const Le=this.ctrl.capture(this.name,this.id,this.priority);return Le&&this.disableScroll&&this.ctrl.disableScroll(this.id),Le}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class lt{constructor(Le,tt,Ke,ye){this.id=tt,this.disable=Ke,this.disableScroll=ye,this.ctrl=Le}block(){if(this.ctrl){if(this.disable)for(const Le of this.disable)this.ctrl.disableGesture(Le,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const Le of this.disable)this.ctrl.enableGesture(Le,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const l="backdrop-no-scroll",_e=new class M{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(Le){var tt;return new w(this,this.newID(),Le.name,null!==(tt=Le.priority)&&void 0!==tt?tt:0,!!Le.disableScroll)}createBlocker(Le={}){return new lt(this,this.newID(),Le.disable,!!Le.disableScroll)}start(Le,tt,Ke){return this.canStart(Le)?(this.requestedStart.set(tt,Ke),!0):(this.requestedStart.delete(tt),!1)}capture(Le,tt,Ke){if(!this.start(Le,tt,Ke))return!1;const ye=this.requestedStart;let Ae=-1e4;if(ye.forEach(Ze=>{Ae=Math.max(Ae,Ze)}),Ae===Ke){this.capturedId=tt,ye.clear();const Ze=new CustomEvent("ionGestureCaptured",{detail:{gestureName:Le}});return document.dispatchEvent(Ze),!0}return ye.delete(tt),!1}release(Le){this.requestedStart.delete(Le),this.capturedId===Le&&(this.capturedId=void 0)}disableGesture(Le,tt){let Ke=this.disabledGestures.get(Le);void 0===Ke&&(Ke=new Set,this.disabledGestures.set(Le,Ke)),Ke.add(tt)}enableGesture(Le,tt){const Ke=this.disabledGestures.get(Le);void 0!==Ke&&Ke.delete(tt)}disableScroll(Le){this.disabledScroll.add(Le),1===this.disabledScroll.size&&document.body.classList.add(l)}enableScroll(Le){this.disabledScroll.delete(Le),0===this.disabledScroll.size&&document.body.classList.remove(l)}canStart(Le){return!(void 0!==this.capturedId||this.isDisabled(Le))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(Le){const tt=this.disabledGestures.get(Le);return!!(tt&&tt.size>0)}newID(){return this.gestureId++,this.gestureId}}},5421:(Hn,It,X)=>{"use strict";X.r(It),X.d(It,{MENU_BACK_BUTTON_PRIORITY:()=>_e,OVERLAY_BACK_BUTTON_PRIORITY:()=>l,blockHardwareBackButton:()=>w,startHardwareBackButton:()=>lt});var M=X(5861);const w=()=>{document.addEventListener("backbutton",()=>{})},lt=()=>{const Ne=document;let Le=!1;Ne.addEventListener("backbutton",()=>{if(Le)return;let tt=0,Ke=[];const ye=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(Qe,ot){Ke.push({priority:Qe,handler:ot,id:tt++})}}});Ne.dispatchEvent(ye);const Ae=function(){var Qe=(0,M.Z)(function*(ot){try{if(ot?.handler){const mt=ot.handler(Ze);null!=mt&&(yield mt)}}catch(mt){console.error(mt)}});return function(mt){return Qe.apply(this,arguments)}}(),Ze=()=>{if(Ke.length>0){let Qe={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};Ke.forEach(ot=>{ot.priority>=Qe.priority&&(Qe=ot)}),Le=!0,Ke=Ke.filter(ot=>ot.id!==Qe.id),Ae(Qe).then(()=>Le=!1)}};Ze()})},l=100,_e=99},544:(Hn,It,X)=>{"use strict";X.d(It,{a:()=>tt,b:()=>Ke,c:()=>lt,d:()=>xt,e:()=>mt,f:()=>ot,g:()=>ye,h:()=>Qe,i:()=>Le,j:()=>Ie,k:()=>_e,l:()=>pt,m:()=>l,n:()=>Ze,o:()=>et,p:()=>Ce,q:()=>ct,r:()=>Ae,s:()=>St,t:()=>M,u:()=>Ot,v:()=>Pt});const M=(Ye,gt=0)=>new Promise(Wt=>{w(Ye,gt,Wt)}),w=(Ye,gt=0,Wt)=>{let Nt,an;const Qt={passive:!0},Jn=()=>{Nt&&Nt()},Zt=Pn=>{(void 0===Pn||Ye===Pn.target)&&(Jn(),Wt(Pn))};return Ye&&(Ye.addEventListener("webkitTransitionEnd",Zt,Qt),Ye.addEventListener("transitionend",Zt,Qt),an=setTimeout(Zt,gt+500),Nt=()=>{an&&(clearTimeout(an),an=void 0),Ye.removeEventListener("webkitTransitionEnd",Zt,Qt),Ye.removeEventListener("transitionend",Zt,Qt)}),Jn},lt=(Ye,gt)=>{Ye.componentOnReady?Ye.componentOnReady().then(Wt=>gt(Wt)):Ae(()=>gt(Ye))},l=Ye=>void 0!==Ye.componentOnReady,_e=(Ye,gt=[])=>{const Wt={};return gt.forEach(Nt=>{Ye.hasAttribute(Nt)&&(null!==Ye.getAttribute(Nt)&&(Wt[Nt]=Ye.getAttribute(Nt)),Ye.removeAttribute(Nt))}),Wt},Ne=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Le=(Ye,gt)=>{let Wt=Ne;return gt&&gt.length>0&&(Wt=Wt.filter(Nt=>!gt.includes(Nt))),_e(Ye,Wt)},tt=(Ye,gt,Wt,Nt)=>{var an;if(typeof window<"u"){const Qt=window,Vt=null===(an=Qt?.Ionic)||void 0===an?void 0:an.config;if(Vt){const Jn=Vt.get("_ael");if(Jn)return Jn(Ye,gt,Wt,Nt);if(Vt._ael)return Vt._ael(Ye,gt,Wt,Nt)}}return Ye.addEventListener(gt,Wt,Nt)},Ke=(Ye,gt,Wt,Nt)=>{var an;if(typeof window<"u"){const Qt=window,Vt=null===(an=Qt?.Ionic)||void 0===an?void 0:an.config;if(Vt){const Jn=Vt.get("_rel");if(Jn)return Jn(Ye,gt,Wt,Nt);if(Vt._rel)return Vt._rel(Ye,gt,Wt,Nt)}}return Ye.removeEventListener(gt,Wt,Nt)},ye=(Ye,gt=Ye)=>Ye.shadowRoot||gt,Ae=Ye=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Ye):"function"==typeof requestAnimationFrame?requestAnimationFrame(Ye):setTimeout(Ye),Ze=Ye=>!!Ye.shadowRoot&&!!Ye.attachShadow,Qe=Ye=>{const gt=Ye.closest("ion-item");return gt?gt.querySelector("ion-label"):null},ot=Ye=>{if(Ye.focus(),Ye.classList.contains("ion-focusable")){const gt=Ye.closest("ion-app");gt&&gt.setFocus([Ye])}},mt=(Ye,gt)=>{let Wt;const Nt=Ye.getAttribute("aria-labelledby"),an=Ye.id;let Qt=null!==Nt&&""!==Nt.trim()?Nt:gt+"-lbl",Vt=null!==Nt&&""!==Nt.trim()?document.getElementById(Nt):Qe(Ye);return Vt?(null===Nt&&(Vt.id=Qt),Wt=Vt.textContent,Vt.setAttribute("aria-hidden","true")):""!==an.trim()&&(Vt=document.querySelector(`label[for="${an}"]`),Vt&&(""!==Vt.id?Qt=Vt.id:Vt.id=Qt=`${an}-lbl`,Wt=Vt.textContent)),{label:Vt,labelId:Qt,labelText:Wt}},xt=(Ye,gt,Wt,Nt,an)=>{if(Ye||Ze(gt)){let Qt=gt.querySelector("input.aux-input");Qt||(Qt=gt.ownerDocument.createElement("input"),Qt.type="hidden",Qt.classList.add("aux-input"),gt.appendChild(Qt)),Qt.disabled=an,Qt.name=Wt,Qt.value=Nt||""}},pt=(Ye,gt,Wt)=>Math.max(Ye,Math.min(gt,Wt)),et=(Ye,gt)=>{if(!Ye){const Wt="ASSERT: "+gt;throw console.error(Wt),new Error(Wt)}},Ot=Ye=>Ye.timeStamp||Date.now(),Pt=Ye=>{if(Ye){const gt=Ye.changedTouches;if(gt&&gt.length>0){const Wt=gt[0];return{x:Wt.clientX,y:Wt.clientY}}if(void 0!==Ye.pageX)return{x:Ye.pageX,y:Ye.pageY}}return{x:0,y:0}},Ce=Ye=>{const gt="rtl"===document.dir;switch(Ye){case"start":return gt;case"end":return!gt;default:throw new Error(`"${Ye}" is not a valid value for [side]. Use "start" or "end" instead.`)}},Ie=(Ye,gt)=>{const Wt=Ye._original||Ye;return{_original:Ye,emit:ct(Wt.emit.bind(Wt),gt)}},ct=(Ye,gt=0)=>{let Wt;return(...Nt)=>{clearTimeout(Wt),Wt=setTimeout(Ye,gt,...Nt)}},St=(Ye,gt)=>{if(Ye??(Ye={}),gt??(gt={}),Ye===gt)return!0;const Wt=Object.keys(Ye);if(Wt.length!==Object.keys(gt).length)return!1;for(const Nt of Wt)if(!(Nt in gt)||Ye[Nt]!==gt[Nt])return!1;return!0}},6953:(Hn,It,X)=>{"use strict";X.d(It,{B:()=>Ae,H:()=>Jn,a:()=>Es,b:()=>Gn,c:()=>nn,d:()=>rn,e:()=>Wn,f:()=>bn,g:()=>ln,h:()=>Qt,i:()=>_t,j:()=>Ze,p:()=>ro,r:()=>Et,w:()=>Dr});var M=X(5861);let lt,l,_e,Ne=!1,Le=!1,tt=!1,Ke=!1,ye=!1;const Ae={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},Ze=he=>{const $e=new URL(he,Gr.$resourcesUrl$);return $e.origin!==Qr.location.origin?$e.href:$e.pathname},Ot="s-id",Pt="sty-id",ct="http://www.w3.org/1999/xlink",St={},Nt=he=>"object"==(he=typeof he)||"function"===he;function an(he){var $e,we,Be;return null!==(Be=null===(we=null===($e=he.head)||void 0===$e?void 0:$e.querySelector('meta[name="csp-nonce"]'))||void 0===we?void 0:we.getAttribute("content"))&&void 0!==Be?Be:void 0}const Qt=(he,$e,...we)=>{let Be=null,Ct=null,kt=null,cn=!1,gn=!1;const un=[],In=Cr=>{for(let kr=0;kr<Cr.length;kr++)Be=Cr[kr],Array.isArray(Be)?In(Be):null!=Be&&"boolean"!=typeof Be&&((cn="function"!=typeof he&&!Nt(Be))&&(Be=String(Be)),cn&&gn?un[un.length-1].$text$+=Be:un.push(cn?Vt(null,Be):Be),gn=cn)};if(In(we),$e){$e.key&&(Ct=$e.key),$e.name&&(kt=$e.name);{const Cr=$e.className||$e.class;Cr&&($e.class="object"!=typeof Cr?Cr:Object.keys(Cr).filter(kr=>Cr[kr]).join(" "))}}if("function"==typeof he)return he(null===$e?{}:$e,un,Pn);const lr=Vt(he,null);return lr.$attrs$=$e,un.length>0&&(lr.$children$=un),lr.$key$=Ct,lr.$name$=kt,lr},Vt=(he,$e)=>({$flags$:0,$tag$:he,$text$:$e,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),Jn={},Pn={forEach:(he,$e)=>he.map(zt).forEach($e),map:(he,$e)=>he.map(zt).map($e).map(Se)},zt=he=>({vattrs:he.$attrs$,vchildren:he.$children$,vkey:he.$key$,vname:he.$name$,vtag:he.$tag$,vtext:he.$text$}),Se=he=>{if("function"==typeof he.vtag){const we=Object.assign({},he.vattrs);return he.vkey&&(we.key=he.vkey),he.vname&&(we.name=he.vname),Qt(he.vtag,we,...he.vchildren||[])}const $e=Vt(he.vtag,he.vtext);return $e.$attrs$=he.vattrs,$e.$children$=he.vchildren,$e.$key$=he.vkey,$e.$name$=he.vname,$e},ut=(he,$e,we,Be,Ct,kt,cn)=>{let gn,un,In,lr;if(1===kt.nodeType){for(gn=kt.getAttribute("c-id"),gn&&(un=gn.split("."),(un[0]===cn||"0"===un[0])&&(In={$flags$:0,$hostId$:un[0],$nodeId$:un[1],$depth$:un[2],$index$:un[3],$tag$:kt.tagName.toLowerCase(),$elm$:kt,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},$e.push(In),kt.removeAttribute("c-id"),he.$children$||(he.$children$=[]),he.$children$[In.$index$]=In,he=In,Be&&"0"===In.$depth$&&(Be[In.$index$]=In.$elm$))),lr=kt.childNodes.length-1;lr>=0;lr--)ut(he,$e,we,Be,Ct,kt.childNodes[lr],cn);if(kt.shadowRoot)for(lr=kt.shadowRoot.childNodes.length-1;lr>=0;lr--)ut(he,$e,we,Be,Ct,kt.shadowRoot.childNodes[lr],cn)}else if(8===kt.nodeType)un=kt.nodeValue.split("."),(un[1]===cn||"0"===un[1])&&(gn=un[0],In={$flags$:0,$hostId$:un[1],$nodeId$:un[2],$depth$:un[3],$index$:un[4],$elm$:kt,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===gn?(In.$elm$=kt.nextSibling,In.$elm$&&3===In.$elm$.nodeType&&(In.$text$=In.$elm$.textContent,$e.push(In),kt.remove(),he.$children$||(he.$children$=[]),he.$children$[In.$index$]=In,Be&&"0"===In.$depth$&&(Be[In.$index$]=In.$elm$))):In.$hostId$===cn&&("s"===gn?(In.$tag$="slot",kt["s-sn"]=un[5]?In.$name$=un[5]:"",kt["s-sr"]=!0,Be&&(In.$elm$=li.createElement(In.$tag$),In.$name$&&In.$elm$.setAttribute("name",In.$name$),kt.parentNode.insertBefore(In.$elm$,kt),kt.remove(),"0"===In.$depth$&&(Be[In.$index$]=In.$elm$)),we.push(In),he.$children$||(he.$children$=[]),he.$children$[In.$index$]=In):"r"===gn&&(Be?kt.remove():(Ct["s-cr"]=kt,kt["s-cn"]=!0))));else if(he&&"style"===he.$tag$){const Cr=Vt(null,kt.textContent);Cr.$elm$=kt,Cr.$index$="0",he.$children$=[Cr]}},Dt=(he,$e)=>{if(1===he.nodeType){let we=0;for(;we<he.childNodes.length;we++)Dt(he.childNodes[we],$e);if(he.shadowRoot)for(we=0;we<he.shadowRoot.childNodes.length;we++)Dt(he.shadowRoot.childNodes[we],$e)}else if(8===he.nodeType){const we=he.nodeValue.split(".");"o"===we[0]&&($e.set(we[1]+"."+we[2],he),he.nodeValue="",he["s-en"]=we[3])}},nn=he=>Ci.push(he),ln=he=>Kt(he).$modeName$,bn=he=>Kt(he).$hostElement$,rn=(he,$e,we)=>{const Be=bn(he);return{emit:Ct=>Jt(Be,$e,{bubbles:!!(4&we),composed:!!(2&we),cancelable:!!(1&we),detail:Ct})}},Jt=(he,$e,we)=>{const Be=Gr.ce($e,we);return he.dispatchEvent(Be),Be},en=new WeakMap,dn=(he,$e,we)=>{let Be=di.get(he);bi&&we?(Be=Be||new CSSStyleSheet,"string"==typeof Be?Be=$e:Be.replaceSync($e)):Be=$e,di.set(he,Be)},Fn=(he,$e,we,Be)=>{var Ct;let kt=nr($e,we);const cn=di.get(kt);if(he=11===he.nodeType?he:li,cn)if("string"==typeof cn){let un,gn=en.get(he=he.head||he);if(gn||en.set(he,gn=new Set),!gn.has(kt)){if(he.host&&(un=he.querySelector(`[${Pt}="${kt}"]`)))un.innerHTML=cn;else{un=li.createElement("style"),un.innerHTML=cn;const In=null!==(Ct=Gr.$nonce$)&&void 0!==Ct?Ct:an(li);null!=In&&un.setAttribute("nonce",In),he.insertBefore(un,he.querySelector("link"))}gn&&gn.add(kt)}}else he.adoptedStyleSheets.includes(cn)||(he.adoptedStyleSheets=[...he.adoptedStyleSheets,cn]);return kt},nr=(he,$e)=>"sc-"+($e&&32&he.$flags$?he.$tagName$+"-"+$e:he.$tagName$),gr=he=>he.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),Xn=(he,$e,we,Be,Ct,kt)=>{if(we!==Be){let cn=cr(he,$e),gn=$e.toLowerCase();if("class"===$e){const un=he.classList,In=yn(we),lr=yn(Be);un.remove(...In.filter(Cr=>Cr&&!lr.includes(Cr))),un.add(...lr.filter(Cr=>Cr&&!In.includes(Cr)))}else if("style"===$e){for(const un in we)(!Be||null==Be[un])&&(un.includes("-")?he.style.removeProperty(un):he.style[un]="");for(const un in Be)(!we||Be[un]!==we[un])&&(un.includes("-")?he.style.setProperty(un,Be[un]):he.style[un]=Be[un])}else if("key"!==$e)if("ref"===$e)Be&&Be(he);else if(cn||"o"!==$e[0]||"n"!==$e[1]){const un=Nt(Be);if((cn||un&&null!==Be)&&!Ct)try{if(he.tagName.includes("-"))he[$e]=Be;else{const lr=Be??"";"list"===$e?cn=!1:(null==we||he[$e]!=lr)&&(he[$e]=lr)}}catch{}let In=!1;gn!==(gn=gn.replace(/^xlink\:?/,""))&&($e=gn,In=!0),null==Be||!1===Be?(!1!==Be||""===he.getAttribute($e))&&(In?he.removeAttributeNS(ct,$e):he.removeAttribute($e)):(!cn||4&kt||Ct)&&!un&&(Be=!0===Be?"":Be,In?he.setAttributeNS(ct,$e,Be):he.setAttribute($e,Be))}else $e="-"===$e[2]?$e.slice(3):cr(Qr,gn)?gn.slice(2):gn[2]+$e.slice(3),we&&Gr.rel(he,$e,we,!1),Be&&Gr.ael(he,$e,Be,!1)}},Lr=/\s/,yn=he=>he?he.split(Lr):[],Jr=(he,$e,we,Be)=>{const Ct=11===$e.$elm$.nodeType&&$e.$elm$.host?$e.$elm$.host:$e.$elm$,kt=he&&he.$attrs$||St,cn=$e.$attrs$||St;for(Be in kt)Be in cn||Xn(Ct,Be,kt[Be],void 0,we,$e.$flags$);for(Be in cn)Xn(Ct,Be,kt[Be],cn[Be],we,$e.$flags$)},Li=(he,$e,we,Be)=>{const Ct=$e.$children$[we];let cn,gn,un,kt=0;if(Ne||(tt=!0,"slot"===Ct.$tag$&&(lt&&Be.classList.add(lt+"-s"),Ct.$flags$|=Ct.$children$?2:1)),null!==Ct.$text$)cn=Ct.$elm$=li.createTextNode(Ct.$text$);else if(1&Ct.$flags$)cn=Ct.$elm$=li.createTextNode("");else{if(Ke||(Ke="svg"===Ct.$tag$),cn=Ct.$elm$=li.createElementNS(Ke?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Ct.$flags$?"slot-fb":Ct.$tag$),Ke&&"foreignObject"===Ct.$tag$&&(Ke=!1),Jr(null,Ct,Ke),(he=>null!=he)(lt)&&cn["s-si"]!==lt&&cn.classList.add(cn["s-si"]=lt),Ct.$children$)for(kt=0;kt<Ct.$children$.length;++kt)gn=Li(he,Ct,kt,cn),gn&&cn.appendChild(gn);"svg"===Ct.$tag$?Ke=!1:"foreignObject"===cn.tagName&&(Ke=!0)}return cn["s-hn"]=_e,3&Ct.$flags$&&(cn["s-sr"]=!0,cn["s-cr"]=l,cn["s-sn"]=Ct.$name$||"",un=he&&he.$children$&&he.$children$[we],un&&un.$tag$===Ct.$tag$&&he.$elm$&&ui(he.$elm$,!1)),cn},ui=(he,$e)=>{Gr.$flags$|=1;const we=he.childNodes;for(let Be=we.length-1;Be>=0;Be--){const Ct=we[Be];Ct["s-hn"]!==_e&&Ct["s-ol"]&&(Gi(Ct).insertBefore(Ct,Di(Ct)),Ct["s-ol"].remove(),Ct["s-ol"]=void 0,tt=!0),$e&&ui(Ct,$e)}Gr.$flags$&=-2},hr=(he,$e,we,Be,Ct,kt)=>{let gn,cn=he["s-cr"]&&he["s-cr"].parentNode||he;for(cn.shadowRoot&&cn.tagName===_e&&(cn=cn.shadowRoot);Ct<=kt;++Ct)Be[Ct]&&(gn=Li(null,we,Ct,he),gn&&(Be[Ct].$elm$=gn,cn.insertBefore(gn,Di($e))))},wr=(he,$e,we)=>{for(let Be=$e;Be<=we;++Be){const Ct=he[Be];if(Ct){const kt=Ct.$elm$;Or(Ct),kt&&(Le=!0,kt["s-ol"]?kt["s-ol"].remove():ui(kt,!0),kt.remove())}}},mr=(he,$e)=>he.$tag$===$e.$tag$&&("slot"===he.$tag$?he.$name$===$e.$name$:he.$key$===$e.$key$),Di=he=>he&&he["s-ol"]||he,Gi=he=>(he["s-ol"]?he["s-ol"]:he).parentNode,Tr=(he,$e)=>{const we=$e.$elm$=he.$elm$,Be=he.$children$,Ct=$e.$children$,kt=$e.$tag$,cn=$e.$text$;let gn;null===cn?(Ke="svg"===kt||"foreignObject"!==kt&&Ke,"slot"===kt||Jr(he,$e,Ke),null!==Be&&null!==Ct?((he,$e,we,Be)=>{let io,Hi,Ct=0,kt=0,cn=0,gn=0,un=$e.length-1,In=$e[0],lr=$e[un],Cr=Be.length-1,kr=Be[0],wi=Be[Cr];for(;Ct<=un&&kt<=Cr;)if(null==In)In=$e[++Ct];else if(null==lr)lr=$e[--un];else if(null==kr)kr=Be[++kt];else if(null==wi)wi=Be[--Cr];else if(mr(In,kr))Tr(In,kr),In=$e[++Ct],kr=Be[++kt];else if(mr(lr,wi))Tr(lr,wi),lr=$e[--un],wi=Be[--Cr];else if(mr(In,wi))("slot"===In.$tag$||"slot"===wi.$tag$)&&ui(In.$elm$.parentNode,!1),Tr(In,wi),he.insertBefore(In.$elm$,lr.$elm$.nextSibling),In=$e[++Ct],wi=Be[--Cr];else if(mr(lr,kr))("slot"===In.$tag$||"slot"===wi.$tag$)&&ui(lr.$elm$.parentNode,!1),Tr(lr,kr),he.insertBefore(lr.$elm$,In.$elm$),lr=$e[--un],kr=Be[++kt];else{for(cn=-1,gn=Ct;gn<=un;++gn)if($e[gn]&&null!==$e[gn].$key$&&$e[gn].$key$===kr.$key$){cn=gn;break}cn>=0?(Hi=$e[cn],Hi.$tag$!==kr.$tag$?io=Li($e&&$e[kt],we,cn,he):(Tr(Hi,kr),$e[cn]=void 0,io=Hi.$elm$),kr=Be[++kt]):(io=Li($e&&$e[kt],we,kt,he),kr=Be[++kt]),io&&Gi(In.$elm$).insertBefore(io,Di(In.$elm$))}Ct>un?hr(he,null==Be[Cr+1]?null:Be[Cr+1].$elm$,we,Be,kt,Cr):kt>Cr&&wr($e,Ct,un)})(we,Be,$e,Ct):null!==Ct?(null!==he.$text$&&(we.textContent=""),hr(we,null,$e,Ct,0,Ct.length-1)):null!==Be&&wr(Be,0,Be.length-1),Ke&&"svg"===kt&&(Ke=!1)):(gn=we["s-cr"])?gn.parentNode.textContent=cn:he.$text$!==cn&&(we.data=cn)},Mi=he=>{const $e=he.childNodes;let we,Be,Ct,kt,cn,gn;for(Be=0,Ct=$e.length;Be<Ct;Be++)if(we=$e[Be],1===we.nodeType){if(we["s-sr"])for(cn=we["s-sn"],we.hidden=!1,kt=0;kt<Ct;kt++)if(gn=$e[kt].nodeType,$e[kt]["s-hn"]!==we["s-hn"]||""!==cn){if(1===gn&&cn===$e[kt].getAttribute("slot")){we.hidden=!0;break}}else if(1===gn||3===gn&&""!==$e[kt].textContent.trim()){we.hidden=!0;break}Mi(we)}},yi=[],Yr=he=>{let $e,we,Be,Ct,kt,cn,gn=0;const un=he.childNodes,In=un.length;for(;gn<In;gn++){if($e=un[gn],$e["s-sr"]&&(we=$e["s-cr"])&&we.parentNode)for(Be=we.parentNode.childNodes,Ct=$e["s-sn"],cn=Be.length-1;cn>=0;cn--)we=Be[cn],!we["s-cn"]&&!we["s-nr"]&&we["s-hn"]!==$e["s-hn"]&&(Do(we,Ct)?(kt=yi.find(lr=>lr.$nodeToRelocate$===we),Le=!0,we["s-sn"]=we["s-sn"]||Ct,kt?kt.$slotRefNode$=$e:yi.push({$slotRefNode$:$e,$nodeToRelocate$:we}),we["s-sr"]&&yi.map(lr=>{Do(lr.$nodeToRelocate$,we["s-sn"])&&(kt=yi.find(Cr=>Cr.$nodeToRelocate$===we),kt&&!lr.$slotRefNode$&&(lr.$slotRefNode$=kt.$slotRefNode$))})):yi.some(lr=>lr.$nodeToRelocate$===we)||yi.push({$nodeToRelocate$:we}));1===$e.nodeType&&Yr($e)}},Do=(he,$e)=>1===he.nodeType?null===he.getAttribute("slot")&&""===$e||he.getAttribute("slot")===$e:he["s-sn"]===$e||""===$e,Or=he=>{he.$attrs$&&he.$attrs$.ref&&he.$attrs$.ref(null),he.$children$&&he.$children$.map(Or)},Xe=(he,$e)=>{$e&&!he.$onRenderResolve$&&$e["s-p"]&&$e["s-p"].push(new Promise(we=>he.$onRenderResolve$=we))},ue=(he,$e)=>{if(he.$flags$|=16,!(4&he.$flags$))return Xe(he,he.$ancestorComponent$),Dr(()=>pe(he,$e));he.$flags$|=512},pe=(he,$e)=>{const Be=he.$lazyInstance$;let Ct;return $e&&(he.$flags$|=256,he.$queuedListeners$&&(he.$queuedListeners$.map(([kt,cn])=>pn(Be,kt,cn)),he.$queuedListeners$=void 0),Ct=pn(Be,"componentWillLoad")),Ct=He(Ct,()=>pn(Be,"componentWillRender")),He(Ct,()=>yt(he,Be,$e))},He=(he,$e)=>at(he)?he.then($e):$e(),at=he=>he instanceof Promise||he&&he.then&&"function"==typeof he.then,yt=function(){var he=(0,M.Z)(function*($e,we,Be){var Ct;const kt=$e.$hostElement$,gn=kt["s-rc"];Be&&(he=>{const $e=he.$cmpMeta$,we=he.$hostElement$,Be=$e.$flags$,kt=Fn(we.shadowRoot?we.shadowRoot:we.getRootNode(),$e,he.$modeName$);10&Be&&(we["s-sc"]=kt,we.classList.add(kt+"-h"),2&Be&&we.classList.add(kt+"-s"))})($e);Mt($e,we),gn&&(gn.map(In=>In()),kt["s-rc"]=void 0);{const In=null!==(Ct=kt["s-p"])&&void 0!==Ct?Ct:[],lr=()=>At($e);0===In.length?lr():(Promise.all(In).then(lr),$e.$flags$|=4,In.length=0)}});return function(we,Be,Ct){return he.apply(this,arguments)}}(),Mt=(he,$e,we)=>{try{$e=$e.render&&$e.render(),he.$flags$&=-17,he.$flags$|=2,((he,$e)=>{const we=he.$hostElement$,Be=he.$cmpMeta$,Ct=he.$vnode$||Vt(null,null),kt=(he=>he&&he.$tag$===Jn)($e)?$e:Qt(null,null,$e);if(_e=we.tagName,Be.$attrsToReflect$&&(kt.$attrs$=kt.$attrs$||{},Be.$attrsToReflect$.map(([cn,gn])=>kt.$attrs$[gn]=we[cn])),kt.$tag$=null,kt.$flags$|=4,he.$vnode$=kt,kt.$elm$=Ct.$elm$=we.shadowRoot||we,lt=we["s-sc"],l=we["s-cr"],Ne=0!=(1&Be.$flags$),Le=!1,Tr(Ct,kt),Gr.$flags$|=1,tt){Yr(kt.$elm$);let cn,gn,un,In,lr,Cr,kr=0;for(;kr<yi.length;kr++)cn=yi[kr],gn=cn.$nodeToRelocate$,gn["s-ol"]||(un=li.createTextNode(""),un["s-nr"]=gn,gn.parentNode.insertBefore(gn["s-ol"]=un,gn));for(kr=0;kr<yi.length;kr++)if(cn=yi[kr],gn=cn.$nodeToRelocate$,cn.$slotRefNode$){for(In=cn.$slotRefNode$.parentNode,lr=cn.$slotRefNode$.nextSibling,un=gn["s-ol"];un=un.previousSibling;)if(Cr=un["s-nr"],Cr&&Cr["s-sn"]===gn["s-sn"]&&In===Cr.parentNode&&(Cr=Cr.nextSibling,!Cr||!Cr["s-nr"])){lr=Cr;break}(!lr&&In!==gn.parentNode||gn.nextSibling!==lr)&&gn!==lr&&(!gn["s-hn"]&&gn["s-ol"]&&(gn["s-hn"]=gn["s-ol"].parentNode.nodeName),In.insertBefore(gn,lr))}else 1===gn.nodeType&&(gn.hidden=!0)}Le&&Mi(kt.$elm$),Gr.$flags$&=-2,yi.length=0})(he,$e)}catch(Be){qn(Be,he.$hostElement$)}return null},At=he=>{const we=he.$hostElement$,Ct=he.$lazyInstance$,kt=he.$ancestorComponent$;pn(Ct,"componentDidRender"),64&he.$flags$?pn(Ct,"componentDidUpdate"):(he.$flags$|=64,ke(we),pn(Ct,"componentDidLoad"),he.$onReadyResolve$(we),kt||Bt()),he.$onInstanceResolve$(we),he.$onRenderResolve$&&(he.$onRenderResolve$(),he.$onRenderResolve$=void 0),512&he.$flags$&&No(()=>ue(he,!1)),he.$flags$&=-517},_t=he=>{{const $e=Kt(he),we=$e.$hostElement$.isConnected;return we&&2==(18&$e.$flags$)&&ue($e,!1),we}},Bt=he=>{ke(li.documentElement),No(()=>Jt(Qr,"appload",{detail:{namespace:"ionic"}}))},pn=(he,$e,we)=>{if(he&&he[$e])try{return he[$e](we)}catch(Be){qn(Be)}},ke=he=>he.classList.add("hydrated"),Fe=(he,$e,we)=>{if($e.$members$){he.watchers&&($e.$watchers$=he.watchers);const Be=Object.entries($e.$members$),Ct=he.prototype;if(Be.map(([kt,[cn]])=>{31&cn||2&we&&32&cn?Object.defineProperty(Ct,kt,{get(){return((he,$e)=>Kt(this).$instanceValues$.get($e))(0,kt)},set(gn){((he,$e,we,Be)=>{const Ct=Kt(he),kt=Ct.$hostElement$,cn=Ct.$instanceValues$.get($e),gn=Ct.$flags$,un=Ct.$lazyInstance$;we=((he,$e)=>null==he||Nt(he)?he:4&$e?"false"!==he&&(""===he||!!he):2&$e?parseFloat(he):1&$e?String(he):he)(we,Be.$members$[$e][0]);const In=Number.isNaN(cn)&&Number.isNaN(we);if((!(8&gn)||void 0===cn)&&we!==cn&&!In&&(Ct.$instanceValues$.set($e,we),un)){if(Be.$watchers$&&128&gn){const Cr=Be.$watchers$[$e];Cr&&Cr.map(kr=>{try{un[kr](we,cn,$e)}catch(wi){qn(wi,kt)}})}2==(18&gn)&&ue(Ct,!1)}})(this,kt,gn,$e)},configurable:!0,enumerable:!0}):1&we&&64&cn&&Object.defineProperty(Ct,kt,{value(...gn){const un=Kt(this);return un.$onInstancePromise$.then(()=>un.$lazyInstance$[kt](...gn))}})}),1&we){const kt=new Map;Ct.attributeChangedCallback=function(cn,gn,un){Gr.jmp(()=>{const In=kt.get(cn);if(this.hasOwnProperty(In))un=this[In],delete this[In];else if(Ct.hasOwnProperty(In)&&"number"==typeof this[In]&&this[In]==un)return;this[In]=(null!==un||"boolean"!=typeof this[In])&&un})},he.observedAttributes=Be.filter(([cn,gn])=>15&gn[0]).map(([cn,gn])=>{const un=gn[1]||cn;return kt.set(un,cn),512&gn[0]&&$e.$attrsToReflect$.push([cn,un]),un})}}return he},fe=function(){var he=(0,M.Z)(function*($e,we,Be,Ct,kt){if(!(32&we.$flags$)){we.$flags$|=32;{if((kt=Fr(Be)).then){const In=()=>{};kt=yield kt,In()}kt.isProxied||(Be.$watchers$=kt.watchers,Fe(kt,Be,2),kt.isProxied=!0);const un=()=>{};we.$flags$|=8;try{new kt(we)}catch(In){qn(In)}we.$flags$&=-9,we.$flags$|=128,un(),nt(we.$lazyInstance$)}if(kt.style){let un=kt.style;"string"!=typeof un&&(un=un[we.$modeName$=(he=>Ci.map($e=>$e(he)).find($e=>!!$e))($e)]);const In=nr(Be,we.$modeName$);if(!di.has(In)){const lr=()=>{};dn(In,un,!!(1&Be.$flags$)),lr()}}}const cn=we.$ancestorComponent$,gn=()=>ue(we,!0);cn&&cn["s-rc"]?cn["s-rc"].push(gn):gn()});return function(we,Be,Ct,kt,cn){return he.apply(this,arguments)}}(),nt=he=>{pn(he,"connectedCallback")},mn=he=>{const $e=he["s-cr"]=li.createComment("");$e["s-cn"]=!0,he.insertBefore($e,he.firstChild)},Gn=(he,$e={})=>{var we;const Ct=[],kt=$e.exclude||[],cn=Qr.customElements,gn=li.head,un=gn.querySelector("meta[charset]"),In=li.createElement("style"),lr=[],Cr=li.querySelectorAll(`[${Pt}]`);let kr,wi=!0,io=0;for(Object.assign(Gr,$e),Gr.$resourcesUrl$=new URL($e.resourcesUrl||"./",li.baseURI).href,Gr.$flags$|=2;io<Cr.length;io++)dn(Cr[io].getAttribute(Pt),gr(Cr[io].innerHTML),!0);he.map(Hi=>{Hi[1].map(Ki=>{const Pi={$flags$:Ki[0],$tagName$:Ki[1],$members$:Ki[2],$listeners$:Ki[3]};Pi.$members$=Ki[2],Pi.$listeners$=Ki[3],Pi.$attrsToReflect$=[],Pi.$watchers$={};const To=Pi.$tagName$,Vr=class extends HTMLElement{constructor(qr){super(qr),wn(qr=this,Pi),1&Pi.$flags$&&qr.attachShadow({mode:"open",delegatesFocus:!!(16&Pi.$flags$)})}connectedCallback(){kr&&(clearTimeout(kr),kr=null),wi?lr.push(this):Gr.jmp(()=>(he=>{if(!(1&Gr.$flags$)){const $e=Kt(he),we=$e.$cmpMeta$,Be=()=>{};if(1&$e.$flags$)dr(he,$e,we.$listeners$),nt($e.$lazyInstance$);else{let Ct;if($e.$flags$|=1,Ct=he.getAttribute(Ot),Ct){if(1&we.$flags$){const kt=Fn(he.shadowRoot,we,he.getAttribute("s-mode"));he.classList.remove(kt+"-h",kt+"-s")}((he,$e,we,Be)=>{const kt=he.shadowRoot,cn=[],un=kt?[]:null,In=Be.$vnode$=Vt($e,null);Gr.$orgLocNodes$||Dt(li.body,Gr.$orgLocNodes$=new Map),he[Ot]=we,he.removeAttribute(Ot),ut(In,cn,[],un,he,he,we),cn.map(lr=>{const Cr=lr.$hostId$+"."+lr.$nodeId$,kr=Gr.$orgLocNodes$.get(Cr),wi=lr.$elm$;kr&&on&&""===kr["s-en"]&&kr.parentNode.insertBefore(wi,kr.nextSibling),kt||(wi["s-hn"]=$e,kr&&(wi["s-ol"]=kr,wi["s-ol"]["s-nr"]=wi)),Gr.$orgLocNodes$.delete(Cr)}),kt&&un.map(lr=>{lr&&kt.appendChild(lr)})})(he,we.$tagName$,Ct,$e)}Ct||12&we.$flags$&&mn(he);{let kt=he;for(;kt=kt.parentNode||kt.host;)if(1===kt.nodeType&&kt.hasAttribute("s-id")&&kt["s-p"]||kt["s-p"]){Xe($e,$e.$ancestorComponent$=kt);break}}we.$members$&&Object.entries(we.$members$).map(([kt,[cn]])=>{if(31&cn&&he.hasOwnProperty(kt)){const gn=he[kt];delete he[kt],he[kt]=gn}}),fe(he,$e,we)}Be()}})(this))}disconnectedCallback(){Gr.jmp(()=>(he=>{if(!(1&Gr.$flags$)){const $e=Kt(this),we=$e.$lazyInstance$;$e.$rmListeners$&&($e.$rmListeners$.map(Be=>Be()),$e.$rmListeners$=void 0),pn(we,"disconnectedCallback")}})())}componentOnReady(){return Kt(this).$onReadyPromise$}};Pi.$lazyBundleId$=Hi[0],!kt.includes(To)&&!cn.get(To)&&(Ct.push(To),cn.define(To,Fe(Vr,Pi,1)))})});{In.innerHTML=Ct+"{visibility:hidden}.hydrated{visibility:inherit}",In.setAttribute("data-styles","");const Hi=null!==(we=Gr.$nonce$)&&void 0!==we?we:an(li);null!=Hi&&In.setAttribute("nonce",Hi),gn.insertBefore(In,un?un.nextSibling:gn.firstChild)}wi=!1,lr.length?lr.map(Hi=>Hi.connectedCallback()):Gr.jmp(()=>kr=setTimeout(Bt,30))},dr=(he,$e,we,Be)=>{we&&we.map(([Ct,kt,cn])=>{const gn=Hr(he,Ct),un=yr($e,cn),In=ti(Ct);Gr.ael(gn,kt,un,In),($e.$rmListeners$=$e.$rmListeners$||[]).push(()=>Gr.rel(gn,kt,un,In))})},yr=(he,$e)=>we=>{try{256&he.$flags$?he.$lazyInstance$[$e](we):(he.$queuedListeners$=he.$queuedListeners$||[]).push([$e,we])}catch(Be){qn(Be)}},Hr=(he,$e)=>4&$e?li:8&$e?Qr:16&$e?li.body:he,ti=he=>0!=(2&he),Bo=new WeakMap,Kt=he=>Bo.get(he),Et=(he,$e)=>Bo.set($e.$lazyInstance$=he,$e),wn=(he,$e)=>{const we={$flags$:0,$hostElement$:he,$cmpMeta$:$e,$instanceValues$:new Map};return we.$onInstancePromise$=new Promise(Be=>we.$onInstanceResolve$=Be),we.$onReadyPromise$=new Promise(Be=>we.$onReadyResolve$=Be),he["s-p"]=[],he["s-rc"]=[],dr(he,we,$e.$listeners$),Bo.set(he,we)},cr=(he,$e)=>$e in he,qn=(he,$e)=>(0,console.error)(he,$e),Rr=new Map,Fr=(he,$e,we)=>{const Be=he.$tagName$.replace(/-/g,"_"),Ct=he.$lazyBundleId$,kt=Rr.get(Ct);return kt?kt[Be]:X(863)(`./${Ct}.entry.js`).then(cn=>(Rr.set(Ct,cn),cn[Be]),qn)},di=new Map,Ci=[],Qr=typeof window<"u"?window:{},li=Qr.document||{head:{}},Gr={$flags$:0,$resourcesUrl$:"",jmp:he=>he(),raf:he=>requestAnimationFrame(he),ael:(he,$e,we,Be)=>he.addEventListener($e,we,Be),rel:(he,$e,we,Be)=>he.removeEventListener($e,we,Be),ce:(he,$e)=>new CustomEvent(he,$e)},Es=he=>{Object.assign(Gr,he)},on=!0,ro=he=>Promise.resolve(he),bi=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),ii=[],Yo=[],zi=(he,$e)=>we=>{he.push(we),ye||(ye=!0,$e&&4&Gr.$flags$?No(Po):Gr.raf(Po))},ss=he=>{for(let $e=0;$e<he.length;$e++)try{he[$e](performance.now())}catch(we){qn(we)}he.length=0},Po=()=>{ss(ii),ss(Yo),(ye=ii.length>0)&&Gr.raf(Po)},No=he=>ro().then(he),Wn=zi(ii,!1),Dr=zi(Yo,!0)},8077:(Hn,It,X)=>{"use strict";X.r(It),X.d(It,{GESTURE_CONTROLLER:()=>M.G,createGesture:()=>Ke});var M=X(4587);const w=(Qe,ot,mt,xt)=>{const pt=lt(Qe)?{capture:!!xt.capture,passive:!!xt.passive}:!!xt.capture;let et,Ot;return Qe.__zone_symbol__addEventListener?(et="__zone_symbol__addEventListener",Ot="__zone_symbol__removeEventListener"):(et="addEventListener",Ot="removeEventListener"),Qe[et](ot,mt,pt),()=>{Qe[Ot](ot,mt,pt)}},lt=Qe=>{if(void 0===l)try{const ot=Object.defineProperty({},"passive",{get:()=>{l=!0}});Qe.addEventListener("optsTest",()=>{},ot)}catch{l=!1}return!!l};let l;const Le=Qe=>Qe instanceof Document?Qe:Qe.ownerDocument,Ke=Qe=>{let ot=!1,mt=!1,xt=!0,pt=!1;const et=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},Qe),Ot=et.canStart,Pt=et.onWillStart,Ce=et.onStart,Ie=et.onEnd,ct=et.notCaptured,St=et.onMove,Ye=et.threshold,gt=et.passive,Wt=et.blurOnStart,Nt={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},an=((Qe,ot,mt)=>{const xt=mt*(Math.PI/180),pt="x"===Qe,et=Math.cos(xt),Ot=ot*ot;let Pt=0,Ce=0,Ie=!1,ct=0;return{start(St,Ye){Pt=St,Ce=Ye,ct=0,Ie=!0},detect(St,Ye){if(!Ie)return!1;const gt=St-Pt,Wt=Ye-Ce,Nt=gt*gt+Wt*Wt;if(Nt<Ot)return!1;const an=Math.sqrt(Nt),Qt=(pt?gt:Wt)/an;return ct=Qt>et?1:Qt<-et?-1:0,Ie=!1,!0},isGesture:()=>0!==ct,getDirection:()=>ct}})(et.direction,et.threshold,et.maxAngle),Qt=M.G.createGesture({name:Qe.gestureName,priority:Qe.gesturePriority,disableScroll:Qe.disableScroll}),Zt=()=>{ot&&(pt=!1,St&&St(Nt))},Pn=()=>!!Qt.capture()&&(ot=!0,xt=!1,Nt.startX=Nt.currentX,Nt.startY=Nt.currentY,Nt.startTime=Nt.currentTime,Pt?Pt(Nt).then(Se):Se(),!0),Se=()=>{Wt&&(()=>{if(typeof document<"u"){const nn=document.activeElement;nn?.blur&&nn.blur()}})(),Ce&&Ce(Nt),xt=!0},ze=()=>{ot=!1,mt=!1,pt=!1,xt=!0,Qt.release()},ut=nn=>{const ln=ot,_n=xt;if(ze(),_n){if(ye(Nt,nn),ln)return void(Ie&&Ie(Nt));ct&&ct(Nt)}},Dt=((Qe,ot,mt,xt,pt)=>{let et,Ot,Pt,Ce,Ie,ct,St,Ye=0;const gt=zt=>{Ye=Date.now()+2e3,ot(zt)&&(!Ot&&mt&&(Ot=w(Qe,"touchmove",mt,pt)),Pt||(Pt=w(zt.target,"touchend",Nt,pt)),Ce||(Ce=w(zt.target,"touchcancel",Nt,pt)))},Wt=zt=>{Ye>Date.now()||ot(zt)&&(!ct&&mt&&(ct=w(Le(Qe),"mousemove",mt,pt)),St||(St=w(Le(Qe),"mouseup",an,pt)))},Nt=zt=>{Qt(),xt&&xt(zt)},an=zt=>{Vt(),xt&&xt(zt)},Qt=()=>{Ot&&Ot(),Pt&&Pt(),Ce&&Ce(),Ot=Pt=Ce=void 0},Vt=()=>{ct&&ct(),St&&St(),ct=St=void 0},Jn=()=>{Qt(),Vt()},Zt=(zt=!0)=>{zt?(et||(et=w(Qe,"touchstart",gt,pt)),Ie||(Ie=w(Qe,"mousedown",Wt,pt))):(et&&et(),Ie&&Ie(),et=Ie=void 0,Jn())};return{enable:Zt,stop:Jn,destroy:()=>{Zt(!1),xt=mt=ot=void 0}}})(et.el,nn=>{const ln=Ze(nn);return!(mt||!xt||(Ae(nn,Nt),Nt.startX=Nt.currentX,Nt.startY=Nt.currentY,Nt.startTime=Nt.currentTime=ln,Nt.velocityX=Nt.velocityY=Nt.deltaX=Nt.deltaY=0,Nt.event=nn,Ot&&!1===Ot(Nt))||(Qt.release(),!Qt.start()))&&(mt=!0,0===Ye?Pn():(an.start(Nt.startX,Nt.startY),!0))},nn=>{ot?!pt&&xt&&(pt=!0,ye(Nt,nn),requestAnimationFrame(Zt)):(ye(Nt,nn),an.detect(Nt.currentX,Nt.currentY)&&(!an.isGesture()||!Pn())&&jt())},ut,{capture:!1,passive:gt}),jt=()=>{ze(),Dt.stop(),ct&&ct(Nt)};return{enable(nn=!0){nn||(ot&&ut(void 0),ze()),Dt.enable(nn)},destroy(){Qt.destroy(),Dt.destroy()}}},ye=(Qe,ot)=>{if(!ot)return;const mt=Qe.currentX,xt=Qe.currentY,pt=Qe.currentTime;Ae(ot,Qe);const et=Qe.currentX,Ot=Qe.currentY,Ce=(Qe.currentTime=Ze(ot))-pt;if(Ce>0&&Ce<100){const ct=(Ot-xt)/Ce;Qe.velocityX=(et-mt)/Ce*.7+.3*Qe.velocityX,Qe.velocityY=.7*ct+.3*Qe.velocityY}Qe.deltaX=et-Qe.startX,Qe.deltaY=Ot-Qe.startY,Qe.event=ot},Ae=(Qe,ot)=>{let mt=0,xt=0;if(Qe){const pt=Qe.changedTouches;if(pt&&pt.length>0){const et=pt[0];mt=et.clientX,xt=et.clientY}else void 0!==Qe.pageX&&(mt=Qe.pageX,xt=Qe.pageY)}ot.currentX=mt,ot.currentY=xt},Ze=Qe=>Qe.timeStamp||Date.now()},1767:(Hn,It,X)=>{"use strict";X.d(It,{m:()=>Ae});var M=X(5861),w=X(5421),lt=X(544),l=X(7876),_e=X(6506);const Ne=Ze=>(0,_e.c)().duration(Ze?400:300),Le=Ze=>{let Qe,ot;const mt=Ze.width+8,xt=(0,_e.c)(),pt=(0,_e.c)();Ze.isEndSide?(Qe=mt+"px",ot="0px"):(Qe=-mt+"px",ot="0px"),xt.addElement(Ze.menuInnerEl).fromTo("transform",`translateX(${Qe})`,`translateX(${ot})`);const Ot="ios"===(0,l.b)(Ze),Pt=Ot?.2:.25;return pt.addElement(Ze.backdropEl).fromTo("opacity",.01,Pt),Ne(Ot).addAnimation([xt,pt])},tt=Ze=>{let Qe,ot;const mt=(0,l.b)(Ze),xt=Ze.width;Ze.isEndSide?(Qe=-xt+"px",ot=xt+"px"):(Qe=xt+"px",ot=-xt+"px");const pt=(0,_e.c)().addElement(Ze.menuInnerEl).fromTo("transform",`translateX(${ot})`,"translateX(0px)"),et=(0,_e.c)().addElement(Ze.contentEl).fromTo("transform","translateX(0px)",`translateX(${Qe})`),Ot=(0,_e.c)().addElement(Ze.backdropEl).fromTo("opacity",.01,.32);return Ne("ios"===mt).addAnimation([pt,et,Ot])},Ke=Ze=>{const Qe=(0,l.b)(Ze),ot=Ze.width*(Ze.isEndSide?-1:1)+"px",mt=(0,_e.c)().addElement(Ze.contentEl).fromTo("transform","translateX(0px)",`translateX(${ot})`);return Ne("ios"===Qe).addAnimation(mt)},Ae=(()=>{const Ze=new Map,Qe=[],ot=function(){var Se=(0,M.Z)(function*(ze){const ut=yield Ce(ze);return!!ut&&ut.open()});return function(ut){return Se.apply(this,arguments)}}(),mt=function(){var Se=(0,M.Z)(function*(ze){const ut=yield void 0!==ze?Ce(ze):Ie();return void 0!==ut&&ut.close()});return function(ut){return Se.apply(this,arguments)}}(),xt=function(){var Se=(0,M.Z)(function*(ze){const ut=yield Ce(ze);return!!ut&&ut.toggle()});return function(ut){return Se.apply(this,arguments)}}(),pt=function(){var Se=(0,M.Z)(function*(ze,ut){const Dt=yield Ce(ut);return Dt&&(Dt.disabled=!ze),Dt});return function(ut,Dt){return Se.apply(this,arguments)}}(),et=function(){var Se=(0,M.Z)(function*(ze,ut){const Dt=yield Ce(ut);return Dt&&(Dt.swipeGesture=ze),Dt});return function(ut,Dt){return Se.apply(this,arguments)}}(),Ot=function(){var Se=(0,M.Z)(function*(ze){if(null!=ze){const ut=yield Ce(ze);return void 0!==ut&&ut.isOpen()}return void 0!==(yield Ie())});return function(ut){return Se.apply(this,arguments)}}(),Pt=function(){var Se=(0,M.Z)(function*(ze){const ut=yield Ce(ze);return!!ut&&!ut.disabled});return function(ut){return Se.apply(this,arguments)}}(),Ce=function(){var Se=(0,M.Z)(function*(ze){return yield zt(),"start"===ze||"end"===ze?Pn(jt=>jt.side===ze&&!jt.disabled)||Pn(jt=>jt.side===ze):null!=ze?Pn(Dt=>Dt.menuId===ze):Pn(Dt=>!Dt.disabled)||(Qe.length>0?Qe[0].el:void 0)});return function(ut){return Se.apply(this,arguments)}}(),Ie=function(){var Se=(0,M.Z)(function*(){return yield zt(),Vt()});return function(){return Se.apply(this,arguments)}}(),ct=function(){var Se=(0,M.Z)(function*(){return yield zt(),Jn()});return function(){return Se.apply(this,arguments)}}(),St=function(){var Se=(0,M.Z)(function*(){return yield zt(),Zt()});return function(){return Se.apply(this,arguments)}}(),Ye=(Se,ze)=>{Ze.set(Se,ze)},Nt=Se=>{const ze=Se.side;Qe.filter(ut=>ut.side===ze&&ut!==Se).forEach(ut=>ut.disabled=!0)},an=function(){var Se=(0,M.Z)(function*(ze,ut,Dt){if(Zt())return!1;if(ut){const jt=yield Ie();jt&&ze.el!==jt&&(yield jt.setOpen(!1,!1))}return ze._setOpen(ut,Dt)});return function(ut,Dt,jt){return Se.apply(this,arguments)}}(),Vt=()=>Pn(Se=>Se._isOpen),Jn=()=>Qe.map(Se=>Se.el),Zt=()=>Qe.some(Se=>Se.isAnimating),Pn=Se=>{const ze=Qe.find(Se);if(void 0!==ze)return ze.el},zt=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(Se=>new Promise(ze=>(0,lt.c)(Se,ze))));return Ye("reveal",Ke),Ye("push",tt),Ye("overlay",Le),typeof document<"u"&&document.addEventListener("ionBackButton",Se=>{const ze=Vt();ze&&Se.detail.register(w.MENU_BACK_BUTTON_PRIORITY,()=>ze.close())}),{registerAnimation:Ye,get:Ce,getMenus:ct,getOpen:Ie,isEnabled:Pt,swipeGesture:et,isAnimating:St,isOpen:Ot,enable:pt,toggle:xt,close:mt,open:ot,_getOpenSync:Vt,_createAnimation:(Se,ze)=>{const ut=Ze.get(Se);if(!ut)throw new Error("animation not registered");return ut(ze)},_register:Se=>{Qe.indexOf(Se)<0&&(Se.disabled||Nt(Se),Qe.push(Se))},_unregister:Se=>{const ze=Qe.indexOf(Se);ze>-1&&Qe.splice(ze,1)},_setOpen:an,_setActiveMenu:Nt}})()},8354:(Hn,It,X)=>{"use strict";X.d(It,{L:()=>l,a:()=>_e,b:()=>Ne,c:()=>Le,d:()=>tt,e:()=>Ye,g:()=>Nt,l:()=>ct,s:()=>gt,t:()=>Ae,w:()=>St});var M=X(5861),w=X(6953),lt=X(544);const l="ionViewWillEnter",_e="ionViewDidEnter",Ne="ionViewWillLeave",Le="ionViewDidLeave",tt="ionViewWillUnload",Ae=an=>new Promise((Qt,Vt)=>{(0,w.w)(()=>{Ze(an),Qe(an).then(Jn=>{Jn.animation&&Jn.animation.destroy(),ot(an),Qt(Jn)},Jn=>{ot(an),Vt(Jn)})})}),Ze=an=>{const Qt=an.enteringEl,Vt=an.leavingEl;Wt(Qt,Vt,an.direction),an.showGoBack?Qt.classList.add("can-go-back"):Qt.classList.remove("can-go-back"),gt(Qt,!1),Qt.style.setProperty("pointer-events","none"),Vt&&(gt(Vt,!1),Vt.style.setProperty("pointer-events","none"))},Qe=function(){var an=(0,M.Z)(function*(Qt){const Vt=yield mt(Qt);return Vt&&w.B.isBrowser?xt(Vt,Qt):pt(Qt)});return function(Vt){return an.apply(this,arguments)}}(),ot=an=>{const Qt=an.enteringEl,Vt=an.leavingEl;Qt.classList.remove("ion-page-invisible"),Qt.style.removeProperty("pointer-events"),void 0!==Vt&&(Vt.classList.remove("ion-page-invisible"),Vt.style.removeProperty("pointer-events"))},mt=function(){var an=(0,M.Z)(function*(Qt){return Qt.leavingEl&&Qt.animated&&0!==Qt.duration?Qt.animationBuilder?Qt.animationBuilder:"ios"===Qt.mode?(yield Promise.resolve().then(X.bind(X,8899))).iosTransitionAnimation:(yield Promise.resolve().then(X.bind(X,5298))).mdTransitionAnimation:void 0});return function(Vt){return an.apply(this,arguments)}}(),xt=function(){var an=(0,M.Z)(function*(Qt,Vt){yield et(Vt,!0);const Jn=Qt(Vt.baseEl,Vt);Ce(Vt.enteringEl,Vt.leavingEl);const Zt=yield Pt(Jn,Vt);return Vt.progressCallback&&Vt.progressCallback(void 0),Zt&&Ie(Vt.enteringEl,Vt.leavingEl),{hasCompleted:Zt,animation:Jn}});return function(Vt,Jn){return an.apply(this,arguments)}}(),pt=function(){var an=(0,M.Z)(function*(Qt){const Vt=Qt.enteringEl,Jn=Qt.leavingEl;return yield et(Qt,!1),Ce(Vt,Jn),Ie(Vt,Jn),{hasCompleted:!0}});return function(Vt){return an.apply(this,arguments)}}(),et=function(){var an=(0,M.Z)(function*(Qt,Vt){(void 0!==Qt.deepWait?Qt.deepWait:Vt)&&(yield Promise.all([Ye(Qt.enteringEl),Ye(Qt.leavingEl)])),yield Ot(Qt.viewIsReady,Qt.enteringEl)});return function(Vt,Jn){return an.apply(this,arguments)}}(),Ot=function(){var an=(0,M.Z)(function*(Qt,Vt){Qt&&(yield Qt(Vt))});return function(Vt,Jn){return an.apply(this,arguments)}}(),Pt=(an,Qt)=>{const Vt=Qt.progressCallback,Jn=new Promise(Zt=>{an.onFinish(Pn=>Zt(1===Pn))});return Vt?(an.progressStart(!0),Vt(an)):an.play(),Jn},Ce=(an,Qt)=>{ct(Qt,Ne),ct(an,l)},Ie=(an,Qt)=>{ct(an,_e),ct(Qt,Le)},ct=(an,Qt)=>{if(an){const Vt=new CustomEvent(Qt,{bubbles:!1,cancelable:!1});an.dispatchEvent(Vt)}},St=()=>new Promise(an=>(0,lt.r)(()=>(0,lt.r)(()=>an()))),Ye=function(){var an=(0,M.Z)(function*(Qt){const Vt=Qt;if(Vt){if(null!=Vt.componentOnReady){if(null!=(yield Vt.componentOnReady()))return}else if(null!=Vt.__registerHost)return void(yield new Promise(Zt=>(0,lt.r)(Zt)));yield Promise.all(Array.from(Vt.children).map(Ye))}});return function(Vt){return an.apply(this,arguments)}}(),gt=(an,Qt)=>{Qt?(an.setAttribute("aria-hidden","true"),an.classList.add("ion-page-hidden")):(an.hidden=!1,an.removeAttribute("aria-hidden"),an.classList.remove("ion-page-hidden"))},Wt=(an,Qt,Vt)=>{void 0!==an&&(an.style.zIndex="back"===Vt?"99":"101"),void 0!==Qt&&(Qt.style.zIndex="100")},Nt=an=>an.classList.contains("ion-page")?an:an.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||an},7643:(Hn,It,X)=>{"use strict";X.d(It,{d:()=>w,w:()=>M});const M=typeof window<"u"?window:void 0,w=typeof document<"u"?document:void 0},7690:(Hn,It,X)=>{"use strict";X.d(It,{a:()=>w,b:()=>lt,p:()=>M});const M=(l,..._e)=>console.warn(`[Ionic Warning]: ${l}`,..._e),w=(l,..._e)=>console.error(`[Ionic Error]: ${l}`,..._e),lt=(l,..._e)=>console.error(`<${l.tagName.toLowerCase()}> must be used inside ${_e.join(" or ")}.`)},7876:(Hn,It,X)=>{"use strict";X.d(It,{a:()=>Ae,b:()=>Zt,c:()=>lt,g:()=>ye,i:()=>Pn});var M=X(6953);class w{constructor(){this.m=new Map}reset(Se){this.m=new Map(Object.entries(Se))}get(Se,ze){const ut=this.m.get(Se);return void 0!==ut?ut:ze}getBoolean(Se,ze=!1){const ut=this.m.get(Se);return void 0===ut?ze:"string"==typeof ut?"true"===ut:!!ut}getNumber(Se,ze){const ut=parseFloat(this.m.get(Se));return isNaN(ut)?void 0!==ze?ze:NaN:ut}set(Se,ze){this.m.set(Se,ze)}}const lt=new w,Ke="ionic-persist-config",ye=zt=>Ze(zt),Ae=(zt,Se)=>("string"==typeof zt&&(Se=zt,zt=void 0),ye(zt).includes(Se)),Ze=(zt=window)=>{if(typeof zt>"u")return[];zt.Ionic=zt.Ionic||{};let Se=zt.Ionic.platforms;return null==Se&&(Se=zt.Ionic.platforms=Qe(zt),Se.forEach(ze=>zt.document.documentElement.classList.add(`plt-${ze}`))),Se},Qe=zt=>{const Se=lt.get("platform");return Object.keys(Vt).filter(ze=>{const ut=Se?.[ze];return"function"==typeof ut?ut(zt):Vt[ze](zt)})},mt=zt=>!!(an(zt,/iPad/i)||an(zt,/Macintosh/i)&&Ie(zt)),et=zt=>an(zt,/android|sink/i),Ie=zt=>Qt(zt,"(any-pointer:coarse)"),St=zt=>Ye(zt)||gt(zt),Ye=zt=>!!(zt.cordova||zt.phonegap||zt.PhoneGap),gt=zt=>{const Se=zt.Capacitor;return!!Se?.isNative},an=(zt,Se)=>Se.test(zt.navigator.userAgent),Qt=(zt,Se)=>{var ze;return null===(ze=zt.matchMedia)||void 0===ze?void 0:ze.call(zt,Se).matches},Vt={ipad:mt,iphone:zt=>an(zt,/iPhone/i),ios:zt=>an(zt,/iPhone|iPod/i)||mt(zt),android:et,phablet:zt=>{const Se=zt.innerWidth,ze=zt.innerHeight,ut=Math.min(Se,ze),Dt=Math.max(Se,ze);return ut>390&&ut<520&&Dt>620&&Dt<800},tablet:zt=>{const Se=zt.innerWidth,ze=zt.innerHeight,ut=Math.min(Se,ze),Dt=Math.max(Se,ze);return mt(zt)||(zt=>et(zt)&&!an(zt,/mobile/i))(zt)||ut>460&&ut<820&&Dt>780&&Dt<1400},cordova:Ye,capacitor:gt,electron:zt=>an(zt,/electron/i),pwa:zt=>{var Se;return!!(null!==(Se=zt.matchMedia)&&void 0!==Se&&Se.call(zt,"(display-mode: standalone)").matches||zt.navigator.standalone)},mobile:Ie,mobileweb:zt=>Ie(zt)&&!St(zt),desktop:zt=>!Ie(zt),hybrid:St};let Jn;const Zt=zt=>zt&&(0,M.g)(zt)||Jn,Pn=(zt={})=>{if(typeof window>"u")return;const Se=window.document,ze=window,ut=ze.Ionic=ze.Ionic||{},Dt={};zt._ael&&(Dt.ael=zt._ael),zt._rel&&(Dt.rel=zt._rel),zt._ce&&(Dt.ce=zt._ce),(0,M.a)(Dt);const jt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(zt=>{try{const Se=zt.sessionStorage.getItem(Ke);return null!==Se?JSON.parse(Se):{}}catch{return{}}})(ze)),{persistConfig:!1}),ut.config),(zt=>{const Se={};return zt.location.search.slice(1).split("&").map(ze=>ze.split("=")).map(([ze,ut])=>[decodeURIComponent(ze),decodeURIComponent(ut)]).filter(([ze])=>((zt,Se)=>zt.substr(0,Se.length)===Se)(ze,"ionic:")).map(([ze,ut])=>[ze.slice(6),ut]).forEach(([ze,ut])=>{Se[ze]=ut}),Se})(ze)),zt);lt.reset(jt),lt.getBoolean("persistConfig")&&((zt,Se)=>{try{zt.sessionStorage.setItem(Ke,JSON.stringify(Se))}catch{return}})(ze,jt),Ze(ze),ut.config=lt,ut.mode=Jn=lt.get("mode",Se.documentElement.getAttribute("mode")||(Ae(ze,"ios")?"ios":"md")),lt.set("mode",Jn),Se.documentElement.setAttribute("mode",Jn),Se.documentElement.classList.add(Jn),lt.getBoolean("_testing")&&lt.set("animated",!1);const nn=_n=>{var bn;return null===(bn=_n.tagName)||void 0===bn?void 0:bn.startsWith("ION-")},ln=_n=>["ios","md"].includes(_n);(0,M.c)(_n=>{for(;_n;){const bn=_n.mode||_n.getAttribute("mode");if(bn){if(ln(bn))return bn;nn(_n)&&console.warn('Invalid ionic mode: "'+bn+'", expected: "ios" or "md"')}_n=_n.parentElement}return Jn})}},8899:(Hn,It,X)=>{"use strict";X.r(It),X.d(It,{iosTransitionAnimation:()=>Qe,shadow:()=>Le});var M=X(6506),w=X(8354);X(7643),X(6953);const Ne=ot=>document.querySelector(`${ot}.ion-cloned-element`),Le=ot=>ot.shadowRoot||ot,tt=ot=>{const mt="ION-TABS"===ot.tagName?ot:ot.querySelector("ion-tabs"),xt="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=mt){const pt=mt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=pt?pt.querySelector(xt):null}return ot.querySelector(xt)},Ke=(ot,mt)=>{const xt="ION-TABS"===ot.tagName?ot:ot.querySelector("ion-tabs");let pt=[];if(null!=xt){const et=xt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=et&&(pt=et.querySelectorAll("ion-buttons"))}else pt=ot.querySelectorAll("ion-buttons");for(const et of pt){const Ot=et.closest("ion-header"),Pt=Ot&&!Ot.classList.contains("header-collapse-condense-inactive"),Ce=et.querySelector("ion-back-button"),Ie=et.classList.contains("buttons-collapse");if(null!==Ce&&("start"===et.slot||""===et.slot)&&(Ie&&Pt&&mt||!Ie))return Ce}return null},Ae=(ot,mt,xt,pt,et,Ot)=>{const Pt=mt?`calc(100% - ${Ot.right+4}px)`:Ot.left-4+"px",Ce=mt?"7px":"-7px",Ie=mt?"-4px":"4px",ct=mt?"-4px":"4px",St=mt?"right":"left",Ye=mt?"left":"right",Nt=xt?[{offset:0,opacity:1,transform:`translate3d(${Ie}, ${Ot.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Ce}, ${et.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Ce}, ${et.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${Ie}, ${Ot.top-46}px, 0) scale(1)`}],Vt=xt?[{offset:0,opacity:1,transform:`translate3d(${ct}, ${Ot.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${ct}, ${Ot.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${ct}, ${Ot.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${ct}, ${Ot.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${ct}, ${Ot.top-46}px, 0) scale(1)`}],Jn=(0,M.c)(),Zt=(0,M.c)(),Pn=Ne("ion-back-button"),zt=Le(Pn).querySelector(".button-text"),Se=Le(Pn).querySelector("ion-icon");Pn.text=pt.text,Pn.mode=pt.mode,Pn.icon=pt.icon,Pn.color=pt.color,Pn.disabled=pt.disabled,Pn.style.setProperty("display","block"),Pn.style.setProperty("position","fixed"),Zt.addElement(Se),Jn.addElement(zt),Jn.beforeStyles({"transform-origin":`${St} center`}).beforeAddWrite(()=>{pt.style.setProperty("display","none"),Pn.style.setProperty(St,Pt)}).afterAddWrite(()=>{pt.style.setProperty("display",""),Pn.style.setProperty("display","none"),Pn.style.removeProperty(St)}).keyframes(Nt),Zt.beforeStyles({"transform-origin":`${Ye} center`}).keyframes(Vt),ot.addAnimation([Jn,Zt])},Ze=(ot,mt,xt,pt,et,Ot)=>{const Pt=mt?`calc(100% - ${et.right}px)`:`${et.left}px`,Ce=mt?"-18px":"18px",Ie=mt?"right":"left",Ye=xt?[{offset:0,opacity:0,transform:`translate3d(${Ce}, ${Ot.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${et.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${et.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Ce}, ${Ot.top-4}px, 0) scale(0.5)`}],gt=Ne("ion-title"),Wt=(0,M.c)();gt.innerText=pt.innerText,gt.size=pt.size,gt.color=pt.color,Wt.addElement(gt),Wt.beforeStyles({"transform-origin":`${Ie} center`,height:"46px",display:"",position:"relative",[Ie]:Pt}).beforeAddWrite(()=>{pt.style.setProperty("display","none")}).afterAddWrite(()=>{pt.style.setProperty("display",""),gt.style.setProperty("display","none")}).keyframes(Ye),ot.addAnimation(Wt)},Qe=(ot,mt)=>{var xt;try{const pt="cubic-bezier(0.32,0.72,0,1)",et="opacity",Ot="transform",Pt="0%",Ie="rtl"===ot.ownerDocument.dir,ct=Ie?"-99.5%":"99.5%",St=Ie?"33%":"-33%",Ye=mt.enteringEl,gt=mt.leavingEl,Wt="back"===mt.direction,Nt=Ye.querySelector(":scope > ion-content"),an=Ye.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),Qt=Ye.querySelectorAll(":scope > ion-header > ion-toolbar"),Vt=(0,M.c)(),Jn=(0,M.c)();if(Vt.addElement(Ye).duration((null!==(xt=mt.duration)&&void 0!==xt?xt:0)||540).easing(mt.easing||pt).fill("both").beforeRemoveClass("ion-page-invisible"),gt&&null!=ot){const Se=(0,M.c)();Se.addElement(ot),Vt.addAnimation(Se)}if(Nt||0!==Qt.length||0!==an.length?(Jn.addElement(Nt),Jn.addElement(an)):Jn.addElement(Ye.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Vt.addAnimation(Jn),Wt?Jn.beforeClearStyles([et]).fromTo("transform",`translateX(${St})`,`translateX(${Pt})`).fromTo(et,.8,1):Jn.beforeClearStyles([et]).fromTo("transform",`translateX(${ct})`,`translateX(${Pt})`),Nt){const Se=Le(Nt).querySelector(".transition-effect");if(Se){const ze=Se.querySelector(".transition-cover"),ut=Se.querySelector(".transition-shadow"),Dt=(0,M.c)(),jt=(0,M.c)(),nn=(0,M.c)();Dt.addElement(Se).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),jt.addElement(ze).beforeClearStyles([et]).fromTo(et,0,.1),nn.addElement(ut).beforeClearStyles([et]).fromTo(et,.03,.7),Dt.addAnimation([jt,nn]),Jn.addAnimation([Dt])}}const Zt=Ye.querySelector("ion-header.header-collapse-condense"),{forward:Pn,backward:zt}=((ot,mt,xt,pt,et)=>{const Ot=Ke(pt,xt),Pt=tt(et),Ce=tt(pt),Ie=Ke(et,xt),ct=null!==Ot&&null!==Pt&&!xt,St=null!==Ce&&null!==Ie&&xt;if(ct){const Ye=Pt.getBoundingClientRect(),gt=Ot.getBoundingClientRect();Ze(ot,mt,xt,Pt,Ye,gt),Ae(ot,mt,xt,Ot,Ye,gt)}else if(St){const Ye=Ce.getBoundingClientRect(),gt=Ie.getBoundingClientRect();Ze(ot,mt,xt,Ce,Ye,gt),Ae(ot,mt,xt,Ie,Ye,gt)}return{forward:ct,backward:St}})(Vt,Ie,Wt,Ye,gt);if(Qt.forEach(Se=>{const ze=(0,M.c)();ze.addElement(Se),Vt.addAnimation(ze);const ut=(0,M.c)();ut.addElement(Se.querySelector("ion-title"));const Dt=(0,M.c)(),jt=Array.from(Se.querySelectorAll("ion-buttons,[menuToggle]")),nn=Se.closest("ion-header"),ln=nn?.classList.contains("header-collapse-condense-inactive");let _n;_n=jt.filter(Wt?dn=>{const Fn=dn.classList.contains("buttons-collapse");return Fn&&!ln||!Fn}:dn=>!dn.classList.contains("buttons-collapse")),Dt.addElement(_n);const bn=(0,M.c)();bn.addElement(Se.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const rn=(0,M.c)();rn.addElement(Le(Se).querySelector(".toolbar-background"));const Jt=(0,M.c)(),en=Se.querySelector("ion-back-button");if(en&&Jt.addElement(en),ze.addAnimation([ut,Dt,bn,rn,Jt]),Dt.fromTo(et,.01,1),bn.fromTo(et,.01,1),Wt)ln||ut.fromTo("transform",`translateX(${St})`,`translateX(${Pt})`).fromTo(et,.01,1),bn.fromTo("transform",`translateX(${St})`,`translateX(${Pt})`),Jt.fromTo(et,.01,1);else if(Zt||ut.fromTo("transform",`translateX(${ct})`,`translateX(${Pt})`).fromTo(et,.01,1),bn.fromTo("transform",`translateX(${ct})`,`translateX(${Pt})`),rn.beforeClearStyles([et,"transform"]),nn?.translucent?rn.fromTo("transform",Ie?"translateX(-100%)":"translateX(100%)","translateX(0px)"):rn.fromTo(et,.01,"var(--opacity)"),Pn||Jt.fromTo(et,.01,1),en&&!Pn){const Fn=(0,M.c)();Fn.addElement(Le(en).querySelector(".button-text")).fromTo("transform",Ie?"translateX(-100px)":"translateX(100px)","translateX(0px)"),ze.addAnimation(Fn)}}),gt){const Se=(0,M.c)(),ze=gt.querySelector(":scope > ion-content"),ut=gt.querySelectorAll(":scope > ion-header > ion-toolbar"),Dt=gt.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(ze||0!==ut.length||0!==Dt.length?(Se.addElement(ze),Se.addElement(Dt)):Se.addElement(gt.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Vt.addAnimation(Se),Wt){Se.beforeClearStyles([et]).fromTo("transform",`translateX(${Pt})`,Ie?"translateX(-100%)":"translateX(100%)");const jt=(0,w.g)(gt);Vt.afterAddWrite(()=>{"normal"===Vt.getDirection()&&jt.style.setProperty("display","none")})}else Se.fromTo("transform",`translateX(${Pt})`,`translateX(${St})`).fromTo(et,1,.8);if(ze){const jt=Le(ze).querySelector(".transition-effect");if(jt){const nn=jt.querySelector(".transition-cover"),ln=jt.querySelector(".transition-shadow"),_n=(0,M.c)(),bn=(0,M.c)(),rn=(0,M.c)();_n.addElement(jt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),bn.addElement(nn).beforeClearStyles([et]).fromTo(et,.1,0),rn.addElement(ln).beforeClearStyles([et]).fromTo(et,.7,.03),_n.addAnimation([bn,rn]),Se.addAnimation([_n])}}ut.forEach(jt=>{const nn=(0,M.c)();nn.addElement(jt);const ln=(0,M.c)();ln.addElement(jt.querySelector("ion-title"));const _n=(0,M.c)(),bn=jt.querySelectorAll("ion-buttons,[menuToggle]"),rn=jt.closest("ion-header"),Jt=rn?.classList.contains("header-collapse-condense-inactive"),en=Array.from(bn).filter(Xn=>{const Lr=Xn.classList.contains("buttons-collapse");return Lr&&!Jt||!Lr});_n.addElement(en);const dn=(0,M.c)(),Fn=jt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");Fn.length>0&&dn.addElement(Fn);const pr=(0,M.c)();pr.addElement(Le(jt).querySelector(".toolbar-background"));const nr=(0,M.c)(),gr=jt.querySelector("ion-back-button");if(gr&&nr.addElement(gr),nn.addAnimation([ln,_n,dn,nr,pr]),Vt.addAnimation(nn),nr.fromTo(et,.99,0),_n.fromTo(et,.99,0),dn.fromTo(et,.99,0),Wt){if(Jt||ln.fromTo("transform",`translateX(${Pt})`,Ie?"translateX(-100%)":"translateX(100%)").fromTo(et,.99,0),dn.fromTo("transform",`translateX(${Pt})`,Ie?"translateX(-100%)":"translateX(100%)"),pr.beforeClearStyles([et,"transform"]),rn?.translucent?pr.fromTo("transform","translateX(0px)",Ie?"translateX(-100%)":"translateX(100%)"):pr.fromTo(et,"var(--opacity)",0),gr&&!zt){const Lr=(0,M.c)();Lr.addElement(Le(gr).querySelector(".button-text")).fromTo("transform",`translateX(${Pt})`,`translateX(${(Ie?-124:124)+"px"})`),nn.addAnimation(Lr)}}else Jt||ln.fromTo("transform",`translateX(${Pt})`,`translateX(${St})`).fromTo(et,.99,0).afterClearStyles([Ot,et]),dn.fromTo("transform",`translateX(${Pt})`,`translateX(${St})`).afterClearStyles([Ot,et]),nr.afterClearStyles([et]),ln.afterClearStyles([et]),_n.afterClearStyles([et])})}return Vt}catch(pt){throw pt}}},5298:(Hn,It,X)=>{"use strict";X.r(It),X.d(It,{mdTransitionAnimation:()=>_e});var M=X(6506),w=X(8354);X(7643),X(6953);const _e=(Ne,Le)=>{var tt,Ke,ye;const Qe="back"===Le.direction,mt=Le.leavingEl,xt=(0,w.g)(Le.enteringEl),pt=xt.querySelector("ion-toolbar"),et=(0,M.c)();if(et.addElement(xt).fill("both").beforeRemoveClass("ion-page-invisible"),Qe?et.duration((null!==(tt=Le.duration)&&void 0!==tt?tt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):et.duration((null!==(Ke=Le.duration)&&void 0!==Ke?Ke:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),pt){const Ot=(0,M.c)();Ot.addElement(pt),et.addAnimation(Ot)}if(mt&&Qe){et.duration((null!==(ye=Le.duration)&&void 0!==ye?ye:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const Ot=(0,M.c)();Ot.addElement((0,w.g)(mt)).onFinish(Pt=>{1===Pt&&Ot.elements.length>0&&Ot.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),et.addAnimation(Ot)}return et}},8946:(Hn,It,X)=>{"use strict";X.d(It,{B:()=>nn,G:()=>ln,a:()=>Ae,b:()=>Ze,c:()=>xt,d:()=>_n,e:()=>bn,f:()=>Vt,g:()=>Zt,h:()=>Se,i:()=>ut,j:()=>et,k:()=>Ot,l:()=>Qe,m:()=>ot,n:()=>Ke,o:()=>Ie,q:()=>an,s:()=>jt,t:()=>pt});var M=X(5861),w=X(7876),lt=X(9439),l=X(5421),_e=X(544),Ne=X(7690);let Le=0,tt=0;const Ke=new WeakMap,ye=rn=>({create:Jt=>Pt(rn,Jt),dismiss:(Jt,en,dn)=>Wt(document,Jt,en,rn,dn),getTop:()=>(0,M.Z)(function*(){return an(document,rn)})()}),Ae=ye("ion-alert"),Ze=ye("ion-action-sheet"),Qe=ye("ion-loading"),ot=ye("ion-modal"),xt=ye("ion-popover"),pt=ye("ion-toast"),et=rn=>{typeof document<"u"&&gt(document);const Jt=Le++;rn.overlayIndex=Jt},Ot=rn=>(rn.hasAttribute("id")||(rn.id="ion-overlay-"+ ++tt),rn.id),Pt=(rn,Jt)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(rn).then(()=>{const en=document.createElement(rn);return en.classList.add("overlay-hidden"),Object.assign(en,Object.assign(Object.assign({},Jt),{hasController:!0})),Pn(document).appendChild(en),new Promise(dn=>(0,_e.c)(en,dn))}):Promise.resolve(),Ce='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Ie=(rn,Jt)=>{let en=rn.querySelector(Ce);const dn=en?.shadowRoot;dn&&(en=dn.querySelector(Ce)||en),en?(0,_e.f)(en):Jt.focus()},St=(rn,Jt)=>{const en=Array.from(rn.querySelectorAll(Ce));let dn=en.length>0?en[en.length-1]:null;const Fn=dn?.shadowRoot;Fn&&(dn=Fn.querySelector(Ce)||dn),dn?dn.focus():Jt.focus()},gt=rn=>{0===Le&&(Le=1,rn.addEventListener("focus",Jt=>{((rn,Jt)=>{const en=an(Jt,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),dn=rn.target;en&&dn&&!en.classList.contains("ion-disable-focus-trap")&&(en.shadowRoot?(()=>{if(en.contains(dn))en.lastFocus=dn;else{const nr=en.lastFocus;Ie(en,en),nr===Jt.activeElement&&St(en,en),en.lastFocus=Jt.activeElement}})():(()=>{if(en===dn)en.lastFocus=void 0;else{const nr=(0,_e.g)(en);if(!nr.contains(dn))return;const gr=nr.querySelector(".ion-overlay-wrapper");if(!gr)return;if(gr.contains(dn)||dn===nr.querySelector("ion-backdrop"))en.lastFocus=dn;else{const Xn=en.lastFocus;Ie(gr,en),Xn===Jt.activeElement&&St(gr,en),en.lastFocus=Jt.activeElement}}})())})(Jt,rn)},!0),rn.addEventListener("ionBackButton",Jt=>{const en=an(rn);en?.backdropDismiss&&Jt.detail.register(l.OVERLAY_BACK_BUTTON_PRIORITY,()=>en.dismiss(void 0,nn))}),rn.addEventListener("keydown",Jt=>{if("Escape"===Jt.key){const en=an(rn);en?.backdropDismiss&&en.dismiss(void 0,nn)}}))},Wt=(rn,Jt,en,dn,Fn)=>{const pr=an(rn,dn,Fn);return pr?pr.dismiss(Jt,en):Promise.reject("overlay does not exist")},an=(rn,Jt,en)=>{const dn=((rn,Jt)=>(void 0===Jt&&(Jt="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(rn.querySelectorAll(Jt)).filter(en=>en.overlayIndex>0)))(rn,Jt).filter(Fn=>!(rn=>rn.classList.contains("overlay-hidden"))(Fn));return void 0===en?dn[dn.length-1]:dn.find(Fn=>Fn.id===en)},Qt=(rn=!1)=>{const en=Pn(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");en&&(rn?en.setAttribute("aria-hidden","true"):en.removeAttribute("aria-hidden"))},Vt=function(){var rn=(0,M.Z)(function*(Jt,en,dn,Fn,pr){var nr,gr;if(Jt.presented)return;Qt(!0),Jt.presented=!0,Jt.willPresent.emit(),null===(nr=Jt.willPresentShorthand)||void 0===nr||nr.emit();const Xn=(0,w.b)(Jt),Lr=Jt.enterAnimation?Jt.enterAnimation:w.c.get(en,"ios"===Xn?dn:Fn);(yield zt(Jt,Lr,Jt.el,pr))&&(Jt.didPresent.emit(),null===(gr=Jt.didPresentShorthand)||void 0===gr||gr.emit()),"ION-TOAST"!==Jt.el.tagName&&Jn(Jt.el),Jt.keyboardClose&&(null===document.activeElement||!Jt.el.contains(document.activeElement))&&Jt.el.focus()});return function(en,dn,Fn,pr,nr){return rn.apply(this,arguments)}}(),Jn=function(){var rn=(0,M.Z)(function*(Jt){let en=document.activeElement;if(!en)return;const dn=en?.shadowRoot;dn&&(en=dn.querySelector(Ce)||en),yield Jt.onDidDismiss(),en.focus()});return function(en){return rn.apply(this,arguments)}}(),Zt=function(){var rn=(0,M.Z)(function*(Jt,en,dn,Fn,pr,nr,gr){var Xn,Lr;if(!Jt.presented)return!1;Qt(!1),Jt.presented=!1;try{Jt.el.style.setProperty("pointer-events","none"),Jt.willDismiss.emit({data:en,role:dn}),null===(Xn=Jt.willDismissShorthand)||void 0===Xn||Xn.emit({data:en,role:dn});const yn=(0,w.b)(Jt),Jr=Jt.leaveAnimation?Jt.leaveAnimation:w.c.get(Fn,"ios"===yn?pr:nr);dn!==ln&&(yield zt(Jt,Jr,Jt.el,gr)),Jt.didDismiss.emit({data:en,role:dn}),null===(Lr=Jt.didDismissShorthand)||void 0===Lr||Lr.emit({data:en,role:dn}),Ke.delete(Jt),Jt.el.classList.add("overlay-hidden"),Jt.el.style.removeProperty("pointer-events"),void 0!==Jt.el.lastFocus&&(Jt.el.lastFocus=void 0)}catch(yn){console.error(yn)}return Jt.el.remove(),!0});return function(en,dn,Fn,pr,nr,gr,Xn){return rn.apply(this,arguments)}}(),Pn=rn=>rn.querySelector("ion-app")||rn.body,zt=function(){var rn=(0,M.Z)(function*(Jt,en,dn,Fn){dn.classList.remove("overlay-hidden");const nr=en(Jt.el,Fn);(!Jt.animated||!w.c.getBoolean("animated",!0))&&nr.duration(0),Jt.keyboardClose&&nr.beforeAddWrite(()=>{const Xn=dn.ownerDocument.activeElement;Xn?.matches("input,ion-input, ion-textarea")&&Xn.blur()});const gr=Ke.get(Jt)||[];return Ke.set(Jt,[...gr,nr]),yield nr.play(),!0});return function(en,dn,Fn,pr){return rn.apply(this,arguments)}}(),Se=(rn,Jt)=>{let en;const dn=new Promise(Fn=>en=Fn);return ze(rn,Jt,Fn=>{en(Fn.detail)}),dn},ze=(rn,Jt,en)=>{const dn=Fn=>{(0,_e.b)(rn,Jt,dn),en(Fn)};(0,_e.a)(rn,Jt,dn)},ut=rn=>"cancel"===rn||rn===nn,Dt=rn=>rn(),jt=(rn,Jt)=>{if("function"==typeof rn)return w.c.get("_zoneGate",Dt)(()=>{try{return rn(Jt)}catch(dn){throw dn}})},nn="backdrop",ln="gesture",_n=rn=>{let en,Jt=!1;const dn=(0,lt.C)(),Fn=(gr=!1)=>{if(en&&!gr)return{delegate:en,inline:Jt};const{el:Xn,hasController:Lr,delegate:yn}=rn;return Jt=null!==Xn.parentNode&&!Lr,en=Jt?yn||dn:yn,{inline:Jt,delegate:en}};return{attachViewToDom:function(){var gr=(0,M.Z)(function*(Xn){const{delegate:Lr}=Fn(!0);if(Lr)return yield Lr.attachViewToDom(rn.el,Xn);const{hasController:yn}=rn;if(yn&&void 0!==Xn)throw new Error("framework delegate is missing");return null});return function(Lr){return gr.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:gr}=Fn();gr&&void 0!==rn.el&&gr.removeViewFromDom(rn.el.parentElement,rn.el)}}},bn=()=>{let rn;const Jt=()=>{rn&&(rn(),rn=void 0)};return{addClickListener:(dn,Fn)=>{Jt();const pr=void 0!==Fn?document.getElementById(Fn):null;pr?rn=((gr,Xn)=>{const Lr=()=>{Xn.present()};return gr.addEventListener("click",Lr),()=>{gr.removeEventListener("click",Lr)}})(pr,dn):(0,Ne.p)(`A trigger element with the ID "${Fn}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,dn)},removeClickListener:Jt}}},335:(Hn,It,X)=>{"use strict";var M=X(6593),w=X(5879),lt=X(1160),l=X(7852);let _e=(()=>{var v;class g{constructor(){}}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275cmp=w.Xpm({type:v,selectors:[["app-root"]],decls:2,vars:0,template:function(S,$){1&S&&(w.TgZ(0,"ion-app"),w._UZ(1,"ion-router-outlet"),w.qZA())},dependencies:[l.dr,l.jP]}),g})(),Ne=(()=>{var v;class g{constructor(){this.navCTRL=(0,w.tBr)(l.SH)}canActivate(S,$){return!!localStorage.getItem("ingresado")||(this.navCTRL.navigateRoot("login"),!1)}}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),g})();const tt=[{path:"home",loadChildren:()=>X.e(1605).then(X.bind(X,1605)).then(v=>v.HomePageModule),canActivate:[Ne]},{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadChildren:()=>X.e(6488).then(X.bind(X,6488)).then(v=>v.LoginPageModule),canActivate:[(()=>{var v;class g{constructor(){this.navCTRL=(0,w.f3M)(l.SH)}canActivate(S,$){return!localStorage.getItem("ingresado")||(this.navCTRL.navigateRoot("home"),!1)}}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),g})()]},{path:"historial",loadChildren:()=>X.e(3030).then(X.bind(X,3030)).then(v=>v.HistorialPageModule),canActivate:[Ne]},{path:"perfil",loadChildren:()=>Promise.all([X.e(6488),X.e(280)]).then(X.bind(X,280)).then(v=>v.PerfilPageModule),canActivate:[Ne]},{path:"mapa-x",loadChildren:()=>X.e(5001).then(X.bind(X,5001)).then(v=>v.MapaXPageModule),canActivate:[Ne]},{path:"config",loadChildren:()=>X.e(6305).then(X.bind(X,6305)).then(v=>v.ConfigPageModule),canActivate:[Ne]},{path:"**",loadChildren:()=>X.e(1123).then(X.bind(X,1123)).then(v=>v.NotfoundPageModule),canActivate:[Ne]}];let Ke=(()=>{var v;class g{}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275mod=w.oAB({type:v}),v.\u0275inj=w.cJS({imports:[lt.Bz.forRoot(tt,{preloadingStrategy:lt.wm}),lt.Bz]}),g})();var ye=X(6825);function Ze(v){return new w.vHH(3e3,!1)}function Fn(v){switch(v.length){case 0:return new ye.ZN;case 1:return v[0];default:return new ye.ZE(v)}}function pr(v,g,E=new Map,S=new Map){const $=[],te=[];let ve=-1,me=null;if(g.forEach(st=>{const $t=st.get("offset"),er=$t==ve,Yn=er&&me||new Map;st.forEach((Nr,Wr)=>{let Sr=Wr,Zr=Nr;if("offset"!==Wr)switch(Sr=v.normalizePropertyName(Sr,$),Zr){case ye.k1:Zr=E.get(Wr);break;case ye.l3:Zr=S.get(Wr);break;default:Zr=v.normalizeStyleValue(Wr,Sr,Zr,$)}Yn.set(Sr,Zr)}),er||te.push(Yn),me=Yn,ve=$t}),$.length)throw function Se(v){return new w.vHH(3502,!1)}();return te}function nr(v,g,E,S){switch(g){case"start":v.onStart(()=>S(E&&gr(E,"start",v)));break;case"done":v.onDone(()=>S(E&&gr(E,"done",v)));break;case"destroy":v.onDestroy(()=>S(E&&gr(E,"destroy",v)))}}function gr(v,g,E){const te=Xn(v.element,v.triggerName,v.fromState,v.toState,g||v.phaseName,E.totalTime??v.totalTime,!!E.disabled),ve=v._data;return null!=ve&&(te._data=ve),te}function Xn(v,g,E,S,$="",te=0,ve){return{element:v,triggerName:g,fromState:E,toState:S,phaseName:$,totalTime:te,disabled:!!ve}}function Lr(v,g,E){let S=v.get(g);return S||v.set(g,S=E),S}function yn(v){const g=v.indexOf(":");return[v.substring(1,g),v.slice(g+1)]}const Jr=(()=>typeof document>"u"?null:document.documentElement)();function Li(v){const g=v.parentNode||v.host||null;return g===Jr?null:g}let hr=null,wr=!1;function Gi(v,g){for(;g;){if(g===v)return!0;g=Li(g)}return!1}function Tr(v,g,E){if(E)return Array.from(v.querySelectorAll(g));const S=v.querySelector(g);return S?[S]:[]}let yi=(()=>{var v;class g{validateStyleProperty(S){return function _r(v){hr||(hr=function Di(){return typeof document<"u"?document.body:null}()||{},wr=!!hr.style&&"WebkitAppearance"in hr.style);let g=!0;return hr.style&&!function ui(v){return"ebkit"==v.substring(1,6)}(v)&&(g=v in hr.style,!g&&wr&&(g="Webkit"+v.charAt(0).toUpperCase()+v.slice(1)in hr.style)),g}(S)}matchesElement(S,$){return!1}containsElement(S,$){return Gi(S,$)}getParentElement(S){return Li(S)}query(S,$,te){return Tr(S,$,te)}computeStyle(S,$,te){return te||""}animate(S,$,te,ve,me,st=[],$t){return new ye.ZN(te,ve)}}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})(),Yr=(()=>{class g{}return g.NOOP=new yi,g})();const Do=1e3,Xe="ng-enter",ue="ng-leave",pe="ng-trigger",He=".ng-trigger",at="ng-animating",yt=".ng-animating";function Mt(v){if("number"==typeof v)return v;const g=v.match(/^(-?[\.\d]+)(m?s)/);return!g||g.length<2?0:At(parseFloat(g[1]),g[2])}function At(v,g){return"s"===g?v*Do:v}function _t(v,g,E){return v.hasOwnProperty("duration")?v:function Bt(v,g,E){let $,te=0,ve="";if("string"==typeof v){const me=v.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===me)return g.push(Ze()),{duration:0,delay:0,easing:""};$=At(parseFloat(me[1]),me[2]);const st=me[3];null!=st&&(te=At(parseFloat(st),me[4]));const $t=me[5];$t&&(ve=$t)}else $=v;if(!E){let me=!1,st=g.length;$<0&&(g.push(function Qe(){return new w.vHH(3100,!1)}()),me=!0),te<0&&(g.push(function ot(){return new w.vHH(3101,!1)}()),me=!0),me&&g.splice(st,0,Ze())}return{duration:$,delay:te,easing:ve}}(v,g,E)}function pn(v,g={}){return Object.keys(v).forEach(E=>{g[E]=v[E]}),g}function ke(v){const g=new Map;return Object.keys(v).forEach(E=>{g.set(E,v[E])}),g}function Fe(v,g=new Map,E){if(E)for(let[S,$]of E)g.set(S,$);for(let[S,$]of v)g.set(S,$);return g}function fe(v,g,E){g.forEach((S,$)=>{const te=ti($);E&&!E.has($)&&E.set($,v.style[te]),v.style[te]=S})}function nt(v,g){g.forEach((E,S)=>{const $=ti(S);v.style[$]=""})}function Ft(v){return Array.isArray(v)?1==v.length?v[0]:(0,ye.vP)(v):v}const Zn=new RegExp("{{\\s*(.+?)\\s*}}","g");function Gn(v){let g=[];if("string"==typeof v){let E;for(;E=Zn.exec(v);)g.push(E[1]);Zn.lastIndex=0}return g}function dr(v,g,E){const S=v.toString(),$=S.replace(Zn,(te,ve)=>{let me=g[ve];return null==me&&(E.push(function xt(v){return new w.vHH(3003,!1)}()),me=""),me.toString()});return $==S?v:$}function yr(v){const g=[];let E=v.next();for(;!E.done;)g.push(E.value),E=v.next();return g}const Hr=/-+([a-z0-9])/g;function ti(v){return v.replace(Hr,(...g)=>g[1].toUpperCase())}function Et(v,g,E){switch(g.type){case 7:return v.visitTrigger(g,E);case 0:return v.visitState(g,E);case 1:return v.visitTransition(g,E);case 2:return v.visitSequence(g,E);case 3:return v.visitGroup(g,E);case 4:return v.visitAnimate(g,E);case 5:return v.visitKeyframes(g,E);case 6:return v.visitStyle(g,E);case 8:return v.visitReference(g,E);case 9:return v.visitAnimateChild(g,E);case 10:return v.visitAnimateRef(g,E);case 11:return v.visitQuery(g,E);case 12:return v.visitStagger(g,E);default:throw function pt(v){return new w.vHH(3004,!1)}()}}function wn(v,g){return window.getComputedStyle(v)[g]}const Qr="*";function li(v,g){const E=[];return"string"==typeof v?v.split(/\s*,\s*/).forEach(S=>function Gr(v,g,E){if(":"==v[0]){const st=function Es(v,g){switch(v){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(E,S)=>parseFloat(S)>parseFloat(E);case":decrement":return(E,S)=>parseFloat(S)<parseFloat(E);default:return g.push(function Jn(v){return new w.vHH(3016,!1)}()),"* => *"}}(v,E);if("function"==typeof st)return void g.push(st);v=st}const S=v.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==S||S.length<4)return E.push(function Vt(v){return new w.vHH(3015,!1)}()),g;const $=S[1],te=S[2],ve=S[3];g.push(bi($,ve));"<"==te[0]&&!($==Qr&&ve==Qr)&&g.push(bi(ve,$))}(S,E,g)):E.push(v),E}const on=new Set(["true","1"]),ro=new Set(["false","0"]);function bi(v,g){const E=on.has(v)||ro.has(v),S=on.has(g)||ro.has(g);return($,te)=>{let ve=v==Qr||v==$,me=g==Qr||g==te;return!ve&&E&&"boolean"==typeof $&&(ve=$?on.has(v):ro.has(v)),!me&&S&&"boolean"==typeof te&&(me=te?on.has(g):ro.has(g)),ve&&me}}const Yo=new RegExp("s*:selfs*,?","g");function zi(v,g,E,S){return new Po(v).build(g,E,S)}class Po{constructor(g){this._driver=g}build(g,E,S){const $=new Dr(E);return this._resetContextStyleTimingState($),Et(this,Ft(g),$)}_resetContextStyleTimingState(g){g.currentQuerySelector="",g.collectedStyles=new Map,g.collectedStyles.set("",new Map),g.currentTime=0}visitTrigger(g,E){let S=E.queryCount=0,$=E.depCount=0;const te=[],ve=[];return"@"==g.name.charAt(0)&&E.errors.push(function Ot(){return new w.vHH(3006,!1)}()),g.definitions.forEach(me=>{if(this._resetContextStyleTimingState(E),0==me.type){const st=me,$t=st.name;$t.toString().split(/\s*,\s*/).forEach(er=>{st.name=er,te.push(this.visitState(st,E))}),st.name=$t}else if(1==me.type){const st=this.visitTransition(me,E);S+=st.queryCount,$+=st.depCount,ve.push(st)}else E.errors.push(function Pt(){return new w.vHH(3007,!1)}())}),{type:7,name:g.name,states:te,transitions:ve,queryCount:S,depCount:$,options:null}}visitState(g,E){const S=this.visitStyle(g.styles,E),$=g.options&&g.options.params||null;if(S.containsDynamicStyles){const te=new Set,ve=$||{};S.styles.forEach(me=>{me instanceof Map&&me.forEach(st=>{Gn(st).forEach($t=>{ve.hasOwnProperty($t)||te.add($t)})})}),te.size&&(yr(te.values()),E.errors.push(function Ce(v,g){return new w.vHH(3008,!1)}()))}return{type:0,name:g.name,style:S,options:$?{params:$}:null}}visitTransition(g,E){E.queryCount=0,E.depCount=0;const S=Et(this,Ft(g.animation),E);return{type:1,matchers:li(g.expr,E.errors),animation:S,queryCount:E.queryCount,depCount:E.depCount,options:we(g.options)}}visitSequence(g,E){return{type:2,steps:g.steps.map(S=>Et(this,S,E)),options:we(g.options)}}visitGroup(g,E){const S=E.currentTime;let $=0;const te=g.steps.map(ve=>{E.currentTime=S;const me=Et(this,ve,E);return $=Math.max($,E.currentTime),me});return E.currentTime=$,{type:3,steps:te,options:we(g.options)}}visitAnimate(g,E){const S=function $e(v,g){if(v.hasOwnProperty("duration"))return v;if("number"==typeof v)return Be(_t(v,g).duration,0,"");const E=v;if(E.split(/\s+/).some(te=>"{"==te.charAt(0)&&"{"==te.charAt(1))){const te=Be(0,0,"");return te.dynamic=!0,te.strValue=E,te}const $=_t(E,g);return Be($.duration,$.delay,$.easing)}(g.timings,E.errors);E.currentAnimateTimings=S;let $,te=g.styles?g.styles:(0,ye.oB)({});if(5==te.type)$=this.visitKeyframes(te,E);else{let ve=g.styles,me=!1;if(!ve){me=!0;const $t={};S.easing&&($t.easing=S.easing),ve=(0,ye.oB)($t)}E.currentTime+=S.duration+S.delay;const st=this.visitStyle(ve,E);st.isEmptyStep=me,$=st}return E.currentAnimateTimings=null,{type:4,timings:S,style:$,options:null}}visitStyle(g,E){const S=this._makeStyleAst(g,E);return this._validateStyleAst(S,E),S}_makeStyleAst(g,E){const S=[],$=Array.isArray(g.styles)?g.styles:[g.styles];for(let me of $)"string"==typeof me?me===ye.l3?S.push(me):E.errors.push(new w.vHH(3002,!1)):S.push(ke(me));let te=!1,ve=null;return S.forEach(me=>{if(me instanceof Map&&(me.has("easing")&&(ve=me.get("easing"),me.delete("easing")),!te))for(let st of me.values())if(st.toString().indexOf("{{")>=0){te=!0;break}}),{type:6,styles:S,easing:ve,offset:g.offset,containsDynamicStyles:te,options:null}}_validateStyleAst(g,E){const S=E.currentAnimateTimings;let $=E.currentTime,te=E.currentTime;S&&te>0&&(te-=S.duration+S.delay),g.styles.forEach(ve=>{"string"!=typeof ve&&ve.forEach((me,st)=>{const $t=E.collectedStyles.get(E.currentQuerySelector),er=$t.get(st);let Yn=!0;er&&(te!=$&&te>=er.startTime&&$<=er.endTime&&(E.errors.push(function St(v,g,E,S,$){return new w.vHH(3010,!1)}()),Yn=!1),te=er.startTime),Yn&&$t.set(st,{startTime:te,endTime:$}),E.options&&function mn(v,g,E){const S=g.params||{},$=Gn(v);$.length&&$.forEach(te=>{S.hasOwnProperty(te)||E.push(function mt(v){return new w.vHH(3001,!1)}())})}(me,E.options,E.errors)})})}visitKeyframes(g,E){const S={type:5,styles:[],options:null};if(!E.currentAnimateTimings)return E.errors.push(function Ye(){return new w.vHH(3011,!1)}()),S;let te=0;const ve=[];let me=!1,st=!1,$t=0;const er=g.steps.map(hi=>{const Zi=this._makeStyleAst(hi,E);let _o=null!=Zi.offset?Zi.offset:function he(v){if("string"==typeof v)return null;let g=null;if(Array.isArray(v))v.forEach(E=>{if(E instanceof Map&&E.has("offset")){const S=E;g=parseFloat(S.get("offset")),S.delete("offset")}});else if(v instanceof Map&&v.has("offset")){const E=v;g=parseFloat(E.get("offset")),E.delete("offset")}return g}(Zi.styles),h=0;return null!=_o&&(te++,h=Zi.offset=_o),st=st||h<0||h>1,me=me||h<$t,$t=h,ve.push(h),Zi});st&&E.errors.push(function gt(){return new w.vHH(3012,!1)}()),me&&E.errors.push(function Wt(){return new w.vHH(3200,!1)}());const Yn=g.steps.length;let Nr=0;te>0&&te<Yn?E.errors.push(function Nt(){return new w.vHH(3202,!1)}()):0==te&&(Nr=1/(Yn-1));const Wr=Yn-1,Sr=E.currentTime,Zr=E.currentAnimateTimings,Ur=Zr.duration;return er.forEach((hi,Zi)=>{const _o=Nr>0?Zi==Wr?1:Nr*Zi:ve[Zi],h=_o*Ur;E.currentTime=Sr+Zr.delay+h,Zr.duration=h,this._validateStyleAst(hi,E),hi.offset=_o,S.styles.push(hi)}),S}visitReference(g,E){return{type:8,animation:Et(this,Ft(g.animation),E),options:we(g.options)}}visitAnimateChild(g,E){return E.depCount++,{type:9,options:we(g.options)}}visitAnimateRef(g,E){return{type:10,animation:this.visitReference(g.animation,E),options:we(g.options)}}visitQuery(g,E){const S=E.currentQuerySelector,$=g.options||{};E.queryCount++,E.currentQuery=g;const[te,ve]=function No(v){const g=!!v.split(/\s*,\s*/).find(E=>":self"==E);return g&&(v=v.replace(Yo,"")),v=v.replace(/@\*/g,He).replace(/@\w+/g,E=>He+"-"+E.slice(1)).replace(/:animating/g,yt),[v,g]}(g.selector);E.currentQuerySelector=S.length?S+" "+te:te,Lr(E.collectedStyles,E.currentQuerySelector,new Map);const me=Et(this,Ft(g.animation),E);return E.currentQuery=null,E.currentQuerySelector=S,{type:11,selector:te,limit:$.limit||0,optional:!!$.optional,includeSelf:ve,animation:me,originalSelector:g.selector,options:we(g.options)}}visitStagger(g,E){E.currentQuery||E.errors.push(function an(){return new w.vHH(3013,!1)}());const S="full"===g.timings?{duration:0,delay:0,easing:"full"}:_t(g.timings,E.errors,!0);return{type:12,animation:Et(this,Ft(g.animation),E),timings:S,options:null}}}class Dr{constructor(g){this.errors=g,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function we(v){return v?(v=pn(v)).params&&(v.params=function Wn(v){return v?pn(v):null}(v.params)):v={},v}function Be(v,g,E){return{duration:v,delay:g,easing:E}}function Ct(v,g,E,S,$,te,ve=null,me=!1){return{type:1,element:v,keyframes:g,preStyleProps:E,postStyleProps:S,duration:$,delay:te,totalTime:$+te,easing:ve,subTimeline:me}}class kt{constructor(){this._map=new Map}get(g){return this._map.get(g)||[]}append(g,E){let S=this._map.get(g);S||this._map.set(g,S=[]),S.push(...E)}has(g){return this._map.has(g)}clear(){this._map.clear()}}const un=new RegExp(":enter","g"),lr=new RegExp(":leave","g");function Cr(v,g,E,S,$,te=new Map,ve=new Map,me,st,$t=[]){return(new kr).buildKeyframes(v,g,E,S,$,te,ve,me,st,$t)}class kr{buildKeyframes(g,E,S,$,te,ve,me,st,$t,er=[]){$t=$t||new kt;const Yn=new io(g,E,$t,$,te,er,[]);Yn.options=st;const Nr=st.delay?Mt(st.delay):0;Yn.currentTimeline.delayNextStep(Nr),Yn.currentTimeline.setStyles([ve],null,Yn.errors,st),Et(this,S,Yn);const Wr=Yn.timelines.filter(Sr=>Sr.containsAnimation());if(Wr.length&&me.size){let Sr;for(let Zr=Wr.length-1;Zr>=0;Zr--){const Ur=Wr[Zr];if(Ur.element===E){Sr=Ur;break}}Sr&&!Sr.allowOnlyTimelineStyles()&&Sr.setStyles([me],null,Yn.errors,st)}return Wr.length?Wr.map(Sr=>Sr.buildKeyframes()):[Ct(E,[],[],[],0,Nr,"",!1)]}visitTrigger(g,E){}visitState(g,E){}visitTransition(g,E){}visitAnimateChild(g,E){const S=E.subInstructions.get(E.element);if(S){const $=E.createSubContext(g.options),te=E.currentTimeline.currentTime,ve=this._visitSubInstructions(S,$,$.options);te!=ve&&E.transformIntoNewTimeline(ve)}E.previousNode=g}visitAnimateRef(g,E){const S=E.createSubContext(g.options);S.transformIntoNewTimeline(),this._applyAnimationRefDelays([g.options,g.animation.options],E,S),this.visitReference(g.animation,S),E.transformIntoNewTimeline(S.currentTimeline.currentTime),E.previousNode=g}_applyAnimationRefDelays(g,E,S){for(const $ of g){const te=$?.delay;if(te){const ve="number"==typeof te?te:Mt(dr(te,$?.params??{},E.errors));S.delayNextStep(ve)}}}_visitSubInstructions(g,E,S){let te=E.currentTimeline.currentTime;const ve=null!=S.duration?Mt(S.duration):null,me=null!=S.delay?Mt(S.delay):null;return 0!==ve&&g.forEach(st=>{const $t=E.appendInstructionToTimeline(st,ve,me);te=Math.max(te,$t.duration+$t.delay)}),te}visitReference(g,E){E.updateOptions(g.options,!0),Et(this,g.animation,E),E.previousNode=g}visitSequence(g,E){const S=E.subContextCount;let $=E;const te=g.options;if(te&&(te.params||te.delay)&&($=E.createSubContext(te),$.transformIntoNewTimeline(),null!=te.delay)){6==$.previousNode.type&&($.currentTimeline.snapshotCurrentStyles(),$.previousNode=wi);const ve=Mt(te.delay);$.delayNextStep(ve)}g.steps.length&&(g.steps.forEach(ve=>Et(this,ve,$)),$.currentTimeline.applyStylesToKeyframe(),$.subContextCount>S&&$.transformIntoNewTimeline()),E.previousNode=g}visitGroup(g,E){const S=[];let $=E.currentTimeline.currentTime;const te=g.options&&g.options.delay?Mt(g.options.delay):0;g.steps.forEach(ve=>{const me=E.createSubContext(g.options);te&&me.delayNextStep(te),Et(this,ve,me),$=Math.max($,me.currentTimeline.currentTime),S.push(me.currentTimeline)}),S.forEach(ve=>E.currentTimeline.mergeTimelineCollectedStyles(ve)),E.transformIntoNewTimeline($),E.previousNode=g}_visitTiming(g,E){if(g.dynamic){const S=g.strValue;return _t(E.params?dr(S,E.params,E.errors):S,E.errors)}return{duration:g.duration,delay:g.delay,easing:g.easing}}visitAnimate(g,E){const S=E.currentAnimateTimings=this._visitTiming(g.timings,E),$=E.currentTimeline;S.delay&&(E.incrementTime(S.delay),$.snapshotCurrentStyles());const te=g.style;5==te.type?this.visitKeyframes(te,E):(E.incrementTime(S.duration),this.visitStyle(te,E),$.applyStylesToKeyframe()),E.currentAnimateTimings=null,E.previousNode=g}visitStyle(g,E){const S=E.currentTimeline,$=E.currentAnimateTimings;!$&&S.hasCurrentStyleProperties()&&S.forwardFrame();const te=$&&$.easing||g.easing;g.isEmptyStep?S.applyEmptyStep(te):S.setStyles(g.styles,te,E.errors,E.options),E.previousNode=g}visitKeyframes(g,E){const S=E.currentAnimateTimings,$=E.currentTimeline.duration,te=S.duration,me=E.createSubContext().currentTimeline;me.easing=S.easing,g.styles.forEach(st=>{me.forwardTime((st.offset||0)*te),me.setStyles(st.styles,st.easing,E.errors,E.options),me.applyStylesToKeyframe()}),E.currentTimeline.mergeTimelineCollectedStyles(me),E.transformIntoNewTimeline($+te),E.previousNode=g}visitQuery(g,E){const S=E.currentTimeline.currentTime,$=g.options||{},te=$.delay?Mt($.delay):0;te&&(6===E.previousNode.type||0==S&&E.currentTimeline.hasCurrentStyleProperties())&&(E.currentTimeline.snapshotCurrentStyles(),E.previousNode=wi);let ve=S;const me=E.invokeQuery(g.selector,g.originalSelector,g.limit,g.includeSelf,!!$.optional,E.errors);E.currentQueryTotal=me.length;let st=null;me.forEach(($t,er)=>{E.currentQueryIndex=er;const Yn=E.createSubContext(g.options,$t);te&&Yn.delayNextStep(te),$t===E.element&&(st=Yn.currentTimeline),Et(this,g.animation,Yn),Yn.currentTimeline.applyStylesToKeyframe(),ve=Math.max(ve,Yn.currentTimeline.currentTime)}),E.currentQueryIndex=0,E.currentQueryTotal=0,E.transformIntoNewTimeline(ve),st&&(E.currentTimeline.mergeTimelineCollectedStyles(st),E.currentTimeline.snapshotCurrentStyles()),E.previousNode=g}visitStagger(g,E){const S=E.parentContext,$=E.currentTimeline,te=g.timings,ve=Math.abs(te.duration),me=ve*(E.currentQueryTotal-1);let st=ve*E.currentQueryIndex;switch(te.duration<0?"reverse":te.easing){case"reverse":st=me-st;break;case"full":st=S.currentStaggerTime}const er=E.currentTimeline;st&&er.delayNextStep(st);const Yn=er.currentTime;Et(this,g.animation,E),E.previousNode=g,S.currentStaggerTime=$.currentTime-Yn+($.startTime-S.currentTimeline.startTime)}}const wi={};class io{constructor(g,E,S,$,te,ve,me,st){this._driver=g,this.element=E,this.subInstructions=S,this._enterClassName=$,this._leaveClassName=te,this.errors=ve,this.timelines=me,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=wi,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=st||new Hi(this._driver,E,0),me.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(g,E){if(!g)return;const S=g;let $=this.options;null!=S.duration&&($.duration=Mt(S.duration)),null!=S.delay&&($.delay=Mt(S.delay));const te=S.params;if(te){let ve=$.params;ve||(ve=this.options.params={}),Object.keys(te).forEach(me=>{(!E||!ve.hasOwnProperty(me))&&(ve[me]=dr(te[me],ve,this.errors))})}}_copyOptions(){const g={};if(this.options){const E=this.options.params;if(E){const S=g.params={};Object.keys(E).forEach($=>{S[$]=E[$]})}}return g}createSubContext(g=null,E,S){const $=E||this.element,te=new io(this._driver,$,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork($,S||0));return te.previousNode=this.previousNode,te.currentAnimateTimings=this.currentAnimateTimings,te.options=this._copyOptions(),te.updateOptions(g),te.currentQueryIndex=this.currentQueryIndex,te.currentQueryTotal=this.currentQueryTotal,te.parentContext=this,this.subContextCount++,te}transformIntoNewTimeline(g){return this.previousNode=wi,this.currentTimeline=this.currentTimeline.fork(this.element,g),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(g,E,S){const $={duration:E??g.duration,delay:this.currentTimeline.currentTime+(S??0)+g.delay,easing:""},te=new Ki(this._driver,g.element,g.keyframes,g.preStyleProps,g.postStyleProps,$,g.stretchStartingKeyframe);return this.timelines.push(te),$}incrementTime(g){this.currentTimeline.forwardTime(this.currentTimeline.duration+g)}delayNextStep(g){g>0&&this.currentTimeline.delayNextStep(g)}invokeQuery(g,E,S,$,te,ve){let me=[];if($&&me.push(this.element),g.length>0){g=(g=g.replace(un,"."+this._enterClassName)).replace(lr,"."+this._leaveClassName);let $t=this._driver.query(this.element,g,1!=S);0!==S&&($t=S<0?$t.slice($t.length+S,$t.length):$t.slice(0,S)),me.push(...$t)}return!te&&0==me.length&&ve.push(function Qt(v){return new w.vHH(3014,!1)}()),me}}class Hi{constructor(g,E,S,$){this._driver=g,this.element=E,this.startTime=S,this._elementTimelineStylesLookup=$,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(E),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(E,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(g){const E=1===this._keyframes.size&&this._pendingStyles.size;this.duration||E?(this.forwardTime(this.currentTime+g),E&&this.snapshotCurrentStyles()):this.startTime+=g}fork(g,E){return this.applyStylesToKeyframe(),new Hi(this._driver,g,E||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(g){this.applyStylesToKeyframe(),this.duration=g,this._loadKeyframe()}_updateStyle(g,E){this._localTimelineStyles.set(g,E),this._globalTimelineStyles.set(g,E),this._styleSummary.set(g,{time:this.currentTime,value:E})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(g){g&&this._previousKeyframe.set("easing",g);for(let[E,S]of this._globalTimelineStyles)this._backFill.set(E,S||ye.l3),this._currentKeyframe.set(E,ye.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(g,E,S,$){E&&this._previousKeyframe.set("easing",E);const te=$&&$.params||{},ve=function To(v,g){const E=new Map;let S;return v.forEach($=>{if("*"===$){S=S||g.keys();for(let te of S)E.set(te,ye.l3)}else Fe($,E)}),E}(g,this._globalTimelineStyles);for(let[me,st]of ve){const $t=dr(st,te,S);this._pendingStyles.set(me,$t),this._localTimelineStyles.has(me)||this._backFill.set(me,this._globalTimelineStyles.get(me)??ye.l3),this._updateStyle(me,$t)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((g,E)=>{this._currentKeyframe.set(E,g)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((g,E)=>{this._currentKeyframe.has(E)||this._currentKeyframe.set(E,g)}))}snapshotCurrentStyles(){for(let[g,E]of this._localTimelineStyles)this._pendingStyles.set(g,E),this._updateStyle(g,E)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const g=[];for(let E in this._currentKeyframe)g.push(E);return g}mergeTimelineCollectedStyles(g){g._styleSummary.forEach((E,S)=>{const $=this._styleSummary.get(S);(!$||E.time>$.time)&&this._updateStyle(S,E.value)})}buildKeyframes(){this.applyStylesToKeyframe();const g=new Set,E=new Set,S=1===this._keyframes.size&&0===this.duration;let $=[];this._keyframes.forEach((me,st)=>{const $t=Fe(me,new Map,this._backFill);$t.forEach((er,Yn)=>{er===ye.k1?g.add(Yn):er===ye.l3&&E.add(Yn)}),S||$t.set("offset",st/this.duration),$.push($t)});const te=g.size?yr(g.values()):[],ve=E.size?yr(E.values()):[];if(S){const me=$[0],st=new Map(me);me.set("offset",0),st.set("offset",1),$=[me,st]}return Ct(this.element,$,te,ve,this.duration,this.startTime,this.easing,!1)}}class Ki extends Hi{constructor(g,E,S,$,te,ve,me=!1){super(g,E,ve.delay),this.keyframes=S,this.preStyleProps=$,this.postStyleProps=te,this._stretchStartingKeyframe=me,this.timings={duration:ve.duration,delay:ve.delay,easing:ve.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let g=this.keyframes,{delay:E,duration:S,easing:$}=this.timings;if(this._stretchStartingKeyframe&&E){const te=[],ve=S+E,me=E/ve,st=Fe(g[0]);st.set("offset",0),te.push(st);const $t=Fe(g[0]);$t.set("offset",Pi(me)),te.push($t);const er=g.length-1;for(let Yn=1;Yn<=er;Yn++){let Nr=Fe(g[Yn]);const Wr=Nr.get("offset");Nr.set("offset",Pi((E+Wr*S)/ve)),te.push(Nr)}S=ve,E=0,$="",g=te}return Ct(this.element,g,this.preStyleProps,this.postStyleProps,S,E,$,!0)}}function Pi(v,g=3){const E=Math.pow(10,g-1);return Math.round(v*E)/E}class qr{}const ps=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Ai extends qr{normalizePropertyName(g,E){return ti(g)}normalizeStyleValue(g,E,S,$){let te="";const ve=S.toString().trim();if(ps.has(E)&&0!==S&&"0"!==S)if("number"==typeof S)te="px";else{const me=S.match(/^[+-]?[\d\.]+([a-z]*)$/);me&&0==me[1].length&&$.push(function et(v,g){return new w.vHH(3005,!1)}())}return ve+te}}function So(v,g,E,S,$,te,ve,me,st,$t,er,Yn,Nr){return{type:0,element:v,triggerName:g,isRemovalTransition:$,fromState:E,fromStyles:te,toState:S,toStyles:ve,timelines:me,queriedElements:st,preStyleProps:$t,postStyleProps:er,totalTime:Yn,errors:Nr}}const Ks={};class as{constructor(g,E,S){this._triggerName=g,this.ast=E,this._stateStyles=S}match(g,E,S,$){return function Os(v,g,E,S,$){return v.some(te=>te(g,E,S,$))}(this.ast.matchers,g,E,S,$)}buildStyles(g,E,S){let $=this._stateStyles.get("*");return void 0!==g&&($=this._stateStyles.get(g?.toString())||$),$?$.buildStyles(E,S):new Map}build(g,E,S,$,te,ve,me,st,$t,er){const Yn=[],Nr=this.ast.options&&this.ast.options.params||Ks,Sr=this.buildStyles(S,me&&me.params||Ks,Yn),Zr=st&&st.params||Ks,Ur=this.buildStyles($,Zr,Yn),hi=new Set,Zi=new Map,_o=new Map,h="void"===$,i={params:Ri(Zr,Nr),delay:this.ast.options?.delay},c=er?[]:Cr(g,E,this.ast.animation,te,ve,Sr,Ur,i,$t,Yn);let p=0;if(c.forEach(D=>{p=Math.max(D.duration+D.delay,p)}),Yn.length)return So(E,this._triggerName,S,$,h,Sr,Ur,[],[],Zi,_o,p,Yn);c.forEach(D=>{const A=D.element,O=Lr(Zi,A,new Set);D.preStyleProps.forEach(G=>O.add(G));const z=Lr(_o,A,new Set);D.postStyleProps.forEach(G=>z.add(G)),A!==E&&hi.add(A)});const y=yr(hi.values());return So(E,this._triggerName,S,$,h,Sr,Ur,c,y,Zi,_o,p)}}function Ri(v,g){const E=pn(g);for(const S in v)v.hasOwnProperty(S)&&null!=v[S]&&(E[S]=v[S]);return E}class rr{constructor(g,E,S){this.styles=g,this.defaultParams=E,this.normalizer=S}buildStyles(g,E){const S=new Map,$=pn(this.defaultParams);return Object.keys(g).forEach(te=>{const ve=g[te];null!==ve&&($[te]=ve)}),this.styles.styles.forEach(te=>{"string"!=typeof te&&te.forEach((ve,me)=>{ve&&(ve=dr(ve,$,E));const st=this.normalizer.normalizePropertyName(me,E);ve=this.normalizer.normalizeStyleValue(me,st,ve,E),S.set(me,ve)})}),S}}class Ti{constructor(g,E,S){this.name=g,this.ast=E,this._normalizer=S,this.transitionFactories=[],this.states=new Map,E.states.forEach($=>{this.states.set($.name,new rr($.style,$.options&&$.options.params||{},S))}),zo(this.states,"true","1"),zo(this.states,"false","0"),E.transitions.forEach($=>{this.transitionFactories.push(new as(g,$,this.states))}),this.fallbackTransition=function Io(v,g,E){return new as(v,{type:1,animation:{type:2,steps:[],options:null},matchers:[(ve,me)=>!0],options:null,queryCount:0,depCount:0},g)}(g,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(g,E,S,$){return this.transitionFactories.find(ve=>ve.match(g,E,S,$))||null}matchStyles(g,E,S){return this.fallbackTransition.buildStyles(g,E,S)}}function zo(v,g,E){v.has(g)?v.has(E)||v.set(E,v.get(g)):v.has(E)&&v.set(g,v.get(E))}const Si=new kt;class Ms{constructor(g,E,S){this.bodyNode=g,this._driver=E,this._normalizer=S,this._animations=new Map,this._playersById=new Map,this.players=[]}register(g,E){const S=[],te=zi(this._driver,E,S,[]);if(S.length)throw function ze(v){return new w.vHH(3503,!1)}();this._animations.set(g,te)}_buildPlayer(g,E,S){const $=g.element,te=pr(this._normalizer,g.keyframes,E,S);return this._driver.animate($,te,g.duration,g.delay,g.easing,[],!0)}create(g,E,S={}){const $=[],te=this._animations.get(g);let ve;const me=new Map;if(te?(ve=Cr(this._driver,E,te,Xe,ue,new Map,new Map,S,Si,$),ve.forEach(er=>{const Yn=Lr(me,er.element,new Map);er.postStyleProps.forEach(Nr=>Yn.set(Nr,null))})):($.push(function ut(){return new w.vHH(3300,!1)}()),ve=[]),$.length)throw function Dt(v){return new w.vHH(3504,!1)}();me.forEach((er,Yn)=>{er.forEach((Nr,Wr)=>{er.set(Wr,this._driver.computeStyle(Yn,Wr,ye.l3))})});const $t=Fn(ve.map(er=>{const Yn=me.get(er.element);return this._buildPlayer(er,new Map,Yn)}));return this._playersById.set(g,$t),$t.onDestroy(()=>this.destroy(g)),this.players.push($t),$t}destroy(g){const E=this._getPlayer(g);E.destroy(),this._playersById.delete(g);const S=this.players.indexOf(E);S>=0&&this.players.splice(S,1)}_getPlayer(g){const E=this._playersById.get(g);if(!E)throw function jt(v){return new w.vHH(3301,!1)}();return E}listen(g,E,S,$){const te=Xn(E,"","","");return nr(this._getPlayer(g),S,te,$),()=>{}}command(g,E,S,$){if("register"==S)return void this.register(g,$[0]);if("create"==S)return void this.create(g,E,$[0]||{});const te=this._getPlayer(g);switch(S){case"play":te.play();break;case"pause":te.pause();break;case"reset":te.reset();break;case"restart":te.restart();break;case"finish":te.finish();break;case"init":te.init();break;case"setPosition":te.setPosition(parseFloat($[0]));break;case"destroy":this.destroy(g)}}}const Qi="ng-animate-queued",Vo="ng-animate-disabled",go=[],$i={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},es={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ro="__ng_removed";class Uo{get params(){return this.options.params}constructor(g,E=""){this.namespaceId=E;const S=g&&g.hasOwnProperty("value");if(this.value=function Qn(v){return v??null}(S?g.value:g),S){const te=pn(g);delete te.value,this.options=te}else this.options={};this.options.params||(this.options.params={})}absorbOptions(g){const E=g.params;if(E){const S=this.options.params;Object.keys(E).forEach($=>{null==S[$]&&(S[$]=E[$])})}}}const jo="void",oa=new Uo(jo);class ms{constructor(g,E,S){this.id=g,this.hostElement=E,this._engine=S,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+g,co(E,this._hostClassName)}listen(g,E,S,$){if(!this._triggers.has(E))throw function nn(v,g){return new w.vHH(3302,!1)}();if(null==S||0==S.length)throw function ln(v){return new w.vHH(3303,!1)}();if(!function As(v){return"start"==v||"done"==v}(S))throw function _n(v,g){return new w.vHH(3400,!1)}();const te=Lr(this._elementListeners,g,[]),ve={name:E,phase:S,callback:$};te.push(ve);const me=Lr(this._engine.statesByElement,g,new Map);return me.has(E)||(co(g,pe),co(g,pe+"-"+E),me.set(E,oa)),()=>{this._engine.afterFlush(()=>{const st=te.indexOf(ve);st>=0&&te.splice(st,1),this._triggers.has(E)||me.delete(E)})}}register(g,E){return!this._triggers.has(g)&&(this._triggers.set(g,E),!0)}_getTrigger(g){const E=this._triggers.get(g);if(!E)throw function bn(v){return new w.vHH(3401,!1)}();return E}trigger(g,E,S,$=!0){const te=this._getTrigger(E),ve=new ts(this.id,E,g);let me=this._engine.statesByElement.get(g);me||(co(g,pe),co(g,pe+"-"+E),this._engine.statesByElement.set(g,me=new Map));let st=me.get(E);const $t=new Uo(S,this.id);if(!(S&&S.hasOwnProperty("value"))&&st&&$t.absorbOptions(st.options),me.set(E,$t),st||(st=oa),$t.value!==jo&&st.value===$t.value){if(!function Wi(v,g){const E=Object.keys(v),S=Object.keys(g);if(E.length!=S.length)return!1;for(let $=0;$<E.length;$++){const te=E[$];if(!g.hasOwnProperty(te)||v[te]!==g[te])return!1}return!0}(st.params,$t.params)){const Zr=[],Ur=te.matchStyles(st.value,st.params,Zr),hi=te.matchStyles($t.value,$t.params,Zr);Zr.length?this._engine.reportError(Zr):this._engine.afterFlush(()=>{nt(g,Ur),fe(g,hi)})}return}const Nr=Lr(this._engine.playersByElement,g,[]);Nr.forEach(Zr=>{Zr.namespaceId==this.id&&Zr.triggerName==E&&Zr.queued&&Zr.destroy()});let Wr=te.matchTransition(st.value,$t.value,g,$t.params),Sr=!1;if(!Wr){if(!$)return;Wr=te.fallbackTransition,Sr=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:g,triggerName:E,transition:Wr,fromState:st,toState:$t,player:ve,isFallbackTransition:Sr}),Sr||(co(g,Qi),ve.onStart(()=>{Mo(g,Qi)})),ve.onDone(()=>{let Zr=this.players.indexOf(ve);Zr>=0&&this.players.splice(Zr,1);const Ur=this._engine.playersByElement.get(g);if(Ur){let hi=Ur.indexOf(ve);hi>=0&&Ur.splice(hi,1)}}),this.players.push(ve),Nr.push(ve),ve}deregister(g){this._triggers.delete(g),this._engine.statesByElement.forEach(E=>E.delete(g)),this._elementListeners.forEach((E,S)=>{this._elementListeners.set(S,E.filter($=>$.name!=g))})}clearElementCache(g){this._engine.statesByElement.delete(g),this._elementListeners.delete(g);const E=this._engine.playersByElement.get(g);E&&(E.forEach(S=>S.destroy()),this._engine.playersByElement.delete(g))}_signalRemovalForInnerTriggers(g,E){const S=this._engine.driver.query(g,He,!0);S.forEach($=>{if($[Ro])return;const te=this._engine.fetchNamespacesByElement($);te.size?te.forEach(ve=>ve.triggerLeaveAnimation($,E,!1,!0)):this.clearElementCache($)}),this._engine.afterFlushAnimationsDone(()=>S.forEach($=>this.clearElementCache($)))}triggerLeaveAnimation(g,E,S,$){const te=this._engine.statesByElement.get(g),ve=new Map;if(te){const me=[];if(te.forEach((st,$t)=>{if(ve.set($t,st.value),this._triggers.has($t)){const er=this.trigger(g,$t,jo,$);er&&me.push(er)}}),me.length)return this._engine.markElementAsRemoved(this.id,g,!0,E,ve),S&&Fn(me).onDone(()=>this._engine.processLeaveNode(g)),!0}return!1}prepareLeaveAnimationListeners(g){const E=this._elementListeners.get(g),S=this._engine.statesByElement.get(g);if(E&&S){const $=new Set;E.forEach(te=>{const ve=te.name;if($.has(ve))return;$.add(ve);const st=this._triggers.get(ve).fallbackTransition,$t=S.get(ve)||oa,er=new Uo(jo),Yn=new ts(this.id,ve,g);this._engine.totalQueuedPlayers++,this._queue.push({element:g,triggerName:ve,transition:st,fromState:$t,toState:er,player:Yn,isFallbackTransition:!0})})}}removeNode(g,E){const S=this._engine;if(g.childElementCount&&this._signalRemovalForInnerTriggers(g,E),this.triggerLeaveAnimation(g,E,!0))return;let $=!1;if(S.totalAnimations){const te=S.players.length?S.playersByQueriedElement.get(g):[];if(te&&te.length)$=!0;else{let ve=g;for(;ve=ve.parentNode;)if(S.statesByElement.get(ve)){$=!0;break}}}if(this.prepareLeaveAnimationListeners(g),$)S.markElementAsRemoved(this.id,g,!1,E);else{const te=g[Ro];(!te||te===$i)&&(S.afterFlush(()=>this.clearElementCache(g)),S.destroyInnerAnimations(g),S._onRemovalComplete(g,E))}}insertNode(g,E){co(g,this._hostClassName)}drainQueuedTransitions(g){const E=[];return this._queue.forEach(S=>{const $=S.player;if($.destroyed)return;const te=S.element,ve=this._elementListeners.get(te);ve&&ve.forEach(me=>{if(me.name==S.triggerName){const st=Xn(te,S.triggerName,S.fromState.value,S.toState.value);st._data=g,nr(S.player,me.phase,st,me.callback)}}),$.markedForDestroy?this._engine.afterFlush(()=>{$.destroy()}):E.push(S)}),this._queue=[],E.sort((S,$)=>{const te=S.transition.ast.depCount,ve=$.transition.ast.depCount;return 0==te||0==ve?te-ve:this._engine.driver.containsElement(S.element,$.element)?1:-1})}destroy(g){this.players.forEach(E=>E.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,g)}}class cs{_onRemovalComplete(g,E){this.onRemovalComplete(g,E)}constructor(g,E,S){this.bodyNode=g,this.driver=E,this._normalizer=S,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=($,te)=>{}}get queuedPlayers(){const g=[];return this._namespaceList.forEach(E=>{E.players.forEach(S=>{S.queued&&g.push(S)})}),g}createNamespace(g,E){const S=new ms(g,E,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,E)?this._balanceNamespaceList(S,E):(this.newHostElements.set(E,S),this.collectEnterElement(E)),this._namespaceLookup[g]=S}_balanceNamespaceList(g,E){const S=this._namespaceList,$=this.namespacesByHostElement;if(S.length-1>=0){let ve=!1,me=this.driver.getParentElement(E);for(;me;){const st=$.get(me);if(st){const $t=S.indexOf(st);S.splice($t+1,0,g),ve=!0;break}me=this.driver.getParentElement(me)}ve||S.unshift(g)}else S.push(g);return $.set(E,g),g}register(g,E){let S=this._namespaceLookup[g];return S||(S=this.createNamespace(g,E)),S}registerTrigger(g,E,S){let $=this._namespaceLookup[g];$&&$.register(E,S)&&this.totalAnimations++}destroy(g,E){g&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const S=this._fetchNamespace(g);this.namespacesByHostElement.delete(S.hostElement);const $=this._namespaceList.indexOf(S);$>=0&&this._namespaceList.splice($,1),S.destroy(E),delete this._namespaceLookup[g]}))}_fetchNamespace(g){return this._namespaceLookup[g]}fetchNamespacesByElement(g){const E=new Set,S=this.statesByElement.get(g);if(S)for(let $ of S.values())if($.namespaceId){const te=this._fetchNamespace($.namespaceId);te&&E.add(te)}return E}trigger(g,E,S,$){if(ka(E)){const te=this._fetchNamespace(g);if(te)return te.trigger(E,S,$),!0}return!1}insertNode(g,E,S,$){if(!ka(E))return;const te=E[Ro];if(te&&te.setForRemoval){te.setForRemoval=!1,te.setForMove=!0;const ve=this.collectedLeaveElements.indexOf(E);ve>=0&&this.collectedLeaveElements.splice(ve,1)}if(g){const ve=this._fetchNamespace(g);ve&&ve.insertNode(E,S)}$&&this.collectEnterElement(E)}collectEnterElement(g){this.collectedEnterElements.push(g)}markElementAsDisabled(g,E){E?this.disabledNodes.has(g)||(this.disabledNodes.add(g),co(g,Vo)):this.disabledNodes.has(g)&&(this.disabledNodes.delete(g),Mo(g,Vo))}removeNode(g,E,S){if(ka(E)){const $=g?this._fetchNamespace(g):null;$?$.removeNode(E,S):this.markElementAsRemoved(g,E,!1,S);const te=this.namespacesByHostElement.get(E);te&&te.id!==g&&te.removeNode(E,S)}else this._onRemovalComplete(E,S)}markElementAsRemoved(g,E,S,$,te){this.collectedLeaveElements.push(E),E[Ro]={namespaceId:g,setForRemoval:$,hasAnimation:S,removedBeforeQueried:!1,previousTriggersValues:te}}listen(g,E,S,$,te){return ka(E)?this._fetchNamespace(g).listen(E,S,$,te):()=>{}}_buildInstruction(g,E,S,$,te){return g.transition.build(this.driver,g.element,g.fromState.value,g.toState.value,S,$,g.fromState.options,g.toState.options,E,te)}destroyInnerAnimations(g){let E=this.driver.query(g,He,!0);E.forEach(S=>this.destroyActiveAnimationsForElement(S)),0!=this.playersByQueriedElement.size&&(E=this.driver.query(g,yt,!0),E.forEach(S=>this.finishActiveQueriedAnimationOnElement(S)))}destroyActiveAnimationsForElement(g){const E=this.playersByElement.get(g);E&&E.forEach(S=>{S.queued?S.markedForDestroy=!0:S.destroy()})}finishActiveQueriedAnimationOnElement(g){const E=this.playersByQueriedElement.get(g);E&&E.forEach(S=>S.finish())}whenRenderingDone(){return new Promise(g=>{if(this.players.length)return Fn(this.players).onDone(()=>g());g()})}processLeaveNode(g){const E=g[Ro];if(E&&E.setForRemoval){if(g[Ro]=$i,E.namespaceId){this.destroyInnerAnimations(g);const S=this._fetchNamespace(E.namespaceId);S&&S.clearElementCache(g)}this._onRemovalComplete(g,E.setForRemoval)}g.classList?.contains(Vo)&&this.markElementAsDisabled(g,!1),this.driver.query(g,".ng-animate-disabled",!0).forEach(S=>{this.markElementAsDisabled(S,!1)})}flush(g=-1){let E=[];if(this.newHostElements.size&&(this.newHostElements.forEach((S,$)=>this._balanceNamespaceList(S,$)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let S=0;S<this.collectedEnterElements.length;S++)co(this.collectedEnterElements[S],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const S=[];try{E=this._flushAnimations(S,g)}finally{for(let $=0;$<S.length;$++)S[$]()}}else for(let S=0;S<this.collectedLeaveElements.length;S++)this.processLeaveNode(this.collectedLeaveElements[S]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(S=>S()),this._flushFns=[],this._whenQuietFns.length){const S=this._whenQuietFns;this._whenQuietFns=[],E.length?Fn(E).onDone(()=>{S.forEach($=>$())}):S.forEach($=>$())}}reportError(g){throw function rn(v){return new w.vHH(3402,!1)}()}_flushAnimations(g,E){const S=new kt,$=[],te=new Map,ve=[],me=new Map,st=new Map,$t=new Map,er=new Set;this.disabledNodes.forEach(de=>{er.add(de);const ge=this.driver.query(de,".ng-animate-queued",!0);for(let be=0;be<ge.length;be++)er.add(ge[be])});const Yn=this.bodyNode,Nr=Array.from(this.statesByElement.keys()),Wr=js(Nr,this.collectedEnterElements),Sr=new Map;let Zr=0;Wr.forEach((de,ge)=>{const be=Xe+Zr++;Sr.set(ge,be),de.forEach(De=>co(De,be))});const Ur=[],hi=new Set,Zi=new Set;for(let de=0;de<this.collectedLeaveElements.length;de++){const ge=this.collectedLeaveElements[de],be=ge[Ro];be&&be.setForRemoval&&(Ur.push(ge),hi.add(ge),be.hasAnimation?this.driver.query(ge,".ng-star-inserted",!0).forEach(De=>hi.add(De)):Zi.add(ge))}const _o=new Map,h=js(Nr,Array.from(hi));h.forEach((de,ge)=>{const be=ue+Zr++;_o.set(ge,be),de.forEach(De=>co(De,be))}),g.push(()=>{Wr.forEach((de,ge)=>{const be=Sr.get(ge);de.forEach(De=>Mo(De,be))}),h.forEach((de,ge)=>{const be=_o.get(ge);de.forEach(De=>Mo(De,be))}),Ur.forEach(de=>{this.processLeaveNode(de)})});const i=[],c=[];for(let de=this._namespaceList.length-1;de>=0;de--)this._namespaceList[de].drainQueuedTransitions(E).forEach(be=>{const De=be.player,Oe=be.element;if(i.push(De),this.collectedEnterElements.length){const dt=Oe[Ro];if(dt&&dt.setForMove){if(dt.previousTriggersValues&&dt.previousTriggersValues.has(be.triggerName)){const Lt=dt.previousTriggersValues.get(be.triggerName),Tt=this.statesByElement.get(be.element);if(Tt&&Tt.has(be.triggerName)){const qt=Tt.get(be.triggerName);qt.value=Lt,Tt.set(be.triggerName,qt)}}return void De.destroy()}}const ae=!Yn||!this.driver.containsElement(Yn,Oe),Te=_o.get(Oe),Ge=Sr.get(Oe),Ve=this._buildInstruction(be,S,Ge,Te,ae);if(Ve.errors&&Ve.errors.length)return void c.push(Ve);if(ae)return De.onStart(()=>nt(Oe,Ve.fromStyles)),De.onDestroy(()=>fe(Oe,Ve.toStyles)),void $.push(De);if(be.isFallbackTransition)return De.onStart(()=>nt(Oe,Ve.fromStyles)),De.onDestroy(()=>fe(Oe,Ve.toStyles)),void $.push(De);const bt=[];Ve.timelines.forEach(dt=>{dt.stretchStartingKeyframe=!0,this.disabledNodes.has(dt.element)||bt.push(dt)}),Ve.timelines=bt,S.append(Oe,Ve.timelines),ve.push({instruction:Ve,player:De,element:Oe}),Ve.queriedElements.forEach(dt=>Lr(me,dt,[]).push(De)),Ve.preStyleProps.forEach((dt,Lt)=>{if(dt.size){let Tt=st.get(Lt);Tt||st.set(Lt,Tt=new Set),dt.forEach((qt,Rn)=>Tt.add(Rn))}}),Ve.postStyleProps.forEach((dt,Lt)=>{let Tt=$t.get(Lt);Tt||$t.set(Lt,Tt=new Set),dt.forEach((qt,Rn)=>Tt.add(Rn))})});if(c.length){const de=[];c.forEach(ge=>{de.push(function en(v,g){return new w.vHH(3505,!1)}())}),i.forEach(ge=>ge.destroy()),this.reportError(de)}const p=new Map,y=new Map;ve.forEach(de=>{const ge=de.element;S.has(ge)&&(y.set(ge,ge),this._beforeAnimationBuild(de.player.namespaceId,de.instruction,p))}),$.forEach(de=>{const ge=de.element;this._getPreviousPlayers(ge,!1,de.namespaceId,de.triggerName,null).forEach(De=>{Lr(p,ge,[]).push(De),De.destroy()})});const D=Ur.filter(de=>Hs(de,st,$t)),A=new Map;Ho(A,this.driver,Zi,$t,ye.l3).forEach(de=>{Hs(de,st,$t)&&D.push(de)});const z=new Map;Wr.forEach((de,ge)=>{Ho(z,this.driver,new Set(de),st,ye.k1)}),D.forEach(de=>{const ge=A.get(de),be=z.get(de);A.set(de,new Map([...ge?.entries()??[],...be?.entries()??[]]))});const G=[],W=[],oe={};ve.forEach(de=>{const{element:ge,player:be,instruction:De}=de;if(S.has(ge)){if(er.has(ge))return be.onDestroy(()=>fe(ge,De.toStyles)),be.disabled=!0,be.overrideTotalTime(De.totalTime),void $.push(be);let Oe=oe;if(y.size>1){let Te=ge;const Ge=[];for(;Te=Te.parentNode;){const Ve=y.get(Te);if(Ve){Oe=Ve;break}Ge.push(Te)}Ge.forEach(Ve=>y.set(Ve,Oe))}const ae=this._buildAnimation(be.namespaceId,De,p,te,z,A);if(be.setRealPlayer(ae),Oe===oe)G.push(be);else{const Te=this.playersByElement.get(Oe);Te&&Te.length&&(be.parentPlayer=Fn(Te)),$.push(be)}}else nt(ge,De.fromStyles),be.onDestroy(()=>fe(ge,De.toStyles)),W.push(be),er.has(ge)&&$.push(be)}),W.forEach(de=>{const ge=te.get(de.element);if(ge&&ge.length){const be=Fn(ge);de.setRealPlayer(be)}}),$.forEach(de=>{de.parentPlayer?de.syncPlayerEvents(de.parentPlayer):de.destroy()});for(let de=0;de<Ur.length;de++){const ge=Ur[de],be=ge[Ro];if(Mo(ge,ue),be&&be.hasAnimation)continue;let De=[];if(me.size){let ae=me.get(ge);ae&&ae.length&&De.push(...ae);let Te=this.driver.query(ge,yt,!0);for(let Ge=0;Ge<Te.length;Ge++){let Ve=me.get(Te[Ge]);Ve&&Ve.length&&De.push(...Ve)}}const Oe=De.filter(ae=>!ae.destroyed);Oe.length?oo(this,ge,Oe):this.processLeaveNode(ge)}return Ur.length=0,G.forEach(de=>{this.players.push(de),de.onDone(()=>{de.destroy();const ge=this.players.indexOf(de);this.players.splice(ge,1)}),de.play()}),G}afterFlush(g){this._flushFns.push(g)}afterFlushAnimationsDone(g){this._whenQuietFns.push(g)}_getPreviousPlayers(g,E,S,$,te){let ve=[];if(E){const me=this.playersByQueriedElement.get(g);me&&(ve=me)}else{const me=this.playersByElement.get(g);if(me){const st=!te||te==jo;me.forEach($t=>{$t.queued||!st&&$t.triggerName!=$||ve.push($t)})}}return(S||$)&&(ve=ve.filter(me=>!(S&&S!=me.namespaceId||$&&$!=me.triggerName))),ve}_beforeAnimationBuild(g,E,S){const te=E.element,ve=E.isRemovalTransition?void 0:g,me=E.isRemovalTransition?void 0:E.triggerName;for(const st of E.timelines){const $t=st.element,er=$t!==te,Yn=Lr(S,$t,[]);this._getPreviousPlayers($t,er,ve,me,E.toState).forEach(Wr=>{const Sr=Wr.getRealPlayer();Sr.beforeDestroy&&Sr.beforeDestroy(),Wr.destroy(),Yn.push(Wr)})}nt(te,E.fromStyles)}_buildAnimation(g,E,S,$,te,ve){const me=E.triggerName,st=E.element,$t=[],er=new Set,Yn=new Set,Nr=E.timelines.map(Sr=>{const Zr=Sr.element;er.add(Zr);const Ur=Zr[Ro];if(Ur&&Ur.removedBeforeQueried)return new ye.ZN(Sr.duration,Sr.delay);const hi=Zr!==st,Zi=function xa(v){const g=[];return Fi(v,g),g}((S.get(Zr)||go).map(p=>p.getRealPlayer())).filter(p=>!!p.element&&p.element===Zr),_o=te.get(Zr),h=ve.get(Zr),i=pr(this._normalizer,Sr.keyframes,_o,h),c=this._buildPlayer(Sr,i,Zi);if(Sr.subTimeline&&$&&Yn.add(Zr),hi){const p=new ts(g,me,Zr);p.setRealPlayer(c),$t.push(p)}return c});$t.forEach(Sr=>{Lr(this.playersByQueriedElement,Sr.element,[]).push(Sr),Sr.onDone(()=>function ns(v,g,E){let S=v.get(g);if(S){if(S.length){const $=S.indexOf(E);S.splice($,1)}0==S.length&&v.delete(g)}return S}(this.playersByQueriedElement,Sr.element,Sr))}),er.forEach(Sr=>co(Sr,at));const Wr=Fn(Nr);return Wr.onDestroy(()=>{er.forEach(Sr=>Mo(Sr,at)),fe(st,E.toStyles)}),Yn.forEach(Sr=>{Lr($,Sr,[]).push(Wr)}),Wr}_buildPlayer(g,E,S){return E.length>0?this.driver.animate(g.element,E,g.duration,g.delay,g.easing,S):new ye.ZN(g.duration,g.delay)}}class ts{constructor(g,E,S){this.namespaceId=g,this.triggerName=E,this.element=S,this._player=new ye.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(g){this._containsRealPlayer||(this._player=g,this._queuedCallbacks.forEach((E,S)=>{E.forEach($=>nr(g,S,void 0,$))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(g.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(g){this.totalTime=g}syncPlayerEvents(g){const E=this._player;E.triggerCallback&&g.onStart(()=>E.triggerCallback("start")),g.onDone(()=>this.finish()),g.onDestroy(()=>this.destroy())}_queueEvent(g,E){Lr(this._queuedCallbacks,g,[]).push(E)}onDone(g){this.queued&&this._queueEvent("done",g),this._player.onDone(g)}onStart(g){this.queued&&this._queueEvent("start",g),this._player.onStart(g)}onDestroy(g){this.queued&&this._queueEvent("destroy",g),this._player.onDestroy(g)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(g){this.queued||this._player.setPosition(g)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(g){const E=this._player;E.triggerCallback&&E.triggerCallback(g)}}function ka(v){return v&&1===v.nodeType}function va(v,g){const E=v.style.display;return v.style.display=g??"none",E}function Ho(v,g,E,S,$){const te=[];E.forEach(st=>te.push(va(st)));const ve=[];S.forEach((st,$t)=>{const er=new Map;st.forEach(Yn=>{const Nr=g.computeStyle($t,Yn,$);er.set(Yn,Nr),(!Nr||0==Nr.length)&&($t[Ro]=es,ve.push($t))}),v.set($t,er)});let me=0;return E.forEach(st=>va(st,te[me++])),ve}function js(v,g){const E=new Map;if(v.forEach(me=>E.set(me,[])),0==g.length)return E;const $=new Set(g),te=new Map;function ve(me){if(!me)return 1;let st=te.get(me);if(st)return st;const $t=me.parentNode;return st=E.has($t)?$t:$.has($t)?1:ve($t),te.set(me,st),st}return g.forEach(me=>{const st=ve(me);1!==st&&E.get(st).push(me)}),E}function co(v,g){v.classList?.add(g)}function Mo(v,g){v.classList?.remove(g)}function oo(v,g,E){Fn(E).onDone(()=>v.processLeaveNode(g))}function Fi(v,g){for(let E=0;E<v.length;E++){const S=v[E];S instanceof ye.ZE?Fi(S.players,g):g.push(S)}}function Hs(v,g,E){const S=E.get(v);if(!S)return!1;let $=g.get(v);return $?S.forEach(te=>$.add(te)):g.set(v,S),E.delete(v),!0}class gs{constructor(g,E,S){this.bodyNode=g,this._driver=E,this._normalizer=S,this._triggerCache={},this.onRemovalComplete=($,te)=>{},this._transitionEngine=new cs(g,E,S),this._timelineEngine=new Ms(g,E,S),this._transitionEngine.onRemovalComplete=($,te)=>this.onRemovalComplete($,te)}registerTrigger(g,E,S,$,te){const ve=g+"-"+$;let me=this._triggerCache[ve];if(!me){const st=[],er=zi(this._driver,te,st,[]);if(st.length)throw function zt(v,g){return new w.vHH(3404,!1)}();me=function vr(v,g,E){return new Ti(v,g,E)}($,er,this._normalizer),this._triggerCache[ve]=me}this._transitionEngine.registerTrigger(E,$,me)}register(g,E){this._transitionEngine.register(g,E)}destroy(g,E){this._transitionEngine.destroy(g,E)}onInsert(g,E,S,$){this._transitionEngine.insertNode(g,E,S,$)}onRemove(g,E,S){this._transitionEngine.removeNode(g,E,S)}disableAnimations(g,E){this._transitionEngine.markElementAsDisabled(g,E)}process(g,E,S,$){if("@"==S.charAt(0)){const[te,ve]=yn(S);this._timelineEngine.command(te,E,ve,$)}else this._transitionEngine.trigger(g,E,S,$)}listen(g,E,S,$,te){if("@"==S.charAt(0)){const[ve,me]=yn(S);return this._timelineEngine.listen(ve,E,me,te)}return this._transitionEngine.listen(g,E,S,$,te)}flush(g=-1){this._transitionEngine.flush(g)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(g){this._transitionEngine.afterFlushAnimationsDone(g)}}let Xo=(()=>{class g{constructor(S,$,te){this._element=S,this._startStyles=$,this._endStyles=te,this._state=0;let ve=g.initialStylesByElement.get(S);ve||g.initialStylesByElement.set(S,ve=new Map),this._initialStyles=ve}start(){this._state<1&&(this._startStyles&&fe(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(fe(this._element,this._initialStyles),this._endStyles&&(fe(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(g.initialStylesByElement.delete(this._element),this._startStyles&&(nt(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(nt(this._element,this._endStyles),this._endStyles=null),fe(this._element,this._initialStyles),this._state=3)}}return g.initialStylesByElement=new WeakMap,g})();function sa(v){let g=null;return v.forEach((E,S)=>{(function ba(v){return"display"===v||"position"===v})(S)&&(g=g||new Map,g.set(S,E))}),g}class Js{constructor(g,E,S,$){this.element=g,this.keyframes=E,this.options=S,this._specialStyles=$,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=S.duration,this._delay=S.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(g=>g()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const g=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,g,this.options),this._finalKeyframe=g.length?g[g.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(g){const E=[];return g.forEach(S=>{E.push(Object.fromEntries(S))}),E}_triggerWebAnimation(g,E,S){return g.animate(this._convertKeyframesToObject(E),S)}onStart(g){this._originalOnStartFns.push(g),this._onStartFns.push(g)}onDone(g){this._originalOnDoneFns.push(g),this._onDoneFns.push(g)}onDestroy(g){this._onDestroyFns.push(g)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(g=>g()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(g=>g()),this._onDestroyFns=[])}setPosition(g){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=g*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const g=new Map;this.hasStarted()&&this._finalKeyframe.forEach((S,$)=>{"offset"!==$&&g.set($,this._finished?S:wn(this.element,$))}),this.currentSnapshot=g}triggerCallback(g){const E="start"===g?this._onStartFns:this._onDoneFns;E.forEach(S=>S()),E.length=0}}class P{validateStyleProperty(g){return!0}validateAnimatableStyleProperty(g){return!0}matchesElement(g,E){return!1}containsElement(g,E){return Gi(g,E)}getParentElement(g){return Li(g)}query(g,E,S){return Tr(g,E,S)}computeStyle(g,E,S){return window.getComputedStyle(g)[E]}animate(g,E,S,$,te,ve=[]){const st={duration:S,delay:$,fill:0==$?"both":"forwards"};te&&(st.easing=te);const $t=new Map,er=ve.filter(Wr=>Wr instanceof Js);(function Bo(v,g){return 0===v||0===g})(S,$)&&er.forEach(Wr=>{Wr.currentSnapshot.forEach((Sr,Zr)=>$t.set(Zr,Sr))});let Yn=function se(v){return v.length?v[0]instanceof Map?v:v.map(g=>ke(g)):[]}(E).map(Wr=>Fe(Wr));Yn=function Kt(v,g,E){if(E.size&&g.length){let S=g[0],$=[];if(E.forEach((te,ve)=>{S.has(ve)||$.push(ve),S.set(ve,te)}),$.length)for(let te=1;te<g.length;te++){let ve=g[te];$.forEach(me=>ve.set(me,wn(v,me)))}}return g}(g,Yn,$t);const Nr=function us(v,g){let E=null,S=null;return Array.isArray(g)&&g.length?(E=sa(g[0]),g.length>1&&(S=sa(g[g.length-1]))):g instanceof Map&&(E=sa(g)),E||S?new Xo(v,E,S):null}(g,Yn);return new Js(g,Yn,st,Nr)}}var K=X(6814);let R=(()=>{var v;class g extends ye._j{constructor(S,$){super(),this._nextAnimationId=0,this._renderer=S.createRenderer($.body,{id:"0",encapsulation:w.ifc.None,styles:[],data:{animation:[]}})}build(S){const $=this._nextAnimationId.toString();this._nextAnimationId++;const te=Array.isArray(S)?(0,ye.vP)(S):S;return En(this._renderer,null,$,"register",[te]),new ne($,this._renderer)}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(w.FYo),w.LFG(K.K0))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})();class ne extends ye.LC{constructor(g,E){super(),this._id=g,this._renderer=E}create(g,E){return new Pe(this._id,g,E||{},this._renderer)}}class Pe{constructor(g,E,S,$){this.id=g,this.element=E,this._renderer=$,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",S)}_listen(g,E){return this._renderer.listen(this.element,`@@${this.id}:${g}`,E)}_command(g,...E){return En(this._renderer,this.element,this.id,g,E)}onDone(g){this._listen("done",g)}onStart(g){this._listen("start",g)}onDestroy(g){this._listen("destroy",g)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(g){this._command("setPosition",g)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function En(v,g,E,S,$){return v.setProperty(g,`@@${E}:${S}`,$)}const ir="@.disabled";let Oi=(()=>{var v;class g{constructor(S,$,te){this.delegate=S,this.engine=$,this._zone=te,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,$.onRemovalComplete=(ve,me)=>{const st=me?.parentNode(ve);st&&me.removeChild(st,ve)}}createRenderer(S,$){const ve=this.delegate.createRenderer(S,$);if(!(S&&$&&$.data&&$.data.animation)){let Yn=this._rendererCache.get(ve);return Yn||(Yn=new so("",ve,this.engine,()=>this._rendererCache.delete(ve)),this._rendererCache.set(ve,Yn)),Yn}const me=$.id,st=$.id+"-"+this._currentId;this._currentId++,this.engine.register(st,S);const $t=Yn=>{Array.isArray(Yn)?Yn.forEach($t):this.engine.registerTrigger(me,st,S,Yn.name,Yn)};return $.data.animation.forEach($t),new ee(this,st,ve,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(S,$,te){S>=0&&S<this._microtaskId?this._zone.run(()=>$(te)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(ve=>{const[me,st]=ve;me(st)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([$,te]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(w.FYo),w.LFG(gs),w.LFG(w.R0b))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})();class so{constructor(g,E,S,$){this.namespaceId=g,this.delegate=E,this.engine=S,this._onDestroy=$}get data(){return this.delegate.data}destroyNode(g){this.delegate.destroyNode?.(g)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(g,E){return this.delegate.createElement(g,E)}createComment(g){return this.delegate.createComment(g)}createText(g){return this.delegate.createText(g)}appendChild(g,E){this.delegate.appendChild(g,E),this.engine.onInsert(this.namespaceId,E,g,!1)}insertBefore(g,E,S,$=!0){this.delegate.insertBefore(g,E,S),this.engine.onInsert(this.namespaceId,E,g,$)}removeChild(g,E,S){this.engine.onRemove(this.namespaceId,E,this.delegate)}selectRootElement(g,E){return this.delegate.selectRootElement(g,E)}parentNode(g){return this.delegate.parentNode(g)}nextSibling(g){return this.delegate.nextSibling(g)}setAttribute(g,E,S,$){this.delegate.setAttribute(g,E,S,$)}removeAttribute(g,E,S){this.delegate.removeAttribute(g,E,S)}addClass(g,E){this.delegate.addClass(g,E)}removeClass(g,E){this.delegate.removeClass(g,E)}setStyle(g,E,S,$){this.delegate.setStyle(g,E,S,$)}removeStyle(g,E,S){this.delegate.removeStyle(g,E,S)}setProperty(g,E,S){"@"==E.charAt(0)&&E==ir?this.disableAnimations(g,!!S):this.delegate.setProperty(g,E,S)}setValue(g,E){this.delegate.setValue(g,E)}listen(g,E,S){return this.delegate.listen(g,E,S)}disableAnimations(g,E){this.engine.disableAnimations(g,E)}}class ee extends so{constructor(g,E,S,$,te){super(E,S,$,te),this.factory=g,this.namespaceId=E}setProperty(g,E,S){"@"==E.charAt(0)?"."==E.charAt(1)&&E==ir?this.disableAnimations(g,S=void 0===S||!!S):this.engine.process(this.namespaceId,g,E.slice(1),S):this.delegate.setProperty(g,E,S)}listen(g,E,S){if("@"==E.charAt(0)){const $=function Y(v){switch(v){case"body":return document.body;case"document":return document;case"window":return window;default:return v}}(g);let te=E.slice(1),ve="";return"@"!=te.charAt(0)&&([te,ve]=function Me(v){const g=v.indexOf(".");return[v.substring(0,g),v.slice(g+1)]}(te)),this.engine.listen(this.namespaceId,$,te,ve,me=>{this.factory.scheduleListenerCallback(me._data||-1,S,me)})}return this.delegate.listen(g,E,S)}}const zr=[{provide:ye._j,useClass:R},{provide:qr,useFactory:function We(){return new Ai}},{provide:gs,useClass:(()=>{var v;class g extends gs{constructor(S,$,te,ve){super(S.body,$,te)}ngOnDestroy(){this.flush()}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(K.K0),w.LFG(Yr),w.LFG(qr),w.LFG(w.z2F))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})()},{provide:w.FYo,useFactory:function zn(v,g,E){return new Oi(v,g,E)},deps:[M.se,gs,w.R0b]}],Oo=[{provide:Yr,useFactory:()=>new P},{provide:w.QbO,useValue:"BrowserAnimations"},...zr],rs=[{provide:Yr,useClass:yi},{provide:w.QbO,useValue:"NoopAnimations"},...zr];let is=(()=>{var v;class g{static withConfig(S){return{ngModule:g,providers:S.disableAnimations?rs:Oo}}}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275mod=w.oAB({type:v}),v.\u0275inj=w.cJS({providers:Oo,imports:[M.b2]}),g})();var Jo=X(2096),il=X(2459),Vl=X(5592),wa=X(6328),xl=X(2181),Fa=X(7398),Ul=X(4716),Ls=X(4664);class Gs{}class uo{}class Fs{constructor(g){this.normalizedNames=new Map,this.lazyUpdate=null,g?"string"==typeof g?this.lazyInit=()=>{this.headers=new Map,g.split("\n").forEach(E=>{const S=E.indexOf(":");if(S>0){const $=E.slice(0,S),te=$.toLowerCase(),ve=E.slice(S+1).trim();this.maybeSetNormalizedName($,te),this.headers.has(te)?this.headers.get(te).push(ve):this.headers.set(te,[ve])}})}:typeof Headers<"u"&&g instanceof Headers?(this.headers=new Map,g.forEach((E,S)=>{this.setHeaderEntries(S,E)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(g).forEach(([E,S])=>{this.setHeaderEntries(E,S)})}:this.headers=new Map}has(g){return this.init(),this.headers.has(g.toLowerCase())}get(g){this.init();const E=this.headers.get(g.toLowerCase());return E&&E.length>0?E[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(g){return this.init(),this.headers.get(g.toLowerCase())||null}append(g,E){return this.clone({name:g,value:E,op:"a"})}set(g,E){return this.clone({name:g,value:E,op:"s"})}delete(g,E){return this.clone({name:g,value:E,op:"d"})}maybeSetNormalizedName(g,E){this.normalizedNames.has(E)||this.normalizedNames.set(E,g)}init(){this.lazyInit&&(this.lazyInit instanceof Fs?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(g=>this.applyUpdate(g)),this.lazyUpdate=null))}copyFrom(g){g.init(),Array.from(g.headers.keys()).forEach(E=>{this.headers.set(E,g.headers.get(E)),this.normalizedNames.set(E,g.normalizedNames.get(E))})}clone(g){const E=new Fs;return E.lazyInit=this.lazyInit&&this.lazyInit instanceof Fs?this.lazyInit:this,E.lazyUpdate=(this.lazyUpdate||[]).concat([g]),E}applyUpdate(g){const E=g.name.toLowerCase();switch(g.op){case"a":case"s":let S=g.value;if("string"==typeof S&&(S=[S]),0===S.length)return;this.maybeSetNormalizedName(g.name,E);const $=("a"===g.op?this.headers.get(E):void 0)||[];$.push(...S),this.headers.set(E,$);break;case"d":const te=g.value;if(te){let ve=this.headers.get(E);if(!ve)return;ve=ve.filter(me=>-1===te.indexOf(me)),0===ve.length?(this.headers.delete(E),this.normalizedNames.delete(E)):this.headers.set(E,ve)}else this.headers.delete(E),this.normalizedNames.delete(E)}}setHeaderEntries(g,E){const S=(Array.isArray(E)?E:[E]).map(te=>te.toString()),$=g.toLowerCase();this.headers.set($,S),this.maybeSetNormalizedName(g,$)}forEach(g){this.init(),Array.from(this.normalizedNames.keys()).forEach(E=>g(this.normalizedNames.get(E),this.headers.get(E)))}}class jl{encodeKey(g){return dc(g)}encodeValue(g){return dc(g)}decodeKey(g){return decodeURIComponent(g)}decodeValue(g){return decodeURIComponent(g)}}const sl=/%(\d[a-f0-9])/gi,al={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function dc(v){return encodeURIComponent(v).replace(sl,(g,E)=>al[E]??g)}function fa(v){return`${v}`}class Ws{constructor(g={}){if(this.updates=null,this.cloneFrom=null,this.encoder=g.encoder||new jl,g.fromString){if(g.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function ol(v,g){const E=new Map;return v.length>0&&v.replace(/^\?/,"").split("&").forEach($=>{const te=$.indexOf("="),[ve,me]=-1==te?[g.decodeKey($),""]:[g.decodeKey($.slice(0,te)),g.decodeValue($.slice(te+1))],st=E.get(ve)||[];st.push(me),E.set(ve,st)}),E}(g.fromString,this.encoder)}else g.fromObject?(this.map=new Map,Object.keys(g.fromObject).forEach(E=>{const S=g.fromObject[E],$=Array.isArray(S)?S.map(fa):[fa(S)];this.map.set(E,$)})):this.map=null}has(g){return this.init(),this.map.has(g)}get(g){this.init();const E=this.map.get(g);return E?E[0]:null}getAll(g){return this.init(),this.map.get(g)||null}keys(){return this.init(),Array.from(this.map.keys())}append(g,E){return this.clone({param:g,value:E,op:"a"})}appendAll(g){const E=[];return Object.keys(g).forEach(S=>{const $=g[S];Array.isArray($)?$.forEach(te=>{E.push({param:S,value:te,op:"a"})}):E.push({param:S,value:$,op:"a"})}),this.clone(E)}set(g,E){return this.clone({param:g,value:E,op:"s"})}delete(g,E){return this.clone({param:g,value:E,op:"d"})}toString(){return this.init(),this.keys().map(g=>{const E=this.encoder.encodeKey(g);return this.map.get(g).map(S=>E+"="+this.encoder.encodeValue(S)).join("&")}).filter(g=>""!==g).join("&")}clone(g){const E=new Ws({encoder:this.encoder});return E.cloneFrom=this.cloneFrom||this,E.updates=(this.updates||[]).concat(g),E}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(g=>this.map.set(g,this.cloneFrom.map.get(g))),this.updates.forEach(g=>{switch(g.op){case"a":case"s":const E=("a"===g.op?this.map.get(g.param):void 0)||[];E.push(fa(g.value)),this.map.set(g.param,E);break;case"d":if(void 0===g.value){this.map.delete(g.param);break}{let S=this.map.get(g.param)||[];const $=S.indexOf(fa(g.value));-1!==$&&S.splice($,1),S.length>0?this.map.set(g.param,S):this.map.delete(g.param)}}}),this.cloneFrom=this.updates=null)}}class qa{constructor(){this.map=new Map}set(g,E){return this.map.set(g,E),this}get(g){return this.map.has(g)||this.map.set(g,g.defaultValue()),this.map.get(g)}delete(g){return this.map.delete(g),this}has(g){return this.map.has(g)}keys(){return this.map.keys()}}function Ic(v){return typeof ArrayBuffer<"u"&&v instanceof ArrayBuffer}function Mc(v){return typeof Blob<"u"&&v instanceof Blob}function fc(v){return typeof FormData<"u"&&v instanceof FormData}class Ea{constructor(g,E,S,$){let te;if(this.url=E,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=g.toUpperCase(),function hc(v){switch(v){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||$?(this.body=void 0!==S?S:null,te=$):te=S,te&&(this.reportProgress=!!te.reportProgress,this.withCredentials=!!te.withCredentials,te.responseType&&(this.responseType=te.responseType),te.headers&&(this.headers=te.headers),te.context&&(this.context=te.context),te.params&&(this.params=te.params)),this.headers||(this.headers=new Fs),this.context||(this.context=new qa),this.params){const ve=this.params.toString();if(0===ve.length)this.urlWithParams=E;else{const me=E.indexOf("?");this.urlWithParams=E+(-1===me?"?":me<E.length-1?"&":"")+ve}}else this.params=new Ws,this.urlWithParams=E}serializeBody(){return null===this.body?null:Ic(this.body)||Mc(this.body)||fc(this.body)||function Hl(v){return typeof URLSearchParams<"u"&&v instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ws?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||fc(this.body)?null:Mc(this.body)?this.body.type||null:Ic(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ws?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(g={}){const E=g.method||this.method,S=g.url||this.url,$=g.responseType||this.responseType,te=void 0!==g.body?g.body:this.body,ve=void 0!==g.withCredentials?g.withCredentials:this.withCredentials,me=void 0!==g.reportProgress?g.reportProgress:this.reportProgress;let st=g.headers||this.headers,$t=g.params||this.params;const er=g.context??this.context;return void 0!==g.setHeaders&&(st=Object.keys(g.setHeaders).reduce((Yn,Nr)=>Yn.set(Nr,g.setHeaders[Nr]),st)),g.setParams&&($t=Object.keys(g.setParams).reduce((Yn,Nr)=>Yn.set(Nr,g.setParams[Nr]),$t)),new Ea(E,S,te,{params:$t,headers:st,context:er,reportProgress:me,responseType:$,withCredentials:ve})}}var Qs=function(v){return v[v.Sent=0]="Sent",v[v.UploadProgress=1]="UploadProgress",v[v.ResponseHeader=2]="ResponseHeader",v[v.DownloadProgress=3]="DownloadProgress",v[v.Response=4]="Response",v[v.User=5]="User",v}(Qs||{});class Ba{constructor(g,E=200,S="OK"){this.headers=g.headers||new Fs,this.status=void 0!==g.status?g.status:E,this.statusText=g.statusText||S,this.url=g.url||null,this.ok=this.status>=200&&this.status<300}}class Na extends Ba{constructor(g={}){super(g),this.type=Qs.ResponseHeader}clone(g={}){return new Na({headers:g.headers||this.headers,status:void 0!==g.status?g.status:this.status,statusText:g.statusText||this.statusText,url:g.url||this.url||void 0})}}class Qo extends Ba{constructor(g={}){super(g),this.type=Qs.Response,this.body=void 0!==g.body?g.body:null}clone(g={}){return new Qo({body:void 0!==g.body?g.body:this.body,headers:g.headers||this.headers,status:void 0!==g.status?g.status:this.status,statusText:g.statusText||this.statusText,url:g.url||this.url||void 0})}}class ea extends Ba{constructor(g){super(g,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${g.url||"(unknown url)"}`:`Http failure response for ${g.url||"(unknown url)"}: ${g.status} ${g.statusText}`,this.error=g.error||null}}function B(v,g){return{body:g,headers:v.headers,context:v.context,observe:v.observe,params:v.params,reportProgress:v.reportProgress,responseType:v.responseType,withCredentials:v.withCredentials}}let Q=(()=>{var v;class g{constructor(S){this.handler=S}request(S,$,te={}){let ve;if(S instanceof Ea)ve=S;else{let $t,er;$t=te.headers instanceof Fs?te.headers:new Fs(te.headers),te.params&&(er=te.params instanceof Ws?te.params:new Ws({fromObject:te.params})),ve=new Ea(S,$,void 0!==te.body?te.body:null,{headers:$t,context:te.context,params:er,reportProgress:te.reportProgress,responseType:te.responseType||"json",withCredentials:te.withCredentials})}const me=(0,Jo.of)(ve).pipe((0,wa.b)($t=>this.handler.handle($t)));if(S instanceof Ea||"events"===te.observe)return me;const st=me.pipe((0,xl.h)($t=>$t instanceof Qo));switch(te.observe||"body"){case"body":switch(ve.responseType){case"arraybuffer":return st.pipe((0,Fa.U)($t=>{if(null!==$t.body&&!($t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return $t.body}));case"blob":return st.pipe((0,Fa.U)($t=>{if(null!==$t.body&&!($t.body instanceof Blob))throw new Error("Response is not a Blob.");return $t.body}));case"text":return st.pipe((0,Fa.U)($t=>{if(null!==$t.body&&"string"!=typeof $t.body)throw new Error("Response is not a string.");return $t.body}));default:return st.pipe((0,Fa.U)($t=>$t.body))}case"response":return st;default:throw new Error(`Unreachable: unhandled observe type ${te.observe}}`)}}delete(S,$={}){return this.request("DELETE",S,$)}get(S,$={}){return this.request("GET",S,$)}head(S,$={}){return this.request("HEAD",S,$)}jsonp(S,$){return this.request("JSONP",S,{params:(new Ws).append($,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(S,$={}){return this.request("OPTIONS",S,$)}patch(S,$,te={}){return this.request("PATCH",S,B(te,$))}post(S,$,te={}){return this.request("POST",S,B(te,$))}put(S,$,te={}){return this.request("PUT",S,B(te,$))}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(Gs))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})();function vi(v,g){return g(v)}function xi(v,g){return(E,S)=>g.intercept(E,{handle:$=>v($,S)})}const eo=new w.OlP(""),Ei=new w.OlP(""),ki=new w.OlP("");function ko(){let v=null;return(g,E)=>{null===v&&(v=((0,w.f3M)(eo,{optional:!0})??[]).reduceRight(xi,vi));const S=(0,w.f3M)(w.HDt),$=S.add();return v(g,E).pipe((0,Ul.x)(()=>S.remove($)))}}let Ps=(()=>{var v;class g extends Gs{constructor(S,$){super(),this.backend=S,this.injector=$,this.chain=null,this.pendingTasks=(0,w.f3M)(w.HDt)}handle(S){if(null===this.chain){const te=Array.from(new Set([...this.injector.get(Ei),...this.injector.get(ki,[])]));this.chain=te.reduceRight((ve,me)=>function Br(v,g,E){return(S,$)=>E.runInContext(()=>g(S,te=>v(te,$)))}(ve,me,this.injector),vi)}const $=this.pendingTasks.add();return this.chain(S,te=>this.backend.handle(te)).pipe((0,Ul.x)(()=>this.pendingTasks.remove($)))}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(uo),w.LFG(w.lqb))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})();const wl=/^\)\]\}',?\n/;let Ya=(()=>{var v;class g{constructor(S){this.xhrFactory=S}handle(S){if("JSONP"===S.method)throw new w.vHH(-2800,!1);const $=this.xhrFactory;return($.\u0275loadImpl?(0,il.D)($.\u0275loadImpl()):(0,Jo.of)(null)).pipe((0,Ls.w)(()=>new Vl.y(ve=>{const me=$.build();if(me.open(S.method,S.urlWithParams),S.withCredentials&&(me.withCredentials=!0),S.headers.forEach((Ur,hi)=>me.setRequestHeader(Ur,hi.join(","))),S.headers.has("Accept")||me.setRequestHeader("Accept","application/json, text/plain, */*"),!S.headers.has("Content-Type")){const Ur=S.detectContentTypeHeader();null!==Ur&&me.setRequestHeader("Content-Type",Ur)}if(S.responseType){const Ur=S.responseType.toLowerCase();me.responseType="json"!==Ur?Ur:"text"}const st=S.serializeBody();let $t=null;const er=()=>{if(null!==$t)return $t;const Ur=me.statusText||"OK",hi=new Fs(me.getAllResponseHeaders()),Zi=function ys(v){return"responseURL"in v&&v.responseURL?v.responseURL:/^X-Request-URL:/m.test(v.getAllResponseHeaders())?v.getResponseHeader("X-Request-URL"):null}(me)||S.url;return $t=new Na({headers:hi,status:me.status,statusText:Ur,url:Zi}),$t},Yn=()=>{let{headers:Ur,status:hi,statusText:Zi,url:_o}=er(),h=null;204!==hi&&(h=typeof me.response>"u"?me.responseText:me.response),0===hi&&(hi=h?200:0);let i=hi>=200&&hi<300;if("json"===S.responseType&&"string"==typeof h){const c=h;h=h.replace(wl,"");try{h=""!==h?JSON.parse(h):null}catch(p){h=c,i&&(i=!1,h={error:p,text:h})}}i?(ve.next(new Qo({body:h,headers:Ur,status:hi,statusText:Zi,url:_o||void 0})),ve.complete()):ve.error(new ea({error:h,headers:Ur,status:hi,statusText:Zi,url:_o||void 0}))},Nr=Ur=>{const{url:hi}=er(),Zi=new ea({error:Ur,status:me.status||0,statusText:me.statusText||"Unknown Error",url:hi||void 0});ve.error(Zi)};let Wr=!1;const Sr=Ur=>{Wr||(ve.next(er()),Wr=!0);let hi={type:Qs.DownloadProgress,loaded:Ur.loaded};Ur.lengthComputable&&(hi.total=Ur.total),"text"===S.responseType&&me.responseText&&(hi.partialText=me.responseText),ve.next(hi)},Zr=Ur=>{let hi={type:Qs.UploadProgress,loaded:Ur.loaded};Ur.lengthComputable&&(hi.total=Ur.total),ve.next(hi)};return me.addEventListener("load",Yn),me.addEventListener("error",Nr),me.addEventListener("timeout",Nr),me.addEventListener("abort",Nr),S.reportProgress&&(me.addEventListener("progress",Sr),null!==st&&me.upload&&me.upload.addEventListener("progress",Zr)),me.send(st),ve.next({type:Qs.Sent}),()=>{me.removeEventListener("error",Nr),me.removeEventListener("abort",Nr),me.removeEventListener("load",Yn),me.removeEventListener("timeout",Nr),S.reportProgress&&(me.removeEventListener("progress",Sr),null!==st&&me.upload&&me.upload.removeEventListener("progress",Zr)),me.readyState!==me.DONE&&me.abort()}})))}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(K.JF))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})();const Bs=new w.OlP("XSRF_ENABLED"),Da=new w.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),ql=new w.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class za{}let Zl=(()=>{var v;class g{constructor(S,$,te){this.doc=S,this.platform=$,this.cookieName=te,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const S=this.doc.cookie||"";return S!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,K.Mx)(S,this.cookieName),this.lastCookieString=S),this.lastToken}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(K.K0),w.LFG(w.Lbi),w.LFG(Da))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac}),g})();function pc(v,g){const E=v.url.toLowerCase();if(!(0,w.f3M)(Bs)||"GET"===v.method||"HEAD"===v.method||E.startsWith("http://")||E.startsWith("https://"))return g(v);const S=(0,w.f3M)(za).getToken(),$=(0,w.f3M)(ql);return null!=S&&!v.headers.has($)&&(v=v.clone({headers:v.headers.set($,S)})),g(v)}var ni=function(v){return v[v.Interceptors=0]="Interceptors",v[v.LegacyInterceptors=1]="LegacyInterceptors",v[v.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",v[v.NoXsrfProtection=3]="NoXsrfProtection",v[v.JsonpSupport=4]="JsonpSupport",v[v.RequestsMadeViaParent=5]="RequestsMadeViaParent",v[v.Fetch=6]="Fetch",v}(ni||{});function Ca(v,g){return{\u0275kind:v,\u0275providers:g}}function El(...v){const g=[Q,Ya,Ps,{provide:Gs,useExisting:Ps},{provide:uo,useExisting:Ya},{provide:Ei,useValue:pc,multi:!0},{provide:Bs,useValue:!0},{provide:za,useClass:Zl}];for(const E of v)g.push(...E.\u0275providers);return(0,w.MR2)(g)}const Dl=new w.OlP("LEGACY_INTERCEPTOR_FN");let Ts=(()=>{var v;class g{}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275mod=w.oAB({type:v}),v.\u0275inj=w.cJS({providers:[El(Ca(ni.LegacyInterceptors,[{provide:Dl,useFactory:ko},{provide:Ei,useExisting:Dl,multi:!0}]))]}),g})();var Kl=X(9397),gc=X(6306);let lu=(()=>{var v;class g{constructor(S){this.http=S,this.URL="https://nancyb3a.github.io/Test_/usuarios_PGY4121_08.json",this.httpHeader={headers:new Fs({"Content-Type":"application/json","Access-Control-Allow-Origin":"*"})}}getUser(S){return this.http.get(`${this.URL}`+S).pipe((0,Kl.b)($=>console.log(`User fetched: ${S}`)),(0,gc.K)(this.handleError(`Get user id=${S}`)))}getUserList(){return this.http.get(`${this.URL}`).pipe((0,Kl.b)(S=>console.log("User fetched!")),(0,gc.K)(this.handleError("Get user",[])))}handleError(S="operation",$){return te=>(console.error(te),console.log(`${S} failed: ${te.message}`),(0,Jo.of)($))}}return(v=g).\u0275fac=function(S){return new(S||v)(w.LFG(Q))},v.\u0275prov=w.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),g})();var qs=X(7217);const Rc_firebaseConfig={apiKey:"AIzaSyC_vVuvLOV4sbVPrFPvzCuIU7lKHeU4zLU",authDomain:"hospit-app-8ea71.firebaseapp.com",projectId:"hospit-app-8ea71",storageBucket:"hospit-app-8ea71.appspot.com",messagingSenderId:"336867522127",appId:"1:336867522127:web:2870db3c2bdc1f512b5c3a"};let L=(()=>{var v;class g{}return(v=g).\u0275fac=function(S){return new(S||v)},v.\u0275mod=w.oAB({type:v,bootstrap:[_e]}),v.\u0275inj=w.cJS({providers:[{provide:lt.wN,useClass:l.r4},lu],imports:[M.b2,l.Pc.forRoot(),Ke,is,Ts,qs.hO.initializeApp(Rc_firebaseConfig)]}),g})();var N=X(2574);X.n(N)().accessToken="pk.eyJ1IjoicGF0MWhubyIsImEiOiJjbG5naWgyOXIwYnF2Mm1vOXhueWFtbXM4In0.zfLtRF__vmCcRycCOuJbPw",(0,w.G48)(),M.q6().bootstrapModule(L).catch(v=>console.log(v))},2574:function(Hn){Hn.exports=function(){"use strict";var It,X,M;function w(l,_e){if(It)if(X){var Ne="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+It+")(sharedChunk); ("+X+")(sharedChunk); self.onerror = null;",Le={};It(Le),M=_e(Le),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(M.workerUrl=window.URL.createObjectURL(new Blob([Ne],{type:"text/javascript"})))}else X=_e;else It=_e}return w(0,function(l){var _e=typeof self<"u"?self:{},Ne="2.15.0";let Le;const tt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Le){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Le=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):n}catch{Le=n}}return Le},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!tt.API_URL)return null;try{const n=new URL(tt.API_URL);return"api.mapbox.cn"===n.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===n.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ke={supported:!1,testSupport:function(n){!Ze&&Ae&&(Qe?ot(n):ye=n)}};let ye,Ae,Ze=!1,Qe=!1;function ot(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,Ae),n.isContextLost())return;Ke.supported=!0}catch{}n.deleteTexture(e),Ze=!0}_e.document&&(Ae=_e.document.createElement("img"),Ae.onload=function(){ye&&ot(ye),ye=null,Qe=!0},Ae.onerror=function(){Ze=!0,ye=null},Ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const mt="01";function xt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var pt=et;function et(n,e,r,s){this.cx=3*n,this.bx=3*(r-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=r,this.p2y=s}et.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(void 0===e&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var r=n,s=0;s<8;s++){var u=this.sampleCurveX(r)-n;if(Math.abs(u)<e)return r;var f=this.sampleCurveDerivativeX(r);if(Math.abs(f)<1e-6)break;r-=u/f}var _=0,x=1;for(r=n,s=0;s<20&&(u=this.sampleCurveX(r),!(Math.abs(u-n)<e));s++)n>u?_=r:x=r,r=.5*(x-_)+_;return r},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Ot=xt(pt),Pt=Ce;function Ce(n,e){this.x=n,this.y=e}Ce.prototype={clone:function(){return new Ce(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,r=n.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),r=Math.sin(n),s=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=s,this},_rotateAround:function(n,e){var r=Math.cos(n),s=Math.sin(n),u=e.y+s*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ce.convert=function(n){return n instanceof Ce?n:Array.isArray(n)?new Ce(n[0],n[1]):n};var Ie=xt(Pt);const ct=Math.PI/180,St=180/Math.PI;function Ye(n){return n*ct}function gt(n){return n*St}const Wt=[[0,0],[1,0],[1,1],[0,1]];function Nt(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,r=e*n;return 4*(n<.5?r:3*(n-e)+r-.75)}function an(n,e,r,s){const u=new Ot(n,e,r,s);return function(f){return u.solve(f)}}const Qt=an(.25,.1,.25,1);function Vt(n,e,r){return Math.min(r,Math.max(e,n))}function Jn(n,e,r){return(r=Vt((r-n)/(e-n),0,1))*r*(3-2*r)}function Zt(n,e,r){const s=r-e,u=((n-e)%s+s)%s+e;return u===e?r:u}function Pn(n,e,r){if(!n.length)return r(null,[]);let s=n.length;const u=new Array(n.length);let f=null;n.forEach((_,x)=>{e(_,(C,T)=>{C&&(f=C),u[x]=T,0==--s&&r(f,u)})})}function zt(n){const e=[];for(const r in n)e.push(n[r]);return e}function Se(n,...e){for(const r of e)for(const s in r)n[s]=r[s];return n}let ze=1;function ut(){return ze++}function Dt(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function jt(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function nn(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function ln(n,e){n.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function _n(n,e){return-1!==n.indexOf(e,n.length-e.length)}function bn(n,e,r){const s={};for(const u in n)s[u]=e.call(r||this,n[u],u,n);return s}function rn(n,e,r){const s={};for(const u in n)e.call(r||this,n[u],u,n)&&(s[u]=n[u]);return s}function Jt(n){return Array.isArray(n)?n.map(Jt):"object"==typeof n&&n?bn(n,Jt):n}const en={};function dn(n){en[n]||(typeof console<"u"&&console.warn(n),en[n]=!0)}function Fn(n,e,r){return(r.y-n.y)*(e.x-n.x)>(e.y-n.y)*(r.x-n.x)}function pr(n){let e=0;for(let r,s,u=0,f=n.length,_=f-1;u<f;_=u++)r=n[u],s=n[_],e+=(s.x-r.x)*(r.y+s.y);return e}function nr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function gr(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,s,u,f)=>{const _=u||f;return e[s]=!_||_.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let Xn=null;function Lr(n){if(null==Xn){const e=n.navigator?n.navigator.userAgent:null;Xn=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Xn}function yn(n){try{const e=_e[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Jr(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const Li="mapbox-tiles";let wr,_r,ui=500,hr=50;function mr(){try{return _e.caches}catch{}}function Di(){mr()&&!wr&&(wr=_e.caches.open(Li))}function Gi(n){const e=n.indexOf("?");if(e<0)return n;const s=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(n).filter(u=>{const f=u.split("=");return"language"===f[0]||"worldview"===f[0]});return s.length?`${n.slice(0,e)}?${s.join("&")}`:n.slice(0,e)}let Tr=1/0;const Mi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Mi);class yi extends Error{constructor(e,r,s){401===r&&Mt(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Yr=nr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===_e.location.protocol?_e.parent:_e).location.href,Do=function(n,e){if(!(/^file:/.test(r=n.url)||/^file:/.test(Yr())&&!/^\w+:/.test(r))){if(_e.fetch&&_e.Request&&_e.AbortController&&_e.Request.prototype.hasOwnProperty("signal"))return function(s,u){const f=new _e.AbortController,_=new _e.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Yr(),referrerPolicy:s.referrerPolicy,signal:f.signal});let x=!1,C=!1;const T=(F=_.url).indexOf("sku=")>0&&Mt(F);var F;"json"===s.type&&_.headers.set("Accept","application/json");const V=(q,J,le)=>{if(C)return;if(q&&"SecurityError"!==q.message&&dn(q.toString()),J&&le)return j(J);const Ee=Date.now();_e.fetch(_).then(Ue=>{if(Ue.ok){const rt=T?Ue.clone():null;return j(Ue,rt,Ee)}return u(new yi(Ue.statusText,Ue.status,s.url))}).catch(Ue=>{"AbortError"!==Ue.name&&u(new Error(`${Ue.message} ${s.url}`))})},j=(q,J,le)=>{("arrayBuffer"===s.type?q.arrayBuffer():"json"===s.type?q.json():q.text()).then(Ee=>{C||(J&&le&&function(Ue,rt,je){if(Di(),!wr)return;const it={status:rt.status,statusText:rt.statusText,headers:new _e.Headers};rt.headers.forEach((Yt,Ut)=>it.headers.set(Ut,Yt));const ft=gr(rt.headers.get("Cache-Control")||"");if(ft["no-store"])return;ft["max-age"]&&it.headers.set("Expires",new Date(je+1e3*ft["max-age"]).toUTCString());const ht=it.headers.get("Expires");ht&&(new Date(ht).getTime()-je<42e4||function(Yt,Ut){if(void 0===_r)try{new Response(new ReadableStream),_r=!0}catch{_r=!1}_r?Ut(Yt.body):Yt.blob().then(Ut)}(rt,Yt=>{const Ut=new _e.Response(Yt,it);Di(),wr&&wr.then(hn=>hn.put(Gi(Ue.url),Ut)).catch(hn=>dn(hn.message))}))}(_,J,le),x=!0,u(null,Ee,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(Ee=>{C||u(new Error(Ee.message))})};return T?function(q,J){if(Di(),!wr)return J(null);const le=Gi(q.url);wr.then(Ee=>{Ee.match(le).then(Ue=>{const rt=function(je){if(!je)return!1;const it=new Date(je.headers.get("Expires")||0),ft=gr(je.headers.get("Cache-Control")||"");return it>Date.now()&&!ft["no-cache"]}(Ue);Ee.delete(le),rt&&Ee.put(le,Ue.clone()),J(null,Ue,rt)}).catch(J)}).catch(J)}(_,V):V(null,null),{cancel:()=>{C=!0,x||f.abort()}}}(n,e);if(nr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var r;return function(s,u){const f=new _e.XMLHttpRequest;f.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(f.responseType="arraybuffer");for(const _ in s.headers)f.setRequestHeader(_,s.headers[_]);return"json"===s.type&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials="include"===s.credentials,f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||0===f.status)&&null!==f.response){let _=f.response;if("json"===s.type)try{_=JSON.parse(f.response)}catch(x){return u(x)}u(null,_,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new yi(f.statusText,f.status,s.url))},f.send(s.body),{cancel:()=>f.abort()}}(n,e)},Or=function(n,e){return Do(Se(n,{type:"arrayBuffer"}),e)};function Co(n){const e=_e.document.createElement("a");return e.href=n,e.protocol===_e.document.location.protocol&&e.host===_e.document.location.host}const Xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ue,pe;ue=[],pe=0;const He=function(n,e){if(Ke.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),pe>=tt.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return ue.push(f),f}pe++;let r=!1;const s=()=>{if(!r)for(r=!0,pe--;ue.length&&pe<tt.MAX_PARALLEL_IMAGE_REQUESTS;){const f=ue.shift(),{requestParameters:_,callback:x,cancelled:C}=f;C||(f.cancel=He(_,x).cancel)}},u=Or(n,(f,_,x,C)=>{s(),f?e(f):_&&(_e.createImageBitmap?function(T,F){const V=new _e.Blob([new Uint8Array(T)],{type:"image/png"});_e.createImageBitmap(V).then(j=>{F(null,j)}).catch(j=>{F(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(T,F)=>e(T,F,x,C)):function(T,F){const V=new _e.Image,j=_e.URL;V.onload=()=>{F(null,V),j.revokeObjectURL(V.src),V.onload=null,_e.requestAnimationFrame(()=>{V.src=Xe})},V.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new _e.Blob([new Uint8Array(T)],{type:"image/png"});V.src=T.byteLength?j.createObjectURL(q):Xe}(_,(T,F)=>e(T,F,x,C)))});return{cancel:()=>{u.cancel(),s()}}},at="NO_ACCESS_TOKEN";function yt(n){return 0===n.indexOf("mapbox:")}function Mt(n){return tt.API_URL_REGEX.test(n)}function At(n){return tt.API_CDN_URL_REGEX.test(n)}function _t(n){return tt.API_STYLE_REGEX.test(n)&&!Bt(n)}function Bt(n){return tt.API_SPRITE_REGEX.test(n)}const pn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ke(n){const e=n.match(pn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function se(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}const ce="mapbox.eventData";function Fe(n){if(!n)return null;const e=n.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(_e.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class fe{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=Fe(tt.ACCESS_TOKEN);let s="";return s=r&&r.u?_e.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(+("0x"+f)))):tt.ACCESS_TOKEN||"",e?`${ce}.${e}:${s}`:`${ce}:${s}`}fetchEventData(){const e=yn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const u=_e.localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));const f=_e.localStorage.getItem(s);f&&(this.anonId=f)}catch{dn("Unable to read from LocalStorage")}}saveEventData(){const e=yn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{_e.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&_e.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{dn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,s,u){if(!tt.EVENTS_URL)return;const f=ke(tt.EVENTS_URL);f.params.push(`access_token=${u||tt.ACCESS_TOKEN||""}`);const _={event:this.type,created:new Date(e).toISOString()},x=r?Se(_,r):_,C={url:se(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};var F;this.pendingRequest=(F=T=>{this.pendingRequest=null,s(T),this.saveEventData(),this.processRequests(u)},Do(Se(C,{method:"POST"}),F))}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const nt=new class extends fe{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){tt.EVENTS_URL&&tt.ACCESS_TOKEN&&Array.isArray(n)&&n.some(r=>yt(r)||Mt(r))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Fe(tt.ACCESS_TOKEN),r=e?e.u:tt.ACCESS_TOKEN;let s=r!==this.eventData.tokenU;nn(this.anonId)||(this.anonId=Dt(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),_=new Date(u),x=(u-this.eventData.lastSuccess)/864e5;s=s||x>=1||x<-1||f.getDate()!==_.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ne,skuId:mt,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},n):this.processRequests()}},Ft=nt.postTurnstileEvent.bind(nt),mn=new class extends fe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,r,s){this.skuToken=e,this.errorCb=s,tt.EVENTS_URL&&(r||tt.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},r):this.errorCb(new Error(at)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),nn(this.anonId)||(this.anonId=Dt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ne,skuId:mt,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n))}},Zn=mn.postMapLoadEvent.bind(mn),Gn=new class extends fe{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){tt.EVENTS_URL&&(n||tt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:r}=this.queue.shift(),s=function(u){const f=_e.performance.getEntriesByType("resource"),_=_e.performance.getEntriesByType("mark"),x=function(j){const q={};if(j)for(const J in j)if("other"!==J)for(const le of j[J]){const Ee=`${J}ResolveRangeMin`,Ue=`${J}ResolveRangeMax`,rt=`${J}RequestCount`,je=`${J}RequestCachedCount`;q[Ee]=Math.min(q[Ee]||1/0,le.startTime),q[Ue]=Math.max(q[Ue]||-1/0,le.responseEnd);const it=ft=>{void 0===q[ft]&&(q[ft]=0),++q[ft]};void 0!==le.transferSize&&0===le.transferSize&&it(je),it(rt)}return q}(function(j,q){const J={};if(j)for(const le of j){const Ee=q(le);void 0===J[Ee]&&(J[Ee]=[]),J[Ee].push(le)}return J}(f,Kt)),C=_e.devicePixelRatio,T=_e.navigator.connection||_e.navigator.mozConnection||_e.navigator.webkitConnection,F={counters:[],metadata:[],attributes:[]},V=(j,q,J)=>{null!=J&&j.push({name:q,value:J.toString()})};for(const j in x)V(F.counters,j,x[j]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(V(F.counters,"interactionRangeMin",u.interactionRange[0]),V(F.counters,"interactionRangeMax",u.interactionRange[1])),_)for(const j of Object.keys(no)){const q=no[j],J=_.find(le=>le.name===q);J&&V(F.counters,q,J.startTime)}return V(F.counters,"visibilityHidden",u.visibilityHidden),V(F.attributes,"style",function(j){if(j)for(const q of j){const J=q.name.split("?")[0];if(_t(J)){const le=J.split("/").slice(-2);if(2===le.length)return`mapbox://styles/${le[0]}/${le[1]}`}}}(f)),V(F.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),V(F.attributes,"fogEnabled",u.fogEnabled?"true":"false"),V(F.attributes,"projection",u.projection),V(F.attributes,"zoom",u.zoom),V(F.metadata,"devicePixelRatio",C),V(F.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),V(F.metadata,"navigatorUserAgent",_e.navigator.userAgent),V(F.metadata,"screenWidth",_e.screen.width),V(F.metadata,"screenHeight",_e.screen.height),V(F.metadata,"windowWidth",_e.innerWidth),V(F.metadata,"windowHeight",_e.innerHeight),V(F.metadata,"mapWidth",u.width/C),V(F.metadata,"mapHeight",u.height/C),V(F.metadata,"webglRenderer",u.renderer),V(F.metadata,"webglVendor",u.vendor),V(F.metadata,"sdkVersion",Ne),V(F.metadata,"sdkIdentifier","mapbox-gl-js"),F}(r);for(const u of s.metadata);for(const u of s.counters);for(const u of s.attributes);this.postEvent(e,s,()=>{},n)}},dr=Gn.postPerformanceEvent.bind(Gn),yr=new class extends fe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,r,s){if(!tt.API_URL||!tt.SESSION_PATH)return;const u=ke(tt.API_URL+tt.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||tt.ACCESS_TOKEN||""}`);const f={url:se(u),headers:{"Content-Type":"text/plain"}};var x;this.pendingRequest=(x=_=>{this.pendingRequest=null,r(_),this.saveEventData(),this.processRequests(s)},Do(Se(f,{method:"GET"}),x))}getSessionAPI(n,e,r,s){this.skuToken=e,this.errorCb=s,tt.SESSION_PATH&&tt.API_URL&&(r||tt.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},r):this.errorCb(new Error(at)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n)}},Hr=yr.getSessionAPI.bind(yr),ti=new Set,no={create:"create",load:"load",fullLoad:"fullLoad"},Bo={mark(n){_e.performance.mark(n)},measure(n,e,r){_e.performance.measure(n,e,r)}};function Kt(n){const e=n.name.split("?")[0];return At(e)&&e.includes("mapbox-gl.js")?"javascript":At(e)&&e.includes("mapbox-gl.css")?"css":tt.API_FONTS_REGEX.test(e)?"fontRange":Bt(e)?"sprite":_t(e)?"style":tt.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const Et=_e.performance;function wn(n){const e=n?n.url.toString():void 0;return Et.getEntriesByName(e)}let cr,qn,Rr,Fr;const di={now:()=>void 0!==Rr?Rr:_e.performance.now(),setNow(n){Rr=n},restoreNow(){Rr=void 0},frame(n){const e=_e.requestAnimationFrame(n);return{cancel:()=>_e.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:r,height:s}=n;Fr||(Fr=_e.document.createElement("canvas"));const u=Fr.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>Fr.width||s>Fr.height)&&(Fr.width=r,Fr.height=s),u.clearRect(-e,-e,r+2*e,s+2*e),u.drawImage(n,0,0,r,s),u.getImageData(-e,-e,r+2*e,s+2*e)},resolveURL:n=>(cr||(cr=_e.document.createElement("a")),cr.href=n,cr.href),get devicePixelRatio(){return _e.devicePixelRatio},get prefersReducedMotion(){return!!_e.matchMedia&&(null==qn&&(qn=_e.matchMedia("(prefers-reduced-motion: reduce)")),qn.matches)}};function Ci(n,e,r){r[n]&&-1!==r[n].indexOf(e)||(r[n]=r[n]||[],r[n].push(e))}function Qr(n,e,r){if(r&&r[n]){const s=r[n].indexOf(e);-1!==s&&r[n].splice(s,1)}}class li{constructor(e,r={}){Se(this,r),this.type=e}}class Gr extends li{constructor(e,r={}){super("error",Se({error:e},r))}}class Es{on(e,r){return this._listeners=this._listeners||{},Ci(e,r,this._listeners),this}off(e,r){return Qr(e,r,this._listeners),Qr(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ci(e,r,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,r){"string"==typeof e&&(e=new li(e,r||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const x of u)x.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const x of f)Qr(s,x,this._oneTimeListeners),x.call(this,e);const _=this._eventedParent;_&&(Se(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof Gr&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var on=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ro(n,...e){for(const r of e)for(const s in r)n[s]=r[s];return n}function bi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function ii(n){if(Array.isArray(n))return n.map(ii);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const r in n)e[r]=ii(n[r]);return e}return bi(n)}class Yo extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var zi=Yo;class ss{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[s,u]of r)this.bindings[s]=u}concat(e){return new ss(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Po=ss;const No={kind:"null"},Wn={kind:"number"},Dr={kind:"string"},he={kind:"boolean"},$e={kind:"color"},we={kind:"object"},Be={kind:"value"},Ct={kind:"collator"},kt={kind:"formatted"},cn={kind:"resolvedImage"};function gn(n,e){return{kind:"array",itemType:n,N:e}}function un(n){if("array"===n.kind){const e=un(n.itemType);return"number"==typeof n.N?`array<${e}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${e}>`}return n.kind}const In=[No,Wn,Dr,he,$e,kt,we,gn(Be),cn];function lr(n,e){if("error"===e.kind)return null;if("array"===n.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!lr(n.itemType,e.itemType))&&("number"!=typeof n.N||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if("value"===n.kind)for(const r of In)if(!lr(r,e))return null}return`Expected ${un(n)} but found ${un(e)} instead.`}function Cr(n,e){return e.some(r=>r.kind===n.kind)}function kr(n,e){return e.some(r=>"null"===r?null===n:"array"===r?Array.isArray(n):"object"===r?n&&!Array.isArray(n)&&"object"==typeof n:r===typeof n)}var wi,io={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Hi(n){return(n=Math.round(n))<0?0:n>255?255:n}function Ki(n){return Hi("%"===n[n.length-1]?parseFloat(n)/100*255:parseInt(n))}function Pi(n){return(e="%"===n[n.length-1]?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function To(n,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?n+(e-n)*r*6:2*r<1?e:3*r<2?n+(e-n)*(2/3-r)*6:n}try{wi={}.parseCSSColor=function(n){var e,r=n.replace(/ /g,"").toLowerCase();if(r in io)return io[r].slice();if("#"===r[0])return 4===r.length?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===r.length&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=r.indexOf("("),u=r.indexOf(")");if(-1!==s&&u+1===r.length){var f=r.substr(0,s),_=r.substr(s+1,u-(s+1)).split(","),x=1;switch(f){case"rgba":if(4!==_.length)return null;x=Pi(_.pop());case"rgb":return 3!==_.length?null:[Ki(_[0]),Ki(_[1]),Ki(_[2]),x];case"hsla":if(4!==_.length)return null;x=Pi(_.pop());case"hsl":if(3!==_.length)return null;var C=(parseFloat(_[0])%360+360)%360/360,T=Pi(_[1]),F=Pi(_[2]),V=F<=.5?F*(T+1):F+T-F*T,j=2*F-V;return[Hi(255*To(j,V,C+1/3)),Hi(255*To(j,V,C)),Hi(255*To(j,V,C-1/3)),x];default:return null}}return null}}catch{}class Vr{constructor(e,r,s,u=1){this.r=e,this.g=r,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof Vr)return e;if("string"!=typeof e)return;const r=wi(e);return r?new Vr(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,s,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(s)},${u})`}toArray(){const{r:e,g:r,b:s,a:u}=this;return 0===u?[0,0,0,0]:[255*e/u,255*r/u,255*s/u,u]}toArray01(){const{r:e,g:r,b:s,a:u}=this;return 0===u?[0,0,0,0]:[e/u,r/u,s/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:s,a:u}=this;return[e,r,s,u]}}Vr.black=new Vr(0,0,0,1),Vr.white=new Vr(1,1,1,1),Vr.transparent=new Vr(0,0,0,0),Vr.red=new Vr(1,0,0,1),Vr.blue=new Vr(0,0,1,1);var qr=Vr;class Ji{constructor(e,r,s){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ps{constructor(e,r,s,u,f){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=s,this.fontStack=u,this.textColor=f}}class Ai{constructor(e){this.sections=e}static fromString(e){return new Ai([new ps(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Ai?e:Ai.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(s)}return e}}class So{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new So({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ks(n,e,r,s){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[n,e,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[n,e,r,s]:[n,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function as(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof qr||n instanceof Ji||n instanceof Ai||n instanceof So)return!0;if(Array.isArray(n)){for(const e of n)if(!as(e))return!1;return!0}if("object"==typeof n){for(const e in n)if(!as(n[e]))return!1;return!0}return!1}function Bi(n){if(null===n)return No;if("string"==typeof n)return Dr;if("boolean"==typeof n)return he;if("number"==typeof n)return Wn;if(n instanceof qr)return $e;if(n instanceof Ji)return Ct;if(n instanceof Ai)return kt;if(n instanceof So)return cn;if(Array.isArray(n)){const e=n.length;let r;for(const s of n){const u=Bi(s);if(r){if(r===u)continue;r=Be;break}r=u}return gn(r||Be,e)}return we}function Os(n){const e=typeof n;return null===n?"":"string"===e||"number"===e||"boolean"===e?String(n):n instanceof qr||n instanceof Ai||n instanceof So?n.toString():JSON.stringify(n)}class Ri{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(2!==e.length)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!as(e[1]))return r.error("invalid value");const s=e[1];let u=Bi(s);const f=r.expectedType;return"array"!==u.kind||0!==u.N||!f||"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(u=f),new Ri(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof qr?["rgba"].concat(this.value.toArray()):this.value instanceof Ai?this.value.serialize():this.value}}var rr=Ri,vr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Ti={string:Dr,number:Wn,boolean:he,object:we};class Io{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let s,u=1;const f=e[0];if("array"===f){let x,C;if(e.length>2){const T=e[1];if("string"!=typeof T||!(T in Ti)||"object"===T)return r.error('The item type argument of "array" must be one of string, number, boolean',1);x=Ti[T],u++}else x=Be;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);C=e[2],u++}s=gn(x,C)}else s=Ti[f];const _=[];for(;u<e.length;u++){const x=r.parse(e[u],u,Be);if(!x)return null;_.push(x)}return new Io(s,_)}evaluate(e){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(e);if(!lr(this.type,Bi(s)))return s;if(r===this.args.length-1)throw new vr(`Expected value to be of type ${un(this.type)}, but found ${un(Bi(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){r.push(s.kind);const u=e.N;("number"==typeof u||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(s=>s.serialize()))}}var zo=Io;class Si{constructor(e){this.type=kt,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return r.error("First argument must be an image or text section.");const u=[];let f=!1;for(let _=1;_<=e.length-1;++_){const x=e[_];if(f&&"object"==typeof x&&!Array.isArray(x)){f=!1;let C=null;if(x["font-scale"]&&(C=r.parse(x["font-scale"],1,Wn),!C))return null;let T=null;if(x["text-font"]&&(T=r.parse(x["text-font"],1,gn(Dr)),!T))return null;let F=null;if(x["text-color"]&&(F=r.parse(x["text-color"],1,$e),!F))return null;const V=u[u.length-1];V.scale=C,V.font=T,V.textColor=F}else{const C=r.parse(e[_],1,Be);if(!C)return null;const T=C.type.kind;if("string"!==T&&"value"!==T&&"null"!==T&&"resolvedImage"!==T)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:C,scale:null,font:null,textColor:null})}}return new Si(u)}evaluate(e){return new Ai(this.sections.map(r=>{const s=r.content.evaluate(e);return Bi(s)===cn?new ps("",s,null,null,null):new ps(Os(s),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),e.push(s)}return e}}class Ms{constructor(e){this.type=cn,this.input=e}static parse(e,r){if(2!==e.length)return r.error("Expected two arguments.");const s=r.parse(e[1],1,Dr);return s?new Ms(s):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),s=So.fromString(r);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(r)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Qi={"to-boolean":he,"to-color":$e,"to-number":Wn,"to-string":Dr};class $o{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return r.error("Expected one argument.");const u=Qi[s],f=[];for(let _=1;_<e.length;_++){const x=r.parse(e[_],_,Be);if(!x)return null;f.push(x)}return new $o(u,f)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let r,s;for(const u of this.args){if(r=u.evaluate(e),s=null,r instanceof qr)return r;if("string"==typeof r){const f=e.parseColor(r);if(f)return f}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Ks(r[0],r[1],r[2],r[3]),!s))return new qr(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new vr(s||`Could not parse color from value '${"string"==typeof r?r:String(JSON.stringify(r))}'`)}if("number"===this.type.kind){let r=null;for(const s of this.args){if(r=s.evaluate(e),null===r)return 0;const u=Number(r);if(!isNaN(u))return u}throw new vr(`Could not convert ${JSON.stringify(r)} to number.`)}return"formatted"===this.type.kind?Ai.fromString(Os(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?So.fromString(Os(this.args[0].evaluate(e))):Os(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Si([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ms(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Vo=$o;const Mr=["Unknown","Point","LineString","Polygon"];var ks=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Mr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-n[0])+this.featureDistanceData.bearing[1]*(s*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=qr.parse(n)),e}};class ls{constructor(e,r,s,u){this.name=e,this.type=r,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const s=e[0],u=ls.definitions[s];if(!u)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,_=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,x=_.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let C=null;for(const[T,F]of x){C=new Xo(r.registry,r.path,null,r.scope);const V=[];let j=!1;for(let q=1;q<e.length;q++){const J=e[q],le=Array.isArray(T)?T[q-1]:T.type,Ee=C.parse(J,1+V.length,le);if(!Ee){j=!0;break}V.push(Ee)}if(!j)if(Array.isArray(T)&&T.length!==V.length)C.error(`Expected ${T.length} arguments, but found ${V.length} instead.`);else{for(let q=0;q<V.length;q++){const J=Array.isArray(T)?T[q]:T.type,le=V[q];C.concat(q+1).checkSubtype(J,le.type)}if(0===C.errors.length)return new ls(s,f,F,V)}}if(1===x.length)r.errors.push(...C.errors);else{const T=(x.length?x:_).map(([V])=>{return j=V,Array.isArray(j)?`(${j.map(un).join(", ")})`:`(${un(j.type)}...)`;var j}).join(" | "),F=[];for(let V=1;V<e.length;V++){const j=r.parse(e[V],1+F.length);if(!j)return null;F.push(un(j.type))}r.error(`Expected arguments of type ${T}, but found (${F.join(", ")}) instead.`)}return null}static register(e,r){ls.definitions=r;for(const s in r)e[s]=ls}}var go=ls;class $i{constructor(e,r,s){this.type=Ct,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(2!==e.length)return r.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return r.error("Collator options argument must be an object.");const u=r.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,he);if(!u)return null;const f=r.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,he);if(!f)return null;let _=null;return s.locale&&(_=r.parse(s.locale,1,Dr),!_)?null:new $i(u,f,_)}evaluate(e){return new Ji(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const es=8192;function Ro(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Uo(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function jo(n,e){const r=(180+n[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(r*u*es),Math.round(s*u*es)]}function oa(n,e,r){const s=n[0]-e[0],u=n[1]-e[1],f=n[0]-r[0],_=n[1]-r[1];return s*_-f*u==0&&s*f<=0&&u*_<=0}function ms(n,e){let r=!1;for(let _=0,x=e.length;_<x;_++){const C=e[_];for(let T=0,F=C.length;T<F-1;T++){if(oa(n,C[T],C[T+1]))return!1;(u=C[T])[1]>(s=n)[1]!=(f=C[T+1])[1]>s[1]&&s[0]<(f[0]-u[0])*(s[1]-u[1])/(f[1]-u[1])+u[0]&&(r=!r)}}var s,u,f;return r}function cs(n,e){for(let r=0;r<e.length;r++)if(ms(n,e[r]))return!0;return!1}function ts(n,e,r,s){const u=s[0]-r[0],f=s[1]-r[1],_=(n[0]-r[0])*f-u*(n[1]-r[1]),x=(e[0]-r[0])*f-u*(e[1]-r[1]);return _>0&&x<0||_<0&&x>0}function ns(n,e,r){for(const T of r)for(let F=0;F<T.length-1;++F)if((x=[(_=T[F+1])[0]-(f=T[F])[0],_[1]-f[1]])[0]*(C=[(u=e)[0]-(s=n)[0],u[1]-s[1]])[1]-x[1]*C[0]!=0&&ts(s,u,f,_)&&ts(f,_,s,u))return!0;var s,u,f,_,x,C;return!1}function Qn(n,e){for(let r=0;r<n.length;++r)if(!ms(n[r],e))return!1;for(let r=0;r<n.length-1;++r)if(ns(n[r],n[r+1],e))return!1;return!0}function ka(n,e){for(let r=0;r<e.length;r++)if(Qn(n,e[r]))return!0;return!1}function As(n,e,r){const s=[];for(let u=0;u<n.length;u++){const f=[];for(let _=0;_<n[u].length;_++){const x=jo(n[u][_],r);Ro(e,x),f.push(x)}s.push(f)}return s}function va(n,e,r){const s=[];for(let u=0;u<n.length;u++){const f=As(n[u],e,r);s.push(f)}return s}function Ho(n,e,r,s){if(n[0]<r[0]||n[0]>r[2]){const u=.5*s;let f=n[0]-r[0]>u?-s:r[0]-n[0]>u?s:0;0===f&&(f=n[0]-r[2]>u?-s:r[2]-n[0]>u?s:0),n[0]+=f}Ro(e,n)}function js(n,e,r,s){const u=Math.pow(2,s.z)*es,f=[s.x*es,s.y*es],_=[];if(!n)return _;for(const x of n)for(const C of x){const T=[C.x+f[0],C.y+f[1]];Ho(T,e,r,u),_.push(T)}return _}function co(n,e,r,s){const u=Math.pow(2,s.z)*es,f=[s.x*es,s.y*es],_=[];if(!n)return _;for(const C of n){const T=[];for(const F of C){const V=[F.x+f[0],F.y+f[1]];Ro(e,V),T.push(V)}_.push(T)}if(e[2]-e[0]<=u/2){(x=e)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const C of _)for(const T of C)Ho(T,e,r,u)}var x;return _}class Mo{constructor(e,r){this.type=he,this.geojson=e,this.geometries=r}static parse(e,r){if(2!==e.length)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(as(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let u=0;u<s.features.length;++u){const f=s.features[u].geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new Mo(s,s.features[u].geometry)}else if("Feature"===s.type){const u=s.geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new Mo(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new Mo(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(r,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=r.canonicalID();if(!_)return!1;if("Polygon"===s.type){const x=As(s.coordinates,f,_),C=js(r.geometry(),u,f,_);if(!Uo(u,f))return!1;for(const T of C)if(!ms(T,x))return!1}if("MultiPolygon"===s.type){const x=va(s.coordinates,f,_),C=js(r.geometry(),u,f,_);if(!Uo(u,f))return!1;for(const T of C)if(!cs(T,x))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(r,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=r.canonicalID();if(!_)return!1;if("Polygon"===s.type){const x=As(s.coordinates,f,_),C=co(r.geometry(),u,f,_);if(!Uo(u,f))return!1;for(const T of C)if(!Qn(T,x))return!1}if("MultiPolygon"===s.type){const x=va(s.coordinates,f,_),C=co(r.geometry(),u,f,_);if(!Uo(u,f))return!1;for(const T of C)if(!ka(T,x))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var oo=Mo;function xa(n){if(n instanceof go&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof oo)return!1;let e=!0;return n.eachChild(r=>{e&&!xa(r)&&(e=!1)}),e}function Fi(n){if(n instanceof go&&"feature-state"===n.name)return!1;let e=!0;return n.eachChild(r=>{e&&!Fi(r)&&(e=!1)}),e}function Wi(n,e){if(n instanceof go&&e.indexOf(n.name)>=0)return!1;let r=!0;return n.eachChild(s=>{r&&!Wi(s,e)&&(r=!1)}),r}class Hs{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(2!==e.length||"string"!=typeof e[1])return r.error("'var' expression requires exactly one string literal argument.");const s=e[1];return r.scope.has(s)?new Hs(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var gs=Hs;class us{constructor(e,r=[],s,u=new Po,f=[]){this.registry=e,this.path=r,this.key=r.map(_=>`[${_}]`).join(""),this.scope=u,this.errors=f,this.expectedType=s}parse(e,r,s,u,f={}){return r?this.concat(r,s,u)._parse(e,f):this._parse(e,f)}_parse(e,r){function s(u,f,_){return"assert"===_?new zo(f,[u]):"coerce"===_?new Vo(f,[u]):u}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if("string"!=typeof u)return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let _=f.parse(e,this);if(!_)return null;if(this.expectedType){const x=this.expectedType,C=_.type;if("string"!==x.kind&&"number"!==x.kind&&"boolean"!==x.kind&&"object"!==x.kind&&"array"!==x.kind||"value"!==C.kind)if("color"!==x.kind&&"formatted"!==x.kind&&"resolvedImage"!==x.kind||"value"!==C.kind&&"string"!==C.kind){if(this.checkSubtype(x,C))return null}else _=s(_,x,r.typeAnnotation||"coerce");else _=s(_,x,r.typeAnnotation||"assert")}if(!(_ instanceof rr)&&"resolvedImage"!==_.type.kind&&sa(_)){const x=new ks;try{_=new rr(_.type,_.evaluate(x))}catch(C){return this.error(C.message),null}}return _}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,s){const u="number"==typeof e?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new us(this.registry,u,r||null,f,this.errors)}error(e,...r){const s=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new zi(s,e))}checkSubtype(e,r){const s=lr(e,r);return s&&this.error(s),s}}var Xo=us;function sa(n){if(n instanceof gs)return sa(n.boundExpression);if(n instanceof go&&"error"===n.name||n instanceof $i||n instanceof oo)return!1;const e=n instanceof Vo||n instanceof zo;let r=!0;return n.eachChild(s=>{r=e?r&&sa(s):r&&s instanceof rr}),!!r&&xa(n)&&Wi(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ba(n,e){const r=n.length-1;let s,u,f=0,_=r,x=0;for(;f<=_;)if(x=Math.floor((f+_)/2),s=n[x],u=n[x+1],s<=e){if(x===r||e<u)return x;f=x+1}else{if(!(s>e))throw new vr("Input is not a number.");_=x-1}return 0}class Js{constructor(e,r,s){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[u,f]of s)this.labels.push(u),this.outputs.push(f)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(e[1],1,Wn);if(!s)return null;const u=[];let f=null;r.expectedType&&"value"!==r.expectedType.kind&&(f=r.expectedType);for(let _=1;_<e.length;_+=2){const x=1===_?-1/0:e[_],C=e[_+1],T=_,F=_+1;if("number"!=typeof x)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(u.length&&u[u.length-1][0]>=x)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const V=r.parse(C,F,f);if(!V)return null;f=f||V.type,u.push([x,V])}return new Js(f,s,u)}evaluate(e){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);const f=r.length;return u>=r[f-1]?s[f-1].evaluate(e):s[ba(r,u)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var P=Js;function K(n,e,r){return n*(1-r)+e*r}var R=Object.freeze({__proto__:null,array:function(n,e,r){return n.map((s,u)=>K(s,e[u],r))},color:function(n,e,r){return new qr(K(n.r,e.r,r),K(n.g,e.g,r),K(n.b,e.b,r),K(n.a,e.a,r))},number:K});const En=4/29,ar=6/29,ir=3*ar*ar,Oi=ar*ar*ar,so=Math.PI/180,ee=180/Math.PI;function Y(n){return n>Oi?Math.pow(n,1/3):n/ir+En}function Me(n){return n>ar?n*n*n:ir*(n-En)}function re(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function We(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function zn(n){const e=We(n.r),r=We(n.g),s=We(n.b),u=Y((.4124564*e+.3575761*r+.1804375*s)/.95047),f=Y((.2126729*e+.7151522*r+.072175*s)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-Y((.0193339*e+.119192*r+.9503041*s)/1.08883)),alpha:n.a}}function zr(n){let e=(n.l+16)/116,r=isNaN(n.a)?e:e+n.a/500,s=isNaN(n.b)?e:e-n.b/200;return e=1*Me(e),r=.95047*Me(r),s=1.08883*Me(s),new qr(re(3.2404542*r-1.5371385*e-.4985314*s),re(-.969266*r+1.8760108*e+.041556*s),re(.0556434*r-.2040259*e+1.0572252*s),n.alpha)}function Oo(n,e,r){const s=e-n;return n+r*(s>180||s<-180?s-360*Math.round(s/360):s)}const rs={forward:zn,reverse:zr,interpolate:function(n,e,r){return{l:K(n.l,e.l,r),a:K(n.a,e.a,r),b:K(n.b,e.b,r),alpha:K(n.alpha,e.alpha,r)}}},is={forward:function(n){const{l:e,a:r,b:s}=zn(n),u=Math.atan2(s,r)*ee;return{h:u<0?u+360:u,c:Math.sqrt(r*r+s*s),l:e,alpha:n.a}},reverse:function(n){const e=n.h*so,r=n.c;return zr({l:n.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:n.alpha})},interpolate:function(n,e,r){return{h:Oo(n.h,e.h,r),c:K(n.c,e.c,r),l:K(n.l,e.l,r),alpha:K(n.alpha,e.alpha,r)}}};var Ko=Object.freeze({__proto__:null,hcl:is,lab:rs});class Ds{constructor(e,r,s,u,f){this.type=e,this.operator=r,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[_,x]of f)this.labels.push(_),this.outputs.push(x)}static interpolationFactor(e,r,s,u){let f=0;if("exponential"===e.name)f=La(r,e.base,s,u);else if("linear"===e.name)f=La(r,1,s,u);else if("cubic-bezier"===e.name){const _=e.controlPoints;f=new Ot(_[0],_[1],_[2],_[3]).solve(La(r,1,s,u))}return f}static parse(e,r){let[s,u,f,..._]=e;if(!Array.isArray(u)||0===u.length)return r.error("Expected an interpolation type expression.",1);if("linear"===u[0])u={name:"linear"};else if("exponential"===u[0]){const T=u[1];if("number"!=typeof T)return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:T}}else{if("cubic-bezier"!==u[0])return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const T=u.slice(1);if(4!==T.length||T.some(F=>"number"!=typeof F||F<0||F>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(f=r.parse(f,2,Wn),!f)return null;const x=[];let C=null;"interpolate-hcl"===s||"interpolate-lab"===s?C=$e:r.expectedType&&"value"!==r.expectedType.kind&&(C=r.expectedType);for(let T=0;T<_.length;T+=2){const F=_[T],V=_[T+1],j=T+3,q=T+4;if("number"!=typeof F)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(x.length&&x[x.length-1][0]>=F)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const J=r.parse(V,q,C);if(!J)return null;C=C||J.type,x.push([F,J])}return"number"===C.kind||"color"===C.kind||"array"===C.kind&&"number"===C.itemType.kind&&"number"==typeof C.N?new Ds(C,s,u,f,x):r.error(`Type ${un(C)} is not interpolatable.`)}evaluate(e){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);const f=r.length;if(u>=r[f-1])return s[f-1].evaluate(e);const _=ba(r,u),x=Ds.interpolationFactor(this.interpolation,u,r[_],r[_+1]),C=s[_].evaluate(e),T=s[_+1].evaluate(e);return"interpolate"===this.operator?R[this.type.kind.toLowerCase()](C,T,x):"interpolate-hcl"===this.operator?is.reverse(is.interpolate(is.forward(C),is.forward(T),x)):rs.reverse(rs.interpolate(rs.forward(C),rs.forward(T),x))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r}}function La(n,e,r,s){const u=s-r,f=n-r;return 0===u?0:1===e?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var Jo=Ds;class il{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let s=null;const u=r.expectedType;u&&"value"!==u.kind&&(s=u);const f=[];for(const x of e.slice(1)){const C=r.parse(x,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!C)return null;s=s||C.type,f.push(C)}const _=u&&f.some(x=>lr(u,x.type));return new il(_?Be:s,f)}evaluate(e){let r,s=null,u=0;for(const f of this.args){if(u++,s=f.evaluate(e),s&&s instanceof So&&!s.available&&(r||(r=s),s=null,u===this.args.length))return r;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Vl=il;class wa{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const _=e[f];if("string"!=typeof _)return r.error(`Expected string, but found ${typeof _} instead.`,f);if(/[^a-zA-Z0-9_]/.test(_))return r.error("Variable names must contain only alphanumeric characters or '_'.",f);const x=r.parse(e[f+1],f+1);if(!x)return null;s.push([_,x])}const u=r.parse(e[e.length-1],e.length-1,r.expectedType,s);return u?new wa(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,s]of this.bindings)e.push(r,s.serialize());return e.push(this.result.serialize()),e}}var xl=wa;class Fa{constructor(e,r,s){this.type=e,this.index=r,this.input=s}static parse(e,r){if(3!==e.length)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Wn),u=r.parse(e[2],2,gn(r.expectedType||Be));return s&&u?new Fa(u.type.itemType,s,u):null}evaluate(e){const r=this.index.evaluate(e),s=this.input.evaluate(e);if(r<0)throw new vr(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new vr(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new vr(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Ul=Fa;class Ls{constructor(e,r){this.type=he,this.needle=e,this.haystack=r}static parse(e,r){if(3!==e.length)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Be),u=r.parse(e[2],2,Be);return s&&u?Cr(s.type,[he,Dr,Wn,No,Be])?new Ls(s,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${un(s.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!kr(r,["boolean","string","number","null"]))throw new vr(`Expected first argument to be of type boolean, string, number or null, but found ${un(Bi(r))} instead.`);if(!kr(s,["string","array"]))throw new vr(`Expected second argument to be of type array or string, but found ${un(Bi(s))} instead.`);return s.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Gs=Ls;class uo{constructor(e,r,s){this.type=Wn,this.needle=e,this.haystack=r,this.fromIndex=s}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Be),u=r.parse(e[2],2,Be);if(!s||!u)return null;if(!Cr(s.type,[he,Dr,Wn,No,Be]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${un(s.type)} instead`);if(4===e.length){const f=r.parse(e[3],3,Wn);return f?new uo(s,u,f):null}return new uo(s,u)}evaluate(e){const r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!kr(r,["boolean","string","number","null"]))throw new vr(`Expected first argument to be of type boolean, string, number or null, but found ${un(Bi(r))} instead.`);if(!kr(s,["string","array"]))throw new vr(`Expected second argument to be of type array or string, but found ${un(Bi(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return s.indexOf(r,u)}return s.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Fs=uo;class bl{constructor(e,r,s,u,f,_){this.inputType=e,this.type=r,this.input=s,this.cases=u,this.outputs=f,this.otherwise=_}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let s,u;r.expectedType&&"value"!==r.expectedType.kind&&(u=r.expectedType);const f={},_=[];for(let T=2;T<e.length-1;T+=2){let F=e[T];const V=e[T+1];Array.isArray(F)||(F=[F]);const j=r.concat(T);if(0===F.length)return j.error("Expected at least one branch label.");for(const J of F){if("number"!=typeof J&&"string"!=typeof J)return j.error("Branch labels must be numbers or strings.");if("number"==typeof J&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof J&&Math.floor(J)!==J)return j.error("Numeric branch labels must be integer values.");if(s){if(j.checkSubtype(s,Bi(J)))return null}else s=Bi(J);if(void 0!==f[String(J)])return j.error("Branch labels must be unique.");f[String(J)]=_.length}const q=r.parse(V,T,u);if(!q)return null;u=u||q.type,_.push(q)}const x=r.parse(e[1],1,Be);if(!x)return null;const C=r.parse(e[e.length-1],e.length-1,u);return C?"value"!==x.type.kind&&r.concat(1).checkSubtype(s,x.type)?null:new bl(s,u,x,f,_,C):null}evaluate(e){const r=this.input.evaluate(e);return(Bi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),s=[],u={};for(const _ of r){const x=u[this.cases[_]];void 0===x?(u[this.cases[_]]=s.length,s.push([this.cases[_],[_]])):s[x][1].push(_)}const f=_=>"number"===this.inputType.kind?Number(_):_;for(const[_,x]of s)e.push(1===x.length?f(x[0]):x.map(f)),e.push(this.outputs[_].serialize());return e.push(this.otherwise.serialize()),e}}var jl=bl;class ol{constructor(e,r,s){this.type=e,this.branches=r,this.otherwise=s}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&"value"!==r.expectedType.kind&&(s=r.expectedType);const u=[];for(let _=1;_<e.length-1;_+=2){const x=r.parse(e[_],_,he);if(!x)return null;const C=r.parse(e[_+1],_+1,s);if(!C)return null;u.push([x,C]),s=s||C.type}const f=r.parse(e[e.length-1],e.length-1,s);return f?new ol(s,u,f):null}evaluate(e){for(const[r,s]of this.branches)if(r.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,s]of this.branches)e(r),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var sl=ol;class al{constructor(e,r,s,u){this.type=e,this.input=r,this.beginIndex=s,this.endIndex=u}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=r.parse(e[1],1,Be),u=r.parse(e[2],2,Wn);if(!s||!u)return null;if(!Cr(s.type,[gn(Be),Dr,Be]))return r.error(`Expected first argument to be of type array or string, but found ${un(s.type)} instead`);if(4===e.length){const f=r.parse(e[3],3,Wn);return f?new al(s.type,s,u,f):null}return new al(s.type,s,u)}evaluate(e){const r=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!kr(r,["string","array"]))throw new vr(`Expected first argument to be of type array or string, but found ${un(Bi(r))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return r.slice(s,u)}return r.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var dc=al;function fa(n,e){return"=="===n||"!="===n?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ws(n,e,r,s){return 0===s.compare(e,r)}function ll(n,e,r){const s="=="!==n&&"!="!==n;return class qb{constructor(f,_,x){this.type=he,this.lhs=f,this.rhs=_,this.collator=x,this.hasUntypedArgument="value"===f.type.kind||"value"===_.type.kind}static parse(f,_){if(3!==f.length&&4!==f.length)return _.error("Expected two or three arguments.");const x=f[0];let C=_.parse(f[1],1,Be);if(!C)return null;if(!fa(x,C.type))return _.concat(1).error(`"${x}" comparisons are not supported for type '${un(C.type)}'.`);let T=_.parse(f[2],2,Be);if(!T)return null;if(!fa(x,T.type))return _.concat(2).error(`"${x}" comparisons are not supported for type '${un(T.type)}'.`);if(C.type.kind!==T.type.kind&&"value"!==C.type.kind&&"value"!==T.type.kind)return _.error(`Cannot compare types '${un(C.type)}' and '${un(T.type)}'.`);s&&("value"===C.type.kind&&"value"!==T.type.kind?C=new zo(T.type,[C]):"value"!==C.type.kind&&"value"===T.type.kind&&(T=new zo(C.type,[T])));let F=null;if(4===f.length){if("string"!==C.type.kind&&"string"!==T.type.kind&&"value"!==C.type.kind&&"value"!==T.type.kind)return _.error("Cannot use collator to compare non-string types.");if(F=_.parse(f[3],3,Ct),!F)return null}return new qb(C,T,F)}evaluate(f){const _=this.lhs.evaluate(f),x=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const C=Bi(_),T=Bi(x);if(C.kind!==T.kind||"string"!==C.kind&&"number"!==C.kind)throw new vr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${C.kind}, ${T.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const C=Bi(_),T=Bi(x);if("string"!==C.kind||"string"!==T.kind)return e(f,_,x)}return this.collator?r(f,_,x,this.collator.evaluate(f)):e(f,_,x)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[n];return this.eachChild(_=>{f.push(_.serialize())}),f}}}const qa=ll("==",function(n,e,r){return e===r},Ws),hc=ll("!=",function(n,e,r){return e!==r},function(n,e,r,s){return!Ws(0,e,r,s)}),Ic=ll("<",function(n,e,r){return e<r},function(n,e,r,s){return s.compare(e,r)<0}),Mc=ll(">",function(n,e,r){return e>r},function(n,e,r,s){return s.compare(e,r)>0}),fc=ll("<=",function(n,e,r){return e<=r},function(n,e,r,s){return s.compare(e,r)<=0}),Hl=ll(">=",function(n,e,r){return e>=r},function(n,e,r,s){return s.compare(e,r)>=0});class Ea{constructor(e,r,s,u,f,_){this.type=Dr,this.number=e,this.locale=r,this.currency=s,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(e,r){if(3!==e.length)return r.error("Expected two arguments.");const s=r.parse(e[1],1,Wn);if(!s)return null;const u=e[2];if("object"!=typeof u||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=r.parse(u.locale,1,Dr),!f))return null;let _=null;if(u.currency&&(_=r.parse(u.currency,1,Dr),!_))return null;let x=null;if(u.unit&&(x=r.parse(u.unit,1,Dr),!x))return null;let C=null;if(u["min-fraction-digits"]&&(C=r.parse(u["min-fraction-digits"],1,Wn),!C))return null;let T=null;return u["max-fraction-digits"]&&(T=r.parse(u["max-fraction-digits"],1,Wn),!T)?null:new Ea(s,f,_,x,C,T)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Qs{constructor(e){this.type=Wn,this.input=e}static parse(e,r){if(2!==e.length)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=r.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?r.error(`Expected argument of type string or array, but found ${un(s.type)} instead.`):new Qs(s):null}evaluate(e){const r=this.input.evaluate(e);if("string"==typeof r||Array.isArray(r))return r.length;throw new vr(`Expected value to be of type string or array, but found ${un(Bi(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const Ba={"==":qa,"!=":hc,">":Mc,"<":Ic,">=":Hl,"<=":fc,array:zo,at:Ul,boolean:zo,case:sl,coalesce:Vl,collator:$i,format:Si,image:Ms,in:Gs,"index-of":Fs,interpolate:Jo,"interpolate-hcl":Jo,"interpolate-lab":Jo,length:Qs,let:xl,literal:rr,match:jl,number:zo,"number-format":Ea,object:zo,slice:dc,step:P,string:zo,"to-boolean":Vo,"to-color":Vo,"to-number":Vo,"to-string":Vo,var:gs,within:oo};function Na(n,[e,r,s,u]){e=e.evaluate(n),r=r.evaluate(n),s=s.evaluate(n);const f=u?u.evaluate(n):1,_=Ks(e,r,s,f);if(_)throw new vr(_);return new qr(e/255*f,r/255*f,s/255*f,f)}function Qo(n,e){return n in e}function ea(n,e){const r=e[n];return void 0===r?null:r}function B(n){return{type:n}}go.register(Ba,{error:[{kind:"error"},[Dr],(n,[e])=>{throw new vr(e.evaluate(n))}],typeof:[Dr,[Be],(n,[e])=>un(Bi(e.evaluate(n)))],"to-rgba":[gn(Wn,4),[$e],(n,[e])=>e.evaluate(n).toArray()],rgb:[$e,[Wn,Wn,Wn],Na],rgba:[$e,[Wn,Wn,Wn,Wn],Na],has:{type:he,overloads:[[[Dr],(n,[e])=>Qo(e.evaluate(n),n.properties())],[[Dr,we],(n,[e,r])=>Qo(e.evaluate(n),r.evaluate(n))]]},get:{type:Be,overloads:[[[Dr],(n,[e])=>ea(e.evaluate(n),n.properties())],[[Dr,we],(n,[e,r])=>ea(e.evaluate(n),r.evaluate(n))]]},"feature-state":[Be,[Dr],(n,[e])=>ea(e.evaluate(n),n.featureState||{})],properties:[we,[],n=>n.properties()],"geometry-type":[Dr,[],n=>n.geometryType()],id:[Be,[],n=>n.id()],zoom:[Wn,[],n=>n.globals.zoom],pitch:[Wn,[],n=>n.globals.pitch||0],"distance-from-center":[Wn,[],n=>n.distanceFromCenter()],"heatmap-density":[Wn,[],n=>n.globals.heatmapDensity||0],"line-progress":[Wn,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Wn,[],n=>n.globals.skyRadialProgress||0],accumulated:[Be,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[Wn,B(Wn),(n,e)=>{let r=0;for(const s of e)r+=s.evaluate(n);return r}],"*":[Wn,B(Wn),(n,e)=>{let r=1;for(const s of e)r*=s.evaluate(n);return r}],"-":{type:Wn,overloads:[[[Wn,Wn],(n,[e,r])=>e.evaluate(n)-r.evaluate(n)],[[Wn],(n,[e])=>-e.evaluate(n)]]},"/":[Wn,[Wn,Wn],(n,[e,r])=>e.evaluate(n)/r.evaluate(n)],"%":[Wn,[Wn,Wn],(n,[e,r])=>e.evaluate(n)%r.evaluate(n)],ln2:[Wn,[],()=>Math.LN2],pi:[Wn,[],()=>Math.PI],e:[Wn,[],()=>Math.E],"^":[Wn,[Wn,Wn],(n,[e,r])=>Math.pow(e.evaluate(n),r.evaluate(n))],sqrt:[Wn,[Wn],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Wn,[Wn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Wn,[Wn],(n,[e])=>Math.log(e.evaluate(n))],log2:[Wn,[Wn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Wn,[Wn],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Wn,[Wn],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Wn,[Wn],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Wn,[Wn],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Wn,[Wn],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Wn,[Wn],(n,[e])=>Math.atan(e.evaluate(n))],min:[Wn,B(Wn),(n,e)=>Math.min(...e.map(r=>r.evaluate(n)))],max:[Wn,B(Wn),(n,e)=>Math.max(...e.map(r=>r.evaluate(n)))],abs:[Wn,[Wn],(n,[e])=>Math.abs(e.evaluate(n))],round:[Wn,[Wn],(n,[e])=>{const r=e.evaluate(n);return r<0?-Math.round(-r):Math.round(r)}],floor:[Wn,[Wn],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Wn,[Wn],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[he,[Dr,Be],(n,[e,r])=>n.properties()[e.value]===r.value],"filter-id-==":[he,[Be],(n,[e])=>n.id()===e.value],"filter-type-==":[he,[Dr],(n,[e])=>n.geometryType()===e.value],"filter-<":[he,[Dr,Be],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s<u}],"filter-id-<":[he,[Be],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r<s}],"filter->":[he,[Dr,Be],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s>u}],"filter-id->":[he,[Be],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r>s}],"filter-<=":[he,[Dr,Be],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[he,[Be],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r<=s}],"filter->=":[he,[Dr,Be],(n,[e,r])=>{const s=n.properties()[e.value],u=r.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[he,[Be],(n,[e])=>{const r=n.id(),s=e.value;return typeof r==typeof s&&r>=s}],"filter-has":[he,[Be],(n,[e])=>e.value in n.properties()],"filter-has-id":[he,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[he,[gn(Dr)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[he,[gn(Be)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[he,[Dr,gn(Be)],(n,[e,r])=>r.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[he,[Dr,gn(Be)],(n,[e,r])=>function(s,u,f,_){for(;f<=_;){const x=f+_>>1;if(u[x]===s)return!0;u[x]>s?_=x-1:f=x+1}return!1}(n.properties()[e.value],r.value,0,r.value.length-1)],all:{type:he,overloads:[[[he,he],(n,[e,r])=>e.evaluate(n)&&r.evaluate(n)],[B(he),(n,e)=>{for(const r of e)if(!r.evaluate(n))return!1;return!0}]]},any:{type:he,overloads:[[[he,he],(n,[e,r])=>e.evaluate(n)||r.evaluate(n)],[B(he),(n,e)=>{for(const r of e)if(r.evaluate(n))return!0;return!1}]]},"!":[he,[he],(n,[e])=>!e.evaluate(n)],"is-supported-script":[he,[Dr],(n,[e])=>{const r=n.globals&&n.globals.isSupportedScript;return!r||r(e.evaluate(n))}],upcase:[Dr,[Dr],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Dr,[Dr],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Dr,B(Be),(n,e)=>e.map(r=>Os(r.evaluate(n))).join("")],"resolved-locale":[Dr,[Ct],(n,[e])=>e.evaluate(n).resolvedLocale()]});var Q=Ba;function qe(n){return{result:"success",value:n}}function Z(n){return{result:"error",value:n}}function Re(n){return"data-driven"===n["property-type"]}function vt(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function vn(n){return!!n.expression&&n.expression.interpolated}function Sn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}function Er(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}function vi(n){return n}function xi(n,e){const r="color"===e.type,s=n.stops&&"object"==typeof n.stops[0][0],u=s||!(s||void 0!==n.property),f=n.type||(vn(e)?"exponential":"interval");if(r&&((n=ro({},n)).stops&&(n.stops=n.stops.map(T=>[T[0],qr.parse(T[1])])),n.default=qr.parse(n.default?n.default:e.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!Ko[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let _,x,C;if("exponential"===f)_=ki;else if("interval"===f)_=Ei;else if("categorical"===f){_=eo,x=Object.create(null);for(const T of n.stops)x[T[0]]=T[1];C=typeof n.stops[0][0]}else{if("identity"!==f)throw new Error(`Unknown function type "${f}"`);_=ko}if(s){const T={},F=[];for(let q=0;q<n.stops.length;q++){const J=n.stops[q],le=J[0].zoom;void 0===T[le]&&(T[le]={zoom:le,type:n.type,property:n.property,default:n.default,stops:[]},F.push(le)),T[le].stops.push([J[0].value,J[1]])}const V=[];for(const q of F)V.push([T[q].zoom,xi(T[q],e)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Jo.interpolationFactor.bind(void 0,j),zoomStops:V.map(q=>q[0]),evaluate:({zoom:q},J)=>ki({stops:V,base:n.base},e,q).evaluate(q,J)}}if(u){const T="exponential"===f?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Jo.interpolationFactor.bind(void 0,T),zoomStops:n.stops.map(F=>F[0]),evaluate:({zoom:F})=>_(n,e,F,x,C)}}return{kind:"source",evaluate(T,F){const V=F&&F.properties?F.properties[n.property]:void 0;return void 0===V?Br(n.default,e.default):_(n,e,V,x,C)}}}function Br(n,e,r){return void 0!==n?n:void 0!==e?e:void 0!==r?r:void 0}function eo(n,e,r,s,u){return Br(typeof r===u?s[r]:void 0,n.default,e.default)}function Ei(n,e,r){if("number"!==Sn(r))return Br(n.default,e.default);const s=n.stops.length;if(1===s||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[s-1][0])return n.stops[s-1][1];const u=ba(n.stops.map(f=>f[0]),r);return n.stops[u][1]}function ki(n,e,r){const s=void 0!==n.base?n.base:1;if("number"!==Sn(r))return Br(n.default,e.default);const u=n.stops.length;if(1===u||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[u-1][0])return n.stops[u-1][1];const f=ba(n.stops.map(F=>F[0]),r),_=function(F,V,j,q){const J=q-j,le=F-j;return 0===J?0:1===V?le/J:(Math.pow(V,le)-1)/(Math.pow(V,J)-1)}(r,s,n.stops[f][0],n.stops[f+1][0]),x=n.stops[f][1],C=n.stops[f+1][1];let T=R[e.type]||vi;if(n.colorSpace&&"rgb"!==n.colorSpace){const F=Ko[n.colorSpace];T=(V,j)=>F.reverse(F.interpolate(F.forward(V),F.forward(j),_))}return"function"==typeof x.evaluate?{evaluate(...F){const V=x.evaluate.apply(void 0,F),j=C.evaluate.apply(void 0,F);if(void 0!==V&&void 0!==j)return T(V,j,_)}}:T(x,C,_)}function ko(n,e,r){return"color"===e.type?r=qr.parse(r):"formatted"===e.type?r=Ai.fromString(r.toString()):"resolvedImage"===e.type?r=So.fromString(r.toString()):Sn(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Br(r,n.default,e.default)}class Ps{constructor(e,r){var s;this.expression=e,this._warningHistory={},this._evaluator=new ks,this._defaultValue=r?"color"===(s=r).type&&(Er(s.default)||Array.isArray(s.default))?new qr(0,0,0,0):"color"===s.type?qr.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=r&&"enum"===r.type?r.values:null}evaluateWithoutErrorHandling(e,r,s,u,f,_,x,C){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,s,u,f,_,x,C){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=C||null;try{const T=this.expression.evaluate(this._evaluator);if(null==T||"number"==typeof T&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new vr(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function ta(n){return Array.isArray(n)&&n.length>0&&"string"==typeof n[0]&&n[0]in Q}function qi(n,e){const r=new Xo(Q,[],e?function(u){const f={color:$e,string:Dr,number:Wn,enum:Dr,boolean:he,formatted:kt,resolvedImage:cn};return"array"===u.type?gn(f[u.value]||Be,u.length):f[u.type]}(e):void 0),s=r.parse(n,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?qe(new Ps(s,e)):Z(r.errors)}class _s{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent="constant"!==e&&!Fi(r.expression)}evaluateWithoutErrorHandling(e,r,s,u,f,_){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,f,_)}evaluate(e,r,s,u,f,_){return this._styleExpression.evaluate(e,r,s,u,f,_)}}class Cs{constructor(e,r,s,u){this.kind=e,this.zoomStops=s,this._styleExpression=r,this.isStateDependent="camera"!==e&&!Fi(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,r,s,u,f,_){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,f,_)}evaluate(e,r,s,u,f,_){return this._styleExpression.evaluate(e,r,s,u,f,_)}interpolationFactor(e,r,s){return this.interpolationType?Jo.interpolationFactor(this.interpolationType,e,r,s):0}}function aa(n,e){if("error"===(n=qi(n,e)).result)return n;const r=n.value.expression,s=xa(r);if(!s&&!Re(e))return Z([new zi("","data expressions not supported")]);const u=Wi(r,["zoom","pitch","distance-from-center"]);if(!u&&!vt(e))return Z([new zi("","zoom expressions not supported")]);const f=cl(r);return f||u?f instanceof zi?Z([f]):f instanceof Jo&&!vn(e)?Z([new zi("",'"interpolate" expressions cannot be used with this property')]):qe(f?new Cs(s?"camera":"composite",n.value,f.labels,f instanceof Jo?f.interpolation:void 0):new _s(s?"constant":"source",n.value)):Z([new zi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Gl{constructor(e,r){this._parameters=e,this._specification=r,ro(this,xi(this._parameters,this._specification))}static deserialize(e){return new Gl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function cl(n){let e=null;if(n instanceof xl)e=cl(n.result);else if(n instanceof Vl){for(const r of n.args)if(e=cl(r),e)break}else(n instanceof P||n instanceof Jo)&&n.input instanceof go&&"zoom"===n.input.name&&(e=n);return e instanceof zi||n.eachChild(r=>{const s=cl(r);s instanceof zi?e=s:!e&&s?e=new zi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new zi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class or{constructor(e,r,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),null!=r&&r.__line__&&(this.line=r.__line__)}}function la(n){const e=n.key,r=n.value,s=n.valueSpec||{},u=n.objectElementValidators||{},f=n.style,_=n.styleSpec;let x=[];const C=Sn(r);if("object"!==C)return[new or(e,r,`object expected, ${C} found`)];for(const T in r){const F=T.split(".")[0];let V;u[F]?V=u[F]:s[F]?V=Ss:u["*"]?V=u["*"]:s["*"]&&(V=Ss),V?x=x.concat(V({key:(e&&`${e}.`)+T,value:r[T],valueSpec:s[F]||s["*"],style:f,styleSpec:_,object:r,objectKey:T},r)):x.push(new or(e,r[T],`unknown property "${T}"`))}for(const T in s)u[T]||s[T].required&&void 0===s[T].default&&void 0===r[T]&&x.push(new or(e,r,`missing required property "${T}"`));return x}function ei(n){const e=n.value,r=n.valueSpec,s=n.style,u=n.styleSpec,f=n.key,_=n.arrayElementValidator||Ss;if("array"!==Sn(e))return[new or(f,e,`array expected, ${Sn(e)} found`)];if(r.length&&e.length!==r.length)return[new or(f,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new or(f,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let x={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};u.$version<7&&(x.function=r.function),"object"===Sn(r.value)&&(x=r.value);let C=[];for(let T=0;T<e.length;T++)C=C.concat(_({array:e,arrayIndex:T,value:e[T],valueSpec:x,style:s,styleSpec:u,key:`${f}[${T}]`}));return C}function Za(n){const e=n.key,r=n.value,s=n.valueSpec;let u=Sn(r);if("number"===u&&r!=r&&(u="NaN"),"number"!==u)return[new or(e,r,`number expected, ${u} found`)];if("minimum"in s){let f=s.minimum;if("array"===Sn(s.minimum)&&(f=s.minimum[n.arrayIndex]),r<f)return[new or(e,r,`${r} is less than the minimum value ${f}`)]}if("maximum"in s){let f=s.maximum;if("array"===Sn(s.maximum)&&(f=s.maximum[n.arrayIndex]),r>f)return[new or(e,r,`${r} is greater than the maximum value ${f}`)]}return[]}function wl(n){const e=n.valueSpec,r=bi(n.value.type);let s,u,f,_={};const x="categorical"!==r&&void 0===n.value.property,C=!x,T="array"===Sn(n.value.stops)&&"array"===Sn(n.value.stops[0])&&"object"===Sn(n.value.stops[0][0]),F=la({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(q){if("identity"===r)return[new or(q.key,q.value,'identity function may not have a "stops" property')];let J=[];const le=q.value;return J=J.concat(ei({key:q.key,value:le,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:V})),"array"===Sn(le)&&0===le.length&&J.push(new or(q.key,le,"array must have at least one stop")),J},default:function(q){return Ss({key:q.key,value:q.value,valueSpec:e,style:q.style,styleSpec:q.styleSpec})}}});return"identity"===r&&x&&F.push(new or(n.key,n.value,'missing required property "property"')),"identity"===r||n.value.stops||F.push(new or(n.key,n.value,'missing required property "stops"')),"exponential"===r&&n.valueSpec.expression&&!vn(n.valueSpec)&&F.push(new or(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(C&&!Re(n.valueSpec)?F.push(new or(n.key,n.value,"property functions not supported")):x&&!vt(n.valueSpec)&&F.push(new or(n.key,n.value,"zoom functions not supported"))),"categorical"!==r&&!T||void 0!==n.value.property||F.push(new or(n.key,n.value,'"property" property is required')),F;function V(q){let J=[];const le=q.value,Ee=q.key;if("array"!==Sn(le))return[new or(Ee,le,`array expected, ${Sn(le)} found`)];if(2!==le.length)return[new or(Ee,le,`array length 2 expected, length ${le.length} found`)];if(T){if("object"!==Sn(le[0]))return[new or(Ee,le,`object expected, ${Sn(le[0])} found`)];if(void 0===le[0].zoom)return[new or(Ee,le,"object stop key must have zoom")];if(void 0===le[0].value)return[new or(Ee,le,"object stop key must have value")];const Ue=bi(le[0].zoom);if("number"!=typeof Ue)return[new or(Ee,le[0].zoom,"stop zoom values must be numbers")];if(f&&f>Ue)return[new or(Ee,le[0].zoom,"stop zoom values must appear in ascending order")];Ue!==f&&(f=Ue,u=void 0,_={}),J=J.concat(la({key:`${Ee}[0]`,value:le[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:Za,value:j}}))}else J=J.concat(j({key:`${Ee}[0]`,value:le[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},le));return ta(ii(le[1]))?J.concat([new or(`${Ee}[1]`,le[1],"expressions are not allowed in function stops.")]):J.concat(Ss({key:`${Ee}[1]`,value:le[1],valueSpec:e,style:q.style,styleSpec:q.styleSpec}))}function j(q,J){const le=Sn(q.value),Ee=bi(q.value),Ue=null!==q.value?q.value:J;if(s){if(le!==s)return[new or(q.key,Ue,`${le} stop domain type must match previous stop domain type ${s}`)]}else s=le;if("number"!==le&&"string"!==le&&"boolean"!==le&&"number"!=typeof Ee&&"string"!=typeof Ee&&"boolean"!=typeof Ee)return[new or(q.key,Ue,"stop domain value must be a number, string, or boolean")];if("number"!==le&&"categorical"!==r){let rt=`number expected, ${le} found`;return Re(e)&&void 0===r&&(rt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new or(q.key,Ue,rt)]}return"categorical"!==r||"number"!==le||"number"==typeof Ee&&isFinite(Ee)&&Math.floor(Ee)===Ee?"categorical"!==r&&"number"===le&&"number"==typeof Ee&&"number"==typeof u&&void 0!==u&&Ee<u?[new or(q.key,Ue,"stop domain values must appear in ascending order")]:(u=Ee,"categorical"===r&&Ee in _?[new or(q.key,Ue,"stop domain values must be unique")]:(_[Ee]=!0,[])):[new or(q.key,Ue,`integer expected, found ${String(Ee)}`)]}}function ys(n){const e=("property"===n.expressionContext?aa:qi)(ii(n.value),n.valueSpec);if("error"===e.result)return e.value.map(s=>new or(`${n.key}${s.key}`,n.value,s.message));const r=e.value.expression||e.value._styleExpression.expression;if("property"===n.expressionContext&&"text-font"===n.propertyKey&&!r.outputDefined())return[new or(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===n.expressionContext&&"layout"===n.propertyType&&!Fi(r))return[new or(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===n.expressionContext)return Ya(r,n);if(n.expressionContext&&0===n.expressionContext.indexOf("cluster")){if(!Wi(r,["zoom","feature-state"]))return[new or(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===n.expressionContext&&!xa(r))return[new or(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ya(n,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)r.delete(u);if(0===r.size)return[];const s=[];return n instanceof go&&r.has(n.name)?[new or(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(u=>{s.push(...Ya(u,e))}),s)}function Bs(n){const e=n.key,r=n.value,s=n.valueSpec,u=[];return Array.isArray(s.values)?-1===s.values.indexOf(bi(r))&&u.push(new or(e,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(s.values).indexOf(bi(r))&&u.push(new or(e,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function Wl(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!Wl(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Da(n,e="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Wl(n)||(n=ni(n));const r=n;let s=!0;try{s=function(T){if(!za(T))return T;let F=ii(T);return ql(F),F=au(F),F}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const u=on[`filter_${e}`],f=qi(s,u);let _=null;if("error"===f.result)throw new Error(f.value.map(T=>`${T.key}: ${T.message}`).join(", "));_=(T,F,V)=>f.value.evaluate(T,F,{},V);let x=null,C=null;if(s!==r){const T=qi(r,u);if("error"===T.result)throw new Error(T.value.map(F=>`${F.key}: ${F.message}`).join(", "));x=(F,V,j,q,J)=>T.value.evaluate(F,V,{},j,void 0,void 0,q,J),C=!xa(T.value.expression)}return{filter:_,dynamicFilter:x||void 0,needGeometry:Bn(s),needFeature:!!C}}function au(n){if(!Array.isArray(n))return n;const e=function(r){if(Zl.has(r[0]))for(let s=1;s<r.length;s++)if(za(r[s]))return!0;return r}(n);return!0===e?e:e.map(r=>au(r))}function ql(n){let e=!1;const r=[];if("case"===n[0]){for(let s=1;s<n.length-1;s+=2)e=e||za(n[s]),r.push(n[s+1]);r.push(n[n.length-1])}else if("match"===n[0]){e=e||za(n[1]);for(let s=2;s<n.length-1;s+=2)r.push(n[s+1]);r.push(n[n.length-1])}else if("step"===n[0]){e=e||za(n[1]);for(let s=1;s<n.length-1;s+=2)r.push(n[s+1])}e&&(n.length=0,n.push("any",...r));for(let s=1;s<n.length;s++)ql(n[s])}function za(n){if(!Array.isArray(n))return!1;if("pitch"===(e=n[0])||"distance-from-center"===e)return!0;var e;for(let r=1;r<n.length;r++)if(za(n[r]))return!0;return!1}const Zl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function pc(n,e){return n<e?-1:n>e?1:0}function Bn(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let e=1;e<n.length;e++)if(Bn(n[e]))return!0;return!1}function ni(n){if(!n)return!0;const e=n[0];return n.length<=1?"any"!==e:"=="===e?Ca(n[1],n[2],"=="):"!="===e?Dl(Ca(n[1],n[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Ca(n[1],n[2],e):"any"===e?(r=n.slice(1),["any"].concat(r.map(ni))):"all"===e?["all"].concat(n.slice(1).map(ni)):"none"===e?["all"].concat(n.slice(1).map(ni).map(Dl)):"in"===e?El(n[1],n.slice(2)):"!in"===e?Dl(El(n[1],n.slice(2))):"has"===e?ds(n[1]):"!has"===e?Dl(ds(n[1])):"within"!==e||n;var r}function Ca(n,e,r){switch(n){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,n,e]}}function El(n,e){if(0===e.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",n,["literal",e.sort(pc)]]:["filter-in-small",n,["literal",e]]}}function ds(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Dl(n){return["!",n]}function $a(n){return Wl(ii(n.value))?ys(ro({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):na(n)}function na(n){const e=n.value,r=n.key;if("array"!==Sn(e))return[new or(r,e,`array expected, ${Sn(e)} found`)];const s=n.styleSpec;let u,f=[];if(e.length<1)return[new or(r,e,"filter array must have at least 1 element")];switch(f=f.concat(Bs({key:`${r}[0]`,value:e[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),bi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===bi(e[1])&&f.push(new or(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&f.push(new or(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Sn(e[1]),"string"!==u&&f.push(new or(`${r}[1]`,e[1],`string expected, ${u} found`)));for(let _=2;_<e.length;_++)u=Sn(e[_]),"$type"===bi(e[1])?f=f.concat(Bs({key:`${r}[${_}]`,value:e[_],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==u&&"number"!==u&&"boolean"!==u&&f.push(new or(`${r}[${_}]`,e[_],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)f=f.concat(na({key:`${r}[${_}]`,value:e[_],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Sn(e[1]),2!==e.length?f.push(new or(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==u&&f.push(new or(`${r}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Sn(e[1]),2!==e.length?f.push(new or(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==u&&f.push(new or(`${r}[1]`,e[1],`object expected, ${u} found`))}return f}function Yl(n,e){const r=n.key,s=n.style,u=n.styleSpec,f=n.value,_=n.objectKey,x=u[`${e}_${n.layerType}`];if(!x)return[];const C=_.match(/^(.*)-transition$/);if("paint"===e&&C&&x[C[1]]&&x[C[1]].transition)return Ss({key:r,value:f,valueSpec:u.transition,style:s,styleSpec:u});const T=n.valueSpec||x[_];if(!T)return[new or(r,f,`unknown property "${_}"`)];let F;if("string"===Sn(f)&&Re(T)&&!T.tokens&&(F=/^{([^}]+)}$/.exec(f))){const j=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new or(r,f,`"${_}" does not support interpolation syntax\nUse an identity property function instead: ${j}.`)]}const V=[];return"symbol"===n.layerType&&("text-field"===_&&s&&!s.glyphs&&V.push(new or(r,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===_&&Er(ii(f))&&"identity"===bi(f.type)&&V.push(new or(r,f,'"text-font" does not support identity functions'))),V.concat(Ss({key:n.key,value:f,valueSpec:T,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:_}))}function Ac(n){return Yl(n,"paint")}function mc(n){return Yl(n,"layout")}function zu(n){let e=[];const r=n.value,s=n.key,u=n.style,f=n.styleSpec;r.type||r.ref||e.push(new or(s,r,'either "type" or "ref" is required'));let _=bi(r.type);const x=bi(r.ref);if(r.id){const C=bi(r.id);for(let T=0;T<n.arrayIndex;T++){const F=u.layers[T];bi(F.id)===C&&e.push(new or(s,r.id,`duplicate layer id "${r.id}", previously used at line ${F.id.__line__}`))}}if("ref"in r){let C;["type","source","source-layer","filter","layout"].forEach(T=>{T in r&&e.push(new or(s,r[T],`"${T}" is prohibited for ref layers`))}),u.layers.forEach(T=>{bi(T.id)===x&&(C=T)}),C?C.ref?e.push(new or(s,r.ref,"ref cannot reference another ref layer")):_=bi(C.type):"string"==typeof x&&e.push(new or(s,r.ref,`ref layer "${x}" not found`))}else if("background"!==_&&"sky"!==_)if(r.source){const C=u.sources&&u.sources[r.source],T=C&&bi(C.type);C?"vector"===T&&"raster"===_?e.push(new or(s,r.source,`layer "${r.id}" requires a raster source`)):"raster"===T&&"raster"!==_?e.push(new or(s,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==T||r["source-layer"]?"raster-dem"===T&&"hillshade"!==_?e.push(new or(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==_||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===T&&C.lineMetrics||e.push(new or(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new or(s,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new or(s,r.source,`source "${r.source}" not found`))}else e.push(new or(s,r,'missing required property "source"'));return e=e.concat(la({key:s,value:r,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ss({key:`${s}.type`,value:r.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,object:r,objectKey:"type"}),filter:C=>$a(ro({layerType:_},C)),layout:C=>la({layer:r,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":T=>mc(ro({layerType:_},T))}}),paint:C=>la({layer:r,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":T=>Ac(ro({layerType:_},T))}})}})),e}function Va(n){const e=n.value,r=n.key,s=Sn(e);return"string"!==s?[new or(r,e,`string expected, ${s} found`)]:[]}const Ts={promoteId:function({key:n,value:e}){if("string"===Sn(e))return Va({key:n,value:e});{const r=[];for(const s in e)r.push(...Va({key:`${n}.${s}`,value:e[s]}));return r}}};function Ta(n){const e=n.value,r=n.key,s=n.styleSpec,u=n.style;if(!e.type)return[new or(r,e,'"type" is required')];const f=bi(e.type);let _;switch(f){case"vector":case"raster":case"raster-dem":return _=la({key:r,value:e,valueSpec:s[`source_${f.replace("-","_")}`],style:n.style,styleSpec:s,objectElementValidators:Ts}),_;case"geojson":if(_=la({key:r,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:Ts}),e.cluster)for(const x in e.clusterProperties){const[C,T]=e.clusterProperties[x],F="string"==typeof C?[C,["accumulated"],["get",x]]:C;_.push(...ys({key:`${r}.${x}.map`,value:T,expressionContext:"cluster-map"})),_.push(...ys({key:`${r}.${x}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return _;case"video":return la({key:r,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return la({key:r,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new or(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bs({key:`${r}.type`,value:e.type,valueSpec:{values:Cl(s)},style:u,styleSpec:s})}}function Cl(n){return n.source.reduce((e,r)=>{const s=n[r];return"enum"===s.type.type&&(e=e.concat(Object.keys(s.type.values))),e},[])}function Xa(n){const e=n.value,r=n.styleSpec,s=r.light,u=n.style;let f=[];const _=Sn(e);if(void 0===e)return f;if("object"!==_)return f=f.concat([new or("light",e,`object expected, ${_} found`)]),f;for(const x in e){const C=x.match(/^(.*)-transition$/);f=f.concat(C&&s[C[1]]&&s[C[1]].transition?Ss({key:x,value:e[x],valueSpec:r.transition,style:u,styleSpec:r}):s[x]?Ss({key:x,value:e[x],valueSpec:s[x],style:u,styleSpec:r}):[new or(x,e[x],`unknown property "${x}"`)])}return f}function ca(n){const e=n.value,r=n.key,s=n.style,u=n.styleSpec,f=u.terrain;let _=[];const x=Sn(e);if(void 0===e)return _;if("object"!==x)return _=_.concat([new or("terrain",e,`object expected, ${x} found`)]),_;for(const C in e){const T=C.match(/^(.*)-transition$/);_=_.concat(T&&f[T[1]]&&f[T[1]].transition?Ss({key:C,value:e[C],valueSpec:u.transition,style:s,styleSpec:u}):f[C]?Ss({key:C,value:e[C],valueSpec:f[C],style:s,styleSpec:u}):[new or(C,e[C],`unknown property "${C}"`)])}if(e.source){const C=s.sources&&s.sources[e.source],T=C&&bi(C.type);C?"raster-dem"!==T&&_.push(new or(r,e.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):_.push(new or(r,e.source,`source "${e.source}" not found`))}else _.push(new or(r,e,'terrain is missing required property "source"'));return _}function Pc(n){const e=n.value,r=n.style,s=n.styleSpec,u=s.fog;let f=[];const _=Sn(e);if(void 0===e)return f;if("object"!==_)return f=f.concat([new or("fog",e,`object expected, ${_} found`)]),f;for(const x in e){const C=x.match(/^(.*)-transition$/);f=f.concat(C&&u[C[1]]&&u[C[1]].transition?Ss({key:x,value:e[x],valueSpec:s.transition,style:r,styleSpec:s}):u[x]?Ss({key:x,value:e[x],valueSpec:u[x],style:r,styleSpec:s}):[new or(x,e[x],`unknown property "${x}"`)])}return f}const Xl={"*":()=>[],array:ei,boolean:function(n){const e=n.value,r=n.key,s=Sn(e);return"boolean"!==s?[new or(r,e,`boolean expected, ${s} found`)]:[]},number:Za,color:function(n){const e=n.key,r=n.value,s=Sn(r);return"string"!==s?[new or(e,r,`color expected, ${s} found`)]:null===wi(r)?[new or(e,r,`color expected, "${r}" found`)]:[]},enum:Bs,filter:$a,function:wl,layer:zu,object:la,source:Ta,light:Xa,terrain:ca,fog:Pc,string:Va,formatted:function(n){return 0===Va(n).length?[]:ys(n)},resolvedImage:function(n){return 0===Va(n).length?[]:ys(n)},projection:function(n){const e=n.value,r=n.styleSpec,s=r.projection,u=n.style;let f=[];const _=Sn(e);if("object"===_)for(const x in e)f=f.concat(Ss({key:x,value:e[x],valueSpec:s[x],style:u,styleSpec:r}));else"string"!==_&&(f=f.concat([new or("projection",e,`object or string expected, ${_} found`)]));return f}};function Ss(n){const e=n.value,r=n.valueSpec,s=n.styleSpec;return r.expression&&Er(bi(e))?wl(n):r.expression&&ta(ii(e))?ys(n):r.type&&Xl[r.type]?Xl[r.type](n):la(ro({},n,{valueSpec:r.type?s[r.type]:r}))}function md(n){const e=n.value,r=n.key,s=Va(n);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new or(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new or(r,e,'"glyphs" url must include a "{range}" token'))),s}function Kl(n,e=on){return qs(Ss({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:md,"*":()=>[]}}))}const gc=n=>qs(Ac(n)),lu=n=>qs(mc(n));function qs(n){return n.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function Rc(n,e){let r=!1;if(e&&e.length)for(const s of e)n.fire(new Gr(new Error(s.message))),r=!0;return r}var L=H,N=3;function H(n,e,r){var s=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var u=new Int32Array(this.arrayBuffer);n=u[0],this.d=(e=u[1])+2*(r=u[2]);for(var f=0;f<this.d*this.d;f++){var _=u[N+f],x=u[N+f+1];s.push(_===x?null:u.subarray(_,x))}var C=u[N+s.length+1];this.keys=u.subarray(u[N+s.length],C),this.bboxes=u.subarray(C),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var T=0;T<this.d*this.d;T++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=r,this.scale=e/n,this.uid=0;var F=r/e*n;this.min=-F,this.max=n+F}H.prototype.insert=function(n,e,r,s,u){this._forEachCell(e,r,s,u,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(u)},H.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},H.prototype._insertCell=function(n,e,r,s,u,f){this.cells[u].push(f)},H.prototype.query=function(n,e,r,s,u){var f=this.min,_=this.max;if(n<=f&&e<=f&&_<=r&&_<=s&&!u)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(n,e,r,s,this._queryCell,x,{},u),x},H.prototype._queryCell=function(n,e,r,s,u,f,_,x){var C=this.cells[u];if(null!==C)for(var T=this.keys,F=this.bboxes,V=0;V<C.length;V++){var j=C[V];if(void 0===_[j]){var q=4*j;(x?x(F[q+0],F[q+1],F[q+2],F[q+3]):n<=F[q+2]&&e<=F[q+3]&&r>=F[q+0]&&s>=F[q+1])?(_[j]=!0,f.push(T[j])):_[j]=!1}}},H.prototype._forEachCell=function(n,e,r,s,u,f,_,x){for(var C=this._convertToCellCoord(n),T=this._convertToCellCoord(e),F=this._convertToCellCoord(r),V=this._convertToCellCoord(s),j=C;j<=F;j++)for(var q=T;q<=V;q++){var J=this.d*q+j;if((!x||x(this._convertFromCellCoord(j),this._convertFromCellCoord(q),this._convertFromCellCoord(j+1),this._convertFromCellCoord(q+1)))&&u.call(this,n,e,r,s,J,f,_,x))return}},H.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},H.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},H.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=N+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var u=new Int32Array(e+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,_=0;_<n.length;_++){var x=n[_];u[N+_]=f,u.set(x,f),f+=x.length}return u[N+n.length]=f,u.set(this.keys,f),u[N+n.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};var v=xt(L);const g={};function E(n,e,r={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),g[e]={klass:n,omit:r.omit||[]}}E(Object,"Object"),v.serialize=function(n,e){const r=n.toArrayBuffer();return e&&e.push(r),{buffer:r}},v.deserialize=function(n){return new v(n.buffer)},Object.defineProperty(v,"name",{value:"Grid"}),E(v,"Grid"),E(qr,"Color"),E(Error,"Error"),E(yi,"AJAXError"),E(So,"ResolvedImage"),E(Gl,"StylePropertyFunction"),E(Ps,"StyleExpression",{omit:["_evaluator"]}),E(Cs,"ZoomDependentExpression"),E(_s,"ZoomConstantExpression"),E(go,"CompoundExpression",{omit:["_evaluate"]});for(const n in Q)g[Q[n]._classRegistryKey]||E(Q[n],`Expression${n}`);function S(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function $(n){return _e.ImageBitmap&&n instanceof _e.ImageBitmap}function te(n,e){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(S(n)||$(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const r=n;return e&&e.push(r.buffer),r}if(n instanceof _e.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const r=[];for(const s of n)r.push(te(s,e));return r}if("object"==typeof n){const r=n.constructor,s=r._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const u=r.serialize?r.serialize(n,e):{};if(!r.serialize){for(const f in n)n.hasOwnProperty(f)&&(g[s].omit.indexOf(f)>=0||(u[f]=te(n[f],e)));n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof n)}function ve(n){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||S(n)||$(n)||ArrayBuffer.isView(n)||n instanceof _e.ImageData)return n;if(Array.isArray(n))return n.map(ve);if("object"==typeof n){const e=n.$name||"Object",{klass:r}=g[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(n);const s=Object.create(r.prototype);for(const u of Object.keys(n))"$name"!==u&&(s[u]=ve(n[u]));return s}throw new Error("can't deserialize object of type "+typeof n)}const me={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function st(n){for(const e of n)if(Yn(e.charCodeAt(0)))return!0;return!1}function $t(n){for(const e of n)if(!er(e.charCodeAt(0)))return!1;return!0}function er(n){return!(me.Arabic(n)||me["Arabic Supplement"](n)||me["Arabic Extended-A"](n)||me["Arabic Presentation Forms-A"](n)||me["Arabic Presentation Forms-B"](n))}function Yn(n){return!(746!==n&&747!==n&&(n<4352||!(me["Bopomofo Extended"](n)||me.Bopomofo(n)||me["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||me["CJK Compatibility Ideographs"](n)||me["CJK Compatibility"](n)||me["CJK Radicals Supplement"](n)||me["CJK Strokes"](n)||!(!me["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||me["CJK Unified Ideographs Extension A"](n)||me["CJK Unified Ideographs"](n)||me["Enclosed CJK Letters and Months"](n)||me["Hangul Compatibility Jamo"](n)||me["Hangul Jamo Extended-A"](n)||me["Hangul Jamo Extended-B"](n)||me["Hangul Jamo"](n)||me["Hangul Syllables"](n)||me.Hiragana(n)||me["Ideographic Description Characters"](n)||me.Kanbun(n)||me["Kangxi Radicals"](n)||me["Katakana Phonetic Extensions"](n)||me.Katakana(n)&&12540!==n||!(!me["Halfwidth and Fullwidth Forms"](n)||65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||!(!me["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||me["Unified Canadian Aboriginal Syllabics"](n)||me["Unified Canadian Aboriginal Syllabics Extended"](n)||me["Vertical Forms"](n)||me["Yijing Hexagram Symbols"](n)||me["Yi Syllables"](n)||me["Yi Radicals"](n))))}function Nr(n){return!(Yn(n)||(e=n,me["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||me["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||me["Letterlike Symbols"](e)||me["Number Forms"](e)||me["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||me["Control Pictures"](e)&&9251!==e||me["Optical Character Recognition"](e)||me["Enclosed Alphanumerics"](e)||me["Geometric Shapes"](e)||me["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||me["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||me["CJK Symbols and Punctuation"](e)||me.Katakana(e)||me["Private Use Area"](e)||me["CJK Compatibility Forms"](e)||me["Small Form Variants"](e)||me["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Wr(n){return n>=1424&&n<=2303||me["Arabic Presentation Forms-A"](n)||me["Arabic Presentation Forms-B"](n)}function Sr(n,e){return!(!e&&Wr(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||me.Khmer(n))}function Zr(n){for(const e of n)if(Wr(e.charCodeAt(0)))return!0;return!1}const Ur="deferred",hi="loading",Zi="loaded";let _o=null,h="unavailable",i=null;const c=function(n){n&&"string"==typeof n&&n.indexOf("NetworkError")>-1&&(h="error"),_o&&_o(n)};function p(){y.fire(new li("pluginStateChange",{pluginStatus:h,pluginURL:i}))}const y=new Es,D=function(){return h},A=function(){if(h!==Ur||!i)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");h=hi,p(),i&&Or({url:i},n=>{n?c(n):(h=Zi,p())})},O={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>h===Zi||null!=O.applyArabicShaping,isLoading:()=>h===hi,setState(n){h=n.pluginStatus,i=n.pluginURL},isParsed:()=>null!=O.applyArabicShaping&&null!=O.processBidirectionalText&&null!=O.processStyledBidirectionalText,getPluginURL:()=>i};class z{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,s){for(const u of r)if(!Sr(u.charCodeAt(0),s))return!1;return!0}(e,O.isLoaded())}}class G{constructor(e,r){this.property=e,this.value=r,this.expression=function(s,u){if(Er(s))return new Gl(s,u);if(ta(s)){const f=aa(s,u);if("error"===f.result)throw new Error(f.value.map(_=>`${_.key}: ${_.message}`).join(", "));return f.value}{let f=s;return"string"==typeof s&&"color"===u.type&&(f=qr.parse(s)),{kind:"constant",evaluate:()=>f}}}(void 0===r?e.specification.default:r,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,r,s){return this.property.possiblyEvaluate(this,e,r,s)}}class W{constructor(e){this.property=e,this.value=new G(e,void 0)}transitioned(e,r){return new de(this.property,this.value,r,Se({},e.transition,this.transition),e.now)}untransitioned(){return new de(this.property,this.value,null,{},0)}}class oe{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Jt(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new W(this._values[e].property)),this._values[e].value=new G(this._values[e].property,null===r?void 0:Jt(r))}getTransition(e){return Jt(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new W(this._values[e].property)),this._values[e].transition=Jt(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(e[r]=s);const u=this.getTransition(r);void 0!==u&&(e[`${r}-transition`]=u)}return e}transitioned(e,r){const s=new ge(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,r._values[u]);return s}untransitioned(){const e=new ge(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class de{constructor(e,r,s,u,f){const _=u.delay||0,x=u.duration||0;f=f||0,this.property=e,this.value=r,this.begin=f+_,this.end=this.begin+x,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,r,s){const u=e.now||0,f=this.value.possiblyEvaluate(e,r,s),_=this.prior;if(_){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return _.possiblyEvaluate(e,r,s);{const x=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,r,s),f,Nt(x))}}return f}}class ge{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,s){const u=new Oe(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,r,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class be{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Jt(this._values[e].value)}setValue(e,r){this._values[e]=new G(this._values[e].property,null===r?void 0:Jt(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(e[r]=s)}return e}possiblyEvaluate(e,r,s){const u=new Oe(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,r,s);return u}}class De{constructor(e,r,s){this.property=e,this.value=r,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,r,s,u){return this.property.evaluate(this.value,this.parameters,e,r,s,u)}}class Oe{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ae{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,s){const u=R[this.specification.type];return u?u(e,r,s):e}}class Te{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,s,u){return new De(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(r,null,{},s,u)}:e.expression,r)}interpolate(e,r,s){if("constant"!==e.value.kind||"constant"!==r.value.kind)return e;if(void 0===e.value.value||void 0===r.value.value)return new De(this,{kind:"constant",value:void 0},e.parameters);const u=R[this.specification.type];return u?new De(this,{kind:"constant",value:u(e.value.value,r.value.value,s)},e.parameters):e}evaluate(e,r,s,u,f,_){return"constant"===e.kind?e.value:e.evaluate(r,s,u,f,_)}}class Ge{constructor(e){this.specification=e}possiblyEvaluate(e,r,s,u){return!!e.expression.evaluate(r,null,{},s,u)}interpolate(){return!1}}class Ve{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new z(0,{});for(const s in e){const u=e[s];u.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new G(u,void 0),_=this.defaultTransitionablePropertyValues[s]=new W(u);this.defaultTransitioningPropertyValues[s]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate(r)}}}function bt(n,e){return 256*(n=Vt(Math.floor(n),0,255))+Vt(Math.floor(e),0,255)}E(Te,"DataDrivenProperty"),E(ae,"DataConstantProperty"),E(Ge,"ColorRampProperty");const wt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class dt{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Lt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Tt(n,e=1){let r=0,s=0;return{members:n.map(u=>{const f=wt[u.type].BYTES_PER_ELEMENT,_=r=qt(r,Math.max(e,f)),x=u.components||1;return s=Math.max(s,f),r+=f*x,{name:u.name,type:u.type,components:x,offset:_}}),size:qt(r,Math.max(s,e)),alignment:e}}function qt(n,e){return Math.ceil(n/e)*e}class Rn extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.int16[u+0]=r,this.int16[u+1]=s,e}}Rn.prototype.bytesPerElement=4,E(Rn,"StructArrayLayout2i4");class Ht extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.int16[f+0]=r,this.int16[f+1]=s,this.int16[f+2]=u,e}}Ht.prototype.bytesPerElement=6,E(Ht,"StructArrayLayout3i6");class Dn extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const _=4*e;return this.int16[_+0]=r,this.int16[_+1]=s,this.int16[_+2]=u,this.int16[_+3]=f,e}}Dn.prototype.bytesPerElement=8,E(Dn,"StructArrayLayout4i8");class sn extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_,x){const C=this.length;return this.resize(C+1),this.emplace(C,e,r,s,u,f,_,x)}emplace(e,r,s,u,f,_,x,C){const T=6*e,F=12*e,V=3*e;return this.int16[T+0]=r,this.int16[T+1]=s,this.uint8[F+4]=u,this.uint8[F+5]=f,this.uint8[F+6]=_,this.uint8[F+7]=x,this.float32[V+2]=C,e}}sn.prototype.bytesPerElement=12,E(sn,"StructArrayLayout2i4ub1f12");class Ln extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const _=4*e;return this.float32[_+0]=r,this.float32[_+1]=s,this.float32[_+2]=u,this.float32[_+3]=f,e}}Ln.prototype.bytesPerElement=16,E(Ln,"StructArrayLayout4f16");class Xt extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,s,u,f)}emplace(e,r,s,u,f,_){const x=6*e,C=3*e;return this.uint16[x+0]=r,this.uint16[x+1]=s,this.uint16[x+2]=u,this.uint16[x+3]=f,this.float32[C+2]=_,e}}Xt.prototype.bytesPerElement=12,E(Xt,"StructArrayLayout4ui1f12");class xn extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const _=4*e;return this.uint16[_+0]=r,this.uint16[_+1]=s,this.uint16[_+2]=u,this.uint16[_+3]=f,e}}xn.prototype.bytesPerElement=8,E(xn,"StructArrayLayout4ui8");class Nn extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,r,s,u,f,_)}emplace(e,r,s,u,f,_,x){const C=6*e;return this.int16[C+0]=r,this.int16[C+1]=s,this.int16[C+2]=u,this.int16[C+3]=f,this.int16[C+4]=_,this.int16[C+5]=x,e}}Nn.prototype.bytesPerElement=12,E(Nn,"StructArrayLayout6i12");class An extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_,x,C,T,F,V,j){const q=this.length;return this.resize(q+1),this.emplace(q,e,r,s,u,f,_,x,C,T,F,V,j)}emplace(e,r,s,u,f,_,x,C,T,F,V,j,q){const J=12*e;return this.int16[J+0]=r,this.int16[J+1]=s,this.int16[J+2]=u,this.int16[J+3]=f,this.uint16[J+4]=_,this.uint16[J+5]=x,this.uint16[J+6]=C,this.uint16[J+7]=T,this.int16[J+8]=F,this.int16[J+9]=V,this.int16[J+10]=j,this.int16[J+11]=q,e}}An.prototype.bytesPerElement=24,E(An,"StructArrayLayout4i4ui4i24");class $n extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,r,s,u,f,_)}emplace(e,r,s,u,f,_,x){const C=10*e,T=5*e;return this.int16[C+0]=r,this.int16[C+1]=s,this.int16[C+2]=u,this.float32[T+2]=f,this.float32[T+3]=_,this.float32[T+4]=x,e}}$n.prototype.bytesPerElement=20,E($n,"StructArrayLayout3i3f20");class Ar extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Ar.prototype.bytesPerElement=4,E(Ar,"StructArrayLayout1ul4");class Xr extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_,x,C,T,F,V,j,q){const J=this.length;return this.resize(J+1),this.emplace(J,e,r,s,u,f,_,x,C,T,F,V,j,q)}emplace(e,r,s,u,f,_,x,C,T,F,V,j,q,J){const le=20*e,Ee=10*e;return this.int16[le+0]=r,this.int16[le+1]=s,this.int16[le+2]=u,this.int16[le+3]=f,this.int16[le+4]=_,this.float32[Ee+3]=x,this.float32[Ee+4]=C,this.float32[Ee+5]=T,this.float32[Ee+6]=F,this.int16[le+14]=V,this.uint32[Ee+8]=j,this.uint16[le+18]=q,this.uint16[le+19]=J,e}}Xr.prototype.bytesPerElement=40,E(Xr,"StructArrayLayout5i4f1i1ul2ui40");class ur extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_,x){const C=this.length;return this.resize(C+1),this.emplace(C,e,r,s,u,f,_,x)}emplace(e,r,s,u,f,_,x,C){const T=8*e;return this.int16[T+0]=r,this.int16[T+1]=s,this.int16[T+2]=u,this.int16[T+4]=f,this.int16[T+5]=_,this.int16[T+6]=x,this.int16[T+7]=C,e}}ur.prototype.bytesPerElement=16,E(ur,"StructArrayLayout3i2i2i16");class $r extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,s,u,f)}emplace(e,r,s,u,f,_){const x=4*e,C=8*e;return this.float32[x+0]=r,this.float32[x+1]=s,this.float32[x+2]=u,this.int16[C+6]=f,this.int16[C+7]=_,e}}$r.prototype.bytesPerElement=16,E($r,"StructArrayLayout2f1f2i16");class mi extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const _=12*e,x=3*e;return this.uint8[_+0]=r,this.uint8[_+1]=s,this.float32[x+1]=u,this.float32[x+2]=f,e}}mi.prototype.bytesPerElement=12,E(mi,"StructArrayLayout2ub2f12");class fi extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.float32[f+0]=r,this.float32[f+1]=s,this.float32[f+2]=u,e}}fi.prototype.bytesPerElement=12,E(fi,"StructArrayLayout3f12");class xr extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){const f=3*e;return this.uint16[f+0]=r,this.uint16[f+1]=s,this.uint16[f+2]=u,e}}xr.prototype.bytesPerElement=6,E(xr,"StructArrayLayout3ui6");class Yi extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee,Ue,rt,je,it,ft){const ht=this.length;return this.resize(ht+1),this.emplace(ht,e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee,Ue,rt,je,it,ft)}emplace(e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee,Ue,rt,je,it,ft,ht){const Yt=30*e,Ut=15*e,hn=60*e;return this.int16[Yt+0]=r,this.int16[Yt+1]=s,this.int16[Yt+2]=u,this.float32[Ut+2]=f,this.float32[Ut+3]=_,this.uint16[Yt+8]=x,this.uint16[Yt+9]=C,this.uint32[Ut+5]=T,this.uint32[Ut+6]=F,this.uint32[Ut+7]=V,this.uint16[Yt+16]=j,this.uint16[Yt+17]=q,this.uint16[Yt+18]=J,this.float32[Ut+10]=le,this.float32[Ut+11]=Ee,this.uint8[hn+48]=Ue,this.uint8[hn+49]=rt,this.uint8[hn+50]=je,this.uint32[Ut+13]=it,this.int16[Yt+28]=ft,this.uint8[hn+58]=ht,e}}Yi.prototype.bytesPerElement=60,E(Yi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class gi extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee,Ue,rt,je,it,ft,ht,Yt,Ut,hn,kn,tn,Cn,Tn,On){const Vn=this.length;return this.resize(Vn+1),this.emplace(Vn,e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee,Ue,rt,je,it,ft,ht,Yt,Ut,hn,kn,tn,Cn,Tn,On)}emplace(e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee,Ue,rt,je,it,ft,ht,Yt,Ut,hn,kn,tn,Cn,Tn,On,Vn){const fn=38*e,tr=19*e;return this.int16[fn+0]=r,this.int16[fn+1]=s,this.int16[fn+2]=u,this.float32[tr+2]=f,this.float32[tr+3]=_,this.int16[fn+8]=x,this.int16[fn+9]=C,this.int16[fn+10]=T,this.int16[fn+11]=F,this.int16[fn+12]=V,this.int16[fn+13]=j,this.uint16[fn+14]=q,this.uint16[fn+15]=J,this.uint16[fn+16]=le,this.uint16[fn+17]=Ee,this.uint16[fn+18]=Ue,this.uint16[fn+19]=rt,this.uint16[fn+20]=je,this.uint16[fn+21]=it,this.uint16[fn+22]=ft,this.uint16[fn+23]=ht,this.uint16[fn+24]=Yt,this.uint16[fn+25]=Ut,this.uint16[fn+26]=hn,this.uint16[fn+27]=kn,this.uint16[fn+28]=tn,this.uint32[tr+15]=Cn,this.float32[tr+16]=Tn,this.float32[tr+17]=On,this.float32[tr+18]=Vn,e}}gi.prototype.bytesPerElement=76,E(gi,"StructArrayLayout3i2f6i15ui1ul3f76");class ho extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}ho.prototype.bytesPerElement=4,E(ho,"StructArrayLayout1f4");class ao extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,s,u,f)}emplace(e,r,s,u,f,_){const x=5*e;return this.float32[x+0]=r,this.float32[x+1]=s,this.float32[x+2]=u,this.float32[x+3]=f,this.float32[x+4]=_,e}}ao.prototype.bytesPerElement=20,E(ao,"StructArrayLayout5f20");class Ns extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,s,u)}emplace(e,r,s,u,f){const _=6*e;return this.uint32[3*e+0]=r,this.uint16[_+2]=s,this.uint16[_+3]=u,this.uint16[_+4]=f,e}}Ns.prototype.bytesPerElement=12,E(Ns,"StructArrayLayout1ul3ui12");class zs extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.uint16[u+0]=r,this.uint16[u+1]=s,e}}zs.prototype.bytesPerElement=4,E(zs,"StructArrayLayout2ui4");class Sa extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}Sa.prototype.bytesPerElement=2,E(Sa,"StructArrayLayout1ui2");class Ua extends Lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){const u=2*e;return this.float32[u+0]=r,this.float32[u+1]=s,e}}Ua.prototype.bytesPerElement=8,E(Ua,"StructArrayLayout2f8");class lo extends dt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}lo.prototype.size=40;class Vi extends Xr{get(e){return new lo(this,e)}}E(Vi,"CollisionBoxArray");class Ii extends dt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Ii.prototype.size=60;class hs extends Yi{get(e){return new Ii(this,e)}}E(hs,"PlacedSymbolArray");class Zs extends dt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Zs.prototype.size=76;class to extends gi{get(e){return new Zs(this,e)}}E(to,"SymbolInstanceArray");class Ia extends ho{getoffsetX(e){return this.float32[1*e+0]}}E(Ia,"GlyphOffsetArray");class $u extends Rn{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}E($u,"SymbolLineVertexArray");class Oc extends dt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Oc.prototype.size=12;class Vu extends Ns{get(e){return new Oc(this,e)}}E(Vu,"FeatureIndexArray");class Jl extends zs{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}E(Jl,"FillExtrusionCentroidArray");const _c=Tt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),kc=Tt([{name:"a_dash",components:4,type:"Uint16"}]);var gd={exports:{}},$s=function(n,e){var r,s,u,f,_,x,C,T;for(s=n.length-(r=3&n.length),u=e,_=3432918353,x=461845907,T=0;T<s;)C=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24,++T,u=27492+(65535&(f=5*(65535&(u=(u^=C=(65535&(C=(C=(65535&C)*_+(((C>>>16)*_&65535)<<16)&4294967295)<<15|C>>>17))*x+(((C>>>16)*x&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(C=0,r){case 3:C^=(255&n.charCodeAt(T+2))<<16;case 2:C^=(255&n.charCodeAt(T+1))<<8;case 1:u^=C=(65535&(C=(C=(65535&(C^=255&n.charCodeAt(T)))*_+(((C>>>16)*_&65535)<<16)&4294967295)<<15|C>>>17))*x+(((C>>>16)*x&65535)<<16)&4294967295}return u^=n.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0},b_=function(n,e){for(var r,s=n.length,u=e^s,f=0;s>=4;)r=1540483477*(65535&(r=255&n.charCodeAt(f)|(255&n.charCodeAt(++f))<<8|(255&n.charCodeAt(++f))<<16|(255&n.charCodeAt(++f))<<24))+((1540483477*(r>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:u^=(255&n.charCodeAt(f+2))<<16;case 2:u^=(255&n.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&n.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};gd.exports=$s,gd.exports.murmur3=$s,gd.exports.murmur2=b_;var cu=xt(gd.exports);class Eh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,s,u){this.ids.push(Ka(e)),this.positions.push(r,s,u)}getPositions(e){const r=Ka(e);let s=0,u=this.ids.length-1;for(;s<u;){const _=s+u>>1;this.ids[_]>=r?u=_:s=_+1}const f=[];for(;this.ids[s]===r;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,r){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Lc(s,u,0,s.length-1),r&&r.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const r=new Eh;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Ka(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:cu(String(n))}function Lc(n,e,r,s){for(;r<s;){const u=n[r+s>>1];let f=r-1,_=s+1;for(;;){do{f++}while(n[f]<u);do{_--}while(n[_]>u);if(f>=_)break;yd(n,f,_),yd(e,3*f,3*_),yd(e,3*f+1,3*_+1),yd(e,3*f+2,3*_+2)}_-r<s-_?(Lc(n,e,r,_),r=_+1):(Lc(n,e,_+1,s),s=_)}}function yd(n,e,r){const s=n[e];n[e]=n[r],n[r]=s}E(Eh,"FeaturePositionMap");class dl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}}class Fc extends dl{constructor(e){super(e),this.current=0}set(e,r,s){this.fetchUniformLocation(e,r)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class hm extends dl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,s){this.fetchUniformLocation(e,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class w_ extends dl{constructor(e){super(e),this.current=qr.transparent}set(e,r,s){this.fetchUniformLocation(e,r)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const E_=new Float32Array(16),bv=new Float32Array(9),Ja=new Float32Array(4);function vd(n){return[bt(255*n.r,255*n.g),bt(255*n.b,255*n.a)]}class Ql{constructor(e,r,s){this.value=e,this.uniformNames=r.map(u=>`u_${u}`),this.type=s}setUniform(e,r,s,u,f){r.set(e,f,u.constantOr(this.value))}getBinding(e,r){return"color"===this.type?new w_(e):new Fc(e)}}class xd{constructor(e,r){this.uniformNames=r.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,s,u,f){const _="u_pattern"===f||"u_dash"===f?this.pattern:"u_pixel_ratio"===f?this.pixelRatio:null;_&&r.set(e,f,_)}getBinding(e,r){return"u_pattern"===r||"u_dash"===r?new hm(e):new Fc(e)}}class ec{constructor(e,r,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(f=>({name:`a_${f}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,r,s,u,f,_){const x=this.paintVertexArray.length,C=this.expression.evaluate(new z(0),r,{},f,u,_);this.paintVertexArray.resize(e),this._setPaintValue(x,e,C)}updatePaintArray(e,r,s,u,f){const _=this.expression.evaluate({zoom:0},s,u,void 0,f);this._setPaintValue(e,r,_)}_setPaintValue(e,r,s){if("color"===this.type){const u=vd(s);for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<r;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Tl{constructor(e,r,s,u,f,_){this.expression=e,this.uniformNames=r.map(x=>`u_${x}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=r.map(x=>({name:`a_${x}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(e,r,s,u,f,_){const x=this.expression.evaluate(new z(this.zoom),r,{},f,u,_),C=this.expression.evaluate(new z(this.zoom+1),r,{},f,u,_),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,x,C)}updatePaintArray(e,r,s,u,f){const _=this.expression.evaluate({zoom:this.zoom},s,u,void 0,f),x=this.expression.evaluate({zoom:this.zoom+1},s,u,void 0,f);this._setPaintValue(e,r,_,x)}_setPaintValue(e,r,s,u){if("color"===this.type){const f=vd(s),_=vd(u);for(let x=e;x<r;x++)this.paintVertexArray.emplace(x,f[0],f[1],_[0],_[1])}else{for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,s,u,f){const _=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,x=Vt(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);r.set(e,f,x)}getBinding(e,r){return new Fc(e)}}class Bc{constructor(e,r,s,u,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=("array"===s?kc:_c).members;for(let _=0;_<r.length;++_);this.paintVertexArray=new u}populatePaintArray(e,r,s){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,r.patterns&&r.patterns[this.layerId],s)}updatePaintArray(e,r,s,u,f,_){this._setPaintValues(e,r,s.patterns&&s.patterns[this.layerId],_)}_setPaintValues(e,r,s,u){if(!u||!s)return;const f=u[s];if(!f)return;const{tl:_,br:x,pixelRatio:C}=f;for(let T=e;T<r;T++)this.paintVertexArray.emplace(T,_[0],_[1],x[0],x[1],C)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Nc{constructor(e,r,s=(()=>!0)){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!s(f))continue;const _=e.paint.get(f);if(!(_ instanceof De&&Re(_.property.specification)))continue;const x=C_(f,e.type),C=_.value,T=_.property.specification.type,F=!!_.property.useIntegerZoom,V="line-dasharray"===f||f.endsWith("pattern"),j="line-dasharray"===f&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==C.kind||j)if("source"===C.kind||j||V){const q=Lf(f,T,"source");this.binders[f]=V?new Bc(C,x,T,q,e.id):new ec(C,x,T,q),u.push(`/a_${f}`)}else{const q=Lf(f,T,"composite");this.binders[f]=new Tl(C,x,T,F,r,q),u.push(`/z_${f}`)}else this.binders[f]=V?new xd(C.value,x):new Ql(C.value,x,T),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof ec||r instanceof Tl?r.maxValue:0}populatePaintArrays(e,r,s,u,f,_){for(const x in this.binders){const C=this.binders[x];(C instanceof ec||C instanceof Tl||C instanceof Bc)&&C.populatePaintArray(e,r,s,u,f,_)}}setConstantPatternPositions(e){for(const r in this.binders){const s=this.binders[r];s instanceof xd&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,r,s,u,f,_){let x=!1;for(const C in e){const T=r.getPositions(C);for(const F of T){const V=s.feature(F.index);for(const j in this.binders){const q=this.binders[j];if((q instanceof ec||q instanceof Tl||q instanceof Bc)&&!0===q.expression.isStateDependent){const J=u.paint.get(j);q.expression=J.value,q.updatePaintArray(F.start,F.end,V,e[C],f,_),x=!0}}}}return x}defines(){const e=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Ql||s instanceof xd)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof ec||s instanceof Tl||s instanceof Bc)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Ql||s instanceof xd||s instanceof Tl)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const r=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Ql||u instanceof xd||u instanceof Tl)for(const f of u.uniformNames)r.push({name:f,property:s,binding:u.getBinding(e,f)})}return r}setUniforms(e,r,s,u,f){for(const{name:_,property:x,binding:C}of s)this.binders[x].setUniform(e,C,f,u.get(x),_)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const r=this.binders[e];(r instanceof ec||r instanceof Tl||r instanceof Bc)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){const s=this.binders[r];(s instanceof ec||s instanceof Tl||s instanceof Bc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof ec||r instanceof Tl||r instanceof Bc)&&r.destroy()}}}class uu{constructor(e,r,s=(()=>!0)){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Nc(u,r,s);this.needsUpload=!1,this._featureMap=new Eh,this._bufferOffset=0}populatePaintArrays(e,r,s,u,f,_,x){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(e,r,u,f,_,x);void 0!==r.id&&this._featureMap.add(r.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,s,u,f){for(const _ of s)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,r,_,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const D_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function C_(n,e){return D_[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const kf={"line-pattern":{source:Xt,composite:Xt},"fill-pattern":{source:Xt,composite:Xt},"fill-extrusion-pattern":{source:Xt,composite:Xt},"line-dasharray":{source:xn,composite:xn}},Dh={color:{source:Ua,composite:Ln},number:{source:ho,composite:Ua}};function Lf(n,e,r){const s=kf[n];return s&&s[r]||Dh[e][r]}E(Ql,"ConstantBinder"),E(xd,"PatternConstantBinder"),E(ec,"SourceExpressionBinder"),E(Bc,"PatternCompositeBinder"),E(Tl,"CompositeExpressionBinder"),E(Nc,"ProgramConfiguration",{omit:["_buffers"]}),E(uu,"ProgramConfigurationSet");const bd="-transition";class Sl extends Es{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new be(r.layout)),r.paint)){this._transitionablePaint=new oe(r.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Oe(r.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,s={}){null!=r&&this._validate(lu,`layers.${this.id}.layout.${e}`,e,r,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return _n(e,bd)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,s={}){if(null!=r&&this._validate(gc,`layers.${this.id}.paint.${e}`,e,r,s))return!1;if(_n(e,bd))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.value.isDataDriven(),_=u.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const x=this._transitionablePaint._values[e].value,C=x.isDataDriven(),T=_n(e,"pattern")||"line-dasharray"===e;return C||f||T||this._handleOverridablePaintPropertyUpdate(e,_,x)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),rn(e,(r,s)=>!(void 0===r||"layout"===s&&!Object.keys(r).length||"paint"===s&&!Object.keys(r).length))}_validate(e,r,s,u,f={}){return(!f||!1!==f.validate)&&Rc(this,e.call(Kl,{key:r,layerType:this.type,objectKey:s,value:u,styleSpec:on,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof De&&Re(r.property.specification)&&("source"===r.value.kind||"composite"===r.value.kind)&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Da(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Ch=Tt([{name:"a_pos",components:2,type:"Int16"}],4),T_=Tt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class fs{constructor(e=[]){this.segments=e}prepareSegment(e,r,s,u){let f=this.segments[this.segments.length-1];return e>fs.MAX_VERTEX_ARRAY_LENGTH&&dn(`Max vertices per segment is ${fs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>fs.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==u&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,s,u){return new fs([{vertexOffset:e,primitiveOffset:r,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}fs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,E(fs,"SegmentVector");var Pr=8192;class Il{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof fo?new fo(e.lng,e.lat):fo.convert(e),this}setSouthWest(e){return this._sw=e instanceof fo?new fo(e.lng,e.lat):fo.convert(e),this}extend(e){const r=this._sw,s=this._ne;let u,f;if(e instanceof fo)u=e,f=e;else{if(!(e instanceof Il))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Il.convert(e)):this.extend(fo.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(fo.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return r||s?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),s.lng=Math.max(f.lng,s.lng),s.lat=Math.max(f.lat,s.lat)):(this._sw=new fo(u.lng,u.lat),this._ne=new fo(f.lng,f.lat)),this}getCenter(){return new fo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new fo(this.getWest(),this.getNorth())}getSouthEast(){return new fo(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:s}=fo.convert(e);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof Il?e:new Il(e)}}var wd=1e-6,ja=typeof Float32Array<"u"?Float32Array:Array;function fm(){var n=new ja(9);return ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function du(n,e,r){var s=e[0],u=e[1],f=e[2],_=e[3],x=e[4],C=e[5],T=e[6],F=e[7],V=e[8],j=r[0],q=r[1],J=r[2],le=r[3],Ee=r[4],Ue=r[5],rt=r[6],je=r[7],it=r[8];return n[0]=j*s+q*_+J*T,n[1]=j*u+q*x+J*F,n[2]=j*f+q*C+J*V,n[3]=le*s+Ee*_+Ue*T,n[4]=le*u+Ee*x+Ue*F,n[5]=le*f+Ee*C+Ue*V,n[6]=rt*s+je*_+it*T,n[7]=rt*u+je*x+it*F,n[8]=rt*f+je*C+it*V,n}function Ma(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ff(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],_=e[4],x=e[5],C=e[6],T=e[7],F=e[8],V=e[9],j=e[10],q=e[11],J=e[12],le=e[13],Ee=e[14],Ue=e[15],rt=r*x-s*_,je=r*C-u*_,it=r*T-f*_,ft=s*C-u*x,ht=s*T-f*x,Yt=u*T-f*C,Ut=F*le-V*J,hn=F*Ee-j*J,kn=F*Ue-q*J,tn=V*Ee-j*le,Cn=V*Ue-q*le,Tn=j*Ue-q*Ee,On=rt*Tn-je*Cn+it*tn+ft*kn-ht*hn+Yt*Ut;return On?(n[0]=(x*Tn-C*Cn+T*tn)*(On=1/On),n[1]=(u*Cn-s*Tn-f*tn)*On,n[2]=(le*Yt-Ee*ht+Ue*ft)*On,n[3]=(j*ht-V*Yt-q*ft)*On,n[4]=(C*kn-_*Tn-T*hn)*On,n[5]=(r*Tn-u*kn+f*hn)*On,n[6]=(Ee*it-J*Yt-Ue*je)*On,n[7]=(F*Yt-j*it+q*je)*On,n[8]=(_*Cn-x*kn+T*Ut)*On,n[9]=(s*kn-r*Cn-f*Ut)*On,n[10]=(J*ht-le*it+Ue*rt)*On,n[11]=(V*it-F*ht-q*rt)*On,n[12]=(x*hn-_*tn-C*Ut)*On,n[13]=(r*tn-s*hn+u*Ut)*On,n[14]=(le*je-J*ft-Ee*rt)*On,n[15]=(F*ft-V*je+j*rt)*On,n):null}function Uu(n,e,r){var s=e[0],u=e[1],f=e[2],_=e[3],x=e[4],C=e[5],T=e[6],F=e[7],V=e[8],j=e[9],q=e[10],J=e[11],le=e[12],Ee=e[13],Ue=e[14],rt=e[15],je=r[0],it=r[1],ft=r[2],ht=r[3];return n[0]=je*s+it*x+ft*V+ht*le,n[1]=je*u+it*C+ft*j+ht*Ee,n[2]=je*f+it*T+ft*q+ht*Ue,n[3]=je*_+it*F+ft*J+ht*rt,n[4]=(je=r[4])*s+(it=r[5])*x+(ft=r[6])*V+(ht=r[7])*le,n[5]=je*u+it*C+ft*j+ht*Ee,n[6]=je*f+it*T+ft*q+ht*Ue,n[7]=je*_+it*F+ft*J+ht*rt,n[8]=(je=r[8])*s+(it=r[9])*x+(ft=r[10])*V+(ht=r[11])*le,n[9]=je*u+it*C+ft*j+ht*Ee,n[10]=je*f+it*T+ft*q+ht*Ue,n[11]=je*_+it*F+ft*J+ht*rt,n[12]=(je=r[12])*s+(it=r[13])*x+(ft=r[14])*V+(ht=r[15])*le,n[13]=je*u+it*C+ft*j+ht*Ee,n[14]=je*f+it*T+ft*q+ht*Ue,n[15]=je*_+it*F+ft*J+ht*rt,n}function ju(n,e,r){var s,u,f,_,x,C,T,F,V,j,q,J,le=r[0],Ee=r[1],Ue=r[2];return e===n?(n[12]=e[0]*le+e[4]*Ee+e[8]*Ue+e[12],n[13]=e[1]*le+e[5]*Ee+e[9]*Ue+e[13],n[14]=e[2]*le+e[6]*Ee+e[10]*Ue+e[14],n[15]=e[3]*le+e[7]*Ee+e[11]*Ue+e[15]):(u=e[1],f=e[2],_=e[3],x=e[4],C=e[5],T=e[6],F=e[7],V=e[8],j=e[9],q=e[10],J=e[11],n[0]=s=e[0],n[1]=u,n[2]=f,n[3]=_,n[4]=x,n[5]=C,n[6]=T,n[7]=F,n[8]=V,n[9]=j,n[10]=q,n[11]=J,n[12]=s*le+x*Ee+V*Ue+e[12],n[13]=u*le+C*Ee+j*Ue+e[13],n[14]=f*le+T*Ee+q*Ue+e[14],n[15]=_*le+F*Ee+J*Ue+e[15]),n}function hu(n,e,r){var s=r[0],u=r[1],f=r[2];return n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n[3]=e[3]*s,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function pm(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[4],_=e[5],x=e[6],C=e[7],T=e[8],F=e[9],V=e[10],j=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*u+T*s,n[5]=_*u+F*s,n[6]=x*u+V*s,n[7]=C*u+j*s,n[8]=T*u-f*s,n[9]=F*u-_*s,n[10]=V*u-x*s,n[11]=j*u-C*s,n}function Th(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[0],_=e[1],x=e[2],C=e[3],T=e[8],F=e[9],V=e[10],j=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u-T*s,n[1]=_*u-F*s,n[2]=x*u-V*s,n[3]=C*u-j*s,n[8]=f*s+T*u,n[9]=_*s+F*u,n[10]=x*s+V*u,n[11]=C*s+j*u,n}function mm(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function gm(n,e,r){var s,u,f,_=r[0],x=r[1],C=r[2],T=Math.hypot(_,x,C);return T<wd?null:(_*=T=1/T,x*=T,C*=T,s=Math.sin(e),u=Math.cos(e),n[0]=_*_*(f=1-u)+u,n[1]=x*_*f+C*s,n[2]=C*_*f-x*s,n[3]=0,n[4]=_*x*f-C*s,n[5]=x*x*f+u,n[6]=C*x*f+_*s,n[7]=0,n[8]=_*C*f+x*s,n[9]=x*C*f-_*s,n[10]=C*C*f+u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Sh=Uu;function Ih(){var n=new ja(3);return ja!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function _m(n){var e=new ja(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Hu(n){return Math.hypot(n[0],n[1],n[2])}function Ed(n,e,r){var s=new ja(3);return s[0]=n,s[1]=e,s[2]=r,s}function tc(n,e,r){return n[0]=e[0]+r[0],n[1]=e[1]+r[1],n[2]=e[2]+r[2],n}function ym(n,e,r){return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],n}function vm(n,e,r){return n[0]=e[0]*r[0],n[1]=e[1]*r[1],n[2]=e[2]*r[2],n}function Dd(n,e,r){return n[0]=Math.min(e[0],r[0]),n[1]=Math.min(e[1],r[1]),n[2]=Math.min(e[2],r[2]),n}function fu(n,e,r){return n[0]=Math.max(e[0],r[0]),n[1]=Math.max(e[1],r[1]),n[2]=Math.max(e[2],r[2]),n}function hl(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n}function Mh(n,e,r,s){return n[0]=e[0]+r[0]*s,n[1]=e[1]+r[1]*s,n[2]=e[2]+r[2]*s,n}function ra(n,e){var r=e[0],s=e[1],u=e[2],f=r*r+s*s+u*u;return f>0&&(f=1/Math.sqrt(f)),n[0]=e[0]*f,n[1]=e[1]*f,n[2]=e[2]*f,n}function Ml(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function xm(n,e,r){var s=e[0],u=e[1],f=e[2],_=r[0],x=r[1],C=r[2];return n[0]=u*C-f*x,n[1]=f*_-s*C,n[2]=s*x-u*_,n}function vs(n,e,r){var s=e[0],u=e[1],f=e[2],_=r[3]*s+r[7]*u+r[11]*f+r[15];return n[0]=(r[0]*s+r[4]*u+r[8]*f+r[12])/(_=_||1),n[1]=(r[1]*s+r[5]*u+r[9]*f+r[13])/_,n[2]=(r[2]*s+r[6]*u+r[10]*f+r[14])/_,n}function S_(n,e,r){var s=r[0],u=r[1],f=r[2],_=e[0],x=e[1],C=e[2],T=u*C-f*x,F=f*_-s*C,V=s*x-u*_,j=u*V-f*F,q=f*T-s*V,J=s*F-u*T,le=2*r[3];return F*=le,V*=le,q*=2,J*=2,n[0]=_+(T*=le)+(j*=2),n[1]=x+F+q,n[2]=C+V+J,n}var Ah,Al=ym,Ph=vm,Rh=Hu;function Bf(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n}function Nf(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],_=r*r+s*s+u*u+f*f;return _>0&&(_=1/Math.sqrt(_)),n[0]=r*_,n[1]=s*_,n[2]=u*_,n[3]=f*_,n}function zc(n,e,r){var s=e[0],u=e[1],f=e[2],_=e[3];return n[0]=r[0]*s+r[4]*u+r[8]*f+r[12]*_,n[1]=r[1]*s+r[5]*u+r[9]*f+r[13]*_,n[2]=r[2]*s+r[6]*u+r[10]*f+r[14]*_,n[3]=r[3]*s+r[7]*u+r[11]*f+r[15]*_,n}function pu(){var n=new ja(4);return ja!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function zf(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function $f(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],_=e[3],x=Math.sin(r),C=Math.cos(r);return n[0]=s*C+_*x,n[1]=u*C+f*x,n[2]=f*C-u*x,n[3]=_*C-s*x,n}function Cd(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],_=e[3],x=Math.sin(r),C=Math.cos(r);return n[0]=s*C-f*x,n[1]=u*C+_*x,n[2]=f*C+s*x,n[3]=_*C-u*x,n}Ih(),Ah=new ja(4),ja!=Float32Array&&(Ah[0]=0,Ah[1]=0,Ah[2]=0,Ah[3]=0);var Oh=Nf;Ih(),Ed(1,0,0),Ed(0,1,0),pu(),pu(),fm();const kh=Tt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:bm}=kh,wm=Tt([{name:"a_pos_3",components:3,type:"Int16"}]);var Td=Tt([{name:"a_pos",type:"Int16",components:2}]);class Lh{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,s){const u=Ml(r,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/u;return s[0]=this.pos[0]+this.dir[0]*f,s[1]=this.pos[1]+this.dir[1]*f,s[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,r,s){if(le=(q=this.pos)[0],Ee=q[1],Ue=q[2],rt=(J=e)[0],je=J[1],it=J[2],Math.abs(le-rt)<=wd*Math.max(1,Math.abs(le),Math.abs(rt))&&Math.abs(Ee-je)<=wd*Math.max(1,Math.abs(Ee),Math.abs(je))&&Math.abs(Ue-it)<=wd*Math.max(1,Math.abs(Ue),Math.abs(it))||0===r)return s[0]=s[1]=s[2]=0,!1;var q,J,le,Ee,Ue,rt,je,it;const[u,f,_]=this.dir,x=this.pos[0]-e[0],C=this.pos[1]-e[1],T=this.pos[2]-e[2],F=u*u+f*f+_*_,V=2*(x*u+C*f+T*_),j=V*V-4*F*(x*x+C*C+T*T-r*r);if(j<0){const q=Math.max(-V/2,0),J=x+u*q,le=C+f*q,Ee=T+_*q,Ue=Math.hypot(J,le,Ee);return s[0]=J*r/Ue,s[1]=le*r/Ue,s[2]=Ee*r/Ue,!1}{const q=(-V-Math.sqrt(j))/(2*F);if(q<0){const J=Math.hypot(x,C,T);return s[0]=x*r/J,s[1]=C*r/J,s[2]=T*r/J,!1}return s[0]=x+u*q,s[1]=C+f*q,s[2]=T+_*q,!0}}}class Sd{constructor(e,r,s,u,f){this.TL=e,this.TR=r,this.BR=s,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,r,s){const u=[-1,1,1],f=[1,1,1],_=[1,-1,1],x=[-1,-1,1],C=vs(u,u,e),T=vs(f,f,e),F=vs(_,_,e),V=vs(x,x,e);return new Sd(C,T,F,V,r/s)}}class Vf{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,s,u){const f=Math.pow(2,s),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const T=zc([],C,e),F=1/T[3]/r*f;return(V=T)[0]=(j=T)[0]*(q=[F,F,u?1/T[3]:F,F])[0],V[1]=j[1]*q[1],V[2]=j[2]*q[2],V[3]=j[3]*q[3],V;var V,j,q}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const T=ra([],xm([],Al([],_[C[0]],_[C[1]]),Al([],_[C[2]],_[C[1]]))),F=-Ml(T,_[C[1]]);return T.concat(F)});return new Vf(_,x)}}class pa{static fromPoints(e){const r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const u of e)Dd(r,r,u),fu(s,s,u);return new pa(r,s)}static applyTransform(e,r){const s=e.getCorners();for(let u=0;u<s.length;++u)vs(s[u],s[u],r);return pa.fromPoints(s)}constructor(e,r){this.min=e,this.max=r,this.center=hl([],tc([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],s=_m(this.min),u=_m(this.max);for(let f=0;f<r.length;f++)s[f]=r[f]?this.min[f]:this.center[f],u[f]=r[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new pa(s,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let s=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let _=0;for(let x=0;x<r.length;x++)_+=Ml(f,r[x])+f[3]>=0;if(0===_)return 0;_!==r.length&&(s=!1)}if(s)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let x=0;x<e.points.length;x++){const C=e.points[x][u]-this.min[u];f=Math.min(f,C),_=Math.max(_,C)}if(_<0||f>this.max[u]-this.min[u])return 0}return 1}}const Uf=5,jf=6,nc=Pr/Math.PI/2,I_=16383,mu=[64,32,16],Qa=-nc,Ha=nc,ma=[new pa([Qa,Qa,Qa],[Ha,Ha,Ha]),new pa([Qa,Qa,Qa],[0,0,Ha]),new pa([0,Qa,Qa],[Ha,0,Ha]),new pa([Qa,0,Qa],[0,Ha,Ha]),new pa([0,0,Qa],[Ha,Ha,Ha])];function $c(n){return n*nc/Ad}function Hf(n,e,r,s=!0){const u=hl([],n._camera.position,n.worldSize),f=[e,r,1,1];zc(f,f,n.pixelMatrixInverse),Bf(f,f,1/f[3]);const _=ra([],Al([],f,u)),x=n.globeMatrix,C=[x[12],x[13],x[14]],T=Al([],C,u),F=Hu(T),V=ra([],T),j=n.worldSize/(2*Math.PI),q=Ml(V,_),J=Math.asin(j/F);if(J<Math.acos(q)){if(!s)return null;const kn=[],tn=[];hl(kn,_,F/q),ra(tn,Al(tn,kn,T)),ra(_,tc(_,T,hl(_,tn,Math.tan(J)*F)))}const le=[];new Lh(u,_).closestPointOnSphere(C,j,le);const Ee=ra([],Jr(x,0)),Ue=ra([],Jr(x,1)),rt=ra([],Jr(x,2)),je=Ml(Ee,le),it=Ml(Ue,le),ft=Ml(rt,le),ht=gt(Math.asin(-it/j));let Yt=gt(Math.atan2(je,ft));Yt=n.center.lng+function(kn,tn){const Cn=(tn-kn+180)%360-180;return Cn<-180?Cn+360:Cn}(n.center.lng,Yt);const Ut=rc(Yt),hn=Vt(Rl(ht),0,1);return new vu(Ut,hn)}class Em{constructor(e,r,s){this.a=Al([],e,s),this.b=Al([],r,s),this.center=s;const u=ra([],this.a),f=ra([],this.b);this.angle=Math.acos(Ml(u,f))}}function Gf(n,e){if(0===n.angle)return null;let r;return r=0===n.a[e]?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),r<0||r>1?null:function(s,u,f,_){const x=Math.sin(f);return s*(Math.sin((1-_)*f)/x)+u*(Math.sin(_*f)/x)}(n.a[e],n.b[e],n.angle,Vt(r,0,1))+n.center[e]}function Pl(n){if(n.z<=1)return ma[n.z+2*n.y+n.x];const e=qf(Fh(n));return pa.fromPoints(e)}function gu(n,e,r){return hl(n,n,1-r),Mh(n,n,e,r)}function Wf(n,e){const r=_u(e.zoom);if(0===r)return Pl(n);const s=Fh(n),u=qf(s),f=rc(s.getWest())*e.worldSize,_=rc(s.getEast())*e.worldSize,x=Rl(s.getNorth())*e.worldSize,C=Rl(s.getSouth())*e.worldSize,T=[f,x,0],F=[_,x,0],V=[f,C,0],j=[_,C,0],q=Ff([],e.globeMatrix);return vs(T,T,q),vs(F,F,q),vs(V,V,q),vs(j,j,q),u[0]=gu(u[0],V,r),u[1]=gu(u[1],j,r),u[2]=gu(u[2],F,r),u[3]=gu(u[3],T,r),pa.fromPoints(u)}function Dm(n,e,r){for(const s of n)vs(s,s,e),hl(s,s,r)}function Fh({x:n,y:e,z:r}){const s=1/(1<<r),u=new fo(Aa(n*s),Us((e+1)*s)),f=new fo(Aa((n+1)*s),Us(e*s));return new Il(u,f)}function qf(n){const e=Ye(n.getNorth()),r=Ye(n.getSouth()),s=Math.cos(e),u=Math.cos(r),f=Math.sin(e),_=Math.sin(r),x=n.getWest(),C=n.getEast();return[Vc(u,_,x),Vc(u,_,C),Vc(s,f,C),Vc(s,f,x)]}function Vc(n,e,r,s=nc){return r=Ye(r),[n*Math.sin(r)*s,-e*s,n*Math.cos(r)*s]}function Uc(n,e,r){return Vc(Math.cos(Ye(n)),Math.sin(Ye(n)),e,r)}function Id(n,e,r,s){const u=1<<r.z,f=(n/Pr+r.x)/u;return Uc(Us((e/Pr+r.y)/u),Aa(f),s)}function jc({min:n,max:e}){return I_/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const Tm=new Float64Array(16);function Md(n){const e=jc(n),r=mm(Tm,[e,e,e]);return ju(r,r,((s=[])[0]=-(u=n.min)[0],s[1]=-u[1],s[2]=-u[2],s));var s,u}function Bh(n){const e=(s=n.min,(r=Tm)[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=s[0],r[13]=s[1],r[14]=s[2],r[15]=1,r);var r,s;const u=1/jc(n);return hu(e,e,[u,u,u])}function Zf(n,e,r,s,u){const f=function(C){const T=Pr/(2*Math.PI);return C/(2*Math.PI)/T}(r),_=[n,e,-r/(2*Math.PI)],x=Ma(new Float64Array(16));return ju(x,x,_),hu(x,x,[f,f,f]),pm(x,x,Ye(-u)),Th(x,x,Ye(-s)),x}function _u(n){return Jn(Uf,jf,n)}function yu(n,e){const r=Uc(e.lat,e.lng);return _=(u=ym([],function(J){const le=Uc(J._center.lat,J._center.lng);let Ee=xm([],Ed(0,1,0),le);const Ue=gm([],-J.angle,le);Ee=vs(Ee,Ee,Ue),gm(Ue,-J._pitch,Ee);const rt=ra([],le);return hl(rt,rt,$c(J.cameraToCenterDistance/J.pixelsPerMeter)),vs(rt,rt,Ue),tc([],le,rt)}(n),r))[0],x=u[1],C=u[2],T=(f=r)[0],F=f[1],V=f[2],q=(j=Math.sqrt(_*_+x*x+C*C)*Math.sqrt(T*T+F*F+V*V))&&Ml(u,f)/j,Math.acos(Math.min(Math.max(q,-1),1));var u,f,_,x,C,T,F,V,j,q}function Gu(n,e){return yu(n,e)>Math.PI/2*1.01}const Yf=Ye(85),Xf=Math.cos(Yf),Nh=Math.sin(Yf),Ad=6371008.8,Sm=2*Math.PI*Ad;class Hc{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Hc(Zt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,s=this.lat*r,u=e.lat*r,f=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*r);return Ad*Math.acos(Math.min(f,1))}toBounds(e=0){const r=360*e/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new Il(new Hc(this.lng-s,this.lat-r),new Hc(this.lng+s,this.lat+r))}toEcef(e){const r=$c(e);return Uc(this.lat,this.lng,nc+r)}static convert(e){if(e instanceof Hc)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Hc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Hc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var fo=Hc;function Kf(n){return Sm*Math.cos(n*Math.PI/180)}function rc(n){return(180+n)/360}function Rl(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Ga(n,e){return n/Kf(e)}function Aa(n){return 360*n-180}function Us(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function Im(n,e){return n*Kf(Us(e))}const ia=85.051129;function zh(n){return 1/Math.cos(n*Math.PI/180)}class vu{constructor(e,r,s=0){this.x=+e,this.y=+r,this.z=+s}static fromLngLat(e,r=0){const s=fo.convert(e);return new vu(rc(s.lng),Rl(s.lat),Ga(r,s.lat))}toLngLat(){return new fo(Aa(this.x),Us(this.y))}toAltitude(){return Im(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Sm*zh(Us(this.y))}}function yc(n,e,r,s,u,f,_,x,C){const T=(e+s)/2,F=(r+u)/2,V=new Ie(T,F);x(V),function(j,q,J,le,Ee,Ue){const rt=J-Ee,je=le-Ue;return Math.abs((le-q)*rt-(J-j)*je)/Math.hypot(rt,je)}(V.x,V.y,f.x,f.y,_.x,_.y)>=C?(yc(n,e,r,T,F,f,V,x,C),yc(n,T,F,s,u,V,_,x,C)):n.push(_)}function Jf(n,e,r){let s=n[0],u=s.x,f=s.y;e(s);const _=[s];for(let x=1;x<n.length;x++){const C=n[x],{x:T,y:F}=C;e(C),yc(_,u,f,T,F,s,C,e,r),u=T,f=F,s=C}return _}function $h(n,e,r,s){if(s(e,r)){const u=e.add(r)._mult(.5);$h(n,e,u,s),$h(n,u,r,s)}else n.push(r)}function M_(n,e){let r=n[0];const s=[r];for(let u=1;u<n.length;u++){const f=n[u];$h(s,r,f,e),r=f}return s}const Mm=Math.pow(2,14)-1,Pd=-Mm-1;function A_(n,e){const r=Math.round(n.x*e),s=Math.round(n.y*e);return n.x=Vt(r,Pd,Mm),n.y=Vt(s,Pd,Mm),(r<n.x||r>n.x+1||s<n.y||s>n.y+1)&&dn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function ic(n,e,r){const s=n.loadGeometry(),u=n.extent,f=Pr/u;if(e&&r&&r.projection.isReprojectedInTileSpace){const _=1<<e.z,{scale:x,x:C,y:T,projection:F}=r,V=j=>{const q=Aa((e.x+j.x/u)/_),J=Us((e.y+j.y/u)/_),le=F.project(q,J);j.x=(le.x*x-C)*u,j.y=(le.y*x-T)*u};for(let j=0;j<s.length;j++)if(1!==n.type)s[j]=Jf(s[j],V,1);else{const q=[];for(const J of s[j])J.x<0||J.x>=u||J.y<0||J.y>=u||(V(J),q.push(J));s[j]=q}}for(const _ of s)for(const x of _)A_(x,f);return s}function Gc(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?ic(n):[]}}function Rd(n,e,r,s,u){n.emplaceBack(2*e+(s+1)/2,2*r+(u+1)/2)}function Wu(n,e,r){n.emplaceBack(e.x,e.y,e.z,16384*r[0],16384*r[1],16384*r[2])}class Vh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Rn,this.indexArray=new xr,this.segments=new fs,this.programConfigurations=new uu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,s,u){const f=this.layers[0],_=[];let x=null;"circle"===f.type&&(x=f.layout.get("circle-sort-key"));for(const{feature:T,id:F,index:V,sourceLayerIndex:j}of e){const q=this.layers[0]._featureFilter.needGeometry,J=Gc(T,q);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),J,s))continue;const le=x?x.evaluate(J,{},s):void 0,Ee={id:F,properties:T.properties,type:T.type,sourceLayerIndex:j,index:V,geometry:q?J.geometry:ic(T,s,u),patterns:{},sortKey:le};_.push(Ee)}x&&_.sort((T,F)=>T.sortKey-F.sortKey);let C=null;"globe"===u.projection.name&&(this.globeExtVertexArray=new Nn,C=u.projection);for(const T of _){const{geometry:F,index:V,sourceLayerIndex:j}=T,q=e[V].feature;this.addFeature(T,F,V,r.availableImages,s,C),r.featureIndex.insert(q,F,V,j,this.index)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ch.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,T_.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,s,u,f,_){for(const x of r)for(const C of x){const T=C.x,F=C.y;if(T<0||T>=Pr||F<0||F>=Pr)continue;if(_){const q=_.projectTilePoint(T,F,f),J=_.upVector(f,T,F),le=this.globeExtVertexArray;Wu(le,q,J),Wu(le,q,J),Wu(le,q,J),Wu(le,q,J)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),j=V.vertexLength;Rd(this.layoutVertexArray,T,F,-1,-1),Rd(this.layoutVertexArray,T,F,1,-1),Rd(this.layoutVertexArray,T,F,1,1),Rd(this.layoutVertexArray,T,F,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u,f)}}function Od(n,e){for(let r=0;r<n.length;r++)if(Wc(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(Wc(n,e[r]))return!0;return!!qu(n,e)}function kd(n,e,r){return!!Wc(n,e)||!!Ld(e,n,r)}function Qf(n,e){if(1===n.length)return Pm(e,n[0]);for(let r=0;r<e.length;r++){const s=e[r];for(let u=0;u<s.length;u++)if(Wc(n,s[u]))return!0}for(let r=0;r<n.length;r++)if(Pm(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(qu(n,e[r]))return!0;return!1}function ep(n,e,r){if(n.length>1){if(qu(n,e))return!0;for(let s=0;s<e.length;s++)if(Ld(e[s],n,r))return!0}for(let s=0;s<n.length;s++)if(Ld(n[s],e,r))return!0;return!1}function qu(n,e){if(0===n.length||0===e.length)return!1;for(let r=0;r<n.length-1;r++){const s=n[r],u=n[r+1];for(let f=0;f<e.length-1;f++)if(Am(s,u,e[f],e[f+1]))return!0}return!1}function Am(n,e,r,s){return Fn(n,r,s)!==Fn(e,r,s)&&Fn(n,e,r)!==Fn(n,e,s)}function Ld(n,e,r){const s=r*r;if(1===e.length)return n.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(Zu(n,e[u-1],e[u])<s)return!0;return!1}function Zu(n,e,r){const s=e.distSqr(r);if(0===s)return n.distSqr(e);const u=((n.x-e.x)*(r.x-e.x)+(n.y-e.y)*(r.y-e.y))/s;return n.distSqr(u<0?e:u>1?r:r.sub(e)._mult(u)._add(e))}function Pm(n,e){let r,s,u,f=!1;for(let _=0;_<n.length;_++){r=n[_];for(let x=0,C=r.length-1;x<r.length;C=x++)s=r[x],u=r[C],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(f=!f)}return f}function Wc(n,e){let r=!1;for(let s=0,u=n.length-1;s<n.length;u=s++){const f=n[s],_=n[u];f.y>e.y!=_.y>e.y&&e.x<(_.x-f.x)*(e.y-f.y)/(_.y-f.y)+f.x&&(r=!r)}return r}function Rm(n,e,r,s,u){for(const _ of n)if(e<=_.x&&r<=_.y&&s>=_.x&&u>=_.y)return!0;const f=[new Ie(e,r),new Ie(e,u),new Ie(s,u),new Ie(s,r)];if(n.length>2)for(const _ of f)if(Wc(n,_))return!0;for(let _=0;_<n.length-1;_++)if(P_(n[_],n[_+1],f))return!0;return!1}function P_(n,e,r){const s=r[0],u=r[2];if(n.x<s.x&&e.x<s.x||n.x>u.x&&e.x>u.x||n.y<s.y&&e.y<s.y||n.y>u.y&&e.y>u.y)return!1;const f=Fn(n,e,r[0]);return f!==Fn(n,e,r[1])||f!==Fn(n,e,r[2])||f!==Fn(n,e,r[3])}function Yu(n,e,r){const s=e.paint.get(n).value;return"constant"===s.kind?s.value:r.programConfigurations.get(e.id).getMaxValue(n)}function Fd(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function tp(n,e,r,s,u){if(!e[0]&&!e[1])return n;const f=Ie.convert(e)._mult(u);"viewport"===r&&f._rotate(-s);const _=[];for(let x=0;x<n.length;x++)_.push(n[x].sub(f));return _}function Bd(n,e,r,s){const u=Ie.convert(n)._mult(s);return"viewport"===e&&u._rotate(-r),u}E(Vh,"CircleBucket",{omit:["layers"]});const np=new Ve({"circle-sort-key":new Te(on.layout_circle["circle-sort-key"])});var Xu={paint:new Ve({"circle-radius":new Te(on.paint_circle["circle-radius"]),"circle-color":new Te(on.paint_circle["circle-color"]),"circle-blur":new Te(on.paint_circle["circle-blur"]),"circle-opacity":new Te(on.paint_circle["circle-opacity"]),"circle-translate":new ae(on.paint_circle["circle-translate"]),"circle-translate-anchor":new ae(on.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ae(on.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ae(on.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Te(on.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Te(on.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Te(on.paint_circle["circle-stroke-opacity"])}),layout:np};function Om(n,e,r,s,u,f,_,x,C){if(f&&n.queryGeometry.isAboveHorizon)return!1;f&&(C*=n.pixelToTileUnitsFactor);const T=n.tileID.canonical,F=r.projection.upVectorScale(T,r.center.lat,r.worldSize).metersToTile;for(const V of e)for(const j of V){const q=j.add(x),J=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(q.x,q.y,!0):0,le=r.projection.projectTilePoint(q.x,q.y,T);if(J>0){const je=r.projection.upVector(T,q.x,q.y);le.x+=je[0]*F*J,le.y+=je[1]*F*J,le.z+=je[2]*F*J}const Ee=f?q:R_(le.x,le.y,le.z,s),Ue=f?n.tilespaceRays.map(je=>rp(je,J)):n.queryGeometry.screenGeometry,rt=zc([],[le.x,le.y,le.z,1],s);if(!_&&f?C*=rt[3]/r.cameraToCenterDistance:_&&!f&&(C*=r.cameraToCenterDistance/rt[3]),f){const je=Us((j.y/Pr+T.y)/(1<<T.z));C/=r.projection.pixelsPerMeter(je,1)/Ga(1,je)}if(kd(Ue,Ee,C))return!0}return!1}function R_(n,e,r,s){const u=zc([],[n,e,r,1],s);return new Ie(u[0]/u[3],u[1]/u[3])}const O_=Ed(0,0,0),k_=Ed(0,0,1);function rp(n,e){const r=Ih();return O_[2]=e,n.intersectsPlane(O_,k_,r),new Ie(r[0],r[1])}class km extends Vh{}function xu(n,{width:e,height:r},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*r*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*r*s);return n.width=e,n.height=r,n.data=u,n}function Nd(n,e,r){const{width:s,height:u}=e;s===n.width&&u===n.height||(zd(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,s),height:Math.min(n.height,u)},r),n.width=s,n.height=u,n.data=e.data)}function zd(n,e,r,s,u,f){if(0===u.width||0===u.height)return e;if(u.width>n.width||u.height>n.height||r.x>n.width-u.width||r.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const _=n.data,x=e.data;for(let C=0;C<u.height;C++){const T=((r.y+C)*n.width+r.x)*f,F=((s.y+C)*e.width+s.x)*f;for(let V=0;V<u.width*f;V++)x[F+V]=_[T+V]}return e}E(km,"HeatmapBucket",{omit:["layers"]});class oc{constructor(e,r){xu(this,e,1,r)}resize(e){Nd(this,new oc(e),1)}clone(){return new oc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,f){zd(e,r,s,u,f,1)}}class Pa{constructor(e,r){xu(this,e,4,r)}resize(e){Nd(this,new Pa(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Pa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,f){zd(e,r,s,u,f,4)}}E(oc,"AlphaImage"),E(Pa,"RGBAImage");var Lm={paint:new Ve({"heatmap-radius":new Te(on.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Te(on.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ae(on.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ge(on.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ae(on.paint_heatmap["heatmap-opacity"])})};function Uh(n){const e={},r=n.resolution||256,s=n.clips?n.clips.length:1,u=n.image||new Pa({width:r,height:s}),f=(_,x,C)=>{e[n.evaluationKey]=C;const T=n.expression.evaluate(e);u.data[_+x+0]=Math.floor(255*T.r/T.a),u.data[_+x+1]=Math.floor(255*T.g/T.a),u.data[_+x+2]=Math.floor(255*T.b/T.a),u.data[_+x+3]=Math.floor(255*T.a)};if(n.clips)for(let _=0,x=0;_<s;++_,x+=4*r)for(let C=0,T=0;C<r;C++,T+=4){const F=C/(r-1),{start:V,end:j}=n.clips[_];f(x,T,V*(1-F)+j*F)}else for(let _=0,x=0;_<r;_++,x+=4)f(0,x,_/(r-1));return u}var L_={paint:new Ve({"hillshade-illumination-direction":new ae(on.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ae(on.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ae(on.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ae(on.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ae(on.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ae(on.paint_hillshade["hillshade-accent-color"])})};const F_=Tt([{name:"a_pos",components:2,type:"Int16"}],4),{members:B_}=F_;var ip={exports:{}};function jh(n,e,r){r=r||2;var s,u,f,_,x,C,T,F=e&&e.length,V=F?e[0]*r:n.length,j=vc(n,0,V,r,!0),q=[];if(!j||j.next===j.prev)return q;if(F&&(j=function(le,Ee,Ue,rt){var je,it,ft,ht=[];for(je=0,it=Ee.length;je<it;je++)(ft=vc(le,Ee[je]*rt,je<it-1?Ee[je+1]*rt:le.length,rt,!1))===ft.next&&(ft.steiner=!0),ht.push(z_(ft));for(ht.sort(Tv),je=0;je<ht.length;je++)Ue=Fm(ht[je],Ue);return Ue}(n,e,j,r)),n.length>80*r){s=f=n[0],u=_=n[1];for(var J=r;J<V;J+=r)(x=n[J])<s&&(s=x),(C=n[J+1])<u&&(u=C),x>f&&(f=x),C>_&&(_=C);T=0!==(T=Math.max(f-s,_-u))?32767/T:0}return $d(j,q,r,s,u,T,0),q}function vc(n,e,r,s,u){var f,_;if(u===Bm(n,e,r,s)>0)for(f=e;f<r;f+=s)_=V_(f,n[f],n[f+1],_);else for(f=r-s;f>=e;f-=s)_=V_(f,n[f],n[f+1],_);return _&&qc(_,_.next)&&(bu(_),_=_.next),_}function Ol(n,e){if(!n)return n;e||(e=n);var r,s=n;do{if(r=!1,s.steiner||!qc(s,s.next)&&0!==yo(s.prev,s,s.next))s=s.next;else{if(bu(s),(s=e=s.prev)===s.next)break;r=!0}}while(r||s!==e);return e}function $d(n,e,r,s,u,f,_){if(n){!_&&f&&function(F,V,j,q){var J=F;do{0===J.z&&(J.z=op(J.x,J.y,V,j,q)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next}while(J!==F);J.prevZ.nextZ=null,J.prevZ=null,function(le){var Ee,Ue,rt,je,it,ft,ht,Yt,Ut=1;do{for(Ue=le,le=null,it=null,ft=0;Ue;){for(ft++,rt=Ue,ht=0,Ee=0;Ee<Ut&&(ht++,rt=rt.nextZ);Ee++);for(Yt=Ut;ht>0||Yt>0&&rt;)0!==ht&&(0===Yt||!rt||Ue.z<=rt.z)?(je=Ue,Ue=Ue.nextZ,ht--):(je=rt,rt=rt.nextZ,Yt--),it?it.nextZ=je:le=je,je.prevZ=it,it=je;Ue=rt}it.nextZ=null,Ut*=2}while(ft>1)}(J)}(n,s,u,f);for(var x,C,T=n;n.prev!==n.next;)if(x=n.prev,C=n.next,f?Ev(n,s,u,f):wv(n))e.push(x.i/r|0),e.push(n.i/r|0),e.push(C.i/r|0),bu(n),n=C.next,T=C.next;else if((n=C)===T){_?1===_?$d(n=Dv(Ol(n),e,r),e,r,s,u,f,2):2===_&&Cv(n,e,r,s,u,f):$d(Ol(n),e,r,s,u,f,1);break}}}function wv(n){var e=n.prev,r=n,s=n.next;if(yo(e,r,s)>=0)return!1;for(var u=e.x,f=r.x,_=s.x,x=e.y,C=r.y,T=s.y,F=u<f?u<_?u:_:f<_?f:_,V=x<C?x<T?x:T:C<T?C:T,j=u>f?u>_?u:_:f>_?f:_,q=x>C?x>T?x:T:C>T?C:T,J=s.next;J!==e;){if(J.x>=F&&J.x<=j&&J.y>=V&&J.y<=q&&Ku(u,x,f,C,_,T,J.x,J.y)&&yo(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Ev(n,e,r,s){var u=n.prev,f=n,_=n.next;if(yo(u,f,_)>=0)return!1;for(var x=u.x,C=f.x,T=_.x,F=u.y,V=f.y,j=_.y,q=x<C?x<T?x:T:C<T?C:T,J=F<V?F<j?F:j:V<j?V:j,le=x>C?x>T?x:T:C>T?C:T,Ee=F>V?F>j?F:j:V>j?V:j,Ue=op(q,J,e,r,s),rt=op(le,Ee,e,r,s),je=n.prevZ,it=n.nextZ;je&&je.z>=Ue&&it&&it.z<=rt;){if(je.x>=q&&je.x<=le&&je.y>=J&&je.y<=Ee&&je!==u&&je!==_&&Ku(x,F,C,V,T,j,je.x,je.y)&&yo(je.prev,je,je.next)>=0||(je=je.prevZ,it.x>=q&&it.x<=le&&it.y>=J&&it.y<=Ee&&it!==u&&it!==_&&Ku(x,F,C,V,T,j,it.x,it.y)&&yo(it.prev,it,it.next)>=0))return!1;it=it.nextZ}for(;je&&je.z>=Ue;){if(je.x>=q&&je.x<=le&&je.y>=J&&je.y<=Ee&&je!==u&&je!==_&&Ku(x,F,C,V,T,j,je.x,je.y)&&yo(je.prev,je,je.next)>=0)return!1;je=je.prevZ}for(;it&&it.z<=rt;){if(it.x>=q&&it.x<=le&&it.y>=J&&it.y<=Ee&&it!==u&&it!==_&&Ku(x,F,C,V,T,j,it.x,it.y)&&yo(it.prev,it,it.next)>=0)return!1;it=it.nextZ}return!0}function Dv(n,e,r){var s=n;do{var u=s.prev,f=s.next.next;!qc(u,f)&&ap(u,s,s.next,f)&&Hh(u,f)&&Hh(f,u)&&(e.push(u.i/r|0),e.push(s.i/r|0),e.push(f.i/r|0),bu(s),bu(s.next),s=n=f),s=s.next}while(s!==n);return Ol(s)}function Cv(n,e,r,s,u,f){var _=n;do{for(var x=_.next.next;x!==_.prev;){if(_.i!==x.i&&sp(_,x)){var C=$_(_,x);return _=Ol(_,_.next),C=Ol(C,C.next),$d(_,e,r,s,u,f,0),void $d(C,e,r,s,u,f,0)}x=x.next}_=_.next}while(_!==n)}function Tv(n,e){return n.x-e.x}function Fm(n,e){var r=function(u,f){var _,x=f,C=u.x,T=u.y,F=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var V=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(V<=C&&V>F&&(F=V,_=x.x<x.next.x?x:x.next,V===C))return _}x=x.next}while(x!==f);if(!_)return null;var j,q=_,J=_.x,le=_.y,Ee=1/0;x=_;do{C>=x.x&&x.x>=J&&C!==x.x&&Ku(T<le?C:F,T,J,le,T<le?F:C,T,x.x,x.y)&&(j=Math.abs(T-x.y)/(C-x.x),Hh(x,u)&&(j<Ee||j===Ee&&(x.x>_.x||x.x===_.x&&N_(_,x)))&&(_=x,Ee=j)),x=x.next}while(x!==q);return _}(n,e);if(!r)return e;var s=$_(r,n);return Ol(s,s.next),Ol(r,r.next)}function N_(n,e){return yo(n.prev,n,e.prev)<0&&yo(e.next,n,n.next)<0}function op(n,e,r,s,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function z_(n){var e=n,r=n;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==n);return r}function Ku(n,e,r,s,u,f,_,x){return(u-_)*(e-x)>=(n-_)*(f-x)&&(n-_)*(s-x)>=(r-_)*(e-x)&&(r-_)*(f-x)>=(u-_)*(s-x)}function sp(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(r,s){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==s.i&&u.next.i!==s.i&&ap(u,u.next,r,s))return!0;u=u.next}while(u!==r);return!1}(n,e)&&(Hh(n,e)&&Hh(e,n)&&function(r,s){var u=r,f=!1,_=(r.x+s.x)/2,x=(r.y+s.y)/2;do{u.y>x!=u.next.y>x&&u.next.y!==u.y&&_<(u.next.x-u.x)*(x-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next}while(u!==r);return f}(n,e)&&(yo(n.prev,n,e.prev)||yo(n,e.prev,e))||qc(n,e)&&yo(n.prev,n,n.next)>0&&yo(e.prev,e,e.next)>0)}function yo(n,e,r){return(e.y-n.y)*(r.x-e.x)-(e.x-n.x)*(r.y-e.y)}function qc(n,e){return n.x===e.x&&n.y===e.y}function ap(n,e,r,s){var u=Ud(yo(n,e,r)),f=Ud(yo(n,e,s)),_=Ud(yo(r,s,n)),x=Ud(yo(r,s,e));return u!==f&&_!==x||!(0!==u||!Vd(n,r,e))||!(0!==f||!Vd(n,s,e))||!(0!==_||!Vd(r,n,s))||!(0!==x||!Vd(r,e,s))}function Vd(n,e,r){return e.x<=Math.max(n.x,r.x)&&e.x>=Math.min(n.x,r.x)&&e.y<=Math.max(n.y,r.y)&&e.y>=Math.min(n.y,r.y)}function Ud(n){return n>0?1:n<0?-1:0}function Hh(n,e){return yo(n.prev,n,n.next)<0?yo(n,e,n.next)>=0&&yo(n,n.prev,e)>=0:yo(n,e,n.prev)<0||yo(n,n.next,e)<0}function $_(n,e){var r=new jd(n.i,n.x,n.y),s=new jd(e.i,e.x,e.y),u=n.next,f=e.prev;return n.next=e,e.prev=n,r.next=u,u.prev=r,s.next=r,r.prev=s,f.next=s,s.prev=f,s}function V_(n,e,r,s){var u=new jd(n,e,r);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function bu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function jd(n,e,r){this.i=n,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bm(n,e,r,s){for(var u=0,f=e,_=r-s;f<r;f+=s)u+=(n[_]-n[f])*(n[f+1]+n[_+1]),_=f;return u}ip.exports=jh,ip.exports.default=jh,jh.deviation=function(n,e,r,s){var u=e&&e.length,f=Math.abs(Bm(n,0,u?e[0]*r:n.length,r));if(u)for(var _=0,x=e.length;_<x;_++)f-=Math.abs(Bm(n,e[_]*r,_<x-1?e[_+1]*r:n.length,r));var C=0;for(_=0;_<s.length;_+=3){var T=s[_]*r,F=s[_+1]*r,V=s[_+2]*r;C+=Math.abs((n[T]-n[V])*(n[F+1]-n[T+1])-(n[T]-n[F])*(n[V+1]-n[T+1]))}return 0===f&&0===C?0:Math.abs((C-f)/f)},jh.flatten=function(n){for(var e=n[0][0].length,r={vertices:[],holes:[],dimensions:e},s=0,u=0;u<n.length;u++){for(var f=0;f<n[u].length;f++)for(var _=0;_<e;_++)r.vertices.push(n[u][f][_]);u>0&&r.holes.push(s+=n[u-1].length)}return r};var Nm=xt(ip.exports);function zm(n,e,r,s,u){$m(n,e,r||0,s||n.length-1,u||U_)}function $m(n,e,r,s,u){for(;s>r;){if(s-r>600){var f=s-r+1,_=e-r+1,x=Math.log(f),C=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*C*(f-C)/f)*(_-f/2<0?-1:1);$m(n,e,Math.max(r,Math.floor(e-_*C/f+T)),Math.min(s,Math.floor(e+(f-_)*C/f+T)),u)}var F=n[e],V=r,j=s;for(Hd(n,r,e),u(n[s],F)>0&&Hd(n,r,s);V<j;){for(Hd(n,V,j),V++,j--;u(n[V],F)<0;)V++;for(;u(n[j],F)>0;)j--}0===u(n[r],F)?Hd(n,r,j):Hd(n,++j,s),j<=e&&(r=j+1),e<=j&&(s=j-1)}}function Hd(n,e,r){var s=n[e];n[e]=n[r],n[r]=s}function U_(n,e){return n<e?-1:n>e?1:0}function lp(n,e){const r=n.length;if(r<=1)return[n];const s=[];let u,f;for(let _=0;_<r;_++){const x=pr(n[_]);0!==x&&(n[_].area=Math.abs(x),void 0===f&&(f=x<0),f===x<0?(u&&s.push(u),u=[n[_]]):u.push(n[_]))}if(u&&s.push(u),e>1)for(let _=0;_<s.length;_++)s[_].length<=e||(zm(s[_],e,1,s[_].length-1,Vm),s[_]=s[_].slice(0,e));return s}function Vm(n,e){return e.area-n.area}function Ju(n,e,r){const s=r.patternDependencies;let u=!1;for(const f of e){const _=f.paint.get(`${n}-pattern`);_.isConstant()||(u=!0);const x=_.constantOr(null);x&&(u=!0,s[x]=!0)}return u}function cp(n,e,r,s,u){const f=u.patternDependencies;for(const _ of e){const x=_.paint.get(`${n}-pattern`).value;if("constant"!==x.kind){let C=x.evaluate({zoom:s},r,{},u.availableImages);C=C&&C.name?C.name:C,f[C]=!0,r.patterns[_.id]=C}}return r}class Qu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Rn,this.indexArray=new xr,this.indexArray2=new zs,this.programConfigurations=new uu(e.layers,e.zoom),this.segments=new fs,this.segments2=new fs,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,s,u){this.hasPattern=Ju("fill",this.layers,r);const f=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:x,id:C,index:T,sourceLayerIndex:F}of e){const V=this.layers[0]._featureFilter.needGeometry,j=Gc(x,V);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),j,s))continue;const q=f?f.evaluate(j,{},s,r.availableImages):void 0,J={id:C,properties:x.properties,type:x.type,sourceLayerIndex:F,index:T,geometry:V?j.geometry:ic(x,s,u),patterns:{},sortKey:q};_.push(J)}f&&_.sort((x,C)=>x.sortKey-C.sortKey);for(const x of _){const{geometry:C,index:T,sourceLayerIndex:F}=x;if(this.hasPattern){const V=cp("fill",this.layers,x,this.zoom,r);this.patternFeatures.push(V)}else this.addFeature(x,C,T,s,{},r.availableImages);r.featureIndex.insert(e[T].feature,C,T,F,this.index)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}addFeatures(e,r,s,u,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,r,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,B_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,s,u,f,_=[]){for(const x of lp(r,500)){let C=0;for(const J of x)C+=J.length;const T=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),F=T.vertexLength,V=[],j=[];for(const J of x){if(0===J.length)continue;J!==x[0]&&j.push(V.length/2);const le=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),Ee=le.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(Ee+J.length-1,Ee),V.push(J[0].x),V.push(J[0].y);for(let Ue=1;Ue<J.length;Ue++)this.layoutVertexArray.emplaceBack(J[Ue].x,J[Ue].y),this.indexArray2.emplaceBack(Ee+Ue-1,Ee+Ue),V.push(J[Ue].x),V.push(J[Ue].y);le.vertexLength+=J.length,le.primitiveLength+=J.length}const q=Nm(V,j);for(let J=0;J<q.length;J+=3)this.indexArray.emplaceBack(F+q[J],F+q[J+1],F+q[J+2]);T.vertexLength+=C,T.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,_,u)}}E(Qu,"FillBucket",{omit:["layers","patternFeatures"]});const j_=new Ve({"fill-sort-key":new Te(on.layout_fill["fill-sort-key"])});var ed={paint:new Ve({"fill-antialias":new ae(on.paint_fill["fill-antialias"]),"fill-opacity":new Te(on.paint_fill["fill-opacity"]),"fill-color":new Te(on.paint_fill["fill-color"]),"fill-outline-color":new Te(on.paint_fill["fill-outline-color"]),"fill-translate":new ae(on.paint_fill["fill-translate"]),"fill-translate-anchor":new ae(on.paint_fill["fill-translate-anchor"]),"fill-pattern":new Te(on.paint_fill["fill-pattern"])}),layout:j_};const H_=Tt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),G_=Tt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Um=Tt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:jm}=H_;var Gh={},W_=Pt,Hm=td;function td(n,e,r,s,u){this.properties={},this.extent=r,this.type=0,this._pbf=n,this._geometry=-1,this._keys=s,this._values=u,n.readFields(Gm,this,e)}function Gm(n,e,r){1==n?e.id=r.readVarint():2==n?function(s,u){for(var f=s.readVarint()+s.pos;s.pos<f;){var _=u._keys[s.readVarint()],x=u._values[s.readVarint()];u.properties[_]=x}}(r,e):3==n?e.type=r.readVarint():4==n&&(e._geometry=r.pos)}function Sv(n){for(var e,r,s=0,u=0,f=n.length,_=f-1;u<f;_=u++)s+=((r=n[_]).x-(e=n[u]).x)*(e.y+r.y);return s}td.types=["Unknown","Point","LineString","Polygon"],td.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,r=n.readVarint()+n.pos,s=1,u=0,f=0,_=0,x=[];n.pos<r;){if(u<=0){var C=n.readVarint();s=7&C,u=C>>3}if(u--,1===s||2===s)f+=n.readSVarint(),_+=n.readSVarint(),1===s&&(e&&x.push(e),e=[]),e.push(new W_(f,_));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&x.push(e),x},td.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,r=1,s=0,u=0,f=0,_=1/0,x=-1/0,C=1/0,T=-1/0;n.pos<e;){if(s<=0){var F=n.readVarint();r=7&F,s=F>>3}if(s--,1===r||2===r)(u+=n.readSVarint())<_&&(_=u),u>x&&(x=u),(f+=n.readSVarint())<C&&(C=f),f>T&&(T=f);else if(7!==r)throw new Error("unknown command "+r)}return[_,C,x,T]},td.prototype.toGeoJSON=function(n,e,r){var s,u,f=this.extent*Math.pow(2,r),_=this.extent*n,x=this.extent*e,C=this.loadGeometry(),T=td.types[this.type];function F(q){for(var J=0;J<q.length;J++){var le=q[J];q[J]=[360*(le.x+_)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+x)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(s=0;s<C.length;s++)V[s]=C[s][0];F(C=V);break;case 2:for(s=0;s<C.length;s++)F(C[s]);break;case 3:for(C=function(q){var J=q.length;if(J<=1)return[q];for(var le,Ee,Ue=[],rt=0;rt<J;rt++){var je=Sv(q[rt]);0!==je&&(void 0===Ee&&(Ee=je<0),Ee===je<0?(le&&Ue.push(le),le=[q[rt]]):le.push(q[rt]))}return le&&Ue.push(le),Ue}(C),s=0;s<C.length;s++)for(u=0;u<C[s].length;u++)F(C[s][u])}1===C.length?C=C[0]:T="Multi"+T;var j={type:"Feature",geometry:{type:T,coordinates:C},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Iv=Hm,nd=po;function po(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(Gd,this,e),this.length=this._features.length}function Gd(n,e,r){15===n?e.version=r.readVarint():1===n?e.name=r.readString():5===n?e.extent=r.readVarint():2===n?e._features.push(r.pos):3===n?e._keys.push(r.readString()):4===n&&e._values.push(function(s){for(var u=null,f=s.readVarint()+s.pos;s.pos<f;){var _=s.readVarint()>>3;u=1===_?s.readString():2===_?s.readFloat():3===_?s.readDouble():4===_?s.readVarint64():5===_?s.readVarint():6===_?s.readSVarint():7===_?s.readBoolean():null}return u}(r))}po.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new Iv(this._pbf,e,this.extent,this._keys,this._values)};var Wm=nd;function qm(n,e,r){if(3===n){var s=new Wm(r,r.readVarint()+r.pos);s.length&&(e[s.name]=s)}}var Wd=Gh.VectorTile=function(n,e){this.layers=n.readFields(qm,{},e)},rd=Gh.VectorTileFeature=Hm;function Wh(n,e,r,s){const u=[],f=0===s?(_,x,C,T,F,V)=>{_.push(new Ie(V,C+(V-x)/(T-x)*(F-C)))}:(_,x,C,T,F,V)=>{_.push(new Ie(x+(V-C)/(F-C)*(T-x),V))};for(const _ of n){const x=[];for(const C of _){if(C.length<=2)continue;const T=[];for(let j=0;j<C.length-1;j++){const q=C[j].x,J=C[j].y,le=C[j+1].x,Ee=C[j+1].y,Ue=0===s?q:J,rt=0===s?le:Ee;Ue<e?rt>e&&f(T,q,J,le,Ee,e):Ue>r?rt<r&&f(T,q,J,le,Ee,r):T.push(C[j]),rt<e&&Ue>=e&&f(T,q,J,le,Ee,e),rt>r&&Ue<=r&&f(T,q,J,le,Ee,r)}let F=C[C.length-1];const V=0===s?F.x:F.y;V>=e&&V<=r&&T.push(F),T.length&&(F=T[T.length-1],T[0].x===F.x&&T[0].y===F.y||T.push(T[0]),x.push(T))}x.length&&u.push(x)}return u}Gh.VectorTileLayer=nd;const Zm=rd.types,Ym=Math.pow(2,13);function Zc(n,e,r,s,u,f,_,x){n.emplaceBack((e<<1)+_,(r<<1)+f,(Math.floor(s*Ym)<<1)+u,Math.round(x))}function qh(n,e,r){n.emplaceBack(e.x,e.y,e.z,16384*r[0],16384*r[1],16384*r[2])}class Zh{constructor(){this.acc=new Ie(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ie(e.x,e.y),this.max=new Ie(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,u=this.max;e.x<s.x?s.x=e.x:e.x>u.x&&(u.x=e.x),e.y<s.y?s.y=e.y:e.y>u.y&&(u.y=e.y),((0===e.x||e.x===Pr)&&e.x===r.x)!=((0===e.y||e.y===Pr)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,K(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>Pr!=e.x>Pr&&this.addBorderIntersection(1,K(r.y,e.y,(Pr-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,K(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>Pr!=e.y>Pr&&this.addBorderIntersection(3,K(r.x,e.x,(Pr-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];r<s[0]&&(s[0]=r),r>s[1]&&(s[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,r.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,r.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((r,s)=>r+s.edges,0);return 0!==e?this.acc.div(e)._round():new Ie(0,0)}span(){return new Ie(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class qd{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Dn,this.centroidVertexArray=new Jl,this.indexArray=new xr,this.programConfigurations=new uu(e.layers,e.zoom),this.segments=new fs,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,s,u){this.features=[],this.hasPattern=Ju("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const _=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*_/(_*_+1)/Pr/(1<<f.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:_,index:x,sourceLayerIndex:C}of e){const T=this.layers[0]._featureFilter.needGeometry,F=Gc(f,T);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),F,s))continue;const V={id:_,sourceLayerIndex:C,index:x,geometry:T?F.geometry:ic(f,s,u),properties:f.properties,type:f.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(cp("fill-extrusion",this.layers,V,this.zoom,r)):this.addFeature(V,V.geometry,x,s,{},r.availableImages,u),r.featureIndex.insert(f,V.geometry,x,C,this.index,j)}this.sortBorders()}addFeatures(e,r,s,u,f){for(const _ of this.features){const{geometry:x}=_;this.addFeature(_,x,_.index,r,s,u,f)}this.sortBorders()}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Um.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,G_.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,s,u,f,_,x){const C=[new Ie(0,0),new Ie(Pr,Pr)],T=x.projection,F="globe"===T.name,V=this.enableTerrain&&!F?new Zh:null,j="Polygon"===Zm[e.type];F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Nn);const q=lp(r,500);for(let Ue=q.length-1;Ue>=0;Ue--){const rt=q[Ue];(0===rt.length||(J=rt[0]).every(je=>je.x<=0)||J.every(je=>je.x>=Pr)||J.every(je=>je.y<=0)||J.every(je=>je.y>=Pr))&&q.splice(Ue,1)}var J;let le;if(F)le=Jm(q,C,u);else{le=[];for(const Ue of q)le.push({polygon:Ue,bounds:C})}const Ee=j?this.edgeRadius:0;for(const{polygon:Ue,bounds:rt}of le){let je=0,it=0;for(const ht of Ue)j&&!ht[0].equals(ht[ht.length-1])&&ht.push(ht[0]),it+=j?ht.length-1:ht.length;const ft=this.segments.prepareSegment((j?5:4)*it,this.layoutVertexArray,this.indexArray);if(j){const ht=[],Yt=[];je=ft.vertexLength;for(const hn of Ue){let kn,tn;hn.length&&hn!==Ue[0]&&Yt.push(ht.length/2),kn=hn[1].sub(hn[0])._perp()._unit();for(let Cn=1;Cn<hn.length;Cn++){const Tn=hn[Cn],On=hn[Cn===hn.length-1?1:Cn+1];let{x:Vn,y:fn}=Tn;if(Ee){tn=On.sub(Tn)._perp()._unit();const tr=kn.add(tn)._unit(),fr=Ee*Math.min(4,1/(kn.x*tr.x+kn.y*tr.y));Vn+=fr*tr.x,fn+=fr*tr.y,kn=tn}Zc(this.layoutVertexArray,Vn,fn,0,0,1,1,0),ft.vertexLength++,ht.push(Tn.x,Tn.y),F&&qh(this.layoutVertexExtArray,T.projectTilePoint(Vn,fn,u),T.upVector(u,Vn,fn))}}const Ut=Nm(ht,Yt);for(let hn=0;hn<Ut.length;hn+=3)this.indexArray.emplaceBack(je+Ut[hn],je+Ut[hn+2],je+Ut[hn+1]),ft.primitiveLength++}for(const ht of Ue){V&&ht.length&&V.startRing(ht[0]);let Yt,Ut,hn,kn=ht.length>4&&Km(ht[ht.length-2],ht[0],ht[1]),tn=Ee?Xm(ht[ht.length-2],ht[0],ht[1],Ee):0;Ut=ht[1].sub(ht[0])._perp()._unit();let Cn=!0;for(let Tn=1,On=0;Tn<ht.length;Tn++){let Vn=ht[Tn-1],fn=ht[Tn];const tr=ht[Tn===ht.length-1?1:Tn+1];if(V&&j&&V.currentPolyCount.top++,Yc(fn,Vn,rt)){Ee&&(Ut=tr.sub(fn)._perp()._unit(),Cn=!Cn);continue}V&&V.append(fn,Vn);const fr=fn.sub(Vn)._perp(),sr=fr.x/(Math.abs(fr.x)+Math.abs(fr.y)),ri=fr.y>0?1:0,Un=Vn.dist(fn);if(On+Un>32768&&(On=0),Ee){hn=tr.sub(fn)._perp()._unit();let si=up(Vn,fn,tr,Yh(Ut,hn),Ee);isNaN(si)&&(si=0);const jr=fn.sub(Vn)._unit();Vn=Vn.add(jr.mult(tn))._round(),fn=fn.add(jr.mult(-si))._round(),tn=si,Ut=hn}const Ir=ft.vertexLength,oi=ht.length>4&&Km(Vn,fn,tr);let Ui=Xh(On,kn,Cn);if(Zc(this.layoutVertexArray,Vn.x,Vn.y,sr,ri,0,0,Ui),Zc(this.layoutVertexArray,Vn.x,Vn.y,sr,ri,0,1,Ui),On+=Un,Ui=Xh(On,oi,!Cn),kn=oi,Zc(this.layoutVertexArray,fn.x,fn.y,sr,ri,0,0,Ui),Zc(this.layoutVertexArray,fn.x,fn.y,sr,ri,0,1,Ui),ft.vertexLength+=4,this.indexArray.emplaceBack(Ir+0,Ir+1,Ir+2),this.indexArray.emplaceBack(Ir+1,Ir+3,Ir+2),ft.primitiveLength+=2,Ee){const si=je+(1===Tn?ht.length-2:Tn-2),jr=1===Tn?je:si+1;if(this.indexArray.emplaceBack(Ir+1,si,Ir+3),this.indexArray.emplaceBack(si,jr,Ir+3),ft.primitiveLength+=2,void 0===Yt&&(Yt=Ir),!Yc(tr,ht[Tn],rt)){const Ao=Tn===ht.length-1?Yt:ft.vertexLength;this.indexArray.emplaceBack(Ir+2,Ir+3,Ao),this.indexArray.emplaceBack(Ir+3,Ao+1,Ao),this.indexArray.emplaceBack(Ir+3,jr,Ao+1),ft.primitiveLength+=3}Cn=!Cn}if(F){const si=this.layoutVertexExtArray,jr=T.projectTilePoint(Vn.x,Vn.y,u),Ao=T.projectTilePoint(fn.x,fn.y,u),ci=T.upVector(u,Vn.x,Vn.y),ai=T.upVector(u,fn.x,fn.y);qh(si,jr,ci),qh(si,jr,ci),qh(si,Ao,ai),qh(si,Ao,ai)}}j&&(je+=ht.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const Ue=V.borders,rt=this.featuresOnBorder.push(V)-1;for(let je=0;je<4;je++)Ue[je][0]!==Number.MAX_VALUE&&this.borders[je].push(rt)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,_,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,s)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,r,s=!0){let u,f;if(e)if(0!==e.y){const x=r.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(x.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+s;let _=s?this.centroidVertexArray.length:r.vertexArrayOffset;for(const x of r.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let C=0;C<x.top;C++)this.centroidVertexArray.emplace(_++,u,f);for(let C=0;C<2*x.edges;C++)this.centroidVertexArray.emplace(_++,0,f),this.centroidVertexArray.emplace(_++,u,f)}}}function Yh(n,e){const r=n.add(e)._unit();return n.x*r.x+n.y*r.y}function Xm(n,e,r,s){const u=e.sub(n)._perp()._unit(),f=r.sub(e)._perp()._unit();return up(n,e,r,Yh(u,f),s)}function up(n,e,r,s,u){const f=Math.sqrt(1-s*s);return Math.min(n.dist(e)/3,e.dist(r)/3,u*f/s)}function Yc(n,e,r){return n.x<r[0].x&&e.x<r[0].x||n.x>r[1].x&&e.x>r[1].x||n.y<r[0].y&&e.y<r[0].y||n.y>r[1].y&&e.y>r[1].y}function Km(n,e,r){if(n.x<0||n.x>=Pr||e.x<0||e.x>=Pr||r.x<0||r.x>=Pr)return!1;const s=r.sub(e),u=s.perp(),f=n.sub(e);return(s.x*f.x+s.y*f.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function Xh(n,e,r){const s=e?2|n:-3&n;return r?1|s:-2&s}function Zd(){const n=Math.PI/32,e=Math.tan(n),r=Ad;return r*Math.sqrt(1+2*e*e)-r}function Jm(n,e,r){const s=1<<r.z,u=Aa(r.x/s),f=Aa((r.x+1)/s),_=Us(r.y/s),x=Us((r.y+1)/s);return function(C,T,F,V,j=0,q){const J=[];if(!C.length||!F||!V)return J;const le=(ht,Yt)=>{for(const Ut of ht)J.push({polygon:Ut,bounds:Yt})},Ee=Math.ceil(Math.log2(F)),Ue=Math.ceil(Math.log2(V)),rt=Ee-Ue,je=[];for(let ht=0;ht<Math.abs(rt);ht++)je.push(rt>0?0:1);for(let ht=0;ht<Math.min(Ee,Ue);ht++)je.push(0),je.push(1);let it=C;if(it=Wh(it,T[0].y-j,T[1].y+j,1),it=Wh(it,T[0].x-j,T[1].x+j,0),!it.length)return J;const ft=[];for(je.length?ft.push({polygons:it,bounds:T,depth:0}):le(it,T);ft.length;){const ht=ft.pop(),Yt=ht.depth,Ut=je[Yt],hn=ht.bounds[0],kn=ht.bounds[1],tn=0===Ut?hn.x:hn.y,Cn=0===Ut?kn.x:kn.y,Tn=q?q(Ut,tn,Cn):.5*(tn+Cn),On=Wh(ht.polygons,tn-j,Tn+j,Ut),Vn=Wh(ht.polygons,Tn-j,Cn+j,Ut);if(On.length){const fn=[hn,new Ie(0===Ut?Tn:kn.x,1===Ut?Tn:kn.y)];je.length>Yt+1?ft.push({polygons:On,bounds:fn,depth:Yt+1}):le(On,fn)}if(Vn.length){const fn=[new Ie(0===Ut?Tn:hn.x,1===Ut?Tn:hn.y),kn];je.length>Yt+1?ft.push({polygons:Vn,bounds:fn,depth:Yt+1}):le(Vn,fn)}}return J}(n,e,Math.ceil((f-u)/11.25),Math.ceil((_-x)/11.25),1,(C,T,F)=>{if(0===C)return.5*(T+F);{const V=Us((r.y+T/Pr)/s);return(Rl(.5*(Us((r.y+F/Pr)/s)+V))*s-r.y)*Pr}})}E(qd,"FillExtrusionBucket",{omit:["layers","features"]}),E(Zh,"PartMetadata");const dp=new Ve({"fill-extrusion-edge-radius":new ae(on["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Kh={paint:new Ve({"fill-extrusion-opacity":new ae(on["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Te(on["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ae(on["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ae(on["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Te(on["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Te(on["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Te(on["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ae(on["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ae(on["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ae(on["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ae(on["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:dp};function kl(n,e,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[n*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class wu{constructor(e,r,s){this.z=e,this.x=r,this.y=s,this.key=Yd(0,e,e,r,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const s=(_=this.y,x=this.z,C=kl(256*(f=this.x),256*(_=Math.pow(2,x)-_-1),x),T=kl(256*(f+1),256*(_+1),x),C[0]+","+C[1]+","+T[0]+","+T[1]),u=function(f,_,x){let C,T="";for(let F=f;F>0;F--)C=1<<F-1,T+=(_&C?1:0)+(x&C?2:0);return T}(this.z,this.x,this.y);var f,_,x,C,T;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Jh{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Yd(e,r.z,r.z,r.x,r.y)}}class ga{constructor(e,r,s,u,f){this.overscaledZ=e,this.wrap=r,this.canonical=new wu(s,+u,+f),this.key=0===r&&e===s?this.canonical.key:Yd(r,e,s,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new ga(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ga(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return Yd(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return Yd(this.wrap*+r,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new ga(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new ga(r,this.wrap,r,s,u),new ga(r,this.wrap,r,s+1,u),new ga(r,this.wrap,r,s,u+1),new ga(r,this.wrap,r,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ga(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ga(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Jh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Yd(n,e,r,s,u){const f=1<<Math.min(r,22);let _=f*(u%f)+s%f;return n&&r<22&&(_+=f*f*((n<0?-2*n-1:2*n)%(1<<2*(22-r)))),16*(32*_+r)+(e-r)}E(wu,"CanonicalTileID"),E(ga,"OverscaledTileID",{omit:["projMatrix"]});class Eu extends Ie{constructor(e,r,s){super(e,r),this.z=s}}function sc(n,e){return n.x*e.x+n.y*e.y}function Qm(n,e){if(1===n.length){let r=0;const s=e[r++];let u;for(;!u||s.equals(u);)if(u=e[r++],!u)return 1/0;for(;r<e.length;r++){const f=e[r],_=n[0],x=u.sub(s),C=f.sub(s),T=_.sub(s),F=sc(x,x),V=sc(x,C),j=sc(C,C),q=sc(T,x),J=sc(T,C),le=F*j-V*V,Ee=(j*q-V*J)/le,Ue=(F*J-V*q)/le,rt=s.z*(1-Ee-Ue)+u.z*Ee+f.z*Ue;if(isFinite(rt))return rt}return 1/0}{let r=1/0;for(const s of e)r=Math.min(r,s.z);return r}}function eg(n,e,r,s,u,f,_,x){const C=_*u.getElevationAt(n,e,!0,!0),T=0!==f[0],F=T?0===f[1]?_*(f[0]/7-450):_*function(V,j,q){const J=Math.floor(j[0]/8),le=Math.floor(j[1]/8),Ee=10*(j[0]-8*J),Ue=10*(j[1]-8*le),rt=V.getElevationAt(J,le,!0,!0),je=V.getMeterToDEM(q),it=Math.floor(.5*(Ee*je-1)),ft=Math.floor(.5*(Ue*je-1)),ht=V.tileCoordToPixel(J,le),Yt=2*it+1,Ut=2*ft+1,hn=(fr=Yt,sr=Ut,[(Vn=V).getElevationAtPixel(fn=ht.x-it,tr=ht.y-ft,!0),Vn.getElevationAtPixel(fn+sr,tr,!0),Vn.getElevationAtPixel(fn,tr+sr,!0),Vn.getElevationAtPixel(fn+fr,tr+sr,!0)]),kn=Math.abs(hn[0]-hn[1]),tn=Math.abs(hn[2]-hn[3]),Cn=Math.abs(hn[0]-hn[2])+Math.abs(hn[1]-hn[3]),Tn=Math.min(.25,.5*je*(kn+tn)/Yt),On=Math.min(.25,.5*je*Cn/Ut);var Vn,fn,tr,fr,sr;return rt+Math.max(Tn*Ee,On*Ue)}(u,f,x):C;return{base:C+(0===r)?-1:r,top:T?Math.max(F+s,C+r+2):C+s}}const q_=Tt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:hp}=q_,tg=Tt([{name:"a_packed",components:4,type:"Float32"}]),{members:Z_}=tg,ng=rd.types,fp=Math.cos(Math.PI/180*37.5);class pp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new sn,this.layoutVertexArray2=new Ln,this.indexArray=new xr,this.programConfigurations=new uu(e.layers,e.zoom),this.segments=new fs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,s,u){this.hasPattern=Ju("line",this.layers,r);const f=this.layers[0].layout.get("line-sort-key"),_=[];for(const{feature:F,id:V,index:j,sourceLayerIndex:q}of e){const J=this.layers[0]._featureFilter.needGeometry,le=Gc(F,J);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),le,s))continue;const Ee=f?f.evaluate(le,{},s):void 0,Ue={id:V,properties:F.properties,type:F.type,sourceLayerIndex:q,index:j,geometry:J?le.geometry:ic(F,s,u),patterns:{},sortKey:Ee};_.push(Ue)}f&&_.sort((F,V)=>F.sortKey-V.sortKey);const{lineAtlas:x,featureIndex:C}=r,T=this.addConstantDashes(x);for(const F of _){const{geometry:V,index:j,sourceLayerIndex:q}=F;if(T&&this.addFeatureDashes(F,x),this.hasPattern){const J=cp("line",this.layers,F,this.zoom,r);this.patternFeatures.push(J)}else this.addFeature(F,V,j,s,x.positions,r.availableImages);C.insert(e[j].feature,V,j,q,this.index)}}addConstantDashes(e){let r=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,f=s.layout.get("line-cap").value;if("constant"!==u.kind||"constant"!==f.kind)r=!0;else{const _=f.value,x=u.value;if(!x)continue;e.addDash(x,_)}}return r}addFeatureDashes(e,r){const s=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,_=u.layout.get("line-cap").value;if("constant"===f.kind&&"constant"===_.kind)continue;let x,C;if("constant"===f.kind){if(x=f.value,!x)continue}else x=f.evaluate({zoom:s},e);C="constant"===_.kind?_.value:_.evaluate({zoom:s},e),r.addDash(x,C),e.patterns[u.id]=r.getKey(x,C)}}update(e,r,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s,u)}addFeatures(e,r,s,u,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,r,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Z_)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,s,u,f,_){const x=this.layers[0].layout,C=x.get("line-join").evaluate(e,{}),T=x.get("line-cap").evaluate(e,{}),F=x.get("line-miter-limit"),V=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const j of r)this.addLine(j,e,C,T,F,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,_,u)}addLine(e,r,s,u,f,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ue=0;Ue<e.length-1;Ue++)this.totalDistance+=e[Ue].dist(e[Ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x="Polygon"===ng[r.type];let C=e.length;for(;C>=2&&e[C-1].equals(e[C-2]);)C--;let T=0;for(;T<C-1&&e[T].equals(e[T+1]);)T++;if(C<(x?3:2))return;"bevel"===s&&(f=1.05);const F=this.overscaling<=16?15*Pr/(512*this.overscaling):0,V=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let j,q,J,le,Ee;this.e1=this.e2=-1,x&&(j=e[C-2],Ee=e[T].sub(j)._unit()._perp());for(let Ue=T;Ue<C;Ue++){if(J=Ue===C-1?x?e[T+1]:void 0:e[Ue+1],J&&e[Ue].equals(J))continue;Ee&&(le=Ee),j&&(q=j),j=e[Ue],Ee=J?J.sub(j)._unit()._perp():le,le=le||Ee;let rt=le.add(Ee);0===rt.x&&0===rt.y||rt._unit();const je=le.x*Ee.x+le.y*Ee.y,it=rt.x*Ee.x+rt.y*Ee.y,ft=0!==it?1/it:1/0,ht=2*Math.sqrt(2-2*it),Yt=it<fp&&q&&J,Ut=le.x*Ee.y-le.y*Ee.x>0;if(Yt&&Ue>T){const tn=j.dist(q);if(tn>2*F){const Cn=j.sub(j.sub(q)._mult(F/tn)._round());this.updateDistance(q,Cn),this.addCurrentVertex(Cn,le,0,0,V),q=Cn}}const hn=q&&J;let kn=hn?s:x?"butt":u;if(hn&&"round"===kn&&(ft<_?kn="miter":ft<=2&&(kn="fakeround")),"miter"===kn&&ft>f&&(kn="bevel"),"bevel"===kn&&(ft>2&&(kn="flipbevel"),ft<f&&(kn="miter")),q&&this.updateDistance(q,j),"miter"===kn)rt._mult(ft),this.addCurrentVertex(j,rt,0,0,V);else if("flipbevel"===kn){if(ft>100)rt=Ee.mult(-1);else{const tn=ft*le.add(Ee).mag()/le.sub(Ee).mag();rt._perp()._mult(tn*(Ut?-1:1))}this.addCurrentVertex(j,rt,0,0,V),this.addCurrentVertex(j,rt.mult(-1),0,0,V)}else if("bevel"===kn||"fakeround"===kn){const tn=-Math.sqrt(ft*ft-1),Cn=Ut?tn:0,Tn=Ut?0:tn;if(q&&this.addCurrentVertex(j,le,Cn,Tn,V),"fakeround"===kn){const On=Math.round(180*ht/Math.PI/20);for(let Vn=1;Vn<On;Vn++){let fn=Vn/On;if(.5!==fn){const fr=fn-.5;fn+=fn*fr*(fn-1)*((1.0904+je*(je*(3.55645-1.43519*je)-3.2452))*fr*fr+(.848013+je*(.215638*je-1.06021)))}const tr=Ee.sub(le)._mult(fn)._add(le)._unit()._mult(Ut?-1:1);this.addHalfVertex(j,tr.x,tr.y,!1,Ut,0,V)}}J&&this.addCurrentVertex(j,Ee,-Cn,-Tn,V)}else if("butt"===kn)this.addCurrentVertex(j,rt,0,0,V);else if("square"===kn){const tn=q?1:-1;q||this.addCurrentVertex(j,rt,tn,tn,V),this.addCurrentVertex(j,rt,0,0,V),q&&this.addCurrentVertex(j,rt,tn,tn,V)}else"round"===kn&&(q&&(this.addCurrentVertex(j,le,0,0,V),this.addCurrentVertex(j,le,1,1,V,!0)),J&&(this.addCurrentVertex(j,Ee,-1,-1,V,!0),this.addCurrentVertex(j,Ee,0,0,V)));if(Yt&&Ue<C-1){const tn=j.dist(J);if(tn>2*F){const Cn=j.add(J.sub(j)._mult(F/tn)._round());this.updateDistance(j,Cn),this.addCurrentVertex(Cn,Ee,0,0,V),j=Cn}}}}addCurrentVertex(e,r,s,u,f,_=!1){const x=r.y*u-r.x,C=-r.y-r.x*u;this.addHalfVertex(e,r.x+r.y*s,r.y-r.x*s,_,!1,s,f),this.addHalfVertex(e,x,C,_,!0,-u,f)}addHalfVertex({x:e,y:r},s,u,f,_,x,C){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(r<<1)+(_?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(0===x?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),C.primitiveLength++),_?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}E(pp,"LineBucket",{omit:["layers","patternFeatures"]});const Y_=new Ve({"line-cap":new Te(on.layout_line["line-cap"]),"line-join":new Te(on.layout_line["line-join"]),"line-miter-limit":new ae(on.layout_line["line-miter-limit"]),"line-round-limit":new ae(on.layout_line["line-round-limit"]),"line-sort-key":new Te(on.layout_line["line-sort-key"])});var rg={paint:new Ve({"line-opacity":new Te(on.paint_line["line-opacity"]),"line-color":new Te(on.paint_line["line-color"]),"line-translate":new ae(on.paint_line["line-translate"]),"line-translate-anchor":new ae(on.paint_line["line-translate-anchor"]),"line-width":new Te(on.paint_line["line-width"]),"line-gap-width":new Te(on.paint_line["line-gap-width"]),"line-offset":new Te(on.paint_line["line-offset"]),"line-blur":new Te(on.paint_line["line-blur"]),"line-dasharray":new Te(on.paint_line["line-dasharray"]),"line-pattern":new Te(on.paint_line["line-pattern"]),"line-gradient":new Ge(on.paint_line["line-gradient"]),"line-trim-offset":new ae(on.paint_line["line-trim-offset"])}),layout:Y_};const ig=new class extends Te{possiblyEvaluate(n,e){return e=new z(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,r,s){return e=Se({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,r,s)}}(rg.paint.properties["line-width"].specification);function X_(n,e){return e>0?e+2*n:n}ig.useIntegerZoom=!0;const Mv=Tt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Qh=Tt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),K_=Tt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Tt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mp=Tt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),gp=Tt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Tt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Du=Tt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_p=Tt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Tt([{name:"triangle",components:3,type:"Uint16"}]),Tt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Tt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Tt([{type:"Float32",name:"offsetX"}]),Tt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Rs=24;const Ra=128;function id(n,e){const{expression:r}=e;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new z(n+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:u}=r;let f=0;for(;f<s.length&&s[f]<=n;)f++;f=Math.max(0,f-1);let _=f;for(;_<s.length&&s[_]<n+1;)_++;_=Math.min(s.length-1,_);const x=s[f],C=s[_];return"composite"===r.kind?{kind:"composite",minZoom:x,maxZoom:C,interpolationType:u}:{kind:"camera",minZoom:x,maxZoom:C,minSize:r.evaluate(new z(x)),maxSize:r.evaluate(new z(C)),interpolationType:u}}}function Xc(n,{uSize:e,uSizeT:r},{lowerSize:s,upperSize:u}){return"source"===n.kind?s/Ra:"composite"===n.kind?K(s/Ra,u/Ra,r):e}function Cu(n,e){let r=0,s=0;if("constant"===n.kind)s=n.layoutSize;else if("source"!==n.kind){const{interpolationType:u,minZoom:f,maxZoom:_}=n,x=u?Vt(Jo.interpolationFactor(u,e,f,_),0,1):0;"camera"===n.kind?s=K(n.minSize,n.maxSize,x):r=x}return{uSizeT:r,uSize:s}}var yp=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ra,evaluateSizeForFeature:Xc,evaluateSizeForZoom:Cu,getSizeData:id});function ef(n,e,r){return n.sections.forEach(s=>{s.text=function(u,f,_){const x=f.layout.get("text-transform").evaluate(_,{});return"uppercase"===x?u=u.toLocaleUpperCase():"lowercase"===x&&(u=u.toLocaleLowerCase()),O.applyArabicShaping&&(u=O.applyArabicShaping(u)),u}(s.text,e,r)}),n}const tf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function vp(n){return"\ufe36"===n||"\ufe48"===n||"\ufe38"===n||"\ufe44"===n||"\ufe42"===n||"\ufe3e"===n||"\ufe3c"===n||"\ufe3a"===n||"\ufe18"===n||"\ufe40"===n||"\ufe10"===n||"\ufe13"===n||"\ufe14"===n||"\uff40"===n||"\uffe3"===n||"\ufe11"===n||"\ufe12"===n}function Xd(n){return"\ufe35"===n||"\ufe47"===n||"\ufe37"===n||"\ufe43"===n||"\ufe41"===n||"\ufe3d"===n||"\ufe3b"===n||"\ufe39"===n||"\ufe17"===n||"\ufe3f"===n}var og=vo,xp=function(n,e,r,s,u){var f,_,x=8*u-s-1,C=(1<<x)-1,T=C>>1,F=-7,V=r?u-1:0,j=r?-1:1,q=n[e+V];for(V+=j,f=q&(1<<-F)-1,q>>=-F,F+=x;F>0;f=256*f+n[e+V],V+=j,F-=8);for(_=f&(1<<-F)-1,f>>=-F,F+=s;F>0;_=256*_+n[e+V],V+=j,F-=8);if(0===f)f=1-T;else{if(f===C)return _?NaN:1/0*(q?-1:1);_+=Math.pow(2,s),f-=T}return(q?-1:1)*_*Math.pow(2,f-s)},sg=function(n,e,r,s,u,f){var _,x,C,T=8*f-u-1,F=(1<<T)-1,V=F>>1,j=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,q=s?0:f-1,J=s?1:-1,le=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(x=isNaN(e)?1:0,_=F):(_=Math.floor(Math.log(e)/Math.LN2),e*(C=Math.pow(2,-_))<1&&(_--,C*=2),(e+=_+V>=1?j/C:j*Math.pow(2,1-V))*C>=2&&(_++,C/=2),_+V>=F?(x=0,_=F):_+V>=1?(x=(e*C-1)*Math.pow(2,u),_+=V):(x=e*Math.pow(2,V-1)*Math.pow(2,u),_=0));u>=8;n[r+q]=255&x,q+=J,x/=256,u-=8);for(_=_<<u|x,T+=u;T>0;n[r+q]=255&_,q+=J,_/=256,T-=8);n[r+q-J]|=128*le};function vo(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}vo.Varint=0,vo.Fixed64=1,vo.Bytes=2,vo.Fixed32=5;var Kd=4294967296,bp=1/Kd,ag=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function xc(n){return n.type===vo.Bytes?n.readVarint()+n.pos:n.pos+1}function lg(n,e,r){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(s);for(var u=r.pos-1;u>=n;u--)r.buf[u+s]=r.buf[u]}function nf(n,e){for(var r=0;r<n.length;r++)e.writeVarint(n[r])}function wp(n,e){for(var r=0;r<n.length;r++)e.writeSVarint(n[r])}function J_(n,e){for(var r=0;r<n.length;r++)e.writeFloat(n[r])}function cg(n,e){for(var r=0;r<n.length;r++)e.writeDouble(n[r])}function Ep(n,e){for(var r=0;r<n.length;r++)e.writeBoolean(n[r])}function rf(n,e){for(var r=0;r<n.length;r++)e.writeFixed32(n[r])}function Q_(n,e){for(var r=0;r<n.length;r++)e.writeSFixed32(n[r])}function ug(n,e){for(var r=0;r<n.length;r++)e.writeFixed64(n[r])}function ey(n,e){for(var r=0;r<n.length;r++)e.writeSFixed64(n[r])}function Qd(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function eh(n,e,r){n[r]=e,n[r+1]=e>>>8,n[r+2]=e>>>16,n[r+3]=e>>>24}function dg(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}vo.prototype={destroy:function(){this.buf=null},readFields:function(n,e,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),u=s>>3,f=this.pos;this.type=7&s,n(u,e,this),this.pos===f&&this.skip(s)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Qd(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=dg(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Qd(this.buf,this.pos)+Qd(this.buf,this.pos+4)*Kd;return this.pos+=8,n},readSFixed64:function(){var n=Qd(this.buf,this.pos)+dg(this.buf,this.pos+4)*Kd;return this.pos+=8,n},readFloat:function(){var n=xp(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=xp(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,r,s=this.buf;return e=127&(r=s[this.pos++]),r<128?e:(e|=(127&(r=s[this.pos++]))<<7,r<128?e:(e|=(127&(r=s[this.pos++]))<<14,r<128?e:(e|=(127&(r=s[this.pos++]))<<21,r<128?e:function(u,f,_){var x,C,T=_.buf;if(x=(112&(C=T[_.pos++]))>>4,C<128||(x|=(127&(C=T[_.pos++]))<<3,C<128)||(x|=(127&(C=T[_.pos++]))<<10,C<128)||(x|=(127&(C=T[_.pos++]))<<17,C<128)||(x|=(127&(C=T[_.pos++]))<<24,C<128)||(x|=(1&(C=T[_.pos++]))<<31,C<128))return function Jd(n,e,r){return r?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}(u,x,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=s[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&ag?ag.decode(this.buf.subarray(e,n)):function(r,s,u){for(var f="",_=s;_<u;){var x,C,T,F=r[_],V=null,j=F>239?4:F>223?3:F>191?2:1;if(_+j>u)break;1===j?F<128&&(V=F):2===j?128==(192&(x=r[_+1]))&&(V=(31&F)<<6|63&x)<=127&&(V=null):3===j?(C=r[_+2],128==(192&(x=r[_+1]))&&128==(192&C)&&((V=(15&F)<<12|(63&x)<<6|63&C)<=2047||V>=55296&&V<=57343)&&(V=null)):4===j&&(C=r[_+2],T=r[_+3],128==(192&(x=r[_+1]))&&128==(192&C)&&128==(192&T)&&((V=(15&F)<<18|(63&x)<<12|(63&C)<<6|63&T)<=65535||V>=1114112)&&(V=null)),null===V?(V=65533,j=1):V>65535&&(V-=65536,f+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),f+=String.fromCharCode(V),_+=j}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==vo.Bytes)return n.push(this.readVarint(e));var r=xc(this);for(n=n||[];this.pos<r;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==vo.Bytes)return n.push(this.readSVarint());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==vo.Bytes)return n.push(this.readBoolean());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==vo.Bytes)return n.push(this.readFloat());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==vo.Bytes)return n.push(this.readDouble());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==vo.Bytes)return n.push(this.readFixed32());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==vo.Bytes)return n.push(this.readSFixed32());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==vo.Bytes)return n.push(this.readFixed64());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==vo.Bytes)return n.push(this.readSFixed64());var e=xc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===vo.Varint)for(;this.buf[this.pos++]>127;);else if(e===vo.Bytes)this.pos=this.readVarint()+this.pos;else if(e===vo.Fixed32)this.pos+=4;else{if(e!==vo.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),eh(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),eh(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),eh(this.buf,-1&n,this.pos),eh(this.buf,Math.floor(n*bp),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),eh(this.buf,-1&n,this.pos),eh(this.buf,Math.floor(n*bp),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,r){var s,u,f,x;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),f=s,(x=r).buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,x.buf[x.pos]=127&(f>>>=7),function(f,_){var x=(7&f)<<4;_.buf[_.pos++]|=x|((f>>>=3)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f)))))}(u,r)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(s,u,f){for(var _,x,C=0;C<u.length;C++){if((_=u.charCodeAt(C))>55295&&_<57344){if(!x){_>56319||C+1===u.length?(s[f++]=239,s[f++]=191,s[f++]=189):x=_;continue}if(_<56320){s[f++]=239,s[f++]=191,s[f++]=189,x=_;continue}_=x-55296<<10|_-56320|65536,x=null}else x&&(s[f++]=239,s[f++]=191,s[f++]=189,x=null);_<128?s[f++]=_:(_<2048?s[f++]=_>>6|192:(_<65536?s[f++]=_>>12|224:(s[f++]=_>>18|240,s[f++]=_>>12&63|128),s[f++]=_>>6&63|128),s[f++]=63&_|128)}return f}(this.buf,n,this.pos);var r=this.pos-e;r>=128&&lg(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(n){this.realloc(4),sg(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),sg(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=n[r]},writeRawMessage:function(n,e){this.pos++;var r=this.pos;n(e,this);var s=this.pos-r;s>=128&&lg(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(n,e,r){this.writeTag(n,vo.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,nf,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,wp,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,Ep,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,J_,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,cg,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,rf,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,Q_,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,ug,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,ey,e)},writeBytesField:function(n,e){this.writeTag(n,vo.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,vo.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,vo.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,vo.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,vo.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,vo.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,vo.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,vo.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,vo.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,vo.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};var Kc=xt(og);const Dp=3;function od(n,e,r){e.glyphs=[],1===n&&r.readMessage(th,e)}function th(n,e,r){if(3===n){const{id:s,bitmap:u,width:f,height:_,left:x,top:C,advance:T}=r.readMessage(ty,{});e.glyphs.push({id:s,bitmap:new oc({width:f+2*Dp,height:_+2*Dp},u),metrics:{width:f,height:_,left:x,top:C,advance:T}})}else 4===n?e.ascender=r.readSVarint():5===n&&(e.descender=r.readSVarint())}function ty(n,e,r){1===n?e.id=r.readVarint():2===n?e.bitmap=r.readBytes():3===n?e.width=r.readVarint():4===n?e.height=r.readVarint():5===n?e.left=r.readSVarint():6===n?e.top=r.readSVarint():7===n&&(e.advance=r.readVarint())}const Cp=Dp;function Tp(n){let e=0,r=0;for(const _ of n)e+=_.w*_.h,r=Math.max(r,_.w);n.sort((_,x)=>x.h-_.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let u=0,f=0;for(const _ of n)for(let x=s.length-1;x>=0;x--){const C=s[x];if(!(_.w>C.w||_.h>C.h)){if(_.x=C.x,_.y=C.y,f=Math.max(f,_.y+_.h),u=Math.max(u,_.x+_.w),_.w===C.w&&_.h===C.h){const T=s.pop();x<s.length&&(s[x]=T)}else _.h===C.h?(C.x+=_.w,C.w-=_.w):_.w===C.w?(C.y+=_.h,C.h-=_.h):(s.push({x:C.x+_.w,y:C.y,w:C.w-_.w,h:_.h}),C.y+=_.h,C.h-=_.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}const Oa=1;class Sp{constructor(e,{pixelRatio:r,version:s,stretchX:u,stretchY:f,content:_}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=u,this.stretchY=f,this.content=_,this.version=s}get tl(){return[this.paddedRect.x+Oa,this.paddedRect.y+Oa]}get br(){return[this.paddedRect.x+this.paddedRect.w-Oa,this.paddedRect.y+this.paddedRect.h-Oa]}get displaySize(){return[(this.paddedRect.w-2*Oa)/this.pixelRatio,(this.paddedRect.h-2*Oa)/this.pixelRatio]}}class Ip{constructor(e,r){const s={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(r,u,f);const{w:_,h:x}=Tp(f),C=new Pa({width:_||1,height:x||1});for(const T in e){const F=e[T],V=s[T].paddedRect;Pa.copy(F.data,C,{x:0,y:0},{x:V.x+Oa,y:V.y+Oa},F.data)}for(const T in r){const F=r[T],V=u[T].paddedRect,j=V.x+Oa,q=V.y+Oa,J=F.data.width,le=F.data.height;Pa.copy(F.data,C,{x:0,y:0},{x:j,y:q},F.data),Pa.copy(F.data,C,{x:0,y:le-1},{x:j,y:q-1},{width:J,height:1}),Pa.copy(F.data,C,{x:0,y:0},{x:j,y:q+le},{width:J,height:1}),Pa.copy(F.data,C,{x:J-1,y:0},{x:j-1,y:q},{width:1,height:le}),Pa.copy(F.data,C,{x:0,y:0},{x:j+J,y:q},{width:1,height:le})}this.image=C,this.iconPositions=s,this.patternPositions=u}addImages(e,r,s){for(const u in e){const f=e[u],_={x:0,y:0,w:f.data.width+2*Oa,h:f.data.height+2*Oa};s.push(_),r[u]=new Sp(_,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),r)}patchUpdatedImage(e,r,s){if(!e||!r||e.version===r.version)return;e.version=r.version;const[u,f]=e.tl;s.update(r.data,void 0,{x:u,y:f})}}E(Sp,"ImagePosition"),E(Ip,"ImageAtlas");const Wa={horizontal:1,vertical:2,horizontalOnly:3},sf=-17;class af{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const s=new af;return s.scale=e||1,s.fontStack=r,s}static forImage(e){const r=new af;return r.imageName=e,r}}class Jc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const s=new Jc;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?s.addImageSection(f):s.addTextSection(f,r)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,s){let u="";for(let f=0;f<r.length;f++){const _=r.charCodeAt(f+1)||null,x=r.charCodeAt(f-1)||null;u+=!s&&(_&&Nr(_)&&!tf[r[f+1]]||x&&Nr(x)&&!tf[r[f-1]])||!tf[r[f]]?r[f]:tf[r[f]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&cf[this.text.charCodeAt(s)];s++)e++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&cf[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const s=new Jc;return s.text=this.text.substring(e,r),s.sectionIndex=this.sectionIndex.slice(e,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(af.forText(e.scale,e.fontStack||r));const s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){const r=e.image?e.image.name:"";if(0===r.length)return void dn("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(af.forImage(r)),this.sectionIndex.push(this.sections.length-1)):dn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lf(n,e,r,s,u,f,_,x,C,T,F,V,j,q,J){const le=Jc.fromFeature(n,u);V===Wa.vertical&&le.verticalizePunctuation(j);let Ee=[];const Ue=function(ht,Yt,Ut,hn,kn,tn){if(!ht)return[];const Cn=[],Tn=function(tr,fr,sr,ri,Un,Ir){let oi=0;for(let Ui=0;Ui<tr.length();Ui++){const si=tr.getSection(Ui);oi+=Mp(tr.getCharCode(Ui),si,ri,Un,fr,Ir)}return oi/Math.max(1,Math.ceil(oi/sr))}(ht,Yt,Ut,hn,kn,tn),On=ht.text.indexOf("\u200b")>=0;let Vn=0;for(let tr=0;tr<ht.length();tr++){const fr=ht.getSection(tr),sr=ht.getCharCode(tr);if(cf[sr]||(Vn+=Mp(sr,fr,hn,kn,Yt,tn)),tr<ht.length()-1){const ri=!((fn=sr)<11904||!(me["Bopomofo Extended"](fn)||me.Bopomofo(fn)||me["CJK Compatibility Forms"](fn)||me["CJK Compatibility Ideographs"](fn)||me["CJK Compatibility"](fn)||me["CJK Radicals Supplement"](fn)||me["CJK Strokes"](fn)||me["CJK Symbols and Punctuation"](fn)||me["CJK Unified Ideographs Extension A"](fn)||me["CJK Unified Ideographs"](fn)||me["Enclosed CJK Letters and Months"](fn)||me["Halfwidth and Fullwidth Forms"](fn)||me.Hiragana(fn)||me["Ideographic Description Characters"](fn)||me["Kangxi Radicals"](fn)||me["Katakana Phonetic Extensions"](fn)||me.Katakana(fn)||me["Vertical Forms"](fn)||me["Yi Radicals"](fn)||me["Yi Syllables"](fn)));(ny[sr]||ri||fr.imageName)&&Cn.push(pg(tr+1,Vn,Tn,Cn,fg(sr,ht.getCharCode(tr+1),ri&&On),!1))}}var fn;return mg(pg(ht.length(),Vn,Tn,Cn,0,!0))}(le,T,f,e,s,q),{processBidirectionalText:rt,processStyledBidirectionalText:je}=O;if(rt&&1===le.sections.length){const ht=rt(le.toString(),Ue);for(const Yt of ht){const Ut=new Jc;Ut.text=Yt,Ut.sections=le.sections;for(let hn=0;hn<Yt.length;hn++)Ut.sectionIndex.push(0);Ee.push(Ut)}}else if(je){const ht=je(le.text,le.sectionIndex,Ue);for(const Yt of ht){const Ut=new Jc;Ut.text=Yt[0],Ut.sectionIndex=Yt[1],Ut.sections=le.sections,Ee.push(Ut)}}else Ee=function(ht,Yt){const Ut=[],hn=ht.text;let kn=0;for(const tn of Yt)Ut.push(ht.substring(kn,tn)),kn=tn;return kn<hn.length&&Ut.push(ht.substring(kn,hn.length)),Ut}(le,Ue);const it=[],ft={positionedLines:it,text:le.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ht,Yt,Ut,hn,kn,tn,Cn,Tn,On,Vn,fn,tr){let fr=0,sr=0,ri=0;const Un="right"===Tn?1:"left"===Tn?0:.5;let Ir=!1;for(const ci of kn){const ai=ci.getSections();for(const xo of ai){if(xo.imageName)continue;const bo=Yt[xo.fontStack];if(bo&&(Ir=void 0!==bo.ascender&&void 0!==bo.descender,!Ir))break}if(!Ir)break}let oi=0;for(const ci of kn){ci.trim();const ai=ci.getMaxScale(),xo=(ai-1)*Rs,bo={positionedGlyphs:[],lineOffset:0};ht.positionedLines[oi]=bo;const wo=bo.positionedGlyphs;let mo=0;if(!ci.length()){sr+=tn,++oi;continue}let Lo=0,Fo=0;for(let Xi=0;Xi<ci.length();Xi++){const xs=ci.getSection(Xi),Go=ci.getSectionIndex(Xi),Wo=ci.getCharCode(Xi);let ji=xs.scale,qo=null,Eo=null,ya=null,bs=Rs,Ys=0;const Is=!(On===Wa.horizontal||!fn&&!Yn(Wo)||fn&&(cf[Wo]||(Ui=Wo,me.Arabic(Ui)||me["Arabic Supplement"](Ui)||me["Arabic Extended-A"](Ui)||me["Arabic Presentation Forms-A"](Ui)||me["Arabic Presentation Forms-B"](Ui))));if(xs.imageName){const Xs=hn[xs.imageName];if(!Xs)continue;ya=xs.imageName,ht.iconsInText=ht.iconsInText||!0,Eo=Xs.paddedRect;const ws=Xs.displaySize;ji=ji*Rs/tr,qo={width:ws[0],height:ws[1],left:Oa,top:-Cp,advance:Is?ws[1]:ws[0],localGlyph:!1},Ys=Ir?-qo.height*ji:sf+ai*Rs-ws[1]*ji,bs=qo.advance;const cc=(Is?ws[0]:ws[1])*ji-Rs*ai;cc>0&&cc>mo&&(mo=cc)}else{const Xs=Ut[xs.fontStack];if(!Xs)continue;Xs[Wo]&&(Eo=Xs[Wo]);const ws=Yt[xs.fontStack];if(!ws)continue;const cc=ws.glyphs[Wo];if(!cc)continue;if(qo=cc.metrics,bs=8203!==Wo?Rs:0,Ir){const hd=void 0!==ws.ascender?Math.abs(ws.ascender):0,_h=void 0!==ws.descender?Math.abs(ws.descender):0,ku=(hd+_h)*ji;Lo<ku&&(Lo=ku,Fo=(hd-_h)/2*ji),Ys=-hd*ji}else Ys=sf+(ai-ji)*Rs}Is?(ht.verticalizable=!0,wo.push({glyph:Wo,imageName:ya,x:fr,y:sr+Ys,vertical:Is,scale:ji,localGlyph:qo.localGlyph,fontStack:xs.fontStack,sectionIndex:Go,metrics:qo,rect:Eo}),fr+=bs*ji+Vn):(wo.push({glyph:Wo,imageName:ya,x:fr,y:sr+Ys,vertical:Is,scale:ji,localGlyph:qo.localGlyph,fontStack:xs.fontStack,sectionIndex:Go,metrics:qo,rect:Eo}),fr+=qo.advance*ji+Vn)}0!==wo.length&&(ri=Math.max(fr-Vn,ri),Ir?Ap(wo,Un,mo,Fo,tn*ai/2):Ap(wo,Un,mo,0,tn/2)),fr=0;const os=tn*ai+mo;bo.lineOffset=Math.max(mo,xo),sr+=os,++oi}var Ui;const si=sr,{horizontalAlign:jr,verticalAlign:Ao}=gg(Cn);(function(ci,ai,xo,bo,wo,mo){const Lo=(ai-xo)*wo,Fo=-mo*bo;for(const os of ci)for(const Xi of os.positionedGlyphs)Xi.x+=Lo,Xi.y+=Fo})(ht.positionedLines,Un,jr,Ao,ri,si),ht.top+=-Ao*si,ht.bottom=ht.top+si,ht.left+=-jr*ri,ht.right=ht.left+ri,ht.hasBaseline=Ir}(ft,e,r,s,Ee,_,x,C,V,T,j,J),!function(ht){for(const Yt of ht)if(0!==Yt.positionedGlyphs.length)return!1;return!0}(it)&&ft}const cf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ny={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mp(n,e,r,s,u,f){if(e.imageName){const _=s[e.imageName];return _?_.displaySize[0]*e.scale*Rs/f+u:0}{const _=r[e.fontStack],x=_&&_.glyphs[n];return x?x.metrics.advance*e.scale+u:0}}function hg(n,e,r,s){const u=Math.pow(n-e,2);return s?n<e?u/2:2*u:u+Math.abs(r)*r}function fg(n,e,r){let s=0;return 10===n&&(s-=1e4),r&&(s+=150),40!==n&&65288!==n||(s+=50),41!==e&&65289!==e||(s+=50),s}function pg(n,e,r,s,u,f){let _=null,x=hg(e,r,u,f);for(const C of s){const T=hg(e-C.x,r,u,f)+C.badness;T<=x&&(_=C,x=T)}return{index:n,x:e,priorBreak:_,badness:x}}function mg(n){return n?mg(n.priorBreak).concat(n.index):[]}function gg(n){let e=.5,r=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Ap(n,e,r,s,u){if(!(e||r||s||u))return;const f=n.length-1,_=n[f],x=(_.x+_.metrics.advance*_.scale)*e;for(let C=0;C<=f;C++)n[C].x-=x,n[C].y+=r+s+u}function _g(n,e,r){const{horizontalAlign:s,verticalAlign:u}=gg(r),f=e[0]-n.displaySize[0]*s,_=e[1]-n.displaySize[1]*u;return{image:n,top:_,bottom:_+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function fl(n,e,r,s,u,f){const _=n.image;let x;if(_.content){const Ee=_.content,Ue=_.pixelRatio||1;x=[Ee[0]/Ue,Ee[1]/Ue,_.displaySize[0]-Ee[2]/Ue,_.displaySize[1]-Ee[3]/Ue]}const C=e.left*f,T=e.right*f;let F,V,j,q;"width"===r||"both"===r?(q=u[0]+C-s[3],V=u[0]+T+s[1]):(q=u[0]+(C+T-_.displaySize[0])/2,V=q+_.displaySize[0]);const J=e.top*f,le=e.bottom*f;return"height"===r||"both"===r?(F=u[1]+J-s[0],j=u[1]+le+s[2]):(F=u[1]+(J+le-_.displaySize[1])/2,j=F+_.displaySize[1]),{image:_,top:F,right:V,bottom:j,left:q,collisionPadding:x}}class Ll extends Ie{constructor(e,r,s,u,f){super(e,r),this.angle=u,this.z=s,void 0!==f&&(this.segment=f)}clone(){return new Ll(this.x,this.y,this.z,this.angle,this.segment)}}function yg(n,e,r,s,u){if(void 0===e.segment)return!0;let f=e,_=e.segment+1,x=0;for(;x>-r/2;){if(_--,_<0)return!1;x-=n[_].dist(f),f=n[_]}x+=n[_].dist(n[_+1]),_++;const C=[];let T=0;for(;x<r/2;){const F=n[_],V=n[_+1];if(!V)return!1;let j=n[_-1].angleTo(F)-F.angleTo(V);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:x,angleDelta:j}),T+=j;x-C[0].distance>s;)T-=C.shift().angleDelta;if(T>u)return!1;_++,x+=F.dist(V)}return!0}function ry(n){let e=0;for(let r=0;r<n.length-1;r++)e+=n[r].dist(n[r+1]);return e}function vg(n,e,r){return n?.6*e*r:0}function xg(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function bg(n,e,r,s,u,f){const _=vg(r,u,f),x=xg(r,s)*f;let C=0;const T=ry(n)/2;for(let F=0;F<n.length-1;F++){const V=n[F],j=n[F+1],q=V.dist(j);if(C+q>T){const J=(T-C)/q,le=K(V.x,j.x,J),Ee=K(V.y,j.y,J),Ue=new Ll(le,Ee,0,j.angleTo(V),F);return!_||yg(n,Ue,x,_,e)?Ue:void 0}C+=q}}function sd(n,e,r,s,u,f,_,x,C){const T=vg(s,f,_),F=xg(s,u),V=F*_,j=0===n[0].x||n[0].x===C||0===n[0].y||n[0].y===C;return e-V<e/4&&(e=V+e/4),ac(n,j?e/2*x%e:(F/2+2*f)*_*x%e,e,T,r,V,j,!1,C)}function ac(n,e,r,s,u,f,_,x,C){const T=f/2,F=ry(n);let V=0,j=e-r,q=[];for(let J=0;J<n.length-1;J++){const le=n[J],Ee=n[J+1],Ue=le.dist(Ee),rt=Ee.angleTo(le);for(;j+r<V+Ue;){j+=r;const je=(j-V)/Ue,it=K(le.x,Ee.x,je),ft=K(le.y,Ee.y,je);if(it>=0&&it<C&&ft>=0&&ft<C&&j-T>=0&&j+T<=F){const ht=new Ll(it,ft,0,rt,J);ht._round(),s&&!yg(n,ht,f,s,u)||q.push(ht)}}V+=Ue}return x||q.length||_||(q=ac(n,V/2,r,s,u,f,_,!0,C)),q}function Tu(n,e,r,s,u){const f=[];for(let _=0;_<n.length;_++){const x=n[_];let C;for(let T=0;T<x.length-1;T++){let F=x[T],V=x[T+1];F.x<e&&V.x<e||(F.x<e?F=new Ie(e,F.y+(e-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x<e&&(V=new Ie(e,F.y+(e-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y<r&&V.y<r||(F.y<r?F=new Ie(F.x+(r-F.y)/(V.y-F.y)*(V.x-F.x),r)._round():V.y<r&&(V=new Ie(F.x+(r-F.y)/(V.y-F.y)*(V.x-F.x),r)._round()),F.x>=s&&V.x>=s||(F.x>=s?F=new Ie(s,F.y+(s-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x>=s&&(V=new Ie(s,F.y+(s-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y>=u&&V.y>=u||(F.y>=u?F=new Ie(F.x+(u-F.y)/(V.y-F.y)*(V.x-F.x),u)._round():V.y>=u&&(V=new Ie(F.x+(u-F.y)/(V.y-F.y)*(V.x-F.x),u)._round()),C&&F.equals(C[C.length-1])||(C=[F],f.push(C)),C.push(V)))))}}return f}E(Ll,"Anchor");const nh=1e20;function wg(n,e,r,s,u,f,_,x,C){for(let T=e;T<e+s;T++)Pp(n,r*f+T,f,u,_,x,C);for(let T=r;T<r+u;T++)Pp(n,T*f+e,1,s,_,x,C)}function Pp(n,e,r,s,u,f,_){f[0]=0,_[0]=-nh,_[1]=nh,u[0]=n[e];for(let x=1,C=0,T=0;x<s;x++){u[x]=n[e+x*r];const F=x*x;do{const V=f[C];T=(u[x]-u[V]+F-V*V)/(x-V)/2}while(T<=_[C]&&--C>-1);C++,f[C]=x,_[C]=T,_[C+1]=nh}for(let x=0,C=0;x<s;x++){for(;_[C+1]<x;)C++;const T=f[C],F=x-T;n[e+x*r]=u[T]+F*F}}const el=2,Su={none:0,ideographs:1,all:2};class Iu{constructor(e,r,s){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const s=[];for(const u in e)for(const f of e[u])s.push({stack:u,id:f});Pn(s,({stack:u,id:f},_)=>{let x=this.entries[u];x||(x=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=x.glyphs[f];if(void 0!==C)return void _(null,{stack:u,id:f,glyph:C});if(C=this._tinySDF(x,u,f),C)return x.glyphs[f]=C,void _(null,{stack:u,id:f,glyph:C});const T=Math.floor(f/256);if(256*T>65535)return void _(new Error("glyphs > 65535 not supported"));if(x.ranges[T])return void _(null,{stack:u,id:f,glyph:C});let F=x.requests[T];F||(F=x.requests[T]=[],Iu.loadGlyphRange(u,T,this.url,this.requestManager,(V,j)=>{if(j){x.ascender=j.ascender,x.descender=j.descender;for(const q in j.glyphs)this._doesCharSupportLocalGlyph(+q)||(x.glyphs[+q]=j.glyphs[+q]);x.ranges[T]=!0}for(const q of F)q(V,j);delete x.requests[T]})),F.push((V,j)=>{V?_(V):j&&_(null,{stack:u,id:f,glyph:j.glyphs[f]||null})})},(u,f)=>{if(u)r(u);else if(f){const _={};for(const{stack:x,id:C,glyph:T}of f)void 0===_[x]&&(_[x]={}),void 0===_[x].glyphs&&(_[x].glyphs={}),_[x].glyphs[C]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},_[x].ascender=this.entries[x].ascender,_[x].descender=this.entries[x].descender;r(null,_)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Su.none&&(this.localGlyphMode===Su.all?!!this.localFontFamily:!!this.localFontFamily&&(me["CJK Unified Ideographs"](e)||me["Hangul Syllables"](e)||me.Hiragana(e)||me.Katakana(e)||me["CJK Symbols and Punctuation"](e)))}_tinySDF(e,r,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let f=e.tinySDF;if(!f){let le="400";/bold/i.test(r)?le="900":/medium/i.test(r)?le="500":/light/i.test(r)&&(le="200"),f=e.tinySDF=new Iu.TinySDF({fontFamily:u,fontWeight:le,fontSize:24*el,buffer:3*el,radius:8*el}),f.fontWeight=le}if(this.localGlyphs[f.fontWeight][s])return this.localGlyphs[f.fontWeight][s];const _=String.fromCharCode(s),{data:x,width:C,height:T,glyphWidth:F,glyphHeight:V,glyphLeft:j,glyphTop:q,glyphAdvance:J}=f.draw(_);return this.localGlyphs[f.fontWeight][s]={id:s,bitmap:new oc({width:C,height:T},x),metrics:{width:F/el,height:V/el,left:j/el,top:q/el-27,advance:J/el,localGlyph:!0}}}}Iu.loadGlyphRange=function(n,e,r,s,u){const f=256*e,_=f+255,x=s.transformRequest(s.normalizeGlyphsURL(r).replace("{fontstack}",n).replace("{range}",`${f}-${_}`),Mi.Glyphs);Or(x,(C,T)=>{if(C)u(C);else if(T){const F={},V=new Kc(T).readFields(od,{});for(const j of V.glyphs)F[j.id]=j;u(null,{glyphs:F,ascender:V.ascender,descender:V.descender})}})},Iu.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:r=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:_="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=r;const x=this.size=n+4*e,C=this._createCanvas(x),T=this.ctx=C.getContext("2d",{willReadFrequently:!0});T.font=`${_} ${f} ${n}px ${u}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(n),_=Math.ceil(r),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),C=Math.min(this.size-this.buffer,_+Math.ceil(s)),T=x+2*this.buffer,F=C+2*this.buffer,V=Math.max(T*F,0),j=new Uint8ClampedArray(V),q={data:j,width:T,height:F,glyphWidth:x,glyphHeight:C,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(0===x||0===C)return q;const{ctx:J,buffer:le,gridInner:Ee,gridOuter:Ue}=this;J.clearRect(le,le,x,C),J.fillText(n,le,le+_);const rt=J.getImageData(le,le,x,C);Ue.fill(nh,0,V),Ee.fill(0,0,V);for(let je=0;je<C;je++)for(let it=0;it<x;it++){const ft=rt.data[4*(je*x+it)+3]/255;if(0===ft)continue;const ht=(je+le)*T+it+le;if(1===ft)Ue[ht]=0,Ee[ht]=nh;else{const Yt=.5-ft;Ue[ht]=Yt>0?Yt*Yt:0,Ee[ht]=Yt<0?Yt*Yt:0}}wg(Ue,0,0,T,F,T,this.f,this.v,this.z),wg(Ee,le,le,x,C,T,this.f,this.v,this.z);for(let je=0;je<V;je++){const it=Math.sqrt(Ue[je])-Math.sqrt(Ee[je]);j[je]=Math.round(255-255*(it/this.radius+this.cutoff))}return q}};const rh=Oa;function uf(n,e,r,s){const u=[],f=n.image,_=f.pixelRatio,x=f.paddedRect.w-2*rh,C=f.paddedRect.h-2*rh,T=n.right-n.left,F=n.bottom-n.top,V=f.stretchX||[[0,x]],j=f.stretchY||[[0,C]],q=(tn,Cn)=>tn+Cn[1]-Cn[0],J=V.reduce(q,0),le=j.reduce(q,0),Ee=x-J,Ue=C-le;let rt=0,je=J,it=0,ft=le,ht=0,Yt=Ee,Ut=0,hn=Ue;if(f.content&&s){const tn=f.content;rt=bc(V,0,tn[0]),it=bc(j,0,tn[1]),je=bc(V,tn[0],tn[2]),ft=bc(j,tn[1],tn[3]),ht=tn[0]-rt,Ut=tn[1]-it,Yt=tn[2]-tn[0]-je,hn=tn[3]-tn[1]-ft}const kn=(tn,Cn,Tn,On)=>{const Vn=oh(tn.stretch-rt,je,T,n.left),fn=sh(tn.fixed-ht,Yt,tn.stretch,J),tr=oh(Cn.stretch-it,ft,F,n.top),fr=sh(Cn.fixed-Ut,hn,Cn.stretch,le),sr=oh(Tn.stretch-rt,je,T,n.left),ri=sh(Tn.fixed-ht,Yt,Tn.stretch,J),Un=oh(On.stretch-it,ft,F,n.top),Ir=sh(On.fixed-Ut,hn,On.stretch,le),oi=new Ie(Vn,tr),Ui=new Ie(sr,tr),si=new Ie(sr,Un),jr=new Ie(Vn,Un),Ao=new Ie(fn/_,fr/_),ci=new Ie(ri/_,Ir/_),ai=e*Math.PI/180;if(ai){const wo=Math.sin(ai),mo=Math.cos(ai),Lo=[mo,-wo,wo,mo];oi._matMult(Lo),Ui._matMult(Lo),jr._matMult(Lo),si._matMult(Lo)}const xo=tn.stretch+tn.fixed,bo=Cn.stretch+Cn.fixed;return{tl:oi,tr:Ui,bl:jr,br:si,tex:{x:f.paddedRect.x+rh+xo,y:f.paddedRect.y+rh+bo,w:Tn.stretch+Tn.fixed-xo,h:On.stretch+On.fixed-bo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ao,pixelOffsetBR:ci,minFontScaleX:Yt/_/T,minFontScaleY:hn/_/F,isSDF:r}};if(s&&(f.stretchX||f.stretchY)){const tn=ih(V,Ee,J),Cn=ih(j,Ue,le);for(let Tn=0;Tn<tn.length-1;Tn++){const On=tn[Tn],Vn=tn[Tn+1];for(let fn=0;fn<Cn.length-1;fn++)u.push(kn(On,Cn[fn],Vn,Cn[fn+1]))}}else u.push(kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:C+1}));return u}function bc(n,e,r){let s=0;for(const u of n)s+=Math.max(e,Math.min(r,u[1]))-Math.max(e,Math.min(r,u[0]));return s}function ih(n,e,r){const s=[{fixed:-rh,stretch:0}];for(const[u,f]of n){const _=s[s.length-1];s.push({fixed:u-_.stretch,stretch:_.stretch}),s.push({fixed:u-_.stretch,stretch:_.stretch+(f-u)})}return s.push({fixed:e+rh,stretch:r}),s}function oh(n,e,r,s){return n/e*r+s}function sh(n,e,r,s){return n-e*r/s}function iy(n,e,r,s){const u=e+n.positionedLines[s].lineOffset;return 0===s?r+u/2:r+(u+(e+n.positionedLines[s-1].lineOffset))/2}class oy{constructor(e=[],r=sy){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:s}=this,u=r[e];for(;e>0;){const f=e-1>>1,_=r[f];if(s(u,_)>=0)break;r[e]=_,e=f}r[e]=u}_down(e){const{data:r,compare:s}=this,u=this.length>>1,f=r[e];for(;e<u;){let _=1+(e<<1),x=r[_];const C=_+1;if(C<this.length&&s(r[C],x)<0&&(_=C,x=r[C]),s(x,f)>=0)break;r[e]=x,e=_}r[e]=f}}function sy(n,e){return n<e?-1:n>e?1:0}function ay(n,e=1,r=!1){let s=1/0,u=1/0,f=-1/0,_=-1/0;const x=n[0];for(let q=0;q<x.length;q++){const J=x[q];(!q||J.x<s)&&(s=J.x),(!q||J.y<u)&&(u=J.y),(!q||J.x>f)&&(f=J.x),(!q||J.y>_)&&(_=J.y)}const C=Math.min(f-s,_-u);let T=C/2;const F=new oy([],Eg);if(0===C)return new Ie(s,u);for(let q=s;q<f;q+=C)for(let J=u;J<_;J+=C)F.push(new ah(q+T,J+T,T,n));let V=function(q){let J=0,le=0,Ee=0;const Ue=q[0];for(let rt=0,je=Ue.length,it=je-1;rt<je;it=rt++){const ft=Ue[rt],ht=Ue[it],Yt=ft.x*ht.y-ht.x*ft.y;le+=(ft.x+ht.x)*Yt,Ee+=(ft.y+ht.y)*Yt,J+=3*Yt}return new ah(le/J,Ee/J,0,q)}(n),j=F.length;for(;F.length;){const q=F.pop();(q.d>V.d||!V.d)&&(V=q,r&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,j)),q.max-V.d<=e||(T=q.h/2,F.push(new ah(q.p.x-T,q.p.y-T,T,n)),F.push(new ah(q.p.x+T,q.p.y-T,T,n)),F.push(new ah(q.p.x-T,q.p.y+T,T,n)),F.push(new ah(q.p.x+T,q.p.y+T,T,n)),j+=4)}return r&&(console.log(`num probes: ${j}`),console.log(`best distance: ${V.d}`)),V.p}function Eg(n,e){return e.max-n.max}class ah{constructor(e,r,s,u){this.p=new Ie(e,r),this.h=s,this.d=function(f,_){let x=!1,C=1/0;for(let T=0;T<_.length;T++){const F=_[T];for(let V=0,j=F.length,q=j-1;V<j;q=V++){const J=F[V],le=F[q];J.y>f.y!=le.y>f.y&&f.x<(le.x-J.x)*(f.y-J.y)/(le.y-J.y)+J.x&&(x=!x),C=Math.min(C,Zu(f,J,le))}}return(x?1:-1)*Math.sqrt(C)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const ad=7,Dg=Number.POSITIVE_INFINITY,Av=Math.sqrt(2);function Rp(n,[e,r]){let s=0,u=0;if(r===Dg){e<0&&(e=0);const f=e/Av;switch(n){case"top-right":case"top-left":u=f-ad;break;case"bottom-right":case"bottom-left":u=-f+ad;break;case"bottom":u=-e+ad;break;case"top":u=e-ad}switch(n){case"top-right":case"bottom-right":s=-f;break;case"top-left":case"bottom-left":s=f;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),n){case"top-right":case"top-left":case"top":u=r-ad;break;case"bottom-right":case"bottom-left":case"bottom":u=-r+ad}switch(n){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,u]}function Cg(n,e,r,s,u,f,_,x,C,T){n.createArrays(),n.tilePixelRatio=Pr/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const F=n.layers[0].layout,V=n.layers[0]._unevaluatedLayout._values,j={};if("composite"===n.textSizeData.kind){const{minZoom:le,maxZoom:Ee}=n.textSizeData;j.compositeTextSizes=[V["text-size"].possiblyEvaluate(new z(le),x),V["text-size"].possiblyEvaluate(new z(Ee),x)]}if("composite"===n.iconSizeData.kind){const{minZoom:le,maxZoom:Ee}=n.iconSizeData;j.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new z(le),x),V["icon-size"].possiblyEvaluate(new z(Ee),x)]}j.layoutTextSize=V["text-size"].possiblyEvaluate(new z(C+1),x),j.layoutIconSize=V["icon-size"].possiblyEvaluate(new z(C+1),x),j.textMaxSize=V["text-size"].possiblyEvaluate(new z(18),x);const q="map"===F.get("text-rotation-alignment")&&"point"!==F.get("symbol-placement"),J=F.get("text-size");for(const le of n.features){const Ee=F.get("text-font").evaluate(le,{},x).join(","),Ue=J.evaluate(le,{},x),rt=j.layoutTextSize.evaluate(le,{},x),je=(j.layoutIconSize.evaluate(le,{},x),{horizontal:{},vertical:void 0}),it=le.text;let ft,ht=[0,0];if(it){const hn=it.toString(),kn=F.get("text-letter-spacing").evaluate(le,{},x)*Rs,tn=F.get("text-line-height").evaluate(le,{},x)*Rs,Cn=$t(hn)?kn:0,Tn=F.get("text-anchor").evaluate(le,{},x),On=F.get("text-variable-anchor");if(!On){const sr=F.get("text-radial-offset").evaluate(le,{},x);ht=sr?Rp(Tn,[sr*Rs,Dg]):F.get("text-offset").evaluate(le,{},x).map(ri=>ri*Rs)}let Vn=q?"center":F.get("text-justify").evaluate(le,{},x);const fn="point"===F.get("symbol-placement"),tr=fn?F.get("text-max-width").evaluate(le,{},x)*Rs:1/0,fr=sr=>{n.allowVerticalPlacement&&st(hn)&&(je.vertical=lf(it,e,r,u,Ee,tr,tn,Tn,sr,Cn,ht,Wa.vertical,!0,rt,Ue))};if(!q&&On){const sr="auto"===Vn?On.map(Un=>Tg(Un)):[Vn];let ri=!1;for(let Un=0;Un<sr.length;Un++){const Ir=sr[Un];if(!je.horizontal[Ir])if(ri)je.horizontal[Ir]=je.horizontal[0];else{const oi=lf(it,e,r,u,Ee,tr,tn,"center",Ir,Cn,ht,Wa.horizontal,!1,rt,Ue);oi&&(je.horizontal[Ir]=oi,ri=1===oi.positionedLines.length)}}fr("left")}else{if("auto"===Vn&&(Vn=Tg(Tn)),fn||F.get("text-writing-mode").indexOf("horizontal")>=0||!st(hn)){const sr=lf(it,e,r,u,Ee,tr,tn,Tn,Vn,Cn,ht,Wa.horizontal,!1,rt,Ue);sr&&(je.horizontal[Vn]=sr)}fr(fn?"left":Vn)}}let Yt=!1;if(le.icon&&le.icon.name){const hn=s[le.icon.name];hn&&(ft=_g(u[le.icon.name],F.get("icon-offset").evaluate(le,{},x),F.get("icon-anchor").evaluate(le,{},x)),Yt=hn.sdf,void 0===n.sdfIcons?n.sdfIcons=hn.sdf:n.sdfIcons!==hn.sdf&&dn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(hn.pixelRatio!==n.pixelRatio||0!==F.get("icon-rotate").constantOr(1))&&(n.iconsNeedLinear=!0))}const Ut=kp(je.horizontal)||je.vertical;n.iconsInText||(n.iconsInText=!!Ut&&Ut.iconsInText),(Ut||ft)&&Sg(n,le,je,ft,s,j,rt,0,ht,Yt,_,x,T)}f&&n.generateCollisionDebugBuffers(C,n.collisionBoxArray)}function Tg(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sg(n,e,r,s,u,f,_,x,C,T,F,V,j){let q=f.textMaxSize.evaluate(e,{},V);void 0===q&&(q=_);const J=n.layers[0].layout,le=J.get("icon-offset").evaluate(e,{},V),Ee=kp(r.horizontal)||r.vertical,Ue="globe"===j.name,rt=Rs,je=_/rt,it=n.tilePixelRatio*q/rt,ft=(Tn=n.overscaling,n.zoom>18&&Tn>2&&(Tn>>=1),Math.max(Pr/(512*Tn),1)*J.get("symbol-spacing")),ht=J.get("text-padding")*n.tilePixelRatio,Yt=J.get("icon-padding")*n.tilePixelRatio,Ut=Ye(J.get("text-max-angle")),hn="map"===J.get("text-rotation-alignment")&&"point"!==J.get("symbol-placement"),kn="map"===J.get("icon-rotation-alignment")&&"point"!==J.get("symbol-placement"),tn=J.get("symbol-placement"),Cn=ft/2;var Tn;const On=J.get("icon-text-fit");let Vn;s&&"none"!==On&&(n.allowVerticalPlacement&&r.vertical&&(Vn=fl(s,r.vertical,On,J.get("icon-text-fit-padding"),le,je)),Ee&&(s=fl(s,Ee,On,J.get("icon-text-fit-padding"),le,je)));const fn=(tr,fr,sr)=>{if(fr.x<0||fr.x>=Pr||fr.y<0||fr.y>=Pr)return;let ri=null;if(Ue){const{x:Un,y:Ir,z:oi}=j.projectTilePoint(fr.x,fr.y,sr);ri={anchor:new Ll(Un,Ir,oi,0,void 0),up:j.upVector(sr,fr.x,fr.y)}}!function(Un,Ir,oi,Ui,si,jr,Ao,ci,ai,xo,bo,wo,mo,Lo,Fo,os,Xi,xs,Go,Wo,ji,qo,Eo,ya,bs){const Ys=Un.addToLineVertexArray(Ir,Ui);let Is,Xs,ws,cc,hd,_h,ku,Jg=0,Jp=0,Qg=0,e_=0,wf=-1,Ef=-1;const $l={};let t_=cu("");const Lu=oi?oi.anchor:Ir;let Qp=0,Df=0;if(void 0===ai._unevaluatedLayout.getValue("text-radial-offset")?[Qp,Df]=ai.layout.get("text-offset").evaluate(ji,{},bs).map(ua=>ua*Rs):(Qp=ai.layout.get("text-radial-offset").evaluate(ji,{},bs)*Rs,Df=Dg),Un.allowVerticalPlacement&&si.vertical){const ua=si.vertical;if(Fo)_h=df(ua),ci&&(ku=df(ci));else{const da=ai.layout.get("text-rotate").evaluate(ji,{},bs)+90;ws=pi(xo,Lu,Ir,bo,wo,mo,ua,Lo,da,os),ci&&(cc=pi(xo,Lu,Ir,bo,wo,mo,ci,xs,da))}}if(jr){const ua=ai.layout.get("icon-rotate").evaluate(ji,{},bs),da="none"!==ai.layout.get("icon-text-fit"),Fu=uf(jr,ua,Eo,da),Cf=ci?uf(ci,ua,Eo,da):void 0;Xs=pi(xo,Lu,Ir,bo,wo,mo,jr,xs,ua),Jg=4*Fu.length;const n_=Un.iconSizeData;let Bu=null;"source"===n_.kind?(Bu=[Ra*ai.layout.get("icon-size").evaluate(ji,{},bs)],Bu[0]>wc&&dn(`${Un.layerIds[0]}: Value for "icon-size" is >= ${Qc}. Reduce your "icon-size".`)):"composite"===n_.kind&&(Bu=[Ra*qo.compositeIconSizes[0].evaluate(ji,{},bs),Ra*qo.compositeIconSizes[1].evaluate(ji,{},bs)],(Bu[0]>wc||Bu[1]>wc)&&dn(`${Un.layerIds[0]}: Value for "icon-size" is >= ${Qc}. Reduce your "icon-size".`)),Un.addSymbols(Un.icon,Fu,Bu,Wo,Go,ji,!1,oi,Ir,Ys.lineStartIndex,Ys.lineLength,-1,ya,bs),wf=Un.icon.placedSymbolArray.length-1,Cf&&(Jp=4*Cf.length,Un.addSymbols(Un.icon,Cf,Bu,Wo,Go,ji,Wa.vertical,oi,Ir,Ys.lineStartIndex,Ys.lineLength,-1,ya,bs),Ef=Un.icon.placedSymbolArray.length-1)}for(const ua in si.horizontal){const da=si.horizontal[ua];Is||(t_=cu(da.text),Fo?hd=df(da):Is=pi(xo,Lu,Ir,bo,wo,mo,da,Lo,ai.layout.get("text-rotate").evaluate(ji,{},bs),os));const Fu=1===da.positionedLines.length;if(Qg+=Op(Un,oi,Ir,da,Ao,ai,Fo,ji,os,Ys,si.vertical?Wa.horizontal:Wa.horizontalOnly,Fu?Object.keys(si.horizontal):[ua],$l,wf,qo,ya,bs),Fu)break}si.vertical&&(e_+=Op(Un,oi,Ir,si.vertical,Ao,ai,Fo,ji,os,Ys,Wa.vertical,["vertical"],$l,Ef,qo,ya,bs));let uc=-1;const yh=(ua,da)=>ua?Math.max(ua,da):da;uc=yh(hd,uc),uc=yh(_h,uc),uc=yh(ku,uc);const wy=uc>-1?1:0;Un.glyphOffsetArray.length>=nu.MAX_GLYPHS&&dn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ji.sortKey&&Un.addToSortKeyRanges(Un.symbolInstances.length,ji.sortKey),Un.symbolInstances.emplaceBack(Lu.x,Lu.y,Lu.z,Ir.x,Ir.y,$l.right>=0?$l.right:-1,$l.center>=0?$l.center:-1,$l.left>=0?$l.left:-1,$l.vertical>=0?$l.vertical:-1,wf,Ef,t_,void 0!==Is?Is:Un.collisionBoxArray.length,void 0!==Is?Is+1:Un.collisionBoxArray.length,void 0!==ws?ws:Un.collisionBoxArray.length,void 0!==ws?ws+1:Un.collisionBoxArray.length,void 0!==Xs?Xs:Un.collisionBoxArray.length,void 0!==Xs?Xs+1:Un.collisionBoxArray.length,cc||Un.collisionBoxArray.length,cc?cc+1:Un.collisionBoxArray.length,bo,Qg,e_,Jg,Jp,wy,0,Qp,Df,uc)}(n,fr,ri,tr,r,s,u,Vn,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,ht,hn,C,0,Yt,kn,le,e,f,T,F,V)};if("line"===tn)for(const tr of Tu(e.geometry,0,0,Pr,Pr)){const fr=sd(tr,ft,Ut,r.vertical||Ee,s,rt,it,n.overscaling,Pr);for(const sr of fr)Ee&&Ig(n,Ee.text,Cn,sr)||fn(tr,sr,V)}else if("line-center"===tn){for(const tr of e.geometry)if(tr.length>1){const fr=bg(tr,Ut,r.vertical||Ee,s,rt,it);fr&&fn(tr,fr,V)}}else if("Polygon"===e.type)for(const tr of lp(e.geometry,0)){const fr=ay(tr,16);fn(tr[0],new Ll(fr.x,fr.y,0,0,void 0),V)}else if("LineString"===e.type)for(const tr of e.geometry)fn(tr,new Ll(tr[0].x,tr[0].y,0,0,void 0),V);else if("Point"===e.type)for(const tr of e.geometry)for(const fr of tr)fn([fr],new Ll(fr.x,fr.y,0,0,void 0),V)}const Qc=255,wc=Qc*Ra;function Op(n,e,r,s,u,f,_,x,C,T,F,V,j,q,J,le,Ee){const Ue=function(it,ft,ht,Yt,Ut,hn,kn,tn){const Cn=[];if(0===ft.positionedLines.length)return Cn;const Tn=Yt.layout.get("text-rotate").evaluate(hn,{})*Math.PI/180,On=function(sr){const ri=sr[0],Un=sr[1],Ir=ri*Un;return Ir>0?[ri,-Un]:Ir<0?[-ri,Un]:0===ri?[Un,ri]:[Un,-ri]}(ht);let Vn=Math.abs(ft.top-ft.bottom);for(const sr of ft.positionedLines)Vn-=sr.lineOffset;const fn=ft.positionedLines.length,tr=Vn/fn;let fr=ft.top-ht[1];for(let sr=0;sr<fn;++sr){const ri=ft.positionedLines[sr];fr=iy(ft,tr,fr,sr);for(const Un of ri.positionedGlyphs){if(!Un.rect)continue;const Ir=Un.rect||{};let oi=Cp+1,Ui=!0,si=1,jr=0;if(Un.imageName){const Eo=kn[Un.imageName];if(!Eo)continue;if(Eo.sdf){dn("SDF images are not supported in formatted text and will be ignored.");continue}Ui=!1,si=Eo.pixelRatio,oi=Oa/si}const Ao=(Ut||tn)&&Un.vertical,ci=Un.metrics.advance*Un.scale/2,ai=Un.metrics,xo=Un.rect;if(null===xo)continue;tn&&ft.verticalizable&&(jr=Un.imageName?ci-Un.metrics.width*Un.scale/2:0);const bo=Ut?[Un.x+ci,Un.y]:[0,0];let wo=[0,0],mo=[0,0],Lo=!1;Ut||(Ao?(mo=[Un.x+ci+On[0],Un.y+On[1]-jr],Lo=!0):wo=[Un.x+ci+ht[0],Un.y+ht[1]-jr]);const Fo=xo.w*Un.scale/(si*(Un.localGlyph?el:1)),os=xo.h*Un.scale/(si*(Un.localGlyph?el:1));let Xi,xs,Go,Wo;if(Ao){const Eo=Un.y-fr,ya=new Ie(-ci,ci-Eo),bs=-Math.PI/2,Ys=new Ie(...mo);Xi=new Ie(-ci+wo[0],wo[1]),Xi._rotateAround(bs,ya)._add(Ys),Xi.x+=-Eo+ci,Xi.y-=(ai.left-oi)*Un.scale;const Is=Un.imageName?ai.advance*Un.scale:Rs*Un.scale,Xs=String.fromCharCode(Un.glyph);vp(Xs)?Xi.x+=(1-oi)*Un.scale:Xd(Xs)?Xi.x+=Is-ai.height*Un.scale+(-oi-1)*Un.scale:Xi.x+=Un.imageName||ai.width+2*oi===xo.w&&ai.height+2*oi===xo.h?(Is-os)/2:(Is-(ai.height+2*oi)*Un.scale)/2,xs=new Ie(Xi.x,Xi.y-Fo),Go=new Ie(Xi.x+os,Xi.y),Wo=new Ie(Xi.x+os,Xi.y-Fo)}else{const Eo=(ai.left-oi)*Un.scale-ci+wo[0],ya=(-ai.top-oi)*Un.scale+wo[1],bs=Eo+Fo,Ys=ya+os;Xi=new Ie(Eo,ya),xs=new Ie(bs,ya),Go=new Ie(Eo,Ys),Wo=new Ie(bs,Ys)}if(Tn){let Eo;Eo=Ut?new Ie(0,0):Lo?new Ie(On[0],On[1]):new Ie(ht[0],ht[1]),Xi._rotateAround(Tn,Eo),xs._rotateAround(Tn,Eo),Go._rotateAround(Tn,Eo),Wo._rotateAround(Tn,Eo)}const ji=new Ie(0,0),qo=new Ie(0,0);Cn.push({tl:Xi,tr:xs,bl:Go,br:Wo,tex:Ir,writingMode:ft.writingMode,glyphOffset:bo,sectionIndex:Un.sectionIndex,isSDF:Ui,pixelOffsetTL:ji,pixelOffsetBR:qo,minFontScaleX:0,minFontScaleY:0})}}return Cn}(0,s,C,f,_,x,u,n.allowVerticalPlacement),rt=n.textSizeData;let je=null;"source"===rt.kind?(je=[Ra*f.layout.get("text-size").evaluate(x,{},Ee)],je[0]>wc&&dn(`${n.layerIds[0]}: Value for "text-size" is >= ${Qc}. Reduce your "text-size".`)):"composite"===rt.kind&&(je=[Ra*J.compositeTextSizes[0].evaluate(x,{},Ee),Ra*J.compositeTextSizes[1].evaluate(x,{},Ee)],(je[0]>wc||je[1]>wc)&&dn(`${n.layerIds[0]}: Value for "text-size" is >= ${Qc}. Reduce your "text-size".`)),n.addSymbols(n.text,Ue,je,C,_,x,F,e,r,T.lineStartIndex,T.lineLength,q,le,Ee);for(const it of V)j[it]=n.text.placedSymbolArray.length-1;return 4*Ue.length}function kp(n){for(const e in n)return n[e];return null}function pi(n,e,r,s,u,f,_,x,C,T){let F=_.top,V=_.bottom,j=_.left,q=_.right;const J=_.collisionPadding;if(J&&(j-=J[0],F-=J[1],q+=J[2],V+=J[3]),C){const le=new Ie(j,F),Ee=new Ie(q,F),Ue=new Ie(j,V),rt=new Ie(q,V),je=Ye(C);let it=new Ie(0,0);T&&(it=new Ie(T[0],T[1])),le._rotateAround(je,it),Ee._rotateAround(je,it),Ue._rotateAround(je,it),rt._rotateAround(je,it),j=Math.min(le.x,Ee.x,Ue.x,rt.x),q=Math.max(le.x,Ee.x,Ue.x,rt.x),F=Math.min(le.y,Ee.y,Ue.y,rt.y),V=Math.max(le.y,Ee.y,Ue.y,rt.y)}return n.emplaceBack(e.x,e.y,e.z,r.x,r.y,j,F,q,V,x,s,u,f),n.length-1}function df(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function Ig(n,e,r,s){const u=n.compareText;if(e in u){const f=u[e];for(let _=f.length-1;_>=0;_--)if(s.dist(f[_])<r)return!0}else u[e]=[];return u[e].push(s),!1}function Mu(n,e){const r=n.fovAboveCenter,s=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,u=(n._camera.position[2]*n.worldSize-s)/Math.cos(n._pitch),f=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-n._pitch-r,.01)),_=Math.sin(n._pitch)*f+u;return Math.min(1.01*_,u*(1/n._horizonShift))}function eu(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const r=Math.pow(2,-n.z),s=n.x*r,u=(n.x+1)*r,f=n.y*r,_=(n.y+1)*r,x=Aa(s),C=Aa(u),T=Us(f),F=Us(_),V=e.project(x,T),j=e.project(C,T),q=e.project(C,F),J=e.project(x,F);let le=Math.min(V.x,j.x,q.x,J.x),Ee=Math.min(V.y,j.y,q.y,J.y),Ue=Math.max(V.x,j.x,q.x,J.x),rt=Math.max(V.y,j.y,q.y,J.y);const je=r/16;function it(ht,Yt,Ut,hn,kn,tn){const Cn=(Ut+kn)/2,Tn=(hn+tn)/2,On=e.project(Aa(Cn),Us(Tn)),Vn=Math.max(0,le-On.x,Ee-On.y,On.x-Ue,On.y-rt);le=Math.min(le,On.x),Ue=Math.max(Ue,On.x),Ee=Math.min(Ee,On.y),rt=Math.max(rt,On.y),Vn>je&&(it(ht,On,Ut,hn,Cn,Tn),it(On,Yt,Cn,Tn,kn,tn))}it(V,j,s,f,u,f),it(j,q,u,f,u,_),it(q,J,u,_,s,_),it(J,V,s,_,s,f),le-=je,Ee-=je,Ue+=je,rt+=je;const ft=1/Math.max(Ue-le,rt-Ee);return{scale:ft,x:le*ft,y:Ee*ft,x2:Ue*ft,y2:rt*ft,projection:e}}const ly=Ma(new Float32Array(16));class Fl{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new fo(0,0)}projectTilePoint(e,r,s){return{x:e,y:r,z:0}}locationPoint(e,r,s=!0){return e._coordinatePoint(e.locationCoordinate(r),s)}pixelsPerMeter(e,r){return Ga(1,e)*r}pixelSpaceConversion(e,r,s){return 1}farthestPixelDistance(e){return Mu(e,e.pixelsPerMeter)}pointCoordinate(e,r,s,u){const f=e.horizonLineFromTop(!1),_=new Ie(r,Math.max(f,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(_,u))}pointCoordinate3D(e,r,s){const u=new Ie(r,s);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const s=e.horizonLineFromTop();return r.y<s}createInversionMatrix(e,r){return ly}createTileMatrix(e,r,s){let u,f,_;const x=s.canonical,C=Ma(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=eu(x,this);u=1,f=T.x+s.wrap*T.scale,_=T.y,hu(C,C,[u/T.scale,u/T.scale,e.pixelsPerMeter/r])}else u=r/e.zoomScale(x.z),f=(x.x+Math.pow(2,x.z)*s.wrap)*u,_=x.y*u;return ju(C,C,[f,_,0]),hu(C,C,[u/Pr,u/Pr,1]),C}upVector(e,r,s){return[0,0,1]}upVectorScale(e,r,s){return{metersToTile:1}}}class ld extends Fl{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,s]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Ye(r));this.n=(u+Math.sin(Ye(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n:s,c:u,r0:f}=this,_=Ye(e-this.center[0]),x=Ye(r),C=Math.sqrt(u-2*s*Math.sin(x))/s;return{x:C*Math.sin(_*s),y:C*Math.cos(_*s)-f,z:0}}unproject(e,r){const{n:s,c:u,r0:f}=this,_=f+r;let x=Math.atan2(e,Math.abs(_))*Math.sign(_);_*s<0&&(x-=Math.PI*Math.sign(e)*Math.sign(_));const C=Ye(this.center[0])*s;x=Zt(x,-Math.PI-C,Math.PI-C);const T=Vt(gt(x/s)+this.center[0],-180,180),F=Math.asin(Vt((u-(e*e+_*_)*s*s)/(2*s),-1,1)),V=Vt(gt(F),-ia,ia);return new fo(T,V)}}const Au=1.340264,Ec=-.081106,cd=893e-6,Pu=.003796,ud=Math.sqrt(3)/2;class Lp extends Fl{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(ud*Math.sin(r)),u=s*s,f=u*u*u;return{x:.5*(e*Math.cos(s)/(ud*(Au+3*Ec*u+f*(7*cd+9*Pu*u)))/Math.PI+.5),y:1-.5*(s*(Au+Ec*u+f*(cd+Pu*u))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=s*s,f=u*u*u;for(let F,V,j,q=0;q<12&&(V=s*(Au+Ec*u+f*(cd+Pu*u))-r,j=Au+3*Ec*u+f*(7*cd+9*Pu*u),F=V/j,s=Vt(s-F,-Math.PI/3,Math.PI/3),u=s*s,f=u*u*u,!(Math.abs(F)<1e-12));++q);const _=ud*e*(Au+3*Ec*u+f*(7*cd+9*Pu*u))/Math.cos(s),x=Math.asin(Math.sin(s)/ud),C=Vt(180*_/Math.PI,-180,180),T=Vt(180*x/Math.PI,-ia,ia);return new fo(C,T)}}class Mg extends Fl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const s=360*(e-.5),u=Vt(360*(.5-r),-ia,ia);return new fo(s,u)}}const tu=Math.PI/2;function hf(n){return Math.tan((tu+n)/2)}class cy extends Fl{constructor(e){super(e),this.center=e.center||[0,30];const[r,s]=this.parallels=e.parallels||[30,30];let u=Ye(r),f=Ye(s);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const _=Math.cos(u),x=hf(u);this.n=u===f?Math.sin(u):Math.log(_/Math.cos(f))/Math.log(hf(f)/x),this.f=_*Math.pow(hf(u),this.n)/this.n}project(e,r){r=Ye(r),this.southernCenter&&(r=-r),e=Ye(e-this.center[0]);const s=1e-6,{n:u,f}=this;f>0?r<-tu+s&&(r=-tu+s):r>tu-s&&(r=tu-s);const _=f/Math.pow(hf(r),u);let x=_*Math.sin(u*e),C=f-_*Math.cos(u*e);return x=.5*(x/Math.PI+.5),C=.5*(C/Math.PI+.5),{x,y:this.southernCenter?C:1-C,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:s,f:u}=this,f=u-r,_=Math.sign(f),x=Math.sign(s)*Math.sqrt(e*e+f*f);let C=Math.atan2(e,Math.abs(f))*_;f*s<0&&(C-=Math.PI*Math.sign(e)*_);const T=Vt(gt(C/s)+this.center[0],-180,180),F=Vt(gt(2*Math.atan(Math.pow(u/x,1/s))-tu),-ia,ia);return new fo(T,this.southernCenter?-F:F)}}class Ag extends Fl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:rc(e),y:Rl(r),z:0}}unproject(e,r){const s=Aa(e),u=Us(r);return new fo(s,u)}}const Fp=Ye(ia);class uy extends Fl{project(e,r){const s=(r=Ye(r))*r,u=s*s;return{x:.5*((e=Ye(e))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=25,f=0,_=s*s;do{_=s*s;const T=_*_;f=(s*(1.007226+_*(.015085+T*(.028874*_-.044475-.005916*T)))-r)/(1.007226+_*(.045255+T*(.259866*_-.311325-.005916*11*T))),s=Vt(s-f,-Fp,Fp)}while(Math.abs(f)>1e-6&&--u>0);_=s*s;const x=Vt(gt(e/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),C=gt(s);return new fo(x,C)}}const Pg=Ye(ia);class dy extends Fl{project(e,r){r=Ye(r),e=Ye(e);const s=Math.cos(r),u=2/Math.PI,f=Math.acos(s*Math.cos(e/2)),_=Math.sin(f)/f,x=.5*(e*u+2*s*Math.sin(e/2)/_)||0,C=.5*(r+Math.sin(r)/_)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(e,r){let s=e=(2*e-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,f=25;const _=1e-6;let x=0,C=0;do{const T=Math.cos(u),F=Math.sin(u),V=2*F*T,j=F*F,q=T*T,J=Math.cos(s/2),le=Math.sin(s/2),Ee=2*J*le,Ue=le*le,rt=1-q*J*J,je=rt?1/rt:0,it=rt?Math.acos(T*J)*Math.sqrt(1/rt):0,ft=.5*(2*it*T*le+2*s/Math.PI)-e,ht=.5*(it*F+u)-r,Yt=.5*je*(q*Ue+it*T*J*j)+1/Math.PI,Ut=je*(Ee*V/4-it*F*le),hn=.125*je*(V*le-it*F*q*Ee),kn=.5*je*(j*J+it*Ue*T)+.5,tn=Ut*hn-kn*Yt;x=(ht*Ut-ft*kn)/tn,C=(ft*hn-ht*Yt)/tn,s=Vt(s-x,-Math.PI,Math.PI),u=Vt(u-C,-Pg,Pg)}while((Math.abs(x)>_||Math.abs(C)>_)&&--f>0);return new fo(gt(s),gt(u))}}class Rg extends Fl{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ye(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:s,cosPhi:u}=this;return{x:Ye(e)*u*s+.5,y:-Math.sin(Ye(r))/u*s+.5,z:0}}unproject(e,r){const{scale:s,cosPhi:u}=this,f=-(r-.5)/s,_=Vt(gt((e-.5)/s)/u,-180,180),x=Math.asin(Vt(f*u,-1,1)),C=Vt(gt(x),-ia,ia);return new fo(_,C)}}class Og extends Ag{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,s){const u=Id(e,r,s);return vs(u,u,Md(Pl(s))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,r){const s=Uc(r.lat,r.lng),u=ra([],s),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude;Mh(s,s,u,Ga(1,0)*Pr*f);const _=Ma(new Float64Array(16));return Uu(_,e.pixelMatrix,e.globeMatrix),vs(s,s,_),new Ie(s[0],s[1])}pixelsPerMeter(e,r){return Ga(1,0)*r}pixelSpaceConversion(e,r,s){const u=Ga(1,e)*r,f=K(Ga(1,45)*r,u,s);return this.pixelsPerMeter(e,r)/f}createTileMatrix(e,r,s){const u=Bh(Pl(s.canonical));return Uu(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,r){const{center:s}=e,u=Md(Pl(r));return Th(u,u,Ye(s.lng)),pm(u,u,Ye(s.lat)),hu(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,r,s,u){return Hf(e,r,s,!0)||new vu(0,0)}pointCoordinate3D(e,r,s){const u=this.pointCoordinate(e,r,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,r){return!Hf(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(u,f){const _=u.cameraToCenterDistance,x=u._centerAltitude*f,C=u._camera,T=u._camera.forward(),F=tc([],hl([],T,-_),[0,0,x]),V=u.worldSize/(2*Math.PI),j=[0,0,-V],q=u.width/u.height,J=Math.tan(u.fovAboveCenter),le=hl([],C.up(),J),Ee=hl([],C.right(),J*q),Ue=ra([],tc([],tc([],T,le),Ee)),rt=[];let je;if(new Lh(F,Ue).closestPointOnSphere(j,V,rt)){const it=tc([],rt,j),ft=Al([],it,F);je=Math.cos(u.fovAboveCenter)*Hu(ft)}else{const it=Al([],F,j),ft=Al([],j,F);ra(ft,ft);const ht=Hu(it)-V;je=Math.sqrt(ht*(ht+2*V));const Yt=Math.acos(je/(V+ht))-Math.acos(Ml(T,ft));je*=Math.cos(Yt)}return 1.01*je}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=_u(e.zoom);if(s>0){const u=Mu(e,Ga(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),_=Math.max(e.width,e.height)/e.worldSize*Math.PI;return K(r,u+f*(1-Math.cos(_)),Math.pow(s,10))}return r}upVector(e,r,s){return Id(r,s,e,1)}upVectorScale(e){return{metersToTile:$c(jc(Pl(e)))}}}function Bp(n){const e=n.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new Ag(n);case"equirectangular":return new Mg(n);case"naturalEarth":return new uy(n);case"equalEarth":return new Lp(n);case"winkelTripel":return new dy(n);case"albers":return r?new Rg(n):new ld(n);case"lambertConformalConic":return r?new Rg(n):new cy(n);case"globe":return new Og(n)}throw new Error(`Invalid projection name: ${n.name}`)}const hy=rd.types,fy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function _a(n,e,r,s,u,f,_,x,C,T,F,V,j){const q=x?Math.min(wc,Math.round(x[0])):0,J=x?Math.min(wc,Math.round(x[1])):0;n.emplaceBack(e,r,Math.round(32*s),Math.round(32*u),f,_,(q<<1)+(C?1:0),J,16*T,16*F,256*V,256*j)}function ff(n,e,r,s,u,f,_){n.emplaceBack(e,r,s,u,f,_)}function pf(n,e,r,s,u){n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u),n.emplaceBack(e,r,s,u)}function Pv(n){for(const e of n.sections)if(Zr(e.text))return!0;return!1}class lh{constructor(e){this.layoutVertexArray=new An,this.indexArray=new xr,this.programConfigurations=e,this.segments=new fs,this.dynamicLayoutVertexArray=new Ln,this.opacityVertexArray=new Ar,this.placedSymbolArray=new hs,this.globeExtVertexArray=new $n}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,r,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mv.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,K_.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,fy,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Qh.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}E(lh,"SymbolBuffers");class mf{constructor(e,r,s){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new s,this.segments=new fs,this.collisionVertexArray=new mi,this.collisionVertexArrayExt=new fi}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,mp.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,gp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}E(mf,"CollisionBuffers");class nu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(_=>_.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ma([]),this.placementViewportMatrix=Ma([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=id(this.zoom,r["text-size"]),this.iconSizeData=id(this.zoom,r["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==f&&void 0!==u.constantOr(1),this.sortFeaturesByY=("viewport-y"===f||"auto"===f&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(_=>Wa[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new lh(new uu(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new lh(new uu(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ia,this.lineVertexArray=new $u,this.symbolInstances=new to}calculateGlyphDependencies(e,r,s,u,f){for(let _=0;_<e.length;_++)if(r[e.charCodeAt(_)]=!0,u&&f){const x=tf[e.charAt(_)];x&&(r[x.charCodeAt(0)]=!0)}}populate(e,r,s,u){const f=this.layers[0],_=f.layout,x="globe"===this.projection.name,C=_.get("text-font"),T=_.get("text-field"),F=_.get("icon-image"),V=("constant"!==T.value.kind||T.value.value instanceof Ai&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&("constant"!==C.value.kind||C.value.value.length>0),j="constant"!==F.value.kind||!!F.value.value||Object.keys(F.parameters).length>0,q=_.get("symbol-sort-key");if(this.features=[],!V&&!j)return;const J=r.iconDependencies,le=r.glyphDependencies,Ee=r.availableImages,Ue=new z(this.zoom);for(const{feature:rt,id:je,index:it,sourceLayerIndex:ft}of e){const ht=f._featureFilter.needGeometry,Yt=Gc(rt,ht);if(!f._featureFilter.filter(Ue,Yt,s))continue;if(ht||(Yt.geometry=ic(rt,s,u)),x&&1!==rt.type&&s.z<=5){const tn=Yt.geometry,Cn=.98078528056,Tn=(On,Vn)=>Ml(Id(On.x,On.y,s,1),Id(Vn.x,Vn.y,s,1))<Cn;for(let On=0;On<tn.length;On++)tn[On]=M_(tn[On],Tn)}let Ut,hn;if(V){const tn=f.getValueAndResolveTokens("text-field",Yt,s,Ee),Cn=Ai.factory(tn);Pv(Cn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===D()||this.hasRTLText&&O.isParsed())&&(Ut=ef(Cn,f,Yt))}if(j){const tn=f.getValueAndResolveTokens("icon-image",Yt,s,Ee);hn=tn instanceof So?tn:So.fromString(tn)}if(!Ut&&!hn)continue;const kn=this.sortFeaturesByKey?q.evaluate(Yt,{},s):void 0;if(this.features.push({id:je,text:Ut,icon:hn,index:it,sourceLayerIndex:ft,geometry:Yt.geometry,properties:rt.properties,type:hy[rt.type],sortKey:kn}),hn&&(J[hn.name]=!0),Ut){const tn=C.evaluate(Yt,{},s).join(","),Cn="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Wa.vertical)>=0;for(const Tn of Ut.sections)if(Tn.image)J[Tn.image.name]=!0;else{const On=st(Ut.toString()),Vn=Tn.fontStack||tn,fn=le[Vn]=le[Vn]||{};this.calculateGlyphDependencies(Tn.text,fn,Cn,this.allowVerticalPlacement,On)}}}"line"===_.get("symbol-placement")&&(this.features=function(rt){const je={},it={},ft=[];let ht=0;function Yt(tn){ft.push(rt[tn]),ht++}function Ut(tn,Cn,Tn){const On=it[tn];return delete it[tn],it[Cn]=On,ft[On].geometry[0].pop(),ft[On].geometry[0]=ft[On].geometry[0].concat(Tn[0]),On}function hn(tn,Cn,Tn){const On=je[Cn];return delete je[Cn],je[tn]=On,ft[On].geometry[0].shift(),ft[On].geometry[0]=Tn[0].concat(ft[On].geometry[0]),On}function kn(tn,Cn,Tn){const On=Tn?Cn[0][Cn[0].length-1]:Cn[0][0];return`${tn}:${On.x}:${On.y}`}for(let tn=0;tn<rt.length;tn++){const Cn=rt[tn],Tn=Cn.geometry,On=Cn.text?Cn.text.toString():null;if(!On){Yt(tn);continue}const Vn=kn(On,Tn),fn=kn(On,Tn,!0);if(Vn in it&&fn in je&&it[Vn]!==je[fn]){const tr=hn(Vn,fn,Tn),fr=Ut(Vn,fn,ft[tr].geometry);delete je[Vn],delete it[fn],it[kn(On,ft[fr].geometry,!0)]=fr,ft[tr].geometry=null}else Vn in it?Ut(Vn,fn,Tn):fn in je?hn(Vn,fn,Tn):(Yt(tn),je[Vn]=ht-1,it[fn]=ht-1)}return ft.filter(tn=>tn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((rt,je)=>rt.sortKey-je.sortKey)}update(e,r,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,s,u),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,s,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Bp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const s=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:u,y:f}of r)this.lineVertexArray.emplaceBack(u,f);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,r,s,u,f,_,x,C,T,F,V,j,q,J){const le=e.indexArray,Ee=e.layoutVertexArray,Ue=e.globeExtVertexArray,rt=e.segments.prepareSegment(4*r.length,Ee,le,this.canOverlap?_.sortKey:void 0),je=this.glyphOffsetArray.length,it=rt.vertexLength,ft=this.allowVerticalPlacement&&x===Wa.vertical?Math.PI/2:0,ht=_.text&&_.text.sections;for(let Ut=0;Ut<r.length;Ut++){const{tl:hn,tr:kn,bl:tn,br:Cn,tex:Tn,pixelOffsetTL:On,pixelOffsetBR:Vn,minFontScaleX:fn,minFontScaleY:tr,glyphOffset:fr,isSDF:sr,sectionIndex:ri}=r[Ut],Un=rt.vertexLength,Ir=fr[1];if(_a(Ee,T.x,T.y,hn.x,Ir+hn.y,Tn.x,Tn.y,s,sr,On.x,On.y,fn,tr),_a(Ee,T.x,T.y,kn.x,Ir+kn.y,Tn.x+Tn.w,Tn.y,s,sr,Vn.x,On.y,fn,tr),_a(Ee,T.x,T.y,tn.x,Ir+tn.y,Tn.x,Tn.y+Tn.h,s,sr,On.x,Vn.y,fn,tr),_a(Ee,T.x,T.y,Cn.x,Ir+Cn.y,Tn.x+Tn.w,Tn.y+Tn.h,s,sr,Vn.x,Vn.y,fn,tr),C){const{x:oi,y:Ui,z:si}=C.anchor,[jr,Ao,ci]=C.up;ff(Ue,oi,Ui,si,jr,Ao,ci),ff(Ue,oi,Ui,si,jr,Ao,ci),ff(Ue,oi,Ui,si,jr,Ao,ci),ff(Ue,oi,Ui,si,jr,Ao,ci),pf(e.dynamicLayoutVertexArray,oi,Ui,si,ft)}else pf(e.dynamicLayoutVertexArray,T.x,T.y,T.z,ft);le.emplaceBack(Un,Un+1,Un+2),le.emplaceBack(Un+1,Un+2,Un+3),rt.vertexLength+=4,rt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fr[0]),Ut!==r.length-1&&ri===r[Ut+1].sectionIndex||e.programConfigurations.populatePaintArrays(Ee.length,_,_.index,{},q,J,ht&&ht[ri])}const Yt=C?C.anchor:T;e.placedSymbolArray.emplaceBack(Yt.x,Yt.y,Yt.z,T.x,T.y,je,this.glyphOffsetArray.length-je,it,F,V,T.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],x,0,!1,0,j,0)}_commitLayoutVertex(e,r,s,u,f,_,x){e.emplaceBack(r,s,u,f,_,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(e,r,s,u,f,_,x){const C=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),T=C.vertexLength,F=x.tileAnchorX,V=x.tileAnchorY;for(let q=0;q<4;q++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,u,f,_,F,V,new Ie(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,_,F,V,new Ie(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,_,F,V,new Ie(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,f,_,F,V,new Ie(e.x1,e.y2)),C.vertexLength+=4;const j=s.indexArray;j.emplaceBack(T,T+1),j.emplaceBack(T+1,T+2),j.emplaceBack(T+2,T+3),j.emplaceBack(T+3,T),C.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,s,u,f,_){for(let x=u;x<f;x++){const C=s.get(x),T=this.getSymbolInstanceTextSize(e,_,r,x);this._addCollisionDebugVertices(C,T,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(e,r,s,u,f,_){for(let x=u;x<f;x++){const C=s.get(x),T=this.getSymbolInstanceIconSize(e,r,_.placedIconSymbolIndex);this._addCollisionDebugVertices(C,T,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,_)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mf(ur,Du.members,zs),this.iconCollisionBox=new mf(ur,Du.members,zs);const s=Cu(this.iconSizeData,e),u=Cu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,r,_.textBoxStartIndex,_.textBoxEndIndex,_),this._addTextDebugCollisionBoxes(u,e,r,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._addIconDebugCollisionBoxes(s,e,r,_.iconBoxStartIndex,_.iconBoxEndIndex,_),this._addIconDebugCollisionBoxes(s,e,r,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_)}}getSymbolInstanceTextSize(e,r,s,u){const f=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),_=Xc(this.textSizeData,e,f)/Rs;return this.tilePixelRatio*_}getSymbolInstanceIconSize(e,r,s){const u=this.icon.placedSymbolArray.get(s),f=Xc(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,r,s){e.emplaceBack(r,-s,-s),e.emplaceBack(r,s,-s),e.emplaceBack(r,s,s),e.emplaceBack(r,-s,s)}_updateTextDebugCollisionBoxes(e,r,s,u,f,_){for(let x=u;x<f;x++){const C=s.get(x),T=this.getSymbolInstanceTextSize(e,_,r,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,C.padding)}}_updateIconDebugCollisionBoxes(e,r,s,u,f,_){for(let x=u;x<f;x++){const C=s.get(x),T=this.getSymbolInstanceIconSize(e,r,_);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,C.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Cu(this.iconSizeData,e),u=Cu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,r,_.textBoxStartIndex,_.textBoxEndIndex,_),this._updateTextDebugCollisionBoxes(u,e,r,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._updateIconDebugCollisionBoxes(s,e,r,_.iconBoxStartIndex,_.iconBoxEndIndex,_.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,r,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,s,u,f,_,x,C,T){const F={};if(r<s){const{x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it,featureIndex:ft}=e.get(r);F.textBox={x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it},F.textFeatureIndex=ft}if(u<f){const{x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it,featureIndex:ft}=e.get(u);F.verticalTextBox={x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it},F.verticalTextFeatureIndex=ft}if(_<x){const{x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it,featureIndex:ft}=e.get(_);F.iconBox={x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it},F.iconFeatureIndex=ft}if(C<T){const{x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it,featureIndex:ft}=e.get(C);F.verticalIconBox={x1:V,y1:j,x2:q,y2:J,padding:le,projectedAnchorX:Ee,projectedAnchorY:Ue,projectedAnchorZ:rt,tileAnchorX:je,tileAnchorY:it},F.verticalIconFeatureIndex=ft}return F}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const s=e.placedSymbolArray.get(r),u=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const r=Math.sin(e),s=Math.cos(e),u=[],f=[],_=[];for(let x=0;x<this.symbolInstances.length;++x){_.push(x);const C=this.symbolInstances.get(x);u.push(0|Math.round(r*C.tileAnchorX+s*C.tileAnchorY)),f.push(C.featureIndex)}return _.sort((x,C)=>u[x]-u[C]||f[C]-f[x]),_}addToSortKeyRanges(e,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:T}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),f>=0&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&_!==u&&this.addIndicesForPlacedSymbol(this.text,_),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}E(nu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nu.MAX_GLYPHS=65535,nu.addDynamicAttributes=pf;const py=new Ve({"symbol-placement":new ae(on.layout_symbol["symbol-placement"]),"symbol-spacing":new ae(on.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ae(on.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Te(on.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ae(on.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ae(on.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ae(on.layout_symbol["icon-ignore-placement"]),"icon-optional":new ae(on.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ae(on.layout_symbol["icon-rotation-alignment"]),"icon-size":new Te(on.layout_symbol["icon-size"]),"icon-text-fit":new ae(on.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ae(on.layout_symbol["icon-text-fit-padding"]),"icon-image":new Te(on.layout_symbol["icon-image"]),"icon-rotate":new Te(on.layout_symbol["icon-rotate"]),"icon-padding":new ae(on.layout_symbol["icon-padding"]),"icon-keep-upright":new ae(on.layout_symbol["icon-keep-upright"]),"icon-offset":new Te(on.layout_symbol["icon-offset"]),"icon-anchor":new Te(on.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ae(on.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ae(on.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ae(on.layout_symbol["text-rotation-alignment"]),"text-field":new Te(on.layout_symbol["text-field"]),"text-font":new Te(on.layout_symbol["text-font"]),"text-size":new Te(on.layout_symbol["text-size"]),"text-max-width":new Te(on.layout_symbol["text-max-width"]),"text-line-height":new Te(on.layout_symbol["text-line-height"]),"text-letter-spacing":new Te(on.layout_symbol["text-letter-spacing"]),"text-justify":new Te(on.layout_symbol["text-justify"]),"text-radial-offset":new Te(on.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ae(on.layout_symbol["text-variable-anchor"]),"text-anchor":new Te(on.layout_symbol["text-anchor"]),"text-max-angle":new ae(on.layout_symbol["text-max-angle"]),"text-writing-mode":new ae(on.layout_symbol["text-writing-mode"]),"text-rotate":new Te(on.layout_symbol["text-rotate"]),"text-padding":new ae(on.layout_symbol["text-padding"]),"text-keep-upright":new ae(on.layout_symbol["text-keep-upright"]),"text-transform":new Te(on.layout_symbol["text-transform"]),"text-offset":new Te(on.layout_symbol["text-offset"]),"text-allow-overlap":new ae(on.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ae(on.layout_symbol["text-ignore-placement"]),"text-optional":new ae(on.layout_symbol["text-optional"])});var Np={paint:new Ve({"icon-opacity":new Te(on.paint_symbol["icon-opacity"]),"icon-color":new Te(on.paint_symbol["icon-color"]),"icon-halo-color":new Te(on.paint_symbol["icon-halo-color"]),"icon-halo-width":new Te(on.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Te(on.paint_symbol["icon-halo-blur"]),"icon-translate":new ae(on.paint_symbol["icon-translate"]),"icon-translate-anchor":new ae(on.paint_symbol["icon-translate-anchor"]),"text-opacity":new Te(on.paint_symbol["text-opacity"]),"text-color":new Te(on.paint_symbol["text-color"],{runtimeType:$e,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Te(on.paint_symbol["text-halo-color"]),"text-halo-width":new Te(on.paint_symbol["text-halo-width"]),"text-halo-blur":new Te(on.paint_symbol["text-halo-blur"]),"text-translate":new ae(on.paint_symbol["text-translate"]),"text-translate-anchor":new ae(on.paint_symbol["text-translate-anchor"])}),layout:py};class zp{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:No,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}E(zp,"FormatSectionOverride",{omit:["defaultValue"]});class gf extends Sl{constructor(e){super(e,Np)}recalculate(e,r){super.recalculate(e,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const f of s)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,s,u){const f=this.layout.get(e).evaluate(r,{},s,u),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||ta(_.value)||!f?f:(x=r.properties,f.replace(/{([^{}]+)}/g,(T,F)=>F in x?String(x[F]):""));var x}createBucket(e){return new nu(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Np.paint.overridableProperties){if(!gf.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),s=new zp(r),u=new Ps(s,r.property.specification);let f=null;f="constant"===r.value.kind||"source"===r.value.kind?new _s("source",u):new Cs("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new De(r.property,f,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&gf.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const s=e.get("text-field"),u=Np.paint.properties[r];let f=!1;const _=x=>{for(const C of x)if(u.overrides&&u.overrides.hasOverride(C))return void(f=!0)};if("constant"===s.value.kind&&s.value.value instanceof Ai)_(s.value.value.sections);else if("source"===s.value.kind){const x=T=>{f||(T instanceof rr&&Bi(T.value)===kt?_(T.value.sections):T instanceof Si?_(T.sections):T.eachChild(x))},C=s.value;C._styleExpression&&x(C._styleExpression.expression)}return f}getProgramConfiguration(e){return new Nc(this,e)}}var my={paint:new Ve({"background-color":new ae(on.paint_background["background-color"]),"background-pattern":new ae(on.paint_background["background-pattern"]),"background-opacity":new ae(on.paint_background["background-opacity"])})},$p={paint:new Ve({"raster-opacity":new ae(on.paint_raster["raster-opacity"]),"raster-hue-rotate":new ae(on.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ae(on.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ae(on.paint_raster["raster-brightness-max"]),"raster-saturation":new ae(on.paint_raster["raster-saturation"]),"raster-contrast":new ae(on.paint_raster["raster-contrast"]),"raster-resampling":new ae(on.paint_raster["raster-resampling"]),"raster-fade-duration":new ae(on.paint_raster["raster-fade-duration"])})};class gy extends Sl{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var _y={paint:new Ve({"sky-type":new ae(on.paint_sky["sky-type"]),"sky-atmosphere-sun":new ae(on.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ae(on.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ae(on.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ae(on.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ge(on.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ae(on.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ae(on.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ae(on.paint_sky["sky-opacity"])})};function Vp(n,e,r){const s=[0,0,1],u=zf([]);return Cd(u,u,r?-Ye(n)+Math.PI:Ye(n)),$f(u,u,-Ye(e)),S_(s,s,u),ra(s,s)}const yy={circle:class extends Sl{constructor(n){super(n,Xu)}createBucket(n){return new Vh(n)}queryRadius(n){const e=n;return Yu("circle-radius",this,e)+Yu("circle-stroke-width",this,e)+Fd(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,r,s,u,f,_,x){const C=Bd(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return Om(n,s,f,_,x,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),C,T)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Nc(this,n)}},heatmap:class extends Sl{createBucket(n){return new km(n)}constructor(n){super(n,Lm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"heatmap-color"===n&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Uh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Yu("heatmap-radius",this,n)}queryIntersectsFeature(n,e,r,s,u,f,_,x){const C=this.paint.get("heatmap-radius").evaluate(e,r);return Om(n,s,f,_,x,!0,!0,new Ie(0,0),C)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Nc(this,n)}},hillshade:class extends Sl{constructor(n){super(n,L_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Sl{constructor(n){super(n,ed)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(n){return new Nc(this,n)}recalculate(n,e){super.recalculate(n,e);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Qu(n)}queryRadius(){return Fd(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,r,s,u,f){return!n.queryGeometry.isAboveHorizon&&Qf(tp(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Sl{constructor(n){super(n,Kh)}createBucket(n){return new qd(n)}queryRadius(){return Fd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Nc(this,n)}queryIntersectsFeature(n,e,r,s,u,f,_,x,C){const T=Bd(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(e,r),V=this.paint.get("fill-extrusion-base").evaluate(e,r),j=[0,0],q=x&&f.elevation,J=f.elevation?f.elevation.exaggeration():1,le=n.tile.getBucket(this);if(q&&le instanceof qd){const it=le.centroidVertexArray,ft=C+1;ft<it.length&&(j[0]=it.geta_centroid_pos0(ft),j[1]=it.geta_centroid_pos1(ft))}if(0===j[0]&&1===j[1])return!1;"globe"===f.projection.name&&(s=Jm([s],[new Ie(0,0),new Ie(Pr,Pr)],n.tileID.canonical).map(it=>it.polygon).flat());const Ee=q?x:null,[Ue,rt]=(ft=s,ht=V,Yt=F,Ut=T,hn=_,kn=Ee,tn=j,Cn=J,Tn=f.center.lat,"globe"===(it=f).projection.name?function(Vn,fn,tr,fr,sr,ri,Un,Ir,oi,Ui,si){const jr=[],Ao=[],ci=Vn.projection.upVectorScale(si,Vn.center.lat,Vn.worldSize).metersToTile,ai=[0,0,0,1],xo=[0,0,0,1],bo=(mo,Lo,Fo,os)=>{mo[0]=Lo,mo[1]=Fo,mo[2]=os,mo[3]=1},wo=Zd();tr>0&&(tr+=wo),fr+=wo;for(const mo of fn){const Lo=[],Fo=[];for(const os of mo){const Xi=os.x+sr.x,xs=os.y+sr.y,Go=Vn.projection.projectTilePoint(Xi,xs,si),Wo=Vn.projection.upVector(si,os.x,os.y);let ji=tr,qo=fr;if(Un){const Eo=eg(Xi,xs,tr,fr,Un,Ir,oi,Ui);ji+=Eo.base,qo+=Eo.top}0!==tr?bo(ai,Go.x+Wo[0]*ci*ji,Go.y+Wo[1]*ci*ji,Go.z+Wo[2]*ci*ji):bo(ai,Go.x,Go.y,Go.z),bo(xo,Go.x+Wo[0]*ci*qo,Go.y+Wo[1]*ci*qo,Go.z+Wo[2]*ci*qo),vs(ai,ai,ri),vs(xo,xo,ri),Lo.push(new Eu(ai[0],ai[1],ai[2])),Fo.push(new Eu(xo[0],xo[1],xo[2]))}jr.push(Lo),Ao.push(Fo)}return[jr,Ao]}(it,ft,ht,Yt,Ut,hn,kn,tn,Cn,Tn,n.tileID.canonical):kn?function(Vn,fn,tr,fr,sr,ri,Un,Ir,oi){const Ui=[],si=[],jr=[0,0,0,1];for(const Ao of Vn){const ci=[],ai=[];for(const xo of Ao){const bo=xo.x+fr.x,wo=xo.y+fr.y,mo=eg(bo,wo,fn,tr,ri,Un,Ir,oi);jr[0]=bo,jr[1]=wo,jr[2]=mo.base,jr[3]=1,zc(jr,jr,sr),jr[3]=Math.max(jr[3],1e-5);const Lo=new Eu(jr[0]/jr[3],jr[1]/jr[3],jr[2]/jr[3]);jr[0]=bo,jr[1]=wo,jr[2]=mo.top,jr[3]=1,zc(jr,jr,sr),jr[3]=Math.max(jr[3],1e-5);const Fo=new Eu(jr[0]/jr[3],jr[1]/jr[3],jr[2]/jr[3]);ci.push(Lo),ai.push(Fo)}Ui.push(ci),si.push(ai)}return[Ui,si]}(ft,ht,Yt,Ut,hn,kn,tn,Cn,Tn):function(Vn,fn,tr,fr,sr){const ri=[],Un=[],Ir=sr[8]*fn,oi=sr[9]*fn,Ui=sr[10]*fn,si=sr[11]*fn,jr=sr[8]*tr,Ao=sr[9]*tr,ci=sr[10]*tr,ai=sr[11]*tr;for(const xo of Vn){const bo=[],wo=[];for(const mo of xo){const Lo=mo.x+fr.x,Fo=mo.y+fr.y,os=sr[0]*Lo+sr[4]*Fo+sr[12],Xi=sr[1]*Lo+sr[5]*Fo+sr[13],xs=sr[2]*Lo+sr[6]*Fo+sr[14],Go=sr[3]*Lo+sr[7]*Fo+sr[15],Wo=os+Ir,ji=Xi+oi,qo=xs+Ui,Eo=Math.max(Go+si,1e-5),ya=os+jr,bs=Xi+Ao,Ys=xs+ci,Is=Math.max(Go+ai,1e-5);bo.push(new Eu(Wo/Eo,ji/Eo,qo/Eo)),wo.push(new Eu(ya/Is,bs/Is,Ys/Is))}ri.push(bo),Un.push(wo)}return[ri,Un]}(ft,ht,Yt,Ut,hn)),je=n.queryGeometry;var it,ft,ht,Yt,Ut,hn,kn,tn,Cn,Tn;return function(it,ft,ht){let Yt=1/0;Qf(ht,ft)&&(Yt=Qm(ht,ft[0]));for(let Ut=0;Ut<ft.length;Ut++){const hn=ft[Ut],kn=it[Ut];for(let tn=0;tn<hn.length-1;tn++){const Cn=hn[tn],Tn=[Cn,hn[tn+1],kn[tn+1],kn[tn],Cn];Od(ht,Tn)&&(Yt=Math.min(Yt,Qm(ht,Tn)))}}return Yt!==1/0&&Yt}(Ue,rt,je.isPointQuery()?je.screenBounds:je.screenGeometry)}},line:class extends Sl{constructor(n){super(n,rg),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if("line-gradient"===n){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof P,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=ig.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new pp(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Nc(this,n)}queryRadius(n){const e=n,r=X_(Yu("line-width",this,e),Yu("line-gap-width",this,e)),s=Yu("line-offset",this,e);return r/2+Math.abs(s)+Fd(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,r,s,u,f){if(n.queryGeometry.isAboveHorizon)return!1;const _=tp(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),x=n.pixelToTileUnitsFactor/2*X_(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),C=this.paint.get("line-offset").evaluate(e,r);return C&&(s=function(T,F){const V=[],j=new Ie(0,0);for(let q=0;q<T.length;q++){const J=T[q],le=[];for(let Ee=0;Ee<J.length;Ee++){const Ue=J[Ee],rt=J[Ee+1],je=0===Ee?j:Ue.sub(J[Ee-1])._unit()._perp(),it=Ee===J.length-1?j:rt.sub(Ue)._unit()._perp(),ft=je._add(it)._unit();ft._mult(1/(ft.x*it.x+ft.y*it.y)),le.push(ft._mult(F)._add(Ue))}V.push(le)}return V}(s,C*n.pixelToTileUnitsFactor)),function(T,F,V){for(let j=0;j<F.length;j++){const q=F[j];if(T.length>=3)for(let J=0;J<q.length;J++)if(Wc(T,q[J]))return!0;if(ep(T,q,V))return!0}return!1}(_,s,x)}isTileClipped(){return!0}},symbol:gf,background:class extends Sl{constructor(n){super(n,my)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Sl{constructor(n){super(n,$p)}getProgramIds(){return["raster"]}},sky:class extends Sl{constructor(n){super(n,_y),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"sky-gradient"===n?this._updateColorRamp():"sky-atmosphere-sun"!==n&&"sky-atmosphere-halo-color"!==n&&"sky-atmosphere-color"!==n&&"sky-atmosphere-sun-intensity"!==n||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Uh({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),u=!s,f=n.style.light,_=f.properties.get("position");return u&&"viewport"===f.properties.get("anchor")&&dn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Vp(_.azimuthal,90-_.polar,e):Vp(s[0],90-s[1],e)}const r=this.paint.get("sky-gradient-center");return Vp(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return"atmosphere"===n?["skyboxCapture","skybox"]:"gradient"===n?["skyboxGradient"]:null}}};class ch{constructor(e,r,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,s){const{width:u,height:f}=e,{context:_}=this,{gl:x}=_,{HTMLImageElement:C,HTMLCanvasElement:T,HTMLVideoElement:F,ImageData:V,ImageBitmap:j}=_e;if(x.bindTexture(x.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!r||!1!==r.premultiply)),s||this.size&&this.size[0]===u&&this.size[1]===f){const{x:q,y:J}=s||{x:0,y:0};e instanceof C||e instanceof T||e instanceof F||e instanceof V||j&&e instanceof j?x.texSubImage2D(x.TEXTURE_2D,0,q,J,x.RGBA,x.UNSIGNED_BYTE,e):x.texSubImage2D(x.TEXTURE_2D,0,q,J,u,f,x.RGBA,x.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof C||e instanceof T||e instanceof F||e instanceof V||j&&e instanceof j?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,e):x.texImage2D(x.TEXTURE_2D,0,this.format,u,f,0,this.format,x.UNSIGNED_BYTE,e.data);this.useMipmap=!!(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(e,r){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class lc{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Up{constructor(){this.tasks={},this.taskQueue=[],ln(["process"],this),this.invoker=new lc(this.process),this.nextId=0}add(e,r){const s=this.nextId++,u=function({type:f,isSymbolTile:_,zoom:x}){return x=x||0,"message"===f?0:"maybePrepare"!==f||_?"parseTile"!==f||_?"parseTile"===f&&_?300-x:"maybePrepare"===f&&_?400-x:500:200-x:100-x}(r);if(0===u){nr();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:r,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){nr();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<r&&(r=f.priority,e=u)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class kg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const s=e[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Lg=["tile","layer","source","sourceLayer","state"];class Fg{constructor(e,r,s,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=s,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const r of Lg)void 0!==this[r]&&(e[r]=this[r]);return e}}const Nl=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,r=0,s=0,u=0,f=0,_=0,x=0;for(1&e?u=f=_=32:r=s=x=32;(e>>=1)>1;){const T=r+u>>1,F=s+f>>1;1&e?(u=r,f=s,r=_,s=x):(r=u,s=f,u=_,f=x),_=T,x=F}const C=4*n;Nl[C+0]=r,Nl[C+1]=s,Nl[C+2]=u,Nl[C+3]=f}const pl=new Uint16Array(2178),Ru=new Uint8Array(1089),uh=new Uint16Array(1089);function jp(n){return 0===n?-.03125:32===n?.03125:0}var Hp=Tt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Gp={type:2,extent:Pr,loadGeometry:()=>[[new Ie(0,0),new Ie(Pr+1,0),new Ie(Pr+1,Pr+1),new Ie(0,Pr+1),new Ie(0,0)]]};class dh{constructor(e,r,s,u,f){this.tileID=e,this.uid=ut(),this.uses=0,this.tileSize=r,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<di.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=eu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const _={};if(!f)return _;for(const x of u){const C=x.layerIds.map(T=>f.getLayer(T)).filter(Boolean);if(0!==C.length){x.layers=C,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(T=>C.filter(F=>F.id===T)[0]));for(const T of C)_[T.id]=x}}return _}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof nu){if(this.hasSymbolBuckets=!0,!s)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof nu&&f.hasRTLText){this.hasRTLText=!0,O.isLoading()||O.isLoaded()||"deferred"!==D()||A();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Vi}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const u=this.buckets[s];u.uploadPending()&&u.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ch(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ch(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ch(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,s,u,f,_,x,C){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:x,transform:_,params:f,tileTransform:this.tileTransform},e,r,s):{}}querySourceFeatures(e,r){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),f=r?r.sourceLayer:"",_=u._geojsonTileLayer||u[f];if(!_)return;const x=Da(r&&r.filter),{z:C,x:T,y:F}=this.tileID.canonical,V={z:C,x:T,y:F};for(let j=0;j<_.length;j++){const q=_.feature(j);if(x.needGeometry){const Ee=Gc(q,!0);if(!x.filter(new z(this.tileID.overscaledZ),Ee,this.tileID.canonical))continue}else if(!x.filter(new z(this.tileID.overscaledZ),q))continue;const J=s.getId(q,f),le=new Fg(q,C,T,F,J);le.tile=V,e.push(le)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const s=gr(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const f=this.expirationTime-r;f?this.expirationTime=s+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!r)return;const s=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const _=this.buckets[f],x=_.layers[0].sourceLayer||"_geojsonTileLayer",C=s[x],T=e[x];if(!C||!T||0===Object.keys(T).length)continue;if(_.update(T,C,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),_ instanceof pp||_ instanceof Qu){const V=r.style._getSourceCache(_.layers[0].source);r._terrain&&r._terrain.enabled&&V&&_.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(V.id,this.tileID)}const F=r&&r.style&&r.style.getLayer(f);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(_)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<di.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=di.now()+e}setTexture(e,r){const s=r.context,u=s.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new ch(s,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,r){const s={};for(const u of r)s[u]=!0;this.dependencies[e]=s}hasDependency(e,r){for(const s of e){const u=this.dependencies[s];if(u)for(const f of r)if(u[f])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||"mercator"===r.name||this._tileDebugBuffer)return;const s=ic(Gp,this.tileID.canonical,this.tileTransform)[0],u=new Rn,f=new Sa;for(let _=0;_<s.length;_++){const{x,y:C}=s[_];u.emplaceBack(x,C),f.emplaceBack(_)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,Td.members),this._tileDebugSegments=fs.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||"mercator"===r.name)return;const s=ic(Gp,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const _=function(x,C){const T=eu(x,C),F=Math.pow(2,x.z);for(let Ee=0;Ee<33;Ee++)for(let Ue=0;Ue<33;Ue++){const rt=Aa((x.x+(Ue+jp(Ue))/32)/F),je=Us((x.y+(Ee+jp(Ee))/32)/F),it=C.project(rt,je),ft=33*Ee+Ue;pl[2*ft+0]=Math.round((it.x*T.scale-T.x)*Pr),pl[2*ft+1]=Math.round((it.y*T.scale-T.y)*Pr)}Ru.fill(0),uh.fill(0);for(let Ee=2045;Ee>=0;Ee--){const Ue=4*Ee,rt=Nl[Ue+0],je=Nl[Ue+1],it=Nl[Ue+2],ft=Nl[Ue+3],ht=rt+it>>1,Yt=je+ft>>1,Ut=ht+Yt-je,hn=Yt+rt-ht,kn=33*je+rt,tn=33*ft+it,Cn=33*Yt+ht,Tn=Math.hypot((pl[2*kn+0]+pl[2*tn+0])/2-pl[2*Cn+0],(pl[2*kn+1]+pl[2*tn+1])/2-pl[2*Cn+1])>=16;Ru[Cn]=Ru[Cn]||(Tn?1:0),Ee<1022&&(Ru[Cn]=Ru[Cn]||Ru[33*(je+hn>>1)+(rt+Ut>>1)]||Ru[33*(ft+hn>>1)+(it+Ut>>1)])}const V=new Dn,j=new xr;let q=0;function J(Ee,Ue){const rt=33*Ue+Ee;return 0===uh[rt]&&(V.emplaceBack(pl[2*rt+0],pl[2*rt+1],Ee*Pr/32,Ue*Pr/32),uh[rt]=++q),uh[rt]-1}function le(Ee,Ue,rt,je,it,ft){const ht=Ee+rt>>1,Yt=Ue+je>>1;if(Math.abs(Ee-it)+Math.abs(Ue-ft)>1&&Ru[33*Yt+ht])le(it,ft,Ee,Ue,ht,Yt),le(rt,je,it,ft,ht,Yt);else{const Ut=J(Ee,Ue),hn=J(rt,je),kn=J(it,ft);j.emplaceBack(Ut,hn,kn)}}return le(0,0,32,32,32,0),le(32,32,0,0,0,32),{vertices:V,indices:j}}(this.tileID.canonical,r);u=_.vertices,f=_.indices}else{u=new Dn,f=new xr;for(const{x,y:C}of s)u.emplaceBack(x,C,0,0);const _=Nm(u.int16,void 0,4);for(let x=0;x<_.length;x+=3)f.emplaceBack(_[x],_[x+1],_[x+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,Hp.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=fs.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,r){const s=r.projection;if(!s||"globe"!==s.name||r.freezeTileCoverage)return;const u=this.tileID.canonical,f=Md(Wf(u,r)),_=_u(r.zoom);let x;_>0&&(x=Ff(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,r,f,x,_),this._makeGlobeTileDebugTextBuffer(e,u,r,f,x,_)}_globePoint(e,r,s,u,f,_,x){let C=Id(e,r,s);if(_){const T=1<<s.z,F=rc(u.center.lng),V=Rl(u.center.lat),j=(s.x+.5)/T-F;let q=0;j>.5?q=-1:j<-.5&&(q=1);let J=(e/Pr+s.x)/T+q,le=(r/Pr+s.y)/T;J=(J-F)*u._pixelsPerMercatorPixel+F,le=(le-V)*u._pixelsPerMercatorPixel+V;const Ee=[J*u.worldSize,le*u.worldSize,0];vs(Ee,Ee,_),C=gu(C,Ee,x)}return vs(C,C,f)}_makeGlobeTileDebugBorderBuffer(e,r,s,u,f,_){const x=new Rn,C=new Sa,T=new Ht,F=(j,q,J,le,Ee)=>{const Ue=(J-j)/(Ee-1),rt=(le-q)/(Ee-1),je=x.length;for(let it=0;it<Ee;it++){const ft=j+it*Ue,ht=q+it*rt;x.emplaceBack(ft,ht);const Yt=this._globePoint(ft,ht,r,s,u,f,_);T.emplaceBack(Yt[0],Yt[1],Yt[2]),C.emplaceBack(je+it)}},V=Pr;F(0,0,V,0,16),F(V,0,V,V,16),F(V,V,0,V,16),F(0,V,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(C),this._tileDebugBuffer=e.createVertexBuffer(x,Td.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(T,wm.members),this._tileDebugSegments=fs.simpleSegment(0,0,x.length,C.length)}_makeGlobeTileDebugTextBuffer(e,r,s,u,f,_){const x=Pr/4,C=new Rn,T=new xr,F=new Ht,V=25;T.reserve(32),C.reserve(V),F.reserve(V);const j=(q,J)=>V*q+J;for(let q=0;q<V;q++){const J=q*x;for(let le=0;le<V;le++){const Ee=le*x;C.emplaceBack(Ee,J);const Ue=this._globePoint(Ee,J,r,s,u,f,_);F.emplaceBack(Ue[0],Ue[1],Ue[2])}}for(let q=0;q<4;q++)for(let J=0;J<4;J++){const le=j(q,J),Ee=j(q,J+1),Ue=j(q+1,J),rt=j(q+1,J+1);T.emplaceBack(le,Ee,Ue),T.emplaceBack(Ue,Ee,rt)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(T),this._tileDebugTextBuffer=e.createVertexBuffer(C,Td.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(F,wm.members),this._tileDebugTextSegments=fs.simpleSegment(0,0,V,32)}}class Dc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,s){const u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Se(this.stateChanges[e][u],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][u]){this.deletedStates[e][u]={};for(const f in this.state[e][u])s[f]||(this.deletedStates[e][u][f]=null)}else for(const f in s)this.deletedStates[e]&&this.deletedStates[e][u]&&null===this.deletedStates[e][u][f]&&delete this.deletedStates[e][u][f]}removeFeatureState(e,r,s){if(null===this.deletedStates[e])return;const u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==r)null!==this.deletedStates[e][u]&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(void 0!==r)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){const s=String(r),u=Se({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const f=this.deletedStates[e][r];if(null===f)return{};for(const _ in f)delete u[_]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const _ in this.stateChanges[u])this.state[u][_]||(this.state[u][_]={}),Se(this.state[u][_],this.stateChanges[u][_]),f[_]=this.state[u][_];s[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(null===this.deletedStates[u])for(const _ in this.state[u])f[_]={},this.state[u][_]={};else for(const _ in this.deletedStates[u]){if(null===this.deletedStates[u][_])this.state[u][_]={};else if(this.state[u][_])for(const x of Object.keys(this.deletedStates[u][_]))delete this.state[u][_][x];f[_]=this.state[u][_]}s[u]=s[u]||{},Se(s[u],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const u in e)e[u].setFeatureState(s,r)}}class Bg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const s=this.toIdx(e,r);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function Ng(n,e,r,s){let u=0,f=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(s[_])<1e-15){if(r[_]<n[_]||r[_]>e[_])return null}else{const x=1/s[_];let C=(n[_]-r[_])*x,T=(e[_]-r[_])*x;if(C>T){const F=C;C=T,T=F}if(C>u&&(u=C),T<f&&(f=T),u>f)return null}return u}function _f(n,e,r,s,u,f,_,x,C,T,F){const V=s-n,j=u-e,q=f-r,J=_-n,le=x-e,Ee=C-r,Ue=F[1]*Ee-F[2]*le,rt=F[2]*J-F[0]*Ee,je=F[0]*le-F[1]*J,it=V*Ue+j*rt+q*je;if(Math.abs(it)<1e-15)return null;const ft=1/it,ht=T[0]-n,Yt=T[1]-e,Ut=T[2]-r,hn=(ht*Ue+Yt*rt+Ut*je)*ft;if(hn<0||hn>1)return null;const kn=Yt*q-Ut*j,tn=Ut*V-ht*q,Cn=ht*j-Yt*V,Tn=(F[0]*kn+F[1]*tn+F[2]*Cn)*ft;return Tn<0||hn+Tn>1?null:(J*kn+le*tn+Ee*Cn)*ft}function zg(n,e,r){return(n-e)/(r-e)}function Wp(n,e,r,s,u,f,_,x,C){const T=1<<r,F=f-s,V=_-u,j=(n+1)/T*F+s,q=(e+0)/T*V+u,J=(e+1)/T*V+u;x[0]=(n+0)/T*F+s,x[1]=q,C[0]=j,C[1]=J}class $g{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(f){const _=Math.ceil(Math.log2(f.dim/8)),x=[];let C=Math.ceil(Math.pow(2,_));const T=1/C,F=(q,J,le,Ee,Ue)=>{const rt=Ee?1:0,je=(q+1)*le-rt,it=J*le,ft=(J+1)*le-rt;Ue[0]=q*le,Ue[1]=it,Ue[2]=je,Ue[3]=ft};let V=new Bg(C);const j=[];for(let q=0;q<C*C;q++){F(q%C,Math.floor(q/C),T,!1,j);const J=ml(j[0],j[1],f),le=ml(j[2],j[1],f),Ee=ml(j[2],j[3],f),Ue=ml(j[0],j[3],f);V.minimums.push(Math.min(J,le,Ee,Ue)),V.maximums.push(Math.max(J,le,Ee,Ue)),V.leaves.push(1)}for(x.push(V),C/=2;C>=1;C/=2){const q=x[x.length-1];V=new Bg(C);for(let J=0;J<C*C;J++){F(J%C,Math.floor(J/C),2,!0,j);const le=q.getElevation(j[0],j[1]),Ee=q.getElevation(j[2],j[1]),Ue=q.getElevation(j[2],j[3]),rt=q.getElevation(j[0],j[3]),je=q.isLeaf(j[0],j[1]),it=q.isLeaf(j[2],j[1]),ft=q.isLeaf(j[2],j[3]),ht=q.isLeaf(j[0],j[3]),Yt=Math.min(le.min,Ee.min,Ue.min,rt.min),Ut=Math.max(le.max,Ee.max,Ue.max,rt.max),hn=je&&it&&ft&&ht;V.maximums.push(Ut),V.minimums.push(Yt),V.leaves.push(Ut-Yt<=5&&hn?1:0)}x.push(V)}return x}(this.dem),s=r.length-1,u=r[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,s,0)}raycastRoot(e,r,s,u,f,_,x=1){return Ng([e,r,-100],[s,u,this.maximums[0]*x],f,_)}raycast(e,r,s,u,f,_,x=1){if(!this.nodeCount)return null;const C=this.raycastRoot(e,r,s,u,f,_,x);if(null==C)return null;const T=[],F=[],V=[],j=[],q=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:J,t:le,nodex:Ee,nodey:Ue,depth:rt}=q.pop();if(this.leaves[J]){Wp(Ee,Ue,rt,e,r,s,u,V,j);const it=1<<rt,ft=(Ee+0)/it,ht=(Ee+1)/it,Yt=(Ue+0)/it,Ut=(Ue+1)/it,hn=ml(ft,Yt,this.dem)*x,kn=ml(ht,Yt,this.dem)*x,tn=ml(ht,Ut,this.dem)*x,Cn=ml(ft,Ut,this.dem)*x,Tn=_f(V[0],V[1],hn,j[0],V[1],kn,j[0],j[1],tn,f,_),On=_f(j[0],j[1],tn,V[0],j[1],Cn,V[0],V[1],hn,f,_),Vn=Math.min(null!==Tn?Tn:Number.MAX_VALUE,null!==On?On:Number.MAX_VALUE);if(Vn!==Number.MAX_VALUE)return Vn;{const fn=Mh([],f,_,le);if(hh(hn,kn,Cn,tn,zg(fn[0],V[0],j[0]),zg(fn[1],V[1],j[1]))>=fn[2])return le}continue}let je=0;for(let it=0;it<this._siblingOffset.length;it++){Wp((Ee<<1)+this._siblingOffset[it][0],(Ue<<1)+this._siblingOffset[it][1],rt+1,e,r,s,u,V,j),V[2]=-100,j[2]=this.maximums[this.childOffsets[J]+it]*x;const ft=Ng(V,j,f,_);if(null!=ft){const ht=ft;T[it]=ht;let Yt=!1;for(let Ut=0;Ut<je&&!Yt;Ut++)ht>=T[F[Ut]]&&(F.splice(Ut,0,it),Yt=!0);Yt||(F[je]=it),je++}}for(let it=0;it<je;it++){const ft=F[it];q.push({idx:this.childOffsets[J]+ft,t:T[ft],nodex:(Ee<<1)+this._siblingOffset[ft][0],nodey:(Ue<<1)+this._siblingOffset[ft][1],depth:rt+1})}}return null}_addNode(e,r,s){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,s,u,f){if(1===e[u].isLeaf(r,s))return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const _=u-1,x=e[_];let C=0,T=0;for(let F=0;F<this._siblingOffset.length;F++){const V=2*r+this._siblingOffset[F][0],j=2*s+this._siblingOffset[F][1],q=x.getElevation(V,j),J=x.isLeaf(V,j),le=this._addNode(q.min,q.max,J);J&&(C|=1<<F),T||(T=le)}for(let F=0;F<this._siblingOffset.length;F++)C&1<<F||this._construct(e,2*r+this._siblingOffset[F][0],2*s+this._siblingOffset[F][1],_,T+F)}}function hh(n,e,r,s,u,f){return K(K(n,r,f),K(e,s,f),u)}function ml(n,e,r){const s=r.dim,u=Vt(n*s-.5,0,s-1),f=Vt(e*s-.5,0,s-1),_=Math.floor(u),x=Math.floor(f),C=Math.min(_+1,s-1),T=Math.min(x+1,s-1);return hh(r.get(_,x),r.get(C,x),r.get(_,T),r.get(C,T),u-_,f-x)}const fh={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Rv(n,e,r){return(256*n*256+256*e+r)/10-1e4}function vy(n,e,r){return 256*n+e+r/256-32768}class ph{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,s,u=!1,f=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return dn(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const _=this.dim=r.height-2,x=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=s||"mapbox",this.borderReady=u,!u){for(let C=0;C<_;C++)x[this._idx(-1,C)]=x[this._idx(0,C)],x[this._idx(_,C)]=x[this._idx(_-1,C)],x[this._idx(C,-1)]=x[this._idx(C,0)],x[this._idx(C,_)]=x[this._idx(C,_-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(_,-1)]=x[this._idx(_-1,0)],x[this._idx(-1,_)]=x[this._idx(0,_-1)],x[this._idx(_,_)]=x[this._idx(_-1,_-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new $g(this)}get(e,r,s=!1){s&&(e=Vt(e,-1,this.dim),r=Vt(r,-1,this.dim));const u=4*this._idx(e,r);return("terrarium"===this.encoding?vy:Rv)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return fh[e]}get unpackVector(){return fh[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}static pack(e,r){const s=[0,0,0,0],u=ph.getUnpackVector(r);let f=Math.floor((e+u[3])/u[2]);return s[2]=f%256,f=Math.floor(f/256),s[1]=f%256,f=Math.floor(f/256),s[0]=f,s}getPixels(){return new Pa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,f=r*this.dim+this.dim,_=s*this.dim,x=s*this.dim+this.dim;switch(r){case-1:u=f-1;break;case 1:f=u+1}switch(s){case-1:_=x-1;break;case 1:x=_+1}const C=-r*this.dim,T=-s*this.dim;for(let F=_;F<x;F++)for(let V=u;V<f;V++){const j=4*this._idx(V,F),q=4*this._idx(V+C,F+T);this.pixels[j+0]=e.pixels[q+0],this.pixels[j+1]=e.pixels[q+1],this.pixels[j+2]=e.pixels[q+2],this.pixels[j+3]=e.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}E(ph,"DEMData"),E($g,"DemMinMaxQuadTree",{omit:["dem"]});class Vg{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,s){const u=e.wrapped().key;void 0===this.data[u]&&(this.data[u]=[]);const f={value:r,timeout:void 0};if(void 0!==s&&(f.timeout=setTimeout(()=>{this.remove(e,f)},s)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const s=e.wrapped().key,u=void 0===r?0:this.data[s].indexOf(r),f=this.data[s][u];return this.data[s].splice(u,1),f.timeout&&clearTimeout(f.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(f.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const s in this.data)for(const u of this.data[s])e(u.value)||r.push(u);for(const s of r)this.remove(s.value.tileID,s)}}class dd{constructor(e,r,s){this.func=e,this.mask=r,this.range=s}}dd.ReadOnly=!1,dd.ReadWrite=!0,dd.disabled=new dd(519,dd.ReadOnly,[0,1]);class yf{constructor(e,r,s,u,f,_){this.test=e,this.ref=r,this.mask=s,this.fail=u,this.depthFail=f,this.pass=_}}yf.disabled=new yf({func:519,mask:0},0,0,7680,7680,7680);class zl{constructor(e,r,s){this.blendFunction=e,this.blendColor=r,this.mask=s}}zl.Replace=[1,0],zl.disabled=new zl(zl.Replace,qr.transparent,[!1,!1,!1,!1]),zl.unblended=new zl(zl.Replace,qr.transparent,[!0,!0,!0,!0]),zl.alphaBlended=new zl([1,771],qr.transparent,[!0,!0,!0,!0]);class gl{constructor(e,r,s){this.enable=e,this.mode=r,this.frontFace=s}}gl.disabled=new gl(!1,1029,2305),gl.backCCW=new gl(!0,1029,2305),gl.backCW=new gl(!0,1029,2304),gl.frontCW=new gl(!0,1028,2304),gl.frontCCW=new gl(!0,1028,2305);class ru extends Es{constructor(e,r,s){super(),this.id=e,this._onlySymbols=s,r.on("data",u=>{"source"===u.dataType&&"metadata"===u.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===u.dataType&&"content"===u.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new Vg(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Dc,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if("loaded"!==r.state&&"errored"!==r.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const s=this._tiles[r];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return zt(this._tiles).map(e=>e.tileID).sort(Ug).map(e=>e.key)}getRenderableIds(e){const r=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&r.push(this._tiles[s]);return e?r.sort((s,u)=>{const f=s.tileID,_=u.tileID,x=new Ie(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),C=new Ie(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-_.overscaledZ||C.y-x.y||C.x-x.x}).map(s=>s.tileID.key):r.map(s=>s.tileID).sort(Ug).map(s=>s.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=r),this._loadTile(s,this._tileLoaded.bind(this,s,e,r)))}_tileLoaded(e,r,s,u){if(u)if(e.state="errored",404!==u.status)this._source.fire(new Gr(u,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=di.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new li("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const f=r[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const _=this.getTileByID(f);s(e,_),s(_,e)}}function s(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let _=f.tileID.canonical.x-u.tileID.canonical.x;const x=f.tileID.canonical.y-u.tileID.canonical.y,C=Math.pow(2,u.tileID.canonical.z),T=f.tileID.key;0===_&&0===x||Math.abs(x)>1||(Math.abs(_)>1&&(1===Math.abs(_+C)?_+=C:1===Math.abs(_-C)&&(_-=C)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,_,x),u.neighboringTiles&&u.neighboringTiles[T]&&(u.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,s,u){for(const f in this._tiles){let _=this._tiles[f];if(u[f]||!_.hasData()||_.tileID.overscaledZ<=r||_.tileID.overscaledZ>s)continue;let x=_.tileID;for(;_&&_.tileID.overscaledZ>r+1;){const T=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[T.key],_&&_.hasData()&&(x=T)}let C=x;for(;C.overscaledZ>r;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]){u[x.key]=x;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=r?s:null}for(let s=e.overscaledZ-1;s>=r;s--){const u=e.scaledTo(s),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const s=Math.ceil(e.width/r)+1,u=Math.ceil(e.height/r)+1,f=Math.floor(s*u*5),_="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,f):f,x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(x)}handleWrapJump(e){const r=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,r){const s={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+r),s[f.tileID.key]=f}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,r,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let u;this.updateCacheSize(e,r),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new ga(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(u=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(x=>this._source.hasTile(x)))):u=[];const f=this._updateRetainedTiles(u);if(jg(this._source.type)&&0!==u.length){const x={},C={},T=Object.keys(f);for(const V of T){const j=f[V],q=this._tiles[V];if(!q||q.fadeEndTime&&q.fadeEndTime<=di.now())continue;const J=this.findLoadedParent(j,Math.max(j.overscaledZ-ru.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),x[J.tileID.key]=J.tileID),C[V]=j}const F=u[u.length-1].overscaledZ;for(const V in this._tiles){const j=this._tiles[V];if(f[V]||!j.hasData())continue;let q=j.tileID;for(;q.overscaledZ>F;){q=q.scaledTo(q.overscaledZ-1);const J=this._tiles[q.key];if(J&&J.hasData()&&C[q.key]){f[V]=j.tileID;break}}}for(const V in x)f[V]||(this._coveredTiles[V]=!0,f[V]=x[V])}for(const x in f)this._tiles[x].clearFadeHold();const _=function(x,C){const T=[];for(const F in x)F in C||T.push(F);return T}(this._tiles,f);for(const x of _){const C=this._tiles[x];C.hasSymbolBuckets&&!C.holdingForFade()?C.setHoldDuration(this.map._fadeDuration):C.hasSymbolBuckets&&!C.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(0===e.length)return r;const s={},u=e.reduce((T,F)=>Math.min(T,F.overscaledZ),1/0),f=e[0].overscaledZ,_=Math.max(f-ru.maxOverzooming,this._source.minzoom),x=Math.max(f+ru.maxUnderzooming,this._source.minzoom),C={};for(const T of e){const F=this._addTile(T);r[T.key]=T,F.hasData()||u<this._source.maxzoom&&(C[T.key]=T)}this._retainLoadedChildren(C,u,x,r);for(const T of e){let F=this._tiles[T.key];if(F.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const j=T.children(this._source.maxzoom)[0],q=this.getTile(j);if(q&&q.hasData()){r[j.key]=j;continue}}else{const j=T.children(this._source.maxzoom);if(r[j[0].key]&&r[j[1].key]&&r[j[2].key]&&r[j[3].key])continue}let V=F.wasRequested();for(let j=T.overscaledZ-1;j>=_;--j){const q=T.scaledTo(j);if(s[q.key]||(s[q.key]=!0,F=this.getTile(q),!F&&V&&(F=this._addTile(q)),F&&(r[q.key]=q,V=F.wasRequested(),F.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}r.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(f),s)break;u=f}for(const f of r)this._loadedParentTiles[f]=s}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const s=!!r;if(!s){const u=this.map?this.map.painter:null;r=new dh(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,s||this._source.fire(new li("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=r.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&"reloading"!==r.state?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,s){const u=[],f=this.transform;if(!f)return u;const _="globe"===f.projection.name,x=rc(f.center.lng);for(const C in this._tiles){const T=this._tiles[C];if(s&&T.clearQueryDebugViz(),T.holdingForFade())continue;let F;if(_){const V=T.tileID.canonical;if(0===V.z){const j=[Math.abs(Vt(x,...Cc(V,-1))-x),Math.abs(Vt(x,...Cc(V,1))-x)];F=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(Vt(x,...Cc(V,-1))-x),Math.abs(Vt(x,...Cc(V,0))-x),Math.abs(Vt(x,...Cc(V,1))-x)];F=[j.indexOf(Math.min(...j))-1]}}else F=[0];for(const V of F){const j=e.containsTile(T,f,r,V);j&&u.push(j)}}return u}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of r)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(jg(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=di.now())return!0}return!1}setFeatureState(e,r,s){this._state.updateState(e=e||"_geojsonTileLayer",r,s)}removeFeatureState(e,r,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,s)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,s){const u=this._tiles[e];u&&u.setDependencies(r,s)}reloadTilesForDependencies(e,r){for(const s in this._tiles)this._tiles[s].hasDependency(e,r)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){const x=()=>{this._sourceLoaded&&(this._source.off("data",x),this._preloadTiles(e,r))};return void this._source.on("data",x)}const s=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,_=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const x of u){const C=x.coveringTiles({tileSize:_,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of C)s.set(T.key,T);this.usedForTerrain&&x.updateElevation(!1)}Pn(Array.from(s.values()),(x,C)=>{const T=new dh(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,F=>{"raster-dem"===this._source.type&&T.dem&&this._backfillDEM(T),C(F,T)})},r)}}function Ug(n,e){const r=Math.abs(2*n.wrap)-+(n.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||s-r||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function jg(n){return"raster"===n||"image"===n||"video"===n||"custom"===n}function Cc(n,e){const r=1<<n.z;return[n.x/r+e,(n.x+1)/r+e]}ru.maxOverzooming=10,ru.maxUnderzooming=3;class vf{constructor(e,r,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=s}static create(e,r,s){const u=s||e.findDEMTileFor(r);if(!u||!u.dem)return;const f=u.dem,_=u.tileID,x=1<<r.canonical.z-_.canonical.z;return new vf(u,u.tileSize/Pr/x,[(r.canonical.x/x-_.canonical.x)*f.dim,(r.canonical.y/x-_.canonical.y)*f.dim])}tileCoordToPixel(e,r){const s=r*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(s);return new Ie(u,f)}getElevationAt(e,r,s,u){const f=e*this._scale+this._offset[0],_=r*this._scale+this._offset[1],x=Math.floor(f),C=Math.floor(_),T=this._dem;return u=!!u,s?K(K(T.get(x,C,u),T.get(x,C+1,u),_-C),K(T.get(x+1,C,u),T.get(x+1,C+1,u),_-C),f-x):T.get(x,C,u)}getElevationAtPixel(e,r,s){return this._dem.get(e,r,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Ga(1,e)*this._dem.stride}}class Hg{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new v(Pr,16,0),this.featureIndexArray=new Vu,this.promoteId=r}insert(e,r,s,u,f,_=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,f,_);const C=this.grid;for(let T=0;T<r.length;T++){const F=r[T],V=[1/0,1/0,-1/0,-1/0];for(let j=0;j<F.length;j++){const q=F[j];V[0]=Math.min(V[0],q.x),V[1]=Math.min(V[1],q.y),V[2]=Math.max(V[2],q.x),V[3]=Math.max(V[3],q.y)}V[0]<Pr&&V[1]<Pr&&V[2]>=0&&V[3]>=0&&C.insert(x,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Wd(new Kc(this.rawTileData)).layers,this.sourceLayerCoder=new kg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,s,u){this.loadVTLayers();const f=e.params||{},_=Da(f.filter),x=e.tileResult,C=e.transform,T=x.bufferedTilespaceBounds,F=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(J,le,Ee,Ue)=>Rm(x.bufferedTilespaceGeometry,J,le,Ee,Ue));F.sort(xy);let V=null;C.elevation&&F.length>0&&(V=vf.create(C.elevation,this.tileID));const j={};let q;for(let J=0;J<F.length;J++){const le=F[J];if(le===q)continue;q=le;const Ee=this.featureIndexArray.get(le);let Ue=null;this.loadMatchingFeature(j,Ee,_,f.layers,f.availableImages,r,s,u,(rt,je,it,ft=0)=>(Ue||(Ue=ic(rt,this.tileID.canonical,e.tileTransform)),je.queryIntersectsFeature(x,rt,it,Ue,this.z,e.transform,e.pixelPosMatrix,V,ft)))}return j}loadMatchingFeature(e,r,s,u,f,_,x,C,T){const{featureIndex:F,bucketIndex:V,sourceLayerIndex:j,layoutVertexArrayOffset:q}=r,J=this.bucketLayerIDs[V];if(u&&!function(rt,je){for(let it=0;it<rt.length;it++)if(je.indexOf(rt[it])>=0)return!0;return!1}(u,J))return;const le=this.sourceLayerCoder.decode(j),Ee=this.vtLayers[le].feature(F);if(s.needGeometry){const rt=Gc(Ee,!0);if(!s.filter(new z(this.tileID.overscaledZ),rt,this.tileID.canonical))return}else if(!s.filter(new z(this.tileID.overscaledZ),Ee))return;const Ue=this.getId(Ee,le);for(let rt=0;rt<J.length;rt++){const je=J[rt];if(u&&u.indexOf(je)<0)continue;const it=_[je];if(!it)continue;let ft={};void 0!==Ue&&C&&(ft=C.getState(it.sourceLayer||"_geojsonTileLayer",Ue));const ht=Se({},x[je]);ht.paint=Gg(ht.paint,it.paint,Ee,ft,f),ht.layout=Gg(ht.layout,it.layout,Ee,ft,f);const Yt=!T||T(Ee,it,ft,q);if(!Yt)continue;const Ut=new Fg(Ee,this.z,this.x,this.y,Ue);Ut.layer=ht;let hn=e[je];void 0===hn&&(hn=e[je]=[]),hn.push({featureIndex:F,feature:Ut,intersectionZ:Yt})}}lookupSymbolFeatures(e,r,s,u,f,_,x,C){const T={};this.loadVTLayers();const F=Da(f);for(const V of e)this.loadMatchingFeature(T,{bucketIndex:s,sourceLayerIndex:u,featureIndex:V,layoutVertexArrayOffset:0},F,_,x,C,r);return T}loadFeature(e){const{featureIndex:r,sourceLayerIndex:s}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(s),f=this.vtFeatures[u];if(f[r])return f[r];const _=this.vtLayers[u].feature(r);return f[r]=_,_}hasLayer(e){for(const r of this.bucketLayerIDs)for(const s of r)if(e===s)return!0;return!1}getId(e,r){let s=e.id;if(this.promoteId){const u="string"==typeof this.promoteId?this.promoteId:this.promoteId[r];null!=u&&(s=e.properties[u]),"boolean"==typeof s&&(s=Number(s))}return s}}function Gg(n,e,r,s,u){return bn(n,(f,_)=>{const x=e instanceof Oe?e.get(_):null;return x&&x.evaluate?x.evaluate(r,s,u):x})}function xy(n,e){return e-n}E(Hg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Wg{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new oc({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const s=this.getKey(e,r);return this.positions[s]}trim(){const e=this.width,r=this.height=jt(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,s){const u=[];let f=e.length%2==1?-e[e.length-1]*s:0,_=e[0]*s,x=!0;u.push({left:f,right:_,isDash:x,zeroLength:0===e[0]});let C=e[0];for(let T=1;T<e.length;T++){x=!x;const F=e[T];f=C*s,C+=F,_=C*s,u.push({left:f,right:_,isDash:x,zeroLength:0===F})}return u}addRoundDash(e,r,s){const u=r/2;for(let f=-s;f<=s;f++){const _=this.width*(this.nextRow+s+f);let x=0,C=e[x];for(let T=0;T<this.width;T++){T/C.right>1&&(C=e[++x]);const F=Math.abs(T-C.left),V=Math.abs(T-C.right),j=Math.min(F,V);let q;const J=f/s*(u+1);if(C.isDash){const le=u-Math.abs(J);q=Math.sqrt(j*j+le*le)}else q=u-Math.sqrt(j*j+J*J);this.image.data[_+T]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(e,r){for(let C=e.length-1;C>=0;--C){const T=e[C],F=e[C+1];T.zeroLength?e.splice(C,1):F&&F.isDash===T.isDash&&(F.left=T.left,e.splice(C,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const f=this.width*this.nextRow;let _=0,x=e[_];for(let C=0;C<this.width;C++){C/x.right>1&&(x=e[++_]);const T=Math.abs(C-x.left),F=Math.abs(C-x.right),V=Math.min(T,F);this.image.data[f+C]=Math.max(0,Math.min(255,(x.isDash?V:-V)+r+128))}}addDash(e,r){const s=this.getKey(e,r);if(this.positions[s])return this.positions[s];const u="round"===r,f=u?7:0,_=2*f+1;if(this.nextRow+_>this.height)return dn("LineAtlas out of space"),null;0===e.length&&e.push(1);let x=0;for(let F=0;F<e.length;F++)e[F]<0&&(dn("Negative value is found in line dasharray, replacing values with 0"),e[F]=0),x+=e[F];if(0!==x){const F=this.width/x,V=this.getDashRanges(e,this.width,F);u?this.addRoundDash(V,F,f):this.addRegularDash(V,"square"===r?.5*F:0)}const C=this.nextRow+f;this.nextRow+=_;const T={tl:[C,f],br:[x,0]};return this.positions[s]=T,T}}E(Wg,"LineAtlas");const qg=1*el;class Zg{constructor(e){const r={},s=[];for(const x in e){const C=e[x],T=r[x]={};for(const F in C.glyphs){const V=C.glyphs[+F];if(!V||0===V.bitmap.width||0===V.bitmap.height)continue;const j=V.metrics.localGlyph?qg:1,q={x:0,y:0,w:V.bitmap.width+2*j,h:V.bitmap.height+2*j};s.push(q),T[F]=q}}const{w:u,h:f}=Tp(s),_=new oc({width:u||1,height:f||1});for(const x in e){const C=e[x];for(const T in C.glyphs){const F=C.glyphs[+T];if(!F||0===F.bitmap.width||0===F.bitmap.height)continue;const V=r[x][T],j=F.metrics.localGlyph?qg:1;oc.copy(F.bitmap,_,{x:0,y:0},{x:V.x+j,y:V.y+j},F.bitmap)}}this.image=_,this.positions=r}}E(Zg,"GlyphAtlas");class by{constructor(e){this.tileID=new ga(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=eu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,s,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new Vi;const _=new kg(Object.keys(e.layers).sort()),x=new Hg(this.tileID,this.promoteId);x.bucketLayerIDs=[];const C={},T=new Wg(256,256),F={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:s},V=r.familiesBySource[this.source];for(const ft in V){const ht=e.layers[ft];if(!ht)continue;let Yt=!1,Ut=!1;for(const tn of V[ft])"symbol"===tn[0].type?Yt=!0:Ut=!0;if(!0===this.isSymbolTile&&!Yt||!1===this.isSymbolTile&&!Ut)continue;1===ht.version&&dn(`Vector tile source "${this.source}" layer "${ft}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const hn=_.encode(ft),kn=[];for(let tn=0;tn<ht.length;tn++){const Cn=ht.feature(tn),Tn=x.getId(Cn,ft);kn.push({feature:Cn,id:Tn,index:tn,sourceLayerIndex:hn})}for(const tn of V[ft]){const Cn=tn[0];void 0!==this.isSymbolTile&&"symbol"===Cn.type!==this.isSymbolTile||Cn.minzoom&&this.zoom<Math.floor(Cn.minzoom)||Cn.maxzoom&&this.zoom>=Cn.maxzoom||"none"!==Cn.visibility&&(xf(tn,this.zoom,s),(C[Cn.id]=Cn.createBucket({index:x.bucketLayerIDs.length,layers:tn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:hn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(kn,F,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(tn.map(Tn=>Tn.id)))}}let j,q,J,le;T.trim();const Ee={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ue=()=>{if(j)return f(j);if(q&&J&&le){const ft=new Zg(q),ht=new Ip(J,le);for(const Yt in C){const Ut=C[Yt];Ut instanceof nu?(xf(Ut.layers,this.zoom,s),Cg(Ut,q,ft.positions,J,ht.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):Ut.hasPattern&&(Ut instanceof pp||Ut instanceof Qu||Ut instanceof qd)&&(xf(Ut.layers,this.zoom,s),Ut.addFeatures(F,this.tileID.canonical,ht.patternPositions,s,this.tileTransform))}this.status="done",f(null,{buckets:zt(C).filter(Yt=>!Yt.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ft.image,lineAtlas:T,imageAtlas:ht,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?ft.positions:null})}},rt=bn(F.glyphDependencies,ft=>Object.keys(ft).map(Number));Object.keys(rt).length?u.send("getGlyphs",{uid:this.uid,stacks:rt},(ft,ht)=>{j||(j=ft,q=ht,Ue())},void 0,!1,Ee):q={};const je=Object.keys(F.iconDependencies);je.length?u.send("getImages",{icons:je,source:this.source,tileID:this.tileID,type:"icons"},(ft,ht)=>{j||(j=ft,J=ht,Ue())},void 0,!1,Ee):J={};const it=Object.keys(F.patternDependencies);it.length?u.send("getImages",{icons:it,source:this.source,tileID:this.tileID,type:"patterns"},(ft,ht)=>{j||(j=ft,le=ht,Ue())},void 0,!1,Ee):le={},Ue()}}function xf(n,e,r){const s=new z(e);for(const u of n)u.recalculate(s,r)}class bf{constructor(e){this.entries={},this.scheduler=e}request(e,r,s,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[_,x]=f.result;return this.scheduler?this.scheduler.add(()=>{u(_,x)},r):u(_,x),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=s((_,x)=>{f.result=[_,x];for(const C of f.callbacks)this.scheduler?this.scheduler.add(()=>{C(_,x)},r):C(_,x);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(_=>_!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function Yg(n,e,r){const s=JSON.stringify(n.request);return n.data&&(this.deduped.entries[s]={result:[null,n.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},u=>{const f=Or(n.request,(_,x,C,T)=>{_?u(_):x&&u(null,{vectorTile:r?void 0:new Wd(new Kc(x)),rawData:x,cacheControl:C,expires:T})});return()=>{f.cancel(),u()}},e)}const mh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Yp{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(e,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");const u=s>>4;if(1!==u)throw new Error(`Got v${u} data when expected v1.`);const f=mh[15&s];if(!f)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(e,2,1),[x]=new Uint32Array(e,4,1);return new Yp(x,_,f,e)}constructor(e,r=64,s=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=mh.indexOf(this.ArrayType),_=2*e*this.ArrayType.BYTES_PER_ELEMENT,x=e*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-x%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+C,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+_+x+C),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+C,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=r,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Xp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:x}=this,C=[0,f.length-1,0],T=[];for(;C.length;){const F=C.pop()||0,V=C.pop()||0,j=C.pop()||0;if(V-j<=x){for(let Ee=j;Ee<=V;Ee++){const Ue=_[2*Ee],rt=_[2*Ee+1];Ue>=e&&Ue<=s&&rt>=r&&rt<=u&&T.push(f[Ee])}continue}const q=j+V>>1,J=_[2*q],le=_[2*q+1];J>=e&&J<=s&&le>=r&&le<=u&&T.push(f[q]),(0===F?e<=J:r<=le)&&(C.push(j),C.push(q-1),C.push(1-F)),(0===F?s>=J:u>=le)&&(C.push(q+1),C.push(V),C.push(1-F))}return T}within(e,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:f,nodeSize:_}=this,x=[0,u.length-1,0],C=[],T=s*s;for(;x.length;){const F=x.pop()||0,V=x.pop()||0,j=x.pop()||0;if(V-j<=_){for(let Ee=j;Ee<=V;Ee++)Kg(f[2*Ee],f[2*Ee+1],e,r)<=T&&C.push(u[Ee]);continue}const q=j+V>>1,J=f[2*q],le=f[2*q+1];Kg(J,le,e,r)<=T&&C.push(u[q]),(0===F?e-s<=J:r-s<=le)&&(x.push(j),x.push(q-1),x.push(1-F)),(0===F?e+s>=J:r+s>=le)&&(x.push(q+1),x.push(V),x.push(1-F))}return C}}function Xp(n,e,r,s,u,f){if(u-s<=r)return;const _=s+u>>1;Xg(n,e,_,s,u,f),Xp(n,e,r,s,_-1,1-f),Xp(n,e,r,_+1,u,1-f)}function Xg(n,e,r,s,u,f){for(;u>s;){if(u-s>600){const T=u-s+1,F=r-s+1,V=Math.log(T),j=.5*Math.exp(2*V/3),q=.5*Math.sqrt(V*j*(T-j)/T)*(F-T/2<0?-1:1);Xg(n,e,r,Math.max(s,Math.floor(r-F*j/T+q)),Math.min(u,Math.floor(r+(T-F)*j/T+q)),f)}const _=e[2*r+f];let x=s,C=u;for(gh(n,e,s,r),e[2*u+f]>_&&gh(n,e,s,u);x<C;){for(gh(n,e,x,C),x++,C--;e[2*x+f]<_;)x++;for(;e[2*C+f]>_;)C--}e[2*s+f]===_?gh(n,e,s,C):(C++,gh(n,e,C,u)),C<=r&&(s=C+1),r<=C&&(u=C-1)}}function gh(n,e,r,s){Kp(n,r,s),Kp(e,2*r,2*s),Kp(e,2*r+1,2*s+1)}function Kp(n,e,r){const s=n[e];n[e]=n[r],n[r]=s}function Kg(n,e,r,s){const u=n-r,f=e-s;return u*u+f*f}l.ARRAY_TYPE=ja,l.AUTH_ERR_MSG=at,l.Aabb=pa,l.Actor=class{constructor(n,e,r){this.target=n,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},ln(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=nr()?n:_e,this.scheduler=new Up}send(n,e,r,s,u=!1,f){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=f,this.callbacks[_]=r);const x=Lr(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:n,hasCallback:!!r,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:te(e,x)},x),{cancel:()=>{r&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(n){const e=n.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[r];delete this.cancelCallbacks[r],s&&s.cancel()}else if(e.mustQueue||nr()){const s=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),s&&s.metadata||{type:"message"})}else this.processTask(r,e)}processTask(n,e){if("<response>"===e.type){const r=this.callbacks[n];delete this.callbacks[n],r&&(e.error?r(ve(e.error)):r(null,ve(e.data)))}else{const r=Lr(this.globalScope)?void 0:[],s=e.hasCallback?(f,_)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:f?te(f):null,data:te(_,r)},r)}:f=>{},u=ve(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,s);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=wu,l.Color=qr,l.ColorMode=zl,l.CullFaceMode=gl,l.DEMData=ph,l.DataConstantProperty=ae,l.DedupedRequest=bf,l.DepthMode=dd,l.EXTENT=Pr,l.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const r=e.getSource().maxzoom,s=1<<r,u=Math.floor(n.x),f=Math.floor((n.x-u)*s),_=Math.floor(n.y*s),x=this.findDEMTileFor(new ga(r,u,r,f,_));return!(!x||!x.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,r=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const s=this._source();if(!s||n.y<0||n.y>1)return e;const u=s.getSource().maxzoom,f=1<<u,_=Math.floor(n.x),x=n.x-_,C=new ga(u,_,u,Math.floor(x*f),Math.floor(n.y*f)),T=this.findDEMTileFor(C);if(!T||!T.dem)return e;const F=T.dem,V=1<<T.tileID.canonical.z,j=(x*V-T.tileID.canonical.x)*F.dim,q=(n.y*V-T.tileID.canonical.y)*F.dim,J=Math.floor(j),le=Math.floor(q);return(r?this.exaggeration():1)*K(K(F.get(J,le),F.get(J,le+1),q-le),K(F.get(J+1,le),F.get(J+1,le+1),q-le),j-J)}getAtTileOffset(n,e,r){const s=1<<n.canonical.z;return this.getAtPointOrZero(new vu(n.wrap+(n.canonical.x+e/Pr)/s,(n.canonical.y+r/Pr)/s))}getAtTileOffsetFunc(n,e,r,s){return u=>{const f=this.getAtTileOffset(n,u.x,u.y),_=s.upVector(n.canonical,u.x,u.y);return hl(_,_,f*s.upVectorScale(n.canonical,e,r).metersToTile),_}}getForTilePoints(n,e,r,s){if(this.isUsingMockSource())return!1;const u=vf.create(this,n,s);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],r)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const r=e.dem.tree,s=e.tileID,u=1<<n.canonical.z-s.canonical.z;let f=n.canonical.x/u-s.canonical.x,_=n.canonical.y/u-s.canonical.y,x=0;for(let C=0;C<n.canonical.z-s.canonical.z&&!r.leaves[x];C++){f*=2,_*=2;const T=2*Math.floor(_)+Math.floor(f);x=r.childOffsets[x]+T,f%=1,_%=1}return{min:this.exaggeration()*r.minimums[x],max:this.exaggeration()*r.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=Gr,l.EvaluationParameters=z,l.Event=li,l.Evented=Es,l.FillExtrusionBucket=qd,l.Frustum=Vf,l.FrustumCorners=Sd,l.GLOBE_RADIUS=nc,l.GLOBE_SCALE_MATCH_LATITUDE=45,l.GLOBE_ZOOM_THRESHOLD_MAX=jf,l.GLOBE_ZOOM_THRESHOLD_MIN=Uf,l.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,e){const r=new Rn,s=new xr,u=[],f=n+1+2,_=e[0]+1,x=e[0]+1+(1+e.length),C=(T,F,V)=>{let j=T===f-1?T-2:0===T?T:T-1;return j+=V?24575:0,[j,F]};for(let T=0;T<f;++T)r.emplaceBack(...C(T,0,!0));for(let T=0;T<_;++T)for(let F=0;F<f;++F)r.emplaceBack(...C(F,T,(0===F||F===f-1)&&!0));for(let T=0;T<e.length;++T){const F=e[T];for(let V=0;V<f;++V)r.emplaceBack(...C(V,F,!0))}for(let T=0;T<e.length;++T){const F=s.length,V=e[T]+1+2,j=new xr;for(let le=0;le<V-1;le++){const Ee=le===V-2,Ue=Ee?f*(x-e.length+T-le):f;for(let rt=0;rt<f-1;rt++){const je=le*f+rt;0===le||Ee||0===rt||rt===f-2?(j.emplaceBack(je+1,je,je+Ue),j.emplaceBack(je+Ue,je+Ue+1,je+1)):(s.emplaceBack(je+1,je,je+Ue),s.emplaceBack(je+Ue,je+Ue+1,je+1))}}const q=fs.simpleSegment(0,F,r.length,s.length-F);for(let le=0;le<j.uint16.length;le+=3)s.emplaceBack(j.uint16[le],j.uint16[le+1],j.uint16[le+2]);const J=fs.simpleSegment(0,F,r.length,s.length-F);u.push({withoutSkirts:q,withSkirts:J})}return{vertices:r,indices:s,segments:u}}_createGrid(n){const e=this._fillGridMeshWithLods(64,mu);this._gridSegments=e.segments,this._gridBuffer=n.createVertexBuffer(e.vertices,Td.members),this._gridIndexBuffer=n.createIndexBuffer(e.indices,!0)}_createPoles(n){const e=new xr;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const r=new ao,s=new ao;this._poleSegments=[];for(let u=0,f=0;u<Uf;u++){const _=360/(1<<u);r.emplaceBack(0,-nc,0,.5,0),s.emplaceBack(0,-nc,0,.5,1);for(let x=0;x<=64;x++){const C=x/64,T=K(0,_,C),[F,V,j]=Vc(Xf,Nh,T,nc);r.emplaceBack(F,V,j,C,0),s.emplaceBack(F,V,j,C,1)}this._poleSegments.push(fs.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(r,bm,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(s,bm,!1)}getGridBuffers(n,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const r=new zs,s=64,u=s+1+2,f=1;this._wireframeSegments=[];for(let _=0,x=0;_<mu.length;_++){const C=mu[_];for(let F=f;F<C+f;F++)for(let V=f;V<s+f;V++){const j=F*u+V;r.emplaceBack(j,j+1),r.emplaceBack(j,j+u),r.emplaceBack(j,j+u+1)}const T=C*s*3;this._wireframeSegments.push(fs.simpleSegment(0,x,(C+1)*u,T)),x+=T}this._wireframeIndexBuffer=n.createIndexBuffer(r)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},l.GlyphManager=Iu,l.ImagePosition=Sp,l.KDBush=Yp,l.LivePerformanceUtils=Bo,l.LngLat=fo,l.LngLatBounds=Il,l.LocalGlyphMode=Su,l.MAX_MERCATOR_LATITUDE=ia,l.MercatorCoordinate=vu,l.ONE_EM=Rs,l.OverscaledTileID=ga,l.PerformanceMarkers=no,l.Point=Ie,l.Properties=Ve,l.RGBAImage=Pa,l.Ray=Lh,l.RequestManager=class{constructor(n,e,r){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!yt(n))return n;const r=ke(n);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!yt(n))return n;const r=ke(n);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(n,e,r,s){if(!yt(n))return n;const u=ke(n);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),r&&u.params.push(`language=${r}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(n,e,r,s){const u=ke(n);return yt(n)?(u.path=`/styles/v1${u.path}/sprite${e}${r}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${r}`,se(u))}normalizeTileURL(n,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!yt(n))return n;const s=ke(n);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&"raster"!==s.authority&&512===r?"@2x":""}${Ke.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${tt.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${tt.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(f){for(const _ of f){const x=_.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(s.params)||tt.ACCESS_TOKEN;return tt.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(n,e){const r=ke(n);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return n;let s="mapbox://";r.path.match(/^\/raster\/v1\//)?s+=`raster/${r.path.replace(`/${tt.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${r.path.replace(`/${tt.TILE_URL_VERSION}/`,"")}`;let u=r.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(n,e){const r=!!e&&yt(e),s=[];for(const u of n.tiles||[])Mt(u)?s.push(this.canonicalizeTileURL(u,r)):s.push(u);return s}_makeAPIURL(n,e){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=ke(tt.API_URL);if(n.protocol=s.protocol,n.authority=s.authority,"http"===n.protocol){const u=n.params.indexOf("secure");u>=0&&n.params.splice(u,1)}if("/"!==s.path&&(n.path=`${s.path}${n.path}`),!tt.REQUIRE_ACCESS_TOKEN)return se(n);if(e=e||tt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return n.params=n.params.filter(u=>-1===u.indexOf("access_token")),n.params.push(`access_token=${e||""}`),se(n)}},l.ResourceType=Mi,l.SegmentVector=fs,l.SourceCache=ru,l.StencilMode=yf,l.StructArrayLayout1ui2=Sa,l.StructArrayLayout2f1f2i16=$r,l.StructArrayLayout2i4=Rn,l.StructArrayLayout2ui4=zs,l.StructArrayLayout3f12=fi,l.StructArrayLayout3ui6=xr,l.StructArrayLayout4i8=Dn,l.StructArrayLayout5f20=ao,l.Texture=ch,l.Tile=dh,l.Transitionable=oe,l.Uniform1f=Fc,l.Uniform1i=class extends dl{constructor(n){super(n),this.current=0}set(n,e,r){this.fetchUniformLocation(n,e)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},l.Uniform2f=class extends dl{constructor(n){super(n),this.current=[0,0]}set(n,e,r){this.fetchUniformLocation(n,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}},l.Uniform3f=class extends dl{constructor(n){super(n),this.current=[0,0,0]}set(n,e,r){this.fetchUniformLocation(n,e)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}},l.Uniform4f=hm,l.UniformColor=w_,l.UniformMatrix2f=class extends dl{constructor(n){super(n),this.current=Ja}set(n,e,r){if(this.fetchUniformLocation(n,e))for(let s=0;s<4;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}},l.UniformMatrix3f=class extends dl{constructor(n){super(n),this.current=bv}set(n,e,r){if(this.fetchUniformLocation(n,e))for(let s=0;s<9;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},l.UniformMatrix4f=class extends dl{constructor(n){super(n),this.current=E_}set(n,e,r){if(this.fetchUniformLocation(n,e)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let s=1;s<16;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}},l.UnwrappedTileID=Jh,l.ValidationError=or,l.VectorTileFeature=rd,l.VectorTileWorkerSource=class extends Es{constructor(n,e,r,s,u){super(),this.actor=n,this.layerIndex=e,this.availableImages=r,this.loadVectorData=u||Yg,this.loading={},this.loaded={},this.deduped=new bf(n.scheduler),this.isSpriteLoaded=s,this.scheduler=n.scheduler}loadTile(n,e){const r=n.uid,s=n&&n.request,u=s&&s.collectResourceTiming,f=this.loading[r]=new by(n);f.abort=this.loadVectorData(n,(_,x)=>{const C=!this.loading[r];if(delete this.loading[r],C||_||!x)return f.status="done",C||(this.loaded[r]=f),e(_);const T=x.rawData,F={};x.expires&&(F.expires=x.expires),x.cacheControl&&(F.cacheControl=x.cacheControl),f.vectorTile=x.vectorTile||new Wd(new Kc(T));const V=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,q)=>{if(j||!q)return e(j);const J={};if(u){const le=wn(s);le.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(le)))}e(null,Se({rawTileData:T.slice(0)},q,F,J))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[r]=f})}reloadTile(n,e){const r=this.loaded,s=n.uid,u=this;if(r&&r[s]){const f=r[s];f.showCollisionBoxes=n.showCollisionBoxes,f.enableTerrain=!!n.enableTerrain,f.projection=n.projection,f.tileTransform=eu(n.tileID.canonical,n.projection);const _=(x,C)=>{const T=f.reloadCallback;T&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,T)),e(x,C)};"parsing"===f.status?f.reloadCallback=_:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,_):_())}}abortTile(n,e){const r=n.uid,s=this.loading[r];s&&(s.abort&&s.abort(),delete this.loading[r]),e()}removeTile(n,e){const r=this.loaded,s=n.uid;r&&r[s]&&delete r[s],e()}},l.WritingMode=Wa,l.ZoomDependentExpression=Cs,l.add=tc,l.addDynamicAttributes=pf,l.adjoint=function(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],_=e[4],x=e[5],C=e[6],T=e[7],F=e[8];return n[0]=_*F-x*T,n[1]=u*T-s*F,n[2]=s*x-u*_,n[3]=x*C-f*F,n[4]=r*F-u*C,n[5]=u*f-r*x,n[6]=f*T-_*C,n[7]=s*C-r*T,n[8]=r*_-s*f,n},l.asyncAll=Pn,l.bezier=an,l.bindAll=ln,l.boundsAttributes=Hp,l.bufferConvexPolygon=function(n,e){const r=[];for(let s=0;s<n.length;s++){const u=Zt(s-1,-1,n.length-1),f=Zt(s+1,-1,n.length-1),_=n[s],x=n[f],C=n[u].sub(_).unit(),T=x.sub(_).unit(),F=T.angleWithSep(C.x,C.y),V=C.add(T).unit().mult(-1*e/Math.sin(F/2));r.push(_.add(V))}return r},l.cacheEntryPossiblyAdded=function(n){Tr++,Tr>hr&&(n.getActor().send("enforceCacheSizeLimit",ui),Tr=0)},l.calculateGlobeLabelMatrix=function(n,e){const{x:r,y:s}=n.point,u=Zf(r,s,n.worldSize/n._pixelsPerMercatorPixel,0,0);return Uu(u,u,Bh(Pl(e)))},l.calculateGlobeMatrix=function(n){const{x:e,y:r}=n.point,{lng:s,lat:u}=n._center;return Zf(e,r,n.worldSize,s,u)},l.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,r=e/Ga(1,n.center.lat),s=Ma(new Float64Array(16));return ju(s,s,[n.point.x,n.point.y,0]),hu(s,s,[r,r,e]),Float32Array.from(s)},l.circumferenceAtLatitude=Kf,l.clamp=Vt,l.clearTileCache=function(n){if(!mr())return;const e=_e.caches.delete(Li);n&&e.catch(n).then(()=>n())},l.clipLine=Tu,l.clone=function(n){var e=new ja(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},l.clone$1=Jt,l.collisionCircleLayout=_p,l.config=tt,l.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},l.create=function(){var n=new ja(16);return ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},l.create$1=fm,l.createExpression=qi,l.createLayout=Tt,l.createStyleLayer=function(n){return"custom"===n.type?new gy(n):new yy[n.type](n)},l.cross=xm,l.degToRad=Ye,l.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},l.div=function(n,e,r){return n[0]=e[0]/r[0],n[1]=e[1]/r[1],n[2]=e[2]/r[2],n},l.dot=Ml,l.earthRadius=Ad,l.ease=Qt,l.easeCubicInOut=Nt,l.ecefToLatLng=function([n,e,r]){const s=Math.hypot(n,e,r),u=Math.atan2(n,r),f=.5*Math.PI-Math.acos(-e/s);return new fo(gt(u),gt(f))},l.emitValidationErrors=Rc,l.endsWith=_n,l.enforceCacheSizeLimit=function(n){Di(),wr&&wr.then(e=>{e.keys().then(r=>{for(let s=0;s<r.length-n;s++)e.delete(r[s])})})},l.evaluateSizeForFeature=Xc,l.evaluateSizeForZoom=Cu,l.evaluateVariableOffset=Rp,l.evented=y,l.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},l.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},l.exported=di,l.exported$1=Ke,l.extend=Se,l.extend$1=ro,l.fillExtrusionHeightLift=Zd,l.filterObject=rn,l.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},l.fromQuat=function(n,e){var r=e[0],s=e[1],u=e[2],f=e[3],_=r+r,x=s+s,C=u+u,T=r*_,F=s*_,V=s*x,j=u*_,q=u*x,J=u*C,le=f*_,Ee=f*x,Ue=f*C;return n[0]=1-V-J,n[1]=F+Ue,n[2]=j-Ee,n[3]=0,n[4]=F-Ue,n[5]=1-T-J,n[6]=q+le,n[7]=0,n[8]=j+Ee,n[9]=q-le,n[10]=1-T-V,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},l.fromRotation=function(n,e){var r=Math.sin(e),s=Math.cos(e);return n[0]=s,n[1]=r,n[2]=0,n[3]=-r,n[4]=s,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},l.fromScaling=mm,l.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return Wt[e]},l.getAABBPointSquareDist=function(n,e,r){let s=0;for(let u=0;u<2;++u){const f=r?r[u]:0;n[u]>f&&(s+=(n[u]-f)*(n[u]-f)),e[u]<f&&(s+=(f-e[u])*(f-e[u]))}return s},l.getAnchorAlignment=gg,l.getAnchorJustification=Tg,l.getBounds=function(n){let e=1/0,r=1/0,s=-1/0,u=-1/0;for(const f of n)e=Math.min(e,f.x),r=Math.min(r,f.y),s=Math.max(s,f.x),u=Math.max(u,f.y);return{min:new Ie(e,r),max:new Ie(s,u)}},l.getColumn=Jr,l.getDefaultExportFromCjs=xt,l.getGridMatrix=function(n,e,r,s){const u=e.getNorth(),f=e.getSouth(),_=e.getWest(),x=e.getEast(),C=1<<n.z,T=x-_,F=u-f,V=T/64,j=-F/mu[r],q=[0,V,0,j,0,0,u,_,0];if(n.z>0){const J=180/s;du(q,q,[J/T+1,0,0,0,J/F+1,0,-.5*J/V,.5*J/j,1])}return q[2]=C,q[5]=n.x,q[8]=n.y,q},l.getImage=He,l.getJSON=function(n,e){return Do(Se(n,{type:"json"}),e)},l.getLatitudinalLod=function(n){const e=ia-5;n=Vt(n,-e,e)/e*90;const r=Math.pow(Math.abs(Math.sin(Ye(n))),3);return Math.round(r*(mu.length-1))},l.getMapSessionAPI=Hr,l.getPerformanceMeasurement=wn,l.getProjection=Bp,l.getRTLTextPluginStatus=D,l.getReferrer=Yr,l.getTilePoint=function(n,{x:e,y:r},s=0){return new Ie(((e-s)*n.scale-n.x)*Pr,(r*n.scale-n.y)*Pr)},l.getTileVec3=function(n,e,r=0){return Ed(((e.x-r)*n.scale-n.x)*Pr,(e.y*n.scale-n.y)*Pr,Im(e.z,e.y))},l.getVideo=function(n,e){const r=_e.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let s=0;s<n.length;s++){const u=_e.document.createElement("source");Co(n[s])||(r.crossOrigin="Anonymous"),u.src=n[s],r.appendChild(u)}return{cancel:()=>{}}},l.globeCenterToScreenPoint=function(n){const e=[0,0,0],r=Ma(new Float64Array(16));return Uu(r,n.pixelMatrix,n.globeMatrix),vs(e,e,r),new Ie(e[0],e[1])},l.globeDenormalizeECEF=Bh,l.globeECEFOrigin=function(n,e){const r=[0,0,0];return vs(r,r,Md(Pl(e.canonical))),vs(r,r,n),r},l.globeMetersToEcef=$c,l.globeNormalizeECEF=Md,l.globePixelsToTileUnits=function(n,e){return Pr/(512*Math.pow(2,n))*jc(Pl(e))},l.globePoleMatrixForTile=function(n,e,r){const s=Ma(new Float64Array(16)),u=(e/(1<<n)-.5)*Math.PI*2;return Th(s,r.globeMatrix,u),Float32Array.from(s)},l.globeTileBounds=Pl,l.globeTiltAtLngLat=yu,l.globeToMercatorTransition=_u,l.globeUseCustomAntiAliasing=function(n,e,r){const s=_u(r.zoom),u=n.style.map._antialias,f=!!e.extStandardDerivatives,_=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return 0===s&&!u&&!_&&f},l.identity=Ma,l.identity$1=zf,l.invert=Ff,l.isFullscreen=function(){return!!_e.document.fullscreenElement||!!_e.document.webkitFullscreenElement},l.isLngLatBehindGlobe=Gu,l.isMapAuthenticated=function(n){return ti.has(n)},l.isMapboxURL=yt,l.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!Lr(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},l.latFromMercatorY=Us,l.latLngToECEF=Uc,l.len=Rh,l.length=Hu,l.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},l.lngFromMercatorX=Aa,l.loadVectorTile=Yg,l.makeRequest=Do,l.mapValue=function(n,e,r,s,u){return Vt((n-e)/(r-e)*(u-s)+s,s,u)},l.mercatorScale=zh,l.mercatorXfromLng=rc,l.mercatorYfromLat=Rl,l.mercatorZfromAltitude=Ga,l.mul=Sh,l.mul$1=Ph,l.multiply=Uu,l.multiply$1=du,l.multiply$2=vm,l.nextPowerOfTwo=jt,l.normalize=ra,l.normalize$1=Oh,l.normalize$2=Nf,l.number=K,l.ortho=function(n,e,r,s,u,f,_){var x=1/(e-r),C=1/(s-u),T=1/(f-_);return n[0]=-2*x,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*C,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*T,n[11]=0,n[12]=(e+r)*x,n[13]=(u+s)*C,n[14]=(_+f)*T,n[15]=1,n},l.pbf=og,l.perspective=function(n,e,r,s,u){var f,_=1/Math.tan(e/2);return n[0]=_/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=_,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=u&&u!==1/0?(n[10]=(u+s)*(f=1/(s-u)),n[14]=2*u*s*f):(n[10]=-1,n[14]=-2*s),n},l.pick=function(n,e){const r={};for(let s=0;s<e.length;s++){const u=e[s];u in n&&(r[u]=n[u])}return r},l.plugin=O,l.pointGeometry=Pt,l.polesInViewport=function(n){const e=Ma(new Float64Array(16));Uu(e,n.pixelMatrix,n.globeMatrix);const r=[0,Qa,0],s=[0,Ha,0];return vs(r,r,e),vs(s,s,e),[r[0]>0&&r[0]<=n.width&&r[1]>0&&r[1]<=n.height&&!Gu(n,new fo(n.center.lat,90)),s[0]>0&&s[0]<=n.width&&s[1]>0&&s[1]<=n.height&&!Gu(n,new fo(n.center.lat,-90))]},l.polygonContainsPoint=Wc,l.polygonIntersectsBox=Rm,l.polygonIntersectsPolygon=Od,l.polygonizeBounds=function(n,e,r=0,s=!0){const u=new Ie(r,r),f=n.sub(u),_=e.add(u),x=[f,new Ie(_.x,f.y),_,new Ie(f.x,_.y)];return s&&x.push(f.clone()),x},l.posAttributes=Td,l.postMapLoadEvent=Zn,l.postPerformanceEvent=dr,l.postTurnstileEvent=Ft,l.potpack=Tp,l.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},l.radToDeg=gt,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(n){return n({pluginStatus:h,pluginURL:i}),y.on("pluginStateChange",n),n},l.removeAuthState=function(n){ti.delete(n)},l.renderColorRamp=Uh,l.resample=Jf,l.rotateX=pm,l.rotateX$1=$f,l.rotateY=Th,l.rotateY$1=Cd,l.rotateZ=function(n,e,r){var s=Math.sin(r),u=Math.cos(r),f=e[0],_=e[1],x=e[2],C=e[3],T=e[4],F=e[5],V=e[6],j=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u+T*s,n[1]=_*u+F*s,n[2]=x*u+V*s,n[3]=C*u+j*s,n[4]=T*u-f*s,n[5]=F*u-_*s,n[6]=V*u-x*s,n[7]=j*u-C*s,n},l.rotateZ$1=function(n,e,r){r*=.5;var s=e[0],u=e[1],f=e[2],_=e[3],x=Math.sin(r),C=Math.cos(r);return n[0]=s*C+u*x,n[1]=u*C-s*x,n[2]=f*C+_*x,n[3]=_*C-f*x,n},l.scale=hu,l.scale$1=Bf,l.scale$2=hl,l.scaleAndAdd=Mh,l.set=function(n,e,r,s){return n[0]=e,n[1]=r,n[2]=s,n},l.setCacheLimits=function(n,e){ui=n,hr=e},l.setColumn=function(n,e,r){n[4*e+0]=r[0],n[4*e+1]=r[1],n[4*e+2]=r[2],n[4*e+3]=r[3]},l.setRTLTextPlugin=function(n,e,r=!1){if(h===Ur||h===hi||h===Zi)throw new Error("setRTLTextPlugin cannot be called multiple times.");i=di.resolveURL(n),h=Ur,_o=e,p(),r||A()},l.smoothstep=Jn,l.spec=on,l.squaredLength=function(n){var e=n[0],r=n[1],s=n[2];return e*e+r*r+s*s},l.storeAuthState=function(n,e){e?ti.add(n):ti.delete(n)},l.sub=Al,l.subtract=ym,l.symbolSize=yp,l.tileAABB=function(n,e,r,s,u,f,_,x,C){if("globe"===C.name)return function Cm(n,e,r){const s=e/n.worldSize,u=n.globeMatrix;if(r.z<=1){const Ut=Pl(r).getCorners();return Dm(Ut,u,s),pa.fromPoints(Ut)}const f=Fh(r),_=qf(f);Dm(_,u,s);const x=Number.MAX_VALUE,C=[-x,-x,-x],T=[x,x,x];if(f.contains(n.center)){for(const kn of _)Dd(T,T,kn),fu(C,C,kn);C[2]=0;const Ut=n.point,hn=[Ut.x*s,Ut.y*s,0];return Dd(T,T,hn),fu(C,C,hn),new pa(T,C)}const F=[u[12]*s,u[13]*s,u[14]*s],V=f.getCenter(),j=Vt(n.center.lat,-ia,ia),q=Vt(V.lat,-ia,ia),J=rc(n.center.lng),le=Rl(j);let Ee=J-rc(V.lng);const Ue=le-Rl(q);Ee>.5?Ee-=1:Ee<-.5&&(Ee+=1);let rt=0;Math.abs(Ee)>Math.abs(Ue)?rt=Ee>=0?1:3:(rt=Ue>=0?0:2,Mh(F,F,[u[4]*s,u[5]*s,u[6]*s],-Math.sin(Ye(Ue>=0?f.getSouth():f.getNorth()))*nc));const je=_[rt],it=_[(rt+1)%4],ft=new Em(je,it,F),ht=[Gf(ft,0)||je[0],Gf(ft,1)||je[1],Gf(ft,2)||je[2]],Yt=_u(n.zoom);if(Yt>0){const Ut=function({x:kn,y:tn,z:Cn},Tn,On,Vn,fn){const tr=1/(1<<Cn);let fr=kn*tr,sr=fr+tr,ri=tn*tr,Un=ri+tr,Ir=0;const oi=(fr+sr)/2-Vn;return oi>.5?Ir=-1:oi<-.5&&(Ir=1),fr=((fr+Ir)*Tn-(Vn*=Tn))*On+Vn,sr=((sr+Ir)*Tn-Vn)*On+Vn,ri=(ri*Tn-(fn*=Tn))*On+fn,Un=(Un*Tn-fn)*On+fn,[[fr,Un,0],[sr,Un,0],[sr,ri,0],[fr,ri,0]]}(r,e,n._pixelsPerMercatorPixel,J,le);for(let kn=0;kn<_.length;kn++)gu(_[kn],Ut[kn],Yt);const hn=tc([],Ut[rt],Ut[(rt+1)%4]);hl(hn,hn,.5),gu(ht,hn,Yt)}for(const Ut of _)Dd(T,T,Ut),fu(C,C,Ut);return T[2]=Math.min(je[2],it[2]),Dd(T,T,ht),fu(C,C,ht),new pa(T,C)}(n,e,new wu(r,s,u));const T=eu({z:r,x:s,y:u},C);return new pa([(f+T.x/T.scale)*e,e*(T.y/T.scale),_],[(f+T.x2/T.scale)*e,e*(T.y2/T.scale),x])},l.tileCornersToBounds=Fh,l.tileTransform=eu,l.transformMat3=function(n,e,r){var s=e[0],u=e[1],f=e[2];return n[0]=s*r[0]+u*r[3]+f*r[6],n[1]=s*r[1]+u*r[4]+f*r[7],n[2]=s*r[2]+u*r[5]+f*r[8],n},l.transformMat4=vs,l.transformMat4$1=zc,l.transformQuat=S_,l.transitionTileAABBinECEF=Wf,l.translate=ju,l.transpose=function(n,e){if(n===e){var r=e[1],s=e[2],u=e[5];n[1]=e[3],n[2]=e[6],n[3]=r,n[5]=e[7],n[6]=s,n[7]=u}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},l.triggerPluginCompletionEvent=c,l.uniqueId=ut,l.updateGlobeVertexNormal=function(n,e,r,s,u){const f=5*e+2;n.float32[f+0]=r,n.float32[f+1]=s,n.float32[f+2]=u},l.validateCustomStyleLayer=function(n){const e=[],r=n.id;return void 0===r&&e.push({message:`layers.${r}: missing required property "id"`}),void 0===n.render&&e.push({message:`layers.${r}: missing required method "render"`}),n.renderingMode&&"2d"!==n.renderingMode&&"3d"!==n.renderingMode&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateFilter=n=>qs($a(n)),l.validateFog=n=>qs(Pc(n)),l.validateLayer=n=>qs(zu(n)),l.validateLight=n=>qs(Xa(n)),l.validateSource=n=>qs(Ta(n)),l.validateStyle=Kl,l.validateTerrain=n=>qs(ca(n)),l.values=zt,l.vectorTile=Gh,l.version=Ne,l.warnOnce=dn,l.window=_e,l.wrap=Zt}),w(0,function(l){function _e(Xe){if("number"==typeof Xe||"boolean"==typeof Xe||"string"==typeof Xe||null==Xe)return JSON.stringify(Xe);if(Array.isArray(Xe)){let pe="[";for(const He of Xe)pe+=`${_e(He)},`;return`${pe}]`}let ue="{";for(const pe of Object.keys(Xe).sort())ue+=`${pe}:${_e(Xe[pe])},`;return`${ue}}`}function Ne(Xe){let ue="";for(const pe of l.refProperties)ue+=`/${_e(Xe[pe])}`;return ue}class Le{constructor(ue){this.keyCache={},ue&&this.replace(ue)}replace(ue){this._layerConfigs={},this._layers={},this.update(ue,[])}update(ue,pe){for(const at of ue)this._layerConfigs[at.id]=at,(this._layers[at.id]=l.createStyleLayer(at)).compileFilter(),this.keyCache[at.id]&&delete this.keyCache[at.id];for(const at of pe)delete this.keyCache[at],delete this._layerConfigs[at],delete this._layers[at];this.familiesBySource={};const He=function(at,yt){const Mt={};for(let _t=0;_t<at.length;_t++){const Bt=yt&&yt[at[_t].id]||Ne(at[_t]);yt&&(yt[at[_t].id]=Bt);let pn=Mt[Bt];pn||(pn=Mt[Bt]=[]),pn.push(at[_t])}const At=[];for(const _t in Mt)At.push(Mt[_t]);return At}(l.values(this._layerConfigs),this.keyCache);for(const at of He){const yt=at.map(ke=>this._layers[ke.id]),Mt=yt[0];if("none"===Mt.visibility)continue;const At=Mt.source||"";let _t=this.familiesBySource[At];_t||(_t=this.familiesBySource[At]={});const Bt=Mt.sourceLayer||"_geojsonTileLayer";let pn=_t[Bt];pn||(pn=_t[Bt]=[]),pn.push(yt)}}}class tt{loadTile(ue,pe){const{uid:He,encoding:at,rawImageData:yt,padding:Mt,buildQuadTree:At}=ue,_t=l.window.ImageBitmap&&yt instanceof l.window.ImageBitmap?this.getImageData(yt,Mt):yt;pe(null,new l.DEMData(He,_t,at,Mt<1,At))}getImageData(ue,pe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ue.width,ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ue.width,this.offscreenCanvas.height=ue.height,this.offscreenCanvasContext.drawImage(ue,0,0,ue.width,ue.height);const He=this.offscreenCanvasContext.getImageData(-pe,-pe,ue.width+2*pe,ue.height+2*pe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),He}}function Ke(Xe,ue){if(0!==Xe.length){ye(Xe[0],ue);for(var pe=1;pe<Xe.length;pe++)ye(Xe[pe],!ue)}}function ye(Xe,ue){for(var pe=0,He=0,at=0,yt=Xe.length,Mt=yt-1;at<yt;Mt=at++){var At=(Xe[at][0]-Xe[Mt][0])*(Xe[Mt][1]+Xe[at][1]),_t=pe+At;He+=Math.abs(pe)>=Math.abs(At)?pe-_t+At:At-_t+pe,pe=_t}pe+He>=0!=!!ue&&Xe.reverse()}var Ae=l.getDefaultExportFromCjs(function Xe(ue,pe){var He,at=ue&&ue.type;if("FeatureCollection"===at)for(He=0;He<ue.features.length;He++)Xe(ue.features[He],pe);else if("GeometryCollection"===at)for(He=0;He<ue.geometries.length;He++)Xe(ue.geometries[He],pe);else if("Feature"===at)Xe(ue.geometry,pe);else if("Polygon"===at)Ke(ue.coordinates,pe);else if("MultiPolygon"===at)for(He=0;He<ue.coordinates.length;He++)Ke(ue.coordinates[He],pe);return ue});const Ze=l.VectorTileFeature.prototype.toGeoJSON;var Qe={exports:{}},ot=l.pointGeometry,mt=l.vectorTile.VectorTileFeature,xt=pt;function pt(Xe,ue){this.options=ue||{},this.features=Xe,this.length=Xe.length}function et(Xe,ue){this.id="number"==typeof Xe.id?Xe.id:void 0,this.type=Xe.type,this.rawGeometry=1===Xe.type?[Xe.geometry]:Xe.geometry,this.properties=Xe.tags,this.extent=ue||4096}pt.prototype.feature=function(Xe){return new et(this.features[Xe],this.options.extent)},et.prototype.loadGeometry=function(){var Xe=this.rawGeometry;this.geometry=[];for(var ue=0;ue<Xe.length;ue++){for(var pe=Xe[ue],He=[],at=0;at<pe.length;at++)He.push(new ot(pe[at][0],pe[at][1]));this.geometry.push(He)}return this.geometry},et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Xe=this.geometry,ue=1/0,pe=-1/0,He=1/0,at=-1/0,yt=0;yt<Xe.length;yt++)for(var Mt=Xe[yt],At=0;At<Mt.length;At++){var _t=Mt[At];ue=Math.min(ue,_t.x),pe=Math.max(pe,_t.x),He=Math.min(He,_t.y),at=Math.max(at,_t.y)}return[ue,He,pe,at]},et.prototype.toGeoJSON=mt.prototype.toGeoJSON;var Ot=l.pbf,Pt=xt;function Ce(Xe){var ue=new Ot;return function(pe,He){for(var at in pe.layers)He.writeMessage(3,Ie,pe.layers[at])}(Xe,ue),ue.finish()}function Ie(Xe,ue){var pe;ue.writeVarintField(15,Xe.version||1),ue.writeStringField(1,Xe.name||""),ue.writeVarintField(5,Xe.extent||4096);var He={keys:[],values:[],keycache:{},valuecache:{}};for(pe=0;pe<Xe.length;pe++)He.feature=Xe.feature(pe),ue.writeMessage(2,ct,He);var at=He.keys;for(pe=0;pe<at.length;pe++)ue.writeStringField(3,at[pe]);var yt=He.values;for(pe=0;pe<yt.length;pe++)ue.writeMessage(4,Nt,yt[pe])}function ct(Xe,ue){var pe=Xe.feature;void 0!==pe.id&&ue.writeVarintField(1,pe.id),ue.writeMessage(2,St,Xe),ue.writeVarintField(3,pe.type),ue.writeMessage(4,Wt,pe)}function St(Xe,ue){var pe=Xe.feature,He=Xe.keys,at=Xe.values,yt=Xe.keycache,Mt=Xe.valuecache;for(var At in pe.properties){var _t=pe.properties[At],Bt=yt[At];if(null!==_t){void 0===Bt&&(He.push(At),yt[At]=Bt=He.length-1),ue.writeVarint(Bt);var pn=typeof _t;"string"!==pn&&"boolean"!==pn&&"number"!==pn&&(_t=JSON.stringify(_t));var ke=pn+":"+_t,se=Mt[ke];void 0===se&&(at.push(_t),Mt[ke]=se=at.length-1),ue.writeVarint(se)}}}function Ye(Xe,ue){return(ue<<3)+(7&Xe)}function gt(Xe){return Xe<<1^Xe>>31}function Wt(Xe,ue){for(var pe=Xe.loadGeometry(),He=Xe.type,at=0,yt=0,Mt=pe.length,At=0;At<Mt;At++){var _t=pe[At],Bt=1;1===He&&(Bt=_t.length),ue.writeVarint(Ye(1,Bt));for(var pn=3===He?_t.length-1:_t.length,ke=0;ke<pn;ke++){1===ke&&1!==He&&ue.writeVarint(Ye(2,pn-1));var se=_t[ke].x-at,ce=_t[ke].y-yt;ue.writeVarint(gt(se)),ue.writeVarint(gt(ce)),at+=se,yt+=ce}3===He&&ue.writeVarint(Ye(7,1))}}function Nt(Xe,ue){var pe=typeof Xe;"string"===pe?ue.writeStringField(1,Xe):"boolean"===pe?ue.writeBooleanField(7,Xe):"number"===pe&&(Xe%1!=0?ue.writeDoubleField(3,Xe):Xe<0?ue.writeSVarintField(6,Xe):ue.writeVarintField(5,Xe))}Qe.exports=Ce,Qe.exports.fromVectorTileJs=Ce,Qe.exports.fromGeojsonVt=function(Xe,ue){ue=ue||{};var pe={};for(var He in Xe)pe[He]=new Pt(Xe[He].features,ue),pe[He].name=He,pe[He].version=ue.version,pe[He].extent=ue.extent;return Ce({layers:pe})},Qe.exports.GeoJSONWrapper=Pt;var an=l.getDefaultExportFromCjs(Qe.exports);const Qt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Xe=>Xe},Vt=Math.fround||(Jn=new Float32Array(1),Xe=>(Jn[0]=+Xe,Jn[0]));var Jn;const Zt=3,Pn=5,zt=6;class Se{constructor(ue){this.options=Object.assign(Object.create(Qt),ue),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ue){const{log:pe,minZoom:He,maxZoom:at}=this.options;pe&&console.time("total time");const yt=`prepare ${ue.length} points`;pe&&console.time(yt),this.points=ue;const Mt=[];for(let _t=0;_t<ue.length;_t++){const Bt=ue[_t];if(!Bt.geometry)continue;const[pn,ke]=Bt.geometry.coordinates,se=Vt(Dt(pn)),ce=Vt(jt(ke));Mt.push(se,ce,1/0,_t,-1,1),this.options.reduce&&Mt.push(0)}let At=this.trees[at+1]=this._createTree(Mt);pe&&console.timeEnd(yt);for(let _t=at;_t>=He;_t--){const Bt=+Date.now();At=this.trees[_t]=this._createTree(this._cluster(At,_t)),pe&&console.log("z%d: %d clusters in %dms",_t,At.numItems,+Date.now()-Bt)}return pe&&console.timeEnd("total time"),this}getClusters(ue,pe){let He=((ue[0]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,ue[1]));let yt=180===ue[2]?180:((ue[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,ue[3]));if(ue[2]-ue[0]>=360)He=-180,yt=180;else if(He>yt){const ke=this.getClusters([He,at,180,Mt],pe),se=this.getClusters([-180,at,yt,Mt],pe);return ke.concat(se)}const At=this.trees[this._limitZoom(pe)],_t=At.range(Dt(He),jt(Mt),Dt(yt),jt(at)),Bt=At.data,pn=[];for(const ke of _t){const se=this.stride*ke;pn.push(Bt[se+Pn]>1?ze(Bt,se,this.clusterProps):this.points[Bt[se+Zt]])}return pn}getChildren(ue){const pe=this._getOriginId(ue),He=this._getOriginZoom(ue),at="No cluster with the specified id.",yt=this.trees[He];if(!yt)throw new Error(at);const Mt=yt.data;if(pe*this.stride>=Mt.length)throw new Error(at);const At=this.options.radius/(this.options.extent*Math.pow(2,He-1)),_t=yt.within(Mt[pe*this.stride],Mt[pe*this.stride+1],At),Bt=[];for(const pn of _t){const ke=pn*this.stride;Mt[ke+4]===ue&&Bt.push(Mt[ke+Pn]>1?ze(Mt,ke,this.clusterProps):this.points[Mt[ke+Zt]])}if(0===Bt.length)throw new Error(at);return Bt}getLeaves(ue,pe,He){const at=[];return this._appendLeaves(at,ue,pe=pe||10,He=He||0,0),at}getTile(ue,pe,He){const at=this.trees[this._limitZoom(ue)],yt=Math.pow(2,ue),{extent:Mt,radius:At}=this.options,_t=At/Mt,Bt=(He-_t)/yt,pn=(He+1+_t)/yt,ke={features:[]};return this._addTileFeatures(at.range((pe-_t)/yt,Bt,(pe+1+_t)/yt,pn),at.data,pe,He,yt,ke),0===pe&&this._addTileFeatures(at.range(1-_t/yt,Bt,1,pn),at.data,yt,He,yt,ke),pe===yt-1&&this._addTileFeatures(at.range(0,Bt,_t/yt,pn),at.data,-1,He,yt,ke),ke.features.length?ke:null}getClusterExpansionZoom(ue){let pe=this._getOriginZoom(ue)-1;for(;pe<=this.options.maxZoom;){const He=this.getChildren(ue);if(pe++,1!==He.length)break;ue=He[0].properties.cluster_id}return pe}_appendLeaves(ue,pe,He,at,yt){const Mt=this.getChildren(pe);for(const At of Mt){const _t=At.properties;if(_t&&_t.cluster?yt+_t.point_count<=at?yt+=_t.point_count:yt=this._appendLeaves(ue,_t.cluster_id,He,at,yt):yt<at?yt++:ue.push(At),ue.length===He)break}return yt}_createTree(ue){const pe=new l.KDBush(ue.length/this.stride|0,this.options.nodeSize,Float32Array);for(let He=0;He<ue.length;He+=this.stride)pe.add(ue[He],ue[He+1]);return pe.finish(),pe.data=ue,pe}_addTileFeatures(ue,pe,He,at,yt,Mt){for(const At of ue){const _t=At*this.stride,Bt=pe[_t+Pn]>1;let pn,ke,se;if(Bt)pn=ut(pe,_t,this.clusterProps),ke=pe[_t],se=pe[_t+1];else{const fe=this.points[pe[_t+Zt]];pn=fe.properties;const[nt,Ft]=fe.geometry.coordinates;ke=Dt(nt),se=jt(Ft)}const ce={type:1,geometry:[[Math.round(this.options.extent*(ke*yt-He)),Math.round(this.options.extent*(se*yt-at))]],tags:pn};let Fe;Fe=Bt||this.options.generateId?pe[_t+Zt]:this.points[pe[_t+Zt]].id,void 0!==Fe&&(ce.id=Fe),Mt.features.push(ce)}}_limitZoom(ue){return Math.max(this.options.minZoom,Math.min(Math.floor(+ue),this.options.maxZoom+1))}_cluster(ue,pe){const{radius:He,extent:at,reduce:yt,minPoints:Mt}=this.options,At=He/(at*Math.pow(2,pe)),_t=ue.data,Bt=[],pn=this.stride;for(let ke=0;ke<_t.length;ke+=pn){if(_t[ke+2]<=pe)continue;_t[ke+2]=pe;const se=_t[ke],ce=_t[ke+1],Fe=ue.within(_t[ke],_t[ke+1],At),fe=_t[ke+Pn];let nt=fe;for(const Ft of Fe){const mn=Ft*pn;_t[mn+2]>pe&&(nt+=_t[mn+Pn])}if(nt>fe&&nt>=Mt){let Ft,mn=se*fe,Zn=ce*fe,Gn=-1;const dr=((ke/pn|0)<<5)+(pe+1)+this.points.length;for(const yr of Fe){const Hr=yr*pn;if(_t[Hr+2]<=pe)continue;_t[Hr+2]=pe;const ti=_t[Hr+Pn];mn+=_t[Hr]*ti,Zn+=_t[Hr+1]*ti,_t[Hr+4]=dr,yt&&(Ft||(Ft=this._map(_t,ke,!0),Gn=this.clusterProps.length,this.clusterProps.push(Ft)),yt(Ft,this._map(_t,Hr)))}_t[ke+4]=dr,Bt.push(mn/nt,Zn/nt,1/0,dr,-1,nt),yt&&Bt.push(Gn)}else{for(let Ft=0;Ft<pn;Ft++)Bt.push(_t[ke+Ft]);if(nt>1)for(const Ft of Fe){const mn=Ft*pn;if(!(_t[mn+2]<=pe)){_t[mn+2]=pe;for(let Zn=0;Zn<pn;Zn++)Bt.push(_t[mn+Zn])}}}}return Bt}_getOriginId(ue){return ue-this.points.length>>5}_getOriginZoom(ue){return(ue-this.points.length)%32}_map(ue,pe,He){if(ue[pe+Pn]>1){const Mt=this.clusterProps[ue[pe+zt]];return He?Object.assign({},Mt):Mt}const at=this.points[ue[pe+Zt]].properties,yt=this.options.map(at);return He&&yt===at?Object.assign({},yt):yt}}function ze(Xe,ue,pe){return{type:"Feature",id:Xe[ue+Zt],properties:ut(Xe,ue,pe),geometry:{type:"Point",coordinates:[(He=Xe[ue],360*(He-.5)),nn(Xe[ue+1])]}};var He}function ut(Xe,ue,pe){const He=Xe[ue+Pn],at=He>=1e4?`${Math.round(He/1e3)}k`:He>=1e3?Math.round(He/100)/10+"k":He,yt=Xe[ue+zt],Mt=-1===yt?{}:Object.assign({},pe[yt]);return Object.assign(Mt,{cluster:!0,cluster_id:Xe[ue+Zt],point_count:He,point_count_abbreviated:at})}function Dt(Xe){return Xe/360+.5}function jt(Xe){const ue=Math.sin(Xe*Math.PI/180),pe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return pe<0?0:pe>1?1:pe}function nn(Xe){const ue=(180-360*Xe)*Math.PI/180;return 360*Math.atan(Math.exp(ue))/Math.PI-90}function ln(Xe,ue,pe,He){for(var at,yt=He,Mt=pe-ue>>1,At=pe-ue,_t=Xe[ue],Bt=Xe[ue+1],pn=Xe[pe],ke=Xe[pe+1],se=ue+3;se<pe;se+=3){var ce=_n(Xe[se],Xe[se+1],_t,Bt,pn,ke);if(ce>yt)at=se,yt=ce;else if(ce===yt){var Fe=Math.abs(se-Mt);Fe<At&&(at=se,At=Fe)}}yt>He&&(at-ue>3&&ln(Xe,ue,at,He),Xe[at+2]=yt,pe-at>3&&ln(Xe,at,pe,He))}function _n(Xe,ue,pe,He,at,yt){var Mt=at-pe,At=yt-He;if(0!==Mt||0!==At){var _t=((Xe-pe)*Mt+(ue-He)*At)/(Mt*Mt+At*At);_t>1?(pe=at,He=yt):_t>0&&(pe+=Mt*_t,He+=At*_t)}return(Mt=Xe-pe)*Mt+(At=ue-He)*At}function bn(Xe,ue,pe,He){var at={id:void 0===Xe?null:Xe,type:ue,geometry:pe,tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(yt){var Mt=yt.geometry,At=yt.type;if("Point"===At||"MultiPoint"===At||"LineString"===At)rn(yt,Mt);else if("Polygon"===At||"MultiLineString"===At)for(var _t=0;_t<Mt.length;_t++)rn(yt,Mt[_t]);else if("MultiPolygon"===At)for(_t=0;_t<Mt.length;_t++)for(var Bt=0;Bt<Mt[_t].length;Bt++)rn(yt,Mt[_t][Bt])}(at),at}function rn(Xe,ue){for(var pe=0;pe<ue.length;pe+=3)Xe.minX=Math.min(Xe.minX,ue[pe]),Xe.minY=Math.min(Xe.minY,ue[pe+1]),Xe.maxX=Math.max(Xe.maxX,ue[pe]),Xe.maxY=Math.max(Xe.maxY,ue[pe+1])}function Jt(Xe,ue,pe,He){if(ue.geometry){var at=ue.geometry.coordinates,yt=ue.geometry.type,Mt=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2),At=[],_t=ue.id;if(pe.promoteId?_t=ue.properties[pe.promoteId]:pe.generateId&&(_t=He||0),"Point"===yt)en(at,At);else if("MultiPoint"===yt)for(var Bt=0;Bt<at.length;Bt++)en(at[Bt],At);else if("LineString"===yt)dn(at,At,Mt,!1);else if("MultiLineString"===yt){if(pe.lineMetrics){for(Bt=0;Bt<at.length;Bt++)dn(at[Bt],At=[],Mt,!1),Xe.push(bn(_t,"LineString",At,ue.properties));return}Fn(at,At,Mt,!1)}else if("Polygon"===yt)Fn(at,At,Mt,!0);else{if("MultiPolygon"!==yt){if("GeometryCollection"===yt){for(Bt=0;Bt<ue.geometry.geometries.length;Bt++)Jt(Xe,{id:_t,geometry:ue.geometry.geometries[Bt],properties:ue.properties},pe,He);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Bt=0;Bt<at.length;Bt++){var pn=[];Fn(at[Bt],pn,Mt,!0),At.push(pn)}}Xe.push(bn(_t,yt,At,ue.properties))}}function en(Xe,ue){ue.push(pr(Xe[0])),ue.push(nr(Xe[1])),ue.push(0)}function dn(Xe,ue,pe,He){for(var at,yt,Mt=0,At=0;At<Xe.length;At++){var _t=pr(Xe[At][0]),Bt=nr(Xe[At][1]);ue.push(_t),ue.push(Bt),ue.push(0),At>0&&(Mt+=He?(at*Bt-_t*yt)/2:Math.sqrt(Math.pow(_t-at,2)+Math.pow(Bt-yt,2))),at=_t,yt=Bt}var pn=ue.length-3;ue[2]=1,ln(ue,0,pn,pe),ue[pn+2]=1,ue.size=Math.abs(Mt),ue.start=0,ue.end=ue.size}function Fn(Xe,ue,pe,He){for(var at=0;at<Xe.length;at++){var yt=[];dn(Xe[at],yt,pe,He),ue.push(yt)}}function pr(Xe){return Xe/360+.5}function nr(Xe){var ue=Math.sin(Xe*Math.PI/180),pe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return pe<0?0:pe>1?1:pe}function gr(Xe,ue,pe,He,at,yt,Mt,At){if(He/=ue,yt>=(pe/=ue)&&Mt<He)return Xe;if(Mt<pe||yt>=He)return null;for(var _t=[],Bt=0;Bt<Xe.length;Bt++){var pn=Xe[Bt],ke=pn.geometry,se=pn.type,ce=0===at?pn.minX:pn.minY,Fe=0===at?pn.maxX:pn.maxY;if(ce>=pe&&Fe<He)_t.push(pn);else if(!(Fe<pe||ce>=He)){var fe=[];if("Point"===se||"MultiPoint"===se)Xn(ke,fe,pe,He,at);else if("LineString"===se)Lr(ke,fe,pe,He,at,!1,At.lineMetrics);else if("MultiLineString"===se)Jr(ke,fe,pe,He,at,!1);else if("Polygon"===se)Jr(ke,fe,pe,He,at,!0);else if("MultiPolygon"===se)for(var nt=0;nt<ke.length;nt++){var Ft=[];Jr(ke[nt],Ft,pe,He,at,!0),Ft.length&&fe.push(Ft)}if(fe.length){if(At.lineMetrics&&"LineString"===se){for(nt=0;nt<fe.length;nt++)_t.push(bn(pn.id,se,fe[nt],pn.tags));continue}"LineString"!==se&&"MultiLineString"!==se||(1===fe.length?(se="LineString",fe=fe[0]):se="MultiLineString"),"Point"!==se&&"MultiPoint"!==se||(se=3===fe.length?"Point":"MultiPoint"),_t.push(bn(pn.id,se,fe,pn.tags))}}}return _t.length?_t:null}function Xn(Xe,ue,pe,He,at){for(var yt=0;yt<Xe.length;yt+=3){var Mt=Xe[yt+at];Mt>=pe&&Mt<=He&&(ue.push(Xe[yt]),ue.push(Xe[yt+1]),ue.push(Xe[yt+2]))}}function Lr(Xe,ue,pe,He,at,yt,Mt){for(var At,_t,Bt=yn(Xe),pn=0===at?ui:hr,ke=Xe.start,se=0;se<Xe.length-3;se+=3){var ce=Xe[se],Fe=Xe[se+1],fe=Xe[se+2],nt=Xe[se+3],Ft=Xe[se+4],mn=0===at?ce:Fe,Zn=0===at?nt:Ft,Gn=!1;Mt&&(At=Math.sqrt(Math.pow(ce-nt,2)+Math.pow(Fe-Ft,2))),mn<pe?Zn>pe&&(_t=pn(Bt,ce,Fe,nt,Ft,pe),Mt&&(Bt.start=ke+At*_t)):mn>He?Zn<He&&(_t=pn(Bt,ce,Fe,nt,Ft,He),Mt&&(Bt.start=ke+At*_t)):Li(Bt,ce,Fe,fe),Zn<pe&&mn>=pe&&(_t=pn(Bt,ce,Fe,nt,Ft,pe),Gn=!0),Zn>He&&mn<=He&&(_t=pn(Bt,ce,Fe,nt,Ft,He),Gn=!0),!yt&&Gn&&(Mt&&(Bt.end=ke+At*_t),ue.push(Bt),Bt=yn(Xe)),Mt&&(ke+=At)}var dr=Xe.length-3;ce=Xe[dr],Fe=Xe[dr+1],fe=Xe[dr+2],(mn=0===at?ce:Fe)>=pe&&mn<=He&&Li(Bt,ce,Fe,fe),dr=Bt.length-3,yt&&dr>=3&&(Bt[dr]!==Bt[0]||Bt[dr+1]!==Bt[1])&&Li(Bt,Bt[0],Bt[1],Bt[2]),Bt.length&&ue.push(Bt)}function yn(Xe){var ue=[];return ue.size=Xe.size,ue.start=Xe.start,ue.end=Xe.end,ue}function Jr(Xe,ue,pe,He,at,yt){for(var Mt=0;Mt<Xe.length;Mt++)Lr(Xe[Mt],ue,pe,He,at,yt,!1)}function Li(Xe,ue,pe,He){Xe.push(ue),Xe.push(pe),Xe.push(He)}function ui(Xe,ue,pe,He,at,yt){var Mt=(yt-ue)/(He-ue);return Xe.push(yt),Xe.push(pe+(at-pe)*Mt),Xe.push(1),Mt}function hr(Xe,ue,pe,He,at,yt){var Mt=(yt-pe)/(at-pe);return Xe.push(ue+(He-ue)*Mt),Xe.push(yt),Xe.push(1),Mt}function wr(Xe,ue){for(var pe=[],He=0;He<Xe.length;He++){var at,yt=Xe[He],Mt=yt.type;if("Point"===Mt||"MultiPoint"===Mt||"LineString"===Mt)at=_r(yt.geometry,ue);else if("MultiLineString"===Mt||"Polygon"===Mt){at=[];for(var At=0;At<yt.geometry.length;At++)at.push(_r(yt.geometry[At],ue))}else if("MultiPolygon"===Mt)for(at=[],At=0;At<yt.geometry.length;At++){for(var _t=[],Bt=0;Bt<yt.geometry[At].length;Bt++)_t.push(_r(yt.geometry[At][Bt],ue));at.push(_t)}pe.push(bn(yt.id,Mt,at,yt.tags))}return pe}function _r(Xe,ue){var pe=[];pe.size=Xe.size,void 0!==Xe.start&&(pe.start=Xe.start,pe.end=Xe.end);for(var He=0;He<Xe.length;He+=3)pe.push(Xe[He]+ue,Xe[He+1],Xe[He+2]);return pe}function mr(Xe,ue){if(Xe.transformed)return Xe;var pe,He,at,yt=1<<Xe.z,Mt=Xe.x,At=Xe.y;for(pe=0;pe<Xe.features.length;pe++){var _t=Xe.features[pe],Bt=_t.geometry,pn=_t.type;if(_t.geometry=[],1===pn)for(He=0;He<Bt.length;He+=2)_t.geometry.push(Di(Bt[He],Bt[He+1],ue,yt,Mt,At));else for(He=0;He<Bt.length;He++){var ke=[];for(at=0;at<Bt[He].length;at+=2)ke.push(Di(Bt[He][at],Bt[He][at+1],ue,yt,Mt,At));_t.geometry.push(ke)}}return Xe.transformed=!0,Xe}function Di(Xe,ue,pe,He,at,yt){return[Math.round(pe*(Xe*He-at)),Math.round(pe*(ue*He-yt))]}function Gi(Xe,ue,pe,He,at){for(var yt=ue===at.maxZoom?0:at.tolerance/((1<<ue)*at.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pe,y:He,z:ue,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},At=0;At<Xe.length;At++){Mt.numFeatures++,Tr(Mt,Xe[At],yt,at);var _t=Xe[At].minX,Bt=Xe[At].minY,pn=Xe[At].maxX,ke=Xe[At].maxY;_t<Mt.minX&&(Mt.minX=_t),Bt<Mt.minY&&(Mt.minY=Bt),pn>Mt.maxX&&(Mt.maxX=pn),ke>Mt.maxY&&(Mt.maxY=ke)}return Mt}function Tr(Xe,ue,pe,He){var at=ue.geometry,yt=ue.type,Mt=[];if("Point"===yt||"MultiPoint"===yt)for(var At=0;At<at.length;At+=3)Mt.push(at[At]),Mt.push(at[At+1]),Xe.numPoints++,Xe.numSimplified++;else if("LineString"===yt)Mi(Mt,at,Xe,pe,!1,!1);else if("MultiLineString"===yt||"Polygon"===yt)for(At=0;At<at.length;At++)Mi(Mt,at[At],Xe,pe,"Polygon"===yt,0===At);else if("MultiPolygon"===yt)for(var _t=0;_t<at.length;_t++){var Bt=at[_t];for(At=0;At<Bt.length;At++)Mi(Mt,Bt[At],Xe,pe,!0,0===At)}if(Mt.length){var pn=ue.tags||null;if("LineString"===yt&&He.lineMetrics){for(var ke in pn={},ue.tags)pn[ke]=ue.tags[ke];pn.mapbox_clip_start=at.start/at.size,pn.mapbox_clip_end=at.end/at.size}var se={geometry:Mt,type:"Polygon"===yt||"MultiPolygon"===yt?3:"LineString"===yt||"MultiLineString"===yt?2:1,tags:pn};null!==ue.id&&(se.id=ue.id),Xe.features.push(se)}}function Mi(Xe,ue,pe,He,at,yt){var Mt=He*He;if(He>0&&ue.size<(at?Mt:He))pe.numPoints+=ue.length/3;else{for(var At=[],_t=0;_t<ue.length;_t+=3)(0===He||ue[_t+2]>Mt)&&(pe.numSimplified++,At.push(ue[_t]),At.push(ue[_t+1])),pe.numPoints++;at&&function(Bt,pn){for(var ke=0,se=0,ce=Bt.length,Fe=ce-2;se<ce;Fe=se,se+=2)ke+=(Bt[se]-Bt[Fe])*(Bt[se+1]+Bt[Fe+1]);if(ke>0===pn)for(se=0,ce=Bt.length;se<ce/2;se+=2){var fe=Bt[se],nt=Bt[se+1];Bt[se]=Bt[ce-2-se],Bt[se+1]=Bt[ce-1-se],Bt[ce-2-se]=fe,Bt[ce-1-se]=nt}}(At,yt),Xe.push(At)}}function yi(Xe,ue){var pe=(ue=this.options=function(at,yt){for(var Mt in yt)at[Mt]=yt[Mt];return at}(Object.create(this.options),ue)).debug;if(pe&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");var at,yt,Mt,At,_t,Bt,He=function(at,yt){var Mt=[];if("FeatureCollection"===at.type)for(var At=0;At<at.features.length;At++)Jt(Mt,at.features[At],yt,At);else Jt(Mt,"Feature"===at.type?at:{geometry:at},yt);return Mt}(Xe,ue);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),At=at=He,_t=gr(at,1,-1-(Mt=(yt=ue).buffer/yt.extent),Mt,0,-1,2,yt),Bt=gr(at,1,1-Mt,2+Mt,0,-1,2,yt),(_t||Bt)&&(At=gr(at,1,-Mt,1+Mt,0,-1,2,yt)||[],_t&&(At=wr(_t,1).concat(At)),Bt&&(At=At.concat(wr(Bt,-1)))),(He=At).length&&this.splitTile(He,0,0,0),pe&&(He.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yr(Xe,ue,pe){return 32*((1<<Xe)*pe+ue)+Xe}function Do(Xe,ue){const pe=Xe.tileID.canonical;if(!this._geoJSONIndex)return ue(null,null);const He=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!He)return ue(null,null);const at=new class{constructor(Mt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Mt.length,this._features=Mt}feature(Mt){return new class{constructor(At){this._feature=At,this.extent=l.EXTENT,this.type=At.type,this.properties=At.tags,"id"in At&&!isNaN(At.id)&&(this.id=parseInt(At.id,10))}loadGeometry(){if(1===this._feature.type){const At=[];for(const _t of this._feature.geometry)At.push([new l.Point(_t[0],_t[1])]);return At}{const At=[];for(const _t of this._feature.geometry){const Bt=[];for(const pn of _t)Bt.push(new l.Point(pn[0],pn[1]));At.push(Bt)}return At}}toGeoJSON(At,_t,Bt){return Ze.call(this,At,_t,Bt)}}(this._features[Mt])}}(He.features);let yt=an(at);0===yt.byteOffset&&yt.byteLength===yt.buffer.byteLength||(yt=new Uint8Array(yt)),ue(null,{vectorTile:at,rawData:yt.buffer})}yi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yi.prototype.splitTile=function(Xe,ue,pe,He,at,yt,Mt){for(var At=[Xe,ue,pe,He],_t=this.options,Bt=_t.debug;At.length;){He=At.pop(),pe=At.pop(),ue=At.pop(),Xe=At.pop();var pn=1<<ue,ke=Yr(ue,pe,He),se=this.tiles[ke];if(!se&&(Bt>1&&console.time("creation"),se=this.tiles[ke]=Gi(Xe,ue,pe,He,_t),this.tileCoords.push({z:ue,x:pe,y:He}),Bt)){Bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,pe,He,se.numFeatures,se.numPoints,se.numSimplified),console.timeEnd("creation"));var ce="z"+ue;this.stats[ce]=(this.stats[ce]||0)+1,this.total++}if(se.source=Xe,at){if(ue===_t.maxZoom||ue===at)continue;var Fe=1<<at-ue;if(pe!==Math.floor(yt/Fe)||He!==Math.floor(Mt/Fe))continue}else if(ue===_t.indexMaxZoom||se.numPoints<=_t.indexMaxPoints)continue;if(se.source=null,0!==Xe.length){Bt>1&&console.time("clipping");var fe,nt,Ft,mn,Zn,Gn,dr=.5*_t.buffer/_t.extent,yr=.5-dr,Hr=.5+dr,ti=1+dr;fe=nt=Ft=mn=null,Zn=gr(Xe,pn,pe-dr,pe+Hr,0,se.minX,se.maxX,_t),Gn=gr(Xe,pn,pe+yr,pe+ti,0,se.minX,se.maxX,_t),Xe=null,Zn&&(fe=gr(Zn,pn,He-dr,He+Hr,1,se.minY,se.maxY,_t),nt=gr(Zn,pn,He+yr,He+ti,1,se.minY,se.maxY,_t),Zn=null),Gn&&(Ft=gr(Gn,pn,He-dr,He+Hr,1,se.minY,se.maxY,_t),mn=gr(Gn,pn,He+yr,He+ti,1,se.minY,se.maxY,_t),Gn=null),Bt>1&&console.timeEnd("clipping"),At.push(fe||[],ue+1,2*pe,2*He),At.push(nt||[],ue+1,2*pe,2*He+1),At.push(Ft||[],ue+1,2*pe+1,2*He),At.push(mn||[],ue+1,2*pe+1,2*He+1)}}},yi.prototype.getTile=function(Xe,ue,pe){var He=this.options,at=He.extent,yt=He.debug;if(Xe<0||Xe>24)return null;var Mt=1<<Xe,At=Yr(Xe,ue=(ue%Mt+Mt)%Mt,pe);if(this.tiles[At])return mr(this.tiles[At],at);yt>1&&console.log("drilling down to z%d-%d-%d",Xe,ue,pe);for(var _t,Bt=Xe,pn=ue,ke=pe;!_t&&Bt>0;)Bt--,pn=Math.floor(pn/2),ke=Math.floor(ke/2),_t=this.tiles[Yr(Bt,pn,ke)];return _t&&_t.source?(yt>1&&console.log("found parent tile z%d-%d-%d",Bt,pn,ke),yt>1&&console.time("drilling down"),this.splitTile(_t.source,Bt,pn,ke,Xe,ue,pe),yt>1&&console.timeEnd("drilling down"),this.tiles[At]?mr(this.tiles[At],at):null):null};class Or extends l.VectorTileWorkerSource{constructor(ue,pe,He,at,yt){super(ue,pe,He,at,Do),yt&&(this.loadGeoJSON=yt)}loadData(ue,pe){const He=ue&&ue.request,at=He&&He.collectResourceTiming;this.loadGeoJSON(ue,(yt,Mt)=>{if(yt||!Mt)return pe(yt);if("object"!=typeof Mt)return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));{Ae(Mt,!0);try{if(ue.filter){const _t=l.createExpression(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===_t.result)throw new Error(_t.value.map(pn=>`${pn.key}: ${pn.message}`).join(", "));Mt={type:"FeatureCollection",features:Mt.features.filter(pn=>_t.value.evaluate({zoom:0},pn))}}this._geoJSONIndex=ue.cluster?new Se(function({superclusterOptions:_t,clusterProperties:Bt}){if(!Bt||!_t)return _t;const pn={},ke={},se={accumulated:null,zoom:0},ce={properties:null},Fe=Object.keys(Bt);for(const fe of Fe){const[nt,Ft]=Bt[fe],mn=l.createExpression(Ft),Zn=l.createExpression("string"==typeof nt?[nt,["accumulated"],["get",fe]]:nt);pn[fe]=mn.value,ke[fe]=Zn.value}return _t.map=fe=>{ce.properties=fe;const nt={};for(const Ft of Fe)nt[Ft]=pn[Ft].evaluate(se,ce);return nt},_t.reduce=(fe,nt)=>{ce.properties=nt;for(const Ft of Fe)se.accumulated=fe[Ft],fe[Ft]=ke[Ft].evaluate(se,ce)},_t}(ue)).load(Mt.features):new yi(_t=Mt,ue.geojsonVtOptions)}catch(_t){return pe(_t)}this.loaded={};const At={};if(at){const _t=l.getPerformanceMeasurement(He);_t&&(At.resourceTiming={},At.resourceTiming[ue.source]=JSON.parse(JSON.stringify(_t)))}pe(null,At)}var _t})}reloadTile(ue,pe){const He=this.loaded;return He&&He[ue.uid]?super.reloadTile(ue,pe):this.loadTile(ue,pe)}loadGeoJSON(ue,pe){if(ue.request)l.getJSON(ue.request,pe);else{if("string"!=typeof ue.data)return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));try{return pe(null,JSON.parse(ue.data))}catch{return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ue,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(He){pe(He)}}getClusterChildren(ue,pe){try{pe(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(He){pe(He)}}getClusterLeaves(ue,pe){try{pe(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(He){pe(He)}}}class Co{constructor(ue){this.self=ue,this.actor=new l.Actor(ue,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=l.getProjection({name:"mercator"}),this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:Or},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,He)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=He},this.self.registerRTLTextPlugin=pe=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=pe.applyArabicShaping,l.plugin.processBidirectionalText=pe.processBidirectionalText,l.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}}clearCaches(ue,pe,He){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],He()}checkIfReady(ue,pe,He){He()}setReferrer(ue,pe){this.referrer=pe}spriteLoaded(ue,pe){this.isSpriteLoaded[ue]=pe;for(const He in this.workerSources[ue]){const at=this.workerSources[ue][He];for(const yt in at)at[yt]instanceof l.VectorTileWorkerSource&&(at[yt].isSpriteLoaded=pe,at[yt].fire(new l.Event("isSpriteLoaded")))}}setImages(ue,pe,He){this.availableImages[ue]=pe;for(const at in this.workerSources[ue]){const yt=this.workerSources[ue][at];for(const Mt in yt)yt[Mt].availableImages=pe}He()}enableTerrain(ue,pe,He){this.terrain=pe,He()}setProjection(ue,pe){this.projections[ue]=l.getProjection(pe)}setLayers(ue,pe,He){this.getLayerIndex(ue).replace(pe),He()}updateLayers(ue,pe,He){this.getLayerIndex(ue).update(pe.layers,pe.removedIds),He()}loadTile(ue,pe,He){const at=this.enableTerrain?l.extend({enableTerrain:this.terrain},pe):pe;at.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,pe.type,pe.source).loadTile(at,He)}loadDEMTile(ue,pe,He){const at=this.enableTerrain?l.extend({buildQuadTree:this.terrain},pe):pe;this.getDEMWorkerSource(ue,pe.source).loadTile(at,He)}reloadTile(ue,pe,He){const at=this.enableTerrain?l.extend({enableTerrain:this.terrain},pe):pe;at.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,pe.type,pe.source).reloadTile(at,He)}abortTile(ue,pe,He){this.getWorkerSource(ue,pe.type,pe.source).abortTile(pe,He)}removeTile(ue,pe,He){this.getWorkerSource(ue,pe.type,pe.source).removeTile(pe,He)}removeSource(ue,pe,He){if(!this.workerSources[ue]||!this.workerSources[ue][pe.type]||!this.workerSources[ue][pe.type][pe.source])return;const at=this.workerSources[ue][pe.type][pe.source];delete this.workerSources[ue][pe.type][pe.source],void 0!==at.removeSource?at.removeSource(pe,He):He()}loadWorkerSource(ue,pe,He){try{this.self.importScripts(pe.url),He()}catch(at){He(at.toString())}}syncRTLPluginState(ue,pe,He){try{l.plugin.setState(pe);const at=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=at){this.self.importScripts(at);const yt=l.plugin.isParsed();He(yt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${at}`),yt)}}catch(at){He(at.toString())}}getAvailableImages(ue){let pe=this.availableImages[ue];return pe||(pe=[]),pe}getLayerIndex(ue){let pe=this.layerIndexes[ue];return pe||(pe=this.layerIndexes[ue]=new Le),pe}getWorkerSource(ue,pe,He){return this.workerSources[ue]||(this.workerSources[ue]={}),this.workerSources[ue][pe]||(this.workerSources[ue][pe]={}),this.workerSources[ue][pe][He]||(this.workerSources[ue][pe][He]=new this.workerSourceTypes[pe]({send:(yt,Mt,At,_t,Bt,pn)=>{this.actor.send(yt,Mt,At,ue,Bt,pn)},scheduler:this.actor.scheduler},this.getLayerIndex(ue),this.getAvailableImages(ue),this.isSpriteLoaded[ue])),this.workerSources[ue][pe][He]}getDEMWorkerSource(ue,pe){return this.demWorkerSources[ue]||(this.demWorkerSources[ue]={}),this.demWorkerSources[ue][pe]||(this.demWorkerSources[ue][pe]=new tt),this.demWorkerSources[ue][pe]}enforceCacheSizeLimit(ue,pe){l.enforceCacheSizeLimit(pe)}getWorkerPerformanceMetrics(ue,pe,He){He(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Co(self)),Co}),w(0,function(l){function _e(h,i){if(Array.isArray(h)){if(!Array.isArray(i)||h.length!==i.length)return!1;for(let c=0;c<h.length;c++)if(!_e(h[c],i[c]))return!1;return!0}if("object"==typeof h&&null!==h&&null!==i){if("object"!=typeof i||Object.keys(h).length!==Object.keys(i).length)return!1;for(const c in h)if(!_e(h[c],i[c]))return!1;return!0}return h===i}var Ne=Le;function Le(h){return i=h,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,y,D=new Blob([""],{type:"text/javascript"}),A=URL.createObjectURL(D);try{y=new Worker(A),p=!0}catch{p=!1}return y&&y.terminate(),URL.revokeObjectURL(A),p}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var p=document.createElement("canvas");p.width=p.height=1;var y=p.getContext("2d");if(!y)return!1;var D=y.getImageData(0,0,1,1);return D&&D.width===p.width}()||(void 0===tt[c=i&&i.failIfMajorPerformanceCaveat]&&(tt[c]=function(p){var y,A,O,z,D=(A=p,O=document.createElement("canvas"),(z=Object.create(Le.webGLContextAttributes)).failIfMajorPerformanceCaveat=A,O.getContext("webgl",z)||O.getContext("experimental-webgl",z));if(!D)return!1;try{y=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!y||D.isContextLost())&&(D.shaderSource(y,"void main() {}"),D.compileShader(y),!0===D.getShaderParameter(y,D.COMPILE_STATUS))}(c)),!tt[c]||document.documentMode));var i,c}var tt={};function Ke(h,i,c){const p=l.window.document.createElement(h);return void 0!==i&&(p.className=i),c&&c.appendChild(p),p}function ye(h,i,c){const p=l.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const y of Object.keys(i))p.setAttributeNS(null,y,i[y]);return c&&c.appendChild(p),p}Le.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ae=l.window.document&&l.window.document.documentElement.style,Ze=Ae&&void 0!==Ae.userSelect?"userSelect":"WebkitUserSelect";let Qe;function ot(){Ae&&Ze&&(Qe=Ae[Ze],Ae[Ze]="none")}function mt(){Ae&&Ze&&(Ae[Ze]=Qe)}function xt(h){h.preventDefault(),h.stopPropagation(),l.window.removeEventListener("click",xt,!0)}function pt(){l.window.addEventListener("click",xt,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",xt,!0)},0)}function et(h,i){const c=h.getBoundingClientRect();return Ce(h,c,i)}function Ot(h,i){const c=h.getBoundingClientRect(),p=[];for(let y=0;y<i.length;y++)p.push(Ce(h,c,i[y]));return p}function Pt(h){return void 0!==l.window.InstallTrigger&&2===h.button&&h.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function Ce(h,i,c){const p=h.offsetWidth===i.width?1:h.offsetWidth/i.width;return new l.Point((c.clientX-i.left)*p,(c.clientY-i.top)*p)}function Ie(h,i){var c=i[0],p=i[1],y=i[2],D=i[3],A=c*D-y*p;return A?(h[0]=D*(A=1/A),h[1]=-p*A,h[2]=-y*A,h[3]=c*A,h):null}function ct(h){const{userImage:i}=h;return!!(i&&i.render&&i.render())&&(h.data.replace(new Uint8Array(i.data.buffer)),!0)}class St extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,c){this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),p=!1),p}_validateStretch(i,c){if(!i)return!0;let p=0;for(const y of i){if(y[0]<p||y[1]<y[0]||c<y[1])return!1;p=y[1]}return!0}_validateContent(i,c){return!(i&&(4!==i.length||i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,c){c.version=this.images[i].version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){const c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,c){let p=!0;if(!this.isLoaded())for(const y of i)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(i,c):this.requestors.push({ids:i,callback:c})}_notify(i,c){const p={};for(const y of i){this.images[y]||this.fire(new l.Event("styleimagemissing",{id:y}));const D=this.images[y];D?p[y]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:!(!D.userImage||!D.userImage.render)}:l.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){const c=this.patterns[i],p=this.getImage(i);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},D=new l.ImagePosition(y,p);this.patterns[i]={bin:y,position:D}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(i,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const D in this.patterns)i.push(this.patterns[D].bin);const{w:c,h:p}=l.potpack(i),y=this.atlasImage;y.resize({width:c||1,height:p||1});for(const D in this.patterns){const{bin:A}=this.patterns[D],O=A.x+1,z=A.y+1,G=this.images[D].data,W=G.width,oe=G.height;l.RGBAImage.copy(G,y,{x:0,y:0},{x:O,y:z},{width:W,height:oe}),l.RGBAImage.copy(G,y,{x:0,y:oe-1},{x:O,y:z-1},{width:W,height:1}),l.RGBAImage.copy(G,y,{x:0,y:0},{x:O,y:z+oe},{width:W,height:1}),l.RGBAImage.copy(G,y,{x:W-1,y:0},{x:O-1,y:z},{width:1,height:oe}),l.RGBAImage.copy(G,y,{x:0,y:0},{x:O+W,y:z},{width:1,height:oe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];ct(p)&&this.updateImage(c,p)}}}const Ye=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(h,i){return function([c,p,y]){const D=l.degToRad(p+90),A=l.degToRad(y);return{x:c*Math.cos(D)*Math.sin(A),y:c*Math.sin(D)*Math.sin(A),z:c*Math.cos(A),azimuthal:p,polar:y}}(h.expression.evaluate(i))}interpolate(h,i,c){return{x:l.number(h.x,i.x,c),y:l.number(h.y,i.y,c),z:l.number(h.z,i.z,c),azimuthal:l.number(h.azimuthal,i.azimuthal,c),polar:l.number(h.polar,i.polar,c)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)});class gt extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(Ye),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(l.validateLight,i,c))for(const p in i){const y=i[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const Wt=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)});let Nt=class extends l.Evented{constructor(h,i){super(),this._transitionable=new l.Transitionable(Wt),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(h){for(const i in h){const c=h[i];l.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),c):this._transitionable.setValue(i,c)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}};function an(h,i,c,p){const y=l.smoothstep(45,65,c),[D,A]=Qt(h,p),O=l.length(i);let z=1-Math.min(1,Math.exp((O-D)/(A-D)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*y*h.alpha}function Qt(h,i){const c=.5/Math.tan(.5*i);return[h.range[0]+c,h.range[1]+c]}const Vt=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"high-color":new l.DataConstantProperty(l.spec.fog["high-color"]),"space-color":new l.DataConstantProperty(l.spec.fog["space-color"]),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"]),"star-intensity":new l.DataConstantProperty(l.spec.fog["star-intensity"])});class Jn extends l.Evented{constructor(i,c){super(),this._transitionable=new l.Transitionable(Vt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const i=this._transform,c="globe"===i.projection.name,p=l.globeToMercatorTransition(i.zoom),y=this.properties.get("range"),D=[.5,3];return{range:c?[l.number(D[0],y[0],p),l.number(D[1],y[1],p)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c={}){if(!this._validate(l.validateFog,i,c)){for(const p of Object.keys(l.spec.fog))i&&void 0===i[p]&&(i[p]=l.spec.fog[p].default);for(const p in i){const y=i[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:l.smoothstep(45,65,i))*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?function(p,y,D){const A=l.MercatorCoordinate.fromLngLat(y),O=D.elevation?D.elevation.getAtPointOrZero(A):0,z=[A.x,A.y,O];return l.transformMat4(z,z,D.mercatorFogMatrix),an(p,z,D.pitch,D._fov)}(this.state,i,c):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?Qt(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class Zt{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const p=this.workerPool.acquire(this.id);for(let y=0;y<p.length;y++){const D=new Zt.Actor(p[y],c,this.id);D.name=`Worker ${y}`,this.actors.push(D)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,c,p){l.asyncAll(this.actors,(y,D)=>{y.send(i,c,D)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Pn(h,i,c){return i*(l.EXTENT/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}Zt.Actor=l.Actor;class zt{constructor(i,c,p,y){this.screenBounds=i,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(i,c){let p,y;if(i instanceof l.Point||"number"==typeof i[0]){const D=l.Point.convert(i);p=[D],y=c.isPointAboveHorizon(D)}else{const D=l.Point.convert(i[0]),A=l.Point.convert(i[1]);p=[D,A],y=l.polygonizeBounds(D,A).every(O=>c.isPointAboveHorizon(O))}return new zt(p,c.getCameraPoint(),y,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return l.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],y=l.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),l.bufferConvexPolygon(y,i)}bufferedCameraGeometryGlobe(i){const c=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],y=l.polygonizeBounds(c,p,i),D=this.cameraPoint.clone();switch(3*((D.y>c.y)+(D.y>p.y))+((D.x>c.x)+(D.x>p.x))){case 0:y[0]=D,y[4]=D.clone();break;case 1:y.splice(1,0,D);break;case 2:y[1]=D;break;case 3:y.splice(4,0,D);break;case 5:y.splice(2,0,D);break;case 6:y[3]=D;break;case 7:y.splice(3,0,D);break;case 8:y[2]=D}return y}containsTile(i,c,p,y=0){const D=i.queryPadding/c._pixelsPerMercatorPixel+1,A=p?this._bufferedCameraMercator(D,c):this._bufferedScreenMercator(D,c);let O=i.tileID.wrap+(A.unwrapped?y:0);const z=A.polygon.map(Oe=>l.getTilePoint(i.tileTransform,Oe,O));if(!l.polygonIntersectsBox(z,0,0,l.EXTENT,l.EXTENT))return;O=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const G=this.screenGeometryMercator.polygon.map(Oe=>l.getTileVec3(i.tileTransform,Oe,O)),W=G.map(Oe=>new l.Point(Oe[0],Oe[1])),oe=c.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),de=l.getTileVec3(i.tileTransform,oe,O),ge=G.map(Oe=>{const ae=l.sub(Oe,Oe,de);return l.normalize(ae,ae),new l.Ray(de,ae)}),be=Pn(i,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:ge,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(De=l.getBounds(z),De.min.x=l.clamp(De.min.x,0,l.EXTENT),De.min.y=l.clamp(De.min.y,0,l.EXTENT),De.max.x=l.clamp(De.max.x,0,l.EXTENT),De.max.y=l.clamp(De.max.y,0,l.EXTENT),De),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:be};var De}_bufferedScreenMercator(i,c){const p=ut(i);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let y;return y="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),c):{polygon:this.bufferedScreenGeometry(i).map(D=>c.pointCoordinate3D(D)),unwrapped:!0},this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(i,c){const p=ut(i);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let y;return y="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),c):{polygon:this.bufferedCameraGeometry(i).map(D=>c.pointCoordinate3D(D)),unwrapped:!0},this._cameraRaycastCache[p]=y,y}}_projectAndResample(i,c){const p=function(D,A){const O=l.multiply([],A.pixelMatrix,A.globeMatrix),z=[0,-l.GLOBE_RADIUS,0,1],G=[0,l.GLOBE_RADIUS,0,1],W=[0,0,0,1];l.transformMat4$1(z,z,O),l.transformMat4$1(G,G,O),l.transformMat4$1(W,W,O);const oe=new l.Point(z[0]/z[3],z[1]/z[3]),de=new l.Point(G[0]/G[3],G[1]/G[3]),ge=l.polygonContainsPoint(D,oe)&&z[3]<W[3],be=l.polygonContainsPoint(D,de)&&G[3]<W[3];if(!ge&&!be)return null;const De=function(dt,Lt,Tt){for(let qt=1;qt<dt.length;qt++){const Rn=ze(Lt.pointCoordinate3D(dt[qt-1]).x),Ht=ze(Lt.pointCoordinate3D(dt[qt]).x);if(Tt<0){if(Rn<Ht)return{idx:qt,t:-Rn/(Ht-1-Rn)}}else if(Ht<Rn)return{idx:qt,t:(1-Rn)/(Ht+1-Rn)}}return null}(D,A,ge?-1:1);if(!De)return null;const{idx:Oe,t:ae}=De;let Te=Oe>1?Se(D.slice(0,Oe),A):[],Ge=Oe<D.length?Se(D.slice(Oe),A):[];Te=Te.map(dt=>new l.Point(ze(dt.x),dt.y)),Ge=Ge.map(dt=>new l.Point(ze(dt.x),dt.y));const Ve=[...Te];0===Ve.length&&Ve.push(Ge[Ge.length-1]);const bt=l.number(Ve[Ve.length-1].y,(0===Ge.length?Te[0]:Ge[0]).y,ae);let wt;return wt=ge?[new l.Point(0,bt),new l.Point(0,0),new l.Point(1,0),new l.Point(1,bt)]:[new l.Point(1,bt),new l.Point(1,1),new l.Point(0,1),new l.Point(0,bt)],Ve.push(...wt),0===Ge.length?Ve.push(Te[0]):Ve.push(...Ge),{polygon:Ve.map(dt=>new l.MercatorCoordinate(dt.x,dt.y)),unwrapped:!1}}(i,c);if(p)return p;const y=function(D,A){let O=!1,z=-1/0,G=0;for(let oe=0;oe<D.length-1;oe++)D[oe].x>z&&(z=D[oe].x,G=oe);for(let oe=0;oe<D.length-1;oe++){const de=(G+oe)%(D.length-1),ge=D[de],be=D[de+1];Math.abs(ge.x-be.x)>.5&&(ge.x<be.x?(ge.x+=1,0===de&&(D[D.length-1].x+=1)):(be.x+=1,de+1===D.length-1&&(D[0].x+=1)),O=!0)}const W=l.mercatorXfromLng(A.center.lng);return O&&W<Math.abs(W-1)&&D.forEach(oe=>{oe.x-=1}),{polygon:D,unwrapped:O}}(Se(i,c).map(D=>new l.Point(ze(D.x),D.y)),c);return{polygon:y.polygon.map(D=>new l.MercatorCoordinate(D.x,D.y)),unwrapped:y.unwrapped}}}function Se(h,i){return l.resample(h,c=>{const p=i.pointCoordinate3D(c);c.x=p.x,c.y=p.y},1/256)}function ze(h){return h<0?1+h%1:h%1}function ut(h){return 100*h|0}function Dt(h,i,c,p,y){const D=function(A,O){if(A)return y(A);if(O){h.url&&O.tiles&&h.tiles&&delete h.tiles;const z=l.pick(l.extend(O,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(z.vectorLayers=O.vector_layers,z.vectorLayerIds=z.vectorLayers.map(G=>G.id)),z.tiles=i.canonicalizeTileset(z,h.url),y(null,z)}};return h.url?l.getJSON(i.transformRequest(i.normalizeSourceURL(h.url,null,c,p),l.ResourceType.Source),D):l.exported.frame(()=>D(null,h))}class jt{constructor(i,c,p){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const c=Math.pow(2,i.z),p=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*c),y=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*c),D=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*c),A=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*c);return i.x>=p&&i.x<D&&i.y>=y&&i.y<A}}class nn{constructor(i,c,p){this.context=i;const y=i.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ln={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _n{constructor(i,c,p,y){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.context=i;const D=i.gl;this.buffer=D.createBuffer(),i.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let p=0;p<this.attributes.length;p++){const y=c.attributes[this.attributes[p].name];void 0!==y&&i.enableVertexAttribArray(y)}}setVertexAttribPointers(i,c,p){for(let y=0;y<this.attributes.length;y++){const D=this.attributes[y],A=c.attributes[D.name];void 0!==A&&i.vertexAttribPointer(A,D.components,i[ln[D.type]],!1,this.itemSize,D.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class bn{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rn extends bn{getDefault(){return l.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Jt extends bn{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class en extends bn{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class dn extends bn{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Fn extends bn{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class pr extends bn{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class nr extends bn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class gr extends bn{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Xn extends bn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class Lr extends bn{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class yn extends bn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class Jr extends bn{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Li extends bn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class ui extends bn{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class hr extends bn{getDefault(){return l.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class wr extends bn{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class _r extends bn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class mr extends bn{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Di extends bn{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}let Gi,Tr=class extends bn{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class Mi extends bn{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class yi extends bn{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Yr extends bn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Do extends bn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Or extends bn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Co extends bn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Xe extends bn{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class ue extends bn{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class pe extends bn{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class He extends bn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class at extends bn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class yt extends bn{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Mt extends yt{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class At extends yt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class _t extends At{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Bt{constructor(i,c,p,y){this.context=i,this.width=c,this.height=p;const D=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Mt(i,D),y&&(this.depthAttachment=new At(i,D))}destroy(){const i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&i.deleteRenderbuffer(p)}i.deleteFramebuffer(this.framebuffer)}}class pn{constructor(i,c=!1){if(this.gl=i,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const p=i;this.extVertexArrayObject={createVertexArrayOES:p.createVertexArray.bind(i),deleteVertexArrayOES:p.deleteVertexArray.bind(i),bindVertexArrayOES:p.bindVertexArray.bind(i)}}this.clearColor=new rn(this),this.clearDepth=new Jt(this),this.clearStencil=new en(this),this.colorMask=new dn(this),this.depthMask=new Fn(this),this.stencilMask=new pr(this),this.stencilFunc=new nr(this),this.stencilOp=new gr(this),this.stencilTest=new Xn(this),this.depthRange=new Lr(this),this.depthTest=new yn(this),this.depthFunc=new Jr(this),this.blend=new Li(this),this.blendFunc=new ui(this),this.blendColor=new hr(this),this.blendEquation=new wr(this),this.cullFace=new _r(this),this.cullFaceSide=new mr(this),this.frontFace=new Di(this),this.program=new Tr(this),this.activeTexture=new Mi(this),this.viewport=new yi(this),this.bindFramebuffer=new Yr(this),this.bindRenderbuffer=new Do(this),this.bindTexture=new Or(this),this.bindVertexBuffer=new Co(this),this.bindElementBuffer=new Xe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ue(this),this.pixelStoreUnpack=new pe(this),this.pixelStoreUnpackPremultiplyAlpha=new He(this),this.pixelStoreUnpackFlipY=new at(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=i.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&i.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||i.getExtension("OES_standard_derivatives"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new nn(this,i,c)}createVertexBuffer(i,c,p){return new _n(this,i,c,p)}createRenderbuffer(i,c,p){const y=this.gl,D=y.createRenderbuffer();return this.bindRenderbuffer.set(D),y.renderbufferStorage(y.RENDERBUFFER,i,c,p),this.bindRenderbuffer.set(null),D}createFramebuffer(i,c,p){return new Bt(this,i,c,p)}clear({color:i,depth:c,stencil:p}){const y=this.gl;let D=0;i&&(D|=y.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(D|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==p&&(D|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(D)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){_e(i.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ke extends l.Evented{constructor(i,c,p,y){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(c,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(i){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=Dt(this._options,this.map._requestManager,c,p,(y,D)=>{this._tileJSONRequest=null,this._loaded=!0,y?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),p&&2!==p.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new l.ErrorEvent(y))):D&&(l.extend(this,D),D.bounds&&(this.tileBounds=new jt(D.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(D.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(y)})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}loadTile(i,c){const p=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(p,l.ResourceType.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,i.actor&&"expired"!==i.state)"loading"===i.state?i.reloadCallback=c:i.request=i.actor.send("reloadTile",y,D.bind(this));else if(i.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",y,D.bind(this),void 0,!0);else{const A=l.loadVectorTile.call({deduped:this._deduped},y,(O,z)=>{O||!z?D.call(this,O):(y.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},i.actor&&i.actor.send("loadTile",y,D.bind(this),void 0,!0))},!0);i.request={cancel:A}}function D(A,O){return delete i.request,i.aborted?c(null):A&&404!==A.status?c(A):(O&&O.resourceTiming&&(i.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&i.setExpiryData(O),i.loadVectorData(O,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id})}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class se extends l.Evented{constructor(i,c,p,y){super(),this.id=i,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},c),l.extend(this,l.pick(c,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Dt(this._options,this.map._requestManager,null,null,(c,p)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):p&&(l.extend(this,p),p.bounds&&(this.tileBounds=new jt(p.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(p.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(c)})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const p=l.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);i.request=l.getImage(this.map._requestManager.transformRequest(y,l.ResourceType.Tile),(D,A,O,z)=>(delete i.request,i.aborted?(i.state="unloaded",c(null)):D?(i.state="errored",c(D)):A?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:O,expires:z}),i.setTexture(A,this.map.painter),i.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(i,c,p){i.setTexture(c,p)}static unloadTileData(i,c){i.texture&&c.saveTileTexture(i.texture)}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c()}unloadTile(i,c){i.texture&&this.map.painter.saveTileTexture(i.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function ce(h,i,c,p,y,D,A,O){const z=[h,c,y,i,p,D,1,1,1],G=[A,O,1],W=l.adjoint([],z),[oe,de,ge]=l.transformMat3(G,G,l.transpose(W,W));return l.multiply$1(z,[oe,0,0,0,de,0,0,0,ge],z)}class Fe extends l.Evented{constructor(i,c,p,y){super(),this.id=i,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=c,this._dirty=!1}load(i,c){this._loaded=c||!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(p,y)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new l.ErrorEvent(p));else if(y){const{HTMLImageElement:D}=l.window;this.image=y instanceof D?l.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const c=i.map(l.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let y=1/0,D=1/0,A=-1/0,O=-1/0;for(const oe of p)y=Math.min(y,oe.x),D=Math.min(D,oe.y),A=Math.max(A,oe.x),O=Math.max(O,oe.y);const z=Math.max(A-y,O-D),G=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),W=Math.pow(2,G);return new l.CanonicalTileID(G,Math.floor((y+A)/2*W),Math.floor((D+O)/2*W))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const z in this.tiles){const G=this.tiles[z];"loaded"!==G.state&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const c=l.tileTransform(this.tileID,this.map.transform.projection),[p,y,D,A]=this.coordinates.map(z=>{const G=c.projection.project(z[0],z[1]);return l.getTilePoint(c,G)._round()});this.perspectiveTransform=function(z,G,W,oe,de,ge,be,De,Oe,ae){const Te=ce(0,0,z,0,0,G,z,G),Ge=ce(W,oe,de,ge,be,De,Oe,ae);return l.multiply$1(Ge,l.adjoint(Te,Te),Ge),[Ge[6]/Ge[8]*z/l.EXTENT,Ge[7]/Ge[8]*G/l.EXTENT]}(this.width,this.height,p.x,p.y,y.x,y.y,A.x,A.y,D.x,D.y);const O=this._boundsArray=new l.StructArrayLayout4i8;O.emplaceBack(p.x,p.y,0,0),O.emplaceBack(y.x,y.y,l.EXTENT,0),O.emplaceBack(A.x,A.y,0,l.EXTENT),O.emplaceBack(D.x,D.y,l.EXTENT,l.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(O,l.boundsAttributes.members),this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,c=i.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new l.Texture(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(i)}loadTile(i,c){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},c(null)):(i.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const fe={vector:ke,raster:se,"raster-dem":class extends se{constructor(h,i,c,p){super(h,i,c,p),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(h,i){const c=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,D){y&&(h.state="errored",i(y)),D&&(h.dem=D,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",i(null))}h.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),function(y,D,A,O){if(delete h.request,h.aborted)h.state="unloaded",i(null);else if(y)h.state="errored",i(y);else if(D){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:A,expires:O});const z=l.window.ImageBitmap&&D instanceof l.window.ImageBitmap&&(null==Gi&&(Gi=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof l.window.createImageBitmap),Gi),G=1-(D.width-l.prevPowerOfTwo(D.width))/2;G<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const W=z?D:l.exported.getImageData(D,G),oe={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:W,encoding:this.encoding,padding:G};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",oe,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const i=h.canonical,c=Math.pow(2,i.z),p=(i.x-1+c)%c,y=0===i.x?h.wrap-1:h.wrap,D=(i.x+1+c)%c,A=i.x+1===c?h.wrap+1:h.wrap,O={};return O[new l.OverscaledTileID(h.overscaledZ,y,i.z,p,i.y).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,A,i.z,D,i.y).key]={backfilled:!1},i.y>0&&(O[new l.OverscaledTileID(h.overscaledZ,y,i.z,p,i.y-1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,h.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,A,i.z,D,i.y-1).key]={backfilled:!1}),i.y+1<c&&(O[new l.OverscaledTileID(h.overscaledZ,y,i.z,p,i.y+1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,h.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},O[new l.OverscaledTileID(h.overscaledZ,A,i.z,D,i.y+1).key]={backfilled:!1}),O}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends l.Evented{constructor(h,i,c,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=i.data,this._options=l.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const y=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*y,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*y,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:l.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*y,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},i),this}getClusterChildren(h,i){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},i),this}getClusterLeaves(h,i,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:i,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=l.extend({},this.workerOptions),i=this._data;"string"==typeof i?(h.request=this.map._requestManager.transformRequest(l.exported.resolveURL(i),l.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new l.ErrorEvent(c));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y.resourceTiming=p.resourceTiming[this.id]),this.fire(new l.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,i){const c=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(c,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,y)=>(delete h.request,h.unloadVectorData(),h.aborted?i(null):p?i(p):(h.loadVectorData(y,this.map.painter,"reloadTile"===c),i(null))),void 0,"loadTile"===c)}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Fe{constructor(h,i,c,p){super(h,i,c,p),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const i of h.urls)this.urls.push(this.map._requestManager.transformRequest(i,l.ResourceType.Source).url);l.getVideo(this.urls,(i,c)=>{this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const i=this.video.seekable;h<i.start(0)||h>i.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const h=this.map.painter.context,i=h.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(h,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Fe,canvas:class extends Fe{constructor(h,i,c,p){super(h,i,c,p),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(y=>!Array.isArray(y)||2!==y.length||y.some(D=>"number"!=typeof D))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends l.Evented{constructor(h,i,c,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=i,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new l.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new l.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new jt(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),l.extend(this,l.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return l.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:i,y:c,z:p}=h.canonical;return this._implementation.hasTile({x:i,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,i){const{x:c,y:p,z:y}=h.tileID.canonical,D=new l.window.AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:c,y:p,z:y},{signal:D.signal})).then(function(A){return delete h.request,h.aborted?(h.state="unloaded",i(null)):void 0===A?(h.state="errored",i(null)):null===A?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",i(null)):(O=A)instanceof l.window.ImageData||O instanceof l.window.HTMLCanvasElement||O instanceof l.window.ImageBitmap||O instanceof l.window.HTMLImageElement?(this.loadTileData(h,A),h.state="loaded",void i(null)):(h.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(A=>{20!==A.code&&(h.state="errored",i(A))}),h.request.cancel=()=>D.abort()}loadTileData(h,i){se.loadTileData(h,i,this._map.painter)}unloadTileData(h){se.unloadTileData(h,this._map.painter)}unloadTile(h,i){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:c,y:p,z:y}=h.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:y})}i()}abortTile(h,i){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}}},nt=function(h,i,c,p){const y=new fe[i.type](h,i,c,p);if(y.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${y.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],y),y};function Ft(h,i){const c=l.identity([]);return l.scale(c,c,[.5*h.width,.5*-h.height,1]),l.translate(c,c,[1,-1,0]),l.multiply(c,c,h.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(c)}function mn(h,i,c,p,y,D,A,O=!1){const z=h.tilesIn(p,A,O);z.sort(Gn);const G=[];for(const oe of z)G.push({wrappedTileID:oe.tile.tileID.wrapped().key,queryResults:oe.tile.queryRenderedFeatures(i,c,h._state,oe,y,D,Ft(h.transform,oe.tile.tileID),O)});const W=function(oe){const de={},ge={};for(const be of oe){const De=be.queryResults,Oe=be.wrappedTileID,ae=ge[Oe]=ge[Oe]||{};for(const Te in De){const Ge=De[Te],Ve=ae[Te]=ae[Te]||{},bt=de[Te]=de[Te]||[];for(const wt of Ge)Ve[wt.featureIndex]||(Ve[wt.featureIndex]=!0,bt.push(wt))}}return de}(G);for(const oe in W)W[oe].forEach(de=>{const ge=de.feature,be=ge.layer;be&&"background"!==be.type&&"sky"!==be.type&&(ge.source=be.source,be["source-layer"]&&(ge.sourceLayer=be["source-layer"]),ge.state=void 0!==ge.id?h.getFeatureState(be["source-layer"],ge.id):{})});return W}function Zn(h,i){const c=h.getRenderableIds().map(D=>h.getTileByID(D)),p=[],y={};for(let D=0;D<c.length;D++){const A=c[D],O=A.tileID.canonical.key;y[O]||(y[O]=!0,A.querySourceFeatures(p,i))}return p}function Gn(h,i){const c=h.tileID,p=i.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function dr(){return null!=_o.workerClass?new _o.workerClass:new l.window.Worker(_o.workerUrl)}const yr="mapboxgl_preloaded_worker_pool";class Hr{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Hr.workerCount;)this.workers.push(new dr);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[yr]}numActive(){return Object.keys(this.active).length}}let ti;function no(){return ti||(ti=new Hr),ti}function Bo(h,i){const c={};for(const p in h)"ref"!==p&&(c[p]=h[p]);return l.refProperties.forEach(p=>{p in i&&(c[p]=i[p])}),c}function Kt(h){h=h.slice();const i=Object.create(null);for(let c=0;c<h.length;c++)i[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=Bo(h[c],i[h[c].ref]));return h}Hr.workerCount=2;const Et={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function wn(h,i,c){c.push({command:Et.addSource,args:[h,i[h]]})}function cr(h,i,c){i.push({command:Et.removeSource,args:[h]}),c[h]=!0}function qn(h,i,c,p){cr(h,c,p),wn(h,i,c)}function Rr(h,i,c){let p;for(p in h[c])if(h[c].hasOwnProperty(p)&&"data"!==p&&!_e(h[c][p],i[c][p]))return!1;for(p in i[c])if(i[c].hasOwnProperty(p)&&"data"!==p&&!_e(h[c][p],i[c][p]))return!1;return!0}function Fr(h,i,c,p,y,D){let A;for(A in i=i||{},h=h||{})h.hasOwnProperty(A)&&(_e(h[A],i[A])||c.push({command:D,args:[p,A,i[A],y]}));for(A in i)i.hasOwnProperty(A)&&!h.hasOwnProperty(A)&&(_e(h[A],i[A])||c.push({command:D,args:[p,A,i[A],y]}))}function di(h){return h.id}function Ci(h,i){return h[i.id]=i,h}class Qr{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=l.clamp(i,0,1);let c=1,p=this._distances[c];const y=i*this.paddedLength+this.padding;for(;p<y&&c<this._distances.length;)p=this._distances[++c];const D=c-1,A=this._distances[D],O=p-A,z=O>0?(y-A)/O:0;return this.points[D].mult(1-z).add(this.points[c].mult(z))}}class li{constructor(i,c,p){const y=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(c/p);for(let A=0;A<this.xCellCount*this.yCellCount;A++)y.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,p,y,D){this._forEachCell(c,p,y,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(D)}insertCircle(i,c,p,y){this._forEachCell(c-y,p-y,c+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(p),this.circles.push(y)}_insertBoxCell(i,c,p,y,D,A){this.boxCells[D].push(A)}_insertCircleCell(i,c,p,y,D,A){this.circleCells[D].push(A)}_query(i,c,p,y,D,A){if(p<0||i>this.width||y<0||c>this.height)return!D&&[];const O=[];if(i<=0&&c<=0&&this.width<=p&&this.height<=y){if(D)return!0;for(let z=0;z<this.boxKeys.length;z++)O.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const G=this.circles[3*z],W=this.circles[3*z+1],oe=this.circles[3*z+2];O.push({key:this.circleKeys[z],x1:G-oe,y1:W-oe,x2:G+oe,y2:W+oe})}return A?O.filter(A):O}return this._forEachCell(i,c,p,y,this._queryCell,O,{hitTest:D,seenUids:{box:{},circle:{}}},A),D?O.length>0:O}_queryCircle(i,c,p,y,D){const A=i-p,O=i+p,z=c-p,G=c+p;if(O<0||A>this.width||G<0||z>this.height)return!y&&[];const W=[];return this._forEachCell(A,z,O,G,this._queryCellCircle,W,{hitTest:y,circle:{x:i,y:c,radius:p},seenUids:{box:{},circle:{}}},D),y?W.length>0:W}query(i,c,p,y,D){return this._query(i,c,p,y,!1,D)}hitTest(i,c,p,y,D){return this._query(i,c,p,y,!0,D)}hitTestCircle(i,c,p,y){return this._queryCircle(i,c,p,!0,y)}_queryCell(i,c,p,y,D,A,O,z){const G=O.seenUids,W=this.boxCells[D];if(null!==W){const de=this.bboxes;for(const ge of W)if(!G.box[ge]){G.box[ge]=!0;const be=4*ge;if(i<=de[be+2]&&c<=de[be+3]&&p>=de[be+0]&&y>=de[be+1]&&(!z||z(this.boxKeys[ge]))){if(O.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[ge],x1:de[be],y1:de[be+1],x2:de[be+2],y2:de[be+3]})}}}const oe=this.circleCells[D];if(null!==oe){const de=this.circles;for(const ge of oe)if(!G.circle[ge]){G.circle[ge]=!0;const be=3*ge;if(this._circleAndRectCollide(de[be],de[be+1],de[be+2],i,c,p,y)&&(!z||z(this.circleKeys[ge]))){if(O.hitTest)return A.push(!0),!0;{const De=de[be],Oe=de[be+1],ae=de[be+2];A.push({key:this.circleKeys[ge],x1:De-ae,y1:Oe-ae,x2:De+ae,y2:Oe+ae})}}}}}_queryCellCircle(i,c,p,y,D,A,O,z){const G=O.circle,W=O.seenUids,oe=this.boxCells[D];if(null!==oe){const ge=this.bboxes;for(const be of oe)if(!W.box[be]){W.box[be]=!0;const De=4*be;if(this._circleAndRectCollide(G.x,G.y,G.radius,ge[De+0],ge[De+1],ge[De+2],ge[De+3])&&(!z||z(this.boxKeys[be])))return A.push(!0),!0}}const de=this.circleCells[D];if(null!==de){const ge=this.circles;for(const be of de)if(!W.circle[be]){W.circle[be]=!0;const De=3*be;if(this._circlesCollide(ge[De],ge[De+1],ge[De+2],G.x,G.y,G.radius)&&(!z||z(this.circleKeys[be])))return A.push(!0),!0}}}_forEachCell(i,c,p,y,D,A,O,z){const G=this._convertToXCellCoord(i),W=this._convertToYCellCoord(c),oe=this._convertToXCellCoord(p),de=this._convertToYCellCoord(y);for(let ge=G;ge<=oe;ge++)for(let be=W;be<=de;be++)if(D.call(this,i,c,p,y,this.xCellCount*be+ge,A,O,z))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,p,y,D,A){const O=y-i,z=D-c,G=p+A;return G*G>O*O+z*z}_circleAndRectCollide(i,c,p,y,D,A,O){const z=(A-y)/2,G=Math.abs(i-(y+z));if(G>z+p)return!1;const W=(O-D)/2,oe=Math.abs(c-(D+W));if(oe>W+p)return!1;if(G<=z||oe<=W)return!0;const de=G-z,ge=oe-W;return de*de+ge*ge<=p*p}}const Gr={unknown:0,flipRequired:1,flipNotRequired:2},Es=Math.tan(85*Math.PI/180);function on(h,i,c,p,y,D,A){const O=l.create();if(c)if("globe"===D.name){const z=l.calculateGlobeLabelMatrix(y,i);l.multiply(O,O,z)}else{const z=Ie([],A);O[0]=z[0],O[1]=z[1],O[4]=z[2],O[5]=z[3],p||l.rotateZ(O,O,y.angle)}else l.multiply(O,y.labelPlaneMatrix,h);return O}function ro(h,i,c,p,y,D,A){const O=on(h,i,c,p,y,D,A);return"globe"===D.name&&c||(O[2]=O[6]=O[10]=O[14]=0),O}function bi(h,i,c,p,y,D,A){if(c){if("globe"===D.name){const O=on(h,i,c,p,y,D,A);return l.invert(O,O),l.multiply(O,h,O),O}{const O=l.clone(h),z=l.identity([]);return z[0]=A[0],z[1]=A[1],z[4]=A[2],z[5]=A[3],l.multiply(O,O,z),p||l.rotateZ(O,O,-y.angle),O}}return y.glCoordMatrix}function ii(h,i,c,p){const y=[h,i,c,1];c?l.transformMat4$1(y,y,p):Be(y,y,p);const D=y[3];return y[0]/=D,y[1]/=D,y[2]/=D,y}function Yo(h,i){return Math.min(.5+h/i*.5,1.5)}function zi(h,i){const c=h[0]/h[3],p=h[1]/h[3];return c>=-i[0]&&c<=i[0]&&p>=-i[1]&&p<=i[1]}function ss(h,i,c,p,y,D,A,O,z,G){const W=c.transform,oe=p?h.textSizeData:h.iconSizeData,de=l.evaluateSizeForZoom(oe,c.transform.zoom),ge="globe"===W.projection.name,be=[256/c.width*2+1,256/c.height*2+1],De=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;De.clear();let Oe=null;ge&&(Oe=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const ae=h.lineVertexArray,Te=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,Ge=c.transform.width/c.transform.height;let Ve,bt=!1;for(let wt=0;wt<Te.length;wt++){const dt=Te.get(wt),{numGlyphs:Lt,writingMode:Tt}=dt;if(Tt!==l.WritingMode.vertical||bt||Ve===l.WritingMode.horizontal||(bt=!0),Ve=Tt,(dt.hidden||Tt===l.WritingMode.vertical)&&!bt){we(Lt,De);continue}bt=!1;const qt=new l.Point(dt.tileAnchorX,dt.tileAnchorY);let{x:Rn,y:Ht,z:Dn}=W.projection.projectTilePoint(qt.x,qt.y,G.canonical);if(z){const[Xr,ur,$r]=z(qt);Rn+=Xr,Ht+=ur,Dn+=$r}const sn=[Rn,Ht,Dn,1];if(l.transformMat4$1(sn,sn,i),!zi(sn,be)){we(Lt,De);continue}const Ln=Yo(c.transform.cameraToCenterDistance,sn[3]),Xt=l.evaluateSizeForFeature(oe,de,dt),xn=A?Xt/Ln:Xt*Ln,Nn=ii(Rn,Ht,Dn,y);if(Nn[3]<=0){we(Lt,De);continue}let An={};const $n=A?null:z,Ar=Wn(dt,xn,!1,O,i,y,D,h.glyphOffsetArray,ae,De,Oe,Nn,qt,An,Ge,$n,W.projection,G,A);bt=Ar.useVertical,$n&&Ar.needsFlipping&&(An={}),(Ar.notEnoughRoom||bt||Ar.needsFlipping&&Wn(dt,xn,!0,O,i,y,D,h.glyphOffsetArray,ae,De,Oe,Nn,qt,An,Ge,$n,W.projection,G,A).notEnoughRoom)&&we(Lt,De)}p?(h.text.dynamicLayoutVertexBuffer.updateData(De),Oe&&h.text.globeExtVertexBuffer.updateData(Oe)):(h.icon.dynamicLayoutVertexBuffer.updateData(De),Oe&&h.icon.globeExtVertexBuffer.updateData(Oe))}function Po(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De){const{lineStartIndex:Oe,glyphStartIndex:ae,segment:Te}=O,Ge=ae+O.numGlyphs,Ve=Oe+O.lineLength,bt=i.getoffsetX(ae),wt=i.getoffsetX(Ge-1),dt=$e(h*bt,c,p,y,D,A,Te,Oe,Ve,z,G,W,oe,de,!0,ge,be,De);if(!dt)return null;const Lt=$e(h*wt,c,p,y,D,A,Te,Oe,Ve,z,G,W,oe,de,!0,ge,be,De);return Lt?{first:dt,last:Lt}:null}function No(h,i,c,p){return h===l.WritingMode.horizontal&&Math.abs(p)>Math.abs(c)?{useVertical:!0}:h===l.WritingMode.vertical?p>0?{needsFlipping:!0}:null:i!==Gr.unknown&&(0===(y=c)||Math.abs(p/y)>Es)?i===Gr.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var y}function Wn(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De,Oe,ae,Te){const Ge=i/24,Ve=h.lineOffsetX*Ge,bt=h.lineOffsetY*Ge,{lineStartIndex:wt,glyphStartIndex:dt,numGlyphs:Lt,segment:Tt,writingMode:qt,flipState:Rn}=h,Ht=wt+h.lineLength,Dn=sn=>{if(W){const[Nn,An,$n]=sn.up,Ar=G.length;l.updateGlobeVertexNormal(W,Ar+0,Nn,An,$n),l.updateGlobeVertexNormal(W,Ar+1,Nn,An,$n),l.updateGlobeVertexNormal(W,Ar+2,Nn,An,$n),l.updateGlobeVertexNormal(W,Ar+3,Nn,An,$n)}const[Ln,Xt,xn]=sn.point;l.addDynamicAttributes(G,Ln,Xt,xn,sn.angle)};if(Lt>1){const sn=Po(Ge,O,Ve,bt,c,oe,de,h,z,D,ge,De,!1,Oe,ae,Te);if(!sn)return{notEnoughRoom:!0};if(p&&!c){let[Ln,Xt,xn]=sn.first.point,[Nn,An,$n]=sn.last.point;[Ln,Xt]=ii(Ln,Xt,xn,A),[Nn,An]=ii(Nn,An,$n,A);const Ar=No(qt,Rn,(Nn-Ln)*be,An-Xt);if(h.flipState=Ar&&Ar.needsFlipping?Gr.flipRequired:Gr.flipNotRequired,Ar)return Ar}Dn(sn.first);for(let Ln=dt+1;Ln<dt+Lt-1;Ln++){const Xt=$e(Ge*O.getoffsetX(Ln),Ve,bt,c,oe,de,Tt,wt,Ht,z,D,ge,De,!1,!1,Oe,ae,Te);if(!Xt)return G.length-=4*(Ln-dt),{notEnoughRoom:!0};Dn(Xt)}Dn(sn.last)}else{if(p&&!c){const Ln=ii(de.x,de.y,0,y),Xt=wt+Tt+1,xn=new l.Point(z.getx(Xt),z.gety(Xt)),Nn=ii(xn.x,xn.y,0,y),An=Nn[3]>0?Nn:he(de,xn,Ln,1,y,void 0,Oe,ae.canonical),$n=No(qt,Rn,(An[0]-Ln[0])*be,An[1]-Ln[1]);if(h.flipState=$n&&$n.needsFlipping?Gr.flipRequired:Gr.flipNotRequired,$n)return $n}const sn=$e(Ge*O.getoffsetX(dt),Ve,bt,c,oe,de,Tt,wt,Ht,z,D,ge,De,!1,!1,Oe,ae,Te);if(!sn)return{notEnoughRoom:!0};Dn(sn)}return{}}function Dr(h,i,c,p,y){const{x:D,y:A,z:O}=p.projectTilePoint(h.x,h.y,i);if(!y)return ii(D,A,O,c);const[z,G,W]=y(h);return ii(D+z,A+G,O+W,c)}function he(h,i,c,p,y,D,A,O){const z=Dr(h.sub(i)._unit()._add(h),O,y,A,D);return l.sub(z,c,z),l.normalize(z,z),l.scaleAndAdd(z,c,z,p)}function $e(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De,Oe,ae){const Te=p?h-i:h+i;let Ge=Te>0?1:-1,Ve=0;p&&(Ge*=-1,Ve=Math.PI),Ge<0&&(Ve+=Math.PI);let bt=O+A+(Ge>0?0:1)|0,wt=y,dt=y,Lt=0,Tt=0;const qt=Math.abs(Te),Rn=[],Ht=[];let Dn=D,sn=Dn;const Ln=()=>he(sn,Dn,dt,qt-Lt+1,W,de,De,Oe.canonical);for(;Lt+Tt<=qt;){if(bt+=Ge,bt<O||bt>=z)return null;if(dt=wt,sn=Dn,Rn.push(dt),ge&&Ht.push(sn),Dn=new l.Point(G.getx(bt),G.gety(bt)),wt=oe[bt],!wt){const $r=Dr(Dn,Oe.canonical,W,De,de);wt=$r[3]>0?oe[bt]=$r:Ln()}Lt+=Tt,Tt=l.distance(dt,wt)}be&&de&&(oe[bt]&&(wt=Ln(),Tt=l.distance(dt,wt)),oe[bt]=wt);const Xt=(qt-Lt)/Tt,xn=Dn.sub(sn)._mult(Xt)._add(sn),Nn=l.sub([],wt,dt),An=l.scaleAndAdd([],dt,Nn,Xt);let $n=[0,0,1],Ar=Nn[0],Xr=Nn[1];if(ae&&($n=De.upVector(Oe.canonical,xn.x,xn.y),0!==$n[0]||0!==$n[1]||1!==$n[2])){const $r=[$n[2],0,-$n[0]],mi=l.cross([],$n,$r);l.normalize($r,$r),l.normalize(mi,mi),Ar=l.dot(Nn,$r),Xr=l.dot(Nn,mi)}if(c){const $r=l.cross([],$n,Nn);l.normalize($r,$r),l.scaleAndAdd(An,An,$r,c*Ge)}const ur=Ve+Math.atan2(Xr,Ar);return Rn.push(An),ge&&Ht.push(xn),{point:An,angle:ur,path:Rn,tilePath:Ht,up:$n}}function we(h,i){const c=i.length,p=c+4*h;i.resize(p),i.float32.fill(-1/0,4*c,4*p)}function Be(h,i,c){const p=i[0],y=i[1];return h[0]=c[0]*p+c[4]*y+c[12],h[1]=c[1]*p+c[5]*y+c[13],h[3]=c[3]*p+c[7]*y+c[15],h}const Ct=100;class kt{constructor(i,c,p=new li(i.width+200,i.height+200,25),y=new li(i.width+200,i.height+200,25)){this.transform=i,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Ct,this.screenBottomBoundary=i.height+Ct,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,p,y,D,A,O,z){let G=p.projectedAnchorX,W=p.projectedAnchorY,oe=p.projectedAnchorZ;const de=p.elevation,ge=p.tileID,be=i.getProjection();if(de&&ge){const[wt,dt,Lt]=be.upVector(ge.canonical,p.tileAnchorX,p.tileAnchorY),Tt=be.upVectorScale(ge.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=wt*de*Tt,W+=dt*de*Tt,oe+=Lt*de*Tt}const De=this.projectAndGetPerspectiveRatio(O,G,W,oe,p.tileID,"globe"===be.name||!!de||this.transform.pitch>0,be),Oe=A*De.perspectiveRatio,ae=(p.x1*c+y.x-p.padding)*Oe+De.point.x,Te=(p.y1*c+y.y-p.padding)*Oe+De.point.y,Ge=(p.x2*c+y.x+p.padding)*Oe+De.point.x,Ve=(p.y2*c+y.y+p.padding)*Oe+De.point.y,bt=De.perspectiveRatio<=.55||De.occluded;return!this.isInsideGrid(ae,Te,Ge,Ve)||!D&&this.grid.hitTest(ae,Te,Ge,Ve,z)||bt?{box:[],offscreen:!1,occluded:De.occluded}:{box:[ae,Te,Ge,Ve],offscreen:this.isOffscreen(ae,Te,Ge,Ve),occluded:!1}}placeCollisionCircles(i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De){const Oe=[],ae=this.transform.elevation,Te=i.getProjection(),Ge=ae?ae.getAtTileOffsetFunc(De,this.transform.center.lat,this.transform.worldSize,Te):null,Ve=new l.Point(p.tileAnchorX,p.tileAnchorY);let{x:bt,y:wt,z:dt}=Te.projectTilePoint(Ve.x,Ve.y,De.canonical);if(Ge){const[xn,Nn,An]=Ge(Ve);bt+=xn,wt+=Nn,dt+=An}const Lt="globe"===Te.name,Tt=this.projectAndGetPerspectiveRatio(O,bt,wt,dt,De,Lt||!!ae||this.transform.pitch>0,Te),{perspectiveRatio:qt}=Tt,Rn=(oe?A/qt:A*qt)/l.ONE_EM,Ht=ii(bt,wt,dt,z),Dn=Tt.signedDistanceFromCamera>0?Po(Rn,D,p.lineOffsetX*Rn,p.lineOffsetY*Rn,!1,Ht,Ve,p,y,z,{},ae&&!oe?Ge:null,oe&&!!ae,Te,De,oe):null;let sn=!1,Ln=!1,Xt=!0;if(Dn&&!Tt.occluded){const xn=.5*ge*qt+be,Nn=new l.Point(-100,-100),An=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),$n=new Qr,{first:Ar,last:Xr}=Dn,ur=Ar.path.length;let $r=[];for(let xr=ur-1;xr>=1;xr--)$r.push(Ar.path[xr]);for(let xr=1;xr<Xr.path.length;xr++)$r.push(Xr.path[xr]);const mi=2.5*xn;G&&($r=$r.map(([xr,Yi,gi],ho)=>(Ge&&!Lt&&(gi=Ge(ho<ur-1?Ar.tilePath[ur-1-ho]:Xr.tilePath[ho-ur+2])[2]),ii(xr,Yi,gi,G))),$r.some(xr=>xr[3]<=0)&&($r=[]));let fi=[];if($r.length>0){let xr=1/0,Yi=-1/0,gi=1/0,ho=-1/0;for(const ao of $r)xr=Math.min(xr,ao[0]),gi=Math.min(gi,ao[1]),Yi=Math.max(Yi,ao[0]),ho=Math.max(ho,ao[1]);Yi>=Nn.x&&xr<=An.x&&ho>=Nn.y&&gi<=An.y&&(fi=[$r.map(ao=>new l.Point(ao[0],ao[1]))],(xr<Nn.x||Yi>An.x||gi<Nn.y||ho>An.y)&&(fi=l.clipLine(fi,Nn.x,Nn.y,An.x,An.y)))}for(const xr of fi){$n.reset(xr,.25*xn);let Yi=0;Yi=$n.length<=.5*xn?1:Math.ceil($n.paddedLength/mi)+1;for(let gi=0;gi<Yi;gi++){const ho=gi/Math.max(Yi-1,1),ao=$n.lerp(ho),Ns=ao.x+Ct,zs=ao.y+Ct;Oe.push(Ns,zs,xn,0);const Sa=Ns-xn,Ua=zs-xn,lo=Ns+xn,Vi=zs+xn;if(Xt=Xt&&this.isOffscreen(Sa,Ua,lo,Vi),Ln=Ln||this.isInsideGrid(Sa,Ua,lo,Vi),!c&&this.grid.hitTestCircle(Ns,zs,xn,de)&&(sn=!0,!W))return{circles:[],offscreen:!1,collisionDetected:sn,occluded:!1}}}}return{circles:!W&&sn||!Ln?[]:Oe,offscreen:Xt,collisionDetected:sn,occluded:Tt.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let p=1/0,y=1/0,D=-1/0,A=-1/0;for(const W of i){const oe=new l.Point(W.x+Ct,W.y+Ct);p=Math.min(p,oe.x),y=Math.min(y,oe.y),D=Math.max(D,oe.x),A=Math.max(A,oe.y),c.push(oe)}const O=this.grid.query(p,y,D,A).concat(this.ignoredGrid.query(p,y,D,A)),z={},G={};for(const W of O){const oe=W.key;if(void 0===z[oe.bucketInstanceId]&&(z[oe.bucketInstanceId]={}),z[oe.bucketInstanceId][oe.featureIndex])continue;const de=[new l.Point(W.x1,W.y1),new l.Point(W.x2,W.y1),new l.Point(W.x2,W.y2),new l.Point(W.x1,W.y2)];l.polygonIntersectsPolygon(c,de)&&(z[oe.bucketInstanceId][oe.featureIndex]=!0,void 0===G[oe.bucketInstanceId]&&(G[oe.bucketInstanceId]=[]),G[oe.bucketInstanceId].push(oe.featureIndex))}return G}insertCollisionBox(i,c,p,y,D){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:D},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,p,y,D){const A=c?this.ignoredGrid:this.grid,O={bucketInstanceId:p,featureIndex:y,collisionGroupID:D};for(let z=0;z<i.length;z+=4)A.insertCircle(O,i[z],i[z+1],i[z+2])}projectAndGetPerspectiveRatio(i,c,p,y,D,A,O){const z=[c,p,y,1];let G=!1;y||this.transform.pitch>0?(l.transformMat4$1(z,z,i),this.fogState&&D&&"globe"!==O.name&&(G=function(de,ge,be,De,Oe,ae){const Te=ae.calculateFogTileMatrix(Oe),Ge=[ge,be,De];return l.transformMat4(Ge,Ge,Te),an(de,Ge,ae.pitch,ae._fov)}(this.fogState,c,p,y,D.toUnwrapped(),this.transform)>.9)):Be(z,z,i);const W=z[3];return{point:new l.Point((z[0]/W+1)/2*this.transform.width+Ct,(-z[1]/W+1)/2*this.transform.height+Ct),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/W*.5,1.5),signedDistanceFromCamera:W,occluded:A&&z[2]>W||G}}isOffscreen(i,c,p,y){return p<Ct||i>=this.screenRightBoundary||y<Ct||c>this.screenBottomBoundary}isInsideGrid(i,c,p,y){return p>=0&&i<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i}}function cn(h,i,c){const p=i.createTileMatrix(h,h.worldSize,c.toUnwrapped());return l.multiply(new Float32Array(16),h.projMatrix,p)}function gn(h,i,c){if(i.projection.name===c.projection.name)return h.projMatrix;const p=c.clone();return p.setProjection(i.projection),cn(p,i.getProjection(),h)}function un(h,i,c){return i.name===c.projection.name?h.projMatrix:cn(c,i,h)}class In{constructor(i,c,p,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):y&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class lr{constructor(i,c,p,y,D,A=!1){this.text=new In(i?i.text:null,c,p,D),this.icon=new In(i?i.icon:null,c,y,D),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Cr{constructor(i,c,p,y=!1){this.text=i,this.icon=c,this.skipFade=p,this.clipped=y}}class kr{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class wi{constructor(i,c,p,y,D){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=D}}class io{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[i]}}function Hi(h,i,c,p,y){const{horizontalAlign:D,verticalAlign:A}=l.getAnchorAlignment(h),O=-(D-.5)*i,z=-(A-.5)*c,G=l.evaluateVariableOffset(h,p);return new l.Point(O+G[0]*y,z+G[1]*y)}function Ki(h,i,c,p,y){const D=new l.Point(h,i);return c&&D._rotate(p?y:-y),D}class Pi{constructor(i,c,p,y,D){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new kt(this.transform,D),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new io(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,p,y){const D=p.getBucket(c),A=p.latestFeatureIndex;if(!D||!A||c.id!==D.layerIds[0])return;const O=D.layers[0].layout,z=p.collisionBoxArray,G=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),W=p.tileSize/l.EXTENT,oe=p.tileID.toUnwrapped();this.transform.setProjection(D.projection);const de=(ge=p.tileID,be=D.getProjection(),De=this.transform,be.name===this.projection?De.calculateProjMatrix(ge.toUnwrapped()):cn(De,be,ge));var ge,be,De;const Oe="map"===O.get("text-pitch-alignment"),ae="map"===O.get("text-rotation-alignment");c.compileFilter();const Te=c.dynamicFilter(),Ge=c.dynamicFilterNeedsFeature(),Ve=this.transform.calculatePixelsToTileUnitsMatrix(p),bt=ro(de,p.tileID.canonical,Oe,ae,this.transform,D.getProjection(),Ve);let wt=null;if(Oe){const Tt=bi(de,p.tileID.canonical,Oe,ae,this.transform,D.getProjection(),Ve);wt=l.multiply([],this.transform.labelPlaneMatrix,Tt)}let dt=null;Te&&p.latestFeatureIndex&&(dt={unwrappedTileID:oe,dynamicFilter:Te,dynamicFilterNeedsFeature:Ge,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[D.bucketInstanceId]=new wi(D.bucketInstanceId,A,D.sourceLayerIndex,D.index,p.tileID);const Lt={bucket:D,layout:O,posMatrix:de,textLabelPlaneMatrix:bt,labelToScreenMatrix:wt,clippingData:dt,scale:G,textPixelRatio:W,holdingForFade:p.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(y)for(const Tt of D.sortKeyRanges){const{sortKey:qt,symbolInstanceStart:Rn,symbolInstanceEnd:Ht}=Tt;i.push({sortKey:qt,symbolInstanceStart:Rn,symbolInstanceEnd:Ht,parameters:Lt})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:Lt})}attemptAnchorPlacement(i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De,Oe,ae,Te){const{textOffset0:Ge,textOffset1:Ve,crossTileID:bt}=de,wt=[Ge,Ve],dt=Hi(i,p,y,wt,D),Lt=this.collisionIndex.placeCollisionBox(be,D,c,Ki(dt.x,dt.y,A,O,this.transform.angle),oe,z,G,W.predicate);if(Oe){const Tt=be.getSymbolInstanceIconSize(Te,this.transform.zoom,de.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(be,Tt,Oe,Ki(dt.x,dt.y,A,O,this.transform.angle),oe,z,G,W.predicate).box.length)return}if(Lt.box.length>0){let Tt;return this.prevPlacement&&this.prevPlacement.variableOffsets[bt]&&this.prevPlacement.placements[bt]&&this.prevPlacement.placements[bt].text&&(Tt=this.prevPlacement.variableOffsets[bt].anchor),this.variableOffsets[bt]={textOffset:wt,width:p,height:y,anchor:i,textScale:D,prevAnchor:Tt},this.markUsedJustification(be,i,de,De),be.allowVerticalPlacement&&(this.markUsedOrientation(be,De,de),this.placedOrientations[bt]=De),{shift:dt,placedGlyphBoxes:Lt}}}placeLayerBucketPart(i,c,p,y){const{bucket:D,layout:A,posMatrix:O,textLabelPlaneMatrix:z,labelToScreenMatrix:G,clippingData:W,textPixelRatio:oe,holdingForFade:de,collisionBoxArray:ge,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:De,collisionGroup:Oe}=i.parameters,ae=A.get("text-optional"),Te=A.get("icon-optional"),Ge=A.get("text-allow-overlap"),Ve=A.get("icon-allow-overlap"),bt="map"===A.get("text-rotation-alignment"),wt="map"===A.get("text-pitch-alignment"),dt="none"!==A.get("icon-text-fit"),Lt="viewport-y"===A.get("symbol-z-order");this.transform.setProjection(D.projection);let Tt=Ge&&(Ve||!D.hasIconData()||Te),qt=Ve&&(Ge||!D.hasTextData()||ae);!D.collisionArrays&&ge&&D.deserializeCollisionBoxes(ge),p&&y&&D.updateCollisionDebugBuffers(this.transform.zoom,ge);const Rn=(Ht,Dn,sn)=>{const{crossTileID:Ln,numVerticalGlyphVertices:Xt}=Ht;if(W){const lo={zoom:this.transform.zoom,pitch:this.transform.pitch};let Vi=null;if(W.dynamicFilterNeedsFeature){const Ii=this.retainedQueryData[D.bucketInstanceId];Vi=W.featureIndex.loadFeature({featureIndex:Ht.featureIndex,bucketIndex:Ii.bucketIndex,sourceLayerIndex:Ii.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,W.dynamicFilter)(lo,Vi,this.retainedQueryData[D.bucketInstanceId].tileID.canonical,new l.Point(Ht.tileAnchorX,Ht.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[Ln]=new Cr(!1,!1,!1,!0),void c.add(Ln)}if(c.has(Ln))return;if(de)return void(this.placements[Ln]=new Cr(!1,!1,!1));let xn=!1,Nn=!1,An=!0,$n=!1,Ar=!1,Xr=null,ur={box:null,offscreen:null,occluded:null},$r={box:null,offscreen:null,occluded:null},mi=null,fi=null,xr=null,Yi=0,gi=0,ho=0;sn.textFeatureIndex?Yi=sn.textFeatureIndex:Ht.useRuntimeCollisionCircles&&(Yi=Ht.featureIndex),sn.verticalTextFeatureIndex&&(gi=sn.verticalTextFeatureIndex);const ao=lo=>{lo.tileID=this.retainedQueryData[D.bucketInstanceId].tileID;const Vi=this.transform.elevation;(Vi||lo.elevation)&&(lo.elevation=Vi?Vi.getAtTileOffset(lo.tileID,lo.tileAnchorX,lo.tileAnchorY):0)},Ns=sn.textBox;if(Ns){ao(Ns);const lo=Ii=>{let hs=l.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Ii&&this.prevPlacement){const Zs=this.prevPlacement.placedOrientations[Ln];Zs&&(this.placedOrientations[Ln]=Zs,hs=Zs,this.markUsedOrientation(D,hs,Ht))}return hs},Vi=(Ii,hs)=>{if(D.allowVerticalPlacement&&Xt>0&&sn.verticalTextBox){for(const Zs of D.writingModes)if(Zs===l.WritingMode.vertical?(ur=hs(),$r=ur):ur=Ii(),ur&&ur.box&&ur.box.length)break}else ur=Ii()};if(A.get("text-variable-anchor")){let Ii=A.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ln]){const to=this.prevPlacement.variableOffsets[Ln];Ii.indexOf(to.anchor)>0&&(Ii=Ii.filter(Ia=>Ia!==to.anchor),Ii.unshift(to.anchor))}const hs=(to,Ia,$u)=>{const Oc=D.getSymbolInstanceTextSize(be,Ht,this.transform.zoom,Dn),Vu=(to.x2-to.x1)*Oc+2*to.padding,Jl=(to.y2-to.y1)*Oc+2*to.padding,_c=dt&&!Ve?Ia:null;_c&&ao(_c);let kc={box:[],offscreen:!1,occluded:!1};const gd=Ge?2*Ii.length:Ii.length;for(let ul=0;ul<gd;++ul){const _d=this.attemptAnchorPlacement(Ii[ul%Ii.length],to,Vu,Jl,Oc,bt,wt,oe,O,Oe,ul>=Ii.length,Ht,Dn,D,$u,_c,be,De);if(_d&&(kc=_d.placedGlyphBoxes,kc&&kc.box&&kc.box.length)){xn=!0,Xr=_d.shift;break}}return kc};Vi(()=>hs(Ns,sn.iconBox,l.WritingMode.horizontal),()=>{const to=sn.verticalTextBox;return to&&ao(to),D.allowVerticalPlacement&&!(ur&&ur.box&&ur.box.length)&&Xt>0&&to?hs(to,sn.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),ur&&(xn=ur.box,An=ur.offscreen,$n=ur.occluded);const Zs=lo(!(!ur||!ur.box));if(!xn&&this.prevPlacement){const to=this.prevPlacement.variableOffsets[Ln];to&&(this.variableOffsets[Ln]=to,this.markUsedJustification(D,to.anchor,Ht,Zs))}}else{const Ii=(hs,Zs)=>{const to=D.getSymbolInstanceTextSize(be,Ht,this.transform.zoom,Dn),Ia=this.collisionIndex.placeCollisionBox(D,to,hs,new l.Point(0,0),Ge,oe,O,Oe.predicate);return Ia&&Ia.box&&Ia.box.length&&(this.markUsedOrientation(D,Zs,Ht),this.placedOrientations[Ln]=Zs),Ia};Vi(()=>Ii(Ns,l.WritingMode.horizontal),()=>{const hs=sn.verticalTextBox;return D.allowVerticalPlacement&&Xt>0&&hs?(ao(hs),Ii(hs,l.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),lo(!!(ur&&ur.box&&ur.box.length))}}if(mi=ur,xn=mi&&mi.box&&mi.box.length>0,An=mi&&mi.offscreen,$n=mi&&mi.occluded,Ht.useRuntimeCollisionCircles){const lo=D.text.placedSymbolArray.get(Ht.centerJustifiedTextSymbolIndex>=0?Ht.centerJustifiedTextSymbolIndex:Ht.verticalPlacedTextSymbolIndex),Vi=l.evaluateSizeForFeature(D.textSizeData,be,lo),Ii=A.get("text-padding");fi=this.collisionIndex.placeCollisionCircles(D,Ge,lo,D.lineVertexArray,D.glyphOffsetArray,Vi,O,z,G,p,wt,Oe.predicate,Ht.collisionCircleDiameter*Vi/l.ONE_EM,Ii,this.retainedQueryData[D.bucketInstanceId].tileID),xn=Ge||fi.circles.length>0&&!fi.collisionDetected,An=An&&fi.offscreen,$n=fi.occluded}if(sn.iconFeatureIndex&&(ho=sn.iconFeatureIndex),sn.iconBox){const lo=Vi=>{ao(Vi);const Ii=dt&&Xr?Ki(Xr.x,Xr.y,bt,wt,this.transform.angle):new l.Point(0,0),hs=D.getSymbolInstanceIconSize(De,this.transform.zoom,Ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(D,hs,Vi,Ii,Ve,oe,O,Oe.predicate)};$r&&$r.box&&$r.box.length&&sn.verticalIconBox?(xr=lo(sn.verticalIconBox),Nn=xr.box.length>0):(xr=lo(sn.iconBox),Nn=xr.box.length>0),An=An&&xr.offscreen,Ar=xr.occluded}const zs=ae||0===Ht.numHorizontalGlyphVertices&&0===Xt,Sa=Te||0===Ht.numIconVertices;if(zs||Sa?Sa?zs||(Nn=Nn&&xn):xn=Nn&&xn:Nn=xn=Nn&&xn,xn&&mi&&mi.box&&this.collisionIndex.insertCollisionBox(mi.box,A.get("text-ignore-placement"),D.bucketInstanceId,$r&&$r.box&&gi?gi:Yi,Oe.ID),Nn&&xr&&this.collisionIndex.insertCollisionBox(xr.box,A.get("icon-ignore-placement"),D.bucketInstanceId,ho,Oe.ID),fi&&(xn&&this.collisionIndex.insertCollisionCircles(fi.circles,A.get("text-ignore-placement"),D.bucketInstanceId,Yi,Oe.ID),p)){const lo=D.bucketInstanceId;let Vi=this.collisionCircleArrays[lo];void 0===Vi&&(Vi=this.collisionCircleArrays[lo]=new kr);for(let Ii=0;Ii<fi.circles.length;Ii+=4)Vi.circles.push(fi.circles[Ii+0]),Vi.circles.push(fi.circles[Ii+1]),Vi.circles.push(fi.circles[Ii+2]),Vi.circles.push(fi.collisionDetected?1:0)}const Ua="globe"!==D.projection.name;Tt=Tt&&(Ua||!$n),qt=qt&&(Ua||!Ar),this.placements[Ln]=new Cr(xn||Tt,Nn||qt,An||D.justReloaded),c.add(Ln)};if(Lt){const Ht=D.getSortedSymbolIndexes(this.transform.angle);for(let Dn=Ht.length-1;Dn>=0;--Dn){const sn=Ht[Dn];Rn(D.symbolInstances.get(sn),sn,D.collisionArrays[sn])}}else for(let Ht=i.symbolInstanceStart;Ht<i.symbolInstanceEnd;Ht++)Rn(D.symbolInstances.get(Ht),Ht,D.collisionArrays[Ht]);if(p&&D.bucketInstanceId in this.collisionCircleArrays){const Ht=this.collisionCircleArrays[D.bucketInstanceId];l.invert(Ht.invProjMatrix,O),Ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(i,c,p,y){const{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:z,crossTileID:G}=p,W=l.getAnchorJustification(c),oe=y===l.WritingMode.vertical?z:"left"===W?D:"center"===W?A:"right"===W?O:-1;D>=0&&(i.text.placedSymbolArray.get(D).crossTileID=oe>=0&&D!==oe?0:G),A>=0&&(i.text.placedSymbolArray.get(A).crossTileID=oe>=0&&A!==oe?0:G),O>=0&&(i.text.placedSymbolArray.get(O).crossTileID=oe>=0&&O!==oe?0:G),z>=0&&(i.text.placedSymbolArray.get(z).crossTileID=oe>=0&&z!==oe?0:G)}markUsedOrientation(i,c,p){const y=c===l.WritingMode.horizontal||c===l.WritingMode.horizontalOnly?c:0,D=c===l.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:G}=p,W=i.text.placedSymbolArray;A>=0&&(W.get(A).placedOrientation=y),O>=0&&(W.get(O).placedOrientation=y),z>=0&&(W.get(z).placedOrientation=y),G>=0&&(W.get(G).placedOrientation=D)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const y=c?c.symbolFadeChange(i):1,D=c?c.opacities:{},A=c?c.variableOffsets:{},O=c?c.placedOrientations:{};for(const z in this.placements){const G=this.placements[z],W=D[z];W?(this.opacities[z]=new lr(W,y,G.text,G.icon,null,G.clipped),p=p||G.text!==W.text.placed||G.icon!==W.icon.placed):(this.opacities[z]=new lr(null,y,G.text,G.icon,G.skipFade,G.clipped),p=p||G.text||G.icon)}for(const z in D){const G=D[z];if(!this.opacities[z]){const W=new lr(G,y,!1,!1);W.isHidden()||(this.opacities[z]=W,p=p||G.text.placed||G.icon.placed)}}for(const z in A)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=A[z]);for(const z in O)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=O[z]);p?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){const p=new Set;for(const y of c){const D=y.getBucket(i);D&&y.latestFeatureIndex&&i.id===D.layerIds[0]&&this.updateBucketOpacities(D,p,y.collisionBoxArray)}}updateBucketOpacities(i,c,p){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const y=i.layers[0].layout,D=!!i.layers[0].dynamicFilter(),A=new lr(null,0,!1,!1,!0),O=y.get("text-allow-overlap"),z=y.get("icon-allow-overlap"),G=y.get("text-variable-anchor"),W="map"===y.get("text-rotation-alignment"),oe="map"===y.get("text-pitch-alignment"),de="none"!==y.get("icon-text-fit"),ge=new lr(null,0,O&&(z||!i.hasIconData()||y.get("icon-optional")),z&&(O||!i.hasTextData()||y.get("text-optional")),!0);!i.collisionArrays&&p&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(p);const be=(Oe,ae,Te)=>{for(let Ge=0;Ge<ae/4;Ge++)Oe.opacityVertexArray.emplaceBack(Te)};let De=0;for(let Oe=0;Oe<i.symbolInstances.length;Oe++){const ae=i.symbolInstances.get(Oe),{numHorizontalGlyphVertices:Te,numVerticalGlyphVertices:Ge,crossTileID:Ve,numIconVertices:bt}=ae,wt=c.has(Ve);let dt=this.opacities[Ve];wt?dt=A:dt||(dt=ge,this.opacities[Ve]=dt),c.add(Ve);const Lt=Te>0||Ge>0,Tt=bt>0,qt=this.placedOrientations[Ve],Rn=qt===l.WritingMode.vertical,Ht=qt===l.WritingMode.horizontal||qt===l.WritingMode.horizontalOnly;if(!Lt&&!Tt||dt.isHidden()||De++,Lt){const Dn=as(dt.text);be(i.text,Te,Rn?Bi:Dn),be(i.text,Ge,Ht?Bi:Dn);const sn=dt.text.isHidden(),{leftJustifiedTextSymbolIndex:Ln,centerJustifiedTextSymbolIndex:Xt,rightJustifiedTextSymbolIndex:xn,verticalPlacedTextSymbolIndex:Nn}=ae,An=i.text.placedSymbolArray,$n=sn||Rn?1:0;Ln>=0&&(An.get(Ln).hidden=$n),Xt>=0&&(An.get(Xt).hidden=$n),xn>=0&&(An.get(xn).hidden=$n),Nn>=0&&(An.get(Nn).hidden=sn||Ht?1:0);const Ar=this.variableOffsets[Ve];Ar&&this.markUsedJustification(i,Ar.anchor,ae,qt);const Xr=this.placedOrientations[Ve];Xr&&(this.markUsedJustification(i,"left",ae,Xr),this.markUsedOrientation(i,Xr,ae))}if(Tt){const Dn=as(dt.icon),{placedIconSymbolIndex:sn,verticalPlacedIconSymbolIndex:Ln}=ae,Xt=i.icon.placedSymbolArray,xn=dt.icon.isHidden()?1:0;sn>=0&&(be(i.icon,bt,Rn?Bi:Dn),Xt.get(sn).hidden=xn),Ln>=0&&(be(i.icon,ae.numVerticalIconVertices,Ht?Bi:Dn),Xt.get(Ln).hidden=xn)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Dn=i.collisionArrays[Oe];if(Dn){let sn=new l.Point(0,0),Ln=!0;if(Dn.textBox||Dn.verticalTextBox){if(G){const xn=this.variableOffsets[Ve];xn?(sn=Hi(xn.anchor,xn.width,xn.height,xn.textOffset,xn.textScale),W&&sn._rotate(oe?this.transform.angle:-this.transform.angle)):Ln=!1}D&&(Ln=!dt.clipped),Dn.textBox&&To(i.textCollisionBox.collisionVertexArray,dt.text.placed,!Ln||Rn,sn.x,sn.y),Dn.verticalTextBox&&To(i.textCollisionBox.collisionVertexArray,dt.text.placed,!Ln||Ht,sn.x,sn.y)}const Xt=Ln&&!(Ht||!Dn.verticalIconBox);Dn.iconBox&&To(i.iconCollisionBox.collisionVertexArray,dt.icon.placed,Xt,de?sn.x:0,de?sn.y:0),Dn.verticalIconBox&&To(i.iconCollisionBox.collisionVertexArray,dt.icon.placed,!Xt,de?sn.x:0,de?sn.y:0)}}}if(i.fullyClipped=0===De,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Oe=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Oe.invProjMatrix,i.placementViewportMatrix=Oe.viewportMatrix,i.collisionCircleArray=Oe.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function To(h,i,c,p,y){h.emplaceBack(i?1:0,c?1:0,p||0,y||0),h.emplaceBack(i?1:0,c?1:0,p||0,y||0),h.emplaceBack(i?1:0,c?1:0,p||0,y||0),h.emplaceBack(i?1:0,c?1:0,p||0,y||0)}const Vr=Math.pow(2,25),qr=Math.pow(2,24),Ji=Math.pow(2,17),ps=Math.pow(2,16),Ai=Math.pow(2,9),So=Math.pow(2,8),Ks=Math.pow(2,1);function as(h){if(0===h.opacity&&!h.placed)return 0;if(1===h.opacity&&h.placed)return 4294967295;const i=h.placed?1:0,c=Math.floor(127*h.opacity);return c*Vr+i*qr+c*Ji+i*ps+c*Ai+i*So+c*Ks+i}const Bi=0;class Os{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(i,c,p,y,D){const A=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(A,y,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((O,z)=>O.sortKey-z.sortKey));this._currentPartIndex<A.length;){const O=A[this._currentPartIndex];if(c.placeLayerBucketPart(O,this._seenCrossTileIDs,p,0===O.symbolInstanceStart),this._currentPartIndex++,D())return!0}return!1}}class Ri{constructor(i,c,p,y,D,A,O,z){this.placement=new Pi(i,D,A,O,z),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(i,c,p){const y=l.exported.now(),D=()=>{const A=l.exported.now()-y;return!this._forceFullPlacement&&A>2};for(;this._currentPlacementIndex>=0;){const A=c[i[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===A.type&&(!A.minzoom||A.minzoom<=O)&&(!A.maxzoom||A.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Os(A)),this._inProgressLayer.continuePlacement(p[A.source],this.placement,this._showCollisionBoxes,A,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const rr=512/l.EXTENT/2;class vr{constructor(i,c,p){this.tileID=i,this.bucketInstanceId=p,this.index=new l.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=i.canonical.x*l.EXTENT,D=i.canonical.y*l.EXTENT;for(let A=0;A<c.length;A++){const{key:O,crossTileID:z,tileAnchorX:G,tileAnchorY:W}=c.get(A),oe=Math.floor((y+G)*rr),de=Math.floor((D+W)*rr);this.index.add(oe,de),this.keys.push(O),this.crossTileIDs.push(z)}this.index.finish()}findMatches(i,c,p){const y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),D=rr/Math.pow(2,c.canonical.z-this.tileID.canonical.z),A=c.canonical.x*l.EXTENT,O=c.canonical.y*l.EXTENT;for(let z=0;z<i.length;z++){const G=i.get(z);if(G.crossTileID)continue;const{key:W,tileAnchorX:oe,tileAnchorY:de}=G,ge=Math.floor((A+oe)*D),be=Math.floor((O+de)*D),De=this.index.range(ge-y,be-y,ge+y,be+y);for(const Oe of De){const ae=this.crossTileIDs[Oe];if(this.keys[Oe]===W&&!p.has(ae)){p.add(ae),G.crossTileID=ae;break}}}}}class Ti{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Io{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(0!==c)for(const p in this.indexes){const y=this.indexes[p],D={};for(const A in y){const O=y[A];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+c),D[O.tileID.key]=O}this.indexes[p]=D}this.lng=i}addBucket(i,c,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let D=0;D<c.symbolInstances.length;D++)c.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]=new Set);const y=this.usedCrossTileIDs[i.overscaledZ];for(const D in this.indexes){const A=this.indexes[D];if(Number(D)>i.overscaledZ)for(const O in A){const z=A[O];z.tileID.isChildOf(i)&&z.findMatches(c.symbolInstances,i,y)}else{const O=A[i.scaledTo(Number(D)).key];O&&O.findMatches(c.symbolInstances,i,y)}}for(let D=0;D<c.symbolInstances.length;D++){const A=c.symbolInstances.get(D);A.crossTileID||(A.crossTileID=p.generate(),y.add(A.crossTileID))}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new vr(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const p of c.crossTileIDs)this.usedCrossTileIDs[i].delete(p)}removeStaleBuckets(i){let c=!1;for(const p in this.indexes){const y=this.indexes[p];for(const D in y)i[y[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[D]),delete y[D],c=!0)}return c}}class zo{constructor(){this.layerIndexes={},this.crossTileIDs=new Ti,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,p,y){let D=this.layerIndexes[i.id];void 0===D&&(D=this.layerIndexes[i.id]=new Io);let A=!1;const O={};"globe"!==y.name&&D.handleWrapJump(p);for(const z of c){const G=z.getBucket(i);G&&i.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),D.addBucket(z.tileID,G,this.crossTileIDs)&&(A=!0),O[G.bucketInstanceId]=!0)}return D.removeStaleBuckets(O)&&(A=!0),A}pruneUnusedLayers(i){const c={};i.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const Si=(h,i)=>l.emitValidationErrors(h,i&&i.filter(c=>"source.canvas"!==c.identifier)),Ms=l.pick(Et,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Qi=l.pick(Et,["setCenter","setZoom","setBearing","setPitch"]),$o={version:8,layers:[],sources:{}},Vo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Mr extends l.Evented{constructor(i,c={}){super(),this.map=i,this.dispatcher=new Zt(no(),this),this.imageManager=new St,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(i._requestManager,c.localFontFamily?l.LocalGlyphMode.all:c.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new zo,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const p=this;this._rtlTextPluginCallback=Mr.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(D,A)=>{if(l.triggerPluginCompletionEvent(D),A&&A.every(O=>O))for(const O in p._sourceCaches){const z=p._sourceCaches[O],G=z.getSource().type;"vector"!==G&&"geojson"!==G||z.reload()}})}),this.on("data",y=>{if("source"!==y.dataType||"metadata"!==y.sourceDataType)return;const D=this.getSource(y.sourceId);if(D&&D.vectorLayerIds)for(const A in this._layers){const O=this._layers[A];O.source===D.id&&this._validateLayer(O)}})}loadURL(i,c={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const p="boolean"==typeof c.validate?c.validate:!l.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,c.accessToken);const y=this.map._requestManager.transformRequest(i,l.ResourceType.Style);this._request=l.getJSON(y,(D,A)=>{this._request=null,D?this.fire(new l.ErrorEvent(D)):A&&this._load(A,p)})}loadJSON(i,c={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(i,!1!==c.validate)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load($o,!1)}_updateLayerCount(i,c){const p=c?1:-1;i.is3D()&&(this._num3DLayers+=p),"circle"===i.type&&(this._numCircleLayers+=p),"symbol"===i.type&&(this._numSymbolLayers+=p)}_load(i,c){if(c&&Si(this,l.validateStyle(i)))return;this._loaded=!0,this.stylesheet=l.clone$1(i),this._updateMapProjection();for(const y in i.sources)this.addSource(y,i.sources[y],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const p=Kt(this.stylesheet.layers);this._order=p.map(y=>y.id),this._layers={},this._serializedLayers={};for(const y of p){const D=l.createStyleLayer(y);D.setEventedParent(this,{layer:{id:D.id}}),this._layers[D.id]=D,this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new gt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(i){this._spriteRequest=function(c,p,y){let D,A,O;const z=l.exported.devicePixelRatio>1?"@2x":"";let G=l.getJSON(p.transformRequest(p.normalizeSpriteURL(c,z,".json"),l.ResourceType.SpriteJSON),(de,ge)=>{G=null,O||(O=de,D=ge,oe())}),W=l.getImage(p.transformRequest(p.normalizeSpriteURL(c,z,".png"),l.ResourceType.SpriteImage),(de,ge)=>{W=null,O||(O=de,A=ge,oe())});function oe(){if(O)y(O);else if(D&&A){const de=l.exported.getImageData(A),ge={};for(const be in D){const{width:De,height:Oe,x:ae,y:Te,sdf:Ge,pixelRatio:Ve,stretchX:bt,stretchY:wt,content:dt}=D[be],Lt=new l.RGBAImage({width:De,height:Oe});l.RGBAImage.copy(de,Lt,{x:ae,y:Te},{x:0,y:0},{width:De,height:Oe}),ge[be]={data:Lt,pixelRatio:Ve,sdf:Ge,stretchX:bt,stretchY:wt,content:dt}}y(null,ge)}}return{cancel(){G&&(G.cancel(),G=null),W&&(W.cancel(),W=null)}}}(i,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new l.ErrorEvent(c));else if(p)for(const y in p)this.imageManager.addImage(y,p[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(i){const c=this.getSource(i.source);if(!c)return;const p=i.sourceLayer;p&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(p))&&this.fire(new l.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const c=[];for(const p of i){const y=this._layers[p];"custom"!==y.type&&c.push(y.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&("function"==typeof i.isLayerDraped?i.isLayerDraped():Vo[i.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const c=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);(y.length||D.length)&&this._updateWorkerLayers(y,D);for(const A in this._updatedSources){const O=this._updatedSources[A];"reload"===O?this._reloadSource(A):"clear"===O&&this._clearSource(A)}this._updateTilesForChangedImages();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const p={};for(const y in this._sourceCaches){const D=this._sourceCaches[y];p[y]=D.used,D.used=!1}for(const y of this._order){const D=this._layers[y];if(D.recalculate(i,this._availableImages),!D.isHidden(i.zoom)){const O=this._getLayerSourceCache(D);O&&(O.used=!0)}const A=this.map.painter;if(A){const O=D.getProgramIds();if(!O)continue;const z=D.getProgramConfiguration(i.zoom);for(const G of O)A.useProgram(G,z)}}for(const y in p){const D=this._sourceCaches[y];p[y]!==D.used&&D.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Si(this,l.validateStyle(i)))return!1;(i=l.clone$1(i)).layers=Kt(i.layers);const c=function(y,D){if(!y)return[{command:Et.setStyle,args:[D]}];let A=[];try{if(!_e(y.version,D.version))return[{command:Et.setStyle,args:[D]}];_e(y.center,D.center)||A.push({command:Et.setCenter,args:[D.center]}),_e(y.zoom,D.zoom)||A.push({command:Et.setZoom,args:[D.zoom]}),_e(y.bearing,D.bearing)||A.push({command:Et.setBearing,args:[D.bearing]}),_e(y.pitch,D.pitch)||A.push({command:Et.setPitch,args:[D.pitch]}),_e(y.sprite,D.sprite)||A.push({command:Et.setSprite,args:[D.sprite]}),_e(y.glyphs,D.glyphs)||A.push({command:Et.setGlyphs,args:[D.glyphs]}),_e(y.transition,D.transition)||A.push({command:Et.setTransition,args:[D.transition]}),_e(y.light,D.light)||A.push({command:Et.setLight,args:[D.light]}),_e(y.fog,D.fog)||A.push({command:Et.setFog,args:[D.fog]}),_e(y.projection,D.projection)||A.push({command:Et.setProjection,args:[D.projection]});const O={},z=[];!function(oe,de,ge,be){let De;for(De in de=de||{},oe=oe||{})oe.hasOwnProperty(De)&&(de.hasOwnProperty(De)||cr(De,ge,be));for(De in de){if(!de.hasOwnProperty(De))continue;const Oe=de[De];oe.hasOwnProperty(De)?_e(oe[De],Oe)||("geojson"===oe[De].type&&"geojson"===Oe.type&&Rr(oe,de,De)?ge.push({command:Et.setGeoJSONSourceData,args:[De,Oe.data]}):qn(De,de,ge,be)):wn(De,de,ge)}}(y.sources,D.sources,z,O);const G=[];y.layers&&y.layers.forEach(oe=>{oe.source&&O[oe.source]?A.push({command:Et.removeLayer,args:[oe.id]}):G.push(oe)});let W=y.terrain;W&&O[W.source]&&(A.push({command:Et.setTerrain,args:[void 0]}),W=void 0),A=A.concat(z),_e(W,D.terrain)||A.push({command:Et.setTerrain,args:[D.terrain]}),function(oe,de,ge){de=de||[];const be=(oe=oe||[]).map(di),De=de.map(di),Oe=oe.reduce(Ci,{}),ae=de.reduce(Ci,{}),Te=be.slice(),Ge=Object.create(null);let Ve,bt,wt,dt,Lt,Tt,qt;for(Ve=0,bt=0;Ve<be.length;Ve++)wt=be[Ve],ae.hasOwnProperty(wt)?bt++:(ge.push({command:Et.removeLayer,args:[wt]}),Te.splice(Te.indexOf(wt,bt),1));for(Ve=0,bt=0;Ve<De.length;Ve++)wt=De[De.length-1-Ve],Te[Te.length-1-Ve]!==wt&&(Oe.hasOwnProperty(wt)?(ge.push({command:Et.removeLayer,args:[wt]}),Te.splice(Te.lastIndexOf(wt,Te.length-bt),1)):bt++,Tt=Te[Te.length-Ve],ge.push({command:Et.addLayer,args:[ae[wt],Tt]}),Te.splice(Te.length-Ve,0,wt),Ge[wt]=!0);for(Ve=0;Ve<De.length;Ve++)if(wt=De[Ve],dt=Oe[wt],Lt=ae[wt],!Ge[wt]&&!_e(dt,Lt))if(_e(dt.source,Lt.source)&&_e(dt["source-layer"],Lt["source-layer"])&&_e(dt.type,Lt.type)){for(qt in Fr(dt.layout,Lt.layout,ge,wt,null,Et.setLayoutProperty),Fr(dt.paint,Lt.paint,ge,wt,null,Et.setPaintProperty),_e(dt.filter,Lt.filter)||ge.push({command:Et.setFilter,args:[wt,Lt.filter]}),_e(dt.minzoom,Lt.minzoom)&&_e(dt.maxzoom,Lt.maxzoom)||ge.push({command:Et.setLayerZoomRange,args:[wt,Lt.minzoom,Lt.maxzoom]}),dt)dt.hasOwnProperty(qt)&&"layout"!==qt&&"paint"!==qt&&"filter"!==qt&&"metadata"!==qt&&"minzoom"!==qt&&"maxzoom"!==qt&&(0===qt.indexOf("paint.")?Fr(dt[qt],Lt[qt],ge,wt,qt.slice(6),Et.setPaintProperty):_e(dt[qt],Lt[qt])||ge.push({command:Et.setLayerProperty,args:[wt,qt,Lt[qt]]}));for(qt in Lt)Lt.hasOwnProperty(qt)&&!dt.hasOwnProperty(qt)&&"layout"!==qt&&"paint"!==qt&&"filter"!==qt&&"metadata"!==qt&&"minzoom"!==qt&&"maxzoom"!==qt&&(0===qt.indexOf("paint.")?Fr(dt[qt],Lt[qt],ge,wt,qt.slice(6),Et.setPaintProperty):_e(dt[qt],Lt[qt])||ge.push({command:Et.setLayerProperty,args:[wt,qt,Lt[qt]]}))}else ge.push({command:Et.removeLayer,args:[wt]}),Tt=Te[Te.lastIndexOf(wt)+1],ge.push({command:Et.addLayer,args:[Lt,Tt]})}(G,D.layers,A)}catch(O){console.warn("Unable to compute style diff:",O),A=[{command:Et.setStyle,args:[D]}]}return A}(this.serialize(),i).filter(y=>!(y.command in Qi));if(0===c.length)return!1;const p=c.filter(y=>!(y.command in Ms));if(p.length>0)throw new Error(`Unimplemented: ${p.map(y=>y.command).join(", ")}.`);return c.forEach(y=>{"setTransition"!==y.command&&"setProjection"!==y.command&&this[y.command].apply(this,y.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,c){return this.getImage(i)?this.fire(new l.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,c),this._afterImageUpdated(i),this)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new l.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,c,p={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(l.validateSource,`sources.${i}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const y=nt(i,c,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:y.serialize(),sourceId:i}));const D=A=>{const O=(A?"symbol:":"other:")+i,z=this._sourceCaches[O]=new l.SourceCache(O,y,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[i]=z,z.style=this,z.onAdd(this.map)};D(!1),"vector"!==c.type&&"geojson"!==c.type||D(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const c=this.getSource(i);if(!c)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(i);for(const y of p)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getSource(i).setData(c),this._changed=!0}getSource(i){const c=this._getSourceCache(i);return c&&c.getSource()}_getSources(){const i=[];for(const c in this._otherSourceCaches){const p=this._getSourceCache(c);p&&i.push(p.getSource())}return i}addLayer(i,c,p={}){this._checkLoaded();const y=i.id;if(this.getLayer(y))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let D;if("custom"===i.type){if(Si(this,l.validateCustomStyleLayer(i)))return;D=l.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(y,i.source),i=l.clone$1(i),i=l.extend(i,{source:y})),this._validate(l.validateLayer,`layers.${y}`,i,{arrayIndex:-1},p))return;D=l.createStyleLayer(i),this._validateLayer(D),D.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}const A=c?this._order.indexOf(c):this._order.length;if(c&&-1===A)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(A,0,y),this._layerOrderChanged=!0,this._layers[y]=D;const O=this._getLayerSourceCache(D);if(this._removedLayers[y]&&D.source&&O&&"custom"!==D.type){const z=this._removedLayers[y];delete this._removedLayers[y],z.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",O.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;const p=this._order.indexOf(i);this._order.splice(p,1);const y=c?this._order.indexOf(c):this._order.length;c&&-1===y?this.fire(new l.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(y,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const c=this._layers[i];if(!c)return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(i);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,p){this._checkLoaded();const y=this.getLayer(i);y?y.minzoom===c&&y.maxzoom===p||(null!=c&&(y.minzoom=c),null!=p&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,c,p={}){this._checkLoaded();const y=this.getLayer(i);if(y){if(!_e(y.filter,c))return null==c?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.validateFilter,`layers.${y.id}.filter`,c,{layerType:y.type},p)||(y.filter=l.clone$1(c),this._updateLayer(y)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const c=this.getLayer(i);return c&&l.clone$1(c.filter)}setLayoutProperty(i,c,p,y={}){this._checkLoaded();const D=this.getLayer(i);D?_e(D.getLayoutProperty(c),p)||(D.setLayoutProperty(c,p,y),this._updateLayer(D)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,c){const p=this.getLayer(i);if(p)return p.getLayoutProperty(c);this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,c,p,y={}){this._checkLoaded();const D=this.getLayer(i);D?_e(D.getPaintProperty(c),p)||(D.setPaintProperty(c,p,y)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,c){const p=this.getLayer(i);return p&&p.getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();const p=i.source,y=i.sourceLayer,D=this.getSource(p);if(!D)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const A=D.type;if("geojson"===A&&y)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===A&&!y)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(p);for(const z of O)z.setFeatureState(y,i.id,c)}removeFeatureState(i,c){this._checkLoaded();const p=i.source,y=this.getSource(p);if(!y)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const D=y.type,A="vector"===D?i.sourceLayer:void 0;if("vector"===D&&!A)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(p);for(const z of O)z.removeFeatureState(A,i.id,c)}getFeatureState(i){this._checkLoaded();const c=i.source,p=i.sourceLayer,y=this.getSource(c);if(y){if("vector"!==y.type||p)return void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,i.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();i[p.id]||(i[p.id]=p.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(i){this._updatedLayers[i.id]=!0;const c=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[i.source]="reload",c.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=A=>"fill-extrusion"===this._layers[A].type,p={},y=[];for(let A=this._order.length-1;A>=0;A--){const O=this._order[A];if(c(O)){p[O]=A;for(const z of i){const G=z[O];if(G)for(const W of G)y.push(W)}}}y.sort((A,O)=>O.intersectionZ-A.intersectionZ);const D=[];for(let A=this._order.length-1;A>=0;A--){const O=this._order[A];if(c(O))for(let z=y.length-1;z>=0;z--){const G=y[z].feature;if(p[G.layer.id]<A)break;D.push(G),y.pop()}else for(const z of i){const G=z[O];if(G)for(const W of G)D.push(W.feature)}}return D}queryRenderedFeatures(i,c,p){c&&c.filter&&this._validate(l.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const y={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of c.layers){const G=this._layers[z];if(!G)return this.fire(new l.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];y[G.source]=!0}}const D=[];c.availableImages=this._availableImages;const A=c&&c.layers?c.layers.some(z=>{const G=this.getLayer(z);return G&&G.is3D()}):this.has3DLayers(),O=zt.createFromScreenPoints(i,p);for(const z in this._sourceCaches){const G=this._sourceCaches[z].getSource().id;c.layers&&!y[G]||D.push(mn(this._sourceCaches[z],this._layers,this._serializedLayers,O,c,p,A,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(z,G,W,oe,de,ge,be){const De={},Oe=ge.queryRenderedSymbols(oe),ae=[];for(const Te of Object.keys(Oe).map(Number))ae.push(be[Te]);ae.sort(Gn);for(const Te of ae){const Ge=Te.featureIndex.lookupSymbolFeatures(Oe[Te.bucketInstanceId],G,Te.bucketIndex,Te.sourceLayerIndex,de.filter,de.layers,de.availableImages,z);for(const Ve in Ge){const bt=De[Ve]=De[Ve]||[],wt=Ge[Ve];wt.sort((dt,Lt)=>{const Tt=Te.featureSortOrder;if(Tt){const qt=Tt.indexOf(dt.featureIndex);return Tt.indexOf(Lt.featureIndex)-qt}return Lt.featureIndex-dt.featureIndex});for(const dt of wt)bt.push(dt)}}for(const Te in De)De[Te].forEach(Ge=>{const Ve=Ge.feature,bt=W(z[Te]);if(!bt)return;const wt=bt.getFeatureState(Ve.layer["source-layer"],Ve.id);Ve.source=Ve.layer.source,Ve.layer["source-layer"]&&(Ve.sourceLayer=Ve.layer["source-layer"]),Ve.state=wt});return De}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(i,c){c&&c.filter&&this._validate(l.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(i);let y=[];for(const D of p)y=y.concat(Zn(D,c));return y}addSourceType(i,c,p){return Mr.getSourceType(i)?p(new Error(`A source type called "${i}" already exists.`)):(Mr.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const A in i)if(!_e(i[A],p[A])){y=!0;break}if(!y)return;const D=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(i,c),this.light.updateTransitions(D)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,c=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let p=i;if(1===c){if("object"==typeof p.source){const y="terrain-dem-src";this.addSource(y,p.source),p=l.clone$1(p),p=l.extend(p,{source:y})}if(this._validate(l.validateTerrain,"terrain",p))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,c)}else{const y=this.terrain,D=y.get();for(const A of Object.keys(l.spec.terrain))!p.hasOwnProperty(A)&&l.spec.terrain[A].default&&(p[A]=l.spec.terrain[A].default);for(const A in p)if(!_e(p[A],D[A])){y.set(p),this.stylesheet.terrain=p;const O=this._setTransitionParameters({duration:0});y.updateTransitions(O);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new Jn(i,this.map.transform);this.stylesheet.fog=i;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();0===Object.keys(i).length&&c.set(i);for(const y in i)if(!_e(i[y],p[y])){c.set(i),this.stylesheet.fog=i;const D=this._setTransitionParameters({duration:0});c.updateTransitions(D);break}}else this._createFog(i);this._markersNeedUpdate=!0}_setTransitionParameters(i){return{now:l.exported.now(),transition:l.extend(i,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const p=this.terrain=new Nt(i,c);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});p.updateTransitions(y)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"symbol"===c.type&&this._updateLayer(c)}}_validate(i,c,p,y,D={}){return(!D||!1!==D.validate)&&Si(this,i.call(l.validateStyle,l.extend({key:c,style:this.serialize(),value:p,styleSpec:l.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const c=this._getSourceCaches(i);for(const p of c)p.clearTiles()}_reloadSource(i){const c=this._getSourceCaches(i);for(const p of c)p.resume(),p.reload()}_reloadSources(){for(const i of this._getSources())i.reload&&i.reload()}_updateSources(i){for(const c in this._sourceCaches)this._sourceCaches[c].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,p,y,D=!1){let A=!1,O=!1;const z={};for(const G of this._order){const W=this._layers[G];if("symbol"!==W.type)continue;if(!z[W.source]){const de=this._getLayerSourceCache(W);if(!de)continue;z[W.source]=de.getRenderableIds(!0).map(ge=>de.getTileByID(ge)).sort((ge,be)=>be.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(be.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(W,z[W.source],i.center.lng,i.projection);A=A||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),D=D||this._layerOrderChanged||0===p,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),i.zoom))&&(this.pauseablePlacement=new Ri(i,this._order,D,c,p,y,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),O=!0),A&&this.pauseablePlacement.placement.setStale()),O||A)for(const G of this._order){const W=this._layers[G];"symbol"===W.type&&this.placement.updateLayerOpacities(W,z[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const y=D=>{D&&D.setDependencies(c.tileID.key,c.type,c.icons)};y(this._otherSourceCaches[c.source]),y(this._symbolSourceCaches[c.source])}getGlyphs(i,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(i,c,p){return l.makeRequest(c,p)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}_isSourceCacheLoaded(i){const c=this._getSourceCaches(i);return 0===c.length?(this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):c.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Mr.getSourceType=function(h){return fe[h]},Mr.setSourceType=function(h,i){fe[h]=i},Mr.registerForPluginStateChange=l.registerForPluginStateChange;var ks="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",ls="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",go="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",$i="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",es="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ro={},Uo={};const jo=[];ns(ks,jo),ns(go,jo),ns($i,jo),ns(es,jo),Ro=Qn("",go),Uo=Qn(es,$i);const oa=Qn("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ms=ks,cs="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var ts={background:Qn("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Qn("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Qn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Qn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Qn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Qn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Qn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Qn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Qn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Qn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Qn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Qn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Qn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Qn("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Qn("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Qn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Qn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Qn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Qn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Qn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Qn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Qn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Qn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Qn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Qn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ls),skyboxGradient:Qn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ls),skyboxCapture:Qn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Qn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Qn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ns(h,i){const c=h.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let p of c)if(p=p.trim(),"#"===p[0]&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=p.split(" ");for(const D of y)i.includes(D)||i.push(D)}}function Qn(h,i){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},D=[...jo];return ns(h,D),ns(i,D),{fragmentSource:h=h.replace(c,(A,O,z,G,W)=>(y[W]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${W}\nvarying ${z} ${G} ${W};\n#else\nuniform ${z} ${G} u_${W};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${W}\n    ${z} ${G} ${W} = u_${W};\n#endif\n`)),vertexSource:i=i.replace(c,(A,O,z,G,W)=>{const oe="float"===G?"vec2":"vec4",de=W.match(/color/)?"color":oe;return y[W]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${z} ${oe} a_${W};\nvarying ${z} ${G} ${W};\n#else\nuniform ${z} ${G} u_${W};\n#endif\n`:"vec4"===de?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = a_${W};\n#else\n    ${z} ${G} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = unpack_mix_${de}(a_${W}, u_${W}_t);\n#else\n    ${z} ${G} ${W} = u_${W};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${z} ${oe} a_${W};\n#else\nuniform ${z} ${G} u_${W};\n#endif\n`:"vec4"===de?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${z} ${G} ${W} = a_${W};\n#else\n    ${z} ${G} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${z} ${G} ${W} = unpack_mix_${de}(a_${W}, u_${W}_t);\n#else\n    ${z} ${G} ${W} = u_${W};\n#endif\n`}),staticAttributes:p,usedDefines:D}}class ka{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,c,p,y,D,A,O){this.context=i;let z=this.boundPaintVertexBuffers.length!==y.length;for(let W=0;!z&&W<y.length;W++)this.boundPaintVertexBuffers[W]!==y[W]&&(z=!0);let G=this.boundDynamicVertexBuffers.length!==O.length;for(let W=0;!G&&W<O.length;W++)this.boundDynamicVertexBuffers[W]!==O[W]&&(G=!0);if(!i.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||z||G||this.boundIndexBuffer!==D||this.boundVertexOffset!==A)this.freshBind(c,p,y,D,A,O);else{i.bindVertexArrayOES.set(this.vao);for(const W of O)W&&W.bind();D&&D.dynamicDraw&&D.bind()}}freshBind(i,c,p,y,D,A){let O;const z=i.numAttributes,G=this.context,W=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=D,this.boundDynamicVertexBuffers=A;else{O=G.currentNumAttributes||0;for(let oe=z;oe<O;oe++)W.disableVertexAttribArray(oe)}c.enableAttributes(W,i),c.bind(),c.setVertexAttribPointers(W,i,D);for(const oe of p)oe.enableAttributes(W,i),oe.bind(),oe.setVertexAttribPointers(W,i,D);for(const oe of A)oe&&(oe.enableAttributes(W,i),oe.bind(),oe.setVertexAttribPointers(W,i,D));y&&y.bind(),G.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function As(h,i){const c=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new l.MercatorCoordinate(0,p/c).toLngLat().lat,new l.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function va(h,i,c,p,y,D,A){const O=h.context,z=O.gl,G=c.fbo;if(!G)return;h.prepareDrawTile();const W=h.useProgram("hillshade");O.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,G.colorAttachment.get());const oe=((De,Oe,ae,Te)=>{const Ge=ae.paint.get("hillshade-shadow-color"),Ve=ae.paint.get("hillshade-highlight-color"),bt=ae.paint.get("hillshade-accent-color");let wt=ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ae.paint.get("hillshade-illumination-anchor")&&(wt-=De.transform.angle);const dt=!De.options.moving;return{u_matrix:Te||De.transform.calculateProjMatrix(Oe.tileID.toUnwrapped(),dt),u_image:0,u_latrange:As(0,Oe.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),wt],u_shadow:Ge,u_highlight:Ve,u_accent:bt}})(h,c,p,h.terrain?i.projMatrix:null);h.prepareDrawProgram(O,W,i.toUnwrapped());const{tileBoundsBuffer:de,tileBoundsIndexBuffer:ge,tileBoundsSegments:be}=h.getTileBoundsBuffers(c);W.draw(O,z.TRIANGLES,y,D,A,l.CullFaceMode.disabled,oe,p.id,de,ge,be)}function Ho(h,i,c){if(!i.needsDEMTextureUpload)return;const p=h.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||h.getTileTexture(c.stride);const D=c.getPixels();i.demTexture?i.demTexture.update(D,{premultiply:!1}):i.demTexture=new l.Texture(p,D,y.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function js(h,i,c,p,y,D){const A=h.context,O=A.gl;if(!i.dem)return;const z=i.dem;if(A.activeTexture.set(O.TEXTURE1),Ho(h,i,z),!i.demTexture)return;i.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const G=z.dim;A.activeTexture.set(O.TEXTURE0);let W=i.fbo;if(!W){const be=new l.Texture(A,{width:G,height:G,data:null},O.RGBA);be.bind(O.LINEAR,O.CLAMP_TO_EDGE),W=i.fbo=A.createFramebuffer(G,G,!0),W.colorAttachment.set(be.texture)}A.bindFramebuffer.set(W.framebuffer),A.viewport.set([0,0,G,G]);const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:de,tileBoundsSegments:ge}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(A,O.TRIANGLES,p,y,D,l.CullFaceMode.disabled,((be,De)=>{const Oe=De.stride,ae=l.create();return l.ortho(ae,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(ae,ae,[0,-l.EXTENT,0]),{u_matrix:ae,u_image:1,u_dimension:[Oe,Oe],u_zoom:be.overscaledZ,u_unpack:De.unpackVector}})(i.tileID,z),c.id,oe,de,ge),i.needsHillshadePrepare=!1}const co=h=>({u_matrix:new l.UniformMatrix4f(h),u_image0:new l.Uniform1i(h),u_skirt_height:new l.Uniform1f(h)}),Mo=(h,i)=>({u_matrix:h,u_image0:0,u_skirt_height:i}),oo=(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:y,u_merc_center:D,u_image0:0,u_frustum_tl:A,u_frustum_tr:O,u_frustum_br:z,u_frustum_bl:G,u_globe_pos:W,u_globe_radius:oe,u_viewport:de,u_grid_matrix:be?Float32Array.from(be):new Float32Array(9),u_skirt_height:ge});function xa(h,i){return null!=h&&null!=i&&!(!h.hasData()||!i.hasData())&&null!=h.demTexture&&null!=i.demTexture&&h.tileID.key!==i.tileID.key}const Fi=new class{constructor(){this.operations={}}newMorphing(h,i,c,p,y){if(h in this.operations){const D=this.operations[h];D.to.tileID.key!==c.tileID.key&&(D.queued=c)}else this.operations[h]={startTime:p,phase:0,duration:y,from:i,to:c,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const i=this.operations[h];return{from:i.from,to:i.to,phase:i.phase}}update(h){for(const i in this.operations){const c=this.operations[i];for(c.phase=(h-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,h)){delete this.operations[i];break}}}_nextOp(h,i){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=i,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Wi={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Hs(h){return 6*Math.pow(1.5,22-h)}function gs(h,i){const c=1<<h.z;return!i&&(0===h.x||h.x===c-1)||0===h.y||h.y===c-1}const us=h=>({u_matrix:h});function Xo(h,i,c,p,y){if(y>0){const D=l.exported.now(),A=(D-h.timeAdded)/y,O=i?(D-i.timeAdded)/y:-1,z=c.getSource(),G=p.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),W=!i||Math.abs(i.tileID.overscaledZ-G)>Math.abs(h.tileID.overscaledZ-G),oe=W&&h.refreshedUponExpiration?1:l.clamp(W?A:1-O,0,1);return h.refreshedUponExpiration&&A>=1&&(h.refreshedUponExpiration=!1),i?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}class sa extends l.SourceCache{constructor(i){const c={type:"raster-dem",maxzoom:i.transform.maxZoom},p=new Zt(no(),null),y=nt("mock-dem",c,p,i.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class ba extends l.SourceCache{constructor(i){const c=nt("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new Zt(no(),null),i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,p){if(i.freezeTileCoverage)return;this.transform=i;const y=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,A)=>{if(D[A.key]="",!this._tiles[A.key]){const O=new l.Tile(A,this._source.tileSize*A.overscaleFactor(),i.tileZoom);O.state="loaded",this._tiles[A.key]=O}return D},{});for(const D in this._tiles)D in y||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(i){const c=this.proxyCachedFBO[i];if(void 0!==c){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Js extends l.OverscaledTileID{constructor(i,c,p){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class P extends l.Elevation{constructor(i,c){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,D]=function(z){const G=new l.StructArrayLayout2i4,W=new l.StructArrayLayout3ui6;G.reserve(17161),W.reserve(33800);const de=l.EXTENT/128,ge=l.EXTENT+de/2,be=ge+de;for(let Oe=-de;Oe<be;Oe+=de)for(let ae=-de;ae<be;ae+=de){const Te=ae<0||ae>ge||Oe<0||Oe>ge?24575:0,Ge=l.clamp(Math.round(ae),0,l.EXTENT),Ve=l.clamp(Math.round(Oe),0,l.EXTENT);G.emplaceBack(Ge+Te,Ve)}const De=(Oe,ae)=>{const Te=131*ae+Oe;W.emplaceBack(Te+1,Te,Te+131),W.emplaceBack(Te+131,Te+131+1,Te+1)};for(let Oe=1;Oe<129;Oe++)for(let ae=1;ae<129;ae++)De(ae,Oe);return[0,129].forEach(Oe=>{for(let ae=0;ae<130;ae++)De(ae,Oe),De(Oe,ae)}),[G,W,32768]}(),A=i.context;this.gridBuffer=A.createVertexBuffer(p,l.posAttributes.members),this.gridIndexBuffer=A.createIndexBuffer(y),this.gridSegments=l.SegmentVector.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,p.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ba(c.map),this.orthoMatrix=l.create(),l.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,l.EXTENT,0,l.EXTENT,0,1);const O=A.gl;this._overlapStencilMode=new l.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new sa(c.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(i,c,p){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const y=i.terrain.properties;this.sourceCache=0===i.terrain.drapeRenderMode?this._mockSourceCache:i._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const D=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const A=this.getScaledDemTileSize();this.sourceCache.update(c,A,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),c.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&l.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=0===p._centerAltitude&&-1===this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(p.center),-1),this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=c.getIds().map(z=>{const G=c.getTileByID(z).tileID;return G.projMatrix=p.calculateProjMatrix(G.toUnwrapped()),G});(function(z,G){const W=G.transform.pointCoordinate(G.transform.getCameraPoint()),oe=new l.Point(W.x,W.y);z.sort((de,ge)=>{if(ge.overscaledZ-de.overscaledZ)return ge.overscaledZ-de.overscaledZ;const be=new l.Point(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),De=new l.Point(ge.canonical.x+(1<<ge.canonical.z)*ge.wrap,ge.canonical.y),Oe=oe.mult(1<<de.canonical.z);return Oe.x-=.5,Oe.y-=.5,Oe.distSqr(be)-Oe.distSqr(De)})})(y,this.painter),this._previousZoom=p.zoom;const D=this.proxyToSource||{};this.proxyToSource={},y.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const A=this._style._sourceCaches;for(const z in A){const G=A[z];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,i[z],D),G.usedForTerrain))continue;const W=i[z];G.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[c.id]=y.map(z=>new Js(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const O={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const G=this.terrainTileForTile[z.key];if(!G)continue;const W=G.tileID.key;W in O||(this._visibleDemTiles.push(G),O[W]=W)}}_assignTerrainTiles(i){this._initializing||i.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],D=y.dem;!D||y.demTexture&&!y.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),Ho(this.painter,y,D))}}_prepareDemTileUniforms(i,c,p,y){if(!c||null==c.demTexture)return!1;const D=i.tileID.canonical,A=Math.pow(2,c.tileID.canonical.z-D.z),O=y||"";return p[`u_dem_tl${O}`]=[D.x*A%1,D.y*A%1],p[`u_dem_scale${O}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,c=i.gl;if(!this._emptyDepthBufferTexture){const p=new l.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new l.Texture(i,p,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const c=this._visibleDemTiles.reduce((p,y)=>{if(!y.dem)return p;const D=y.dem.tree.minimums[0];return D>0&&i++,p+D},0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),y=new l.RGBAImage({width:1,height:1},new Uint8Array(l.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(y,{premultiply:!1}):D=this._emptyDEMTexture=new l.Texture(i,y,c.RGBA,{premultiply:!1}),D}setupElevationDraw(i,c,p){const y=this.painter.context,D=y.gl,A=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;A.u_dem_size=this.sourceCache.getSource().tileSize,A.u_exaggeration=this.exaggeration();let z=null,G=null,W=1;if(p&&p.morphing&&this._useVertexMorphing){const oe=p.morphing.srcDemTile,de=p.morphing.dstDemTile;W=p.morphing.phase,oe&&de&&(this._prepareDemTileUniforms(i,oe,A,"_prev")&&(G=oe),this._prepareDemTileUniforms(i,de,A)&&(z=de))}if(G&&z?(y.activeTexture.set(D.TEXTURE2),z.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),y.activeTexture.set(D.TEXTURE4),G.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),A.u_dem_lerp=W):(z=this.terrainTileForTile[i.tileID.key],y.activeTexture.set(D.TEXTURE2),(this._prepareDemTileUniforms(i,z,A)?z.demTexture:this.emptyDEMTexture).bind(D.NEAREST,D.CLAMP_TO_EDGE)),y.activeTexture.set(D.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),this._depthFBO&&(A.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),A.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&z){const oe=(1<<z.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=oe}if(p&&p.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(y,A),"globe"===this.painter.transform.projection.name){const oe=this.globeUniformValues(this.painter.transform,i.tileID.canonical,p&&p.useDenormalizedUpVectorScale);c.setGlobeUniformValues(y,oe)}}globeUniformValues(i,c,p){const y=i.projection;return{u_tile_tl_up:y.upVector(c,0,0),u_tile_tr_up:y.upVector(c,l.EXTENT,0),u_tile_br_up:y.upVector(c,l.EXTENT,l.EXTENT),u_tile_bl_up:y.upVector(c,0,l.EXTENT),u_tile_up_scale:p?l.globeMetersToEcef(1):y.upVectorScale(c,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const c=this.painter,p=this.painter.context;0!==i.length&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,D,A,O,z){if("globe"===y.transform.projection.name)!function(G,W,oe,de,ge){const be=G.context,De=be.gl;let Oe,ae;const Te=G.options.showTerrainWireframe?2:0,Ge=G.transform,Ve=l.globeUseCustomAntiAliasing(G,be,Ge),bt=(Ln,Xt)=>{if(ae===Ln)return;const xn=[Wi[Ln],"PROJECTION_GLOBE_VIEW"];Ve&&xn.push("CUSTOM_ANTIALIASING"),Xt&&xn.push(Wi[Te]),Oe=G.useProgram("globeRaster",null,xn),ae=Ln},wt=G.colorModeForRenderPass(),dt=new l.DepthMode(De.LEQUAL,l.DepthMode.ReadWrite,G.depthRangeFor3D);Fi.update(ge);const Lt=l.calculateGlobeMercatorMatrix(Ge),Tt=[l.mercatorXfromLng(Ge.center.lng),l.mercatorYfromLat(Ge.center.lat)],qt=Te?[!1,!0]:[!1],Rn=G.globeSharedBuffers,Ht=[Ge.width*l.exported.devicePixelRatio,Ge.height*l.exported.devicePixelRatio],Dn=Float32Array.from(Ge.globeMatrix),sn={useDenormalizedUpVectorScale:!0};if(qt.forEach(Ln=>{const Xt=G.transform,xn=Hs(Xt.zoom)*W.exaggeration();ae=-1;const Nn=Ln?De.LINES:De.TRIANGLES;for(const An of de){const $n=oe.getTile(An),Ar=l.StencilMode.disabled,Xr=W.prevTerrainTileForTile[An.key],ur=W.terrainTileForTile[An.key];xa(Xr,ur)&&Fi.newMorphing(An.key,Xr,ur,ge,250),be.activeTexture.set(De.TEXTURE0),$n.texture.bind(De.LINEAR,De.CLAMP_TO_EDGE);const $r=Fi.getMorphValuesForProxy(An.key),mi=$r?1:0;$r&&l.extend$1(sn,{morphing:{srcDemTile:$r.from,dstDemTile:$r.to,phase:l.easeCubicInOut($r.phase)}});const fi=l.tileCornersToBounds(An.canonical),xr=l.getLatitudinalLod(fi.getCenter().lat),Yi=l.getGridMatrix(An.canonical,fi,xr,Xt.worldSize/Xt._pixelsPerMercatorPixel),gi=l.globeNormalizeECEF(l.globeTileBounds(An.canonical)),ho=oo(Xt.projMatrix,Dn,Lt,gi,l.globeToMercatorTransition(Xt.zoom),Tt,Xt.frustumCorners.TL,Xt.frustumCorners.TR,Xt.frustumCorners.BR,Xt.frustumCorners.BL,Xt.globeCenterInViewSpace,Xt.globeRadius,Ht,xn,Yi);if(bt(mi,Ln),W.setupElevationDraw($n,Oe,sn),G.prepareDrawProgram(be,Oe,An.toUnwrapped()),Rn){const[ao,Ns,zs]=Ln?Rn.getWirefameBuffers(G.context,xr):Rn.getGridBuffers(xr,0!==xn);Oe.draw(be,Nn,dt,Ar,wt,l.CullFaceMode.backCCW,ho,"globe_raster",ao,Ns,zs)}}}),Rn){const Ln=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ve&&Ln.push("CUSTOM_ANTIALIASING"),Oe=G.useProgram("globeRaster",null,Ln);for(const Xt of de){const{x:xn,y:Nn,z:An}=Xt.canonical,$n=0===Nn,Ar=Nn===(1<<An)-1,[Xr,ur,$r,mi]=Rn.getPoleBuffers(An);if(mi&&($n||Ar)){const fi=oe.getTile(Xt);be.activeTexture.set(De.TEXTURE0),fi.texture.bind(De.LINEAR,De.CLAMP_TO_EDGE);let xr=l.globePoleMatrixForTile(An,xn,Ge);const Yi=l.globeNormalizeECEF(l.globeTileBounds(Xt.canonical)),gi=(ho,ao)=>ho.draw(be,De.TRIANGLES,dt,l.StencilMode.disabled,wt,l.CullFaceMode.disabled,oo(Ge.projMatrix,xr,xr,Yi,0,Tt,Ge.frustumCorners.TL,Ge.frustumCorners.TR,Ge.frustumCorners.BR,Ge.frustumCorners.BL,Ge.globeCenterInViewSpace,Ge.globeRadius,Ht,0),"globe_pole_raster",ao,$r,mi);W.setupElevationDraw(fi,Oe,sn),G.prepareDrawProgram(be,Oe,Xt.toUnwrapped()),$n&&gi(Oe,Xr),Ar&&(xr=l.scale(l.create(),xr,[1,-1,1]),gi(Oe,ur))}}}}(y,D,A,O,z);else{const G=y.context,W=G.gl;let oe,de;const ge=y.options.showTerrainWireframe?2:0,be=(Ge,Ve)=>{if(de===Ge)return;const bt=[Wi[Ge]];Ve&&bt.push(Wi[ge]),oe=y.useProgram("terrainRaster",null,bt),de=Ge},De=y.colorModeForRenderPass(),Oe=new l.DepthMode(W.LEQUAL,l.DepthMode.ReadWrite,y.depthRangeFor3D);Fi.update(z);const ae=y.transform,Te=Hs(ae.zoom)*D.exaggeration();(ge?[!1,!0]:[!1]).forEach(Ge=>{de=-1;const Ve=Ge?W.LINES:W.TRIANGLES,[bt,wt]=Ge?D.getWirefameBuffer():[D.gridIndexBuffer,D.gridSegments];for(const dt of O){const Lt=A.getTile(dt),Tt=l.StencilMode.disabled,qt=D.prevTerrainTileForTile[dt.key],Rn=D.terrainTileForTile[dt.key];xa(qt,Rn)&&Fi.newMorphing(dt.key,qt,Rn,z,250),G.activeTexture.set(W.TEXTURE0),Lt.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST);const Ht=Fi.getMorphValuesForProxy(dt.key),Dn=Ht?1:0;let sn;Ht&&(sn={morphing:{srcDemTile:Ht.from,dstDemTile:Ht.to,phase:l.easeCubicInOut(Ht.phase)}});const Ln=Mo(dt.projMatrix,gs(dt.canonical,ae.renderWorldCopies)?Te/10:Te);be(Dn,Ge),D.setupElevationDraw(Lt,oe,sn),y.prepareDrawProgram(G,oe,dt.toUnwrapped()),oe.draw(G,Ve,Oe,Tt,De,l.CullFaceMode.backCCW,Ln,"terrain_raster",D.gridBuffer,bt,wt)}})}}(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,y=this.proxySourceCache,D=this.proxiedCoords[y.id],A=this._drapedRenderBatches.shift(),O=[],z=c.style.order;let G=0;for(const W of D){const oe=y.getTileByID(W.proxyTileKey),de=y.proxyCachedFBO[W.key]?y.proxyCachedFBO[W.key][i]:void 0,ge=void 0!==de?y.renderCache[de]:this.pool[G++],be=void 0!==de;if(oe.texture=ge.tex,be&&!ge.dirty){O.push(oe.tileID);continue}let De;p.bindFramebuffer.set(ge.fb.framebuffer),this.renderedToTile=!1,ge.dirty&&(p.clear({color:l.Color.transparent,stencil:0}),ge.dirty=!1);for(let Oe=A.start;Oe<=A.end;++Oe){const ae=c.style._layers[z[Oe]];if(ae.isHidden(c.transform.zoom))continue;const Te=c.style._getLayerSourceCache(ae),Ge=Te?this.proxyToSource[W.key][Te.id]:[W];if(!Ge)continue;const Ve=Ge;p.viewport.set([0,0,ge.fb.width,ge.fb.height]),De!==(Te?Te.id:null)&&(this._setupStencil(ge,Ge,ae,Te),De=Te?Te.id:null),c.renderLayer(c,Te,ae,Ve)}this.renderedToTile?(ge.dirty=!0,O.push(oe.tileID)):be||--G,5===G&&(G=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),A.end+1}postRender(){}renderCacheEfficiency(i){const c=i.order.length;if(0===c)return{efficiency:100};let p,y=0,D=0,A=!1;for(let O=0;O<c;++O){const z=i._layers[i.order[O]];this._style.isLayerDraped(z)?(A&&++y,++D):A||(A=!0,p=z.id)}return 0===D?{efficiency:100}:{efficiency:100*(1-y/D),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{i=Math.min(i,c.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,c,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(D=>D.dem).map(D=>{const A=D.tileID,O=1<<A.overscaledZ,{x:z,y:G}=A.canonical,W=z/O,oe=(z+1)/O,de=G/O,ge=(G+1)/O;return{minx:W,miny:de,maxx:oe,maxy:ge,t:D.dem.tree.raycastRoot(W,de,oe,ge,i,c,p),tile:D}});y.sort((D,A)=>(null!==D.t?D.t:Number.MAX_VALUE)-(null!==A.t?A.t:Number.MAX_VALUE));for(const D of y){if(null==D.t)return null;const A=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,i,c,p);if(null!=A)return A}return null}_createFBO(){const i=this.painter.context,c=i.gl,p=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const y=new l.Texture(i,{width:p[0],height:p[1],data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);const D=i.createFramebuffer(p[0],p[1],!1);return D.colorAttachment.set(y.texture),D.depthAttachment=new _t(i,D.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:D,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const c=this._style._layers[i],p=c.isHidden(this.painter.transform.zoom);return"custom"===c.type?!p&&c.shouldRedrape():!p&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let i=!1;for(const p of this._style._getSources())if(p instanceof ke){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const y=this._style._layers[this._style.order[p]],D=this._style._getLayerSourceCache(y);if(D&&!c[D.id]&&!y.isHidden(this.painter.transform.zoom)&&"line"===y.type&&y.widthExpression()instanceof l.ZoomDependentExpression){c[D.id]=!0;for(const A of this.proxyCoords){const O=this.proxyToSource[A.key][D.id];if(O)for(const z of O)this._clearRenderCacheForTile(D.id,z)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const p in this._style._sourceCaches)if(this._style._sourceCaches[p]._source instanceof se){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const y=this._style._layers[this._style.order[p]],D=this._style._getLayerSourceCache(y);if(!D||c[D.id]||y.isHidden(this.painter.transform.zoom)||"raster"!==y.type)continue;const A=y.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const z=this.proxyToSource[O.key][D.id];if(z)for(const G of z){const W=Xo(D.getTile(G),D.findLoadedParent(G,0),D,this.painter.transform,A);(1!==W.opacity||0!==W.mix)&&this._clearRenderCacheForTile(D.id,G)}}}}_setupDrapedRenderBatches(){const i=this._style.order,c=i.length;if(0===c)return;const p=[];let y,D=0,A=this._style._layers[i[D]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++D<c;)A=this._style._layers[i[D]];for(;D<c;++D){const O=this._style._layers[i[D]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===y&&(y=D):void 0!==y&&(p.push({start:y,end:D-1}),y=void 0))}void 0!==y&&p.push({start:y,end:D-1}),this._drapedRenderBatches=p}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const A=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let O=0;O<A.length;++O){const z=Object.values(A[O]);c.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let A=p.length-1;A>=0;A--){const O=p[A];if(c.getTileByID(O.key),void 0!==c.proxyCachedFBO[O.key]){const z=i[O.key],G=this.proxyToSource[O.key];let W=0;for(const oe in G){const de=G[oe],ge=z[oe];if(!ge||ge.length!==de.length||de.some((be,De)=>be!==ge[De]||y[oe]&&y[oe].hasOwnProperty(be.key))){W=-1;break}++W}for(const oe in c.proxyCachedFBO[O.key])c.renderCache[c.proxyCachedFBO[O.key][oe]].dirty=W<0||W!==Object.values(z).length}}const D=[...this._drapedRenderBatches];D.sort((A,O)=>O.end-O.start-(A.end-A.start));for(const A of D)for(const O of p){if(c.proxyCachedFBO[O.key])continue;let z=c.renderCachePool.pop();void 0===z&&c.renderCache.length<50&&(z=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==z&&(c.proxyCachedFBO[O.key]={},c.proxyCachedFBO[O.key][A.start]=z,c.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const D=this.painter.context,A=D.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let O;if(p.isTileClipped())O=c.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(i,c){const p=this.painter,y=this.painter.context,D=y.gl;p._tileClippingMaskIDs={},y.setColorMode(l.ColorMode.disabled),y.setDepthMode(l.DepthMode.disabled);const A=p.useProgram("clippingMask");for(const O of i){const z=p._tileClippingMaskIDs[O.key]=--c;A.draw(y,D.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:D.ALWAYS,mask:0},z,255,D.KEEP,D.KEEP,D.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,us(O.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const p=[i.x,i.y,1,1];l.transformMat4$1(p,p,c.pixelMatrixInverse),l.scale$1(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const y=c._camera.position,D=l.mercatorZfromAltitude(1,c.center.lat),A=[y[0],y[1],y[2]/D,0],O=l.subtract([],p.slice(0,3),A);l.normalize(O,O);const z=this.raycast(A,O,this._exaggeration);return null!==z&&z?(l.scaleAndAdd(A,A,O,z),A[3]=A[2],A[2]*=D,A):null}drawDepth(){const i=this.painter,c=i.context,p=this.proxySourceCache,y=Math.ceil(i.width),D=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===D||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const A=c.gl,O=c.createFramebuffer(y,D,!0);c.activeTexture.set(A.TEXTURE0);const z=new l.Texture(c,{width:y,height:D,data:null},A.RGBA);z.bind(A.NEAREST,A.CLAMP_TO_EDGE),O.colorAttachment.set(z.texture);const G=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,y,D);O.depthAttachment.set(G),this._depthFBO=O,this._depthTexture=z}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,y,D]),function(A,O,z,G){if("globe"===A.transform.projection.name)return;const W=A.context,oe=W.gl;W.clear({depth:1});const de=A.useProgram("terrainDepth"),ge=new l.DepthMode(oe.LESS,l.DepthMode.ReadWrite,A.depthRangeFor3D);for(const be of G){const De=z.getTile(be),Oe=Mo(be.projMatrix,0);O.setupElevationDraw(De,de),de.draw(W,oe.TRIANGLES,ge,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,Oe,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(i,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,c,p){if(i.getSource()instanceof Fe)return this._setupProxiedCoordsForImageSource(i,c,p);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const y=this.proxiedCoords[i.id]=[],D=this.proxyCoords;for(let O=0;O<D.length;O++){const z=D[O],G=this._findTileCoveringTileID(z,i);if(G){const W=this._createProxiedId(z,G,p[z.key]&&p[z.key][i.id]);y.push(W),this.proxyToSource[z.key][i.id]=[W]}}let A=!1;for(let O=0;O<c.length;O++){const z=i.getTile(c[O]);if(!z||!z.hasData())continue;const G=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==z.tileID.canonical.z){const W=this.proxyToSource[G.tileID.key][i.id],oe=this._createProxiedId(G.tileID,z,p[G.tileID.key]&&p[G.tileID.key][i.id]);W?W.splice(W.length-1,0,oe):this.proxyToSource[G.tileID.key][i.id]=[oe],y.push(oe),A=!0}}this._sourceTilesOverlap[i.id]=A}_setupProxiedCoordsForImageSource(i,c,p){if(!i.getSource().loaded())return;const y=this.proxiedCoords[i.id]=[],D=this.proxyCoords,A=i.getSource(),O=new l.Point(A.tileID.x,A.tileID.y)._div(1<<A.tileID.z),z=A.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((W,oe)=>(W.min.x=Math.min(W.min.x,oe.x-O.x),W.min.y=Math.min(W.min.y,oe.y-O.y),W.max.x=Math.max(W.max.x,oe.x-O.x),W.max.y=Math.max(W.max.y,oe.y-O.y),W),{min:new l.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(W,oe)=>{const de=W.wrap+W.canonical.x/(1<<W.canonical.z),ge=W.canonical.y/(1<<W.canonical.z),be=l.EXTENT/(1<<W.canonical.z),De=oe.wrap+oe.canonical.x/(1<<oe.canonical.z),Oe=oe.canonical.y/(1<<oe.canonical.z);return de+be<De+z.min.x||de>De+z.max.x||ge+be<Oe+z.min.y||ge>Oe+z.max.y};for(let W=0;W<D.length;W++){const oe=D[W];for(let de=0;de<c.length;de++){const ge=i.getTile(c[de]);if(!ge||!ge.hasData()||G(oe,ge.tileID))continue;const be=this._createProxiedId(oe,ge,p[oe.key]&&p[oe.key][i.id]),De=this.proxyToSource[oe.key][i.id];De?De.push(be):this.proxyToSource[oe.key][i.id]=[be],y.push(be)}}}_createProxiedId(i,c,p){let y=this.orthoMatrix;if(p){const D=p.find(A=>A.key===c.tileID.key);if(D)return D}if(c.tileID.key!==i.key){const D=i.canonical.z-c.tileID.canonical.z;let A,O,z;y=l.create();const G=c.tileID.wrap-i.wrap<<i.overscaledZ;D>0?(A=l.EXTENT>>D,O=A*((c.tileID.canonical.x<<D)-i.canonical.x+G),z=A*((c.tileID.canonical.y<<D)-i.canonical.y)):(A=l.EXTENT<<-D,O=l.EXTENT*(c.tileID.canonical.x-(i.canonical.x+G<<-D)),z=l.EXTENT*(c.tileID.canonical.y-(i.canonical.y<<-D))),l.ortho(y,0,A,0,A,0,1),l.translate(y,y,[O,z,0])}return new Js(c.tileID,i.key,y)}_findTileCoveringTileID(i,c){let p=c.getTile(i);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[c.id],D=y[i.key];if(p=D?c.getTileByID(D):null,p&&p.hasData()||null===D)return p;let A=p?p.tileID:i,O=A.overscaledZ;const z=c.getSource().minzoom,G=[];if(!D){const oe=c.getSource().maxzoom;if(i.canonical.z>=oe){const de=i.canonical.z-oe;c.getSource().reparseOverscaled?(O=Math.max(i.canonical.z+2,c.transform.tileZoom),A=new l.OverscaledTileID(O,i.wrap,oe,i.canonical.x>>de,i.canonical.y>>de)):0!==de&&(O=oe,A=new l.OverscaledTileID(O,i.wrap,oe,i.canonical.x>>de,i.canonical.y>>de))}A.key!==i.key&&(G.push(A.key),p=c.getTile(A))}const W=oe=>{G.forEach(de=>{y[de]=oe}),G.length=0};for(O-=1;O>=z&&(!p||!p.hasData());O--){p&&W(p.tileID.key);const oe=A.calculateScaledKey(O);if(p=c.getTileByID(oe),p&&p.hasData())break;const de=y[oe];if(null===de)break;void 0===de?G.push(oe):p=c.getTileByID(de)}return W(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let p=this._tilesDirty[i];p||(p=this._tilesDirty[i]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(c){let p=0;const y=new l.StructArrayLayout2ui4,D=131;for(let A=1;A<129;A++){for(let O=1;O<129;O++)p=A*D+O,y.emplaceBack(p,p+1),y.emplaceBack(p,p+D),y.emplaceBack(p+1,p+D),128===A&&y.emplaceBack(p+D,p+D+1);y.emplaceBack(p+1,p+1+D)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class K{static cacheKey(i,c,p,y){let D=`${c}${y?y.cacheKey:""}`;for(const A of p)i.usedDefines.includes(A)&&(D+=`/${A}`);return D}constructor(i,c,p,y,D,A){const O=i.gl;this.program=O.createProgram();const z=function(ae){const Te=[];for(let Ge=0;Ge<ae.length;Ge++){if(null===ae[Ge])continue;const Ve=ae[Ge].split(" ");Te.push(Ve.pop())}return Te}(p.staticAttributes),G=y?y.getBinderAttributes():[],W=z.concat(G);let oe=y?y.defines():[];oe=oe.concat(A.map(ae=>`#define ${ae}`));const de=i.isWebGL2?"#version 300 es\n":"",ge=de+oe.concat(i.extStandardDerivatives&&0===de.length?"#extension GL_OES_standard_derivatives : enable\n".concat(cs):cs,cs,ms,oa.fragmentSource,Uo.fragmentSource,p.fragmentSource).join("\n"),be=de+oe.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ms,oa.vertexSource,Uo.vertexSource,Ro.vertexSource,p.vertexSource).join("\n"),De=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(De,ge),O.compileShader(De),O.attachShader(this.program,De);const Oe=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(Oe,be),O.compileShader(Oe),O.attachShader(this.program,Oe),this.attributes={},this.numAttributes=W.length;for(let ae=0;ae<this.numAttributes;ae++)W[ae]&&(O.bindAttribLocation(this.program,ae,W[ae]),this.attributes[W[ae]]=ae);O.linkProgram(this.program),O.deleteShader(Oe),O.deleteShader(De),this.fixedUniforms=D(i),this.binderUniforms=y?y.getUniforms(i):[],A.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new l.Uniform1i(ae=i),u_dem_prev:new l.Uniform1i(ae),u_dem_unpack:new l.Uniform4f(ae),u_dem_tl:new l.Uniform2f(ae),u_dem_scale:new l.Uniform1f(ae),u_dem_tl_prev:new l.Uniform2f(ae),u_dem_scale_prev:new l.Uniform1f(ae),u_dem_size:new l.Uniform1f(ae),u_dem_lerp:new l.Uniform1f(ae),u_exaggeration:new l.Uniform1f(ae),u_depth:new l.Uniform1i(ae),u_depth_size_inv:new l.Uniform2f(ae),u_meter_to_dem:new l.Uniform1f(ae),u_label_plane_matrix_inv:new l.UniformMatrix4f(ae)}),A.includes("GLOBE")&&(this.globeUniforms=(ae=>({u_tile_tl_up:new l.Uniform3f(ae),u_tile_tr_up:new l.Uniform3f(ae),u_tile_br_up:new l.Uniform3f(ae),u_tile_bl_up:new l.Uniform3f(ae),u_tile_up_scale:new l.Uniform1f(ae)}))(i)),A.includes("FOG")&&(this.fogUniforms=(ae=>({u_fog_matrix:new l.UniformMatrix4f(ae),u_fog_range:new l.Uniform2f(ae),u_fog_color:new l.Uniform4f(ae),u_fog_horizon_blend:new l.Uniform1f(ae),u_fog_temporal_offset:new l.Uniform1f(ae),u_frustum_tl:new l.Uniform3f(ae),u_frustum_tr:new l.Uniform3f(ae),u_frustum_br:new l.Uniform3f(ae),u_frustum_bl:new l.Uniform3f(ae),u_globe_pos:new l.Uniform3f(ae),u_globe_radius:new l.Uniform1f(ae),u_globe_transition:new l.Uniform1f(ae),u_is_globe:new l.Uniform1i(ae),u_viewport:new l.Uniform2f(ae)}))(i))}var ae}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y]&&p[y].set(this.program,y,c[y])}}setGlobeUniformValues(i,c){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y]&&p[y].set(this.program,y,c[y])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}draw(i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De){const Oe=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(p),i.setStencilMode(y),i.setColorMode(D),i.setCullFace(A);for(const Te of Object.keys(this.fixedUniforms))this.fixedUniforms[Te].set(this.program,Te,O[Te]);be&&be.setUniforms(this.program,i,this.binderUniforms,de,{zoom:ge});const ae={[Oe.LINES]:2,[Oe.TRIANGLES]:3,[Oe.LINE_STRIP]:1}[c];for(const Te of oe.get()){const Ge=Te.vaos||(Te.vaos={});(Ge[z]||(Ge[z]=new ka)).bind(i,this,G,be?be.getPaintVertexBuffers():[],W,Te.vertexOffset,De||[]),Oe.drawElements(c,Te.primitiveLength*ae,Oe.UNSIGNED_SHORT,Te.primitiveOffset*ae*2)}}}function R(h,i){const c=Math.pow(2,i.tileID.overscaledZ),p=i.tileSize*Math.pow(2,h.transform.tileZoom)/c,y=p*(i.tileID.canonical.x+i.tileID.wrap*c),D=p*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_tile_units_to_pixels:1/Pn(i,1,h.transform.tileZoom),u_pixel_coord_upper:[y>>16,D>>16],u_pixel_coord_lower:[65535&y,65535&D]}}const ne=l.create(),Pe=(h,i,c,p,y,D,A,O,z,G,W)=>{const oe=i.style.light,de=oe.properties.get("position"),ge=[de.x,de.y,de.z],be=l.create$1();"viewport"===oe.properties.get("anchor")&&(l.fromRotation(be,-i.transform.angle),l.transformMat3(ge,ge,be));const De=oe.properties.get("color"),Oe=i.transform,ae={u_matrix:h,u_lightpos:ge,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ne,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:D};return"globe"===Oe.projection.name&&(ae.u_tile_id=[A.canonical.x,A.canonical.y,1<<A.canonical.z],ae.u_zoom_transition=z,ae.u_inv_rot_matrix=W,ae.u_merc_center=G,ae.u_up_dir=Oe.projection.upVector(new l.CanonicalTileID(0,0,0),G[0]*l.EXTENT,G[1]*l.EXTENT),ae.u_height_lift=O),ae},En=(h,i,c,p,y,D,A,O,z,G,W,oe)=>{const de=Pe(h,i,c,p,y,D,A,z,G,W,oe),ge={u_height_factor:-Math.pow(2,A.overscaledZ)/O.tileSize/8};return l.extend(de,R(i,O),ge)},ar=h=>({u_matrix:h}),ir=(h,i,c)=>l.extend(ar(h),R(i,c)),Oi=(h,i)=>({u_matrix:h,u_world:i}),so=(h,i,c,p)=>l.extend(ir(h,i,c),{u_world:p}),ee=l.create(),Y=(h,i,c,p,y,D)=>{const A=h.transform,O="globe"===A.projection.name;let z;if("map"===D.paint.get("circle-pitch-alignment"))if(O){const W=l.globePixelsToTileUnits(A.zoom,i.canonical)*A._pixelsPerMercatorPixel;z=Float32Array.from([W,0,0,W])}else z=A.calculatePixelsToTileUnitsMatrix(c);else z=new Float32Array([A.pixelsToGLUnits[0],0,0,A.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:A.cameraToCenterDistance,u_matrix:h.translatePosMatrix(i.projMatrix,c,D.paint.get("circle-translate"),D.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:ee,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){G.u_inv_rot_matrix=p,G.u_merc_center=y,G.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],G.u_zoom_transition=l.globeToMercatorTransition(A.zoom);const W=y[0]*l.EXTENT,oe=y[1]*l.EXTENT;G.u_up_dir=A.projection.upVector(new l.CanonicalTileID(0,0,0),W,oe)}return G},Me=h=>{const i=[];return"map"===h.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===h.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},re=(h,i,c,p)=>{const y=l.EXTENT/c.tileSize;return{u_matrix:h,u_camera_to_center_distance:i.getCameraToCenterDistance(p),u_extrude_scale:[i.pixelsToGLUnits[0]/y,i.pixelsToGLUnits[1]/y]}},We=(h,i,c=1)=>({u_matrix:h,u_color:i,u_overlay:0,u_overlay_scale:c}),zn=l.create(),zr=(h,i,c,p,y,D,A)=>{const O=h.transform,z="globe"===O.projection.name,G=z?l.globePixelsToTileUnits(O.zoom,i.canonical)*O._pixelsPerMercatorPixel:Pn(c,1,D),W={u_matrix:i.projMatrix,u_extrude_scale:G,u_intensity:A,u_inv_rot_matrix:zn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){W.u_inv_rot_matrix=p,W.u_merc_center=y,W.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],W.u_zoom_transition=l.globeToMercatorTransition(O.zoom);const oe=y[0]*l.EXTENT,de=y[1]*l.EXTENT;W.u_up_dir=O.projection.upVector(new l.CanonicalTileID(0,0,0),oe,de)}return W},Oo=(h,i,c,p,y,D,A)=>{const O=h.transform,z=O.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:Ko(h,i,c,p),u_pixels_to_tile_units:z,u_device_pixel_ratio:D,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:Ds(c)?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:is(i,h.transform),u_alpha_discard_threshold:0,u_trim_offset:A}},rs=(h,i,c,p,y)=>{const D=h.transform;return{u_matrix:Ko(h,i,c,p),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:is(i,D),u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function is(h,i){return 1/Pn(h,1,i.tileZoom)}function Ko(h,i,c,p){return h.translatePosMatrix(p||i.tileID.projMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Ds(h){const i=h.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const La=(h,i,c,p,y,D)=>{return{u_matrix:h,u_tl_parent:i,u_scale_parent:c,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(O=y.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(A=y.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:Jo(y.paint.get("raster-hue-rotate")),u_perspective_transform:D};var A,O};function Jo(h){h*=Math.PI/180;const i=Math.sin(h),c=Math.cos(h);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const il=l.create(),Vl=(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De)=>{const Oe=y.transform,ae={u_is_size_zoom_constant:+("constant"===h||"source"===h),u_is_size_feature_constant:+("constant"===h||"camera"===h),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:Oe.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:Oe.width/Oe.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:A,u_coord_matrix:O,u_is_text:+z,u_pitch_with_map:+p,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:il,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:il,u_up_vector:[0,-1,0]};return"globe"===De.name&&(ae.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],ae.u_zoom_transition=oe,ae.u_inv_rot_matrix=ge,ae.u_merc_center=de,ae.u_camera_forward=Oe._camera.forward(),ae.u_ecef_origin=l.globeECEFOrigin(Oe.globeMatrix,W.toUnwrapped()),ae.u_tile_matrix=Float32Array.from(Oe.globeMatrix),ae.u_up_vector=be),ae},wa=(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De,Oe)=>l.extend(Vl(h,i,c,p,y,D,A,O,z,G,oe,de,ge,be,De,Oe),{u_gamma_scale:p?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+W}),xl=(h,i,c,p,y,D,A,O,z,G,W,oe,de,ge,be,De)=>l.extend(wa(h,i,c,p,y,D,A,O,!0,z,!0,W,oe,de,ge,be,De),{u_texsize_icon:G,u_texture_icon:1}),Fa=(h,i,c)=>({u_matrix:h,u_opacity:i,u_color:c}),Ul=(h,i,c,p,y)=>l.extend(function(D,A,O){const z=A.imageManager.getPattern(D.toString()),{width:G,height:W}=A.imageManager.getPixelSize(),oe=Math.pow(2,O.tileID.overscaledZ),de=O.tileSize*Math.pow(2,A.transform.tileZoom)/oe,ge=de*(O.tileID.canonical.x+O.tileID.wrap*oe),be=de*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[G,W],u_pattern_size:z.displaySize,u_tile_units_to_pixels:1/Pn(O,1,A.transform.tileZoom),u_pixel_coord_upper:[ge>>16,be>>16],u_pixel_coord_lower:[65535&ge,65535&be]}}(p,c,y),{u_matrix:h,u_opacity:i}),Ls={fillExtrusion:h=>({u_matrix:new l.UniformMatrix4f(h),u_lightpos:new l.Uniform3f(h),u_lightintensity:new l.Uniform1f(h),u_lightcolor:new l.Uniform3f(h),u_vertical_gradient:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_edge_radius:new l.Uniform1f(h),u_ao:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_up_dir:new l.Uniform3f(h),u_height_lift:new l.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_lightpos:new l.Uniform3f(h),u_lightintensity:new l.Uniform1f(h),u_lightcolor:new l.Uniform3f(h),u_vertical_gradient:new l.Uniform1f(h),u_height_factor:new l.Uniform1f(h),u_edge_radius:new l.Uniform1f(h),u_ao:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_up_dir:new l.Uniform3f(h),u_height_lift:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h)}),fill:h=>({u_matrix:new l.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),fillOutline:h=>({u_matrix:new l.UniformMatrix4f(h),u_world:new l.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_world:new l.Uniform2f(h),u_image:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new l.Uniform1f(h),u_extrude_scale:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_up_dir:new l.Uniform3f(h)}),collisionBox:h=>({u_matrix:new l.UniformMatrix4f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_extrude_scale:new l.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new l.UniformMatrix4f(h),u_inv_matrix:new l.UniformMatrix4f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_viewport_size:new l.Uniform2f(h)}),debug:h=>({u_color:new l.UniformColor(h),u_matrix:new l.UniformMatrix4f(h),u_overlay:new l.Uniform1i(h),u_overlay_scale:new l.Uniform1f(h)}),clippingMask:h=>({u_matrix:new l.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new l.Uniform1f(h),u_intensity:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_up_dir:new l.Uniform3f(h)}),heatmapTexture:h=>({u_image:new l.Uniform1i(h),u_color_ramp:new l.Uniform1i(h),u_opacity:new l.Uniform1f(h)}),hillshade:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_latrange:new l.Uniform2f(h),u_light:new l.Uniform2f(h),u_shadow:new l.UniformColor(h),u_highlight:new l.UniformColor(h),u_accent:new l.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new l.UniformMatrix4f(h),u_image:new l.Uniform1i(h),u_dimension:new l.Uniform2f(h),u_zoom:new l.Uniform1f(h),u_unpack:new l.Uniform4f(h)}),line:h=>({u_matrix:new l.UniformMatrix4f(h),u_pixels_to_tile_units:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_units_to_pixels:new l.Uniform2f(h),u_dash_image:new l.Uniform1i(h),u_gradient_image:new l.Uniform1i(h),u_image_height:new l.Uniform1f(h),u_texsize:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_alpha_discard_threshold:new l.Uniform1f(h),u_trim_offset:new l.Uniform2f(h)}),linePattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_texsize:new l.Uniform2f(h),u_pixels_to_tile_units:new l.UniformMatrix2f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_units_to_pixels:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h),u_alpha_discard_threshold:new l.Uniform1f(h)}),raster:h=>({u_matrix:new l.UniformMatrix4f(h),u_tl_parent:new l.Uniform2f(h),u_scale_parent:new l.Uniform1f(h),u_fade_t:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_image0:new l.Uniform1i(h),u_image1:new l.Uniform1i(h),u_brightness_low:new l.Uniform1f(h),u_brightness_high:new l.Uniform1f(h),u_saturation_factor:new l.Uniform1f(h),u_contrast_factor:new l.Uniform1f(h),u_spin_weights:new l.Uniform3f(h),u_perspective_transform:new l.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_camera_forward:new l.Uniform3f(h),u_tile_matrix:new l.UniformMatrix4f(h),u_up_vector:new l.Uniform3f(h),u_ecef_origin:new l.Uniform3f(h),u_texture:new l.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_texture:new l.Uniform1i(h),u_gamma_scale:new l.Uniform1f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_tile_id:new l.Uniform3f(h),u_zoom_transition:new l.Uniform1f(h),u_inv_rot_matrix:new l.UniformMatrix4f(h),u_merc_center:new l.Uniform2f(h),u_camera_forward:new l.Uniform3f(h),u_tile_matrix:new l.UniformMatrix4f(h),u_up_vector:new l.Uniform3f(h),u_ecef_origin:new l.Uniform3f(h),u_is_halo:new l.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new l.Uniform1i(h),u_is_size_feature_constant:new l.Uniform1i(h),u_size_t:new l.Uniform1f(h),u_size:new l.Uniform1f(h),u_camera_to_center_distance:new l.Uniform1f(h),u_rotate_symbol:new l.Uniform1i(h),u_aspect_ratio:new l.Uniform1f(h),u_fade_change:new l.Uniform1f(h),u_matrix:new l.UniformMatrix4f(h),u_label_plane_matrix:new l.UniformMatrix4f(h),u_coord_matrix:new l.UniformMatrix4f(h),u_is_text:new l.Uniform1i(h),u_pitch_with_map:new l.Uniform1i(h),u_texsize:new l.Uniform2f(h),u_texsize_icon:new l.Uniform2f(h),u_texture:new l.Uniform1i(h),u_texture_icon:new l.Uniform1i(h),u_gamma_scale:new l.Uniform1f(h),u_device_pixel_ratio:new l.Uniform1f(h),u_is_halo:new l.Uniform1i(h)}),background:h=>({u_matrix:new l.UniformMatrix4f(h),u_opacity:new l.Uniform1f(h),u_color:new l.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new l.UniformMatrix4f(h),u_opacity:new l.Uniform1f(h),u_image:new l.Uniform1i(h),u_pattern_tl:new l.Uniform2f(h),u_pattern_br:new l.Uniform2f(h),u_texsize:new l.Uniform2f(h),u_pattern_size:new l.Uniform2f(h),u_pixel_coord_upper:new l.Uniform2f(h),u_pixel_coord_lower:new l.Uniform2f(h),u_tile_units_to_pixels:new l.Uniform1f(h)}),terrainRaster:co,terrainDepth:co,skybox:h=>({u_matrix:new l.UniformMatrix4f(h),u_sun_direction:new l.Uniform3f(h),u_cubemap:new l.Uniform1i(h),u_opacity:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new l.UniformMatrix4f(h),u_color_ramp:new l.Uniform1i(h),u_center_direction:new l.Uniform3f(h),u_radius:new l.Uniform1f(h),u_opacity:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new l.UniformMatrix3f(h),u_sun_direction:new l.Uniform3f(h),u_sun_intensity:new l.Uniform1f(h),u_color_tint_r:new l.Uniform4f(h),u_color_tint_m:new l.Uniform4f(h),u_luminance:new l.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new l.UniformMatrix4f(h),u_globe_matrix:new l.UniformMatrix4f(h),u_normalize_matrix:new l.UniformMatrix4f(h),u_merc_matrix:new l.UniformMatrix4f(h),u_zoom_transition:new l.Uniform1f(h),u_merc_center:new l.Uniform2f(h),u_image0:new l.Uniform1i(h),u_grid_matrix:new l.UniformMatrix3f(h),u_skirt_height:new l.Uniform1f(h),u_frustum_tl:new l.Uniform3f(h),u_frustum_tr:new l.Uniform3f(h),u_frustum_br:new l.Uniform3f(h),u_frustum_bl:new l.Uniform3f(h),u_globe_pos:new l.Uniform3f(h),u_globe_radius:new l.Uniform1f(h),u_viewport:new l.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new l.Uniform3f(h),u_frustum_tr:new l.Uniform3f(h),u_frustum_br:new l.Uniform3f(h),u_frustum_bl:new l.Uniform3f(h),u_horizon:new l.Uniform1f(h),u_transition:new l.Uniform1f(h),u_fadeout_range:new l.Uniform1f(h),u_color:new l.Uniform4f(h),u_high_color:new l.Uniform4f(h),u_space_color:new l.Uniform4f(h),u_star_intensity:new l.Uniform1f(h),u_star_density:new l.Uniform1f(h),u_star_size:new l.Uniform1f(h),u_temporal_offset:new l.Uniform1f(h),u_horizon_angle:new l.Uniform1f(h),u_rotation_matrix:new l.UniformMatrix4f(h)})};let Gs;function uo(h,i,c,p,y,D,A){const O=h.context,z=O.gl,G=h.transform,W=h.useProgram("collisionBox"),oe=[];let de=0,ge=0;for(let Ve=0;Ve<p.length;Ve++){const bt=p[Ve],wt=i.getTile(bt),dt=wt.getBucket(c);if(!dt)continue;const Lt=gn(bt,dt,G);let Tt=Lt;0===y[0]&&0===y[1]||(Tt=h.translatePosMatrix(Lt,wt,y,D));const qt=A?dt.textCollisionBox:dt.iconCollisionBox,Rn=dt.collisionCircleArray;if(Rn.length>0){const Ht=l.create(),Dn=Tt;l.mul(Ht,dt.placementInvProjMatrix,G.glCoordMatrix),l.mul(Ht,Ht,dt.placementViewportMatrix),oe.push({circleArray:Rn,circleOffset:ge,transform:Dn,invTransform:Ht,projection:dt.getProjection()}),de+=Rn.length/4,ge=de}qt&&(h.terrain&&h.terrain.setupElevationDraw(wt,W),W.draw(O,z.LINES,l.DepthMode.disabled,l.StencilMode.disabled,h.colorModeForRenderPass(),l.CullFaceMode.disabled,re(Tt,G,wt,dt.getProjection()),c.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,null,G.zoom,null,[qt.collisionVertexBuffer,qt.collisionVertexBufferExt]))}if(!A||!oe.length)return;const be=h.useProgram("collisionCircle"),De=new l.StructArrayLayout2f1f2i16;De.resize(4*de),De._trim();let Oe=0;for(const Ve of oe)for(let bt=0;bt<Ve.circleArray.length/4;bt++){const wt=4*bt,dt=Ve.circleArray[wt+0],Lt=Ve.circleArray[wt+1],Tt=Ve.circleArray[wt+2],qt=Ve.circleArray[wt+3];De.emplace(Oe++,dt,Lt,Tt,qt,0),De.emplace(Oe++,dt,Lt,Tt,qt,1),De.emplace(Oe++,dt,Lt,Tt,qt,2),De.emplace(Oe++,dt,Lt,Tt,qt,3)}(!Gs||Gs.length<2*de)&&(Gs=function(Ve){const bt=2*Ve,wt=new l.StructArrayLayout3ui6;wt.resize(bt),wt._trim();for(let dt=0;dt<bt;dt++){const Lt=6*dt;wt.uint16[Lt+0]=4*dt+0,wt.uint16[Lt+1]=4*dt+1,wt.uint16[Lt+2]=4*dt+2,wt.uint16[Lt+3]=4*dt+2,wt.uint16[Lt+4]=4*dt+3,wt.uint16[Lt+5]=4*dt+0}return wt}(de));const ae=O.createIndexBuffer(Gs,!0),Te=O.createVertexBuffer(De,l.collisionCircleLayout.members,!0);for(const Ve of oe){const bt={u_matrix:Ve.transform,u_inv_matrix:Ve.invTransform,u_camera_to_center_distance:(Ge=G).getCameraToCenterDistance(Ve.projection),u_viewport_size:[Ge.width,Ge.height]};be.draw(O,z.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,h.colorModeForRenderPass(),l.CullFaceMode.disabled,bt,c.id,Te,ae,l.SegmentVector.simpleSegment(0,2*Ve.circleOffset,Ve.circleArray.length,Ve.circleArray.length/2),null,G.zoom)}var Ge;Te.destroy(),ae.destroy()}const Fs=l.create();function bl({width:h,height:i,anchor:c,textOffset:p,textScale:y},D){const{horizontalAlign:A,verticalAlign:O}=l.getAnchorAlignment(c),z=-(A-.5)*h,G=-(O-.5)*i,W=l.evaluateVariableOffset(c,p);return new l.Point((z/y+W[0])*D,(G/y+W[1])*D)}function jl(h,i,c,p,y,D,A,O,z,G,W){const oe=h.text.placedSymbolArray,de=h.text.dynamicLayoutVertexArray,ge=h.icon.dynamicLayoutVertexArray,be={},De=h.getProjection(),Oe=un(O,De,D),ae=D.elevation,Te=De.upVectorScale(O.canonical,D.center.lat,D.worldSize).metersToTile;de.clear();for(let Ge=0;Ge<oe.length;Ge++){const Ve=oe.get(Ge),{tileAnchorX:bt,tileAnchorY:wt,numGlyphs:dt}=Ve,Lt=Ve.hidden||!Ve.crossTileID||h.allowVerticalPlacement&&!Ve.placedOrientation?null:p[Ve.crossTileID];if(Lt){let Tt=0,qt=0,Rn=0;if(ae){const $n=ae?ae.getAtTileOffset(O,bt,wt):0,[Ar,Xr,ur]=De.upVector(O.canonical,bt,wt);Tt=$n*Ar*Te,qt=$n*Xr*Te,Rn=$n*ur*Te}let[Ht,Dn,sn,Ln]=ii(Ve.projectedAnchorX+Tt,Ve.projectedAnchorY+qt,Ve.projectedAnchorZ+Rn,c?Oe:A);const Xt=Yo(D.getCameraToCenterDistance(De),Ln);let xn=y.evaluateSizeForFeature(h.textSizeData,G,Ve)*Xt/l.ONE_EM;c&&(xn*=h.tilePixelRatio/z);const Nn=bl(Lt,xn);c?(({x:Ht,y:Dn,z:sn}=De.projectTilePoint(bt+Nn.x,wt+Nn.y,O.canonical)),[Ht,Dn,sn]=ii(Ht+Tt,Dn+qt,sn+Rn,A)):(i&&Nn._rotate(-D.angle),Ht+=Nn.x,Dn+=Nn.y,sn=0);const An=h.allowVerticalPlacement&&Ve.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let $n=0;$n<dt;$n++)l.addDynamicAttributes(de,Ht,Dn,sn,An);W&&Ve.associatedIconIndex>=0&&(be[Ve.associatedIconIndex]={x:Ht,y:Dn,z:sn,angle:An})}else we(dt,de)}if(W){ge.clear();const Ge=h.icon.placedSymbolArray;for(let Ve=0;Ve<Ge.length;Ve++){const bt=Ge.get(Ve),{numGlyphs:wt}=bt,dt=be[Ve];if(bt.hidden||!dt)we(wt,ge);else{const{x:Lt,y:Tt,z:qt,angle:Rn}=dt;for(let Ht=0;Ht<wt;Ht++)l.addDynamicAttributes(ge,Lt,Tt,qt,Rn)}}h.icon.dynamicLayoutVertexBuffer.updateData(ge)}h.text.dynamicLayoutVertexBuffer.updateData(de)}function ol(h,i,c){return c.iconsInText&&i?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function sl(h,i,c,p,y,D,A,O,z,G,W,oe){const de=h.context,ge=de.gl,be=h.transform,De="map"===O,Oe="map"===z,ae=De&&"point"!==c.layout.get("symbol-placement"),Te=De&&!Oe&&!ae,Ge=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let Ve=!1;const bt=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),wt=[l.mercatorXfromLng(be.center.lng),l.mercatorYfromLat(be.center.lat)],dt=c.layout.get("text-variable-anchor"),Lt="globe"===be.projection.name,Tt=[],qt=[0,-1,0];let Rn=qt;!Lt&&!be.mercatorFromTransition||De||(Rn=function(Ht){const Dn=Ht._camera.getWorldToCamera(Ht.worldSize,1),sn=l.multiply([],Dn,Ht.globeMatrix);l.invert(sn,sn);const Ln=[0,0,0],Xt=[0,1,0,0];return l.transformMat4$1(Xt,Xt,sn),Ln[0]=Xt[0],Ln[1]=Xt[1],Ln[2]=Xt[2],l.normalize(Ln,Ln),Ln}(be));for(const Ht of p){const Dn=i.getTile(Ht),sn=Dn.getBucket(c);if(!sn||"mercator"===sn.projection.name&&Lt)continue;const Ln=y?sn.text:sn.icon;if(!Ln||sn.fullyClipped||!Ln.segments.get().length)continue;const Xt=Ln.programConfigurations.get(c.id),xn=y||sn.sdfIcons,Nn=y?sn.textSizeData:sn.iconSizeData,An=Oe||0!==be.pitch,$n=l.evaluateSizeForZoom(Nn,be.zoom);let Ar,Xr,ur,$r,mi=[0,0],fi=null;if(y)Xr=Dn.glyphAtlasTexture,ur=ge.LINEAR,Ar=Dn.glyphAtlasTexture.size,sn.iconsInText&&(mi=Dn.imageAtlasTexture.size,fi=Dn.imageAtlasTexture,$r=An||h.options.rotating||h.options.zooming||"composite"===Nn.kind||"camera"===Nn.kind?ge.LINEAR:ge.NEAREST);else{const Jl=1!==c.layout.get("icon-size").constantOr(0)||sn.iconsNeedLinear;Xr=Dn.imageAtlasTexture,ur=xn||h.options.rotating||h.options.zooming||Jl||An?ge.LINEAR:ge.NEAREST,Ar=Dn.imageAtlasTexture.size}const xr="globe"===sn.projection.name,Yi=xr?Rn:qt,gi=xr?l.globeToMercatorTransition(be.zoom):0,ho=un(Ht,sn.getProjection(),be),ao=be.calculatePixelsToTileUnitsMatrix(Dn),Ns=on(ho,Dn.tileID.canonical,Oe,De,be,sn.getProjection(),ao),zs=h.terrain&&Oe&&ae?l.invert(l.create(),Ns):Fs,Sa=bi(ho,Dn.tileID.canonical,Oe,De,be,sn.getProjection(),ao),Ua=dt&&sn.hasTextData(),lo="none"!==c.layout.get("icon-text-fit")&&Ua&&sn.hasIconData();if(ae){const Jl=be.elevation,_c=Jl?Jl.getAtTileOffsetFunc(Ht,be.center.lat,be.worldSize,sn.getProjection()):null,kc=ro(ho,Dn.tileID.canonical,Oe,De,be,sn.getProjection(),ao);ss(sn,ho,h,y,kc,Sa,Oe,G,_c,Ht)}const Vi=ae||y&&dt||lo,Ii=h.translatePosMatrix(ho,Dn,D,A),hs=Vi?Fs:Ns,Zs=h.translatePosMatrix(Sa,Dn,D,A,!0),to=sn.getProjection().createInversionMatrix(be,Ht.canonical),Ia=[];h.terrainRenderModeElevated()&&Oe&&Ia.push("PITCH_WITH_MAP_TERRAIN"),xr&&Ia.push("PROJECTION_GLOBE_VIEW"),Vi&&Ia.push("PROJECTED_POS_ON_VIEWPORT");const $u=xn&&0!==c.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1);let Oc;Oc=xn?sn.iconsInText?xl(Nn.kind,$n,Te,Oe,h,Ii,hs,Zs,Ar,mi,Ht,gi,wt,to,Yi,sn.getProjection()):wa(Nn.kind,$n,Te,Oe,h,Ii,hs,Zs,y,Ar,!0,Ht,gi,wt,to,Yi,sn.getProjection()):Vl(Nn.kind,$n,Te,Oe,h,Ii,hs,Zs,y,Ar,Ht,gi,wt,to,Yi,sn.getProjection());const Vu={program:h.useProgram(ol(xn,y,sn),Xt,Ia),buffers:Ln,uniformValues:Oc,atlasTexture:Xr,atlasTextureIcon:fi,atlasInterpolation:ur,atlasInterpolationIcon:$r,isSDF:xn,hasHalo:$u,tile:Dn,labelPlaneMatrixInv:zs};if(Ge&&sn.canOverlap){Ve=!0;const Jl=Ln.segments.get();for(const _c of Jl)Tt.push({segments:new l.SegmentVector([_c]),sortKey:_c.sortKey,state:Vu})}else Tt.push({segments:Ln.segments,sortKey:0,state:Vu})}Ve&&Tt.sort((Ht,Dn)=>Ht.sortKey-Dn.sortKey);for(const Ht of Tt){const Dn=Ht.state;if(h.terrain&&h.terrain.setupElevationDraw(Dn.tile,Dn.program,{useDepthForOcclusion:!Lt,labelPlaneMatrixInv:Dn.labelPlaneMatrixInv}),de.activeTexture.set(ge.TEXTURE0),Dn.atlasTexture.bind(Dn.atlasInterpolation,ge.CLAMP_TO_EDGE),Dn.atlasTextureIcon&&(de.activeTexture.set(ge.TEXTURE1),Dn.atlasTextureIcon&&Dn.atlasTextureIcon.bind(Dn.atlasInterpolationIcon,ge.CLAMP_TO_EDGE)),Dn.isSDF){const sn=Dn.uniformValues;Dn.hasHalo&&(sn.u_is_halo=1,al(Dn.buffers,Ht.segments,c,h,Dn.program,bt,W,oe,sn)),sn.u_is_halo=0}al(Dn.buffers,Ht.segments,c,h,Dn.program,bt,W,oe,Dn.uniformValues)}}function al(h,i,c,p,y,D,A,O,z){const G=p.context,W=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];y.draw(G,G.gl.TRIANGLES,D,A,O,l.CullFaceMode.disabled,z,c.id,h.layoutVertexBuffer,h.indexBuffer,i,c.paint,p.transform.zoom,h.programConfigurations.get(c.id),W)}function dc(h,i,c,p,y,D,A){const O=h.context.gl,z=c.paint.get("fill-pattern"),G=z&&z.constantOr(1);let W,oe,de,ge,be;A?(oe=G&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=O.LINES):(oe=G?"fillPattern":"fill",W=O.TRIANGLES);for(const De of p){const Oe=i.getTile(De);if(G&&!Oe.patternsLoaded())continue;const ae=Oe.getBucket(c);if(!ae)continue;h.prepareDrawTile();const Te=ae.programConfigurations.get(c.id),Ge=h.useProgram(oe,Te);G&&(h.context.activeTexture.set(O.TEXTURE0),Oe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Te.updatePaintBuffers());const Ve=z.constantOr(null);if(Ve&&Oe.imageAtlas){const wt=Oe.imageAtlas.patternPositions[Ve.toString()];wt&&Te.setConstantPatternPositions(wt)}const bt=h.translatePosMatrix(De.projMatrix,Oe,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(A){ge=ae.indexBuffer2,be=ae.segments2;const wt=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];de="fillOutlinePattern"===oe&&G?so(bt,h,Oe,wt):Oi(bt,wt)}else ge=ae.indexBuffer,be=ae.segments,de=G?ir(bt,h,Oe):ar(bt);h.prepareDrawProgram(h.context,Ge,De.toUnwrapped()),Ge.draw(h.context,W,y,h.stencilModeForClipping(De),D,l.CullFaceMode.disabled,de,c.id,ae.layoutVertexBuffer,ge,be,c.paint,h.transform.zoom,Te)}}function fa(h,i,c,p,y,D,A){const O=h.context,z=O.gl,G=h.transform,W=c.paint.get("fill-extrusion-pattern"),oe=W.constantOr(1),de=c.paint.get("fill-extrusion-opacity"),ge=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],be=c.layout.get("fill-extrusion-edge-radius"),De=be>0&&!c.paint.get("fill-extrusion-rounded-roof"),Oe=De?0:be,ae="globe"===G.projection.name?l.fillExtrusionHeightLift():0,Te="globe"===G.projection.name,Ge=Te?l.globeToMercatorTransition(G.zoom):0,Ve=[l.mercatorXfromLng(G.center.lng),l.mercatorYfromLat(G.center.lat)],bt=[];Te&&bt.push("PROJECTION_GLOBE_VIEW"),ge[0]>0&&bt.push("FAUX_AO"),De&&bt.push("ZERO_ROOF_RADIUS");for(const wt of p){const dt=i.getTile(wt),Lt=dt.getBucket(c);if(!Lt||Lt.projection.name!==G.projection.name)continue;const Tt=Lt.programConfigurations.get(c.id),qt=h.useProgram(oe?"fillExtrusionPattern":"fillExtrusion",Tt,bt);if(h.terrain){const xn=h.terrain;if(h.style.terrainSetForDrapingOnly())xn.setupElevationDraw(dt,qt,{useMeterToDem:!0});else{if(!Lt.enableTerrain)continue;if(xn.setupElevationDraw(dt,qt,{useMeterToDem:!0}),Ws(O,i,wt,Lt,c,xn),!Lt.centroidVertexBuffer){const Nn=qt.attributes.a_centroid_pos;void 0!==Nn&&z.vertexAttrib2f(Nn,0,0)}}}oe&&(h.context.activeTexture.set(z.TEXTURE0),dt.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Tt.updatePaintBuffers());const Rn=W.constantOr(null);if(Rn&&dt.imageAtlas){const xn=dt.imageAtlas.patternPositions[Rn.toString()];xn&&Tt.setConstantPatternPositions(xn)}const Ht=h.translatePosMatrix(wt.projMatrix,dt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Dn=G.projection.createInversionMatrix(G,wt.canonical),sn=c.paint.get("fill-extrusion-vertical-gradient"),Ln=oe?En(Ht,h,sn,de,ge,Oe,wt,dt,ae,Ge,Ve,Dn):Pe(Ht,h,sn,de,ge,Oe,wt,ae,Ge,Ve,Dn);h.prepareDrawProgram(O,qt,wt.toUnwrapped());const Xt=[];h.terrain&&Xt.push(Lt.centroidVertexBuffer),Te&&Xt.push(Lt.layoutVertexExtBuffer),qt.draw(O,O.gl.TRIANGLES,y,D,A,l.CullFaceMode.backCCW,Ln,c.id,Lt.layoutVertexBuffer,Lt.indexBuffer,Lt.segments,c.paint,h.transform.zoom,Tt,Xt)}}function Ws(h,i,c,p,y,D){const A=[ae=>{let Te=ae.canonical.x-1,Ge=ae.wrap;return Te<0&&(Te=(1<<ae.canonical.z)-1,Ge--),new l.OverscaledTileID(ae.overscaledZ,Ge,ae.canonical.z,Te,ae.canonical.y)},ae=>{let Te=ae.canonical.x+1,Ge=ae.wrap;return Te===1<<ae.canonical.z&&(Te=0,Ge++),new l.OverscaledTileID(ae.overscaledZ,Ge,ae.canonical.z,Te,ae.canonical.y)},ae=>new l.OverscaledTileID(ae.overscaledZ,ae.wrap,ae.canonical.z,ae.canonical.x,(0===ae.canonical.y?1<<ae.canonical.z:ae.canonical.y)-1),ae=>new l.OverscaledTileID(ae.overscaledZ,ae.wrap,ae.canonical.z,ae.canonical.x,ae.canonical.y===(1<<ae.canonical.z)-1?0:ae.canonical.y+1)],O=ae=>{const Te=i.getSource().minzoom,Ge=bt=>{const wt=i.getTileByID(bt);if(wt&&wt.hasData())return wt.getBucket(y)},Ve=[0,-1,1];for(const bt of Ve){if(ae.overscaledZ+bt<Te)continue;const wt=Ge(ae.calculateScaledKey(ae.overscaledZ+bt));if(wt)return wt}},z=[0,0,0],G=(ae,Te)=>(z[0]=Math.min(ae.min.y,Te.min.y),z[1]=Math.max(ae.max.y,Te.max.y),z[2]=l.EXTENT-Te.min.x>ae.max.x?Te.min.x-l.EXTENT:ae.max.x,z),W=(ae,Te)=>(z[0]=Math.min(ae.min.x,Te.min.x),z[1]=Math.max(ae.max.x,Te.max.x),z[2]=l.EXTENT-Te.min.y>ae.max.y?Te.min.y-l.EXTENT:ae.max.y,z),oe=[(ae,Te)=>G(ae,Te),(ae,Te)=>G(Te,ae),(ae,Te)=>W(ae,Te),(ae,Te)=>W(Te,ae)],de=new l.Point(0,0);let ge,be,De;const Oe=(ae,Te,Ge,Ve,bt)=>{const wt=[[Ve?Ge:ae,Ve?ae:Ge,0],[Ve?Ge:Te,Ve?Te:Ge,0]],dt=bt<0?l.EXTENT+bt:bt,Lt=[Ve?dt:(ae+Te)/2,Ve?(ae+Te)/2:dt,0];return 0===Ge&&bt<0||0!==Ge&&bt>0?D.getForTilePoints(De,[Lt],!0,be):wt.push(Lt),D.getForTilePoints(c,wt,!0,ge),Math.max(wt[0][2],wt[1][2],Lt[2])/D.exaggeration()};for(let ae=0;ae<4;ae++){const Te=(ae<2?1:5)-ae,Ge=p.borders[ae];if(0===Ge.length)continue;const Ve=De=A[ae](c),bt=O(Ve);if(!(bt&&bt instanceof l.FillExtrusionBucket&&bt.enableTerrain)||p.borderDoneWithNeighborZ[ae]===bt.canonical.z&&bt.borderDoneWithNeighborZ[Te]===p.canonical.z||(be=D.findDEMTileFor(Ve),!be||!be.dem))continue;if(!ge){const Tt=D.findDEMTileFor(c);if(!Tt||!Tt.dem)return;ge=Tt}const wt=bt.borders[Te];let dt=0;const Lt=bt.borderDoneWithNeighborZ[Te]!==p.canonical.z;if(p.canonical.z===bt.canonical.z){for(let Tt=0;Tt<Ge.length;Tt++){const qt=p.featuresOnBorder[Ge[Tt]],Rn=qt.borders[ae];let Ht;for(;dt<wt.length&&(Ht=bt.featuresOnBorder[wt[dt]],!(Ht.borders[Te][1]>Rn[0]+3));)Lt&&bt.encodeCentroid(void 0,Ht,!1),dt++;if(Ht&&dt<wt.length){const Dn=dt;let sn=0;for(;!(Ht.borders[Te][0]>Rn[1]-3)&&(sn++,++dt!==wt.length);)Ht=bt.featuresOnBorder[wt[dt]];if(Ht=bt.featuresOnBorder[wt[Dn]],qt.intersectsCount()>1||Ht.intersectsCount()>1||1!==sn){1!==sn&&(dt=Dn),p.encodeCentroid(void 0,qt,!1),Lt&&bt.encodeCentroid(void 0,Ht,!1);continue}const Ln=oe[ae](qt,Ht),Xt=ae%2?l.EXTENT-1:0;de.x=Oe(Ln[0],Math.min(l.EXTENT-1,Ln[1]),Xt,ae<2,Ln[2]),de.y=0,p.encodeCentroid(de,qt,!1),Lt&&bt.encodeCentroid(de,Ht,!1)}else p.encodeCentroid(void 0,qt,!1)}p.borderDoneWithNeighborZ[ae]=bt.canonical.z,p.needsCentroidUpdate=!0,Lt&&(bt.borderDoneWithNeighborZ[Te]=p.canonical.z,bt.needsCentroidUpdate=!0)}else{for(const Tt of Ge)p.encodeCentroid(void 0,p.featuresOnBorder[Tt],!1);if(Lt){for(const Tt of wt)bt.encodeCentroid(void 0,bt.featuresOnBorder[Tt],!1);bt.borderDoneWithNeighborZ[Te]=p.canonical.z,bt.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[ae]=bt.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&0!==p.centroidVertexArray.length)&&p.uploadCentroid(h)}const ll=new l.Color(1,0,0,1),qa=new l.Color(0,1,0,1),hc=new l.Color(0,0,1,1),Ic=new l.Color(1,0,1,1),Mc=new l.Color(0,1,1,1);function fc(h,i,c){const p=h.context,y=h.transform,D=p.gl,A="globe"===y.projection.name,O=A?["PROJECTION_GLOBE_VIEW"]:null;let z=c.projMatrix;if(A&&l.globeToMercatorTransition(y.zoom)>0){const qt=l.transitionTileAABBinECEF(c.canonical,y),Rn=l.globeDenormalizeECEF(qt);z=l.multiply(new Float32Array(16),y.globeMatrix,Rn),l.multiply(z,y.projMatrix,z)}const G=h.useProgram("debug",null,O),W=i.getTileByID(c.key);h.terrain&&h.terrain.setupElevationDraw(W,G);const oe=l.DepthMode.disabled,de=l.StencilMode.disabled,ge=h.colorModeForRenderPass();p.activeTexture.set(D.TEXTURE0),h.emptyTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),A?W._makeGlobeTileDebugBuffers(h.context,y):W._makeDebugTileBoundsBuffers(h.context,y.projection);const De=W._tileDebugBuffer||h.debugBuffer,Oe=W._tileDebugIndexBuffer||h.debugIndexBuffer,ae=W._tileDebugSegments||h.debugSegments;G.draw(p,D.LINE_STRIP,oe,de,ge,l.CullFaceMode.disabled,We(z,l.Color.red),"$debug",De,Oe,ae,null,null,null,[W._globeTileDebugBorderBuffer]);const Te=W.latestRawTileData,Ge=Math.floor((Te&&Te.byteLength||0)/1024),Ve=i.getTile(c).tileSize,bt=512/Math.min(Ve,512)*(c.overscaledZ/y.zoom)*.5;let wt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(wt+=` => ${c.overscaledZ}`),wt+=` ${Ge}kb`,function(qt,Rn){qt.initDebugOverlayCanvas();const Ht=qt.debugOverlayCanvas,Dn=qt.context.gl,sn=qt.debugOverlayCanvas.getContext("2d");sn.clearRect(0,0,Ht.width,Ht.height),sn.shadowColor="white",sn.shadowBlur=2,sn.lineWidth=1.5,sn.strokeStyle="white",sn.textBaseline="top",sn.font="bold 36px Open Sans, sans-serif",sn.fillText(Rn,5,5),sn.strokeText(Rn,5,5),qt.debugOverlayTexture.update(Ht),qt.debugOverlayTexture.bind(Dn.LINEAR,Dn.CLAMP_TO_EDGE)}(h,wt);const dt=W._tileDebugTextBuffer||h.debugBuffer,Lt=W._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Tt=W._tileDebugTextSegments||h.debugSegments;G.draw(p,D.TRIANGLES,oe,de,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,We(z,l.Color.transparent,bt),"$debug",dt,Lt,Tt,null,null,null,[W._globeTileDebugTextBuffer])}function Hl(h,i,c,p){Qs(h,0,i+c/2,h.transform.width,c,p)}function Ea(h,i,c,p){Qs(h,i-c/2,0,c,h.transform.height,p)}function Qs(h,i,c,p,y,D){const A=h.context,O=A.gl;O.enable(O.SCISSOR_TEST),O.scissor(i*l.exported.devicePixelRatio,c*l.exported.devicePixelRatio,p*l.exported.devicePixelRatio,y*l.exported.devicePixelRatio),A.clear({color:D}),O.disable(O.SCISSOR_TEST)}const Ba=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Na}=Ba;function Qo(h,i,c,p){h.emplaceBack(i,c,p)}class ea{constructor(i){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,Qo(this.vertexArray,-1,-1,1),Qo(this.vertexArray,1,-1,1),Qo(this.vertexArray,-1,1,1),Qo(this.vertexArray,1,1,1),Qo(this.vertexArray,-1,-1,-1),Qo(this.vertexArray,1,-1,-1),Qo(this.vertexArray,-1,1,-1),Qo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Na),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function B(h,i,c,p,y,D){const A=h.gl,O=i.paint.get("sky-atmosphere-color"),z=i.paint.get("sky-atmosphere-halo-color"),G=i.paint.get("sky-atmosphere-sun-intensity"),W={u_matrix_3f:l.fromMat4(l.create$1(),p),u_sun_direction:y,u_sun_intensity:G,u_color_tint_r:[(be=O).r,be.g,be.b,be.a],u_color_tint_m:[(De=z).r,De.g,De.b,De.a],u_luminance:5e-5};var be,De;A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+D,i.skyboxTexture,0),c.draw(h,A.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,W,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Q=l.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class qe{constructor(i){const c=new l.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new l.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(c,Q.members),this.indexBuffer=i.createIndexBuffer(p),this.segments=l.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Z={symbol:function(h,i,c,p,y){if("translucent"!==h.renderPass)return;const D=l.StencilMode.disabled,A=h.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(O,z,G,W,oe,de,ge){const be=z.transform,De="map"===oe,Oe="map"===de;for(const ae of O){const Te=W.getTile(ae),Ge=Te.getBucket(G);if(!Ge||!Ge.text||!Ge.text.segments.get().length)continue;const Ve=l.evaluateSizeForZoom(Ge.textSizeData,be.zoom),bt=un(ae,Ge.getProjection(),be),wt=be.calculatePixelsToTileUnitsMatrix(Te),dt=on(bt,Te.tileID.canonical,Oe,De,be,Ge.getProjection(),wt),Lt="none"!==G.layout.get("icon-text-fit")&&Ge.hasIconData();if(Ve){const Tt=Math.pow(2,be.zoom-Te.tileID.overscaledZ);jl(Ge,De,Oe,ge,l.symbolSize,be,dt,ae,Tt,Ve,Lt)}}}(p,h,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y),0!==c.paint.get("icon-opacity").constantOr(1)&&sl(h,i,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),D,A),0!==c.paint.get("text-opacity").constantOr(1)&&sl(h,i,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),D,A),i.map.showCollisionBoxes&&(uo(h,i,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),uo(h,i,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(h,i,c,p){if("translucent"!==h.renderPass)return;const y=c.paint.get("circle-opacity"),D=c.paint.get("circle-stroke-width"),A=c.paint.get("circle-stroke-opacity"),O=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===y.constantOr(1)&&(0===D.constantOr(1)||0===A.constantOr(1)))return;const z=h.context,G=z.gl,W=h.transform,oe=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),de=l.StencilMode.disabled,ge=h.colorModeForRenderPass(),be="globe"===W.projection.name,De=[l.mercatorXfromLng(W.center.lng),l.mercatorYfromLat(W.center.lat)],Oe=[];for(let Te=0;Te<p.length;Te++){const Ge=p[Te],Ve=i.getTile(Ge),bt=Ve.getBucket(c);if(!bt||bt.projection.name!==W.projection.name)continue;const wt=bt.programConfigurations.get(c.id),dt=Me(c);be&&dt.push("PROJECTION_GLOBE_VIEW");const Lt=h.useProgram("circle",wt,dt),Tt=bt.layoutVertexBuffer,qt=bt.globeExtVertexBuffer,Rn=bt.indexBuffer,Ht=W.projection.createInversionMatrix(W,Ge.canonical),Dn={programConfiguration:wt,program:Lt,layoutVertexBuffer:Tt,globeExtVertexBuffer:qt,indexBuffer:Rn,uniformValues:Y(h,Ge,Ve,Ht,De,c),tile:Ve};if(O){const sn=bt.segments.get();for(const Ln of sn)Oe.push({segments:new l.SegmentVector([Ln]),sortKey:Ln.sortKey,state:Dn})}else Oe.push({segments:bt.segments,sortKey:0,state:Dn})}O&&Oe.sort((Te,Ge)=>Te.sortKey-Ge.sortKey);const ae={useDepthForOcclusion:!be};for(const Te of Oe){const{programConfiguration:Ge,program:Ve,layoutVertexBuffer:bt,globeExtVertexBuffer:wt,indexBuffer:dt,uniformValues:Lt,tile:Tt}=Te.state,qt=Te.segments;h.terrain&&h.terrain.setupElevationDraw(Tt,Ve,ae),h.prepareDrawProgram(z,Ve,Tt.tileID.toUnwrapped()),Ve.draw(z,G.TRIANGLES,oe,de,ge,l.CullFaceMode.disabled,Lt,c.id,bt,dt,qt,c.paint,W.zoom,Ge,[wt])}},heatmap:function(h,i,c,p){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===h.renderPass){const y=h.context,D=y.gl,A=l.StencilMode.disabled,O=new l.ColorMode([D.ONE,D.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(ge,be,De,Oe){const ae=ge.gl,Te=be.width*Oe,Ge=be.height*Oe;ge.activeTexture.set(ae.TEXTURE1),ge.viewport.set([0,0,Te,Ge]);let Ve=De.heatmapFbo;if(!Ve||Ve&&(Ve.width!==Te||Ve.height!==Ge)){Ve&&Ve.destroy();const bt=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,bt),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),Ve=De.heatmapFbo=ge.createFramebuffer(Te,Ge,!1),function(wt,dt,Lt,Tt,qt,Rn){const Ht=wt.gl;Ht.texImage2D(Ht.TEXTURE_2D,0,wt.isWebGL2&&wt.extRenderToTextureHalfFloat?Ht.RGBA16F:Ht.RGBA,qt,Rn,0,Ht.RGBA,wt.extRenderToTextureHalfFloat?wt.isWebGL2?Ht.HALF_FLOAT:wt.extTextureHalfFloat.HALF_FLOAT_OES:Ht.UNSIGNED_BYTE,null),Tt.colorAttachment.set(Lt)}(ge,0,bt,Ve,Te,Ge)}else ae.bindTexture(ae.TEXTURE_2D,Ve.colorAttachment.get()),ge.bindFramebuffer.set(Ve.framebuffer)})(y,h,c,"globe"===h.transform.projection.name?.5:.25),y.clear({color:l.Color.transparent});const z=h.transform,G="globe"===z.projection.name,W=G?["PROJECTION_GLOBE_VIEW"]:null,oe=G?l.CullFaceMode.frontCCW:l.CullFaceMode.disabled,de=[l.mercatorXfromLng(z.center.lng),l.mercatorYfromLat(z.center.lat)];for(let ge=0;ge<p.length;ge++){const be=p[ge];if(i.hasRenderableParent(be))continue;const De=i.getTile(be),Oe=De.getBucket(c);if(!Oe||Oe.projection.name!==z.projection.name)continue;const ae=Oe.programConfigurations.get(c.id),Te=h.useProgram("heatmap",ae,W),{zoom:Ge}=h.transform;h.terrain&&h.terrain.setupElevationDraw(De,Te),h.prepareDrawProgram(y,Te,be.toUnwrapped());const Ve=z.projection.createInversionMatrix(z,be.canonical);Te.draw(y,D.TRIANGLES,l.DepthMode.disabled,A,O,oe,zr(h,be,De,Ve,de,Ge,c.paint.get("heatmap-intensity")),c.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,c.paint,h.transform.zoom,ae,G?[Oe.globeExtVertexBuffer]:null)}y.viewport.set([0,0,h.width,h.height])}else"translucent"===h.renderPass&&(h.context.setColorMode(h.colorModeForRenderPass()),function(y,D){const A=y.context,O=A.gl,z=D.heatmapFbo;if(!z)return;A.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,z.colorAttachment.get()),A.activeTexture.set(O.TEXTURE1);let G=D.colorRampTexture;G||(G=D.colorRampTexture=new l.Texture(A,D.colorRamp,O.RGBA)),G.bind(O.LINEAR,O.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(A,O.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,y.colorModeForRenderPass(),l.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")},D.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,D.paint,y.transform.zoom)}(h,c))},line:function(h,i,c,p){if("translucent"!==h.renderPass)return;const y=c.paint.get("line-opacity"),D=c.paint.get("line-width");if(0===y.constantOr(1)||0===D.constantOr(1))return;const A=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),O=h.colorModeForRenderPass(),z=h.terrain&&h.terrain.renderingToTexture?1:l.exported.devicePixelRatio,G=c.paint.get("line-dasharray"),W=G.constantOr(1),oe=c.layout.get("line-cap"),de=c.paint.get("line-pattern"),ge=de.constantOr(1),be=c.paint.get("line-gradient"),De=ge?"linePattern":"line",Oe=h.context,ae=Oe.gl,Te=(Ve=>{const bt=[];Ds(Ve)&&bt.push("RENDER_LINE_DASH"),Ve.paint.get("line-gradient")&&bt.push("RENDER_LINE_GRADIENT");const wt=Ve.paint.get("line-trim-offset");0===wt[0]&&0===wt[1]||bt.push("RENDER_LINE_TRIM_OFFSET");const dt=Ve.paint.get("line-pattern").constantOr(1),Lt=1!==Ve.paint.get("line-opacity").constantOr(1);return!dt&&Lt&&bt.push("RENDER_LINE_ALPHA_DISCARD"),bt})(c);let Ge=Te.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(Ge=!1);for(const Ve of p){const bt=i.getTile(Ve);if(ge&&!bt.patternsLoaded())continue;const wt=bt.getBucket(c);if(!wt)continue;h.prepareDrawTile();const dt=wt.programConfigurations.get(c.id),Lt=h.useProgram(De,dt,Te),Tt=de.constantOr(null);if(Tt&&bt.imageAtlas){const xn=bt.imageAtlas.patternPositions[Tt.toString()];xn&&dt.setConstantPatternPositions(xn)}const qt=G.constantOr(null),Rn=oe.constantOr(null);if(!ge&&qt&&Rn&&bt.lineAtlas){const xn=bt.lineAtlas.getDash(qt,Rn);xn&&dt.setConstantPatternPositions(xn)}let[Ht,Dn]=c.paint.get("line-trim-offset");("round"===Rn||"square"===Rn)&&Ht!==Dn&&(0===Ht&&(Ht-=1),1===Dn&&(Dn+=1));const sn=h.terrain?Ve.projMatrix:null,Ln=ge?rs(h,bt,c,sn,z):Oo(h,bt,c,sn,wt.lineClipsArray.length,z,[Ht,Dn]);if(be){const xn=wt.gradients[c.id];let Nn=xn.texture;if(c.gradientVersion!==xn.version){let An=256;if(c.stepInterpolant){const $n=i.getSource().maxzoom,Ar=Ve.canonical.z===$n?Math.ceil(1<<h.transform.maxZoom-Ve.canonical.z):1;An=l.clamp(l.nextPowerOfTwo(wt.maxLineLength/l.EXTENT*1024*Ar),256,Oe.maxTextureSize)}xn.gradient=l.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:An,image:xn.gradient||void 0,clips:wt.lineClipsArray}),xn.texture?xn.texture.update(xn.gradient):xn.texture=new l.Texture(Oe,xn.gradient,ae.RGBA),xn.version=c.gradientVersion,Nn=xn.texture}Oe.activeTexture.set(ae.TEXTURE1),Nn.bind(c.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}W&&(Oe.activeTexture.set(ae.TEXTURE0),bt.lineAtlasTexture.bind(ae.LINEAR,ae.REPEAT),dt.updatePaintBuffers()),ge&&(Oe.activeTexture.set(ae.TEXTURE0),bt.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),dt.updatePaintBuffers()),h.prepareDrawProgram(Oe,Lt,Ve.toUnwrapped());const Xt=xn=>{Lt.draw(Oe,ae.TRIANGLES,A,xn,O,l.CullFaceMode.disabled,Ln,c.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,c.paint,h.transform.zoom,dt,[wt.layoutVertexBuffer2])};if(Ge){const xn=h.stencilModeForClipping(Ve).ref;0===xn&&h.terrain&&Oe.clear({stencil:0});const Nn={func:ae.EQUAL,mask:255};Ln.u_alpha_discard_threshold=.8,Xt(new l.StencilMode(Nn,xn,255,ae.KEEP,ae.KEEP,ae.INVERT)),Ln.u_alpha_discard_threshold=0,Xt(new l.StencilMode(Nn,xn,255,ae.KEEP,ae.KEEP,ae.KEEP))}else Xt(h.stencilModeForClipping(Ve))}Ge&&(h.resetStencilClippingMasks(),h.terrain&&Oe.clear({stencil:0}))},fill:function(h,i,c,p){const y=c.paint.get("fill-color"),D=c.paint.get("fill-opacity");if(0===D.constantOr(1))return;const A=h.colorModeForRenderPass(),O=c.paint.get("fill-pattern"),z=h.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===y.constantOr(l.Color.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(h.renderPass===z){const G=h.depthModeForSublayer(1,"opaque"===h.renderPass?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);dc(h,i,c,p,G,A,!1)}if("translucent"===h.renderPass&&c.paint.get("fill-antialias")){const G=h.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);dc(h,i,c,p,G,A,!0)}},"fill-extrusion":function(h,i,c,p){const y=c.paint.get("fill-extrusion-opacity");if(0!==y&&"translucent"===h.renderPass){const D=new l.DepthMode(h.context.gl.LEQUAL,l.DepthMode.ReadWrite,h.depthRangeFor3D);if(1!==y||c.paint.get("fill-extrusion-pattern").constantOr(1))fa(h,i,c,p,D,l.StencilMode.disabled,l.ColorMode.disabled),fa(h,i,c,p,D,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const A=h.colorModeForRenderPass();fa(h,i,c,p,D,l.StencilMode.disabled,A)}}},hillshade:function(h,i,c,p){if("offscreen"!==h.renderPass&&"translucent"!==h.renderPass)return;const y=h.context,D=h.depthModeForSublayer(0,l.DepthMode.ReadOnly),A=h.colorModeForRenderPass(),O=h.terrain&&h.terrain.renderingToTexture,[z,G]="translucent"!==h.renderPass||O?[{},p]:h.stencilConfigForOverlap(p);for(const W of G){const oe=i.getTile(W);if(oe.needsHillshadePrepare&&"offscreen"===h.renderPass)js(h,oe,c,D,l.StencilMode.disabled,A);else if("translucent"===h.renderPass){const de=O&&h.terrain?h.terrain.stencilModeForRTTOverlap(W):z[W.overscaledZ];va(h,W,oe,c,D,de,A)}}y.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,i,c,p,y,D){if("translucent"!==h.renderPass||0===c.paint.get("raster-opacity")||!p.length)return;const A=h.context,O=A.gl,z=i.getSource(),G=h.useProgram("raster"),W=h.colorModeForRenderPass(),oe=h.terrain&&h.terrain.renderingToTexture,[de,ge]=z instanceof Fe||oe?[{},p]:h.stencilConfigForOverlap(p),be=ge[ge.length-1].overscaledZ,De=!h.options.moving;for(const Oe of ge){const ae=oe?l.DepthMode.disabled:h.depthModeForSublayer(Oe.overscaledZ-be,1===c.paint.get("raster-opacity")?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,O.LESS),Te=Oe.toUnwrapped(),Ge=i.getTile(Oe);if(oe&&(!Ge||!Ge.hasData()))continue;const Ve=oe?Oe.projMatrix:h.transform.calculateProjMatrix(Te,De),bt=h.terrain&&oe?h.terrain.stencilModeForRTTOverlap(Oe):de[Oe.overscaledZ],wt=D?0:c.paint.get("raster-fade-duration");Ge.registerFadeDuration(wt);const dt=i.findLoadedParent(Oe,0),Lt=Xo(Ge,dt,i,h.transform,wt);let Tt,qt;h.terrain&&h.terrain.prepareDrawTile();const Rn="nearest"===c.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;A.activeTexture.set(O.TEXTURE0),Ge.texture.bind(Rn,O.CLAMP_TO_EDGE),A.activeTexture.set(O.TEXTURE1),dt?(dt.texture.bind(Rn,O.CLAMP_TO_EDGE),Tt=Math.pow(2,dt.tileID.overscaledZ-Ge.tileID.overscaledZ),qt=[Ge.tileID.canonical.x*Tt%1,Ge.tileID.canonical.y*Tt%1]):Ge.texture.bind(Rn,O.CLAMP_TO_EDGE),Ge.texture.useMipmap&&A.extTextureFilterAnisotropic&&h.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax);const Ht=La(Ve,qt||[0,0],Tt||1,Lt,c,z instanceof Fe?z.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(A,G,Te),z instanceof Fe)z.boundsBuffer&&z.boundsSegments&&G.draw(A,O.TRIANGLES,ae,l.StencilMode.disabled,W,l.CullFaceMode.disabled,Ht,c.id,z.boundsBuffer,h.quadTriangleIndexBuffer,z.boundsSegments);else{const{tileBoundsBuffer:Dn,tileBoundsIndexBuffer:sn,tileBoundsSegments:Ln}=h.getTileBoundsBuffers(Ge);G.draw(A,O.TRIANGLES,ae,bt,W,l.CullFaceMode.disabled,Ht,c.id,Dn,sn,Ln)}}h.resetStencilClippingMasks()},background:function(h,i,c,p){const y=c.paint.get("background-color"),D=c.paint.get("background-opacity");if(0===D)return;const A=h.context,O=A.gl,z=h.transform,G=z.tileSize,W=c.paint.get("background-pattern");if(h.isPatternMissing(W))return;const oe=!W&&1===y.a&&1===D&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==oe)return;const de=l.StencilMode.disabled,ge=h.depthModeForSublayer(0,"opaque"===oe?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),be=h.colorModeForRenderPass(),De=h.useProgram(W?"backgroundPattern":"background");let Oe,ae=p;ae||(Oe=h.getBackgroundTiles(),ae=Object.values(Oe).map(Te=>Te.tileID)),W&&(A.activeTexture.set(O.TEXTURE0),h.imageManager.bind(h.context));for(const Te of ae){const Ge=Te.toUnwrapped(),Ve=p?Te.projMatrix:h.transform.calculateProjMatrix(Ge);h.prepareDrawTile();const bt=i?i.getTile(Te):Oe?Oe[Te.key]:new l.Tile(Te,G,z.zoom,h),wt=W?Ul(Ve,D,h,W,{tileID:Te,tileSize:G}):Fa(Ve,D,y);h.prepareDrawProgram(A,De,Ge);const{tileBoundsBuffer:dt,tileBoundsIndexBuffer:Lt,tileBoundsSegments:Tt}=h.getTileBoundsBuffers(bt);De.draw(A,O.TRIANGLES,ge,de,be,l.CullFaceMode.disabled,wt,c.id,dt,Lt,Tt)}},sky:function(h,i,c){const p=h.transform,y="mercator"===p.projection.name||"globe"===p.projection.name?1:l.smoothstep(7,8,p.zoom),D=c.paint.get("sky-opacity")*y;if(0===D)return;const A=h.context,O=c.paint.get("sky-type"),z=new l.DepthMode(A.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),G=h.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===h.renderPass?c.needsSkyboxCapture(h)&&(function(W,oe,de,ge){const be=W.context,De=be.gl;let Oe=oe.skyboxFbo;if(!Oe){Oe=oe.skyboxFbo=be.createFramebuffer(32,32,!1),oe.skyboxGeometry=new ea(be),oe.skyboxTexture=be.gl.createTexture(),De.bindTexture(De.TEXTURE_CUBE_MAP,oe.skyboxTexture),De.texParameteri(De.TEXTURE_CUBE_MAP,De.TEXTURE_WRAP_S,De.CLAMP_TO_EDGE),De.texParameteri(De.TEXTURE_CUBE_MAP,De.TEXTURE_WRAP_T,De.CLAMP_TO_EDGE),De.texParameteri(De.TEXTURE_CUBE_MAP,De.TEXTURE_MIN_FILTER,De.LINEAR),De.texParameteri(De.TEXTURE_CUBE_MAP,De.TEXTURE_MAG_FILTER,De.LINEAR);for(let Ve=0;Ve<6;++Ve)De.texImage2D(De.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,De.RGBA,32,32,0,De.RGBA,De.UNSIGNED_BYTE,null)}be.bindFramebuffer.set(Oe.framebuffer),be.viewport.set([0,0,32,32]);const ae=oe.getCenter(W,!0),Te=W.useProgram("skyboxCapture"),Ge=new Float64Array(16);l.identity(Ge),l.rotateY(Ge,Ge,.5*-Math.PI),B(be,oe,Te,Ge,ae,0),l.identity(Ge),l.rotateY(Ge,Ge,.5*Math.PI),B(be,oe,Te,Ge,ae,1),l.identity(Ge),l.rotateX(Ge,Ge,.5*-Math.PI),B(be,oe,Te,Ge,ae,2),l.identity(Ge),l.rotateX(Ge,Ge,.5*Math.PI),B(be,oe,Te,Ge,ae,3),l.identity(Ge),B(be,oe,Te,Ge,ae,4),l.identity(Ge),l.rotateY(Ge,Ge,Math.PI),B(be,oe,Te,Ge,ae,5),be.viewport.set([0,0,W.width,W.height])}(h,c),c.markSkyboxValid(h)):"sky"===h.renderPass&&function(W,oe,de,ge,be){const De=W.context,Oe=De.gl,ae=W.transform,Te=W.useProgram("skybox");De.activeTexture.set(Oe.TEXTURE0),Oe.bindTexture(Oe.TEXTURE_CUBE_MAP,oe.skyboxTexture);const Ge={u_matrix:ae.skyboxMatrix,u_sun_direction:oe.getCenter(W,!1),u_cubemap:0,u_opacity:ge,u_temporal_offset:be};W.prepareDrawProgram(De,Te),Te.draw(De,Oe.TRIANGLES,de,l.StencilMode.disabled,W.colorModeForRenderPass(),l.CullFaceMode.backCW,Ge,"skybox",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(h,c,z,D,G):"gradient"===O&&"sky"===h.renderPass&&function(W,oe,de,ge,be){const De=W.context,Oe=De.gl,ae=W.transform,Te=W.useProgram("skyboxGradient");oe.skyboxGeometry||(oe.skyboxGeometry=new ea(De)),De.activeTexture.set(Oe.TEXTURE0);let Ge=oe.colorRampTexture;Ge||(Ge=oe.colorRampTexture=new l.Texture(De,oe.colorRamp,Oe.RGBA)),Ge.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE);const Ve=(bt=ae.skyboxMatrix,wt=oe.getCenter(W,!1),dt=oe.paint.get("sky-gradient-radius"),Lt=ge,Tt=be,{u_matrix:bt,u_color_ramp:0,u_center_direction:wt,u_radius:l.degToRad(dt),u_opacity:Lt,u_temporal_offset:Tt});var bt,wt,dt,Lt,Tt;W.prepareDrawProgram(De,Te),Te.draw(De,Oe.TRIANGLES,de,l.StencilMode.disabled,W.colorModeForRenderPass(),l.CullFaceMode.backCW,Ve,"skyboxGradient",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(h,c,z,D,G)},debug:function(h,i,c){for(let p=0;p<c.length;p++)fc(h,i,c[p])},custom:function(h,i,c,p){const y=h.context,D=c.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||"offscreen"===h.renderPass)&&c.isLayerDraped()){if("offscreen"===h.renderPass){const A=D.prerender;if(A){if(h.setCustomLayerDefaults(),y.setColorMode(h.colorModeForRenderPass()),"globe"===h.transform.projection.name){const O=h.transform.pointMerc;A.call(D,y.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(h.transform.zoom),[O.x,O.y],h.transform.pixelsPerMeterRatio)}else A.call(D,y.gl,h.transform.customLayerMatrix());y.setDirty(),h.setBaseState()}}else if("translucent"===h.renderPass){if(h.terrain&&h.terrain.renderingToTexture){const O=D.renderToTile;if(O){const z=p[0].canonical,G=new l.MercatorCoordinate(z.x+p[0].wrap*(1<<z.z),z.y,z.z);y.setDepthMode(l.DepthMode.disabled),y.setStencilMode(l.StencilMode.disabled),y.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),O.call(D,y.gl,G),y.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),y.setColorMode(h.colorModeForRenderPass()),y.setStencilMode(l.StencilMode.disabled);const A="3d"===D.renderingMode?new l.DepthMode(h.context.gl.LEQUAL,l.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,l.DepthMode.ReadOnly);if(y.setDepthMode(A),"globe"===h.transform.projection.name){const O=h.transform.pointMerc;D.render(y.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(h.transform.zoom),[O.x,O.y],h.transform.pixelsPerMeterRatio)}else D.render(y.gl,h.transform.customLayerMatrix());y.setDirty(),h.setBaseState(),y.bindFramebuffer.set(null)}}else l.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Re{constructor(i,c,p=!1){this.context=new pn(i,p),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,c){const p=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new P(this,i));const y=this._terrain;this.transform.elevation=p?y:null,y.update(i,this.transform,c)}_updateFog(i){const c=i.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=c.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const D=p+.78*(y-p);this.transform.fogCullDistSq=D*D}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,c){if(this.width=i*l.exported.devicePixelRatio,this.height=c*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const i=this.context,c=new l.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(c,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const p=new l.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(l.EXTENT,0),p.emplaceBack(0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(p,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const y=new l.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(y,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const D=new l.StructArrayLayout4i8;D.emplaceBack(0,0,0,0),D.emplaceBack(l.EXTENT,0,l.EXTENT,0),D.emplaceBack(0,l.EXTENT,0,l.EXTENT),D.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(D,l.boundsAttributes.members),this.mercatorBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const A=new l.StructArrayLayout3ui6;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(A);const O=new l.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])O.emplaceBack(G);this.debugIndexBuffer=i.createIndexBuffer(O),this.emptyTexture=new l.Texture(i,new l.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=l.create();const z=this.context.gl;this.stencilClearMode=new l.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(l.window.performance.now()),this.atmosphereBuffer=new qe(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,c.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,us(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,p){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!p||0===p.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const z of p)if(void 0===this._tileClippingMaskIDs[z.key]){O=!0;break}if(!O)return}this.currentStencilSource=c.id;const y=this.context,D=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(l.ColorMode.disabled),y.setDepthMode(l.DepthMode.disabled);const A=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of p){const z=c.getTile(O),G=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:oe,tileBoundsSegments:de}=this.getTileBoundsBuffers(z);A.draw(y,D.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:D.ALWAYS,mask:0},G,255,D.KEEP,D.KEEP,D.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,us(O.projMatrix),"$clipping",W,oe,de)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new l.StencilMode({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new l.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,p=i.sort((A,O)=>O.overscaledZ-A.overscaledZ),y=p[p.length-1].overscaledZ,D=p[0].overscaledZ-y+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const A={};for(let O=0;O<D;O++)A[O+y]=new l.StencilMode({func:c.GEQUAL,mask:255},O+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=D,[A,p]}return[{[y]:l.StencilMode.disabled},p]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new l.ColorMode([i.CONSTANT_COLOR,i.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(i,c,p){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new l.DepthMode(p||this.context.gl.LEQUAL,c,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){this.style=i,this.options=c,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const p=this.style.order,y=this.style._sourceCaches;for(const G in y){const W=y[G];W.used&&W.prepare(this.context)}const D={},A={},O={};for(const G in y){const W=y[G];D[G]=W.getVisibleCoordinates(),A[G]=D[G].slice().reverse(),O[G]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<p.length;G++)if(this.style._layers[p[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new l.GlobeSharedBuffers(this.context)),!l.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of p){const W=this.style._layers[G],oe=i._getLayerSourceCache(W);if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;const de=oe?A[oe.id]:void 0;("custom"===W.type||W.isSky()||de&&de.length)&&this.renderLayer(this,oe,W,de)}this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon];const z=this.terrain;if(z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&z.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[p[this.currentLayer]],W=i._getLayerSourceCache(G);if(G.isSky())continue;const oe=W?A[W.id]:void 0;this._renderTileClippingMasks(G,W,oe),this.renderLayer(this,W,G,oe)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,W){const oe=G.context,de=oe.gl,ge=G.transform,be=new l.DepthMode(de.LEQUAL,l.DepthMode.ReadOnly,[0,1]),De=G.useProgram("globeAtmosphere",null,"globe"===ge.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Oe=l.globeToMercatorTransition(ge.zoom),ae=W.properties.get("color").toArray01(),Te=W.properties.get("high-color").toArray01(),Ge=W.properties.get("space-color").toArray01PremultipliedAlpha(),Ve=l.identity$1([]);l.rotateY$1(Ve,Ve,-l.degToRad(ge._center.lng)),l.rotateX$1(Ve,Ve,l.degToRad(ge._center.lat)),l.rotateZ$1(Ve,Ve,ge.angle),l.rotateX$1(Ve,Ve,-ge._pitch);const bt=l.fromQuat(new Float32Array(16),Ve),wt=l.mapValue(W.properties.get("star-intensity"),0,1,0,.25),Lt=l.mapValue(W.properties.get("horizon-blend"),0,1,5e-4,.25),Tt=l.globeUseCustomAntiAliasing(G,oe,ge)&&5e-4===Lt?ge.worldSize/(2*Math.PI*1.025)-1:ge.globeRadius,qt=G.frameCounter/1e3%1,Rn=l.length(ge.globeCenterInViewSpace),Ht=Math.sqrt(Math.pow(Rn,2)-Math.pow(Tt,2)),Dn=Math.acos(Ht/Rn),sn={u_frustum_tl:ge.frustumCorners.TL,u_frustum_tr:ge.frustumCorners.TR,u_frustum_br:ge.frustumCorners.BR,u_frustum_bl:ge.frustumCorners.BL,u_horizon:ge.frustumCorners.horizon,u_transition:Oe,u_fadeout_range:Lt,u_color:ae,u_high_color:Te,u_space_color:Ge,u_star_intensity:wt,u_star_size:5*l.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:qt,u_horizon_angle:Dn,u_rotation_matrix:bt};G.prepareDrawProgram(oe,De);const Ln=G.atmosphereBuffer;Ln&&De.draw(oe,de.TRIANGLES,be,l.StencilMode.disabled,l.ColorMode.alphaBlended,l.CullFaceMode.backCW,sn,"skybox",Ln.vertexBuffer,Ln.indexBuffer,Ln.segments)}(this,this.style.fog),this.renderPass="sky",(l.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const G=this.style._layers[p[this.currentLayer]],W=i._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,W,G,W?A[W.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const G=this.style._layers[p[this.currentLayer]],W=i._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const oe=W?("symbol"===G.type?O:A)[W.id]:void 0;this._renderTileClippingMasks(G,W,W?D[W.id]:void 0),this.renderLayer(this,W,G,oe),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;l.values(this.style._layers).forEach(W=>{const oe=i._getLayerSourceCache(W);oe&&!W.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<oe.getSource().maxzoom)&&(G=oe)}),G&&this.options.showTileBoundaries&&Z.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const W=G.transform.padding;Hl(G,G.transform.height-(W.top||0),3,ll),Hl(G,W.bottom||0,3,qa),Ea(G,W.left||0,3,hc),Ea(G,G.transform.width-(W.right||0),3,Ic);const oe=G.transform.centerPoint;var de,ge,be,De;Qs(de=G,(ge=oe.x)-1,(be=G.transform.height-oe.y)-10,2,20,De=Mc),Qs(de,ge-10,be-1,20,2,De)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}renderLayer(i,c,p,y){p.isHidden(this.transform.zoom)||("background"===p.type||"sky"===p.type||"custom"===p.type||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes(p.type)||i.terrain&&"custom"===p.type)&&Z[p.type](i,c,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[i.id];p||(p=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,c=i.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),i.beginQueryEXT(i.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const c={};for(const p in i){const y=i[p],D=this.context.extTimerQuery,A=D.getQueryObjectEXT(y.query,D.QUERY_RESULT_EXT)/1e6;D.deleteQueryEXT(y.query),c[p]=A}return c}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let p=0;for(const y of i)p+=c.getQueryObjectEXT(y,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(y);return p}translatePosMatrix(i,c,p,y,D){if(!p[0]&&!p[1])return i;const A=D?"map"===y?this.transform.angle:0:"viewport"===y?-this.transform.angle:0;if(A){const G=Math.sin(A),W=Math.cos(A);p=[p[0]*W-p[1]*G,p[0]*G+p[1]*W]}const O=[D?p[0]:Pn(c,p[0],this.transform.zoom),D?p[1]:Pn(c,p[1],this.transform.zoom),0],z=new Float32Array(16);return l.translate(z,i,O),z}saveTileTexture(i){const c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){return null===i||void 0!==i&&!this.imageManager.getPattern(i.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),p=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),"globe"===this.transform.projection.name&&y.push("GLOBE"),c&&y.push("ZERO_EXAGGERATION"),p&&!i&&0!==p.getOpacity(this.transform.pitch)&&y.push("FOG"),i&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(i,c,p){this.cache=this.cache||{};const y=p||[],D=this.currentGlobalDefines().concat(y),A=K.cacheKey(ts[i],i,D,c);return this.cache[A]||(this.cache[A]=new K(this.context,i,ts[i],c,Ls[i],D)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const D=y.getOpacity(this.transform.pitch),A=((O,z,G,W,oe,de,ge,be,De,Oe,ae)=>{const Te=O.transform,Ge=z.properties.get("color").toArray01();Ge[3]=W;const Ve=O.frameCounter/1e3%1;return{u_fog_matrix:G?Te.calculateFogTileMatrix(G):O.identityMat,u_fog_range:z.getFovAdjustedRange(Te._fov),u_fog_color:Ge,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_temporal_offset:Ve,u_frustum_tl:oe,u_frustum_tr:de,u_frustum_br:ge,u_frustum_bl:be,u_globe_pos:De,u_globe_radius:Oe,u_viewport:ae,u_globe_transition:l.globeToMercatorTransition(Te.zoom),u_is_globe:+("globe"===Te.projection.name)}})(this,y,p,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*l.exported.devicePixelRatio,this.transform.height*l.exported.devicePixelRatio]);c.setFogUniformValues(i,A)}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)c[y.key]=i[y.key]||new l.Tile(y,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class vt{constructor(i=0,c=0,p=0,y=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=p,this.right=y}interpolate(i,c,p){return null!=c.top&&null!=i.top&&(this.top=l.number(i.top,c.top,p)),null!=c.bottom&&null!=i.bottom&&(this.bottom=l.number(i.bottom,c.bottom,p)),null!=c.left&&null!=i.left&&(this.left=l.number(i.left,c.left,p)),null!=c.right&&null!=i.right&&(this.right=l.number(i.right,c.right,p)),this}getCenter(i,c){const p=l.clamp((this.left+i-this.right)/2,0,i),y=l.clamp((this.top+c-this.bottom)/2,0,c);return new l.Point(p,y)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new vt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function vn(h,i){const c=l.getColumn(h,3);l.fromQuat(h,i),l.setColumn(h,3,c)}function Sn(h,i){const c=l.identity$1([]);return l.rotateZ$1(c,c,-i),l.rotateX$1(c,c,-h),c}function Er(h,i){const c=[h[0],h[1],0],p=[i[0],i[1],0];if(l.length(c)>=1e-15){const A=l.normalize([],c);l.scale$2(p,A,l.dot(p,A)),i[0]=p[0],i[1]=p[1]}const y=l.cross([],i,h);if(l.len(y)<1e-15)return null;const D=Math.atan2(-y[1],y[0]);return Sn(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),D)}class vi{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){if(i){const c=i instanceof l.MercatorCoordinate?i:new l.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(c.x=l.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const p=this.position,y=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(i)):0,D=l.MercatorCoordinate.fromLngLat(i,y),A=[D.x-p.x,D.y-p.y,D.z-p.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Er(A,c)}setPitchBearing(i,c){this.orientation=Sn(l.degToRad(i),l.degToRad(-c))}}class xi{constructor(i,c){this._transform=l.identity([]),this.orientation=c,this.position=i}get mercatorPosition(){const i=this.position;return new l.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=l.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var c;i&&l.setColumn(this._transform,3,[(c=i)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||l.identity$1([]),i&&vn(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=Sn(i,c),vn(this._transform,this._orientation)}forward(){const i=l.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=l.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=l.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const p=new Float64Array(16);return l.invert(p,this.getWorldToCamera(i,c)),p}getWorldToCameraPosition(i,c,p){const y=this.position;l.scale$2(y,y,-i);const D=new Float64Array(16);return l.fromScaling(D,[p,p,p]),l.translate(D,D,y),D[10]*=c,D}getWorldToCamera(i,c){const p=new Float64Array(16),y=new Float64Array(4),D=this.position;return l.conjugate(y,this._orientation),l.scale$2(D,D,-i),l.fromQuat(p,y),l.translate(p,p,D),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(i,c,p,y){const D=new Float64Array(16);return l.perspective(D,i,c,p,y),D}getDistanceToElevation(i,c=!1){const p=0===i?0:l.mercatorZfromAltitude(i,c?l.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(p-this.position[2])/y[2]}clone(){return new xi([...this.position],[...this.orientation])}}function Br(h,i){const c=Ei(h.projection,h.zoom,h.width,h.height),p=function(D,A,O,z,G){const W=new l.LngLat(O.lng-180*ki,O.lat),oe=new l.LngLat(O.lng+180*ki,O.lat),de=D.project(W.lng,W.lat),ge=D.project(oe.lng,oe.lat),be=-Math.atan2(ge.y-de.y,ge.x-de.x),De=l.MercatorCoordinate.fromLngLat(O);De.y=l.clamp(De.y,-1+ki,1-ki);const Oe=De.toLngLat(),ae=D.project(Oe.lng,Oe.lat),Te=l.MercatorCoordinate.fromLngLat(Oe);Te.x+=ki;const Ge=Te.toLngLat(),Ve=D.project(Ge.lng,Ge.lat),bt=Ps(Ve.x-ae.x,Ve.y-ae.y,be),wt=l.MercatorCoordinate.fromLngLat(Oe);wt.y+=ki;const dt=wt.toLngLat(),Lt=D.project(dt.lng,dt.lat),Tt=Ps(Lt.x-ae.x,Lt.y-ae.y,be),qt=Math.abs(bt.x)/Math.abs(Tt.y),Rn=l.identity([]);l.rotateZ(Rn,Rn,-be*(1-(G?0:z)));const Ht=l.identity([]);return l.scale(Ht,Ht,[1,1-(1-qt)*z,1]),Ht[4]=-Tt.x/Tt.y*z,l.rotateZ(Ht,Ht,be),l.multiply(Ht,Rn,Ht),Ht}(h.projection,0,h.center,c,i),y=eo(h);return l.scale(p,p,[y,y,1]),p}function eo(h){const i=h.projection,c=Ei(h.projection,h.zoom,h.width,h.height),p=ko(i,h.center),y=ko(i,l.LngLat.convert(i.center));return Math.pow(2,p*c+(1-c)*y)}function Ei(h,i,c,p,y=1/0){const D=h.range;if(!D)return 0;const A=Math.min(y,Math.max(c,p)),O=Math.log(A/1024)/Math.LN2;return l.smoothstep(D[0]+O,D[1]+O,i)}const ki=1/4e4;function ko(h,i){const c=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=new l.LngLat(i.lng-180*ki,c),y=new l.LngLat(i.lng+180*ki,c),D=h.project(p.lng,c),A=h.project(y.lng,c),O=l.MercatorCoordinate.fromLngLat(p),z=l.MercatorCoordinate.fromLngLat(y),G=A.x-D.x,W=A.y-D.y,oe=z.x-O.x,de=z.y-O.y,ge=Math.sqrt((oe*oe+de*de)/(G*G+W*W));return Math.log(ge)/Math.LN2}function Ps(h,i,c){const p=Math.cos(c),y=Math.sin(c);return{x:h*p-i*y,y:h*y+i*p}}class ta{constructor(i,c,p,y,D,A,O){this.tileSize=512,this._renderWorldCopies=void 0===D||D,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=y??60,this.setProjection(A),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new vt,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new xi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const i=new ta(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i,c=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||p)&&this._updateCameraOnTerrain(),(i||p)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return l.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=l.getProjection(this.projectionOptions);const p=!_e(c,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=l.getProjection({name:"mercator"});const c=i!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return l.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;var p,y,D,A,O,z,G,W,oe,de;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),y=this.rotationMatrix,A=this.angle,O=(D=this.rotationMatrix)[0],z=D[1],G=D[2],W=D[3],oe=Math.sin(A),de=Math.cos(A),y[0]=O*de+G*oe,y[1]=z*de+W*oe,y[2]=O*-oe+G*de,y[3]=z*-oe+W*de)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=l.degToRad(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,D=0;for(let A=0;A<c.length;A++){const O=new l.Point(c[A][0]*this.width,p+c[A][1]*(this.height-p)),z=i.pointCoordinate(O);if(!z)continue;const G=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);y+=z[3]*G,D+=G}return 0===D?NaN:y/D}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,y=this._mercatorZfromZoom(i),D=this._mercatorZfromZoom(this._maxZoom),A=Math.max(y-p,D);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let p;p=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const y=l.length(l.sub([],this._camera.position,p));return l.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!l.exactEquals(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const p=[i.position.x,i.position.y,i.position.z];l.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new vi;return c.position=new l.MercatorCoordinate(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!l.length$1(i))return!1;l.normalize$1(i,i);const c=l.transformQuat([],[0,0,-1],i),p=l.transformQuat([],[0,-1,0],i);if(p[2]<0)return!1;const y=Er(c,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;i[2]=l.clamp(i[2],y/p,y/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,p){this._unmodified=!1,this._edgeInsets.interpolate(i,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new l.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const p=this.pointCoordinate(new l.Point(0,0)),y=this.pointCoordinate(new l.Point(this.width,0)),D=this.pointCoordinate(new l.Point(this.width,this.height)),A=this.pointCoordinate(new l.Point(0,this.height)),O=Math.floor(Math.min(p.x,y.x,D.x,A.x)),z=Math.floor(Math.max(p.x,y.x,D.x,A.x)),G=1;for(let W=O-G;W<=z+G;W++)0!==W&&c.push(new l.UnwrappedTileID(W,i))}return c}coveringTiles(i){let c=this.coveringZoomLevel(i);const p=c,y=this.elevation&&!i.isTerrainDEM,D="mercator"===this.projection.name;if(void 0!==i.minzoom&&c<i.minzoom)return[];void 0!==i.maxzoom&&c>i.maxzoom&&(c=i.maxzoom);const A=this.locationCoordinate(this.center),O=this.center.lat,z=1<<c,G=[z*A.x,z*A.y,0],W="globe"===this.projection.name,oe=!W,de=l.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,oe),ge=W?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),be=z*l.mercatorZfromAltitude(1,this.center.lat),De=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),Oe=[z*ge.x,z*ge.y,De*(oe?1:be)],ae=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),Te=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,Ge=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ve=i.isTerrainDEM?-Ge:this._elevation?this._elevation.getMinElevationBelowMSL():0,bt=this.projection.isReprojectedInTileSpace?eo(this):1,wt=Xt=>{const Nn=new l.MercatorCoordinate(Xt.x+25e-6,Xt.y,Xt.z),An=new l.MercatorCoordinate(Xt.x,Xt.y+25e-6,Xt.z),$n=Xt.toLngLat(),Ar=Nn.toLngLat(),Xr=An.toLngLat(),ur=this.locationCoordinate($n),$r=this.locationCoordinate(Ar),mi=this.locationCoordinate(Xr),fi=Math.hypot($r.x-ur.x,$r.y-ur.y),xr=Math.hypot(mi.x-ur.x,mi.y-ur.y);return Math.sqrt(fi*xr)*bt/25e-6},dt=Xt=>{const xn=Ge,Nn=Ve;return{aabb:l.tileAABB(this,z,0,0,0,Xt,Nn,xn,this.projection),zoom:0,x:0,y:0,minZ:Nn,maxZ:xn,wrap:Xt,fullyVisible:!1}},Lt=[];let Tt=[];const qt=c,Rn=i.reparseOverscaled?p:c,Ht=Xt=>Xt*Xt,Dn=Ht((De-this._centerAltitude)*be),sn=Xt=>{if(!this._elevation||!Xt.tileID||!D)return;const xn=this._elevation.getMinMaxForTile(Xt.tileID),Nn=Xt.aabb;xn?(Nn.min[2]=xn.min,Nn.max[2]=xn.max,Nn.center[2]=(Nn.min[2]+Nn.max[2])/2):(Xt.shouldSplit=Ln(Xt),Xt.shouldSplit||(Nn.min[2]=Nn.max[2]=Nn.center[2]=this._centerAltitude))},Ln=Xt=>{if(Xt.zoom<Te)return!0;if(Xt.zoom===qt)return!1;if(null!=Xt.shouldSplit)return Xt.shouldSplit;const xn=Xt.aabb.distanceX(Oe),Nn=Xt.aabb.distanceY(Oe);let An=Dn,$n=1;if(W){An=Ht(Xt.aabb.distanceZ(Oe));const ur=Math.pow(2,Xt.zoom),$r=l.latFromMercatorY((Xt.y+1)/ur),mi=l.latFromMercatorY(Xt.y/ur),fi=Math.min(Math.max(O,$r),mi),xr=l.circumferenceAtLatitude(fi)/l.circumferenceAtLatitude(O);if($n=fi===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,xr/this._mercatorScaleRatio),this.zoom<=l.GLOBE_ZOOM_THRESHOLD_MIN&&Xt.zoom===qt-1&&xr>=.9)return!0}else if(y&&(An=Ht(Xt.aabb.distanceZ(Oe)*be)),this.projection.isReprojectedInTileSpace&&p<=5){const ur=Math.pow(2,Xt.zoom),$r=wt(new l.MercatorCoordinate((Xt.x+.5)/ur,(Xt.y+.5)/ur));$n=$r>.85?1:$r}const Ar=xn*xn+Nn*Nn+An;return Ar<Ht((1<<qt-Xt.zoom)*ae*$n*((ur,$r)=>{if($r*Ht(.707)<ur)return 1;const mi=Math.sqrt($r/ur);return mi/(1.4144271570014144+(Math.pow(1.1,mi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(An,Dn),Ar))};if(this.renderWorldCopies)for(let Xt=1;Xt<=3;Xt++)Lt.push(dt(-Xt)),Lt.push(dt(Xt));for(Lt.push(dt(0));Lt.length>0;){const Xt=Lt.pop(),xn=Xt.x,Nn=Xt.y;let An=Xt.fullyVisible;if(!An){const $n=Xt.aabb.intersects(de);if(0===$n)continue;An=2===$n}if(Xt.zoom!==qt&&Ln(Xt))for(let $n=0;$n<4;$n++){const Ar=(xn<<1)+$n%2,Xr=(Nn<<1)+($n>>1),ur={aabb:D?Xt.aabb.quadrant($n):l.tileAABB(this,z,Xt.zoom+1,Ar,Xr,Xt.wrap,Xt.minZ,Xt.maxZ,this.projection),zoom:Xt.zoom+1,x:Ar,y:Xr,wrap:Xt.wrap,fullyVisible:An,tileID:void 0,shouldSplit:void 0,minZ:Xt.minZ,maxZ:Xt.maxZ};y&&!W&&(ur.tileID=new l.OverscaledTileID(Xt.zoom+1===qt?Rn:Xt.zoom+1,Xt.wrap,Xt.zoom+1,Ar,Xr),sn(ur)),Lt.push(ur)}else{const $n=Xt.zoom===qt?Rn:Xt.zoom;if(i.minzoom&&i.minzoom>$n)continue;const Ar=G[0]-(.5+xn+(Xt.wrap<<Xt.zoom))*(1<<c-Xt.zoom),Xr=G[1]-.5-Nn,ur=Xt.tileID?Xt.tileID:new l.OverscaledTileID($n,Xt.wrap,Xt.zoom,xn,Nn);Tt.push({tileID:ur,distanceSq:Ar*Ar+Xr*Xr})}}if(this.fogCullDistSq){const Xt=this.fogCullDistSq,xn=this.horizonLineFromTop();Tt=Tt.filter(Nn=>{const An=[0,0,0,1],$n=[l.EXTENT,l.EXTENT,0,1],Ar=this.calculateFogTileMatrix(Nn.tileID.toUnwrapped());l.transformMat4$1(An,An,Ar),l.transformMat4$1($n,$n,Ar);const Xr=l.getAABBPointSquareDist(An,$n);if(0===Xr)return!0;let ur=!1;const $r=this._elevation;if($r&&Xr>Xt&&0!==xn){const mi=this.calculateProjMatrix(Nn.tileID.toUnwrapped());let fi;i.isTerrainDEM||(fi=$r.getMinMaxForTile(Nn.tileID)),fi||(fi={min:Ve,max:Ge});const xr=l.furthestTileCorner(this.rotation),Yi=[xr[0]*l.EXTENT,xr[1]*l.EXTENT,fi.max];l.transformMat4(Yi,Yi,mi),ur=(1-Yi[1])*this.height*.5<xn}return Xr<Xt||ur})}return Tt.sort((Xt,xn)=>Xt.distanceSq-xn.distanceSq).map(Xt=>Xt.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const c=l.clamp(i.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=this.projection.project(i.lng,c);return new l.Point(p.x*this.worldSize,p.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/l.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,c){let p,y;const D=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;p=(c.x-D.x)/O,y=(c.y-D.y)/O}else{const O=this.pointCoordinate(c),z=this.pointCoordinate(D);p=O.x-z.x,y=O.y-z.y}const A=this.locationCoordinate(i);this.setLocation(new l.MercatorCoordinate(A.x-p,A.y-y))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,c){const p=c?l.mercatorZfromAltitude(c,i.lat):void 0,y=this.projection.project(i.lng,i.lat);return new l.MercatorCoordinate(y.x,y.y,p)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const p=c??this._centerAltitude,y=[i.x,i.y,0,1],D=[i.x,i.y,1,1];l.transformMat4$1(y,y,this.pixelMatrixInverse),l.transformMat4$1(D,D,this.pixelMatrixInverse);const A=D[3];l.scale$1(y,y,1/y[3]),l.scale$1(D,D,1/A);const O=y[2],z=D[2];return{p0:y,p1:D,t:O===z?0:(p-O)/(z-O)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],p=[i.x,i.y,1,1];return l.transformMat4$1(c,c,this.pixelMatrixInverse),l.transformMat4$1(p,p,this.pixelMatrixInverse),l.scale$1(c,c,1/c[3]),l.scale$1(p,p,1/p[3]),c[2]=l.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=l.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,l.scale$1(c,c,1/this.worldSize),l.scale$1(p,p,1/this.worldSize),new l.Ray([c[0],c[1],c[2]],l.normalize([],l.sub([],p,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:p,t:y}=i,D=l.mercatorZfromAltitude(c[2],this._center.lat),A=l.mercatorZfromAltitude(p[2],this._center.lat);return new l.MercatorCoordinate(l.number(c[0],p[0],y)/this.worldSize,l.number(c[1],p[1],y)/this.worldSize,l.number(D,A,y))}pointCoordinate(i,c=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,c)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let c=this.projection.pointCoordinate3D(this,i.x,i.y);if(c)return new l.MercatorCoordinate(c[0],c[1],c[2]);let p=0,y=this.horizonLineFromTop();if(i.y>y)return this.pointCoordinate(i);const D=.02*y,A=i.clone();for(let O=0;O<10&&y-p>D;O++){A.y=l.number(p,y,.66);const z=this.projection.pointCoordinate3D(this,A.x,A.y);z?(y=A.y,c=z):p=A.y}return c?new l.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}isPointOnSurface(i){if(i.y<0||i.y>this.height||i.x<0||i.x>this.width)return!1;if(this.elevation||this.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(i);const c=this.pointCoordinate(i);return c.y>=0&&c.y<=1}_coordinatePoint(i,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,y=[i.x*this.worldSize,i.y*this.worldSize,p+i.toAltitude(),1];return l.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new l.Point(y[0]/y[3],y[1]/y[3]):new l.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:c}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,D=this.pointLocation3D(new l.Point(c,i)),A=this.pointLocation3D(new l.Point(y,i)),O=this.pointLocation3D(new l.Point(y,p)),z=this.pointLocation3D(new l.Point(c,p));let G=Math.min(D.lng,A.lng,O.lng,z.lng),W=Math.max(D.lng,A.lng,O.lng,z.lng),oe=Math.min(D.lat,A.lat,O.lat,z.lat),de=Math.max(D.lat,A.lat,O.lat,z.lat);const ge=Math.pow(2,-this.zoom)/16*270,be="globe"===this.projection.name?1:4,De=(Oe,ae,Te,Ge,Ve)=>{const bt=(Oe+Te)/2,wt=(ae+Ge)/2,dt=new l.Point(bt,wt),{lng:Lt,lat:Tt}=this.pointLocation3D(dt),qt=Math.max(0,G-Lt,oe-Tt,Lt-W,Tt-de);G=Math.min(G,Lt),W=Math.max(W,Lt),oe=Math.min(oe,Tt),de=Math.max(de,Tt),(Ve<be||qt>ge)&&(De(Oe,ae,bt,wt,Ve+1),De(bt,wt,Te,Ge,Ve+1))};if(De(c,i,y,i,1),De(y,i,y,p,1),De(y,p,c,p,1),De(c,p,c,i,1),"globe"===this.projection.name){const[Oe,ae]=l.polesInViewport(this);Oe?(de=90,W=180,G=-180):ae&&(oe=-90,W=180,G=-180)}return new l.LngLatBounds(new l.LngLat(G,oe),new l.LngLat(W,de))}_getBoundsRectangular(i,c){const{top:p,left:y}=this._edgeInsets,D=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,O=new l.Point(y,p),z=new l.Point(A,p),G=new l.Point(A,D),W=new l.Point(y,D);let oe=this.pointCoordinate(O,i),de=this.pointCoordinate(z,i);const ge=this.pointCoordinate(G,c),be=this.pointCoordinate(W,c),De=(Oe,ae)=>(ae.y-Oe.y)/(ae.x-Oe.x);return oe.y>1&&de.y>=0?oe=new l.MercatorCoordinate((1-be.y)/De(be,oe)+be.x,1):oe.y<0&&de.y<=1&&(oe=new l.MercatorCoordinate(-be.y/De(be,oe)+be.x,0)),de.y>1&&oe.y>=0?de=new l.MercatorCoordinate((1-ge.y)/De(ge,de)+ge.x,1):de.y<0&&oe.y<=1&&(de=new l.MercatorCoordinate(-ge.y/De(ge,de)+ge.x,0)),(new l.LngLatBounds).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(be)).extend(this.coordinateLocation(ge))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=i.visibleDemTiles.reduce((p,y)=>{if(y.dem){const D=y.dem.tree;p.min=Math.min(p.min,D.minimums[0]),p.max=Math.max(p.max,D.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-l.MAX_MERCATOR_LATITUDE,this.maxLat=l.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=l.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=l.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=l.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=l.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileMatrix(this,c,i)}calculateDistanceTileData(i){const c=i.key,p=this._distanceTileDataCache;if(p[c])return p[c];const y=i.canonical,D=1/this.height,A=this.cameraWorldSize,O=A/this.zoomScale(y.z),z=(y.x+Math.pow(2,y.z)*i.wrap)*O,G=y.y*O,W=this.point;W.x*=A/this.worldSize,W.y*=A/this.worldSize;const oe=this.angle,de=Math.sin(-oe),ge=-Math.cos(-oe);return p[c]={bearing:[de,ge],center:[(W.x-z)*D,(W.y-G)*D],scale:O/l.EXTENT*D},p[c]}calculateFogTileMatrix(i){const c=i.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return l.multiply(y,this.worldToFogMatrix,y),p[c]=new Float32Array(y),p[c]}calculateProjMatrix(i,c=!1){const p=i.key,y=c?this._alignedProjMatrixCache:this._projMatrixCache;if(y[p])return y[p];const D=this.calculatePosMatrix(i,this.worldSize);return l.multiply(D,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,D),y[p]=new Float32Array(D),y[p]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const y=function(D,A){const{scale:O}=D.tileTransform,z=O*l.EXTENT/(D.tileSize*Math.pow(2,A.zoom-D.tileID.overscaledZ+D.tileID.canonical.z));return G=new Float32Array(4),de=(W=A.inverseAdjustmentMatrix)[1],ge=W[2],be=W[3],Oe=(oe=[z,z])[1],G[0]=W[0]*(De=oe[0]),G[1]=de*De,G[2]=ge*Oe,G[3]=be*Oe,G;var G,W,oe,de,ge,be,De,Oe}(i,this);return p[c]=y,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const i=1/this.worldSize,c=l.fromScaling([],[i,i,i]);return l.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const c=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),y=this._camera.forward(),D=l.mercatorZfromAltitude(1,this._center.lat);p[2]/=D,y[2]/=D,l.normalize(y,y);const A=i.raycast(p,y,i.exaggeration());if(A){const O=l.scaleAndAdd([],p,y,A),z=new l.MercatorCoordinate(O[0],O[1],l.mercatorZfromAltitude(O[2],l.latFromMercatorY(O[1]))),G=(z.z+l.length([z.x-p[0],z.y-p[1],z.z-p[2]*D]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const c=this._elevation,p=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(p),D=c.getAtPointOrZero(new l.MercatorCoordinate(...y)),A=this.pixelsPerMeter/this.worldSize*D,O=this._minimumHeightOverTerrain(),z=y[2]-A;if(z<=O)if(z<0||i){const G=this.locationCoordinate(this._center,this._centerAltitude),W=[y[0],y[1],G.z-y[2]],oe=l.length(W);W[2]-=(O-z)/this._pixelsPerMercatorPixel;const de=l.length(W);if(0===de)return;l.scale$2(W,W,oe/de*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],G.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const de=this.center;return de.lat=l.clamp(de.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(de.lng=l.clamp(de.lng,this.minLng,this.maxLng)),this.center=de,void(this._constraining=!1)}const c=this._unmodified,{x:p,y}=this.point;let D=0,A=p,O=y;const z=this.width/2,G=this.height/2,W=this.worldMinY*this.scale,oe=this.worldMaxY*this.scale;if(y-G<W&&(O=W+G),y+G>oe&&(O=oe-G),oe-W<this.height&&(D=Math.max(D,this.height/(oe-W)),O=(oe+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const de=this.worldMinX*this.scale,ge=this.worldMaxX*this.scale,be=this.worldSize/2-(de+ge)/2;A=(p+be+this.worldSize)%this.worldSize-be,A-z<de&&(A=de+z),A+z>ge&&(A=ge-z),ge-de<this.width&&(D=Math.max(D,this.width/(ge-de)),A=(ge+de)/2)}A===p&&O===y||(this.center=this.unproject(new l.Point(A,O))),D&&(this.zoom+=this.scaleZoom(D)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=l.mercatorZfromAltitude(1,this.center.lat)/l.mercatorZfromAltitude(1,l.GLOBE_SCALE_MATCH_LATITUDE));const p=Ei(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y="meters"===this.projection.zAxisUnit?c:1,D=this._camera.getWorldToCamera(this.worldSize,y),A=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);A[8]=2*-i.x/this.width,A[9]=2*i.y/this.height;let O=l.mul([],A,D);if(this.projection.isReprojectedInTileSpace){const wt=this.locationCoordinate(this.center),dt=l.identity([]);l.translate(dt,dt,[wt.x*this.worldSize,wt.y*this.worldSize,0]),l.multiply(dt,dt,Br(this)),l.translate(dt,dt,[-wt.x*this.worldSize,-wt.y*this.worldSize,0]),l.multiply(O,O,dt),this.inverseAdjustmentMatrix=function(Lt){const Tt=Br(Lt,!0);return Ie([],[Tt[0],Tt[1],Tt[4],Tt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=l.scale([],O,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=O,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const z=l.invert([],A);this.frustumCorners=l.FrustumCorners.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);l.identity(G),l.scale(G,G,[1,-1,1]),l.rotateX(G,G,this._pitch),l.rotateZ(G,G,this.angle);const W=l.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),oe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-i.x/this.width,W[9]=2*(i.y+oe)/this.height,this.skyboxMatrix=l.multiply(G,W,G);const de=this.point,ge=de.x,be=de.y,De=this.width%2/2,Oe=this.height%2/2,ae=Math.cos(this.angle),Te=Math.sin(this.angle),Ge=ge-Math.round(ge)+ae*De+Te*Oe,Ve=be-Math.round(be)+ae*Oe+Te*De,bt=new Float64Array(O);if(l.translate(bt,bt,[Ge>.5?Ge-1:Ge,Ve>.5?Ve-1:Ve,0]),this.alignedProjMatrix=bt,O=l.create(),l.scale(O,O,[this.width/2,-this.height/2,1]),l.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=l.create(),l.scale(O,O,[1,-1,1]),l.translate(O,O,[-1,-1,0]),l.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=l.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=l.calculateGlobeMatrix(this);const wt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=l.transformMat4(wt,wt,D),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,D=[i,i,c];l.scale$2(D,D,y),l.scale$2(p,p,-1),l.multiply$2(p,p,D);const A=l.create();l.translate(A,A,p),l.scale(A,A,D),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,y)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),y=this.point,D=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-p[0]*D,y.y/this.worldSize-p[1]*D,i/this.worldSize*this._centerAltitude-p[2]*D]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],y=i[2];let D=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(D=Math.min((c-p)/y,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,i,D),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),D=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),O=Math.max((i[2]-D)/Math.cos(p),A),z=this._zoomFromMercatorZ(O);l.scaleAndAdd(i,i,c,O),this._pitch=l.clamp(p,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(y,-Math.PI,Math.PI),this._setZoom(l.clamp(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new l.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){let c=0,p=l.GLOBE_ZOOM_THRESHOLD_MAX,y=0,D=1/0;for(;p-c>1e-6&&p>c;){const A=c+.5*(p-c),O=this.tileSize*Math.pow(2,A),z=this.getCameraToCenterDistance(this.projection,A,O),G=this.scaleZoom(z/(i*this.tileSize)),W=Math.abs(A-G);W<D&&(D=W,y=A),A<G?c=A:p=A}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(l.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,c){const p=Math.min(i.x,c.x),y=Math.max(i.x,c.x),D=Math.min(i.y,c.y),A=Math.max(i.y,c.y);if(D<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new l.Point(p,D),new l.Point(y,A),new l.Point(p,A),new l.Point(y,D)],z=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const W of O){const oe=this.pointRayIntersection(W);if(oe.t<0)return!0;const de=this.rayIntersectionCoordinate(oe);if(de.x<z||de.y<0||de.x>G||de.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new l.Point(0,0),new l.Point(this.width,this.height))}zoomDeltaToMovement(i,c){const p=l.length(l.sub([],this._camera.position,i)),y=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(y)}getCameraPoint(){if("globe"===this.projection.name){const i=function([c,p,y],D){const A=[c,p,y,1];l.transformMat4$1(A,A,D);const O=A[3]=Math.max(A[3],1e-6);return A[0]/=O,A[1]/=O,A[2]/=O,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new l.Point(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,i))}}getCameraToCenterDistance(i,c=this.zoom,p=this.worldSize){const y=Ei(i,c,this.width,this.height,1024),D=i.pixelSpaceConversion(this.center.lat,p,y);return.5/Math.tan(.5*this._fov)*this.height*D}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&l.multiply(i,i,this.globeMatrix),i}}function qi(h,i){let c=!1,p=null;const y=()=>{p=null,c&&(h(),p=setTimeout(y,i),c=!1)};return()=>(c=!0,p||y(),p)}class _s{constructor(i){this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=qi(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),l.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const c=Cs(i);if(this._hashName){const p=this._hashName;let y=!1;const D=l.window.location.hash.slice(1).split("&").map(A=>{const O=A.split("=")[0];return O===p?(y=!0,`${O}=${c}`):A}).filter(A=>A);return y||D.push(`${p}=${c}`),`#${D.join("&")}`}return`#${c}`}_getCurrentHash(){const i=l.window.location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){const p=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(c[3]||0):i.getBearing();return i.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,i)}}function Cs(h,i){const c=h.getCenter(),p=Math.round(100*h.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,y),A=Math.round(c.lng*D)/D,O=Math.round(c.lat*D)/D,z=h.getBearing(),G=h.getPitch();let W=i?`/${A}/${O}/${p}`:`${p}/${O}/${A}`;return(z||G)&&(W+="/"+Math.round(10*z)/10),G&&(W+=`/${Math.round(G)}`),W}const aa={linearity:.3,easing:l.bezier(0,0,.3,1)},Gl=l.extend({deceleration:2500,maxSpeed:1400},aa),cl=l.extend({deceleration:20,maxSpeed:1400},aa),or=l.extend({deceleration:1e3,maxSpeed:360},aa),la=l.extend({deceleration:1e3,maxSpeed:90},aa);class ei{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=l.exported.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)c.zoom+=D.zoomDelta||0,c.bearing+=D.bearingDelta||0,c.pitch+=D.pitchDelta||0,D.panDelta&&c.pan._add(D.panDelta),D.around&&(c.around=D.around),D.pinchAround&&(c.pinchAround=D.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){const D=wl(c.pan.mag(),p,l.extend({},Gl,i||{}));y.offset=c.pan.mult(D.amount/c.pan.mag()),y.center=this._map.transform.center,Za(y,D)}if(c.zoom){const D=wl(c.zoom,p,cl);y.zoom=this._map.transform.zoom+D.amount,Za(y,D)}if(c.bearing){const D=wl(c.bearing,p,or);y.bearing=this._map.transform.bearing+l.clamp(D.amount,-179,179),Za(y,D)}if(c.pitch){const D=wl(c.pitch,p,la);y.pitch=this._map.transform.pitch+D.amount,Za(y,D)}if(y.zoom||y.bearing){const D=void 0===c.pinchAround?c.around:c.pinchAround;y.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function Za(h,i){(!h.duration||h.duration<i.duration)&&(h.duration=i.duration,h.easing=i.easing)}function wl(h,i,c){const{maxSpeed:p,linearity:y,deceleration:D}=c,A=l.clamp(h*y/(i/1e3),-p,p),O=Math.abs(A)/(D*y);return{easing:c.easing,duration:1e3*O,amount:A*(O/2)}}class ys extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p,y={}){const D=et(c.getCanvasContainer(),p),A=c.unproject(D);super(i,l.extend({point:D,lngLat:A,originalEvent:p},y)),this._defaultPrevented=!1,this.target=c}}class Ya extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){const y="touchend"===i?p.changedTouches:p.touches,D=Ot(c.getCanvasContainer(),y),A=D.map(z=>c.unproject(z)),O=D.reduce((z,G,W,oe)=>z.add(G.div(oe.length)),new l.Point(0,0));super(i,{points:D,point:O,lngLats:A,lngLat:c.unproject(O),originalEvent:p}),this._defaultPrevented=!1}}class Bs extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){super(i,{originalEvent:p}),this._defaultPrevented=!1}}class Wl{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new Bs(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new ys(i.type,this._map,i))}mouseup(i){this._map.fire(new ys(i.type,this._map,i))}preclick(i){const c=l.extend({},i);c.type="preclick",this._map.fire(new ys(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new ys(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new ys(i.type,this._map,i))}mouseover(i){this._map.fire(new ys(i.type,this._map,i))}mouseout(i){this._map.fire(new ys(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Ya(i.type,this._map,i))}touchmove(i){this._map.fire(new Ya(i.type,this._map,i))}touchend(i){this._map.fire(new Ya(i.type,this._map,i))}touchcancel(i){this._map.fire(new Ya(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Da{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new ys(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ys("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new ys(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class au{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&0===i.button&&(ot(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const p=c,y=this._startPos,D=this._lastPos;if(!y||!D||D.equals(p)||!this._box&&p.dist(y)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=Ke("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const A=Math.min(y.x,p.x),O=Math.max(y.x,p.x),z=Math.min(y.y,p.y),G=Math.max(y.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${z}px)`,this._box.style.width=O-A+"px",this._box.style.height=G-z+"px")})}mouseupWindow(i,c){if(!this._active)return;const p=this._startPos,y=c;if(p&&0===i.button){if(this.reset(),pt(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:D=>D.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),mt(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new l.Event(i,{originalEvent:c}))}}function ql(h,i){const c={};for(let p=0;p<h.length;p++)c[h[p].identifier]=i[p];return c}class za{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const D=new l.Point(0,0);for(const A of y)D._add(A);return D.div(y.length)}(c),this.touches=ql(p,c)))}touchmove(i,c,p){if(this.aborted||!this.centroid)return;const y=ql(p,c);for(const D in this.touches){const A=y[D];(!A||A.dist(this.touches[D])>30)&&(this.aborted=!0)}}touchend(i,c,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Zl{constructor(i){this.singleTap=new za(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,c,p){this.singleTap.touchstart(i,c,p)}touchmove(i,c,p){this.singleTap.touchmove(i,c,p)}touchend(i,c,p){const y=this.singleTap.touchend(i,c,p);if(y){const D=i.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(y)<30;if(D&&A||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class pc{constructor(){this._zoomIn=new Zl({numTouches:1,numTaps:2}),this._zoomOut=new Zl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,p){this._zoomIn.touchstart(i,c,p),this._zoomOut.touchstart(i,c,p)}touchmove(i,c,p){this._zoomIn.touchmove(i,c,p),this._zoomOut.touchmove(i,c,p)}touchend(i,c,p){const y=this._zoomIn.touchend(i,c,p),D=this._zoomOut.touchend(i,c,p);return y?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(y)},{originalEvent:i})}):D?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(D)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Bn={0:1,2:2};class ni{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const p=Pt(i);this._correctButton(i,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(i,c){const p=this._lastPoint;if(p)if(i.preventDefault(),null!=this._eventButton&&function(y,D){const A=Bn[D];return void 0===y.buttons||(y.buttons&A)!==A}(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}mouseupWindow(i){this._lastPoint&&Pt(i)===this._eventButton&&(this._moved&&pt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ca extends ni{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return 0===c&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class El extends ni{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const p=.8*(c.x-i.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(i){i.preventDefault()}}class ds extends ni{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const p=-.5*(c.y-i.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(i){i.preventDefault()}}class Dl{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),l.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)}touchstart(i,c,p){return this._calculateTransform(i,c,p)}touchmove(i,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===p.length&&!l.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,c,p)}}touchend(i,c,p){this._calculateTransform(i,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,p){p.length>0&&(this._active=!0);const y=ql(p,c),D=new l.Point(0,0),A=new l.Point(0,0);let O=0;for(const G in y){const W=y[G],oe=this._touches[G];oe&&(D._add(W),A._add(W.sub(oe)),O++,y[G]=W)}if(this._touches=y,O<this._minTouches||!A.mag())return;const z=A.div(O);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(O),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ke("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class $a{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,c,p){return{}}touchstart(i,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,p){const y=this._firstTwoTouches;if(!y)return;i.preventDefault();const[D,A]=y,O=na(p,c,D),z=na(p,c,A);if(!O||!z)return;const G=this._aroundCenter?null:O.add(z).div(2);return this._move([O,z],G,i)}touchend(i,c,p){if(!this._firstTwoTouches)return;const[y,D]=this._firstTwoTouches,A=na(p,c,y),O=na(p,c,D);A&&O||(this._active&&pt(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function na(h,i,c){for(let p=0;p<h.length;p++)if(h[p].identifier===c)return i[p]}function Yl(h,i){return Math.log(h/i)/Math.LN2}class Ac extends $a{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Yl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yl(this._distance,p),pinchAround:c}}}function mc(h,i){return 180*h.angleWith(i)/Math.PI}class zu extends $a{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const p=this._vector;if(this._vector=i[0].sub(i[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:mc(this._vector,p),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const y=mc(i,p);return Math.abs(y)<c}}function Va(h){return Math.abs(h.y)>Math.abs(h.x)}class Ts extends $a{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Va(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,p){const y=this._lastPoints;if(!y)return;const D=i[0].sub(y[0]),A=i[1].sub(y[1]);return this._map._cooperativeGestures&&!l.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(D,A,p.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(D.y+A.y)/2*-.5})}gestureBeginsVertically(i,c,p){if(void 0!==this._valid)return this._valid;const y=i.mag()>=2,D=c.mag()>=2;if(!y&&!D)return;if(!y||!D)return null==this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const A=i.y>0==c.y>0;return Va(i)&&Va(c)&&A}}const Ta={panStep:100,bearingStep:15,pitchStep:10};class Cl{constructor(){const i=Ta;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,p=0,y=0,D=0,A=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),D=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),D=1);break;case 38:i.shiftKey?y=1:(i.preventDefault(),A=-1);break;case 40:i.shiftKey?y=-1:(i.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:O=>{const z=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Xa,zoom:c?Math.round(z)+c*(i.shiftKey?2:1):z,bearing:O.getBearing()+p*this._bearingStep,pitch:O.getPitch()+y*this._pitchStep,offset:[-D*this._panStep,-A*this._panStep],center:O.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xa(h){return h*(2-h)}const ca=4.000244140625;class Pc{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||l.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const p=l.exported.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==c&&c%ca==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=et(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;"wheel"===this._type&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const z="wheel"===this._type&&Math.abs(this._delta)>ca?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&0!==G&&(G=1/G);const W=c(),oe=Math.pow(2,W),de="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):oe;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(de*G))),"wheel"===this._type&&(this._startZoom=W,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:c(),y=this._startZoom,D=this._easing;let A,O=!1;if("wheel"===this._type&&y&&D){const z=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),G=D(z);A=l.number(y,p,G),z<1?this._frameId||(this._frameId=!0):O=!0}else A=p,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:A-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=l.ease;if(this._prevEase){const p=this._prevEase,y=(l.exported.now()-p.start)/p.duration,D=p.easing(y+.01)-p.easing(y),A=.27/Math.sqrt(D*D+1e-4)*.01,O=Math.sqrt(.0729-A*A);c=l.bezier(A,O,.25,1)}return this._prevEase={start:l.exported.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ke("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(l.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Xl{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ss{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(i.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class md{constructor(){this._tap=new Zl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,c,p){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(i,c,p))}touchmove(i,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=c[0],D=y.y-this._swipePoint.y;return this._swipePoint=y,i.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(i,c,p)}touchend(i,c,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(i,c,p)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kl{constructor(i,c,p){this._el=i,this._mousePan=c,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class gc{constructor(i,c,p){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class lu{constructor(i,c,p,y){this._el=i,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qs=h=>h.zoom||h.drag||h.pitch||h.rotate;class Rc extends l.Event{}class L{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const p=l.sub([],c,i);this.radius=l.length(p[2]<0?l.div([],p,this.constants):[p[0],p[1],0])}projectRay(i){l.div(i,i,this.constants),l.normalize(i,i),l.mul$1(i,i,this.constants);const c=l.scale$2([],i,this.radius);if(c[2]>0){const p=l.scale$2([],[0,0,1],l.dot(c,[0,0,1])),y=l.scale$2([],l.normalize([],[c[0],c[1],0]),this.radius),D=l.add([],c,l.scale$2([],l.sub([],l.add([],y,p),c),2));c[0]=D[0],c[1]=D[1]}return c}}function N(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class H{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ei(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new L,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),l.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[y,D,A]of this._listeners)y.addEventListener(D,y===l.window.document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[i,c,p]of this._listeners)i.removeEventListener(c,i===l.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(i){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new Wl(c,i));const y=c.boxZoom=new au(c,i);this._add("boxZoom",y);const D=new pc,A=new Ss;c.doubleClickZoom=new Xl(A,D),this._add("tapZoom",D),this._add("clickZoom",A);const O=new md;this._add("tapDragZoom",O);const z=c.touchPitch=new Ts(c);this._add("touchPitch",z);const G=new El(i),W=new ds(i);c.dragRotate=new gc(i,G,W),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const oe=new Ca(i),de=new Dl(c,i);c.dragPan=new Kl(p,oe,de),this._add("mousePan",oe),this._add("touchPan",de,["touchZoom","touchRotate"]);const ge=new zu,be=new Ac;c.touchZoomRotate=new lu(p,be,ge,O),this._add("touchRotate",ge,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Da(c));const De=c.scrollZoom=new Pc(c,this);this._add("scrollZoom",De,["mousePan"]);const Oe=c.keyboard=new Cl;this._add("keyboard",Oe);for(const ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[ae]&&c[ae].enable(i[ae])}_add(i,c,p){this._handlers.push({handlerName:i,handler:c,allowed:p}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,c,p){for(const y in i)if(y!==p&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const p of i)this._el.contains(p.target)&&c.push(p);return c}handleEvent(i,c){this._updatingCamera=!0;const p="renderFrame"===i.type,y=p?void 0:i,D={needsRenderFrame:!1},A={},O={},z=i.touches?this._getMapTouches(i.touches):void 0,G=z?Ot(this._el,z):p?void 0:et(this._el,i);for(const{handlerName:de,handler:ge,allowed:be}of this._handlers){if(!ge.isEnabled())continue;let De;this._blockedByActive(O,be,de)?ge.reset():ge[c||i.type]&&(De=ge[c||i.type](i,G,z),this.mergeHandlerResult(D,A,De,de,y),De&&De.needsRenderFrame&&this._triggerRenderFrame()),(De||ge.isActive())&&(O[de]=ge)}const W={};for(const de in this._previousActiveHandlers)O[de]||(W[de]=y);this._previousActiveHandlers=O,(Object.keys(W).length||N(D))&&(this._changes.push([D,A,W]),this._triggerRenderFrame()),(Object.keys(O).length||N(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=D;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))}mergeHandlerResult(i,c,p,y,D){if(!p)return;l.extend(i,p);const A={handlerName:y,originalEvent:p.originalEvent||D};void 0!==p.zoomDelta&&(c.zoom=A),void 0!==p.panDelta&&(c.drag=A),void 0!==p.pitchDelta&&(c.pitch=A),void 0!==p.bearingDelta&&(c.rotate=A)}_applyChanges(){const i={},c={},p={};for(const[y,D,A]of this._changes)y.panDelta&&(i.panDelta=(i.panDelta||new l.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+y.pitchDelta),void 0!==y.around&&(i.around=y.around),void 0!==y.aroundCoord&&(i.aroundCoord=y.aroundCoord),void 0!==y.pinchAround&&(i.pinchAround=y.pinchAround),y.noInertia&&(i.noInertia=y.noInertia),l.extend(c,D),l.extend(p,A);this._updateMapTransform(i,c,p),this._changes=[]}_updateMapTransform(i,c,p){const y=this._map,D=y.transform,A=Te=>[Te.x,Te.y,Te.z];if((Te=>{const Ge=this._eventsInProgress.drag;return Ge&&!this._handlersById[Ge.handlerName].isActive()})()&&!N(i)){const Te=D.zoom;D.cameraElevationReference="sea",D.recenterOnTerrain(),D.cameraElevationReference="ground",Te!==D.zoom&&this._map._update(!0)}if(D._isCameraConstrained&&y._stop(!0),!N(i))return void this._fireEvents(c,p,!0);let{panDelta:O,zoomDelta:z,bearingDelta:G,pitchDelta:W,around:oe,aroundCoord:de,pinchAround:ge}=i;D._isCameraConstrained&&(z>0&&(z=0),D._isCameraConstrained=!1),void 0!==ge&&(oe=ge),(z||(Te=>c.drag&&!this._eventsInProgress.drag)())&&oe&&(this._dragOrigin=A(D.pointCoordinate3D(oe)),this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",y._stop(!0),oe=oe||y.transform.centerPoint,G&&(D.bearing+=G),W&&(D.pitch+=W),D._updateCameraState();const be=[0,0,0];if(O)if("mercator"===D.projection.name){const Te=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(oe).dir),Ge=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(oe.sub(O)).dir);be[0]=Ge[0]-Te[0],be[1]=Ge[1]-Te[1]}else{const Te=D.pointCoordinate(oe);if("globe"===D.projection.name){O=O.rotate(-D.angle);const Ge=D._pixelsPerMercatorPixel/D.worldSize;be[0]=-O.x*l.mercatorScale(l.latFromMercatorY(Te.y))*Ge,be[1]=-O.y*l.mercatorScale(D.center.lat)*Ge}else{const Ge=D.pointCoordinate(oe.sub(O));Te&&Ge&&(be[0]=Ge.x-Te.x,be[1]=Ge.y-Te.y)}}const De=D.zoom,Oe=[0,0,0];if(z){const Te=A(de||D.pointCoordinate3D(oe)),Ge={dir:l.normalize([],l.sub([],Te,D._camera.position))};if(Ge.dir[2]<0){const Ve=D.zoomDeltaToMovement(Te,z);l.scale$2(Oe,Ge.dir,Ve)}}const ae=l.add(be,be,Oe);D._translateCameraConstrained(ae),z&&Math.abs(D.zoom-De)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,p,!0)}_fireEvents(i,c,p){const y=qs(this._eventsInProgress),D=qs(i),A={};for(const W in i){const{originalEvent:oe}=i[W];this._eventsInProgress[W]||(A[`${W}start`]=oe),this._eventsInProgress[W]=i[W]}!y&&D&&this._fireEvent("movestart",D.originalEvent);for(const W in A)this._fireEvent(W,A[W]);D&&this._fireEvent("move",D.originalEvent);for(const W in i){const{originalEvent:oe}=i[W];this._fireEvent(W,oe)}const O={};let z;for(const W in this._eventsInProgress){const{handlerName:oe,originalEvent:de}=this._eventsInProgress[W];this._handlersById[oe].isActive()||(delete this._eventsInProgress[W],z=c[oe]||de,O[`${W}end`]=z)}for(const W in O)this._fireEvent(W,O[W]);const G=qs(this._eventsInProgress);if(p&&(y||D)&&!G){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=de=>0!==de&&-this._bearingSnap<de&&de<this._bearingSnap;W?(oe(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:z})):(this._map.fire(new l.Event("moveend",{originalEvent:z})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new l.Event(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new Rc("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const v="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class g extends l.Evented{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=!1!==c.respectPrefersReducedMotion,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,p){return i=l.Point.convert(i).mult(-1),this.panTo(this.transform.center,l.extend({offset:i},c),p)}panTo(i,c,p){return this.easeTo(l.extend({center:i},c),p)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,p){return this.easeTo(l.extend({zoom:i},c),p)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,p){return this.easeTo(l.extend({bearing:i},c),p)}resetNorth(i,c){return this.rotateTo(0,l.extend({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=l.LngLatBounds.convert(i);const p=c&&c.bearing||0,y=c&&c.pitch||0,D=i.getNorthWest(),A=i.getSouthEast();return this._cameraForBounds(this.transform,D,A,p,y,c)}_extendCameraOptions(i){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=l.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const p=i.padding;i.padding={top:p,bottom:p,right:p,left:p}}return i.padding=l.extend(c,i.padding),i}_minimumAABBFrustumDistance(i,c){const p=c.max[0]-c.min[0],y=c.max[1]-c.min[1];return p/y>i.aspect?p/(2*Math.tan(.5*i.fovX)*i.aspect):y/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,c,p,y,D,A){const O=i.clone(),z=this._extendCameraOptions(A);O.bearing=y,O.pitch=D;const G=l.LngLat.convert(c),W=l.LngLat.convert(p),oe=.5*(G.lat+W.lat),de=.5*(G.lng+W.lng),ge=l.latLngToECEF(oe,de),be=l.normalize([],ge),De=l.normalize([],l.cross([],be,[0,1,0])),Oe=l.cross([],De,be),ae=[De[0],De[1],De[2],0,Oe[0],Oe[1],Oe[2],0,be[0],be[1],be[2],0,0,0,0,1],Te=[ge,l.latLngToECEF(G.lat,G.lng),l.latLngToECEF(W.lat,G.lng),l.latLngToECEF(W.lat,W.lng),l.latLngToECEF(G.lat,W.lng),l.latLngToECEF(oe,G.lng),l.latLngToECEF(oe,W.lng),l.latLngToECEF(G.lat,de),l.latLngToECEF(W.lat,de)];let Ge=l.Aabb.fromPoints(Te.map(An=>[l.dot(De,An),l.dot(Oe,An),l.dot(be,An)]));const Ve=l.transformMat4([],Ge.center,ae);0===l.squaredLength(Ve)&&l.set(Ve,0,0,1),l.normalize(Ve,Ve),l.scale$2(Ve,Ve,l.GLOBE_RADIUS),O.center=l.ecefToLatLng(Ve);const bt=O.getWorldToCameraMatrix(),wt=l.invert(new Float64Array(16),bt);Ge=l.Aabb.applyTransform(Ge,l.multiply([],bt,ae)),l.transformMat4(Ve,Ve,bt);const dt=.5*(Ge.max[2]-Ge.min[2]),Lt=this._minimumAABBFrustumDistance(O,Ge),Tt=l.scale$2([],[0,0,1],dt),qt=l.add(Tt,Ve,Tt),Rn=Lt+(0===O.pitch?0:l.distance(Ve,qt)),Ht=O.globeCenterInViewSpace,Dn=l.sub([],Ve,[Ht[0],Ht[1],Ht[2]]);l.normalize(Dn,Dn),l.scale$2(Dn,Dn,Rn);const sn=l.add([],Ve,Dn);l.transformMat4(sn,sn,wt);const Ln=l.earthRadius/l.GLOBE_RADIUS,Xt=l.length(sn),xn=l.mercatorZfromAltitude(Math.max(Xt*Ln-l.earthRadius,Number.EPSILON),0),Nn=Math.min(O.zoomFromMercatorZAdjusted(xn),z.maxZoom);return Nn>.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=Nn,this._cameraForBounds(O,c,p,y,D,A)):{center:O.center,zoom:Nn,bearing:y,pitch:D}}queryTerrainElevation(i,c){const p=this.transform.elevation;return p?(c=l.extend({},{exaggerated:!0},c),p.getAtPoint(l.MercatorCoordinate.fromLngLat(i),null,c.exaggerated)):null}_cameraForBounds(i,c,p,y,D,A){if("globe"===i.projection.name)return this._cameraForBoundsOnGlobe(i,c,p,y,D,A);const O=i.clone(),z=this._extendCameraOptions(A),G=O.padding;O.bearing=y,O.pitch=D;const W=l.LngLat.convert(c),oe=l.LngLat.convert(p),de=new l.LngLat(W.lng,oe.lat),ge=new l.LngLat(oe.lng,W.lat),be=O.project(W),De=O.project(oe),Oe=this.queryTerrainElevation(W),ae=this.queryTerrainElevation(oe),Te=this.queryTerrainElevation(de),Ge=this.queryTerrainElevation(ge),Ve=[[be.x,be.y,Math.min(Oe||0,ae||0,Te||0,Ge||0)],[De.x,De.y,Math.max(Oe||0,ae||0,Te||0,Ge||0)]];let bt=l.Aabb.fromPoints(Ve);const wt=O.getWorldToCameraMatrix(),dt=l.invert(new Float64Array(16),wt);bt=l.Aabb.applyTransform(bt,wt);const Lt=l.sub([],bt.max,bt.min),Tt=G.left||0,qt=G.right||0,Rn=G.bottom||0,Ht=G.top||0,{left:Dn,right:sn,top:Ln,bottom:Xt}=z.padding,xn=.5*(Tt+qt),Nn=.5*(Ht+Rn),An=Math.min(O.scaleZoom(O.scale*Math.min((O.width-(Tt+qt+Dn+sn))/Lt[0],(O.height-(Rn+Ht+Xt+Ln))/Lt[1])),z.maxZoom),$n=O.scale/O.zoomScale(An);bt=new l.Aabb([bt.min[0]-(Dn+xn)*$n,bt.min[1]-(Xt+Nn)*$n,bt.min[2]],[bt.max[0]+(sn+xn)*$n,bt.max[1]+(Ln+Nn)*$n,bt.max[2]]);const Ar=.5*Lt[2],Xr=this._minimumAABBFrustumDistance(O,bt),ur=[0,0,1,0];l.transformMat4$1(ur,ur,wt),l.normalize$2(ur,ur);const $r=l.scale$2([],ur,Xr+Ar),mi=l.add([],bt.center,$r),fi=("number"==typeof z.offset.x&&"number"==typeof z.offset.y?new l.Point(z.offset.x,z.offset.y):l.Point.convert(z.offset)).rotate(-l.degToRad(y));bt.center[0]-=fi.x*$n,bt.center[1]+=fi.y*$n,l.transformMat4(bt.center,bt.center,dt),l.transformMat4(mi,mi,dt);const xr=[bt.center[0],bt.center[1],mi[2]*O.pixelsPerMeter];l.scale$2(xr,xr,1/O.worldSize);const Yi=l.lngFromMercatorX(xr[0]),gi=l.latFromMercatorY(xr[1]),ho=Math.min(O._zoomFromMercatorZ(xr[2]),z.maxZoom),ao=new l.LngLat(Yi,gi);return O.mercatorFromTransition&&ho<.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=ho,this._cameraForBounds(O,c,p,y,D,A)):{center:ao,zoom:ho,bearing:y,pitch:D}}fitBounds(i,c,p){const y=this.cameraForBounds(i,c);return this._fitInternal(y,c,p)}fitScreenCoordinates(i,c,p,y,D){const A=l.Point.convert(i),O=l.Point.convert(c),z=new l.Point(Math.min(A.x,O.x),Math.min(A.y,O.y)),G=new l.Point(Math.max(A.x,O.x),Math.max(A.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(A,O))return this;const W=this.transform.pointLocation3D(z),oe=this.transform.pointLocation3D(G),de=this.transform.pointLocation3D(new l.Point(z.x,G.y)),ge=this.transform.pointLocation3D(new l.Point(G.x,z.y)),be=[Math.min(W.lng,oe.lng,de.lng,ge.lng),Math.min(W.lat,oe.lat,de.lat,ge.lat)],De=[Math.max(W.lng,oe.lng,de.lng,ge.lng),Math.max(W.lat,oe.lat,de.lat,ge.lat)],Oe=y&&y.pitch?y.pitch:this.getPitch(),ae=this._cameraForBounds(this.transform,be,De,p,Oe,y);return this._fitInternal(ae,y,D)}_fitInternal(i,c,p){return i?(delete(c=l.extend(i,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(i,c){this.stop();const p=i.preloadOnly?this.transform.clone():this.transform;let y=!1,D=!1,A=!1;return"zoom"in i&&p.zoom!==+i.zoom&&(y=!0,p.zoom=+i.zoom),void 0!==i.center&&(p.center=l.LngLat.convert(i.center)),"bearing"in i&&p.bearing!==+i.bearing&&(D=!0,p.bearing=+i.bearing),"pitch"in i&&p.pitch!==+i.pitch&&(A=!0,p.pitch=+i.pitch),null==i.padding||p.isPaddingEqual(i.padding)||(p.padding=i.padding),i.preloadOnly?(this._preloadTiles(p),this):(this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),y&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),D&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),A&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||l.warnOnce(v),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return l.warnOnce(v),this;this.stop();const y=p.zoom,D=p.pitch,A=p.bearing;p.setFreeCameraOptions(i);const O=y!==p.zoom,z=D!==p.pitch,G=A!==p.bearing;return this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),O&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),G&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),z&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),(!1===(i=l.extend({offset:[0,0],duration:500,easing:l.ease},i)).animate||this._prefersReducedMotion(i))&&(i.duration=0);const p=this.transform,y=this.getZoom(),D=this.getBearing(),A=this.getPitch(),O=this.getPadding(),z="zoom"in i?+i.zoom:y,G="bearing"in i?this._normalizeBearing(i.bearing,D):D,W="pitch"in i?+i.pitch:A,oe="padding"in i?i.padding:p.padding,de=l.Point.convert(i.offset);let ge,be,De;if("globe"===p.projection.name){const Tt=l.MercatorCoordinate.fromLngLat(p.center),qt=de.rotate(-p.angle);Tt.x+=qt.x/p.worldSize,Tt.y+=qt.y/p.worldSize;const Rn=Tt.toLngLat(),Ht=l.LngLat.convert(i.center||Rn);this._normalizeCenter(Ht),ge=p.centerPoint.add(qt),be=new l.Point(Tt.x,Tt.y).mult(p.worldSize),De=new l.Point(l.mercatorXfromLng(Ht.lng),l.mercatorYfromLat(Ht.lat)).mult(p.worldSize).sub(be)}else{ge=p.centerPoint.add(de);const Tt=p.pointLocation(ge),qt=l.LngLat.convert(i.center||Tt);this._normalizeCenter(qt),be=p.project(Tt),De=p.project(qt).sub(be)}const Oe=p.zoomScale(z-y);let ae,Te;i.around&&(ae=l.LngLat.convert(i.around),Te=p.locationPoint(ae));const Ge=this._zooming||z!==y,Ve=this._rotating||D!==G,bt=this._pitching||W!==A,wt=!p.isPaddingEqual(oe),dt=Tt=>qt=>{if(Ge&&(Tt.zoom=l.number(y,z,qt)),Ve&&(Tt.bearing=l.number(D,G,qt)),bt&&(Tt.pitch=l.number(A,W,qt)),wt&&(Tt.interpolatePadding(O,oe,qt),ge=Tt.centerPoint.add(de)),ae)Tt.setLocationAtPoint(ae,Te);else{const Rn=Tt.zoomScale(Tt.zoom-y),Ht=z>y?Math.min(2,Oe):Math.max(.5,Oe),Dn=Math.pow(Ht,1-qt),sn=Tt.unproject(be.add(De.mult(qt*Dn)).mult(Rn));Tt.setLocationAtPoint(Tt.renderWorldCopies?sn.wrap():sn,ge)}return i.preloadOnly||this._fireMoveEvents(c),Tt};if(i.preloadOnly){const Tt=this._emulate(dt,i.duration,p);return this._preloadTiles(Tt),this}const Lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ge,this._rotating=Ve,this._pitching=bt,this._padding=wt,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,Lt),this._ease(dt(p),Tt=>{p.recenterOnTerrain(),this._afterEase(c,Tt)},i),this}_prepareEase(i,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new l.Event("movestart",i)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new l.Event("move",i)),this._zooming&&this.fire(new l.Event("zoom",i)),this._rotating&&this.fire(new l.Event("rotate",i)),this._pitching&&this.fire(new l.Event("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",i)),y&&this.fire(new l.Event("rotateend",i)),D&&this.fire(new l.Event("pitchend",i)),this.fire(new l.Event("moveend",i))}flyTo(i,c){if(this._prefersReducedMotion(i)){const An=l.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(An,c)}this.stop(),i=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},i);const p=this.transform,y=this.getZoom(),D=this.getBearing(),A=this.getPitch(),O=this.getPadding(),z="zoom"in i?l.clamp(+i.zoom,p.minZoom,p.maxZoom):y,G="bearing"in i?this._normalizeBearing(i.bearing,D):D,W="pitch"in i?+i.pitch:A,oe="padding"in i?i.padding:p.padding,de=p.zoomScale(z-y),ge=l.Point.convert(i.offset);let be=p.centerPoint.add(ge);const De=p.pointLocation(be),Oe=l.LngLat.convert(i.center||De);this._normalizeCenter(Oe);const ae=p.project(De),Te=p.project(Oe).sub(ae);let Ge=i.curve;const Ve=Math.max(p.width,p.height),bt=Ve/de,wt=Te.mag();if("minZoom"in i){const An=l.clamp(Math.min(i.minZoom,y,z),p.minZoom,p.maxZoom),$n=Ve/p.zoomScale(An-y);Ge=Math.sqrt($n/wt*2)}const dt=Ge*Ge;function Lt(An){const $n=(bt*bt-Ve*Ve+(An?-1:1)*dt*dt*wt*wt)/(2*(An?bt:Ve)*dt*wt);return Math.log(Math.sqrt($n*$n+1)-$n)}function Tt(An){return(Math.exp(An)-Math.exp(-An))/2}function qt(An){return(Math.exp(An)+Math.exp(-An))/2}const Rn=Lt(0);let Ht=function(An){return qt(Rn)/qt(Rn+Ge*An)},Dn=function(An){return Ve*((qt(Rn)*(Tt($n=Rn+Ge*An)/qt($n))-Tt(Rn))/dt)/wt;var $n},sn=(Lt(1)-Rn)/Ge;if(Math.abs(wt)<1e-6||!isFinite(sn)){if(Math.abs(Ve-bt)<1e-6)return this.easeTo(i,c);const An=bt<Ve?-1:1;sn=Math.abs(Math.log(bt/Ve))/Ge,Dn=function(){return 0},Ht=function($n){return Math.exp(An*Ge*$n)}}i.duration="duration"in i?+i.duration:1e3*sn/("screenSpeed"in i?+i.screenSpeed/Ge:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Ln=D!==G,Xt=W!==A,xn=!p.isPaddingEqual(oe),Nn=An=>$n=>{const Ar=$n*sn,Xr=1/Ht(Ar);An.zoom=1===$n?z:y+An.scaleZoom(Xr),Ln&&(An.bearing=l.number(D,G,$n)),Xt&&(An.pitch=l.number(A,W,$n)),xn&&(An.interpolatePadding(O,oe,$n),be=An.centerPoint.add(ge));const ur=1===$n?Oe:An.unproject(ae.add(Te.mult(Dn(Ar))).mult(Xr));return An.setLocationAtPoint(An.renderWorldCopies?ur.wrap():ur,be),An._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(c),An};if(i.preloadOnly){const An=this._emulate(Nn,i.duration,p);return this._preloadTiles(An),this}return this._zooming=!0,this._rotating=Ln,this._pitching=Xt,this._padding=xn,this._prepareEase(c,!1),this._ease(Nn(p),()=>this._afterEase(c),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!i){const p=this.handlers;p&&p.stop(!1)}return this}_ease(i,c,p){!1===p.animate||0===p.duration?(i(1),c()):(this._easeStart=l.exported.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=l.wrap(i,-180,180);const p=Math.abs(i-c);return Math.abs(i-360-c)<p&&(i-=360),Math.abs(i+360-c)<p&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=i.lng-c.center.lng;i.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(i){return this._respectPrefersReducedMotion&&l.exported.prefersReducedMotion&&!(i&&i.essential)}_emulate(i,c,p){const y=Math.ceil(15*c/1e3),D=[],A=i(p.clone());for(let O=0;O<=y;O++){const z=A(O/y);D.push(z.clone())}return D}}class E{constructor(i={}){this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact;return this._map=i,this._container=Ke("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ke("button","mapboxgl-ctrl-attrib-button",this._container),Ke("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ke("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,c){const p=this._map._getUIString(`AttributionControl.${c}`);i.setAttribute("aria-label",p),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){const p=c.reduce((y,D,A)=>(D.value&&(y+=`${D.key}=${D.value}${A<c.length-1?"&":""}`),y),"?");i.href=`${l.config.FEEDBACK_URL}/${p}#${Cs(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const c=this._map.style._sourceCaches;for(const y in c){const D=c[y];if(D.used){const A=D.getSource();A.attribution&&i.indexOf(A.attribution)<0&&i.push(A.attribution)}}i.sort((y,D)=>y.length-D.length),i=i.filter((y,D)=>{for(let A=D+1;A<i.length;A++)if(i[A].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class S{constructor(){l.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=Ke("div","mapboxgl-ctrl");const c=Ke("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const c in i){const p=i[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class ${constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const y of p)if(y.id===i)return void(y.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function te(h,i,c){if(h=new l.LngLat(h.lng,h.lat),i){const p=new l.LngLat(h.lng-360,h.lat),y=new l.LngLat(h.lng+360,h.lat),D=360*Math.ceil(Math.abs(h.lng-c.center.lng)/360),A=c.locationPoint(h).distSqr(i),O=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint(p).distSqr(i)<A&&(O||Math.abs(p.lng-c.center.lng)<D)?h=p:c.locationPoint(y).distSqr(i)<A&&(O||Math.abs(y.lng-c.center.lng)<D)&&(h=y)}for(;Math.abs(h.lng-c.center.lng)>180;){const p=c.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;h.lng>c.center.lng?h.lng-=360:h.lng+=360}return h}const ve={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class me extends l.Evented{constructor(i,c){if(super(),(i instanceof l.window.HTMLElement||c)&&(i=l.extend({element:i},c)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=l.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ke("div");const y=41,D=27,A=ye("svg",{display:"block",height:y*this._scale+"px",width:D*this._scale+"px",viewBox:`0 0 ${D} ${y}`},this._element),O=ye("radialGradient",{id:"shadowGradient"},ye("defs",{},A));ye("stop",{offset:"10%","stop-opacity":.4},O),ye("stop",{offset:"100%","stop-opacity":.05},O),ye("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},A),ye("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},A),ye("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},A),ye("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},A),this._offset=l.Point.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const p=this._element.classList;for(const y in ve)p.remove(`mapboxgl-marker-anchor-${y}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(24.6+y)],"bottom-right":[-y,-1*(24.6+y)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,p=i.charCode||i.keyCode;"Space"!==c&&"Enter"!==c&&32!==p&&13!==p||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,c=this._pos;if(!i||!c)return!1;const p=i.unproject(c),y=i.getFreeCameraOptions();if(!y.position)return!1;const D=y.position.toLngLat();return D.distanceTo(p)<.9*D.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const c=this._pos;if(!c||c.x<0||c.x>i.transform.width||c.y<0||c.y>i.transform.height)return void this._clearFadeTimer();const p=i.unproject(c);let y;i._showingGlobe()&&l.isLngLatBehindGlobe(i.transform,this._lngLat)?y=0:(y=1-i._queryFogOpacity(p),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${ve[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const i=this._pos,c=this._map,p=this.getPitchAlignment();if(!c||!i||"map"!==p)return"";if(!c._showingGlobe()){const z=c.getPitch();return z?`rotateX(${z}deg)`:""}const y=l.radToDeg(l.globeTiltAtLngLat(c.transform,this._lngLat)),D=i.sub(l.globeCenterToScreenPoint(c.transform)),A=Math.abs(D.x)+Math.abs(D.y);if(0===A)return"";const O=y/A;return`rotateX(${-D.y*O}deg) rotateY(${D.x*O}deg)`}_calculateZTransform(){const i=this._pos,c=this._map;if(!c||!i)return"";let p=0;const y=this.getRotationAlignment();if("map"===y)if(c._showingGlobe()){const D=c.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),A=c.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(D);p=l.radToDeg(Math.atan2(A.y,A.x))-90}else p=-c.getBearing();else if("horizon"===y){const D=l.smoothstep(4,6,c.getZoom()),A=l.globeCenterToScreenPoint(c.transform);A.y+=D*c.transform.height;const O=i.sub(A),z=l.radToDeg(Math.atan2(O.y,O.x));p=(z>90?z-270:z+90)*(1-D)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(i){l.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=te(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===i?this._updateFrameId=l.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=l.Point.convert(i),this._update(),this}_onMove(i){const c=this._map;if(!c)return;const p=this._pointerdownPos,y=this._positionDelta;if(p&&y){if(!this._isDragging){const D=this._clickTolerance||c._clickTolerance;if(i.point.dist(p)<D)return;this._isDragging=!0}this._pos=i.point.sub(y),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(i){const c=this._map,p=this._pos;c&&p&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(p),this._pointerdownPos=i.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const c=this._map;return c&&(i?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const st={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},$t=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function er(h=new l.Point(0,0),i="bottom"){if("number"==typeof h){const c=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(i){case"top":return new l.Point(0,h);case"top-left":return new l.Point(c,c);case"top-right":return new l.Point(-c,c);case"bottom":return new l.Point(0,-h);case"bottom-left":return new l.Point(c,-c);case"bottom-right":return new l.Point(-c,-c);case"left":return new l.Point(h,0);case"right":return new l.Point(-h,0)}return new l.Point(0,0)}return h instanceof l.Point||Array.isArray(h)?l.Point.convert(h):l.Point.convert(h[i]||[0,0])}class Yn{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=l.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,p){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+p}}const Nr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Wr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Sr={showCompass:!0,showZoom:!0,visualizePitch:!1};class Zr{constructor(i,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new El({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,p&&(this.mousePitch=new ds({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),ot()}move(i,c){const p=this.map,y=this.mouseRotate.mousemoveWindow(i,c),D=y&&y.bearingDelta;if(D&&p.setBearing(p.getBearing()+D),this.mousePitch){const A=this.mousePitch.mousemoveWindow(i,c),O=A&&A.pitchDelta;O&&p.setPitch(p.getPitch()+O)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){mt(),l.window.removeEventListener("mousemove",this.mousemove),l.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),et(this.element,i)),l.window.addEventListener("mousemove",this.mousemove),l.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,et(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=Ot(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=Ot(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ur={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},hi={maxWidth:100,unit:"metric"},Zi={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},_o={version:l.version,supported:Ne,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends g{constructor(h){if(l.LivePerformanceUtils.mark(l.PerformanceMarkers.create),null!=(h=l.extend({},Wr,h)).minZoom&&null!=h.maxZoom&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=h.minPitch&&null!=h.maxPitch&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=h.minPitch&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=h.maxPitch&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&l.isSafariWithAntialiasingBug(l.window)&&(h.antialias=!1,l.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ta(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._useWebGL2=h.useWebGL2,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new $,this._domRenderTaskQueue=new $,this._controls=[],this._markers=[],this._popups=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Nr,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Yn(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new l.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,"string"==typeof h.container){if(this._container=l.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof l.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&l.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new H(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new _s("string"==typeof h.hash&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,l.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new E({customAttribution:h.customAttribution})),this._logoControl=new S,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new l.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new l.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(h,i){if(void 0===i&&(i=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[i];return-1!==i.indexOf("bottom")?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(h);return i>-1&&this._controls.splice(i,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new l.Event("movestart",h)).fire(new l.Event("move",h)),this.fire(new l.Event("resize",h)),i&&this.fire(new l.Event("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(l.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return"auto"===h?l.window.navigator.language:Array.isArray(h)?0===h.length?void 0:h.map(i=>"auto"===i?l.window.navigator.language:i):h}setLanguage(h){const i=this._parseLanguage(h);if(!this.style||i===this._language)return this;this._language=i,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(h){return this._lazyInitEmptyStyle(),h?"string"==typeof h&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const h=this.transform,i=h.projection.name;let c;"globe"===i&&h.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),c=!0):"mercator"===i&&h.zoom<l.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,i){return this._updateProjection(h||i||{name:"mercator"})}_updateProjection(h){let i;if(i="globe"===h.name&&this.transform.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(h){return this.transform.locationPoint3D(l.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(l.Point.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,i,c){if("mouseenter"===h||"mouseover"===h){let p=!1;const y=A=>{const O=i.filter(G=>this.getLayer(G)),z=O.length?this.queryRenderedFeatures(A.point,{layers:O}):[];z.length?p||(p=!0,c.call(this,new ys(h,this,A.originalEvent,{features:z}))):p=!1},D=()=>{p=!1};return{layers:new Set(i),listener:c,delegates:{mousemove:y,mouseout:D}}}if("mouseleave"===h||"mouseout"===h){let p=!1;const y=A=>{const O=i.filter(z=>this.getLayer(z));(O.length?this.queryRenderedFeatures(A.point,{layers:O}):[]).length?p=!0:p&&(p=!1,c.call(this,new ys(h,this,A.originalEvent)))},D=A=>{p&&(p=!1,c.call(this,new ys(h,this,A.originalEvent)))};return{layers:new Set(i),listener:c,delegates:{mousemove:y,mouseout:D}}}{const p=y=>{const D=i.filter(O=>this.getLayer(O)),A=D.length?this.queryRenderedFeatures(y.point,{layers:D}):[];A.length&&(y.features=A,c.call(this,y),delete y.features)};return{layers:new Set(i),listener:c,delegates:{[h]:p}}}}on(h,i,c){if(void 0===c)return super.on(h,i);Array.isArray(i)||(i=[i]);const p=this._createDelegatedListener(h,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(h,i,c){if(void 0===c)return super.once(h,i);Array.isArray(i)||(i=[i]);const p=this._createDelegatedListener(h,i,c);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(h,i,c){if(void 0===c)return super.off(h,i);i=new Set(Array.isArray(i)?i:[i]);const p=(D,A)=>{if(D.size!==A.size)return!1;for(const O of D)if(!A.has(O))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[h]:void 0;return y&&(D=>{for(let A=0;A<D.length;A++){const O=D[A];if(O.listener===c&&p(O.layers,i)){for(const z in O.delegates)this.off(z,O.delegates[z]);return D.splice(A,1),this}}})(y),this}queryRenderedFeatures(h,i){return this.style?(void 0!==i||void 0===h||h instanceof l.Point||Array.isArray(h)||(i=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(h,i){return this.style.querySourceFeatures(h,i)}isPointOnSurface(h){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&l.warnOnce(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(l.Point.convert(h))}setStyle(h,i){return!1!==(i=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(h,i))}_getUIString(h){const i=this._locale[h];if(null==i)throw new Error(`Missing UI string '${h}'`);return i}_updateStyle(h,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new Mr(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof h?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,i){if("string"==typeof h){const c=this._requestManager.normalizeStyleURL(h),p=this._requestManager.transformRequest(c,l.ResourceType.Style);l.getJSON(p,(y,D)=>{y?this.fire(new l.ErrorEvent(y)):D&&this._updateDiff(D,i)})}else"object"==typeof h&&this._updateDiff(h,i)}_updateDiff(h,i){try{this.style.setState(h)&&this._update(!0)}catch(c){l.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(h,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(l.warnOnce("There is no style added to the map."),!1)}addSource(h,i){return this._lazyInitEmptyStyle(),this.style.addSource(h,i),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const i in h){const c=h[i]._tiles;for(const p in c){const y=c[p];if("loaded"!==y.state&&"errored"!==y.state)return!1}}return!0}addSourceType(h,i,c){this._lazyInitEmptyStyle(),this.style.addSourceType(h,i,c)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,i,{pixelRatio:c=1,sdf:p=!1,stretchX:y,stretchY:D,content:A}={}){if(this._lazyInitEmptyStyle(),i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap){const{width:O,height:z,data:G}=l.exported.getImageData(i);this.style.addImage(h,{data:new l.RGBAImage({width:O,height:z},G),pixelRatio:c,stretchX:y,stretchY:D,content:A,sdf:p,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:z}=i,G=i;this.style.addImage(h,{data:new l.RGBAImage({width:O,height:z},new Uint8Array(G.data)),pixelRatio:c,stretchX:y,stretchY:D,content:A,sdf:p,version:0,userImage:G}),G.onAdd&&G.onAdd(this,h)}}updateImage(h,i){const c=this.style.getImage(h);if(!c)return void this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap?l.exported.getImageData(i):i,{width:y,height:D}=p;void 0!==y&&void 0!==D?y===c.data.width&&D===c.data.height?(c.data.replace(p.data,!(i instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&i instanceof l.window.ImageBitmap)),this.style.updateImage(h,c)):this.fire(new l.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${D})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,i){l.getImage(this._requestManager.transformRequest(h,l.ResourceType.Image),(c,p)=>{i(c,p instanceof l.window.HTMLImageElement?l.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(h,i){return this._lazyInitEmptyStyle(),this.style.addLayer(h,i),this._update(!0)}moveLayer(h,i){return this.style.moveLayer(h,i),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,i,c){return this.style.setLayerZoomRange(h,i,c),this._update(!0)}setFilter(h,i,c={}){return this.style.setFilter(h,i,c),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,i,c,p={}){return this.style.setPaintProperty(h,i,c,p),this._update(!0)}getPaintProperty(h,i){return this.style.getPaintProperty(h,i)}setLayoutProperty(h,i,c,p={}){return this.style.setLayoutProperty(h,i,c,p),this._update(!0)}getLayoutProperty(h,i){return this.style.getLayoutProperty(h,i)}setLight(h,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(h),this.transform):0}setFeatureState(h,i){return this.style.setFeatureState(h,i),this._update()}removeFeatureState(h,i){return this.style.removeFeatureState(h,i),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,p,y,D=this._container;for(;D&&(!p||!y);){const A=l.window.getComputedStyle(D).transform;A&&"none"!==A&&(c=A.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(p=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(y=c[3])),D=D.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=y?Math.abs(i/y):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ke("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=Ke("div","mapboxgl-canvas-container",h);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=Ke("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=Ke("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=Ke("div",`mapboxgl-ctrl-${y}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,i){const c=l.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(h),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${i}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const i=this._markers.indexOf(h);-1!==i&&this._markers.splice(i,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const i=this._popups.indexOf(h);-1!==i&&this._popups.splice(i,1)}_setupPainter(){const h=l.extend({},Ne.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._useWebGL2&&this._canvas.getContext("webgl2",h),c=i||this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);c?(this._useWebGL2&&!i&&l.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),l.storeAuthState(c,!0),this.painter=new Re(c,this.transform,!!i),this.on("data",p=>{"source"===p.dataType&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(c)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let i;const c=this.painter.context.extTimerQuery,p=l.exported.now();if(this.listens("gpu-timing-frame")&&(i=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],l.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],l.window.performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,z=this.transform.pitch,G=l.exported.now(),W=new l.EvaluationParameters(O,{now:G,fadeDuration:y,pitch:z,transition:this.style.getTransition()});this.style.update(W)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let D=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),D=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):D=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const O=l.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,i),setTimeout(()=>{const z=c.getQueryObjectEXT(i,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(i),this.fire(new l.Event("gpu-timing-frame",{cpuTime:O,gpuTime:z})),l.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(O);this.fire(new l.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(O);this.fire(new l.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const A=this._sourcesDirty||this._styleDirty||this._placementDirty||D;if(A||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(D=this._updateAverageElevation(p,!0)),D)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,l.LivePerformanceUtils.mark(l.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&l.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const i of this._markers)h&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!h||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(h,i=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((i||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const p=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),D=!1;this.transform.elevation&&(D=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=h;const A=Math.abs(p-y);if(A>1){if(this._isInitialLoad||D)return this._averageElevation.jumpTo(y),c(y);this._averageElevation.easeTo(y,h,300)}else if(A>1e-4)return this._averageElevation.jumpTo(y),c(y)}return!!this._averageElevation.isEasing(h)&&c(this._averageElevation.getValue(h))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===l.AUTH_ERR_MSG||401===h.status)){const i=this.painter.context.gl;l.storeAuthState(i,!1),this._logoControl instanceof S&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function y(D){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,D,0);const A=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,A),A}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(y(h),i.canvasCopies.map(y),i.timeStamps)}_canvasPixelComparison(h,i,c){let p=c[1]-c[0];const y=h.length/4;for(let D=0;D<i.length;D++){const A=i[D];let O=0;for(let z=0;z<A.length;z+=4)A[z]===h[z]&&A[z+1]===h[z+1]&&A[z+2]===h[z+2]&&A[z+3]===h[z+3]&&(O+=1);p+=(c[D+2]-c[D+1])*(1-O/y)}return p}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1),l.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=l.exported.frame(i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)}))}_preloadTiles(h){const i=this.style?Object.values(this.style._sourceCaches):[];return l.asyncAll(i,(c,p)=>c._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){"hidden"===l.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,h&&this._update())}_setCacheLimits(h,i){l.setCacheLimits(h,i)}get version(){return l.version}},NavigationControl:class{constructor(h){this.options=l.extend({},Sr,h),this._container=Ke("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),Ke("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),Ke("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:i}):c.resetNorth({},{originalEvent:i}))}),this._compassIcon=Ke("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const i=h.getZoom(),c=i===h.getMaxZoom(),p=i===h.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zr(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,i){const c=Ke("button",h,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(h,i){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${i}`);h.setAttribute("aria-label",c),h.firstElementChild&&h.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends l.Evented{constructor(h){super(),this.options=l.extend({geolocation:l.window.navigator.geolocation},Ur,h),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=qi(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=Ke("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const i=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,h(c)};void 0!==this._supportsGeolocation?h(this._supportsGeolocation):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(c=>i("denied"!==c.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(h){const i=this._map.getMaxBounds(),c=h.coords;return!!i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",h)),this._finish()}}_updateCamera(h){const i=new l.LngLat(h.coords.longitude,h.coords.latitude),c=h.coords.accuracy,p=this._map.getBearing(),y=l.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),y,{geolocateSource:!0})}_updateMarker(h){if(h){const i=new l.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,i=l.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,c=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=Ke("button","mapboxgl-ctrl-geolocate",this._container),Ke("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===h){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ke("div","mapboxgl-user-location"),this._dotElement.appendChild(Ke("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ke("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new me({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ke("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new me({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:!0===h.absolute&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==l.window.DeviceMotionEvent&&"function"==typeof l.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientation),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:E,ScaleControl:class{constructor(h){this.options=l.extend({},hi,h),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),l.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,i=this._map,c=i._containerHeight/2,p=i._containerWidth/2-h/2,y=i.unproject([p,c]),D=i.unproject([p+h,c]),A=y.distanceTo(D);if("imperial"===this.options.unit){const O=3.2808*A;O>5280?this._setScale(h,O/5280,"mile"):this._setScale(h,O,"foot")}else"nautical"===this.options.unit?this._setScale(h,A/1852,"nautical-mile"):A>=1e3?this._setScale(h,A/1e3,"kilometer"):this._setScale(h,A,"meter")}_setScale(h,i,c){this._map._requestDomTask(()=>{const p=function(D){const A=Math.pow(10,`${Math.floor(D)}`.length-1);let O=D/A;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(z){const G=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*G)/G}(O),A*O}(i),y=p/i;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(p):`${p}&nbsp;${Zi[c]}`,this._container.style.width=h*y+"px"})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=Ke("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof l.window.HTMLElement?this._container=h.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ke("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=Ke("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ke("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(h){super(),this.options=l.extend(Object.create(st),h),l.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=l.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(l.window.document.createTextNode(h))}setHTML(h){const i=l.window.document.createDocumentFragment(),c=l.window.document.createElement("body");let p;for(c.innerHTML=h;p=c.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=Ke("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(h),this.options.closeButton){const c=this._closeButton=Ke("button","mapboxgl-popup-close-button",i);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let i;return this._classList.delete(h)?i=!1:(this._classList.add(h),i=!0),this._updateClassList(),i}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const i=this._map,c=this._container,p=this._pos;if(!i||!c||!p)return"bottom";const y=c.offsetWidth,D=c.offsetHeight,A=p.x<y/2,O=p.x>i.transform.width-y/2;if(p.y+h<D)return A?"top-left":O?"top-right":"top";if(p.y>i.transform.height-D){if(A)return"bottom-left";if(O)return"bottom-right"}return A?"left":O?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),h.className=i.join(" ")}_update(h){const i=this._map,c=this._content;if(!i||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=Ke("div","mapboxgl-popup",i.getContainer()),this._tip=Ke("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=te(this._lngLat,this._pos,i.transform)),!this._trackPointer||h){const y=this._pos=this._trackPointer&&h?h:i.project(this._lngLat),D=er(this.options.offset),A=this._anchor=this._getAnchor(D.y),O=er(this.options.offset,A),z=y.add(O).round();i._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${ve[A]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&i._showingGlobe()){const y=l.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector($t);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:me,Style:Mr,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:vi,Evented:l.Evented,config:l.config,prewarm:function(){no().acquire(yr)},clearPrewarmedResources:function(){const h=ti;h&&(h.isPreloaded()&&1===h.numActive()?(h.release(yr),ti=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(h){l.config.ACCESS_TOKEN=h},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(h){l.config.API_URL=h},get workerCount(){return Hr.workerCount},set workerCount(h){Hr.workerCount=h},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){l.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){l.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return _o}),M}()},5619:(Hn,It,X)=>{"use strict";X.d(It,{X:()=>w});var M=X(8645);class w extends M.x{constructor(l){super(),this._value=l}get value(){return this.getValue()}_subscribe(l){const _e=super._subscribe(l);return!_e.closed&&l.next(this._value),_e}getValue(){const{hasError:l,thrownError:_e,_value:Ne}=this;if(l)throw _e;return this._throwIfClosed(),Ne}next(l){super.next(this._value=l)}}},5592:(Hn,It,X)=>{"use strict";X.d(It,{y:()=>tt});var M=X(305),w=X(7394),lt=X(4850),l=X(8407),_e=X(2653),Ne=X(4674),Le=X(1441);let tt=(()=>{class Ze{constructor(ot){ot&&(this._subscribe=ot)}lift(ot){const mt=new Ze;return mt.source=this,mt.operator=ot,mt}subscribe(ot,mt,xt){const pt=function Ae(Ze){return Ze&&Ze instanceof M.Lv||function ye(Ze){return Ze&&(0,Ne.m)(Ze.next)&&(0,Ne.m)(Ze.error)&&(0,Ne.m)(Ze.complete)}(Ze)&&(0,w.Nn)(Ze)}(ot)?ot:new M.Hp(ot,mt,xt);return(0,Le.x)(()=>{const{operator:et,source:Ot}=this;pt.add(et?et.call(pt,Ot):Ot?this._subscribe(pt):this._trySubscribe(pt))}),pt}_trySubscribe(ot){try{return this._subscribe(ot)}catch(mt){ot.error(mt)}}forEach(ot,mt){return new(mt=Ke(mt))((xt,pt)=>{const et=new M.Hp({next:Ot=>{try{ot(Ot)}catch(Pt){pt(Pt),et.unsubscribe()}},error:pt,complete:xt});this.subscribe(et)})}_subscribe(ot){var mt;return null===(mt=this.source)||void 0===mt?void 0:mt.subscribe(ot)}[lt.L](){return this}pipe(...ot){return(0,l.U)(ot)(this)}toPromise(ot){return new(ot=Ke(ot))((mt,xt)=>{let pt;this.subscribe(et=>pt=et,et=>xt(et),()=>mt(pt))})}}return Ze.create=Qe=>new Ze(Qe),Ze})();function Ke(Ze){var Qe;return null!==(Qe=Ze??_e.config.Promise)&&void 0!==Qe?Qe:Promise}},8645:(Hn,It,X)=>{"use strict";X.d(It,{x:()=>Le});var M=X(5592),w=X(7394);const l=(0,X(2306).d)(Ke=>function(){Ke(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var _e=X(9039),Ne=X(1441);let Le=(()=>{class Ke extends M.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Ae){const Ze=new tt(this,this);return Ze.operator=Ae,Ze}_throwIfClosed(){if(this.closed)throw new l}next(Ae){(0,Ne.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Ze of this.currentObservers)Ze.next(Ae)}})}error(Ae){(0,Ne.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Ae;const{observers:Ze}=this;for(;Ze.length;)Ze.shift().error(Ae)}})}complete(){(0,Ne.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Ae}=this;for(;Ae.length;)Ae.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Ae;return(null===(Ae=this.observers)||void 0===Ae?void 0:Ae.length)>0}_trySubscribe(Ae){return this._throwIfClosed(),super._trySubscribe(Ae)}_subscribe(Ae){return this._throwIfClosed(),this._checkFinalizedStatuses(Ae),this._innerSubscribe(Ae)}_innerSubscribe(Ae){const{hasError:Ze,isStopped:Qe,observers:ot}=this;return Ze||Qe?w.Lc:(this.currentObservers=null,ot.push(Ae),new w.w0(()=>{this.currentObservers=null,(0,_e.P)(ot,Ae)}))}_checkFinalizedStatuses(Ae){const{hasError:Ze,thrownError:Qe,isStopped:ot}=this;Ze?Ae.error(Qe):ot&&Ae.complete()}asObservable(){const Ae=new M.y;return Ae.source=this,Ae}}return Ke.create=(ye,Ae)=>new tt(ye,Ae),Ke})();class tt extends Le{constructor(ye,Ae){super(),this.destination=ye,this.source=Ae}next(ye){var Ae,Ze;null===(Ze=null===(Ae=this.destination)||void 0===Ae?void 0:Ae.next)||void 0===Ze||Ze.call(Ae,ye)}error(ye){var Ae,Ze;null===(Ze=null===(Ae=this.destination)||void 0===Ae?void 0:Ae.error)||void 0===Ze||Ze.call(Ae,ye)}complete(){var ye,Ae;null===(Ae=null===(ye=this.destination)||void 0===ye?void 0:ye.complete)||void 0===Ae||Ae.call(ye)}_subscribe(ye){var Ae,Ze;return null!==(Ze=null===(Ae=this.source)||void 0===Ae?void 0:Ae.subscribe(ye))&&void 0!==Ze?Ze:w.Lc}}},305:(Hn,It,X)=>{"use strict";X.d(It,{Hp:()=>xt,Lv:()=>Ze});var M=X(4674),w=X(7394),lt=X(2653),l=X(3894),_e=X(2420);const Ne=Ke("C",void 0,void 0);function Ke(Ce,Ie,ct){return{kind:Ce,value:Ie,error:ct}}var ye=X(7599),Ae=X(1441);class Ze extends w.w0{constructor(Ie){super(),this.isStopped=!1,Ie?(this.destination=Ie,(0,w.Nn)(Ie)&&Ie.add(this)):this.destination=Pt}static create(Ie,ct,St){return new xt(Ie,ct,St)}next(Ie){this.isStopped?Ot(function tt(Ce){return Ke("N",Ce,void 0)}(Ie),this):this._next(Ie)}error(Ie){this.isStopped?Ot(function Le(Ce){return Ke("E",void 0,Ce)}(Ie),this):(this.isStopped=!0,this._error(Ie))}complete(){this.isStopped?Ot(Ne,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ie){this.destination.next(Ie)}_error(Ie){try{this.destination.error(Ie)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Qe=Function.prototype.bind;function ot(Ce,Ie){return Qe.call(Ce,Ie)}class mt{constructor(Ie){this.partialObserver=Ie}next(Ie){const{partialObserver:ct}=this;if(ct.next)try{ct.next(Ie)}catch(St){pt(St)}}error(Ie){const{partialObserver:ct}=this;if(ct.error)try{ct.error(Ie)}catch(St){pt(St)}else pt(Ie)}complete(){const{partialObserver:Ie}=this;if(Ie.complete)try{Ie.complete()}catch(ct){pt(ct)}}}class xt extends Ze{constructor(Ie,ct,St){let Ye;if(super(),(0,M.m)(Ie)||!Ie)Ye={next:Ie??void 0,error:ct??void 0,complete:St??void 0};else{let gt;this&&lt.config.useDeprecatedNextContext?(gt=Object.create(Ie),gt.unsubscribe=()=>this.unsubscribe(),Ye={next:Ie.next&&ot(Ie.next,gt),error:Ie.error&&ot(Ie.error,gt),complete:Ie.complete&&ot(Ie.complete,gt)}):Ye=Ie}this.destination=new mt(Ye)}}function pt(Ce){lt.config.useDeprecatedSynchronousErrorHandling?(0,Ae.O)(Ce):(0,l.h)(Ce)}function Ot(Ce,Ie){const{onStoppedNotification:ct}=lt.config;ct&&ye.z.setTimeout(()=>ct(Ce,Ie))}const Pt={closed:!0,next:_e.Z,error:function et(Ce){throw Ce},complete:_e.Z}},7394:(Hn,It,X)=>{"use strict";X.d(It,{Lc:()=>Ne,w0:()=>_e,Nn:()=>Le});var M=X(4674);const lt=(0,X(2306).d)(Ke=>function(Ae){Ke(this),this.message=Ae?`${Ae.length} errors occurred during unsubscription:\n${Ae.map((Ze,Qe)=>`${Qe+1}) ${Ze.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Ae});var l=X(9039);class _e{constructor(ye){this.initialTeardown=ye,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ye;if(!this.closed){this.closed=!0;const{_parentage:Ae}=this;if(Ae)if(this._parentage=null,Array.isArray(Ae))for(const ot of Ae)ot.remove(this);else Ae.remove(this);const{initialTeardown:Ze}=this;if((0,M.m)(Ze))try{Ze()}catch(ot){ye=ot instanceof lt?ot.errors:[ot]}const{_finalizers:Qe}=this;if(Qe){this._finalizers=null;for(const ot of Qe)try{tt(ot)}catch(mt){ye=ye??[],mt instanceof lt?ye=[...ye,...mt.errors]:ye.push(mt)}}if(ye)throw new lt(ye)}}add(ye){var Ae;if(ye&&ye!==this)if(this.closed)tt(ye);else{if(ye instanceof _e){if(ye.closed||ye._hasParent(this))return;ye._addParent(this)}(this._finalizers=null!==(Ae=this._finalizers)&&void 0!==Ae?Ae:[]).push(ye)}}_hasParent(ye){const{_parentage:Ae}=this;return Ae===ye||Array.isArray(Ae)&&Ae.includes(ye)}_addParent(ye){const{_parentage:Ae}=this;this._parentage=Array.isArray(Ae)?(Ae.push(ye),Ae):Ae?[Ae,ye]:ye}_removeParent(ye){const{_parentage:Ae}=this;Ae===ye?this._parentage=null:Array.isArray(Ae)&&(0,l.P)(Ae,ye)}remove(ye){const{_finalizers:Ae}=this;Ae&&(0,l.P)(Ae,ye),ye instanceof _e&&ye._removeParent(this)}}_e.EMPTY=(()=>{const Ke=new _e;return Ke.closed=!0,Ke})();const Ne=_e.EMPTY;function Le(Ke){return Ke instanceof _e||Ke&&"closed"in Ke&&(0,M.m)(Ke.remove)&&(0,M.m)(Ke.add)&&(0,M.m)(Ke.unsubscribe)}function tt(Ke){(0,M.m)(Ke)?Ke():Ke.unsubscribe()}},2653:(Hn,It,X)=>{"use strict";X.d(It,{config:()=>M});const M={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(Hn,It,X)=>{"use strict";X.d(It,{a:()=>ye});var M=X(5592),w=X(7453),lt=X(2459),l=X(2737),_e=X(7400),Ne=X(9940),Le=X(2714),tt=X(8251),Ke=X(7103);function ye(...Qe){const ot=(0,Ne.yG)(Qe),mt=(0,Ne.jO)(Qe),{args:xt,keys:pt}=(0,w.D)(Qe);if(0===xt.length)return(0,lt.D)([],ot);const et=new M.y(function Ae(Qe,ot,mt=l.y){return xt=>{Ze(ot,()=>{const{length:pt}=Qe,et=new Array(pt);let Ot=pt,Pt=pt;for(let Ce=0;Ce<pt;Ce++)Ze(ot,()=>{const Ie=(0,lt.D)(Qe[Ce],ot);let ct=!1;Ie.subscribe((0,tt.x)(xt,St=>{et[Ce]=St,ct||(ct=!0,Pt--),Pt||xt.next(mt(et.slice()))},()=>{--Ot||xt.complete()}))},xt)},xt)}}(xt,ot,pt?Ot=>(0,Le.n)(pt,Ot):l.y));return mt?et.pipe((0,_e.Z)(mt)):et}function Ze(Qe,ot,mt){Qe?(0,Ke.f)(mt,Qe,ot):ot()}},5211:(Hn,It,X)=>{"use strict";X.d(It,{z:()=>_e});var M=X(7537),lt=X(9940),l=X(2459);function _e(...Ne){return function w(){return(0,M.J)(1)}()((0,l.D)(Ne,(0,lt.yG)(Ne)))}},4911:(Hn,It,X)=>{"use strict";X.d(It,{P:()=>lt});var M=X(5592),w=X(4829);function lt(l){return new M.y(_e=>{(0,w.Xf)(l()).subscribe(_e)})}},6232:(Hn,It,X)=>{"use strict";X.d(It,{E:()=>w});const w=new(X(5592).y)(_e=>_e.complete())},2459:(Hn,It,X)=>{"use strict";X.d(It,{D:()=>Ie});var M=X(4829),w=X(3093),lt=X(5137),Ne=X(5592),tt=X(4971),Ke=X(4674),ye=X(7103);function Ze(ct,St){if(!ct)throw new Error("Iterable cannot be null");return new Ne.y(Ye=>{(0,ye.f)(Ye,St,()=>{const gt=ct[Symbol.asyncIterator]();(0,ye.f)(Ye,St,()=>{gt.next().then(Wt=>{Wt.done?Ye.complete():Ye.next(Wt.value)})},0,!0)})})}var Qe=X(8382),ot=X(4026),mt=X(4266),xt=X(3664),pt=X(5726),et=X(9853),Ot=X(541);function Ie(ct,St){return St?function Ce(ct,St){if(null!=ct){if((0,Qe.c)(ct))return function l(ct,St){return(0,M.Xf)(ct).pipe((0,lt.R)(St),(0,w.Q)(St))}(ct,St);if((0,mt.z)(ct))return function Le(ct,St){return new Ne.y(Ye=>{let gt=0;return St.schedule(function(){gt===ct.length?Ye.complete():(Ye.next(ct[gt++]),Ye.closed||this.schedule())})})}(ct,St);if((0,ot.t)(ct))return function _e(ct,St){return(0,M.Xf)(ct).pipe((0,lt.R)(St),(0,w.Q)(St))}(ct,St);if((0,pt.D)(ct))return Ze(ct,St);if((0,xt.T)(ct))return function Ae(ct,St){return new Ne.y(Ye=>{let gt;return(0,ye.f)(Ye,St,()=>{gt=ct[tt.h](),(0,ye.f)(Ye,St,()=>{let Wt,Nt;try{({value:Wt,done:Nt}=gt.next())}catch(an){return void Ye.error(an)}Nt?Ye.complete():Ye.next(Wt)},0,!0)}),()=>(0,Ke.m)(gt?.return)&&gt.return()})}(ct,St);if((0,Ot.L)(ct))return function Pt(ct,St){return Ze((0,Ot.Q)(ct),St)}(ct,St)}throw(0,et.z)(ct)}(ct,St):(0,M.Xf)(ct)}},2438:(Hn,It,X)=>{"use strict";X.d(It,{R:()=>ye});var M=X(4829),w=X(5592),lt=X(1631),l=X(4266),_e=X(4674),Ne=X(7400);const Le=["addListener","removeListener"],tt=["addEventListener","removeEventListener"],Ke=["on","off"];function ye(mt,xt,pt,et){if((0,_e.m)(pt)&&(et=pt,pt=void 0),et)return ye(mt,xt,pt).pipe((0,Ne.Z)(et));const[Ot,Pt]=function ot(mt){return(0,_e.m)(mt.addEventListener)&&(0,_e.m)(mt.removeEventListener)}(mt)?tt.map(Ce=>Ie=>mt[Ce](xt,Ie,pt)):function Ze(mt){return(0,_e.m)(mt.addListener)&&(0,_e.m)(mt.removeListener)}(mt)?Le.map(Ae(mt,xt)):function Qe(mt){return(0,_e.m)(mt.on)&&(0,_e.m)(mt.off)}(mt)?Ke.map(Ae(mt,xt)):[];if(!Ot&&(0,l.z)(mt))return(0,lt.z)(Ce=>ye(Ce,xt,pt))((0,M.Xf)(mt));if(!Ot)throw new TypeError("Invalid event target");return new w.y(Ce=>{const Ie=(...ct)=>Ce.next(1<ct.length?ct:ct[0]);return Ot(Ie),()=>Pt(Ie)})}function Ae(mt,xt){return pt=>et=>mt[pt](xt,et)}},4829:(Hn,It,X)=>{"use strict";X.d(It,{Xf:()=>Qe});var M=X(7582),w=X(4266),lt=X(4026),l=X(5592),_e=X(8382),Ne=X(5726),Le=X(9853),tt=X(3664),Ke=X(541),ye=X(4674),Ae=X(3894),Ze=X(4850);function Qe(Ce){if(Ce instanceof l.y)return Ce;if(null!=Ce){if((0,_e.c)(Ce))return function ot(Ce){return new l.y(Ie=>{const ct=Ce[Ze.L]();if((0,ye.m)(ct.subscribe))return ct.subscribe(Ie);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ce);if((0,w.z)(Ce))return function mt(Ce){return new l.y(Ie=>{for(let ct=0;ct<Ce.length&&!Ie.closed;ct++)Ie.next(Ce[ct]);Ie.complete()})}(Ce);if((0,lt.t)(Ce))return function xt(Ce){return new l.y(Ie=>{Ce.then(ct=>{Ie.closed||(Ie.next(ct),Ie.complete())},ct=>Ie.error(ct)).then(null,Ae.h)})}(Ce);if((0,Ne.D)(Ce))return et(Ce);if((0,tt.T)(Ce))return function pt(Ce){return new l.y(Ie=>{for(const ct of Ce)if(Ie.next(ct),Ie.closed)return;Ie.complete()})}(Ce);if((0,Ke.L)(Ce))return function Ot(Ce){return et((0,Ke.Q)(Ce))}(Ce)}throw(0,Le.z)(Ce)}function et(Ce){return new l.y(Ie=>{(function Pt(Ce,Ie){var ct,St,Ye,gt;return(0,M.mG)(this,void 0,void 0,function*(){try{for(ct=(0,M.KL)(Ce);!(St=yield ct.next()).done;)if(Ie.next(St.value),Ie.closed)return}catch(Wt){Ye={error:Wt}}finally{try{St&&!St.done&&(gt=ct.return)&&(yield gt.call(ct))}finally{if(Ye)throw Ye.error}}Ie.complete()})})(Ce,Ie).catch(ct=>Ie.error(ct))})}},3019:(Hn,It,X)=>{"use strict";X.d(It,{T:()=>Ne});var M=X(7537),w=X(4829),lt=X(6232),l=X(9940),_e=X(2459);function Ne(...Le){const tt=(0,l.yG)(Le),Ke=(0,l._6)(Le,1/0),ye=Le;return ye.length?1===ye.length?(0,w.Xf)(ye[0]):(0,M.J)(Ke)((0,_e.D)(ye,tt)):lt.E}},2096:(Hn,It,X)=>{"use strict";X.d(It,{of:()=>lt});var M=X(9940),w=X(2459);function lt(...l){const _e=(0,M.yG)(l);return(0,w.D)(l,_e)}},8251:(Hn,It,X)=>{"use strict";X.d(It,{x:()=>w});var M=X(305);function w(l,_e,Ne,Le,tt){return new lt(l,_e,Ne,Le,tt)}class lt extends M.Lv{constructor(_e,Ne,Le,tt,Ke,ye){super(_e),this.onFinalize=Ke,this.shouldUnsubscribe=ye,this._next=Ne?function(Ae){try{Ne(Ae)}catch(Ze){_e.error(Ze)}}:super._next,this._error=tt?function(Ae){try{tt(Ae)}catch(Ze){_e.error(Ze)}finally{this.unsubscribe()}}:super._error,this._complete=Le?function(){try{Le()}catch(Ae){_e.error(Ae)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var _e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ne}=this;super.unsubscribe(),!Ne&&(null===(_e=this.onFinalize)||void 0===_e||_e.call(this))}}}},6306:(Hn,It,X)=>{"use strict";X.d(It,{K:()=>l});var M=X(4829),w=X(8251),lt=X(9360);function l(_e){return(0,lt.e)((Ne,Le)=>{let ye,tt=null,Ke=!1;tt=Ne.subscribe((0,w.x)(Le,void 0,void 0,Ae=>{ye=(0,M.Xf)(_e(Ae,l(_e)(Ne))),tt?(tt.unsubscribe(),tt=null,ye.subscribe(Le)):Ke=!0})),Ke&&(tt.unsubscribe(),tt=null,ye.subscribe(Le))})}},6328:(Hn,It,X)=>{"use strict";X.d(It,{b:()=>lt});var M=X(1631),w=X(4674);function lt(l,_e){return(0,w.m)(_e)?(0,M.z)(l,_e,1):(0,M.z)(l,1)}},3572:(Hn,It,X)=>{"use strict";X.d(It,{d:()=>lt});var M=X(9360),w=X(8251);function lt(l){return(0,M.e)((_e,Ne)=>{let Le=!1;_e.subscribe((0,w.x)(Ne,tt=>{Le=!0,Ne.next(tt)},()=>{Le||Ne.next(l),Ne.complete()}))})}},3997:(Hn,It,X)=>{"use strict";X.d(It,{x:()=>l});var M=X(2737),w=X(9360),lt=X(8251);function l(Ne,Le=M.y){return Ne=Ne??_e,(0,w.e)((tt,Ke)=>{let ye,Ae=!0;tt.subscribe((0,lt.x)(Ke,Ze=>{const Qe=Le(Ze);(Ae||!Ne(ye,Qe))&&(Ae=!1,ye=Qe,Ke.next(Ze))}))})}function _e(Ne,Le){return Ne===Le}},2181:(Hn,It,X)=>{"use strict";X.d(It,{h:()=>lt});var M=X(9360),w=X(8251);function lt(l,_e){return(0,M.e)((Ne,Le)=>{let tt=0;Ne.subscribe((0,w.x)(Le,Ke=>l.call(_e,Ke,tt++)&&Le.next(Ke)))})}},4716:(Hn,It,X)=>{"use strict";X.d(It,{x:()=>w});var M=X(9360);function w(lt){return(0,M.e)((l,_e)=>{try{l.subscribe(_e)}finally{_e.add(lt)}})}},1374:(Hn,It,X)=>{"use strict";X.d(It,{P:()=>Le});var M=X(6973),w=X(2181),lt=X(8180),l=X(3572),_e=X(3026),Ne=X(2737);function Le(tt,Ke){const ye=arguments.length>=2;return Ae=>Ae.pipe(tt?(0,w.h)((Ze,Qe)=>tt(Ze,Qe,Ae)):Ne.y,(0,lt.q)(1),ye?(0,l.d)(Ke):(0,_e.T)(()=>new M.K))}},7398:(Hn,It,X)=>{"use strict";X.d(It,{U:()=>lt});var M=X(9360),w=X(8251);function lt(l,_e){return(0,M.e)((Ne,Le)=>{let tt=0;Ne.subscribe((0,w.x)(Le,Ke=>{Le.next(l.call(_e,Ke,tt++))}))})}},7537:(Hn,It,X)=>{"use strict";X.d(It,{J:()=>lt});var M=X(1631),w=X(2737);function lt(l=1/0){return(0,M.z)(w.y,l)}},1631:(Hn,It,X)=>{"use strict";X.d(It,{z:()=>tt});var M=X(7398),w=X(4829),lt=X(9360),l=X(7103),_e=X(8251),Le=X(4674);function tt(Ke,ye,Ae=1/0){return(0,Le.m)(ye)?tt((Ze,Qe)=>(0,M.U)((ot,mt)=>ye(Ze,ot,Qe,mt))((0,w.Xf)(Ke(Ze,Qe))),Ae):("number"==typeof ye&&(Ae=ye),(0,lt.e)((Ze,Qe)=>function Ne(Ke,ye,Ae,Ze,Qe,ot,mt,xt){const pt=[];let et=0,Ot=0,Pt=!1;const Ce=()=>{Pt&&!pt.length&&!et&&ye.complete()},Ie=St=>et<Ze?ct(St):pt.push(St),ct=St=>{ot&&ye.next(St),et++;let Ye=!1;(0,w.Xf)(Ae(St,Ot++)).subscribe((0,_e.x)(ye,gt=>{Qe?.(gt),ot?Ie(gt):ye.next(gt)},()=>{Ye=!0},void 0,()=>{if(Ye)try{for(et--;pt.length&&et<Ze;){const gt=pt.shift();mt?(0,l.f)(ye,mt,()=>ct(gt)):ct(gt)}Ce()}catch(gt){ye.error(gt)}}))};return Ke.subscribe((0,_e.x)(ye,Ie,()=>{Pt=!0,Ce()})),()=>{xt?.()}}(Ze,Qe,Ke,Ae)))}},3093:(Hn,It,X)=>{"use strict";X.d(It,{Q:()=>l});var M=X(7103),w=X(9360),lt=X(8251);function l(_e,Ne=0){return(0,w.e)((Le,tt)=>{Le.subscribe((0,lt.x)(tt,Ke=>(0,M.f)(tt,_e,()=>tt.next(Ke),Ne),()=>(0,M.f)(tt,_e,()=>tt.complete(),Ne),Ke=>(0,M.f)(tt,_e,()=>tt.error(Ke),Ne)))})}},6699:(Hn,It,X)=>{"use strict";X.d(It,{R:()=>l});var M=X(9360),w=X(8251);function l(_e,Ne){return(0,M.e)(function lt(_e,Ne,Le,tt,Ke){return(ye,Ae)=>{let Ze=Le,Qe=Ne,ot=0;ye.subscribe((0,w.x)(Ae,mt=>{const xt=ot++;Qe=Ze?_e(Qe,mt,xt):(Ze=!0,mt),tt&&Ae.next(Qe)},Ke&&(()=>{Ze&&Ae.next(Qe),Ae.complete()})))}}(_e,Ne,arguments.length>=2,!0))}},3020:(Hn,It,X)=>{"use strict";X.d(It,{B:()=>_e});var M=X(4829),w=X(8645),lt=X(305),l=X(9360);function _e(Le={}){const{connector:tt=(()=>new w.x),resetOnError:Ke=!0,resetOnComplete:ye=!0,resetOnRefCountZero:Ae=!0}=Le;return Ze=>{let Qe,ot,mt,xt=0,pt=!1,et=!1;const Ot=()=>{ot?.unsubscribe(),ot=void 0},Pt=()=>{Ot(),Qe=mt=void 0,pt=et=!1},Ce=()=>{const Ie=Qe;Pt(),Ie?.unsubscribe()};return(0,l.e)((Ie,ct)=>{xt++,!et&&!pt&&Ot();const St=mt=mt??tt();ct.add(()=>{xt--,0===xt&&!et&&!pt&&(ot=Ne(Ce,Ae))}),St.subscribe(ct),!Qe&&xt>0&&(Qe=new lt.Hp({next:Ye=>St.next(Ye),error:Ye=>{et=!0,Ot(),ot=Ne(Pt,Ke,Ye),St.error(Ye)},complete:()=>{pt=!0,Ot(),ot=Ne(Pt,ye),St.complete()}}),(0,M.Xf)(Ie).subscribe(Qe))})(Ze)}}function Ne(Le,tt,...Ke){if(!0===tt)return void Le();if(!1===tt)return;const ye=new lt.Hp({next:()=>{ye.unsubscribe(),Le()}});return(0,M.Xf)(tt(...Ke)).subscribe(ye)}},7921:(Hn,It,X)=>{"use strict";X.d(It,{O:()=>l});var M=X(5211),w=X(9940),lt=X(9360);function l(..._e){const Ne=(0,w.yG)(_e);return(0,lt.e)((Le,tt)=>{(Ne?(0,M.z)(_e,Le,Ne):(0,M.z)(_e,Le)).subscribe(tt)})}},5137:(Hn,It,X)=>{"use strict";X.d(It,{R:()=>w});var M=X(9360);function w(lt,l=0){return(0,M.e)((_e,Ne)=>{Ne.add(lt.schedule(()=>_e.subscribe(Ne),l))})}},4664:(Hn,It,X)=>{"use strict";X.d(It,{w:()=>l});var M=X(4829),w=X(9360),lt=X(8251);function l(_e,Ne){return(0,w.e)((Le,tt)=>{let Ke=null,ye=0,Ae=!1;const Ze=()=>Ae&&!Ke&&tt.complete();Le.subscribe((0,lt.x)(tt,Qe=>{Ke?.unsubscribe();let ot=0;const mt=ye++;(0,M.Xf)(_e(Qe,mt)).subscribe(Ke=(0,lt.x)(tt,xt=>tt.next(Ne?Ne(Qe,xt,mt,ot++):xt),()=>{Ke=null,Ze()}))},()=>{Ae=!0,Ze()}))})}},8180:(Hn,It,X)=>{"use strict";X.d(It,{q:()=>l});var M=X(6232),w=X(9360),lt=X(8251);function l(_e){return _e<=0?()=>M.E:(0,w.e)((Ne,Le)=>{let tt=0;Ne.subscribe((0,lt.x)(Le,Ke=>{++tt<=_e&&(Le.next(Ke),_e<=tt&&Le.complete())}))})}},9397:(Hn,It,X)=>{"use strict";X.d(It,{b:()=>_e});var M=X(4674),w=X(9360),lt=X(8251),l=X(2737);function _e(Ne,Le,tt){const Ke=(0,M.m)(Ne)||Le||tt?{next:Ne,error:Le,complete:tt}:Ne;return Ke?(0,w.e)((ye,Ae)=>{var Ze;null===(Ze=Ke.subscribe)||void 0===Ze||Ze.call(Ke);let Qe=!0;ye.subscribe((0,lt.x)(Ae,ot=>{var mt;null===(mt=Ke.next)||void 0===mt||mt.call(Ke,ot),Ae.next(ot)},()=>{var ot;Qe=!1,null===(ot=Ke.complete)||void 0===ot||ot.call(Ke),Ae.complete()},ot=>{var mt;Qe=!1,null===(mt=Ke.error)||void 0===mt||mt.call(Ke,ot),Ae.error(ot)},()=>{var ot,mt;Qe&&(null===(ot=Ke.unsubscribe)||void 0===ot||ot.call(Ke)),null===(mt=Ke.finalize)||void 0===mt||mt.call(Ke)}))}):l.y}},3026:(Hn,It,X)=>{"use strict";X.d(It,{T:()=>l});var M=X(6973),w=X(9360),lt=X(8251);function l(Ne=_e){return(0,w.e)((Le,tt)=>{let Ke=!1;Le.subscribe((0,lt.x)(tt,ye=>{Ke=!0,tt.next(ye)},()=>Ke?tt.complete():tt.error(Ne())))})}function _e(){return new M.K}},1954:(Hn,It,X)=>{"use strict";X.d(It,{o:()=>_e});var M=X(7394);class w extends M.w0{constructor(Le,tt){super()}schedule(Le,tt=0){return this}}const lt={setInterval(Ne,Le,...tt){const{delegate:Ke}=lt;return Ke?.setInterval?Ke.setInterval(Ne,Le,...tt):setInterval(Ne,Le,...tt)},clearInterval(Ne){const{delegate:Le}=lt;return(Le?.clearInterval||clearInterval)(Ne)},delegate:void 0};var l=X(9039);class _e extends w{constructor(Le,tt){super(Le,tt),this.scheduler=Le,this.work=tt,this.pending=!1}schedule(Le,tt=0){var Ke;if(this.closed)return this;this.state=Le;const ye=this.id,Ae=this.scheduler;return null!=ye&&(this.id=this.recycleAsyncId(Ae,ye,tt)),this.pending=!0,this.delay=tt,this.id=null!==(Ke=this.id)&&void 0!==Ke?Ke:this.requestAsyncId(Ae,this.id,tt),this}requestAsyncId(Le,tt,Ke=0){return lt.setInterval(Le.flush.bind(Le,this),Ke)}recycleAsyncId(Le,tt,Ke=0){if(null!=Ke&&this.delay===Ke&&!1===this.pending)return tt;null!=tt&&lt.clearInterval(tt)}execute(Le,tt){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Ke=this._execute(Le,tt);if(Ke)return Ke;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Le,tt){let ye,Ke=!1;try{this.work(Le)}catch(Ae){Ke=!0,ye=Ae||new Error("Scheduled action threw falsy error")}if(Ke)return this.unsubscribe(),ye}unsubscribe(){if(!this.closed){const{id:Le,scheduler:tt}=this,{actions:Ke}=tt;this.work=this.state=this.scheduler=null,this.pending=!1,(0,l.P)(Ke,this),null!=Le&&(this.id=this.recycleAsyncId(tt,Le,null)),this.delay=null,super.unsubscribe()}}}},2631:(Hn,It,X)=>{"use strict";X.d(It,{v:()=>lt});var M=X(4552);class w{constructor(_e,Ne=w.now){this.schedulerActionCtor=_e,this.now=Ne}schedule(_e,Ne=0,Le){return new this.schedulerActionCtor(this,_e).schedule(Le,Ne)}}w.now=M.l.now;class lt extends w{constructor(_e,Ne=w.now){super(_e,Ne),this.actions=[],this._active=!1}flush(_e){const{actions:Ne}=this;if(this._active)return void Ne.push(_e);let Le;this._active=!0;do{if(Le=_e.execute(_e.state,_e.delay))break}while(_e=Ne.shift());if(this._active=!1,Le){for(;_e=Ne.shift();)_e.unsubscribe();throw Le}}}},6321:(Hn,It,X)=>{"use strict";X.d(It,{P:()=>l,z:()=>lt});var M=X(1954);const lt=new(X(2631).v)(M.o),l=lt},4552:(Hn,It,X)=>{"use strict";X.d(It,{l:()=>M});const M={now:()=>(M.delegate||Date).now(),delegate:void 0}},7599:(Hn,It,X)=>{"use strict";X.d(It,{z:()=>M});const M={setTimeout(w,lt,...l){const{delegate:_e}=M;return _e?.setTimeout?_e.setTimeout(w,lt,...l):setTimeout(w,lt,...l)},clearTimeout(w){const{delegate:lt}=M;return(lt?.clearTimeout||clearTimeout)(w)},delegate:void 0}},4971:(Hn,It,X)=>{"use strict";X.d(It,{h:()=>w});const w=function M(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Hn,It,X)=>{"use strict";X.d(It,{L:()=>M});const M="function"==typeof Symbol&&Symbol.observable||"@@observable"},6973:(Hn,It,X)=>{"use strict";X.d(It,{K:()=>w});const w=(0,X(2306).d)(lt=>function(){lt(this),this.name="EmptyError",this.message="no elements in sequence"})},9940:(Hn,It,X)=>{"use strict";X.d(It,{_6:()=>Ne,jO:()=>l,yG:()=>_e});var M=X(4674),w=X(671);function lt(Le){return Le[Le.length-1]}function l(Le){return(0,M.m)(lt(Le))?Le.pop():void 0}function _e(Le){return(0,w.K)(lt(Le))?Le.pop():void 0}function Ne(Le,tt){return"number"==typeof lt(Le)?Le.pop():tt}},7453:(Hn,It,X)=>{"use strict";X.d(It,{D:()=>_e});const{isArray:M}=Array,{getPrototypeOf:w,prototype:lt,keys:l}=Object;function _e(Le){if(1===Le.length){const tt=Le[0];if(M(tt))return{args:tt,keys:null};if(function Ne(Le){return Le&&"object"==typeof Le&&w(Le)===lt}(tt)){const Ke=l(tt);return{args:Ke.map(ye=>tt[ye]),keys:Ke}}}return{args:Le,keys:null}}},9039:(Hn,It,X)=>{"use strict";function M(w,lt){if(w){const l=w.indexOf(lt);0<=l&&w.splice(l,1)}}X.d(It,{P:()=>M})},2306:(Hn,It,X)=>{"use strict";function M(w){const l=w(_e=>{Error.call(_e),_e.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}X.d(It,{d:()=>M})},2714:(Hn,It,X)=>{"use strict";function M(w,lt){return w.reduce((l,_e,Ne)=>(l[_e]=lt[Ne],l),{})}X.d(It,{n:()=>M})},1441:(Hn,It,X)=>{"use strict";X.d(It,{O:()=>l,x:()=>lt});var M=X(2653);let w=null;function lt(_e){if(M.config.useDeprecatedSynchronousErrorHandling){const Ne=!w;if(Ne&&(w={errorThrown:!1,error:null}),_e(),Ne){const{errorThrown:Le,error:tt}=w;if(w=null,Le)throw tt}}else _e()}function l(_e){M.config.useDeprecatedSynchronousErrorHandling&&w&&(w.errorThrown=!0,w.error=_e)}},7103:(Hn,It,X)=>{"use strict";function M(w,lt,l,_e=0,Ne=!1){const Le=lt.schedule(function(){l(),Ne?w.add(this.schedule(null,_e)):this.unsubscribe()},_e);if(w.add(Le),!Ne)return Le}X.d(It,{f:()=>M})},2737:(Hn,It,X)=>{"use strict";function M(w){return w}X.d(It,{y:()=>M})},4266:(Hn,It,X)=>{"use strict";X.d(It,{z:()=>M});const M=w=>w&&"number"==typeof w.length&&"function"!=typeof w},5726:(Hn,It,X)=>{"use strict";X.d(It,{D:()=>w});var M=X(4674);function w(lt){return Symbol.asyncIterator&&(0,M.m)(lt?.[Symbol.asyncIterator])}},4674:(Hn,It,X)=>{"use strict";function M(w){return"function"==typeof w}X.d(It,{m:()=>M})},8382:(Hn,It,X)=>{"use strict";X.d(It,{c:()=>lt});var M=X(4850),w=X(4674);function lt(l){return(0,w.m)(l[M.L])}},3664:(Hn,It,X)=>{"use strict";X.d(It,{T:()=>lt});var M=X(4971),w=X(4674);function lt(l){return(0,w.m)(l?.[M.h])}},4026:(Hn,It,X)=>{"use strict";X.d(It,{t:()=>w});var M=X(4674);function w(lt){return(0,M.m)(lt?.then)}},541:(Hn,It,X)=>{"use strict";X.d(It,{L:()=>l,Q:()=>lt});var M=X(7582),w=X(4674);function lt(_e){return(0,M.FC)(this,arguments,function*(){const Le=_e.getReader();try{for(;;){const{value:tt,done:Ke}=yield(0,M.qq)(Le.read());if(Ke)return yield(0,M.qq)(void 0);yield yield(0,M.qq)(tt)}}finally{Le.releaseLock()}})}function l(_e){return(0,w.m)(_e?.getReader)}},671:(Hn,It,X)=>{"use strict";X.d(It,{K:()=>w});var M=X(4674);function w(lt){return lt&&(0,M.m)(lt.schedule)}},9360:(Hn,It,X)=>{"use strict";X.d(It,{A:()=>w,e:()=>lt});var M=X(4674);function w(l){return(0,M.m)(l?.lift)}function lt(l){return _e=>{if(w(_e))return _e.lift(function(Ne){try{return l(Ne,this)}catch(Le){this.error(Le)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(Hn,It,X)=>{"use strict";X.d(It,{Z:()=>l});var M=X(7398);const{isArray:w}=Array;function l(_e){return(0,M.U)(Ne=>function lt(_e,Ne){return w(Ne)?_e(...Ne):_e(Ne)}(_e,Ne))}},2420:(Hn,It,X)=>{"use strict";function M(){}X.d(It,{Z:()=>M})},8407:(Hn,It,X)=>{"use strict";X.d(It,{U:()=>lt,z:()=>w});var M=X(2737);function w(...l){return lt(l)}function lt(l){return 0===l.length?M.y:1===l.length?l[0]:function(Ne){return l.reduce((Le,tt)=>tt(Le),Ne)}}},3894:(Hn,It,X)=>{"use strict";X.d(It,{h:()=>lt});var M=X(2653),w=X(7599);function lt(l){w.z.setTimeout(()=>{const{onUnhandledError:_e}=M.config;if(!_e)throw l;_e(l)})}},9853:(Hn,It,X)=>{"use strict";function M(w){return new TypeError(`You provided ${null!==w&&"object"==typeof w?"an invalid object":`'${w}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}X.d(It,{z:()=>M})},863:(Hn,It,X)=>{var M={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,982,433],"./ion-datetime_3.entry.js":[7059,982,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function w(lt){if(!X.o(M,lt))return Promise.resolve().then(()=>{var Ne=new Error("Cannot find module '"+lt+"'");throw Ne.code="MODULE_NOT_FOUND",Ne});var l=M[lt],_e=l[0];return Promise.all(l.slice(1).map(X.e)).then(()=>X(_e))}w.keys=()=>Object.keys(M),w.id=863,Hn.exports=w},6825:(Hn,It,X)=>{"use strict";X.d(It,{IO:()=>mt,LC:()=>w,SB:()=>Ke,X$:()=>l,ZE:()=>et,ZN:()=>pt,_j:()=>M,eR:()=>Ae,jt:()=>_e,k1:()=>Ot,l3:()=>lt,oB:()=>tt,pV:()=>Qe,vP:()=>Le});class M{}class w{}const lt="*";function l(Pt,Ce){return{type:7,name:Pt,definitions:Ce,options:{}}}function _e(Pt,Ce=null){return{type:4,styles:Ce,timings:Pt}}function Le(Pt,Ce=null){return{type:2,steps:Pt,options:Ce}}function tt(Pt){return{type:6,styles:Pt,offset:null}}function Ke(Pt,Ce,Ie){return{type:0,name:Pt,styles:Ce,options:Ie}}function Ae(Pt,Ce,Ie=null){return{type:1,expr:Pt,animation:Ce,options:Ie}}function Qe(Pt=null){return{type:9,options:Pt}}function mt(Pt,Ce,Ie=null){return{type:11,selector:Pt,animation:Ce,options:Ie}}class pt{constructor(Ce=0,Ie=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=Ce+Ie}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Ce=>Ce()),this._onDoneFns=[])}onStart(Ce){this._originalOnStartFns.push(Ce),this._onStartFns.push(Ce)}onDone(Ce){this._originalOnDoneFns.push(Ce),this._onDoneFns.push(Ce)}onDestroy(Ce){this._onDestroyFns.push(Ce)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(Ce=>Ce()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(Ce=>Ce()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(Ce){this._position=this.totalTime?Ce*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(Ce){const Ie="start"==Ce?this._onStartFns:this._onDoneFns;Ie.forEach(ct=>ct()),Ie.length=0}}class et{constructor(Ce){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=Ce;let Ie=0,ct=0,St=0;const Ye=this.players.length;0==Ye?queueMicrotask(()=>this._onFinish()):this.players.forEach(gt=>{gt.onDone(()=>{++Ie==Ye&&this._onFinish()}),gt.onDestroy(()=>{++ct==Ye&&this._onDestroy()}),gt.onStart(()=>{++St==Ye&&this._onStart()})}),this.totalTime=this.players.reduce((gt,Wt)=>Math.max(gt,Wt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Ce=>Ce()),this._onDoneFns=[])}init(){this.players.forEach(Ce=>Ce.init())}onStart(Ce){this._onStartFns.push(Ce)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(Ce=>Ce()),this._onStartFns=[])}onDone(Ce){this._onDoneFns.push(Ce)}onDestroy(Ce){this._onDestroyFns.push(Ce)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(Ce=>Ce.play())}pause(){this.players.forEach(Ce=>Ce.pause())}restart(){this.players.forEach(Ce=>Ce.restart())}finish(){this._onFinish(),this.players.forEach(Ce=>Ce.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(Ce=>Ce.destroy()),this._onDestroyFns.forEach(Ce=>Ce()),this._onDestroyFns=[])}reset(){this.players.forEach(Ce=>Ce.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(Ce){const Ie=Ce*this.totalTime;this.players.forEach(ct=>{const St=ct.totalTime?Math.min(1,Ie/ct.totalTime):1;ct.setPosition(St)})}getPosition(){const Ce=this.players.reduce((Ie,ct)=>null===Ie||ct.totalTime>Ie.totalTime?ct:Ie,null);return null!=Ce?Ce.getPosition():0}beforeDestroy(){this.players.forEach(Ce=>{Ce.beforeDestroy&&Ce.beforeDestroy()})}triggerCallback(Ce){const Ie="start"==Ce?this._onStartFns:this._onDoneFns;Ie.forEach(ct=>ct()),Ie.length=0}}const Ot="!"},6814:(Hn,It,X)=>{"use strict";X.d(It,{Do:()=>xt,ED:()=>we,EM:()=>Uo,HT:()=>l,JF:()=>cs,K0:()=>Ne,Mx:()=>li,NF:()=>ls,O5:()=>Po,PM:()=>go,RF:()=>he,S$:()=>Qe,V_:()=>tt,Ye:()=>pt,b0:()=>mt,bD:()=>$o,ez:()=>Qi,mk:()=>on,n9:()=>$e,q:()=>lt,sg:()=>Yo,tP:()=>gn,w_:()=>_e});var M=X(5879);let w=null;function lt(){return w}function l(B){w||(w=B)}class _e{}const Ne=new M.OlP("DocumentToken");let Le=(()=>{var B;class Q{historyGo(Z){throw new Error("Not implemented")}}return(B=Q).\u0275fac=function(Z){return new(Z||B)},B.\u0275prov=M.Yz7({token:B,factory:function(){return(0,M.f3M)(Ke)},providedIn:"platform"}),Q})();const tt=new M.OlP("Location Initialized");let Ke=(()=>{var B;class Q extends Le{constructor(){super(),this._doc=(0,M.f3M)(Ne),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return lt().getBaseHref(this._doc)}onPopState(Z){const Re=lt().getGlobalEventTarget(this._doc,"window");return Re.addEventListener("popstate",Z,!1),()=>Re.removeEventListener("popstate",Z)}onHashChange(Z){const Re=lt().getGlobalEventTarget(this._doc,"window");return Re.addEventListener("hashchange",Z,!1),()=>Re.removeEventListener("hashchange",Z)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(Z){this._location.pathname=Z}pushState(Z,Re,vt){this._history.pushState(Z,Re,vt)}replaceState(Z,Re,vt){this._history.replaceState(Z,Re,vt)}forward(){this._history.forward()}back(){this._history.back()}historyGo(Z=0){this._history.go(Z)}getState(){return this._history.state}}return(B=Q).\u0275fac=function(Z){return new(Z||B)},B.\u0275prov=M.Yz7({token:B,factory:function(){return new B},providedIn:"platform"}),Q})();function ye(B,Q){if(0==B.length)return Q;if(0==Q.length)return B;let qe=0;return B.endsWith("/")&&qe++,Q.startsWith("/")&&qe++,2==qe?B+Q.substring(1):1==qe?B+Q:B+"/"+Q}function Ae(B){const Q=B.match(/#|\?|$/),qe=Q&&Q.index||B.length;return B.slice(0,qe-("/"===B[qe-1]?1:0))+B.slice(qe)}function Ze(B){return B&&"?"!==B[0]?"?"+B:B}let Qe=(()=>{var B;class Q{historyGo(Z){throw new Error("Not implemented")}}return(B=Q).\u0275fac=function(Z){return new(Z||B)},B.\u0275prov=M.Yz7({token:B,factory:function(){return(0,M.f3M)(mt)},providedIn:"root"}),Q})();const ot=new M.OlP("appBaseHref");let mt=(()=>{var B;class Q extends Qe{constructor(Z,Re){super(),this._platformLocation=Z,this._removeListenerFns=[],this._baseHref=Re??this._platformLocation.getBaseHrefFromDOM()??(0,M.f3M)(Ne).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(Z){this._removeListenerFns.push(this._platformLocation.onPopState(Z),this._platformLocation.onHashChange(Z))}getBaseHref(){return this._baseHref}prepareExternalUrl(Z){return ye(this._baseHref,Z)}path(Z=!1){const Re=this._platformLocation.pathname+Ze(this._platformLocation.search),vt=this._platformLocation.hash;return vt&&Z?`${Re}${vt}`:Re}pushState(Z,Re,vt,vn){const Sn=this.prepareExternalUrl(vt+Ze(vn));this._platformLocation.pushState(Z,Re,Sn)}replaceState(Z,Re,vt,vn){const Sn=this.prepareExternalUrl(vt+Ze(vn));this._platformLocation.replaceState(Z,Re,Sn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(Z=0){this._platformLocation.historyGo?.(Z)}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.LFG(Le),M.LFG(ot,8))},B.\u0275prov=M.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"}),Q})(),xt=(()=>{var B;class Q extends Qe{constructor(Z,Re){super(),this._platformLocation=Z,this._baseHref="",this._removeListenerFns=[],null!=Re&&(this._baseHref=Re)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(Z){this._removeListenerFns.push(this._platformLocation.onPopState(Z),this._platformLocation.onHashChange(Z))}getBaseHref(){return this._baseHref}path(Z=!1){let Re=this._platformLocation.hash;return null==Re&&(Re="#"),Re.length>0?Re.substring(1):Re}prepareExternalUrl(Z){const Re=ye(this._baseHref,Z);return Re.length>0?"#"+Re:Re}pushState(Z,Re,vt,vn){let Sn=this.prepareExternalUrl(vt+Ze(vn));0==Sn.length&&(Sn=this._platformLocation.pathname),this._platformLocation.pushState(Z,Re,Sn)}replaceState(Z,Re,vt,vn){let Sn=this.prepareExternalUrl(vt+Ze(vn));0==Sn.length&&(Sn=this._platformLocation.pathname),this._platformLocation.replaceState(Z,Re,Sn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(Z=0){this._platformLocation.historyGo?.(Z)}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.LFG(Le),M.LFG(ot,8))},B.\u0275prov=M.Yz7({token:B,factory:B.\u0275fac}),Q})(),pt=(()=>{var B;class Q{constructor(Z){this._subject=new M.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=Z;const Re=this._locationStrategy.getBaseHref();this._basePath=function Ce(B){if(new RegExp("^(https?:)?//").test(B)){const[,qe]=B.split(/\/\/[^\/]+/);return qe}return B}(Ae(Pt(Re))),this._locationStrategy.onPopState(vt=>{this._subject.emit({url:this.path(!0),pop:!0,state:vt.state,type:vt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(Z=!1){return this.normalize(this._locationStrategy.path(Z))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(Z,Re=""){return this.path()==this.normalize(Z+Ze(Re))}normalize(Z){return Q.stripTrailingSlash(function Ot(B,Q){if(!B||!Q.startsWith(B))return Q;const qe=Q.substring(B.length);return""===qe||["/",";","?","#"].includes(qe[0])?qe:Q}(this._basePath,Pt(Z)))}prepareExternalUrl(Z){return Z&&"/"!==Z[0]&&(Z="/"+Z),this._locationStrategy.prepareExternalUrl(Z)}go(Z,Re="",vt=null){this._locationStrategy.pushState(vt,"",Z,Re),this._notifyUrlChangeListeners(this.prepareExternalUrl(Z+Ze(Re)),vt)}replaceState(Z,Re="",vt=null){this._locationStrategy.replaceState(vt,"",Z,Re),this._notifyUrlChangeListeners(this.prepareExternalUrl(Z+Ze(Re)),vt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(Z=0){this._locationStrategy.historyGo?.(Z)}onUrlChange(Z){return this._urlChangeListeners.push(Z),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Re=>{this._notifyUrlChangeListeners(Re.url,Re.state)})),()=>{const Re=this._urlChangeListeners.indexOf(Z);this._urlChangeListeners.splice(Re,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(Z="",Re){this._urlChangeListeners.forEach(vt=>vt(Z,Re))}subscribe(Z,Re,vt){return this._subject.subscribe({next:Z,error:Re,complete:vt})}}return(B=Q).normalizeQueryParams=Ze,B.joinWithSlash=ye,B.stripTrailingSlash=Ae,B.\u0275fac=function(Z){return new(Z||B)(M.LFG(Qe))},B.\u0275prov=M.Yz7({token:B,factory:function(){return function et(){return new pt((0,M.LFG)(Qe))}()},providedIn:"root"}),Q})();function Pt(B){return B.replace(/\/index.html$/,"")}function li(B,Q){Q=encodeURIComponent(Q);for(const qe of B.split(";")){const Z=qe.indexOf("="),[Re,vt]=-1==Z?[qe,""]:[qe.slice(0,Z),qe.slice(Z+1)];if(Re.trim()===Q)return decodeURIComponent(vt)}return null}const Gr=/\s+/,Es=[];let on=(()=>{var B;class Q{constructor(Z,Re,vt,vn){this._iterableDiffers=Z,this._keyValueDiffers=Re,this._ngEl=vt,this._renderer=vn,this.initialClasses=Es,this.stateMap=new Map}set klass(Z){this.initialClasses=null!=Z?Z.trim().split(Gr):Es}set ngClass(Z){this.rawClass="string"==typeof Z?Z.trim().split(Gr):Z}ngDoCheck(){for(const Re of this.initialClasses)this._updateState(Re,!0);const Z=this.rawClass;if(Array.isArray(Z)||Z instanceof Set)for(const Re of Z)this._updateState(Re,!0);else if(null!=Z)for(const Re of Object.keys(Z))this._updateState(Re,!!Z[Re]);this._applyStateDiff()}_updateState(Z,Re){const vt=this.stateMap.get(Z);void 0!==vt?(vt.enabled!==Re&&(vt.changed=!0,vt.enabled=Re),vt.touched=!0):this.stateMap.set(Z,{enabled:Re,changed:!0,touched:!0})}_applyStateDiff(){for(const Z of this.stateMap){const Re=Z[0],vt=Z[1];vt.changed?(this._toggleClass(Re,vt.enabled),vt.changed=!1):vt.touched||(vt.enabled&&this._toggleClass(Re,!1),this.stateMap.delete(Re)),vt.touched=!1}}_toggleClass(Z,Re){(Z=Z.trim()).length>0&&Z.split(Gr).forEach(vt=>{Re?this._renderer.addClass(this._ngEl.nativeElement,vt):this._renderer.removeClass(this._ngEl.nativeElement,vt)})}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.Y36(M.ZZ4),M.Y36(M.aQg),M.Y36(M.SBq),M.Y36(M.Qsj))},B.\u0275dir=M.lG2({type:B,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),Q})();class ii{constructor(Q,qe,Z,Re){this.$implicit=Q,this.ngForOf=qe,this.index=Z,this.count=Re}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Yo=(()=>{var B;class Q{set ngForOf(Z){this._ngForOf=Z,this._ngForOfDirty=!0}set ngForTrackBy(Z){this._trackByFn=Z}get ngForTrackBy(){return this._trackByFn}constructor(Z,Re,vt){this._viewContainer=Z,this._template=Re,this._differs=vt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(Z){Z&&(this._template=Z)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const Z=this._ngForOf;!this._differ&&Z&&(this._differ=this._differs.find(Z).create(this.ngForTrackBy))}if(this._differ){const Z=this._differ.diff(this._ngForOf);Z&&this._applyChanges(Z)}}_applyChanges(Z){const Re=this._viewContainer;Z.forEachOperation((vt,vn,Sn)=>{if(null==vt.previousIndex)Re.createEmbeddedView(this._template,new ii(vt.item,this._ngForOf,-1,-1),null===Sn?void 0:Sn);else if(null==Sn)Re.remove(null===vn?void 0:vn);else if(null!==vn){const Er=Re.get(vn);Re.move(Er,Sn),zi(Er,vt)}});for(let vt=0,vn=Re.length;vt<vn;vt++){const Er=Re.get(vt).context;Er.index=vt,Er.count=vn,Er.ngForOf=this._ngForOf}Z.forEachIdentityChange(vt=>{zi(Re.get(vt.currentIndex),vt)})}static ngTemplateContextGuard(Z,Re){return!0}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.Y36(M.s_b),M.Y36(M.Rgc),M.Y36(M.ZZ4))},B.\u0275dir=M.lG2({type:B,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),Q})();function zi(B,Q){B.context.$implicit=Q.item}let Po=(()=>{var B;class Q{constructor(Z,Re){this._viewContainer=Z,this._context=new No,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Re}set ngIf(Z){this._context.$implicit=this._context.ngIf=Z,this._updateView()}set ngIfThen(Z){Wn("ngIfThen",Z),this._thenTemplateRef=Z,this._thenViewRef=null,this._updateView()}set ngIfElse(Z){Wn("ngIfElse",Z),this._elseTemplateRef=Z,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(Z,Re){return!0}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.Y36(M.s_b),M.Y36(M.Rgc))},B.\u0275dir=M.lG2({type:B,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),Q})();class No{constructor(){this.$implicit=null,this.ngIf=null}}function Wn(B,Q){if(Q&&!Q.createEmbeddedView)throw new Error(`${B} must be a TemplateRef, but received '${(0,M.AaK)(Q)}'.`)}class Dr{constructor(Q,qe){this._viewContainerRef=Q,this._templateRef=qe,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(Q){Q&&!this._created?this.create():!Q&&this._created&&this.destroy()}}let he=(()=>{var B;class Q{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(Z){this._ngSwitch=Z,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(Z){this._defaultViews.push(Z)}_matchCase(Z){const Re=Z==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||Re,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),Re}_updateDefaultCases(Z){if(this._defaultViews.length>0&&Z!==this._defaultUsed){this._defaultUsed=Z;for(const Re of this._defaultViews)Re.enforceState(Z)}}}return(B=Q).\u0275fac=function(Z){return new(Z||B)},B.\u0275dir=M.lG2({type:B,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),Q})(),$e=(()=>{var B;class Q{constructor(Z,Re,vt){this.ngSwitch=vt,vt._addCase(),this._view=new Dr(Z,Re)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.Y36(M.s_b),M.Y36(M.Rgc),M.Y36(he,9))},B.\u0275dir=M.lG2({type:B,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),Q})(),we=(()=>{var B;class Q{constructor(Z,Re,vt){vt._addDefault(new Dr(Z,Re))}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.Y36(M.s_b),M.Y36(M.Rgc),M.Y36(he,9))},B.\u0275dir=M.lG2({type:B,selectors:[["","ngSwitchDefault",""]],standalone:!0}),Q})(),gn=(()=>{var B;class Q{constructor(Z){this._viewContainerRef=Z,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(Z){if(Z.ngTemplateOutlet||Z.ngTemplateOutletInjector){const Re=this._viewContainerRef;if(this._viewRef&&Re.remove(Re.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:vt,ngTemplateOutletContext:vn,ngTemplateOutletInjector:Sn}=this;this._viewRef=Re.createEmbeddedView(vt,vn,Sn?{injector:Sn}:void 0)}else this._viewRef=null}else this._viewRef&&Z.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return(B=Q).\u0275fac=function(Z){return new(Z||B)(M.Y36(M.s_b))},B.\u0275dir=M.lG2({type:B,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[M.TTD]}),Q})(),Qi=(()=>{var B;class Q{}return(B=Q).\u0275fac=function(Z){return new(Z||B)},B.\u0275mod=M.oAB({type:B}),B.\u0275inj=M.cJS({}),Q})();const $o="browser",Vo="server";function ls(B){return B===$o}function go(B){return B===Vo}let Uo=(()=>{var B;class Q{}return(B=Q).\u0275prov=(0,M.Yz7)({token:B,providedIn:"root",factory:()=>new jo((0,M.LFG)(Ne),window)}),Q})();class jo{constructor(Q,qe){this.document=Q,this.window=qe,this.offset=()=>[0,0]}setOffset(Q){this.offset=Array.isArray(Q)?()=>Q:Q}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(Q){this.supportsScrolling()&&this.window.scrollTo(Q[0],Q[1])}scrollToAnchor(Q){if(!this.supportsScrolling())return;const qe=function oa(B,Q){const qe=B.getElementById(Q)||B.getElementsByName(Q)[0];if(qe)return qe;if("function"==typeof B.createTreeWalker&&B.body&&"function"==typeof B.body.attachShadow){const Z=B.createTreeWalker(B.body,NodeFilter.SHOW_ELEMENT);let Re=Z.currentNode;for(;Re;){const vt=Re.shadowRoot;if(vt){const vn=vt.getElementById(Q)||vt.querySelector(`[name="${Q}"]`);if(vn)return vn}Re=Z.nextNode()}}return null}(this.document,Q);qe&&(this.scrollToElement(qe),qe.focus())}setHistoryScrollRestoration(Q){this.supportsScrolling()&&(this.window.history.scrollRestoration=Q)}scrollToElement(Q){const qe=Q.getBoundingClientRect(),Z=qe.left+this.window.pageXOffset,Re=qe.top+this.window.pageYOffset,vt=this.offset();this.window.scrollTo(Z-vt[0],Re-vt[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class cs{}},5879:(Hn,It,X)=>{"use strict";X.d(It,{$8M:()=>Ua,$WT:()=>ps,$Z:()=>eu,AFp:()=>tg,AaK:()=>Ze,CHM:()=>Ca,CRH:()=>zx,DdM:()=>vx,EJc:()=>oD,EpF:()=>kv,F$t:()=>Vv,F4k:()=>Lv,FYo:()=>Cp,FiY:()=>bd,G48:()=>WD,Gf:()=>Bx,GfV:()=>Ip,GkF:()=>Cy,Gpc:()=>mt,Gre:()=>E0,HDt:()=>ab,Hsn:()=>Uv,Ikx:()=>Ly,JOm:()=>kh,KtG:()=>El,LFG:()=>mn,LMc:()=>wC,Lbi:()=>fp,Lck:()=>Vw,MAs:()=>Df,MMx:()=>dx,MR2:()=>rd,NdJ:()=>Sy,O4$:()=>$t,Ojb:()=>rg,OlP:()=>po,Oqu:()=>ky,P3R:()=>Gm,PXZ:()=>BD,Q6J:()=>uc,QGY:()=>Ty,QbO:()=>Y_,Qsj:()=>Tp,R0b:()=>rl,RDi:()=>km,Rgc:()=>lm,SBq:()=>th,Sil:()=>lD,Suo:()=>Nx,TTD:()=>Ba,TgZ:()=>ua,VuI:()=>xC,X6Q:()=>GD,XFs:()=>hr,Xpm:()=>lr,Xq5:()=>_,Xts:()=>Gd,Y36:()=>Mu,YKP:()=>cx,YNc:()=>wf,Yjl:()=>To,Yz7:()=>en,Z0I:()=>nr,ZZ4:()=>_v,_Bn:()=>lx,_UZ:()=>Fu,_Vd:()=>Kc,_c5:()=>lC,_uU:()=>f0,aQg:()=>yv,c2e:()=>sb,cJS:()=>Fn,cg1:()=>Fy,dDg:()=>OD,dqk:()=>Tr,eFA:()=>wb,eJc:()=>Qy,ekj:()=>Ry,eoX:()=>yb,f3M:()=>Gn,g9A:()=>ng,h0i:()=>bh,hGG:()=>cC,hij:()=>o_,iGM:()=>Fx,ifc:()=>wn,ip1:()=>ob,jDz:()=>hx,kL8:()=>k0,kcU:()=>Yn,lG2:()=>Pi,lqb:()=>kl,lri:()=>gb,n5z:()=>ao,n_E:()=>u_,oAB:()=>io,oxw:()=>$v,q4F:()=>Wa,qFp:()=>EC,qLn:()=>bc,qOj:()=>bf,qZA:()=>da,rWj:()=>_b,rg0:()=>fc,sBO:()=>qD,s_b:()=>f_,soG:()=>m_,tBr:()=>Lf,tb:()=>dv,tp0:()=>Ch,uIk:()=>je,vHH:()=>Ce,vpe:()=>su,wAp:()=>If,xp6:()=>df,z2F:()=>Rf,zSh:()=>Xh,zs3:()=>fl});var M=X(8645),w=X(7394),lt=X(5619),l=X(5592),_e=X(3019),Ne=X(2096),Le=X(3020),tt=X(4664),Ke=X(3997);function ye(t){for(let o in t)if(t[o]===ye)return o;throw Error("Could not find renamed property on target object.")}function Ae(t,o){for(const a in o)o.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=o[a])}function Ze(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ze).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const o=t.toString();if(null==o)return""+o;const a=o.indexOf("\n");return-1===a?o:o.substring(0,a)}function Qe(t,o){return null==t||""===t?null===o?"":o:null==o||""===o?t:t+" "+o}const ot=ye({__forward_ref__:ye});function mt(t){return t.__forward_ref__=mt,t.toString=function(){return Ze(this())},t}function xt(t){return pt(t)?t():t}function pt(t){return"function"==typeof t&&t.hasOwnProperty(ot)&&t.__forward_ref__===mt}function et(t){return t&&!!t.\u0275providers}const Pt="https://g.co/ng/security#xss";class Ce extends Error{constructor(o,a){super(function Ie(t,o){return`NG0${Math.abs(t)}${o?": "+o:""}`}(o,a)),this.code=o}}function ct(t){return"string"==typeof t?t:null==t?"":String(t)}function Nt(t,o){throw new Ce(-201,!1)}function ln(t,o){null==t&&function _n(t,o,a,d){throw new Error(`ASSERTION ERROR: ${t}`+(null==d?"":` [Expected=> ${a} ${d} ${o} <=Actual]`))}(o,t,null,"!=")}function en(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Fn(t){return{providers:t.providers||[],imports:t.imports||[]}}function pr(t){return gr(t,yn)||gr(t,Li)}function nr(t){return null!==pr(t)}function gr(t,o){return t.hasOwnProperty(o)?t[o]:null}function Lr(t){return t&&(t.hasOwnProperty(Jr)||t.hasOwnProperty(ui))?t[Jr]:null}const yn=ye({\u0275prov:ye}),Jr=ye({\u0275inj:ye}),Li=ye({ngInjectableDef:ye}),ui=ye({ngInjectorDef:ye});var hr=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(hr||{});let wr;function mr(t){const o=wr;return wr=t,o}function Di(t,o,a){const d=pr(t);return d&&"root"==d.providedIn?void 0===d.value?d.value=d.factory():d.value:a&hr.Optional?null:void 0!==o?o:void Nt(Ze(t))}const Tr=globalThis,At={},_t="__NG_DI_FLAG__",Bt="ngTempTokenPath",ke=/\n/gm,ce="__source";let Fe;function nt(t){const o=Fe;return Fe=t,o}function Ft(t,o=hr.Default){if(void 0===Fe)throw new Ce(-203,!1);return null===Fe?Di(t,void 0,o):Fe.get(t,o&hr.Optional?null:void 0,o)}function mn(t,o=hr.Default){return(function _r(){return wr}()||Ft)(xt(t),o)}function Gn(t,o=hr.Default){return mn(t,dr(o))}function dr(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function yr(t){const o=[];for(let a=0;a<t.length;a++){const d=xt(t[a]);if(Array.isArray(d)){if(0===d.length)throw new Ce(900,!1);let m,b=hr.Default;for(let I=0;I<d.length;I++){const k=d[I],U=ti(k);"number"==typeof U?-1===U?m=k.token:b|=U:m=k}o.push(mn(m,b))}else o.push(mn(d))}return o}function Hr(t,o){return t[_t]=o,t.prototype[_t]=o,t}function ti(t){return t[_t]}function Kt(t){return{toString:t}.toString()}var Et=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Et||{}),wn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(wn||{});const cr={},qn=[],Rr=ye({\u0275cmp:ye}),Fr=ye({\u0275dir:ye}),di=ye({\u0275pipe:ye}),Ci=ye({\u0275mod:ye}),Qr=ye({\u0275fac:ye}),li=ye({__NG_ELEMENT_ID__:ye}),Gr=ye({__NG_ENV_ID__:ye});function Es(t,o,a){let d=t.length;for(;;){const m=t.indexOf(o,a);if(-1===m)return m;if(0===m||t.charCodeAt(m-1)<=32){const b=o.length;if(m+b===d||t.charCodeAt(m+b)<=32)return m}a=m+1}}function on(t,o,a){let d=0;for(;d<a.length;){const m=a[d];if("number"==typeof m){if(0!==m)break;d++;const b=a[d++],I=a[d++],k=a[d++];t.setAttribute(o,I,k,b)}else{const b=m,I=a[++d];bi(b)?t.setProperty(o,b,I):t.setAttribute(o,b,I),d++}}return d}function ro(t){return 3===t||4===t||6===t}function bi(t){return 64===t.charCodeAt(0)}function ii(t,o){if(null!==o&&0!==o.length)if(null===t||0===t.length)t=o.slice();else{let a=-1;for(let d=0;d<o.length;d++){const m=o[d];"number"==typeof m?a=m:0===a||Yo(t,a,m,null,-1===a||2===a?o[++d]:null)}}return t}function Yo(t,o,a,d,m){let b=0,I=t.length;if(-1===o)I=-1;else for(;b<t.length;){const k=t[b++];if("number"==typeof k){if(k===o){I=-1;break}if(k>o){I=b-1;break}}}for(;b<t.length;){const k=t[b];if("number"==typeof k)break;if(k===a){if(null===d)return void(null!==m&&(t[b+1]=m));if(d===t[b+1])return void(t[b+2]=m)}b++,null!==d&&b++,null!==m&&b++}-1!==I&&(t.splice(I,0,o),b=I+1),t.splice(b++,0,a),null!==d&&t.splice(b++,0,d),null!==m&&t.splice(b++,0,m)}const zi="ng-template";function ss(t,o,a){let d=0,m=!0;for(;d<t.length;){let b=t[d++];if("string"==typeof b&&m){const I=t[d++];if(a&&"class"===b&&-1!==Es(I.toLowerCase(),o,0))return!0}else{if(1===b){for(;d<t.length&&"string"==typeof(b=t[d++]);)if(b.toLowerCase()===o)return!0;return!1}"number"==typeof b&&(m=!1)}}return!1}function Po(t){return 4===t.type&&t.value!==zi}function No(t,o,a){return o===(4!==t.type||a?t.value:zi)}function Wn(t,o,a){let d=4;const m=t.attrs||[],b=function Be(t){for(let o=0;o<t.length;o++)if(ro(t[o]))return o;return t.length}(m);let I=!1;for(let k=0;k<o.length;k++){const U=o[k];if("number"!=typeof U){if(!I)if(4&d){if(d=2|1&d,""!==U&&!No(t,U,a)||""===U&&1===o.length){if(Dr(d))return!1;I=!0}}else{const ie=8&d?U:o[++k];if(8&d&&null!==t.attrs){if(!ss(t.attrs,ie,a)){if(Dr(d))return!1;I=!0}continue}const Je=he(8&d?"class":U,m,Po(t),a);if(-1===Je){if(Dr(d))return!1;I=!0;continue}if(""!==ie){let Rt;Rt=Je>b?"":m[Je+1].toLowerCase();const Gt=8&d?Rt:null;if(Gt&&-1!==Es(Gt,ie,0)||2&d&&ie!==Rt){if(Dr(d))return!1;I=!0}}}}else{if(!I&&!Dr(d)&&!Dr(U))return!1;if(I&&Dr(U))continue;I=!1,d=U|1&d}}return Dr(d)||I}function Dr(t){return 0==(1&t)}function he(t,o,a,d){if(null===o)return-1;let m=0;if(d||!a){let b=!1;for(;m<o.length;){const I=o[m];if(I===t)return m;if(3===I||6===I)b=!0;else{if(1===I||2===I){let k=o[++m];for(;"string"==typeof k;)k=o[++m];continue}if(4===I)break;if(0===I){m+=4;continue}}m+=b?1:2}return-1}return function Ct(t,o){let a=t.indexOf(4);if(a>-1)for(a++;a<t.length;){const d=t[a];if("number"==typeof d)return-1;if(d===o)return a;a++}return-1}(o,t)}function $e(t,o,a=!1){for(let d=0;d<o.length;d++)if(Wn(t,o[d],a))return!0;return!1}function kt(t,o){e:for(let a=0;a<o.length;a++){const d=o[a];if(t.length===d.length){for(let m=0;m<t.length;m++)if(t[m]!==d[m])continue e;return!0}}return!1}function cn(t,o){return t?":not("+o.trim()+")":o}function gn(t){let o=t[0],a=1,d=2,m="",b=!1;for(;a<t.length;){let I=t[a];if("string"==typeof I)if(2&d){const k=t[++a];m+="["+I+(k.length>0?'="'+k+'"':"")+"]"}else 8&d?m+="."+I:4&d&&(m+=" "+I);else""!==m&&!Dr(I)&&(o+=cn(b,m),m=""),d=I,b=b||!Dr(d);a++}return""!==m&&(o+=cn(b,m)),o}function lr(t){return Kt(()=>{const o=So(t),a={...o,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Et.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||wn.Emulated,styles:t.styles||qn,_:null,schemas:t.schemas||null,tView:null,id:""};Ks(a);const d=t.dependencies;return a.directiveDefs=as(d,!1),a.pipeDefs=as(d,!0),a.id=function Os(t){let o=0;const a=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const m of a)o=Math.imul(31,o)+m.charCodeAt(0)<<0;return o+=2147483648,"c"+o}(a),a})}function kr(t){return Vr(t)||qr(t)}function wi(t){return null!==t}function io(t){return Kt(()=>({type:t.type,bootstrap:t.bootstrap||qn,declarations:t.declarations||qn,imports:t.imports||qn,exports:t.exports||qn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Ki(t,o){if(null==t)return cr;const a={};for(const d in t)if(t.hasOwnProperty(d)){let m=t[d],b=m;Array.isArray(m)&&(b=m[1],m=m[0]),a[m]=d,o&&(o[m]=b)}return a}function Pi(t){return Kt(()=>{const o=So(t);return Ks(o),o})}function To(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Vr(t){return t[Rr]||null}function qr(t){return t[Fr]||null}function Ji(t){return t[di]||null}function ps(t){const o=Vr(t)||qr(t)||Ji(t);return null!==o&&o.standalone}function Ai(t,o){const a=t[Ci]||null;if(!a&&!0===o)throw new Error(`Type ${Ze(t)} does not have '\u0275mod' property.`);return a}function So(t){const o={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:o,inputTransforms:null,inputConfig:t.inputs||cr,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||qn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ki(t.inputs,o),outputs:Ki(t.outputs)}}function Ks(t){t.features?.forEach(o=>o(t))}function as(t,o){if(!t)return null;const a=o?Ji:kr;return()=>("function"==typeof t?t():t).map(d=>a(d)).filter(wi)}const Ri=0,rr=1,vr=2,Ti=3,Io=4,zo=5,Si=6,Ms=7,Qi=8,$o=9,Vo=10,Mr=11,ks=12,ls=13,go=14,$i=15,es=16,Ro=17,Uo=18,jo=19,oa=20,ms=21,cs=22,ts=23,ns=24,Qn=25,As=1,va=2,Ho=7,co=9,oo=11;function Fi(t){return Array.isArray(t)&&"object"==typeof t[As]}function Wi(t){return Array.isArray(t)&&!0===t[As]}function Hs(t){return 0!=(4&t.flags)}function gs(t){return t.componentOffset>-1}function us(t){return 1==(1&t.flags)}function Xo(t){return!!t.template}function sa(t){return 0!=(512&t[vr])}function Ko(t,o){return t.hasOwnProperty(Qr)?t[Qr]:null}let wa=Tr.WeakRef??class Vl{constructor(o){this.ref=o}deref(){return this.ref}},Ul=0,Ls=null,Gs=!1;function uo(t){const o=Ls;return Ls=t,o}class Fs{constructor(){this.id=Ul++,this.ref=function xl(t){return new wa(t)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[o,a]of this.producers){const d=a.producerNode.deref();if(null!=d&&a.atTrackingVersion===this.trackingVersion){if(d.producerPollStatus(a.seenValueVersion))return!0}else this.producers.delete(o),d?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const o=Gs;Gs=!0;try{for(const[a,d]of this.consumers){const m=d.consumerNode.deref();null!=m&&m.trackingVersion===d.atTrackingVersion?m.onConsumerDependencyMayHaveChanged():(this.consumers.delete(a),m?.producers.delete(this.id))}}finally{Gs=o}}producerAccessed(){if(Gs)throw new Error("");if(null===Ls)return;let o=Ls.producers.get(this.id);void 0===o?(o={consumerNode:Ls.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Ls.trackingVersion},Ls.producers.set(this.id,o),this.consumers.set(Ls.id,o)):(o.seenValueVersion=this.valueVersion,o.atTrackingVersion=Ls.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Ls?.consumerAllowSignalWrites}producerPollStatus(o){return this.valueVersion!==o||(this.onProducerUpdateValueVersion(),this.valueVersion!==o)}}let fa=null;function fc(t){const o=uo(null);try{return t()}finally{uo(o)}}const Hl=()=>{};class Ea extends Fs{constructor(o,a,d){super(),this.watch=o,this.schedule=a,this.dirty=!1,this.cleanupFn=Hl,this.registerOnCleanup=m=>{this.cleanupFn=m},this.consumerAllowSignalWrites=d}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const o=uo(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Hl,this.watch(this.registerOnCleanup)}finally{uo(o)}}cleanup(){this.cleanupFn()}}class Qs{constructor(o,a,d){this.previousValue=o,this.currentValue=a,this.firstChange=d}isFirstChange(){return this.firstChange}}function Ba(){return Na}function Na(t){return t.type.prototype.ngOnChanges&&(t.setInput=ea),Qo}function Qo(){const t=Q(this),o=t?.current;if(o){const a=t.previous;if(a===cr)t.previous=o;else for(let d in o)a[d]=o[d];t.current=null,this.ngOnChanges(o)}}function ea(t,o,a,d){const m=this.declaredInputs[a],b=Q(t)||function qe(t,o){return t[B]=o}(t,{previous:cr,current:null}),I=b.current||(b.current={}),k=b.previous,U=k[m];I[m]=new Qs(U&&U.currentValue,o,k===cr),t[d]=o}Ba.ngInherit=!0;const B="__ngSimpleChanges__";function Q(t){return t[B]||null}const vt=function(t,o,a){},vn="svg";function Er(t){for(;Array.isArray(t);)t=t[Ri];return t}function xi(t,o){return Er(o[t])}function Br(t,o){return Er(o[t.index])}function Ei(t,o){return t.data[o]}function ko(t,o){const a=o[t];return Fi(a)?a:a[Ri]}function _s(t,o){return null==o?null:t[o]}function Cs(t){t[Ro]=0}function aa(t){1024&t[vr]||(t[vr]|=1024,cl(t,1))}function Gl(t){1024&t[vr]&&(t[vr]&=-1025,cl(t,-1))}function cl(t,o){let a=t[Ti];if(null===a)return;a[zo]+=o;let d=a;for(a=a[Ti];null!==a&&(1===o&&1===d[zo]||-1===o&&0===d[zo]);)a[zo]+=o,d=a,a=a[Ti]}const ei={lFrame:v(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Wl(){return ei.bindingsEnabled}function Da(){return null!==ei.skipHydrationRootTNode}function Bn(){return ei.lFrame.lView}function ni(){return ei.lFrame.tView}function Ca(t){return ei.lFrame.contextLView=t,t[Qi]}function El(t){return ei.lFrame.contextLView=null,t}function ds(){let t=Dl();for(;null!==t&&64===t.type;)t=t.parent;return t}function Dl(){return ei.lFrame.currentTNode}function na(t,o){const a=ei.lFrame;a.currentTNode=t,a.isParent=o}function Yl(){return ei.lFrame.isParent}function Ac(){ei.lFrame.isParent=!1}function Xa(){return ei.lFrame.bindingIndex++}function ca(t){const o=ei.lFrame,a=o.bindingIndex;return o.bindingIndex=o.bindingIndex+t,a}function Ss(t,o){const a=ei.lFrame;a.bindingIndex=a.bindingRootIndex=t,Kl(o)}function Kl(t){ei.lFrame.currentDirectiveIndex=t}function lu(){return ei.lFrame.currentQueryIndex}function qs(t){ei.lFrame.currentQueryIndex=t}function Rc(t){const o=t[rr];return 2===o.type?o.declTNode:1===o.type?t[Si]:null}function L(t,o,a){if(a&hr.SkipSelf){let m=o,b=t;for(;!(m=m.parent,null!==m||a&hr.Host||(m=Rc(b),null===m||(b=b[go],10&m.type))););if(null===m)return!1;o=m,t=b}const d=ei.lFrame=H();return d.currentTNode=o,d.lView=t,!0}function N(t){const o=H(),a=t[rr];ei.lFrame=o,o.currentTNode=a.firstChild,o.lView=t,o.tView=a,o.contextLView=t,o.bindingIndex=a.bindingStartIndex,o.inI18n=!1}function H(){const t=ei.lFrame,o=null===t?null:t.child;return null===o?v(t):o}function v(t){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=o),o}function g(){const t=ei.lFrame;return ei.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const E=g;function S(){const t=g();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function ve(){return ei.lFrame.selectedIndex}function me(t){ei.lFrame.selectedIndex=t}function st(){const t=ei.lFrame;return Ei(t.tView,t.selectedIndex)}function $t(){ei.lFrame.currentNamespace=vn}function Yn(){!function Nr(){ei.lFrame.currentNamespace=null}()}let Sr=!0;function Zr(){return Sr}function Ur(t){Sr=t}function Zi(t,o){for(let a=o.directiveStart,d=o.directiveEnd;a<d;a++){const b=t.data[a].type.prototype,{ngAfterContentInit:I,ngAfterContentChecked:k,ngAfterViewInit:U,ngAfterViewChecked:ie,ngOnDestroy:xe}=b;I&&(t.contentHooks??=[]).push(-a,I),k&&((t.contentHooks??=[]).push(a,k),(t.contentCheckHooks??=[]).push(a,k)),U&&(t.viewHooks??=[]).push(-a,U),ie&&((t.viewHooks??=[]).push(a,ie),(t.viewCheckHooks??=[]).push(a,ie)),null!=xe&&(t.destroyHooks??=[]).push(a,xe)}}function _o(t,o,a){c(t,o,3,a)}function h(t,o,a,d){(3&t[vr])===a&&c(t,o,a,d)}function i(t,o){let a=t[vr];(3&a)===o&&(a&=8191,a+=1,t[vr]=a)}function c(t,o,a,d){const b=d??-1,I=o.length-1;let k=0;for(let U=void 0!==d?65535&t[Ro]:0;U<I;U++)if("number"==typeof o[U+1]){if(k=o[U],null!=d&&k>=d)break}else o[U]<0&&(t[Ro]+=65536),(k<b||-1==b)&&(y(t,a,o,U),t[Ro]=(4294901760&t[Ro])+U+2),U++}function p(t,o){vt(4,t,o);const a=uo(null);try{o.call(t)}finally{uo(a),vt(5,t,o)}}function y(t,o,a,d){const m=a[d]<0,b=a[d+1],k=t[m?-a[d]:a[d]];m?t[vr]>>13<t[Ro]>>16&&(3&t[vr])===o&&(t[vr]+=8192,p(k,b)):p(k,b)}const D=-1;class A{constructor(o,a,d){this.factory=o,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=d}}function De(t){return t!==D}function Oe(t){return 32767&t}function Te(t,o){let a=function ae(t){return t>>16}(t),d=o;for(;a>0;)d=d[go],a--;return d}let Ge=!0;function Ve(t){const o=Ge;return Ge=t,o}const wt=255,dt=5;let Lt=0;const Tt={};function Rn(t,o){const a=Dn(t,o);if(-1!==a)return a;const d=o[rr];d.firstCreatePass&&(t.injectorIndex=o.length,Ht(d.data,t),Ht(o,null),Ht(d.blueprint,null));const m=sn(t,o),b=t.injectorIndex;if(De(m)){const I=Oe(m),k=Te(m,o),U=k[rr].data;for(let ie=0;ie<8;ie++)o[b+ie]=k[I+ie]|U[I+ie]}return o[b+8]=m,b}function Ht(t,o){t.push(0,0,0,0,0,0,0,0,o)}function Dn(t,o){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===o[t.injectorIndex+8]?-1:t.injectorIndex}function sn(t,o){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let a=0,d=null,m=o;for(;null!==m;){if(d=Sa(m),null===d)return D;if(a++,m=m[go],-1!==d.injectorIndex)return d.injectorIndex|a<<16}return D}function Ln(t,o,a){!function qt(t,o,a){let d;"string"==typeof a?d=a.charCodeAt(0)||0:a.hasOwnProperty(li)&&(d=a[li]),null==d&&(d=a[li]=Lt++);const m=d&wt;o.data[t+(m>>dt)]|=1<<m}(t,o,a)}function xn(t,o,a){if(a&hr.Optional||void 0!==t)return t;Nt()}function Nn(t,o,a,d){if(a&hr.Optional&&void 0===d&&(d=null),!(a&(hr.Self|hr.Host))){const m=t[$o],b=mr(void 0);try{return m?m.get(o,d,a&hr.Optional):Di(o,d,a&hr.Optional)}finally{mr(b)}}return xn(d,0,a)}function An(t,o,a,d=hr.Default,m){if(null!==t){if(2048&o[vr]&&!(d&hr.Self)){const I=function zs(t,o,a,d,m){let b=t,I=o;for(;null!==b&&null!==I&&2048&I[vr]&&!(512&I[vr]);){const k=$n(b,I,a,d|hr.Self,Tt);if(k!==Tt)return k;let U=b.parent;if(!U){const ie=I[oa];if(ie){const xe=ie.get(a,Tt,d);if(xe!==Tt)return xe}U=Sa(I),I=I[go]}b=U}return m}(t,o,a,d,Tt);if(I!==Tt)return I}const b=$n(t,o,a,d,Tt);if(b!==Tt)return b}return Nn(o,a,d,m)}function $n(t,o,a,d,m){const b=function $r(t){if("string"==typeof t)return t.charCodeAt(0)||0;const o=t.hasOwnProperty(li)?t[li]:void 0;return"number"==typeof o?o>=0?o&wt:ho:o}(a);if("function"==typeof b){if(!L(o,t,d))return d&hr.Host?xn(m,0,d):Nn(o,a,d,m);try{let I;if(I=b(d),null!=I||d&hr.Optional)return I;Nt()}finally{E()}}else if("number"==typeof b){let I=null,k=Dn(t,o),U=D,ie=d&hr.Host?o[$i][Si]:null;for((-1===k||d&hr.SkipSelf)&&(U=-1===k?sn(t,o):o[k+8],U!==D&&fi(d,!1)?(I=o[rr],k=Oe(U),o=Te(U,o)):k=-1);-1!==k;){const xe=o[rr];if(mi(b,k,xe.data)){const Je=Ar(k,o,a,I,d,ie);if(Je!==Tt)return Je}U=o[k+8],U!==D&&fi(d,o[rr].data[k+8]===ie)&&mi(b,k,o)?(I=xe,k=Oe(U),o=Te(U,o)):k=-1}}return m}function Ar(t,o,a,d,m,b){const I=o[rr],k=I.data[t+8],xe=Xr(k,I,a,null==d?gs(k)&&Ge:d!=I&&0!=(3&k.type),m&hr.Host&&b===k);return null!==xe?ur(o,I,xe,k):Tt}function Xr(t,o,a,d,m){const b=t.providerIndexes,I=o.data,k=1048575&b,U=t.directiveStart,xe=b>>20,Rt=m?k+xe:t.directiveEnd;for(let Gt=d?k:k+xe;Gt<Rt;Gt++){const Mn=I[Gt];if(Gt<U&&a===Mn||Gt>=U&&Mn.type===a)return Gt}if(m){const Gt=I[U];if(Gt&&Xo(Gt)&&Gt.type===a)return U}return null}function ur(t,o,a,d){let m=t[a];const b=o.data;if(function O(t){return t instanceof A}(m)){const I=m;I.resolving&&function Ye(t,o){const a=o?`. Dependency path: ${o.join(" > ")} > ${t}`:"";throw new Ce(-200,`Circular dependency in DI detected for ${t}${a}`)}(function St(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():ct(t)}(b[a]));const k=Ve(I.canSeeViewProviders);I.resolving=!0;const ie=I.injectImpl?mr(I.injectImpl):null;L(t,d,hr.Default);try{m=t[a]=I.factory(void 0,b,t,d),o.firstCreatePass&&a>=d.directiveStart&&function hi(t,o,a){const{ngOnChanges:d,ngOnInit:m,ngDoCheck:b}=o.type.prototype;if(d){const I=Na(o);(a.preOrderHooks??=[]).push(t,I),(a.preOrderCheckHooks??=[]).push(t,I)}m&&(a.preOrderHooks??=[]).push(0-t,m),b&&((a.preOrderHooks??=[]).push(t,b),(a.preOrderCheckHooks??=[]).push(t,b))}(a,b[a],o)}finally{null!==ie&&mr(ie),Ve(k),I.resolving=!1,E()}}return m}function mi(t,o,a){return!!(a[o+(t>>dt)]&1<<t)}function fi(t,o){return!(t&hr.Self||t&hr.Host&&o)}class gi{constructor(o,a){this._tNode=o,this._lView=a}get(o,a,d){return An(this._tNode,this._lView,o,dr(d),a)}}function ho(){return new gi(ds(),Bn())}function ao(t){return Kt(()=>{const o=t.prototype.constructor,a=o[Qr]||Ns(o),d=Object.prototype;let m=Object.getPrototypeOf(t.prototype).constructor;for(;m&&m!==d;){const b=m[Qr]||Ns(m);if(b&&b!==a)return b;m=Object.getPrototypeOf(m)}return b=>new b})}function Ns(t){return pt(t)?()=>{const o=Ns(xt(t));return o&&o()}:Ko(t)}function Sa(t){const o=t[rr],a=o.type;return 2===a?o.declTNode:1===a?t[Si]:null}function Ua(t){return function Xt(t,o){if("class"===o)return t.classes;if("style"===o)return t.styles;const a=t.attrs;if(a){const d=a.length;let m=0;for(;m<d;){const b=a[m];if(ro(b))break;if(0===b)m+=2;else if("number"==typeof b)for(m++;m<d&&"string"==typeof a[m];)m++;else{if(b===o)return a[m+1];m+=2}}}return null}(ds(),t)}const Vi="__parameters__";function to(t,o,a){return Kt(()=>{const d=function Zs(t){return function(...a){if(t){const d=t(...a);for(const m in d)this[m]=d[m]}}}(o);function m(...b){if(this instanceof m)return d.apply(this,b),this;const I=new m(...b);return k.annotation=I,k;function k(U,ie,xe){const Je=U.hasOwnProperty(Vi)?U[Vi]:Object.defineProperty(U,Vi,{value:[]})[Vi];for(;Je.length<=xe;)Je.push(null);return(Je[xe]=Je[xe]||[]).push(I),U}}return a&&(m.prototype=Object.create(a.prototype)),m.prototype.ngMetadataName=t,m.annotationCls=m,m})}function Lc(t,o){t.forEach(a=>Array.isArray(a)?Lc(a,o):o(a))}function yd(t,o,a){o>=t.length?t.push(a):t.splice(o,0,a)}function dl(t,o){return o>=t.length-1?t.pop():t.splice(o,1)[0]}function Fc(t,o){const a=[];for(let d=0;d<t;d++)a.push(o);return a}function Ja(t,o,a){let d=Ql(t,o);return d>=0?t[1|d]=a:(d=~d,function E_(t,o,a,d){let m=t.length;if(m==o)t.push(a,d);else if(1===m)t.push(d,t[0]),t[0]=a;else{for(m--,t.push(t[m-1],t[m]);m>o;)t[m]=t[m-2],m--;t[o]=a,t[o+1]=d}}(t,d,o,a)),d}function vd(t,o){const a=Ql(t,o);if(a>=0)return t[1|a]}function Ql(t,o){return function ec(t,o,a){let d=0,m=t.length>>a;for(;m!==d;){const b=d+(m-d>>1),I=t[b<<a];if(o===I)return b<<a;I>o?m=b:d=b+1}return~(m<<a)}(t,o,1)}const Lf=Hr(to("Inject",t=>({token:t})),-1),bd=Hr(to("Optional"),8),Ch=Hr(to("SkipSelf"),4);function Cd(t){return 128==(128&t.flags)}var kh=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(kh||{});const bm=/^>|^->|<!--|-->|--!>|<!-$/g,wm=/(<|>)/,Td="\u200b$1\u200b";const Sd=new Map;let Vf=0;const Ha="__ngContext__";function ma(t,o){Fi(o)?(t[Ha]=o[jo],function Uf(t){Sd.set(t[jo],t)}(o)):t[Ha]=o}let Vc;function Uc(t,o){return Vc(t,o)}function jc(t){const o=t[Ti];return Wi(o)?o[Ti]:o}function Bh(t){return _u(t[ks])}function Zf(t){return _u(t[Io])}function _u(t){for(;null!==t&&!Wi(t);)t=t[Io];return t}function yu(t,o,a,d,m){if(null!=d){let b,I=!1;Wi(d)?b=d:Fi(d)&&(I=!0,d=d[Ri]);const k=Er(d);0===t&&null!==a?null==m?Jf(o,a,k):yc(o,a,k,m||null,!0):1===t&&null!==a?yc(o,a,k,m||null,!0):2===t?function qu(t,o,a){const d=Pd(t,o);d&&function M_(t,o,a,d){t.removeChild(o,a,d)}(t,d,o,a)}(o,k,I):3===t&&o.destroyNode(k),null!=b&&function Rm(t,o,a,d,m){const b=a[Ho];b!==Er(a)&&yu(o,t,d,b,m);for(let k=oo;k<a.length;k++){const U=a[k];Zu(U[rr],U,t,o,d,b)}}(o,t,b,a,m)}}function Xf(t,o){return t.createComment(function Lh(t){return t.replace(bm,o=>o.replace(wm,Td))}(o))}function Nh(t,o,a){return t.createElement(o,a)}function Rl(t,o){const a=t[co],d=a.indexOf(o);Gl(o),a.splice(d,1)}function Ga(t,o){if(t.length<=oo)return;const a=oo+o,d=t[a];if(d){const m=d[es];null!==m&&m!==t&&Rl(m,d),o>0&&(t[a-1][Io]=d[Io]);const b=dl(t,oo+o);!function Ad(t,o){Zu(t,o,o[Mr],2,null,null),o[Ri]=null,o[Si]=null}(d[rr],d);const I=b[Uo];null!==I&&I.detachView(b[rr]),d[Ti]=null,d[Io]=null,d[vr]&=-129}return d}function Aa(t,o){if(!(256&o[vr])){const a=o[Mr];o[ts]?.destroy(),o[ns]?.destroy(),a.destroyNode&&Zu(t,o,a,3,null,null),function fo(t){let o=t[ks];if(!o)return Us(t[rr],t);for(;o;){let a=null;if(Fi(o))a=o[ks];else{const d=o[oo];d&&(a=d)}if(!a){for(;o&&!o[Io]&&o!==t;)Fi(o)&&Us(o[rr],o),o=o[Ti];null===o&&(o=t),Fi(o)&&Us(o[rr],o),a=o&&o[Io]}o=a}}(o)}}function Us(t,o){if(!(256&o[vr])){o[vr]&=-129,o[vr]|=256,function ia(t,o){let a;if(null!=t&&null!=(a=t.destroyHooks))for(let d=0;d<a.length;d+=2){const m=o[a[d]];if(!(m instanceof A)){const b=a[d+1];if(Array.isArray(b))for(let I=0;I<b.length;I+=2){const k=m[b[I]],U=b[I+1];vt(4,k,U);try{U.call(k)}finally{vt(5,k,U)}}else{vt(4,m,b);try{b.call(m)}finally{vt(5,m,b)}}}}}(t,o),function Im(t,o){const a=t.cleanup,d=o[Ms];if(null!==a)for(let b=0;b<a.length-1;b+=2)if("string"==typeof a[b]){const I=a[b+3];I>=0?d[I]():d[-I].unsubscribe(),b+=2}else a[b].call(d[a[b+1]]);null!==d&&(o[Ms]=null);const m=o[ms];if(null!==m){o[ms]=null;for(let b=0;b<m.length;b++)(0,m[b])()}}(t,o),1===o[rr].type&&o[Mr].destroy();const a=o[es];if(null!==a&&Wi(o[Ti])){a!==o[Ti]&&Rl(a,o);const d=o[Uo];null!==d&&d.detachView(t)}!function nc(t){Sd.delete(t[jo])}(o)}}function zh(t,o,a){return function vu(t,o,a){let d=o;for(;null!==d&&40&d.type;)d=(o=d).parent;if(null===d)return a[Ri];{const{componentOffset:m}=d;if(m>-1){const{encapsulation:b}=t.data[d.directiveStart+m];if(b===wn.None||b===wn.Emulated)return null}return Br(d,a)}}(t,o.parent,a)}function yc(t,o,a,d,m){t.insertBefore(o,a,d,m)}function Jf(t,o,a){t.appendChild(o,a)}function $h(t,o,a,d,m){null!==d?yc(t,o,a,d,m):Jf(t,o,a)}function Pd(t,o){return t.parentNode(o)}function ic(t,o,a){return Rd(t,o,a)}let Wu,rp,Nd,Rd=function Gc(t,o,a){return 40&t.type?Br(t,a):null};function Od(t,o,a,d){const m=zh(t,d,o),b=o[Mr],k=ic(d.parent||o[Si],d,o);if(null!=m)if(Array.isArray(a))for(let U=0;U<a.length;U++)$h(b,m,a[U],k,!1);else $h(b,m,a,k,!1);void 0!==Wu&&Wu(b,d,o,a,m)}function kd(t,o){if(null!==o){const a=o.type;if(3&a)return Br(o,t);if(4&a)return ep(-1,t[o.index]);if(8&a){const d=o.child;if(null!==d)return kd(t,d);{const m=t[o.index];return Wi(m)?ep(-1,m):Er(m)}}if(32&a)return Uc(o,t)()||Er(t[o.index]);{const d=Qf(t,o);return null!==d?Array.isArray(d)?d[0]:kd(jc(t[$i]),d):kd(t,o.next)}}return null}function Qf(t,o){return null!==o?t[$i][Si].projection[o.projection]:null}function ep(t,o){const a=oo+t+1;if(a<o.length){const d=o[a],m=d[rr].firstChild;if(null!==m)return kd(d,m)}return o[Ho]}function Ld(t,o,a,d,m,b,I){for(;null!=a;){const k=d[a.index],U=a.type;if(I&&0===o&&(k&&ma(Er(k),d),a.flags|=2),32!=(32&a.flags))if(8&U)Ld(t,o,a.child,d,m,b,!1),yu(o,t,m,k,b);else if(32&U){const ie=Uc(a,d);let xe;for(;xe=ie();)yu(o,t,m,xe,b);yu(o,t,m,k,b)}else 16&U?Wc(t,o,d,a,m,b):yu(o,t,m,k,b);a=I?a.projectionNext:a.next}}function Zu(t,o,a,d,m,b){Ld(a,d,t.firstChild,o,m,b,!1)}function Wc(t,o,a,d,m,b){const I=a[$i],U=I[Si].projection[d.projection];if(Array.isArray(U))for(let ie=0;ie<U.length;ie++)yu(o,t,m,U[ie],b);else{let ie=U;const xe=I[Ti];Cd(d)&&(ie.flags|=128),Ld(t,o,ie,xe,m,b,!0)}}function Fd(t,o,a){""===a?t.removeAttribute(o,"class"):t.setAttribute(o,"class",a)}function tp(t,o,a){const{mergedAttrs:d,classes:m,styles:b}=a;null!==d&&on(t,o,d),null!==m&&Fd(t,o,m),null!==b&&function Yu(t,o,a){t.setAttribute(o,"style",a)}(t,o,b)}function km(t){rp=t}function Lm(t){return function zd(){if(void 0===Nd&&(Nd=null,Tr.trustedTypes))try{Nd=Tr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Nd}()?.createScriptURL(t)||t}class Uh{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Pt})`}}function vc(t){return t instanceof Uh?t.changingThisBreaksApplicationSecurity:t}function Ol(t,o){const a=function $d(t){return t instanceof Uh&&t.getTypeName()||null}(t);if(null!=a&&a!==o){if("ResourceURL"===a&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${a} (see ${Pt})`)}return a===o}const Ku=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ed=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(ed||{});function Um(t){const o=nd();return o?o.sanitize(ed.URL,t)||"":Ol(t,"URL")?vc(t):function sp(t){return(t=String(t)).match(Ku)?t:"unsafe:"+t}(ct(t))}function jm(t){const o=nd();if(o)return Lm(o.sanitize(ed.RESOURCE_URL,t)||"");if(Ol(t,"ResourceURL"))return Lm(vc(t));throw new Ce(904,!1)}function Gm(t,o,a){return function td(t,o){return"src"===o&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===o&&("base"===t||"link"===t)?jm:Um}(o,a)(t)}function nd(){const t=Bn();return t&&t[Vo].sanitizer}class po{constructor(o,a){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=en({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Gd=new po("ENVIRONMENT_INITIALIZER"),Wm=new po("INJECTOR",-1),qm=new po("INJECTOR_DEF_TYPES");class Wd{get(o,a=At){if(a===At){const d=new Error(`NullInjectorError: No provider for ${Ze(o)}!`);throw d.name="NullInjectorError",d}return a}}function rd(t){return{\u0275providers:t}}function Wh(...t){return{\u0275providers:Zm(0,t),\u0275fromNgModule:!0}}function Zm(t,...o){const a=[],d=new Set;let m;const b=I=>{a.push(I)};return Lc(o,I=>{const k=I;Zc(k,b,[],d)&&(m||=[],m.push(k))}),void 0!==m&&Ym(m,b),a}function Ym(t,o){for(let a=0;a<t.length;a++){const{ngModule:d,providers:m}=t[a];Zh(m,b=>{o(b,d)})}}function Zc(t,o,a,d){if(!(t=xt(t)))return!1;let m=null,b=Lr(t);const I=!b&&Vr(t);if(b||I){if(I&&!I.standalone)return!1;m=t}else{const U=t.ngModule;if(b=Lr(U),!b)return!1;m=U}const k=d.has(m);if(I){if(k)return!1;if(d.add(m),I.dependencies){const U="function"==typeof I.dependencies?I.dependencies():I.dependencies;for(const ie of U)Zc(ie,o,a,d)}}else{if(!b)return!1;{if(null!=b.imports&&!k){let ie;d.add(m);try{Lc(b.imports,xe=>{Zc(xe,o,a,d)&&(ie||=[],ie.push(xe))})}finally{}void 0!==ie&&Ym(ie,o)}if(!k){const ie=Ko(m)||(()=>new m);o({provide:m,useFactory:ie,deps:qn},m),o({provide:qm,useValue:m,multi:!0},m),o({provide:Gd,useValue:()=>mn(m),multi:!0},m)}const U=b.providers;if(null!=U&&!k){const ie=t;Zh(U,xe=>{o(xe,ie)})}}}return m!==t&&void 0!==t.providers}function Zh(t,o){for(let a of t)et(a)&&(a=a.\u0275providers),Array.isArray(a)?Zh(a,o):o(a)}const qd=ye({provide:String,useValue:ye});function Yh(t){return null!==t&&"object"==typeof t&&qd in t}function Yc(t){return"function"==typeof t}const Xh=new po("Set Injector scope."),Zd={},Jm={};let dp;function Kh(){return void 0===dp&&(dp=new Wd),dp}class kl{}class wu extends kl{get destroyed(){return this._destroyed}constructor(o,a,d,m){super(),this.parent=a,this.source=d,this.scopes=m,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hp(o,I=>this.processProvider(I)),this.records.set(Wm,sc(void 0,this)),m.has("environment")&&this.records.set(kl,sc(void 0,this));const b=this.records.get(Xh);null!=b&&"string"==typeof b.value&&this.scopes.add(b.value),this.injectorDefTypes=new Set(this.get(qm.multi,qn,hr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const a of this._ngOnDestroyHooks)a.ngOnDestroy();const o=this._onDestroyHooks;this._onDestroyHooks=[];for(const a of o)a()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(o){return this.assertNotDestroyed(),this._onDestroyHooks.push(o),()=>this.removeOnDestroy(o)}runInContext(o){this.assertNotDestroyed();const a=nt(this),d=mr(void 0);try{return o()}finally{nt(a),mr(d)}}get(o,a=At,d=hr.Default){if(this.assertNotDestroyed(),o.hasOwnProperty(Gr))return o[Gr](this);d=dr(d);const b=nt(this),I=mr(void 0);try{if(!(d&hr.SkipSelf)){let U=this.records.get(o);if(void 0===U){const ie=function q_(t){return"function"==typeof t||"object"==typeof t&&t instanceof po}(o)&&pr(o);U=ie&&this.injectableDefInScope(ie)?sc(Jh(o),Zd):null,this.records.set(o,U)}if(null!=U)return this.hydrate(o,U)}return(d&hr.Self?Kh():this.parent).get(o,a=d&hr.Optional&&a===At?null:a)}catch(k){if("NullInjectorError"===k.name){if((k[Bt]=k[Bt]||[]).unshift(Ze(o)),b)throw k;return function no(t,o,a,d){const m=t[Bt];throw o[ce]&&m.unshift(o[ce]),t.message=function Bo(t,o,a,d=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let m=Ze(o);if(Array.isArray(o))m=o.map(Ze).join(" -> ");else if("object"==typeof o){let b=[];for(let I in o)if(o.hasOwnProperty(I)){let k=o[I];b.push(I+":"+("string"==typeof k?JSON.stringify(k):Ze(k)))}m=`{${b.join(", ")}}`}return`${a}${d?"("+d+")":""}[${m}]: ${t.replace(ke,"\n  ")}`}("\n"+t.message,m,a,d),t.ngTokenPath=m,t[Bt]=null,t}(k,o,"R3InjectorError",this.source)}throw k}finally{mr(I),nt(b)}}resolveInjectorInitializers(){const o=nt(this),a=mr(void 0);try{const m=this.get(Gd.multi,qn,hr.Self);for(const b of m)b()}finally{nt(o),mr(a)}}toString(){const o=[],a=this.records;for(const d of a.keys())o.push(Ze(d));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ce(205,!1)}processProvider(o){let a=Yc(o=xt(o))?o:xt(o&&o.provide);const d=function Yd(t){return Yh(t)?sc(void 0,t.useValue):sc(Eu(t),Zd)}(o);if(Yc(o)||!0!==o.multi)this.records.get(a);else{let m=this.records.get(a);m||(m=sc(void 0,Zd,!0),m.factory=()=>yr(m.multi),this.records.set(a,m)),a=o,m.multi.push(o)}this.records.set(a,d)}hydrate(o,a){return a.value===Zd&&(a.value=Jm,a.value=a.factory()),"object"==typeof a.value&&a.value&&function eg(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(a.value)&&this._ngOnDestroyHooks.add(a.value),a.value}injectableDefInScope(o){if(!o.providedIn)return!1;const a=xt(o.providedIn);return"string"==typeof a?"any"===a||this.scopes.has(a):this.injectorDefTypes.has(a)}removeOnDestroy(o){const a=this._onDestroyHooks.indexOf(o);-1!==a&&this._onDestroyHooks.splice(a,1)}}function Jh(t){const o=pr(t),a=null!==o?o.factory:Ko(t);if(null!==a)return a;if(t instanceof po)throw new Ce(204,!1);if(t instanceof Function)return function ga(t){const o=t.length;if(o>0)throw Fc(o,"?"),new Ce(204,!1);const a=function Xn(t){return t&&(t[yn]||t[Li])||null}(t);return null!==a?()=>a.factory(t):()=>new t}(t);throw new Ce(204,!1)}function Eu(t,o,a){let d;if(Yc(t)){const m=xt(t);return Ko(m)||Jh(m)}if(Yh(t))d=()=>xt(t.useValue);else if(function up(t){return!(!t||!t.useFactory)}(t))d=()=>t.useFactory(...yr(t.deps||[]));else if(function Xm(t){return!(!t||!t.useExisting)}(t))d=()=>mn(xt(t.useExisting));else{const m=xt(t&&(t.useClass||t.provide));if(!function Qm(t){return!!t.deps}(t))return Ko(m)||Jh(m);d=()=>new m(...yr(t.deps))}return d}function sc(t,o,a=!1){return{factory:t,value:o,multi:a?[]:void 0}}function hp(t,o){for(const a of t)Array.isArray(a)?hp(a,o):a&&et(a)?hp(a.\u0275providers,o):o(a)}const tg=new po("AppId",{providedIn:"root",factory:()=>Z_}),Z_="ng",ng=new po("Platform Initializer"),fp=new po("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Y_=new po("AnimationModuleType"),rg=new po("CSP nonce",{providedIn:"root",factory:()=>function xu(){if(void 0!==rp)return rp;if(typeof document<"u")return document;throw new Ce(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let xp=(t,o,a)=>null;function Kd(t,o,a=!1){return xp(t,o,a)}class Q_{}class ug{}class dg{resolveComponentFactory(o){throw function ey(t){const o=Error(`No component factory found for ${Ze(t)}.`);return o.ngComponent=t,o}(o)}}let Kc=(()=>{class o{}return o.NULL=new dg,o})();function Dp(){return od(ds(),Bn())}function od(t,o){return new th(Br(t,o))}let th=(()=>{class o{constructor(d){this.nativeElement=d}}return o.__NG_ELEMENT_ID__=Dp,o})();function ty(t){return t instanceof th?t.nativeElement:t}class Cp{}let Tp=(()=>{class o{constructor(){this.destroyNode=null}}return o.__NG_ELEMENT_ID__=()=>function Oa(){const t=Bn(),a=ko(ds().index,t);return(Fi(a)?a:t)[Mr]}(),o})(),Sp=(()=>{var t;class o{}return(t=o).\u0275prov=en({token:t,providedIn:"root",factory:()=>null}),o})();class Ip{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Wa=new Ip("16.2.0"),sf={};function Ap(t,o=null,a=null,d){const m=_g(t,o,a,d);return m.resolveInjectorInitializers(),m}function _g(t,o=null,a=null,d,m=new Set){const b=[a||qn,Wh(t)];return d=d||("object"==typeof t?void 0:Ze(t)),new wu(b,o||Kh(),d||null,m)}let fl=(()=>{var t;class o{static create(d,m){if(Array.isArray(d))return Ap({name:""},m,d,"");{const b=d.name??"";return Ap({name:b},d.parent,d.providers,b)}}}return(t=o).THROW_IF_NOT_FOUND=At,t.NULL=new Wd,t.\u0275prov=en({token:t,providedIn:"any",factory:()=>mn(Wm)}),t.__NG_ELEMENT_ID__=-1,o})();function ac(t){return t instanceof Function?t():t}let el=(()=>{var t;class o{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new Ce(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const d of this.callbacks)d.invoke()}finally{this.runningCallbacks=!1;for(const d of this.deferredCallbacks)this.callbacks.add(d);this.deferredCallbacks.clear()}}register(d){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(d)}unregister(d){this.callbacks.delete(d),this.deferredCallbacks.delete(d)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(t=o).\u0275prov=en({token:t,providedIn:"root",factory:()=>new t}),o})();function Su(t){for(;t;){t[vr]|=64;const o=jc(t);if(sa(t)&&!o)return t;t=o}return null}function uf(t){return t.ngOriginalError}class bc{constructor(){this._console=console}handleError(o){const a=this._findOriginalError(o);this._console.error("ERROR",o),a&&this._console.error("ORIGINAL ERROR",a)}_findOriginalError(o){let a=o&&uf(o);for(;a&&uf(a);)a=uf(a);return a||null}}const sh=new po("",{providedIn:"root",factory:()=>!1});class Sg extends Fs{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(o){this._lView=o}onConsumerDependencyMayHaveChanged(){Su(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(o,a,d){const m=uo(this);this.trackingVersion++;try{o(a,d)}finally{uo(m)}}destroy(){this.trackingVersion++}}let Qc=null;function wc(){return Qc??=new Sg,Qc}function Op(t,o){return t[o]??wc()}function kp(t,o){const a=wc();a.hasReadASignal&&(t[o]=Qc,a.lView=t,Qc=new Sg)}const pi={};function df(t){Ig(ni(),Bn(),ve()+t,!1)}function Ig(t,o,a,d){if(!d)if(3==(3&o[vr])){const b=t.preOrderCheckHooks;null!==b&&_o(o,b,a)}else{const b=t.preOrderHooks;null!==b&&h(o,b,0,a)}me(a)}function Mu(t,o=hr.Default){const a=Bn();return null===a?mn(t,o):An(ds(),a,xt(t),o)}function eu(){throw new Error("invalid")}function Fl(t,o,a,d,m,b,I,k,U,ie,xe){const Je=o.blueprint.slice();return Je[Ri]=m,Je[vr]=140|d,(null!==ie||t&&2048&t[vr])&&(Je[vr]|=2048),Cs(Je),Je[Ti]=Je[go]=t,Je[Qi]=a,Je[Vo]=I||t&&t[Vo],Je[Mr]=k||t&&t[Mr],Je[$o]=U||t&&t[$o]||null,Je[Si]=b,Je[jo]=function pa(){return Vf++}(),Je[cs]=xe,Je[oa]=ie,Je[$i]=2==o.type?t[$i]:Je,Je}function ld(t,o,a,d,m){let b=t.data[o];if(null===b)b=function Au(t,o,a,d,m){const b=Dl(),I=Yl(),U=t.data[o]=function Rg(t,o,a,d,m,b){let I=o?o.injectorIndex:-1,k=0;return Da()&&(k|=128),{type:a,index:d,insertBeforeIndex:null,injectorIndex:I,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:k,providerIndexes:0,value:m,attrs:b,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,I?b:b&&b.parent,a,o,d,m);return null===t.firstChild&&(t.firstChild=U),null!==b&&(I?null==b.child&&null!==U.parent&&(b.child=U):null===b.next&&(b.next=U,U.prev=b)),U}(t,o,a,d,m),function Pc(){return ei.lFrame.inI18n}()&&(b.flags|=32);else if(64&b.type){b.type=a,b.value=d,b.attrs=m;const I=function $a(){const t=ei.lFrame,o=t.currentTNode;return t.isParent?o:o.parent}();b.injectorIndex=null===I?-1:I.injectorIndex}return na(b,!0),b}function Ec(t,o,a,d){if(0===a)return-1;const m=o.length;for(let b=0;b<a;b++)o.push(d),t.blueprint.push(d),t.data.push(null);return m}function cd(t,o,a,d,m){const b=Op(o,ts),I=ve(),k=2&d;try{if(me(-1),k&&o.length>Qn&&Ig(t,o,Qn,!1),vt(k?2:0,m),k)b.runInContext(a,d,m);else{const ie=uo(null);try{a(d,m)}finally{uo(ie)}}}finally{k&&null===o[ts]&&kp(o,ts),me(I),vt(k?3:1,m)}}function Pu(t,o,a){if(Hs(o)){const d=uo(null);try{const b=o.directiveEnd;for(let I=o.directiveStart;I<b;I++){const k=t.data[I];k.contentQueries&&k.contentQueries(1,a[I],I)}}finally{uo(d)}}}function ud(t,o,a){Wl()&&(function Np(t,o,a,d){const m=a.directiveStart,b=a.directiveEnd;gs(a)&&function ch(t,o,a){const d=Br(o,t),m=Mg(a);let I=16;a.signals?I=4096:a.onPush&&(I=64);const k=Nl(t,Fl(t,m,null,I,d,o,null,t[Vo].rendererFactory.createRenderer(d,a),null,null,null));t[o.index]=k}(o,a,t.data[m+a.componentOffset]),t.firstCreatePass||Rn(a,o),ma(d,o);const I=a.initialInputs;for(let k=m;k<b;k++){const U=t.data[k],ie=ur(o,t,k,a);ma(ie,o),null!==I&&kg(0,k-m,ie,U,0,I),Xo(U)&&(ko(a.index,o)[Qi]=ur(o,t,k,a))}}(t,o,a,Br(a,o)),64==(64&a.flags)&&zp(t,o,a))}function Lp(t,o,a=Br){const d=o.localNames;if(null!==d){let m=o.index+1;for(let b=0;b<d.length;b+=2){const I=d[b+1],k=-1===I?a(o,t):t[I];t[m++]=k}}}function Mg(t){const o=t.tView;return null===o||o.incompleteFirstPass?t.tView=tu(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):o}function tu(t,o,a,d,m,b,I,k,U,ie,xe){const Je=Qn+d,Rt=Je+m,Gt=function hf(t,o){const a=[];for(let d=0;d<o;d++)a.push(d<t?null:pi);return a}(Je,Rt),Mn="function"==typeof ie?ie():ie;return Gt[rr]={type:t,blueprint:Gt,template:a,queries:null,viewQuery:k,declTNode:o,data:Gt.slice().fill(null,Je),bindingStartIndex:Je,expandoStartIndex:Rt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof b?b():b,pipeRegistry:"function"==typeof I?I():I,firstChild:null,schemas:U,consts:Mn,incompleteFirstPass:!1,ssrId:xe}}let Fp=t=>null;function Og(t,o,a,d){for(let m in t)if(t.hasOwnProperty(m)){a=null===a?{}:a;const b=t[m];null===d?Bp(a,o,m,b):d.hasOwnProperty(m)&&Bp(a,o,d[m],b)}return a}function Bp(t,o,a,d){t.hasOwnProperty(a)?t[a].push(o,d):t[a]=[o,d]}function _a(t,o,a,d,m,b,I,k){const U=Br(o,a);let xe,ie=o.inputs;!k&&null!=ie&&(xe=ie[d])?(dh(t,a,xe,d,m),gs(o)&&function ff(t,o){const a=ko(o,t);16&a[vr]||(a[vr]|=64)}(a,o.index)):3&o.type&&(d=function fy(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(d),m=null!=I?I(m,o.value||"",d):m,b.setProperty(U,d,m))}function lh(t,o,a,d){if(Wl()){const m=null===d?null:{"":-1},b=function my(t,o){const a=t.directiveRegistry;let d=null,m=null;if(a)for(let b=0;b<a.length;b++){const I=a[b];if($e(o,I.selectors,!1))if(d||(d=[]),Xo(I))if(null!==I.findHostDirectiveDefs){const k=[];m=m||new Map,I.findHostDirectiveDefs(I,k,m),d.unshift(...k,I),$p(t,o,k.length)}else d.unshift(I),$p(t,o,0);else m=m||new Map,I.findHostDirectiveDefs?.(I,d,m),d.push(I)}return null===d?null:[d,m]}(t,a);let I,k;null===b?I=k=null:[I,k]=b,null!==I&&mf(t,o,a,I,m,k),m&&function gy(t,o,a){if(o){const d=t.localNames=[];for(let m=0;m<o.length;m+=2){const b=a[o[m+1]];if(null==b)throw new Ce(-301,!1);d.push(o[m],b)}}}(a,d,m)}a.mergedAttrs=ii(a.mergedAttrs,a.attrs)}function mf(t,o,a,d,m,b){for(let ie=0;ie<d.length;ie++)Ln(Rn(a,o),t,d[ie].type);!function Vp(t,o,a){t.flags|=1,t.directiveStart=o,t.directiveEnd=o+a,t.providerIndexes=o}(a,t.data.length,d.length);for(let ie=0;ie<d.length;ie++){const xe=d[ie];xe.providersResolver&&xe.providersResolver(xe)}let I=!1,k=!1,U=Ec(t,o,d.length,null);for(let ie=0;ie<d.length;ie++){const xe=d[ie];a.mergedAttrs=ii(a.mergedAttrs,xe.hostAttrs),yy(t,a,o,U,xe),_y(U,xe,m),null!==xe.contentQueries&&(a.flags|=4),(null!==xe.hostBindings||null!==xe.hostAttrs||0!==xe.hostVars)&&(a.flags|=64);const Je=xe.type.prototype;!I&&(Je.ngOnChanges||Je.ngOnInit||Je.ngDoCheck)&&((t.preOrderHooks??=[]).push(a.index),I=!0),!k&&(Je.ngOnChanges||Je.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(a.index),k=!0),U++}!function hy(t,o,a){const m=o.directiveEnd,b=t.data,I=o.attrs,k=[];let U=null,ie=null;for(let xe=o.directiveStart;xe<m;xe++){const Je=b[xe],Rt=a?a.get(Je):null,Mn=Rt?Rt.outputs:null;U=Og(Je.inputs,xe,U,Rt?Rt.inputs:null),ie=Og(Je.outputs,xe,ie,Mn);const Kn=null===U||null===I||Po(o)?null:Fg(U,xe,I);k.push(Kn)}null!==U&&(U.hasOwnProperty("class")&&(o.flags|=8),U.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=k,o.inputs=U,o.outputs=ie}(t,a,b)}function zp(t,o,a){const d=a.directiveStart,m=a.directiveEnd,b=a.index,I=function md(){return ei.lFrame.currentDirectiveIndex}();try{me(b);for(let k=d;k<m;k++){const U=t.data[k],ie=o[k];Kl(k),(null!==U.hostBindings||0!==U.hostVars||null!==U.hostAttrs)&&gf(U,ie)}}finally{me(-1),Kl(I)}}function gf(t,o){null!==t.hostBindings&&t.hostBindings(1,o)}function $p(t,o,a){o.componentOffset=a,(t.components??=[]).push(o.index)}function _y(t,o,a){if(a){if(o.exportAs)for(let d=0;d<o.exportAs.length;d++)a[o.exportAs[d]]=t;Xo(o)&&(a[""]=t)}}function yy(t,o,a,d,m){t.data[d]=m;const b=m.factory||(m.factory=Ko(m.type)),I=new A(b,Xo(m),Mu);t.blueprint[d]=I,a[d]=I,function nu(t,o,a,d,m){const b=m.hostBindings;if(b){let I=t.hostBindingOpCodes;null===I&&(I=t.hostBindingOpCodes=[]);const k=~o.index;(function py(t){let o=t.length;for(;o>0;){const a=t[--o];if("number"==typeof a&&a<0)return a}return 0})(I)!=k&&I.push(k),I.push(a,d,b)}}(t,o,d,Ec(t,a,m.hostVars,pi),m)}function lc(t,o,a,d,m,b){const I=Br(t,o);!function Up(t,o,a,d,m,b,I){if(null==b)t.removeAttribute(o,m,a);else{const k=null==I?ct(b):I(b,d||"",m);t.setAttribute(o,m,k,a)}}(o[Mr],I,b,t.value,a,d,m)}function kg(t,o,a,d,m,b){const I=b[o];if(null!==I)for(let k=0;k<I.length;)Lg(d,a,I[k++],I[k++],I[k++])}function Lg(t,o,a,d,m){const b=uo(null);try{const I=t.inputTransforms;null!==I&&I.hasOwnProperty(d)&&(m=I[d].call(o,m)),null!==t.setInput?t.setInput(o,m,a,d):o[d]=m}finally{uo(b)}}function Fg(t,o,a){let d=null,m=0;for(;m<a.length;){const b=a[m];if(0!==b)if(5!==b){if("number"==typeof b)break;if(t.hasOwnProperty(b)){null===d&&(d=[]);const I=t[b];for(let k=0;k<I.length;k+=2)if(I[k]===o){d.push(b,I[k+1],a[m+1]);break}}m+=2}else m+=2;else m+=4}return d}function tl(t,o,a,d){return[t,!0,!1,o,null,0,d,a,null,null,null]}function Bl(t,o){const a=t.contentQueries;if(null!==a)for(let d=0;d<a.length;d+=2){const b=a[d+1];if(-1!==b){const I=t.data[b];qs(a[d]),I.contentQueries(2,o[b],b)}}}function Nl(t,o){return t[ks]?t[ls][Io]=o:t[ks]=o,t[ls]=o,o}function pl(t,o,a){qs(0);const d=uo(null);try{o(t,a)}finally{uo(d)}}function uh(t){return t[Ms]||(t[Ms]=[])}function jp(t){return t.cleanup||(t.cleanup=[])}function Gp(t,o){const a=t[$o],d=a?a.get(bc,null):null;d&&d.handleError(o)}function dh(t,o,a,d,m){for(let b=0;b<a.length;){const I=a[b++],k=a[b++];Lg(t.data[I],o[I],d,k,m)}}function Bg(t,o){const a=ko(o,t),d=a[rr];!function Ng(t,o){for(let a=o.length;a<t.blueprint.length;a++)o.push(t.blueprint[a])}(d,a);const m=a[Ri];null!==m&&null===a[cs]&&(a[cs]=Kd(m,a[$o])),_f(d,a,a[Qi])}function _f(t,o,a){N(o);try{const d=t.viewQuery;null!==d&&pl(1,d,a);const m=t.template;null!==m&&cd(t,o,m,1,a),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Bl(t,o),t.staticViewQueries&&pl(2,t.viewQuery,a);const b=t.components;null!==b&&function zg(t,o){for(let a=0;a<o.length;a++)Bg(t,o[a])}(o,b)}catch(d){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),d}finally{o[vr]&=-5,S()}}let Wp=(()=>{var t;class o{constructor(){this.all=new Set,this.queue=new Map}create(d,m,b){const I=typeof Zone>"u"?null:Zone.current,k=new Ea(d,xe=>{this.all.has(xe)&&this.queue.set(xe,I)},b);let U;this.all.add(k),k.notify();const ie=()=>{k.cleanup(),U?.(),this.all.delete(k),this.queue.delete(k)};return U=m?.onDestroy(ie),{destroy:ie}}flush(){if(0!==this.queue.size)for(const[d,m]of this.queue)this.queue.delete(d),m?m.run(()=>d.run()):d.run()}get isQueueEmpty(){return 0===this.queue.size}}return(t=o).\u0275prov=en({token:t,providedIn:"root",factory:()=>new t}),o})();function hh(t,o,a){let d=a?t.styles:null,m=a?t.classes:null,b=0;if(null!==o)for(let I=0;I<o.length;I++){const k=o[I];"number"==typeof k?b=k:1==b?m=Qe(m,k):2==b&&(d=Qe(d,k+": "+o[++I]+";"))}a?t.styles=d:t.stylesWithoutHost=d,a?t.classes=m:t.classesWithoutHost=m}function ml(t,o,a,d,m=!1){for(;null!==a;){const b=o[a.index];if(null!==b&&d.push(Er(b)),Wi(b)){for(let k=oo;k<b.length;k++){const U=b[k],ie=U[rr].firstChild;null!==ie&&ml(U[rr],U,ie,d)}b[Ho]!==b[Ri]&&d.push(b[Ho])}const I=a.type;if(8&I)ml(t,o,a.child,d);else if(32&I){const k=Uc(a,o);let U;for(;U=k();)d.push(U)}else if(16&I){const k=Qf(o,a);if(Array.isArray(k))d.push(...k);else{const U=jc(o[$i]);ml(U[rr],U,k,d,!0)}}a=m?a.projectionNext:a.next}return d}function fh(t,o,a,d=!0){const m=o[Vo],b=m.rendererFactory,I=m.afterRenderEventManager;b.begin?.(),I?.begin();try{ph(t,o,t.template,a)}catch(U){throw d&&Gp(o,U),U}finally{b.end?.(),m.effectManager?.flush(),I?.end()}}function ph(t,o,a,d){const m=o[vr];if(256!=(256&m)){o[Vo].effectManager?.flush(),N(o);try{Cs(o),function Cl(t){return ei.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==a&&cd(t,o,a,2,d);const I=3==(3&m);if(I){const ie=t.preOrderCheckHooks;null!==ie&&_o(o,ie,null)}else{const ie=t.preOrderHooks;null!==ie&&h(o,ie,0,null),i(o,0)}if(function dd(t){for(let o=Bh(t);null!==o;o=Zf(o)){if(!o[va])continue;const a=o[co];for(let d=0;d<a.length;d++){aa(a[d])}}}(o),Vg(o,2),null!==t.contentQueries&&Bl(t,o),I){const ie=t.contentCheckHooks;null!==ie&&_o(o,ie)}else{const ie=t.contentHooks;null!==ie&&h(o,ie,1),i(o,1)}!function ly(t,o){const a=t.hostBindingOpCodes;if(null===a)return;const d=Op(o,ns);try{for(let m=0;m<a.length;m++){const b=a[m];if(b<0)me(~b);else{const I=b,k=a[++m],U=a[++m];Ss(k,I),d.runInContext(U,2,o[I])}}}finally{null===o[ns]&&kp(o,ns),me(-1)}}(t,o);const k=t.components;null!==k&&zl(o,k,0);const U=t.viewQuery;if(null!==U&&pl(2,U,d),I){const ie=t.viewCheckHooks;null!==ie&&_o(o,ie)}else{const ie=t.viewHooks;null!==ie&&h(o,ie,2),i(o,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o[vr]&=-73,Gl(o)}finally{S()}}}function Vg(t,o){for(let a=Bh(t);null!==a;a=Zf(a))for(let d=oo;d<a.length;d++)yf(a[d],o)}function qp(t,o,a){yf(ko(o,t),a)}function yf(t,o){if(!function ta(t){return 128==(128&t[vr])}(t))return;const a=t[rr];if(80&t[vr]&&0===o||1024&t[vr]||2===o)ph(a,t,a.template,t[Qi]);else if(t[zo]>0){Vg(t,1);const m=t[rr].components;null!==m&&zl(t,m,1)}}function zl(t,o,a){for(let d=0;d<o.length;d++)qp(t,o[d],a)}class Ou{get rootNodes(){const o=this._lView,a=o[rr];return ml(a,o,a.firstChild,[])}constructor(o,a){this._lView=o,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Qi]}set context(o){this._lView[Qi]=o}get destroyed(){return 256==(256&this._lView[vr])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[Ti];if(Wi(o)){const a=o[8],d=a?a.indexOf(this):-1;d>-1&&(Ga(o,d),dl(a,d))}this._attachedToViewContainer=!1}Aa(this._lView[rr],this._lView)}onDestroy(o){!function or(t,o){if(256==(256&t[vr]))throw new Ce(911,!1);null===t[ms]&&(t[ms]=[]),t[ms].push(o)}(this._lView,o)}markForCheck(){Su(this._cdRefInjectingView||this._lView)}detach(){this._lView[vr]&=-129}reattach(){this._lView[vr]|=128}detectChanges(){fh(this._lView[rr],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Hc(t,o){Zu(t,o,o[Mr],2,null,null)}(this._lView[rr],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Ce(902,!1);this._appRef=o}}class Zp extends Ou{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;fh(o[rr],o,o[Qi],!1)}checkNoChanges(){}get context(){return null}}class gl extends Kc{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const a=Vr(o);return new Cc(a,this.ngModule)}}function ru(t){const o=[];for(let a in t)t.hasOwnProperty(a)&&o.push({propName:t[a],templateName:a});return o}class jg{constructor(o,a){this.injector=o,this.parentInjector=a}get(o,a,d){d=dr(d);const m=this.injector.get(o,sf,d);return m!==sf||a===sf?m:this.parentInjector.get(o,a,d)}}class Cc extends ug{get inputs(){const o=this.componentDef,a=o.inputTransforms,d=ru(o.inputs);if(null!==a)for(const m of d)a.hasOwnProperty(m.propName)&&(m.transform=a[m.propName]);return d}get outputs(){return ru(this.componentDef.outputs)}constructor(o,a){super(),this.componentDef=o,this.ngModule=a,this.componentType=o.type,this.selector=function un(t){return t.map(gn).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!a}create(o,a,d,m){let b=(m=m||this.ngModule)instanceof kl?m:m?.injector;b&&null!==this.componentDef.getStandaloneInjector&&(b=this.componentDef.getStandaloneInjector(b)||b);const I=b?new jg(o,b):o,k=I.get(Cp,null);if(null===k)throw new Ce(407,!1);const Je={rendererFactory:k,sanitizer:I.get(Sp,null),effectManager:I.get(Wp,null),afterRenderEventManager:I.get(el,null)},Rt=k.createRenderer(null,this.componentDef),Gt=this.componentDef.selectors[0][0]||"div",Mn=d?function cy(t,o,a,d){const b=d.get(sh,!1)||a===wn.ShadowDom,I=t.selectRootElement(o,b);return function Ag(t){Fp(t)}(I),I}(Rt,d,this.componentDef.encapsulation,I):Nh(Rt,Gt,function Ug(t){const o=t.toLowerCase();return"svg"===o?vn:"math"===o?"math":null}(Gt)),Kr=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let jn=null;null!==Mn&&(jn=Kd(Mn,I,!0));const _i=tu(0,null,null,1,0,null,null,null,null,null,null),Ni=Fl(null,_i,null,Kr,null,null,Je,Rt,I,null,jn);let Zo,vl;N(Ni);try{const Nu=this.componentDef;let Of,xv=null;Nu.findHostDirectiveDefs?(Of=[],xv=new Map,Nu.findHostDirectiveDefs(Nu,Of,xv),Of.push(Nu)):Of=[Nu];const DC=function Hg(t,o){const a=t[rr],d=Qn;return t[d]=o,ld(a,d,2,"#host",null)}(Ni,Mn),CC=function Gg(t,o,a,d,m,b,I){const k=m[rr];!function xy(t,o,a,d){for(const m of t)o.mergedAttrs=ii(o.mergedAttrs,m.hostAttrs);null!==o.mergedAttrs&&(hh(o,o.mergedAttrs,!0),null!==a&&tp(d,a,o))}(d,t,o,I);let U=null;null!==o&&(U=Kd(o,m[$o]));const ie=b.rendererFactory.createRenderer(o,a);let xe=16;a.signals?xe=4096:a.onPush&&(xe=64);const Je=Fl(m,Mg(a),null,xe,m[t.index],t,b,ie,null,null,U);return k.firstCreatePass&&$p(k,t,d.length-1),Nl(m,Je),m[t.index]=Je}(DC,Mn,Nu,Of,Ni,Je,Rt);vl=Ei(_i,Qn),Mn&&function qg(t,o,a,d){if(d)on(t,a,["ng-version",Wa.full]);else{const{attrs:m,classes:b}=function In(t){const o=[],a=[];let d=1,m=2;for(;d<t.length;){let b=t[d];if("string"==typeof b)2===m?""!==b&&o.push(b,t[++d]):8===m&&a.push(b);else{if(!Dr(m))break;m=b}d++}return{attrs:o,classes:a}}(o.selectors[0]);m&&on(t,a,m),b&&b.length>0&&Fd(t,a,b.join(" "))}}(Rt,Nu,Mn,d),void 0!==a&&function Zg(t,o,a){const d=t.projection=[];for(let m=0;m<o.length;m++){const b=a[m];d.push(null!=b?Array.from(b):null)}}(vl,this.ngContentSelectors,a),Zo=function Wg(t,o,a,d,m,b){const I=ds(),k=m[rr],U=Br(I,m);mf(k,m,I,a,null,d);for(let xe=0;xe<a.length;xe++)ma(ur(m,k,I.directiveStart+xe,I),m);zp(k,m,I),U&&ma(U,m);const ie=ur(m,k,I.directiveStart+I.componentOffset,I);if(t[Qi]=m[Qi]=ie,null!==b)for(const xe of b)xe(ie,o);return Pu(k,I,t),ie}(CC,Nu,Of,xv,Ni,[by]),_f(_i,Ni,null)}finally{S()}return new vf(this.componentType,Zo,od(vl,Ni),Ni,vl)}}class vf extends Q_{constructor(o,a,d,m,b){super(),this.location=d,this._rootLView=m,this._tNode=b,this.previousInputValues=null,this.instance=a,this.hostView=this.changeDetectorRef=new Zp(m),this.componentType=o}setInput(o,a){const d=this._tNode.inputs;let m;if(null!==d&&(m=d[o])){if(this.previousInputValues??=new Map,this.previousInputValues.has(o)&&Object.is(this.previousInputValues.get(o),a))return;const b=this._rootLView;dh(b[rr],b,m,o,a),this.previousInputValues.set(o,a),Su(ko(this._tNode.index,b))}}get injector(){return new gi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function by(){const t=ds();Zi(Bn()[rr],t)}function bf(t){let o=function xf(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),a=!0;const d=[t];for(;o;){let m;if(Xo(t))m=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Ce(903,!1);m=o.\u0275dir}if(m){if(a){d.push(m);const I=t;I.inputs=mh(t.inputs),I.inputTransforms=mh(t.inputTransforms),I.declaredInputs=mh(t.declaredInputs),I.outputs=mh(t.outputs);const k=m.hostBindings;k&&Xg(t,k);const U=m.viewQuery,ie=m.contentQueries;if(U&&Yp(t,U),ie&&Xp(t,ie),Ae(t.inputs,m.inputs),Ae(t.declaredInputs,m.declaredInputs),Ae(t.outputs,m.outputs),null!==m.inputTransforms&&(null===I.inputTransforms&&(I.inputTransforms={}),Ae(I.inputTransforms,m.inputTransforms)),Xo(m)&&m.data.animation){const xe=t.data;xe.animation=(xe.animation||[]).concat(m.data.animation)}}const b=m.features;if(b)for(let I=0;I<b.length;I++){const k=b[I];k&&k.ngInherit&&k(t),k===bf&&(a=!1)}}o=Object.getPrototypeOf(o)}!function Yg(t){let o=0,a=null;for(let d=t.length-1;d>=0;d--){const m=t[d];m.hostVars=o+=m.hostVars,m.hostAttrs=ii(m.hostAttrs,a=ii(a,m.hostAttrs))}}(d)}function mh(t){return t===cr?{}:t===qn?[]:t}function Yp(t,o){const a=t.viewQuery;t.viewQuery=a?(d,m)=>{o(d,m),a(d,m)}:o}function Xp(t,o){const a=t.contentQueries;t.contentQueries=a?(d,m,b)=>{o(d,m,b),a(d,m,b)}:o}function Xg(t,o){const a=t.hostBindings;t.hostBindings=a?(d,m)=>{o(d,m),a(d,m)}:o}function _(t){const o=t.inputConfig,a={};for(const d in o)if(o.hasOwnProperty(d)){const m=o[d];Array.isArray(m)&&m[2]&&(a[d]=m[2])}t.inputTransforms=a}function C(t){return!!V(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function V(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function le(t,o,a){return!Object.is(t[o],a)&&(t[o]=a,!0)}function je(t,o,a,d){const m=Bn();return le(m,Xa(),o)&&(ni(),lc(st(),m,t,o,a,d)),je}function ft(t,o,a,d){return le(t,Xa(),a)?o+ct(a)+d:pi}function wf(t,o,a,d,m,b,I,k){const U=Bn(),ie=ni(),xe=t+Qn,Je=ie.firstCreatePass?function e_(t,o,a,d,m,b,I,k,U){const ie=o.consts,xe=ld(o,t,4,I||null,_s(ie,k));lh(o,a,xe,_s(ie,U)),Zi(o,xe);const Je=xe.tView=tu(2,xe,d,m,b,o.directiveRegistry,o.pipeRegistry,null,o.schemas,ie,null);return null!==o.queries&&(o.queries.template(o,xe),Je.queries=o.queries.embeddedTView(xe)),xe}(xe,ie,U,o,a,d,m,b,I):ie.data[xe];na(Je,!1);const Rt=Ef(ie,U,Je,t);Zr()&&Od(ie,U,Rt,Je),ma(Rt,U),Nl(U,U[xe]=tl(Rt,U,Rt,Je)),us(Je)&&ud(ie,U,Je),null!=I&&Lp(U,Je,k)}let Ef=function $l(t,o,a,d){return Ur(!0),o[Mr].createComment("")};function Df(t){return function ki(t,o){return t[o]}(function mc(){return ei.lFrame.contextLView}(),Qn+t)}function uc(t,o,a){const d=Bn();return le(d,Xa(),o)&&_a(ni(),st(),d,t,o,d[Mr],a,!1),uc}function yh(t,o,a,d,m){const I=m?"class":"style";dh(t,a,o.inputs[I],I,d)}function ua(t,o,a,d){const m=Bn(),b=ni(),I=Qn+t,k=m[Mr],U=b.firstCreatePass?function wy(t,o,a,d,m,b){const I=o.consts,U=ld(o,t,2,d,_s(I,m));return lh(o,a,U,_s(I,b)),null!==U.attrs&&hh(U,U.attrs,!1),null!==U.mergedAttrs&&hh(U,U.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,U),U}(I,b,m,o,a,d):b.data[I],ie=Cf(b,m,U,k,o,t);m[I]=ie;const xe=us(U);return na(U,!0),tp(k,ie,U),32!=(32&U.flags)&&Zr()&&Od(b,m,ie,U),0===function ys(){return ei.lFrame.elementDepthCount}()&&ma(ie,m),function Ya(){ei.lFrame.elementDepthCount++}(),xe&&(ud(b,m,U),Pu(b,U,m)),null!==d&&Lp(m,U),ua}function da(){let t=ds();Yl()?Ac():(t=t.parent,na(t,!1));const o=t;(function au(t){return ei.skipHydrationRootTNode===t})(o)&&function pc(){ei.skipHydrationRootTNode=null}(),function Bs(){ei.lFrame.elementDepthCount--}();const a=ni();return a.firstCreatePass&&(Zi(a,t),Hs(t)&&a.queries.elementEnd(t)),null!=o.classesWithoutHost&&function oe(t){return 0!=(8&t.flags)}(o)&&yh(a,o,Bn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function de(t){return 0!=(16&t.flags)}(o)&&yh(a,o,Bn(),o.stylesWithoutHost,!1),da}function Fu(t,o,a,d){return ua(t,o,a,d),da(),Fu}let Cf=(t,o,a,d,m,b)=>(Ur(!0),Nh(d,m,function Wr(){return ei.lFrame.currentNamespace}()));function Ey(t,o,a){const d=Bn(),m=ni(),b=t+Qn,I=m.firstCreatePass?function Zb(t,o,a,d,m){const b=o.consts,I=_s(b,d),k=ld(o,t,8,"ng-container",I);return null!==I&&hh(k,I,!0),lh(o,a,k,_s(b,m)),null!==o.queries&&o.queries.elementStart(o,k),k}(b,m,d,o,a):m.data[b];na(I,!0);const k=Ov(m,d,I,t);return d[b]=k,Zr()&&Od(m,d,k,I),ma(k,d),us(I)&&(ud(m,d,I),Pu(m,I,d)),null!=a&&Lp(d,I),Ey}function Dy(){let t=ds();const o=ni();return Yl()?Ac():(t=t.parent,na(t,!1)),o.firstCreatePass&&(Zi(o,t),Hs(t)&&o.queries.elementEnd(t)),Dy}function Cy(t,o,a){return Ey(t,o,a),Dy(),Cy}let Ov=(t,o,a,d)=>(Ur(!0),Xf(o[Mr],""));function kv(){return Bn()}function Ty(t){return!!t&&"function"==typeof t.then}function Lv(t){return!!t&&"function"==typeof t.subscribe}function Sy(t,o,a,d){const m=Bn(),b=ni(),I=ds();return function Bv(t,o,a,d,m,b,I){const k=us(d),ie=t.firstCreatePass&&jp(t),xe=o[Qi],Je=uh(o);let Rt=!0;if(3&d.type||I){const Kn=Br(d,o),br=I?I(Kn):Kn,Kr=Je.length,jn=I?Ni=>I(Er(Ni[d.index])):d.index;let _i=null;if(!I&&k&&(_i=function Kb(t,o,a,d){const m=t.cleanup;if(null!=m)for(let b=0;b<m.length-1;b+=2){const I=m[b];if(I===a&&m[b+1]===d){const k=o[Ms],U=m[b+2];return k.length>U?k[U]:null}"string"==typeof I&&(b+=2)}return null}(t,o,m,d.index)),null!==_i)(_i.__ngLastListenerFn__||_i).__ngNextListenerFn__=b,_i.__ngLastListenerFn__=b,Rt=!1;else{b=zv(d,o,xe,b,!1);const Ni=a.listen(br,m,b);Je.push(b,Ni),ie&&ie.push(m,jn,Kr,Kr+1)}}else b=zv(d,o,xe,b,!1);const Gt=d.outputs;let Mn;if(Rt&&null!==Gt&&(Mn=Gt[m])){const Kn=Mn.length;if(Kn)for(let br=0;br<Kn;br+=2){const Zo=o[Mn[br]][Mn[br+1]].subscribe(b),vl=Je.length;Je.push(b,Zo),ie&&ie.push(m,d.index,vl,-(vl+1))}}}(b,m,m[Mr],I,t,o,d),Sy}function Nv(t,o,a,d){try{return vt(6,o,a),!1!==a(d)}catch(m){return Gp(t,m),!1}finally{vt(7,o,a)}}function zv(t,o,a,d,m){return function b(I){if(I===Function)return d;Su(t.componentOffset>-1?ko(t.index,o):o);let U=Nv(o,a,d,I),ie=b.__ngNextListenerFn__;for(;ie;)U=Nv(o,a,ie,I)&&U,ie=ie.__ngNextListenerFn__;return m&&!1===U&&I.preventDefault(),U}}function $v(t=1){return function $(t){return(ei.lFrame.contextLView=function te(t,o){for(;t>0;)o=o[go],t--;return o}(t,ei.lFrame.contextLView))[Qi]}(t)}function Jb(t,o){let a=null;const d=function we(t){const o=t.attrs;if(null!=o){const a=o.indexOf(5);if(!(1&a))return o[a+1]}return null}(t);for(let m=0;m<o.length;m++){const b=o[m];if("*"!==b){if(null===d?$e(t,b,!0):kt(d,b))return m}else a=m}return a}function Vv(t){const o=Bn()[$i][Si];if(!o.projection){const d=o.projection=Fc(t?t.length:1,null),m=d.slice();let b=o.child;for(;null!==b;){const I=t?Jb(b,t):0;null!==I&&(m[I]?m[I].projectionNext=b:d[I]=b,m[I]=b),b=b.next}}}function Uv(t,o=0,a){const d=Bn(),m=ni(),b=ld(m,Qn+t,16,null,a||null);null===b.projection&&(b.projection=o),Ac(),(!d[cs]||Da())&&32!=(32&b.flags)&&function Pm(t,o,a){Wc(o[Mr],0,o,a,zh(t,a,o),ic(a.parent||o[Si],a,o))}(m,d,b)}function r_(t,o){return t<<17|o<<2}function fd(t){return t>>17&32767}function My(t){return 2|t}function vh(t){return(131068&t)>>2}function Ay(t,o){return-131069&t|o<<2}function Py(t){return 1|t}function Jv(t,o,a,d,m){const b=t[a+1],I=null===o;let k=d?fd(b):vh(b),U=!1;for(;0!==k&&(!1===U||I);){const xe=t[k+1];i1(t[k],o)&&(U=!0,t[k+1]=d?Py(xe):My(xe)),k=d?fd(xe):vh(xe)}U&&(t[a+1]=d?My(b):Py(b))}function i1(t,o){return null===t||null==o||(Array.isArray(t)?t[1]:t)===o||!(!Array.isArray(t)||"string"!=typeof o)&&Ql(t,o)>=0}const ha={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Qv(t){return t.substring(ha.key,ha.keyEnd)}function e0(t,o){const a=ha.textEnd;return a===o?-1:(o=ha.keyEnd=function l1(t,o,a){for(;o<a&&t.charCodeAt(o)>32;)o++;return o}(t,ha.key=o,a),Tf(t,o,a))}function Tf(t,o,a){for(;o<a&&t.charCodeAt(o)<=32;)o++;return o}function Ry(t,o){return function Tc(t,o,a,d){const m=Bn(),b=ni(),I=ca(2);b.firstUpdatePass&&l0(b,t,I,d),o!==pi&&le(m,I,o)&&u0(b,b.data[ve()],m,m[Mr],t,m[I+1]=function x1(t,o){return null==t||""===t||("string"==typeof o?t+=o:"object"==typeof t&&(t=Ze(vc(t)))),t}(o,a),d,I)}(t,o,null,!0),Ry}function ou(t,o){for(let a=function s1(t){return function n0(t){ha.key=0,ha.keyEnd=0,ha.value=0,ha.valueEnd=0,ha.textEnd=t.length}(t),e0(t,Tf(t,0,ha.textEnd))}(o);a>=0;a=e0(o,a))Ja(t,Qv(o),!0)}function a0(t,o){return o>=t.expandoStartIndex}function l0(t,o,a,d){const m=t.data;if(null===m[a+1]){const b=m[ve()],I=a0(t,a);h0(b,d)&&null===o&&!I&&(o=!1),o=function f1(t,o,a,d){const m=function gc(t){const o=ei.lFrame.currentDirectiveIndex;return-1===o?null:t[o]}(t);let b=d?o.residualClasses:o.residualStyles;if(null===m)0===(d?o.classBindings:o.styleBindings)&&(a=em(a=Oy(null,t,o,a,d),o.attrs,d),b=null);else{const I=o.directiveStylingLast;if(-1===I||t[I]!==m)if(a=Oy(m,t,o,a,d),null===b){let U=function p1(t,o,a){const d=a?o.classBindings:o.styleBindings;if(0!==vh(d))return t[fd(d)]}(t,o,d);void 0!==U&&Array.isArray(U)&&(U=Oy(null,t,o,U[1],d),U=em(U,o.attrs,d),function m1(t,o,a,d){t[fd(a?o.classBindings:o.styleBindings)]=d}(t,o,d,U))}else b=function g1(t,o,a){let d;const m=o.directiveEnd;for(let b=1+o.directiveStylingLast;b<m;b++)d=em(d,t[b].hostAttrs,a);return em(d,o.attrs,a)}(t,o,d)}return void 0!==b&&(d?o.residualClasses=b:o.residualStyles=b),a}(m,b,o,d),function n1(t,o,a,d,m,b){let I=b?o.classBindings:o.styleBindings,k=fd(I),U=vh(I);t[d]=a;let xe,ie=!1;if(Array.isArray(a)?(xe=a[1],(null===xe||Ql(a,xe)>0)&&(ie=!0)):xe=a,m)if(0!==U){const Rt=fd(t[k+1]);t[d+1]=r_(Rt,k),0!==Rt&&(t[Rt+1]=Ay(t[Rt+1],d)),t[k+1]=function e1(t,o){return 131071&t|o<<17}(t[k+1],d)}else t[d+1]=r_(k,0),0!==k&&(t[k+1]=Ay(t[k+1],d)),k=d;else t[d+1]=r_(U,0),0===k?k=d:t[U+1]=Ay(t[U+1],d),U=d;ie&&(t[d+1]=My(t[d+1])),Jv(t,xe,d,!0),Jv(t,xe,d,!1),function r1(t,o,a,d,m){const b=m?t.residualClasses:t.residualStyles;null!=b&&"string"==typeof o&&Ql(b,o)>=0&&(a[d+1]=Py(a[d+1]))}(o,xe,t,d,b),I=r_(k,U),b?o.classBindings=I:o.styleBindings=I}(m,b,o,a,I,d)}}function Oy(t,o,a,d,m){let b=null;const I=a.directiveEnd;let k=a.directiveStylingLast;for(-1===k?k=a.directiveStart:k++;k<I&&(b=o[k],d=em(d,b.hostAttrs,m),b!==t);)k++;return null!==t&&(a.directiveStylingLast=k),d}function em(t,o,a){const d=a?1:2;let m=-1;if(null!==o)for(let b=0;b<o.length;b++){const I=o[b];"number"==typeof I?m=I:m===d&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Ja(t,I,!!a||o[++b]))}return void 0===t?null:t}function u0(t,o,a,d,m,b,I,k){if(!(3&o.type))return;const U=t.data,ie=U[k+1],xe=function t1(t){return 1==(1&t)}(ie)?d0(U,o,a,m,vh(ie),I):void 0;i_(xe)||(i_(b)||function Qb(t){return 2==(2&t)}(ie)&&(b=d0(U,null,a,m,k,I)),function P_(t,o,a,d,m){if(o)m?t.addClass(a,d):t.removeClass(a,d);else{let b=-1===d.indexOf("-")?void 0:kh.DashCase;null==m?t.removeStyle(a,d,b):("string"==typeof m&&m.endsWith("!important")&&(m=m.slice(0,-10),b|=kh.Important),t.setStyle(a,d,m,b))}}(d,I,xi(ve(),a),m,b))}function d0(t,o,a,d,m,b){const I=null===o;let k;for(;m>0;){const U=t[m],ie=Array.isArray(U),xe=ie?U[1]:U,Je=null===xe;let Rt=a[m+1];Rt===pi&&(Rt=Je?qn:void 0);let Gt=Je?vd(Rt,d):xe===d?Rt:void 0;if(ie&&!i_(Gt)&&(Gt=vd(U,d)),i_(Gt)&&(k=Gt,I))return k;const Mn=t[m+1];m=I?fd(Mn):vh(Mn)}if(null!==o){let U=b?o.residualClasses:o.residualStyles;null!=U&&(k=vd(U,d))}return k}function i_(t){return void 0!==t}function h0(t,o){return 0!=(t.flags&(o?8:16))}function f0(t,o=""){const a=Bn(),d=ni(),m=t+Qn,b=d.firstCreatePass?ld(d,m,1,o,null):d.data[m],I=p0(d,a,b,o,t);a[m]=I,Zr()&&Od(d,a,I,b),na(b,!1)}let p0=(t,o,a,d,m)=>(Ur(!0),function Gu(t,o){return t.createText(o)}(o[Mr],d));function ky(t){return o_("",t,""),ky}function o_(t,o,a){const d=Bn(),m=ft(d,t,o,a);return m!==pi&&function Dc(t,o,a){const d=xi(o,t);!function Yf(t,o,a){t.setValue(o,a)}(t[Mr],d,a)}(d,ve(),m),o_}function E0(t,o,a){!function Sc(t,o,a,d){const m=ni(),b=ca(2);m.firstUpdatePass&&l0(m,null,b,d);const I=Bn();if(a!==pi&&le(I,b,a)){const k=m.data[ve()];if(h0(k,d)&&!a0(m,b)){let U=d?k.classesWithoutHost:k.stylesWithoutHost;null!==U&&(a=Qe(U,a||"")),yh(m,k,I,a,d)}else!function v1(t,o,a,d,m,b,I,k){m===pi&&(m=qn);let U=0,ie=0,xe=0<m.length?m[0]:null,Je=0<b.length?b[0]:null;for(;null!==xe||null!==Je;){const Rt=U<m.length?m[U+1]:void 0,Gt=ie<b.length?b[ie+1]:void 0;let Kn,Mn=null;xe===Je?(U+=2,ie+=2,Rt!==Gt&&(Mn=Je,Kn=Gt)):null===Je||null!==xe&&xe<Je?(U+=2,Mn=xe):(ie+=2,Mn=Je,Kn=Gt),null!==Mn&&u0(t,o,a,d,Mn,Kn,I,k),xe=U<m.length?m[U]:null,Je=ie<b.length?b[ie]:null}}(m,k,I,I[Mr],I[b+1],I[b+1]=function _1(t,o,a){if(null==a||""===a)return qn;const d=[],m=vc(a);if(Array.isArray(m))for(let b=0;b<m.length;b++)t(d,m[b],!0);else if("object"==typeof m)for(const b in m)m.hasOwnProperty(b)&&t(d,b,m[b]);else"string"==typeof m&&o(d,m);return d}(t,o,a),d,b)}}(Ja,ou,ft(Bn(),t,o,a),!0)}function Ly(t,o,a){const d=Bn();return le(d,Xa(),o)&&_a(ni(),st(),d,t,o,d[Mr],a,!0),Ly}const xh=void 0;var V1=["en",[["a","p"],["AM","PM"],xh],[["AM","PM"],xh,xh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],xh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],xh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",xh,"{1} 'at' {0}",xh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $1(t){const a=Math.floor(Math.abs(t)),d=t.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===d?1:5}];let Sf={};function Fy(t){const o=function U1(t){return t.toLowerCase().replace(/_/g,"-")}(t);let a=L0(o);if(a)return a;const d=o.split("-")[0];if(a=L0(d),a)return a;if("en"===d)return V1;throw new Ce(701,!1)}function k0(t){return Fy(t)[If.PluralCase]}function L0(t){return t in Sf||(Sf[t]=Tr.ng&&Tr.ng.common&&Tr.ng.common.locales&&Tr.ng.common.locales[t]),Sf[t]}var If=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(If||{});const Mf="en-US";let F0=Mf;function zy(t,o,a,d,m){if(t=xt(t),Array.isArray(t))for(let b=0;b<t.length;b++)zy(t[b],o,a,d,m);else{const b=ni(),I=Bn(),k=ds();let U=Yc(t)?t:xt(t.provide);const ie=Eu(t),xe=1048575&k.providerIndexes,Je=k.directiveStart,Rt=k.providerIndexes>>20;if(Yc(t)||!t.multi){const Gt=new A(ie,m,Mu),Mn=Vy(U,o,m?xe:xe+Rt,Je);-1===Mn?(Ln(Rn(k,I),b,U),$y(b,t,o.length),o.push(U),k.directiveStart++,k.directiveEnd++,m&&(k.providerIndexes+=1048576),a.push(Gt),I.push(Gt)):(a[Mn]=Gt,I[Mn]=Gt)}else{const Gt=Vy(U,o,xe+Rt,Je),Mn=Vy(U,o,xe,xe+Rt),br=Mn>=0&&a[Mn];if(m&&!br||!m&&!(Gt>=0&&a[Gt])){Ln(Rn(k,I),b,U);const Kr=function $w(t,o,a,d,m){const b=new A(t,a,Mu);return b.multi=[],b.index=o,b.componentProviders=0,ax(b,m,d&&!a),b}(m?zw:Nw,a.length,m,d,ie);!m&&br&&(a[Mn].providerFactory=Kr),$y(b,t,o.length,0),o.push(U),k.directiveStart++,k.directiveEnd++,m&&(k.providerIndexes+=1048576),a.push(Kr),I.push(Kr)}else $y(b,t,Gt>-1?Gt:Mn,ax(a[m?Mn:Gt],ie,!m&&d));!m&&d&&br&&a[Mn].componentProviders++}}}function $y(t,o,a,d){const m=Yc(o),b=function Km(t){return!!t.useClass}(o);if(m||b){const U=(b?xt(o.useClass):o).prototype.ngOnDestroy;if(U){const ie=t.destroyHooks||(t.destroyHooks=[]);if(!m&&o.multi){const xe=ie.indexOf(a);-1===xe?ie.push(a,[d,U]):ie[xe+1].push(d,U)}else ie.push(a,U)}}}function ax(t,o,a){return a&&t.componentProviders++,t.multi.push(o)-1}function Vy(t,o,a,d){for(let m=a;m<d;m++)if(o[m]===t)return m;return-1}function Nw(t,o,a,d){return Uy(this.multi,[])}function zw(t,o,a,d){const m=this.multi;let b;if(this.providerFactory){const I=this.providerFactory.componentProviders,k=ur(a,a[rr],this.providerFactory.index,d);b=k.slice(0,I),Uy(m,b);for(let U=I;U<k.length;U++)b.push(k[U])}else b=[],Uy(m,b);return b}function Uy(t,o){for(let a=0;a<t.length;a++)o.push((0,t[a])());return o}function lx(t,o=[]){return a=>{a.providersResolver=(d,m)=>function Bw(t,o,a){const d=ni();if(d.firstCreatePass){const m=Xo(t);zy(a,d.data,d.blueprint,m,!0),zy(o,d.data,d.blueprint,m,!1)}}(d,m?m(t):t,o)}}class bh{}class cx{}function Vw(t,o){return new jy(t,o??null,[])}class jy extends bh{constructor(o,a,d){super(),this._parent=a,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new gl(this);const m=Ai(o);this._bootstrapComponents=ac(m.bootstrap),this._r3Injector=_g(o,a,[{provide:bh,useValue:this},{provide:Kc,useValue:this.componentFactoryResolver},...d],Ze(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Hy extends cx{constructor(o){super(),this.moduleType=o}create(o){return new jy(this.moduleType,o,[])}}class ux extends bh{constructor(o){super(),this.componentFactoryResolver=new gl(this),this.instance=null;const a=new wu([...o.providers,{provide:bh,useValue:this},{provide:Kc,useValue:this.componentFactoryResolver}],o.parent||Kh(),o.debugName,new Set(["environment"]));this.injector=a,o.runEnvironmentInitializers&&a.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function dx(t,o,a=null){return new ux({providers:t,parent:o,debugName:a,runEnvironmentInitializers:!0}).injector}let jw=(()=>{var t;class o{constructor(d){this._injector=d,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(d){if(!d.standalone)return null;if(!this.cachedInjectors.has(d)){const m=Zm(0,d.type),b=m.length>0?dx([m],this._injector,`Standalone[${d.type.name}]`):null;this.cachedInjectors.set(d,b)}return this.cachedInjectors.get(d)}ngOnDestroy(){try{for(const d of this.cachedInjectors.values())null!==d&&d.destroy()}finally{this.cachedInjectors.clear()}}}return(t=o).\u0275prov=en({token:t,providedIn:"environment",factory:()=>new t(mn(kl))}),o})();function hx(t){t.getStandaloneInjector=o=>o.get(jw).getOrCreateStandaloneInjector(t)}function vx(t,o,a){const d=function Ts(){const t=ei.lFrame;let o=t.bindingRootIndex;return-1===o&&(o=t.bindingRootIndex=t.tView.bindingStartIndex),o}()+t,m=Bn();return m[d]===pi?function q(t,o,a){return t[o]=a}(m,d,a?o.call(a):o()):function J(t,o){return t[o]}(m,d)}function Wy(t){return o=>{setTimeout(t,void 0,o)}}const su=class pE extends M.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,a,d){let m=o,b=a||(()=>null),I=d;if(o&&"object"==typeof o){const U=o;m=U.next?.bind(U),b=U.error?.bind(U),I=U.complete?.bind(U)}this.__isAsync&&(b=Wy(b),m&&(m=Wy(m)),I&&(I=Wy(I)));const k=super.subscribe({next:m,error:b,complete:I});return o instanceof w.w0&&o.add(k),k}};function mE(){return this._results[Symbol.iterator]()}class u_{get changes(){return this._changes||(this._changes=new su)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=u_.prototype;a[Symbol.iterator]||(a[Symbol.iterator]=mE)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,a){return this._results.reduce(o,a)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,a){const d=this;d.dirty=!1;const m=function Ka(t){return t.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Eh(t,o,a){if(t.length!==o.length)return!1;for(let d=0;d<t.length;d++){let m=t[d],b=o[d];if(a&&(m=a(m),b=a(b)),b!==m)return!1}return!0}(d._results,m,a))&&(d._results=m,d.length=m.length,d.last=m[this.length-1],d.first=m[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function _E(t,o,a,d=!0){const m=o[rr];if(function Kf(t,o,a,d){const m=oo+d,b=a.length;d>0&&(a[m-1][Io]=o),d<b-oo?(o[Io]=a[m],yd(a,oo+d,o)):(a.push(o),o[Io]=null),o[Ti]=a;const I=o[es];null!==I&&a!==I&&function rc(t,o){const a=t[co];o[$i]!==o[Ti][Ti][$i]&&(t[va]=!0),null===a?t[co]=[o]:a.push(o)}(I,o);const k=o[Uo];null!==k&&k.insertView(t),o[vr]|=128}(m,o,t,a),d){const b=ep(a,t),I=o[Mr],k=Pd(I,t[Ho]);null!==k&&function Sm(t,o,a,d,m,b){d[Ri]=m,d[Si]=o,Zu(t,d,a,1,m,b)}(m,t[Si],I,o,k,b)}}let lm=(()=>{class o{}return o.__NG_ELEMENT_ID__=xE,o})();const yE=lm,vE=class extends yE{constructor(o,a,d){super(),this._declarationLView=o,this._declarationTContainer=a,this.elementRef=d}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(o,a){return this.createEmbeddedViewImpl(o,a)}createEmbeddedViewImpl(o,a,d){const m=function gE(t,o,a,d){const m=o.tView,k=Fl(t,m,a,4096&t[vr]?4096:16,null,o,null,null,null,d?.injector??null,d?.hydrationInfo??null);k[es]=t[o.index];const ie=t[Uo];return null!==ie&&(k[Uo]=ie.createEmbeddedView(m)),_f(m,k,a),k}(this._declarationLView,this._declarationTContainer,o,{injector:a,hydrationInfo:d});return new Ou(m)}};function xE(){return d_(ds(),Bn())}function d_(t,o){return 4&t.type?new vE(o,t,od(t,o)):null}let f_=(()=>{class o{}return o.__NG_ELEMENT_ID__=TE,o})();function TE(){return Px(ds(),Bn())}const SE=f_,Mx=class extends SE{constructor(o,a,d){super(),this._lContainer=o,this._hostTNode=a,this._hostLView=d}get element(){return od(this._hostTNode,this._hostLView)}get injector(){return new gi(this._hostTNode,this._hostLView)}get parentInjector(){const o=sn(this._hostTNode,this._hostLView);if(De(o)){const a=Te(o,this._hostLView),d=Oe(o);return new gi(a[rr].data[d+8],a)}return new gi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const a=Ax(this._lContainer);return null!==a&&a[o]||null}get length(){return this._lContainer.length-oo}createEmbeddedView(o,a,d){let m,b;"number"==typeof d?m=d:null!=d&&(m=d.index,b=d.injector);const k=o.createEmbeddedViewImpl(a||{},b,null);return this.insertImpl(k,m,false),k}createComponent(o,a,d,m,b){const I=o&&!function cu(t){return"function"==typeof t}(o);let k;if(I)k=a;else{const Kn=a||{};k=Kn.index,d=Kn.injector,m=Kn.projectableNodes,b=Kn.environmentInjector||Kn.ngModuleRef}const U=I?o:new Cc(Vr(o)),ie=d||this.parentInjector;if(!b&&null==U.ngModule){const br=(I?ie:this.parentInjector).get(kl,null);br&&(b=br)}Vr(U.componentType??{});const Gt=U.create(ie,m,null,b);return this.insertImpl(Gt.hostView,k,false),Gt}insert(o,a){return this.insertImpl(o,a,!1)}insertImpl(o,a,d){const m=o._lView;if(function qi(t){return Wi(t[Ti])}(m)){const U=this.indexOf(o);if(-1!==U)this.detach(U);else{const ie=m[Ti],xe=new Mx(ie,ie[Si],ie[Ti]);xe.detach(xe.indexOf(o))}}const I=this._adjustIndex(a),k=this._lContainer;return _E(k,m,I,!d),o.attachToViewContainerRef(),yd(qy(k),I,o),o}move(o,a){return this.insert(o,a)}indexOf(o){const a=Ax(this._lContainer);return null!==a?a.indexOf(o):-1}remove(o){const a=this._adjustIndex(o,-1),d=Ga(this._lContainer,a);d&&(dl(qy(this._lContainer),a),Aa(d[rr],d))}detach(o){const a=this._adjustIndex(o,-1),d=Ga(this._lContainer,a);return d&&null!=dl(qy(this._lContainer),a)?new Ou(d):null}_adjustIndex(o,a=0){return o??this.length+a}};function Ax(t){return t[8]}function qy(t){return t[8]||(t[8]=[])}function Px(t,o){let a;const d=o[t.index];return Wi(d)?a=d:(a=tl(d,o,null,t),o[t.index]=a,Nl(o,a)),Rx(a,o,t,d),new Mx(a,t,o)}let Rx=function Ox(t,o,a,d){if(t[Ho])return;let m;m=8&a.type?Er(d):function IE(t,o){const a=t[Mr],d=a.createComment(""),m=Br(o,t);return yc(a,Pd(a,m),d,function A_(t,o){return t.nextSibling(o)}(a,m),!1),d}(o,a),t[Ho]=m};class Zy{constructor(o){this.queryList=o,this.matches=null}clone(){return new Zy(this.queryList)}setDirty(){this.queryList.setDirty()}}class Yy{constructor(o=[]){this.queries=o}createEmbeddedView(o){const a=o.queries;if(null!==a){const d=null!==o.contentQueries?o.contentQueries[0]:a.length,m=[];for(let b=0;b<d;b++){const I=a.getByIndex(b);m.push(this.queries[I.indexInDeclarationView].clone())}return new Yy(m)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let a=0;a<this.queries.length;a++)null!==Ux(o,a).matches&&this.queries[a].setDirty()}}class kx{constructor(o,a,d=null){this.predicate=o,this.flags=a,this.read=d}}class Xy{constructor(o=[]){this.queries=o}elementStart(o,a){for(let d=0;d<this.queries.length;d++)this.queries[d].elementStart(o,a)}elementEnd(o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(o)}embeddedTView(o){let a=null;for(let d=0;d<this.length;d++){const m=null!==a?a.length:0,b=this.getByIndex(d).embeddedTView(o,m);b&&(b.indexInDeclarationView=d,null!==a?a.push(b):a=[b])}return null!==a?new Xy(a):null}template(o,a){for(let d=0;d<this.queries.length;d++)this.queries[d].template(o,a)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Ky{constructor(o,a=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(o,a){this.isApplyingToNode(a)&&this.matchTNode(o,a)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,a){this.elementStart(o,a)}embeddedTView(o,a){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,a),new Ky(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let d=o.parent;for(;null!==d&&8&d.type&&d.index!==a;)d=d.parent;return a===(null!==d?d.index:-1)}return this._appliesToNextNode}matchTNode(o,a){const d=this.metadata.predicate;if(Array.isArray(d))for(let m=0;m<d.length;m++){const b=d[m];this.matchTNodeWithReadOption(o,a,PE(a,b)),this.matchTNodeWithReadOption(o,a,Xr(a,o,b,!1,!1))}else d===lm?4&a.type&&this.matchTNodeWithReadOption(o,a,-1):this.matchTNodeWithReadOption(o,a,Xr(a,o,d,!1,!1))}matchTNodeWithReadOption(o,a,d){if(null!==d){const m=this.metadata.read;if(null!==m)if(m===th||m===f_||m===lm&&4&a.type)this.addMatch(a.index,-2);else{const b=Xr(a,o,m,!1,!1);null!==b&&this.addMatch(a.index,b)}else this.addMatch(a.index,d)}}addMatch(o,a){null===this.matches?this.matches=[o,a]:this.matches.push(o,a)}}function PE(t,o){const a=t.localNames;if(null!==a)for(let d=0;d<a.length;d+=2)if(a[d]===o)return a[d+1];return null}function OE(t,o,a,d){return-1===a?function RE(t,o){return 11&t.type?od(t,o):4&t.type?d_(t,o):null}(o,t):-2===a?function kE(t,o,a){return a===th?od(o,t):a===lm?d_(o,t):a===f_?Px(o,t):void 0}(t,o,d):ur(t,t[rr],a,o)}function Lx(t,o,a,d){const m=o[Uo].queries[d];if(null===m.matches){const b=t.data,I=a.matches,k=[];for(let U=0;U<I.length;U+=2){const ie=I[U];k.push(ie<0?null:OE(o,b[ie],I[U+1],a.metadata.read))}m.matches=k}return m.matches}function Jy(t,o,a,d){const m=t.queries.getByIndex(a),b=m.matches;if(null!==b){const I=Lx(t,o,m,a);for(let k=0;k<b.length;k+=2){const U=b[k];if(U>0)d.push(I[k/2]);else{const ie=b[k+1],xe=o[-U];for(let Je=oo;Je<xe.length;Je++){const Rt=xe[Je];Rt[es]===Rt[Ti]&&Jy(Rt[rr],Rt,ie,d)}if(null!==xe[co]){const Je=xe[co];for(let Rt=0;Rt<Je.length;Rt++){const Gt=Je[Rt];Jy(Gt[rr],Gt,ie,d)}}}}}return d}function Fx(t){const o=Bn(),a=ni(),d=lu();qs(d+1);const m=Ux(a,d);if(t.dirty&&function Ps(t){return 4==(4&t[vr])}(o)===(2==(2&m.metadata.flags))){if(null===m.matches)t.reset([]);else{const b=m.crossesNgTemplate?Jy(a,o,d,[]):Lx(a,o,m,d);t.reset(b,ty),t.notifyOnChanges()}return!0}return!1}function Bx(t,o,a){const d=ni();d.firstCreatePass&&(Vx(d,new kx(t,o,a),-1),2==(2&o)&&(d.staticViewQueries=!0)),$x(d,Bn(),o)}function Nx(t,o,a,d){const m=ni();if(m.firstCreatePass){const b=ds();Vx(m,new kx(o,a,d),b.index),function FE(t,o){const a=t.contentQueries||(t.contentQueries=[]);o!==(a.length?a[a.length-1]:-1)&&a.push(t.queries.length-1,o)}(m,t),2==(2&a)&&(m.staticContentQueries=!0)}$x(m,Bn(),a)}function zx(){return function LE(t,o){return t[Uo].queries[o].queryList}(Bn(),lu())}function $x(t,o,a){const d=new u_(4==(4&a));(function dy(t,o,a,d){const m=uh(o);m.push(a),t.firstCreatePass&&jp(t).push(d,m.length-1)})(t,o,d,d.destroy),null===o[Uo]&&(o[Uo]=new Yy),o[Uo].queries.push(new Zy(d))}function Vx(t,o,a){null===t.queries&&(t.queries=new Xy),t.queries.track(new Ky(o,a))}function Ux(t,o){return t.queries.getByIndex(o)}function Qy(t){return!!Ai(t)}const ob=new po("Application Initializer");let iv=(()=>{var t;class o{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((d,m)=>{this.resolve=d,this.reject=m}),this.appInits=Gn(ob,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const d=[];for(const b of this.appInits){const I=b();if(Ty(I))d.push(I);else if(Lv(I)){const k=new Promise((U,ie)=>{I.subscribe({complete:U,error:ie})});d.push(k)}}const m=()=>{this.done=!0,this.resolve()};Promise.all(d).then(()=>{m()}).catch(b=>{this.reject(b)}),0===d.length&&m(),this.initialized=!0}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"root"}),o})(),sb=(()=>{var t;class o{log(d){console.log(d)}warn(d){console.warn(d)}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})();const m_=new po("LocaleId",{providedIn:"root",factory:()=>Gn(m_,hr.Optional|hr.SkipSelf)||function iD(){return typeof $localize<"u"&&$localize.locale||Mf}()}),oD=new po("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let ab=(()=>{var t;class o{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new lt.X(!1)}add(){this.hasPendingTasks.next(!0);const d=this.taskId++;return this.pendingTasks.add(d),d}remove(d){this.pendingTasks.delete(d),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();class aD{constructor(o,a){this.ngModuleFactory=o,this.componentFactories=a}}let lD=(()=>{var t;class o{compileModuleSync(d){return new Hy(d)}compileModuleAsync(d){return Promise.resolve(this.compileModuleSync(d))}compileModuleAndAllComponentsSync(d){const m=this.compileModuleSync(d),I=ac(Ai(d).declarations).reduce((k,U)=>{const ie=Vr(U);return ie&&k.push(new Cc(ie)),k},[]);return new aD(m,I)}compileModuleAndAllComponentsAsync(d){return Promise.resolve(this.compileModuleAndAllComponentsSync(d))}clearCache(){}clearCacheFor(d){}getModuleId(d){}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function db(...t){}class rl{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:d=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new su(!1),this.onMicrotaskEmpty=new su(!1),this.onStable=new su(!1),this.onError=new su(!1),typeof Zone>"u")throw new Ce(908,!1);Zone.assertZonePatched();const m=this;m._nesting=0,m._outer=m._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(m._inner=m._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(m._inner=m._inner.fork(Zone.longStackTraceZoneSpec)),m.shouldCoalesceEventChangeDetection=!d&&a,m.shouldCoalesceRunChangeDetection=d,m.lastRequestAnimationFrameId=-1,m.nativeRequestAnimationFrame=function ID(){const t="function"==typeof Tr.requestAnimationFrame;let o=Tr[t?"requestAnimationFrame":"setTimeout"],a=Tr[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&o&&a){const d=o[Zone.__symbol__("OriginalDelegate")];d&&(o=d);const m=a[Zone.__symbol__("OriginalDelegate")];m&&(a=m)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:a}}().nativeRequestAnimationFrame,function PD(t){const o=()=>{!function AD(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Tr,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,lv(t),t.isCheckStableRunning=!0,av(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),lv(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,d,m,b,I,k)=>{try{return hb(t),a.invokeTask(m,b,I,k)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===b.type||t.shouldCoalesceRunChangeDetection)&&o(),fb(t)}},onInvoke:(a,d,m,b,I,k,U)=>{try{return hb(t),a.invoke(m,b,I,k,U)}finally{t.shouldCoalesceRunChangeDetection&&o(),fb(t)}},onHasTask:(a,d,m,b)=>{a.hasTask(m,b),d===m&&("microTask"==b.change?(t._hasPendingMicrotasks=b.microTask,lv(t),av(t)):"macroTask"==b.change&&(t.hasPendingMacrotasks=b.macroTask))},onHandleError:(a,d,m,b)=>(a.handleError(m,b),t.runOutsideAngular(()=>t.onError.emit(b)),!1)})}(m)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!rl.isInAngularZone())throw new Ce(909,!1)}static assertNotInAngularZone(){if(rl.isInAngularZone())throw new Ce(909,!1)}run(o,a,d){return this._inner.run(o,a,d)}runTask(o,a,d,m){const b=this._inner,I=b.scheduleEventTask("NgZoneEvent: "+m,o,MD,db,db);try{return b.runTask(I,a,d)}finally{b.cancelTask(I)}}runGuarded(o,a,d){return this._inner.runGuarded(o,a,d)}runOutsideAngular(o){return this._outer.run(o)}}const MD={};function av(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function lv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function hb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function fb(t){t._nesting--,av(t)}class RD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new su,this.onMicrotaskEmpty=new su,this.onStable=new su,this.onError=new su}run(o,a,d){return o.apply(a,d)}runGuarded(o,a,d){return o.apply(a,d)}runOutsideAngular(o){return o()}runTask(o,a,d,m){return o.apply(a,d)}}const pb=new po("",{providedIn:"root",factory:mb});function mb(){const t=Gn(rl);let o=!0;const a=new l.y(m=>{o=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{m.next(o),m.complete()})}),d=new l.y(m=>{let b;t.runOutsideAngular(()=>{b=t.onStable.subscribe(()=>{rl.assertNotInAngularZone(),queueMicrotask(()=>{!o&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(o=!0,m.next(!0))})})});const I=t.onUnstable.subscribe(()=>{rl.assertInAngularZone(),o&&(o=!1,t.runOutsideAngular(()=>{m.next(!1)}))});return()=>{b.unsubscribe(),I.unsubscribe()}});return(0,_e.T)(a,d.pipe((0,Le.B)()))}const gb=new po(""),_b=new po("");let cv,OD=(()=>{var t;class o{constructor(d,m,b){this._ngZone=d,this.registry=m,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,cv||(function kD(t){cv=t}(b),b.addToWindow(m)),this._watchAngularEvents(),d.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{rl.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let d=this._callbacks.pop();clearTimeout(d.timeoutId),d.doneCb(this._didWork)}this._didWork=!1});else{let d=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(d)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(d=>({source:d.source,creationLocation:d.creationLocation,data:d.data})):[]}addCallback(d,m,b){let I=-1;m&&m>0&&(I=setTimeout(()=>{this._callbacks=this._callbacks.filter(k=>k.timeoutId!==I),d(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:d,timeoutId:I,updateCb:b})}whenStable(d,m,b){if(b&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(d,m,b),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(d){this.registry.registerApplication(d,this)}unregisterApplication(d){this.registry.unregisterApplication(d)}findProviders(d,m,b){return[]}}return(t=o).\u0275fac=function(d){return new(d||t)(mn(rl),mn(yb),mn(_b))},t.\u0275prov=en({token:t,factory:t.\u0275fac}),o})(),yb=(()=>{var t;class o{constructor(){this._applications=new Map}registerApplication(d,m){this._applications.set(d,m)}unregisterApplication(d){this._applications.delete(d)}unregisterAllApplications(){this._applications.clear()}getTestability(d){return this._applications.get(d)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(d,m=!0){return cv?.findTestabilityInTree(this,d,m)??null}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})(),pd=null;const vb=new po("AllowMultipleToken"),uv=new po("PlatformDestroyListeners"),dv=new po("appBootstrapListener");class BD{constructor(o,a){this.name=o,this.token=a}}function wb(t,o,a=[]){const d=`Platform: ${o}`,m=new po(d);return(b=[])=>{let I=hv();if(!I||I.injector.get(vb,!1)){const k=[...a,...b,{provide:m,useValue:!0}];t?t(k):function ND(t){if(pd&&!pd.get(vb,!1))throw new Ce(400,!1);(function xb(){!function ll(t){fa=t}(()=>{throw new Ce(600,!1)})})(),pd=t;const o=t.get(Db);(function bb(t){t.get(ng,null)?.forEach(a=>a())})(t)}(function Eb(t=[],o){return fl.create({name:o,providers:[{provide:Xh,useValue:"platform"},{provide:uv,useValue:new Set([()=>pd=null])},...t]})}(k,d))}return function $D(t){const o=hv();if(!o)throw new Ce(401,!1);return o}()}}function hv(){return pd?.get(Db)??null}let Db=(()=>{var t;class o{constructor(d){this._injector=d,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(d,m){const b=function VD(t="zone.js",o){return"noop"===t?new RD:"zone.js"===t?new rl(o):t}(m?.ngZone,function Cb(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:m?.ngZoneEventCoalescing,runCoalescing:m?.ngZoneRunCoalescing}));return b.run(()=>{const I=function Uw(t,o,a){return new jy(t,o,a)}(d.moduleType,this.injector,function Ab(t){return[{provide:rl,useFactory:t},{provide:Gd,multi:!0,useFactory:()=>{const o=Gn(jD,{optional:!0});return()=>o.initialize()}},{provide:Mb,useFactory:UD},{provide:pb,useFactory:mb}]}(()=>b)),k=I.injector.get(bc,null);return b.runOutsideAngular(()=>{const U=b.onError.subscribe({next:ie=>{k.handleError(ie)}});I.onDestroy(()=>{__(this._modules,I),U.unsubscribe()})}),function Tb(t,o,a){try{const d=a();return Ty(d)?d.catch(m=>{throw o.runOutsideAngular(()=>t.handleError(m)),m}):d}catch(d){throw o.runOutsideAngular(()=>t.handleError(d)),d}}(k,b,()=>{const U=I.injector.get(iv);return U.runInitializers(),U.donePromise.then(()=>(function B0(t){ln(t,"Expected localeId to be defined"),"string"==typeof t&&(F0=t.toLowerCase().replace(/_/g,"-"))}(I.injector.get(m_,Mf)||Mf),this._moduleDoBootstrap(I),I))})})}bootstrapModule(d,m=[]){const b=Sb({},m);return function LD(t,o,a){const d=new Hy(a);return Promise.resolve(d)}(0,0,d).then(I=>this.bootstrapModuleFactory(I,b))}_moduleDoBootstrap(d){const m=d.injector.get(Rf);if(d._bootstrapComponents.length>0)d._bootstrapComponents.forEach(b=>m.bootstrap(b));else{if(!d.instance.ngDoBootstrap)throw new Ce(-403,!1);d.instance.ngDoBootstrap(m)}this._modules.push(d)}onDestroy(d){this._destroyListeners.push(d)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ce(404,!1);this._modules.slice().forEach(m=>m.destroy()),this._destroyListeners.forEach(m=>m());const d=this._injector.get(uv,null);d&&(d.forEach(m=>m()),d.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(t=o).\u0275fac=function(d){return new(d||t)(mn(fl))},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"platform"}),o})();function Sb(t,o){return Array.isArray(o)?o.reduce(Sb,t):{...t,...o}}let Rf=(()=>{var t;class o{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Gn(Mb),this.zoneIsStable=Gn(pb),this.componentTypes=[],this.components=[],this.isStable=Gn(ab).hasPendingTasks.pipe((0,tt.w)(d=>d?(0,Ne.of)(!1):this.zoneIsStable),(0,Ke.x)(),(0,Le.B)()),this._injector=Gn(kl)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(d,m){const b=d instanceof ug;if(!this._injector.get(iv).done)throw!b&&ps(d),new Ce(405,!1);let k;k=b?d:this._injector.get(Kc).resolveComponentFactory(d),this.componentTypes.push(k.componentType);const U=function FD(t){return t.isBoundToModule}(k)?void 0:this._injector.get(bh),xe=k.create(fl.NULL,[],m||k.selector,U),Je=xe.location.nativeElement,Rt=xe.injector.get(gb,null);return Rt?.registerApplication(Je),xe.onDestroy(()=>{this.detachView(xe.hostView),__(this.components,xe),Rt?.unregisterApplication(Je)}),this._loadComponent(xe),xe}tick(){if(this._runningTick)throw new Ce(101,!1);try{this._runningTick=!0;for(let d of this._views)d.detectChanges()}catch(d){this.internalErrorHandler(d)}finally{this._runningTick=!1}}attachView(d){const m=d;this._views.push(m),m.attachToAppRef(this)}detachView(d){const m=d;__(this._views,m),m.detachFromAppRef()}_loadComponent(d){this.attachView(d.hostView),this.tick(),this.components.push(d);const m=this._injector.get(dv,[]);m.push(...this._bootstrapListeners),m.forEach(b=>b(d))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(d=>d()),this._views.slice().forEach(d=>d.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(d){return this._destroyListeners.push(d),()=>__(this._destroyListeners,d)}destroy(){if(this._destroyed)throw new Ce(406,!1);const d=this._injector;d.destroy&&!d.destroyed&&d.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function __(t,o){const a=t.indexOf(o);a>-1&&t.splice(a,1)}const Mb=new po("",{providedIn:"root",factory:()=>Gn(bc).handleError.bind(void 0)});function UD(){const t=Gn(rl),o=Gn(bc);return a=>t.runOutsideAngular(()=>o.handleError(a))}let jD=(()=>{var t;class o{constructor(){this.zone=Gn(rl),this.applicationRef=Gn(Rf)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(t=o).\u0275fac=function(d){return new(d||t)},t.\u0275prov=en({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function GD(){return!1}function WD(){}let qD=(()=>{class o{}return o.__NG_ELEMENT_ID__=ZD,o})();function ZD(t){return function YD(t,o,a){if(gs(t)&&!a){const d=ko(t.index,o);return new Ou(d,d)}return 47&t.type?new Ou(o[$i],o):null}(ds(),Bn(),16==(16&t))}class kb{constructor(){}supports(o){return C(o)}create(o){return new tC(o)}}const eC=(t,o)=>o;class tC{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||eC}forEachItem(o){let a;for(a=this._itHead;null!==a;a=a._next)o(a)}forEachOperation(o){let a=this._itHead,d=this._removalsHead,m=0,b=null;for(;a||d;){const I=!d||a&&a.currentIndex<Fb(d,m,b)?a:d,k=Fb(I,m,b),U=I.currentIndex;if(I===d)m--,d=d._nextRemoved;else if(a=a._next,null==I.previousIndex)m++;else{b||(b=[]);const ie=k-m,xe=U-m;if(ie!=xe){for(let Rt=0;Rt<ie;Rt++){const Gt=Rt<b.length?b[Rt]:b[Rt]=0,Mn=Gt+Rt;xe<=Mn&&Mn<ie&&(b[Rt]=Gt+1)}b[I.previousIndex]=xe-ie}}k!==U&&o(I,k,U)}}forEachPreviousItem(o){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachMovedItem(o){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}forEachIdentityChange(o){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)o(a)}diff(o){if(null==o&&(o=[]),!C(o))throw new Ce(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let m,b,I,a=this._itHead,d=!1;if(Array.isArray(o)){this.length=o.length;for(let k=0;k<this.length;k++)b=o[k],I=this._trackByFn(k,b),null!==a&&Object.is(a.trackById,I)?(d&&(a=this._verifyReinsertion(a,b,I,k)),Object.is(a.item,b)||this._addIdentityChange(a,b)):(a=this._mismatch(a,b,I,k),d=!0),a=a._next}else m=0,function F(t,o){if(Array.isArray(t))for(let a=0;a<t.length;a++)o(t[a]);else{const a=t[Symbol.iterator]();let d;for(;!(d=a.next()).done;)o(d.value)}}(o,k=>{I=this._trackByFn(m,k),null!==a&&Object.is(a.trackById,I)?(d&&(a=this._verifyReinsertion(a,k,I,m)),Object.is(a.item,k)||this._addIdentityChange(a,k)):(a=this._mismatch(a,k,I,m),d=!0),a=a._next,m++}),this.length=m;return this._truncate(a),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,a,d,m){let b;return null===o?b=this._itTail:(b=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._reinsertAfter(o,b,m)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(d,m))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._moveAfter(o,b,m)):o=this._addAfter(new nC(a,d),b,m),o}_verifyReinsertion(o,a,d,m){let b=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null);return null!==b?o=this._reinsertAfter(b,o._prev,m):o.currentIndex!=m&&(o.currentIndex=m,this._addToMoves(o,m)),o}_truncate(o){for(;null!==o;){const a=o._next;this._addToRemovals(this._unlink(o)),o=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,a,d){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const m=o._prevRemoved,b=o._nextRemoved;return null===m?this._removalsHead=b:m._nextRemoved=b,null===b?this._removalsTail=m:b._prevRemoved=m,this._insertAfter(o,a,d),this._addToMoves(o,d),o}_moveAfter(o,a,d){return this._unlink(o),this._insertAfter(o,a,d),this._addToMoves(o,d),o}_addAfter(o,a,d){return this._insertAfter(o,a,d),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,a,d){const m=null===a?this._itHead:a._next;return o._next=m,o._prev=a,null===m?this._itTail=o:m._prev=o,null===a?this._itHead=o:a._next=o,null===this._linkedRecords&&(this._linkedRecords=new Lb),this._linkedRecords.put(o),o.currentIndex=d,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const a=o._prev,d=o._next;return null===a?this._itHead=d:a._next=d,null===d?this._itTail=a:d._prev=a,o}_addToMoves(o,a){return o.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Lb),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,a){return o.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class nC{constructor(o,a){this.item=o,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class rC{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,a){let d;for(d=this._head;null!==d;d=d._nextDup)if((null===a||a<=d.currentIndex)&&Object.is(d.trackById,o))return d;return null}remove(o){const a=o._prevDup,d=o._nextDup;return null===a?this._head=d:a._nextDup=d,null===d?this._tail=a:d._prevDup=a,null===this._head}}class Lb{constructor(){this.map=new Map}put(o){const a=o.trackById;let d=this.map.get(a);d||(d=new rC,this.map.set(a,d)),d.add(o)}get(o,a){const m=this.map.get(o);return m?m.get(o,a):null}remove(o){const a=o.trackById;return this.map.get(a).remove(o)&&this.map.delete(a),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Fb(t,o,a){const d=t.previousIndex;if(null===d)return d;let m=0;return a&&d<a.length&&(m=a[d]),d+o+m}class Bb{constructor(){}supports(o){return o instanceof Map||V(o)}create(){return new iC}}class iC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let a;for(a=this._mapHead;null!==a;a=a._next)o(a)}forEachPreviousItem(o){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)o(a)}forEachChangedItem(o){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}diff(o){if(o){if(!(o instanceof Map||V(o)))throw new Ce(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(o,(d,m)=>{if(a&&a.key===m)this._maybeAddToChanges(a,d),this._appendAfter=a,a=a._next;else{const b=this._getOrCreateRecordForKey(m,d);a=this._insertBeforeOrAppend(a,b)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let d=a;null!==d;d=d._nextRemoved)d===this._mapHead&&(this._mapHead=null),this._records.delete(d.key),d._nextRemoved=d._next,d.previousValue=d.currentValue,d.currentValue=null,d._prev=null,d._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,a){if(o){const d=o._prev;return a._next=o,a._prev=d,o._prev=a,d&&(d._next=a),o===this._mapHead&&(this._mapHead=a),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(o,a){if(this._records.has(o)){const m=this._records.get(o);this._maybeAddToChanges(m,a);const b=m._prev,I=m._next;return b&&(b._next=I),I&&(I._prev=b),m._next=null,m._prev=null,m}const d=new oC(o);return this._records.set(o,d),d.currentValue=a,this._addToAdditions(d),d}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,a){Object.is(a,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=a,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,a){o instanceof Map?o.forEach(a):Object.keys(o).forEach(d=>a(o[d],d))}}class oC{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Nb(){return new _v([new kb])}let _v=(()=>{var t;class o{constructor(d){this.factories=d}static create(d,m){if(null!=m){const b=m.factories.slice();d=d.concat(b)}return new o(d)}static extend(d){return{provide:o,useFactory:m=>o.create(d,m||Nb()),deps:[[o,new Ch,new bd]]}}find(d){const m=this.factories.find(b=>b.supports(d));if(null!=m)return m;throw new Ce(901,!1)}}return(t=o).\u0275prov=en({token:t,providedIn:"root",factory:Nb}),o})();function zb(){return new yv([new Bb])}let yv=(()=>{var t;class o{constructor(d){this.factories=d}static create(d,m){if(m){const b=m.factories.slice();d=d.concat(b)}return new o(d)}static extend(d){return{provide:o,useFactory:m=>o.create(d,m||zb()),deps:[[o,new Ch,new bd]]}}find(d){const m=this.factories.find(b=>b.supports(d));if(m)return m;throw new Ce(901,!1)}}return(t=o).\u0275prov=en({token:t,providedIn:"root",factory:zb}),o})();const lC=wb(null,"core",[]);let cC=(()=>{var t;class o{constructor(d){}}return(t=o).\u0275fac=function(d){return new(d||t)(mn(Rf))},t.\u0275mod=io({type:t}),t.\u0275inj=Fn({}),o})();function xC(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function wC(t,o){const a=Vr(t),d=o.elementInjector||Kh();return new Cc(a).create(d,o.projectableNodes,o.hostElement,o.environmentInjector)}function EC(t){const o=Vr(t);if(!o)return null;const a=new Cc(o);return{get selector(){return a.selector},get type(){return a.componentType},get inputs(){return a.inputs},get outputs(){return a.outputs},get ngContentSelectors(){return a.ngContentSelectors},get isStandalone(){return o.standalone},get isSignal(){return o.signals}}}},7217:(Hn,It,X)=>{"use strict";X.d(It,{Dh:()=>Ke,GT:()=>Le,cc:()=>mt,hO:()=>ot,on:()=>Ae,pX:()=>Ne,xv:()=>ye});var M=X(1180),w=X(5879),lt=X(1920),l=X(7142);const _e=["ngOnDestroy"],Ne=(Ot,Pt,Ce,Ie={})=>new Proxy(Ot,{get:(ct,St)=>Ce.runOutsideAngular(()=>{if(Ot[St])return Ie?.spy?.get&&Ie.spy.get(St,Ot[St]),Ot[St];if(_e.indexOf(St)>-1)return()=>{};const Ye=Pt.toPromise().then(gt=>{const Wt=gt?.[St];return"function"==typeof Wt?Wt.bind(gt):Wt?.then?Wt.then(Nt=>Ce.run(()=>Nt)):Ce.run(()=>Wt)});return new Proxy(()=>{},{get:(gt,Wt)=>Ye[Wt],apply:(gt,Wt,Nt)=>Ye.then(an=>{const Qt=an?.(...Nt);return Ie?.spy?.apply&&Ie.spy.apply(St,Nt,Qt),Qt})})})}),Le=(Ot,Pt)=>{Pt.forEach(Ce=>{Object.getOwnPropertyNames(Ce.prototype||Ce).forEach(Ie=>{Object.defineProperty(Ot.prototype,Ie,Object.getOwnPropertyDescriptor(Ce.prototype||Ce,Ie))})})};class tt{constructor(Pt){return Pt}}const Ke=new w.OlP("angularfire2.app.options"),ye=new w.OlP("angularfire2.app.name");function Ae(Ot,Pt,Ce){const ct="object"==typeof Ce&&Ce||{};ct.name=ct.name||"string"==typeof Ce&&Ce||"[DEFAULT]";const Ye=l.Z.apps.filter(gt=>gt&&gt.name===ct.name)[0]||Pt.runOutsideAngular(()=>l.Z.initializeApp(Ot,ct));try{if(JSON.stringify(Ot)!==JSON.stringify(Ye.options)){const gt=!!module.hot;Ze("error",`${Ye.name} Firebase App already initialized with different options${gt?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new tt(Ye)}const Ze=(Ot,...Pt)=>{(0,w.X6Q)()&&typeof console<"u"&&console[Ot](...Pt)},Qe={provide:tt,useFactory:Ae,deps:[Ke,w.R0b,[new w.FiY,ye]]};let ot=(()=>{var Ot;class Pt{static initializeApp(Ie,ct){return{ngModule:Pt,providers:[{provide:Ke,useValue:Ie},{provide:ye,useValue:ct}]}}constructor(Ie){l.Z.registerVersion("angularfire",lt.q4.full,"core"),l.Z.registerVersion("angularfire",lt.q4.full,"app-compat"),l.Z.registerVersion("angular",w.q4F.full,Ie.toString())}}return Ot=Pt,(0,M.Z)(Pt,"\u0275fac",function(Ie){return new(Ie||Ot)(w.LFG(w.Lbi))}),(0,M.Z)(Pt,"\u0275mod",w.oAB({type:Ot})),(0,M.Z)(Pt,"\u0275inj",w.cJS({providers:[Qe]})),Pt})();function mt(Ot,Pt,Ce,Ie,ct){const[,St,Ye]=globalThis.\u0275AngularfireInstanceCache.find(gt=>gt[0]===Ot)||[];if(St)return function xt(Ot,Pt){try{return Ot.toString()===Pt.toString()}catch{return Ot===Pt}}(ct,Ye)||(et("error",`${Pt} was already initialized on the ${Ce} Firebase App with different settings.${pt?" You may need to reload as Firebase is not HMR aware.":""}`),et("warn",{is:ct,was:Ye})),St;{const gt=Ie();return globalThis.\u0275AngularfireInstanceCache.push([Ot,gt,ct]),gt}}const pt=typeof module<"u"&&!!module.hot,et=(Ot,...Pt)=>{(0,w.X6Q)()&&typeof console<"u"&&console[Ot](...Pt)};globalThis.\u0275AngularfireInstanceCache||=[]},1920:(Hn,It,X)=>{"use strict";X.d(It,{q4:()=>mt,iC:()=>Qt,HU:()=>St,Rf:()=>Ot,vb:()=>et,JM:()=>pt,u3:()=>Zt});var M=X(1180),w=X(5879),lt=X(3182),l=X(1954),Ne=X(2631);const tt=new class Le extends Ne.v{}(class _e extends l.o{constructor(zt,Se){super(zt,Se),this.scheduler=zt,this.work=Se}schedule(zt,Se=0){return Se>0?super.schedule(zt,Se):(this.delay=Se,this.state=zt,this.scheduler.flush(this),this)}execute(zt,Se){return Se>0||this.closed?super.execute(zt,Se):this._execute(zt,Se)}requestAsyncId(zt,Se,ze=0){return null!=ze&&ze>0||null==ze&&this.delay>0?super.requestAsyncId(zt,Se,ze):(zt.flush(this),0)}});var ye=X(6321),Ae=X(5592),Ze=X(9397),Qe=X(5137),ot=X(3093);const mt=new w.GfV("ANGULARFIRE2_VERSION");function pt(Pn,zt,Se){if(zt){if(1===zt.length)return zt[0];const Dt=zt.filter(jt=>jt.app===Se);if(1===Dt.length)return Dt[0]}return Se.container.getProvider(Pn).getImmediate({optional:!0})}const et=(Pn,zt)=>{const Se=zt?[zt]:(0,lt.C6)(),ze=[];return Se.forEach(ut=>{ut.container.getProvider(Pn).instances.forEach(jt=>{ze.includes(jt)||ze.push(jt)})}),ze};class Ot{constructor(){return et(Pt)}}const Pt="app-check";function Ce(){}class Ie{constructor(zt,Se=tt){(0,M.Z)(this,"zone",void 0),(0,M.Z)(this,"delegate",void 0),this.zone=zt,this.delegate=Se}now(){return this.delegate.now()}schedule(zt,Se,ze){const ut=this.zone;return this.delegate.schedule(function(jt){ut.runGuarded(()=>{zt.apply(this,[jt])})},Se,ze)}}class ct{constructor(zt){(0,M.Z)(this,"zone",void 0),(0,M.Z)(this,"task",null),this.zone=zt}call(zt,Se){const ze=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ce,{},Ce,Ce)),Se.pipe((0,Ze.b)({next:ze,complete:ze,error:ze})).subscribe(zt).add(ze)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let St=(()=>{var Pn;class zt{constructor(ze){(0,M.Z)(this,"ngZone",void 0),(0,M.Z)(this,"outsideAngular",void 0),(0,M.Z)(this,"insideAngular",void 0),this.ngZone=ze,this.outsideAngular=ze.runOutsideAngular(()=>new Ie(Zone.current)),this.insideAngular=ze.run(()=>new Ie(Zone.current,ye.z)),globalThis.\u0275AngularFireScheduler||=this}}return Pn=zt,(0,M.Z)(zt,"\u0275fac",function(ze){return new(ze||Pn)(w.LFG(w.R0b))}),(0,M.Z)(zt,"\u0275prov",w.Yz7({token:Pn,factory:Pn.\u0275fac,providedIn:"root"})),zt})();function Ye(){const Pn=globalThis.\u0275AngularFireScheduler;if(!Pn)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return Pn}function Wt(Pn){return Ye().ngZone.run(()=>Pn())}function Qt(Pn){return function Vt(Pn){return function(Se){return(Se=Se.lift(new ct(Pn.ngZone))).pipe((0,Qe.R)(Pn.outsideAngular),(0,ot.Q)(Pn.insideAngular))}}(Ye())(Pn)}const Jn=(Pn,zt)=>function(){const ze=arguments;return zt&&setTimeout(()=>{"scheduled"===zt.state&&zt.invoke()},10),Wt(()=>Pn.apply(void 0,ze))},Zt=(Pn,zt)=>function(){let Se;const ze=arguments;for(let Dt=0;Dt<arguments.length;Dt++)"function"==typeof ze[Dt]&&(zt&&(Se||=Wt(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ce,{},Ce,Ce))),ze[Dt]=Jn(ze[Dt],Se));const ut=function gt(Pn){return Ye().ngZone.runOutsideAngular(()=>Pn())}(()=>Pn.apply(this,ze));if(!zt){if(ut instanceof Ae.y){const Dt=Ye();return ut.pipe((0,Qe.R)(Dt.outsideAngular),(0,ot.Q)(Dt.insideAngular))}return Wt(()=>ut)}return ut instanceof Ae.y?ut.pipe(Qt):ut instanceof Promise?Wt(()=>new Promise((Dt,jt)=>ut.then(nn=>Wt(()=>Dt(nn)),nn=>Wt(()=>jt(nn))))):"function"==typeof ut&&Se?function(){return setTimeout(()=>{Se&&"scheduled"===Se.state&&Se.invoke()},10),ut.apply(this,arguments)}:Wt(()=>ut)}},95:(Hn,It,X)=>{"use strict";X.d(It,{NI:()=>Ct,oH:()=>Ri,cw:()=>Zn,sg:()=>vr,u5:()=>Oi,JU:()=>mt,a5:()=>Jr,JJ:()=>wr,JL:()=>_r,F:()=>$e,UX:()=>so,kI:()=>Wt,_Y:()=>Pi});var M=X(5879),w=X(6814),lt=X(2459),l=X(5592),_e=X(7453),Ne=X(4829),Le=X(9940),tt=X(8251),Ke=X(7400),ye=X(2714),Ze=X(7398);let Qe=(()=>{var ee;class Y{constructor(re,We){this._renderer=re,this._elementRef=We,this.onChange=zn=>{},this.onTouched=()=>{}}setProperty(re,We){this._renderer.setProperty(this._elementRef.nativeElement,re,We)}registerOnTouched(re){this.onTouched=re}registerOnChange(re){this.onChange=re}setDisabledState(re){this.setProperty("disabled",re)}}return(ee=Y).\u0275fac=function(re){return new(re||ee)(M.Y36(M.Qsj),M.Y36(M.SBq))},ee.\u0275dir=M.lG2({type:ee}),Y})(),ot=(()=>{var ee;class Y extends Qe{}return(ee=Y).\u0275fac=function(){let Me;return function(We){return(Me||(Me=M.n5z(ee)))(We||ee)}}(),ee.\u0275dir=M.lG2({type:ee,features:[M.qOj]}),Y})();const mt=new M.OlP("NgValueAccessor"),et={provide:mt,useExisting:(0,M.Gpc)(()=>Ce),multi:!0},Pt=new M.OlP("CompositionEventMode");let Ce=(()=>{var ee;class Y extends Qe{constructor(re,We,zn){super(re,We),this._compositionMode=zn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Ot(){const ee=(0,w.q)()?(0,w.q)().getUserAgent():"";return/android (\d+)/.test(ee.toLowerCase())}())}writeValue(re){this.setProperty("value",re??"")}_handleInput(re){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(re)}_compositionStart(){this._composing=!0}_compositionEnd(re){this._composing=!1,this._compositionMode&&this.onChange(re)}}return(ee=Y).\u0275fac=function(re){return new(re||ee)(M.Y36(M.Qsj),M.Y36(M.SBq),M.Y36(Pt,8))},ee.\u0275dir=M.lG2({type:ee,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(re,We){1&re&&M.NdJ("input",function(zr){return We._handleInput(zr.target.value)})("blur",function(){return We.onTouched()})("compositionstart",function(){return We._compositionStart()})("compositionend",function(zr){return We._compositionEnd(zr.target.value)})},features:[M._Bn([et]),M.qOj]}),Y})();function Ie(ee){return null==ee||("string"==typeof ee||Array.isArray(ee))&&0===ee.length}function ct(ee){return null!=ee&&"number"==typeof ee.length}const St=new M.OlP("NgValidators"),Ye=new M.OlP("NgAsyncValidators"),gt=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Wt{static min(Y){return function Nt(ee){return Y=>{if(Ie(Y.value)||Ie(ee))return null;const Me=parseFloat(Y.value);return!isNaN(Me)&&Me<ee?{min:{min:ee,actual:Y.value}}:null}}(Y)}static max(Y){return function an(ee){return Y=>{if(Ie(Y.value)||Ie(ee))return null;const Me=parseFloat(Y.value);return!isNaN(Me)&&Me>ee?{max:{max:ee,actual:Y.value}}:null}}(Y)}static required(Y){return function Qt(ee){return Ie(ee.value)?{required:!0}:null}(Y)}static requiredTrue(Y){return function Vt(ee){return!0===ee.value?null:{required:!0}}(Y)}static email(Y){return function Jn(ee){return Ie(ee.value)||gt.test(ee.value)?null:{email:!0}}(Y)}static minLength(Y){return function Zt(ee){return Y=>Ie(Y.value)||!ct(Y.value)?null:Y.value.length<ee?{minlength:{requiredLength:ee,actualLength:Y.value.length}}:null}(Y)}static maxLength(Y){return function Pn(ee){return Y=>ct(Y.value)&&Y.value.length>ee?{maxlength:{requiredLength:ee,actualLength:Y.value.length}}:null}(Y)}static pattern(Y){return function zt(ee){if(!ee)return Se;let Y,Me;return"string"==typeof ee?(Me="","^"!==ee.charAt(0)&&(Me+="^"),Me+=ee,"$"!==ee.charAt(ee.length-1)&&(Me+="$"),Y=new RegExp(Me)):(Me=ee.toString(),Y=ee),re=>{if(Ie(re.value))return null;const We=re.value;return Y.test(We)?null:{pattern:{requiredPattern:Me,actualValue:We}}}}(Y)}static nullValidator(Y){return null}static compose(Y){return _n(Y)}static composeAsync(Y){return rn(Y)}}function Se(ee){return null}function ze(ee){return null!=ee}function ut(ee){return(0,M.QGY)(ee)?(0,lt.D)(ee):ee}function Dt(ee){let Y={};return ee.forEach(Me=>{Y=null!=Me?{...Y,...Me}:Y}),0===Object.keys(Y).length?null:Y}function jt(ee,Y){return Y.map(Me=>Me(ee))}function ln(ee){return ee.map(Y=>function nn(ee){return!ee.validate}(Y)?Y:Me=>Y.validate(Me))}function _n(ee){if(!ee)return null;const Y=ee.filter(ze);return 0==Y.length?null:function(Me){return Dt(jt(Me,Y))}}function bn(ee){return null!=ee?_n(ln(ee)):null}function rn(ee){if(!ee)return null;const Y=ee.filter(ze);return 0==Y.length?null:function(Me){return function Ae(...ee){const Y=(0,Le.jO)(ee),{args:Me,keys:re}=(0,_e.D)(ee),We=new l.y(zn=>{const{length:zr}=Me;if(!zr)return void zn.complete();const Oo=new Array(zr);let rs=zr,is=zr;for(let Ko=0;Ko<zr;Ko++){let Ds=!1;(0,Ne.Xf)(Me[Ko]).subscribe((0,tt.x)(zn,La=>{Ds||(Ds=!0,is--),Oo[Ko]=La},()=>rs--,void 0,()=>{(!rs||!Ds)&&(is||zn.next(re?(0,ye.n)(re,Oo):Oo),zn.complete())}))}});return Y?We.pipe((0,Ke.Z)(Y)):We}(jt(Me,Y).map(ut)).pipe((0,Ze.U)(Dt))}}function Jt(ee){return null!=ee?rn(ln(ee)):null}function en(ee,Y){return null===ee?[Y]:Array.isArray(ee)?[...ee,Y]:[ee,Y]}function dn(ee){return ee._rawValidators}function Fn(ee){return ee._rawAsyncValidators}function pr(ee){return ee?Array.isArray(ee)?ee:[ee]:[]}function nr(ee,Y){return Array.isArray(ee)?ee.includes(Y):ee===Y}function gr(ee,Y){const Me=pr(Y);return pr(ee).forEach(We=>{nr(Me,We)||Me.push(We)}),Me}function Xn(ee,Y){return pr(Y).filter(Me=>!nr(ee,Me))}class Lr{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(Y){this._rawValidators=Y||[],this._composedValidatorFn=bn(this._rawValidators)}_setAsyncValidators(Y){this._rawAsyncValidators=Y||[],this._composedAsyncValidatorFn=Jt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(Y){this._onDestroyCallbacks.push(Y)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(Y=>Y()),this._onDestroyCallbacks=[]}reset(Y=void 0){this.control&&this.control.reset(Y)}hasError(Y,Me){return!!this.control&&this.control.hasError(Y,Me)}getError(Y,Me){return this.control?this.control.getError(Y,Me):null}}class yn extends Lr{get formDirective(){return null}get path(){return null}}class Jr extends Lr{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Li{constructor(Y){this._cd=Y}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let wr=(()=>{var ee;class Y extends Li{constructor(re){super(re)}}return(ee=Y).\u0275fac=function(re){return new(re||ee)(M.Y36(Jr,2))},ee.\u0275dir=M.lG2({type:ee,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(re,We){2&re&&M.ekj("ng-untouched",We.isUntouched)("ng-touched",We.isTouched)("ng-pristine",We.isPristine)("ng-dirty",We.isDirty)("ng-valid",We.isValid)("ng-invalid",We.isInvalid)("ng-pending",We.isPending)},features:[M.qOj]}),Y})(),_r=(()=>{var ee;class Y extends Li{constructor(re){super(re)}}return(ee=Y).\u0275fac=function(re){return new(re||ee)(M.Y36(yn,10))},ee.\u0275dir=M.lG2({type:ee,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(re,We){2&re&&M.ekj("ng-untouched",We.isUntouched)("ng-touched",We.isTouched)("ng-pristine",We.isPristine)("ng-dirty",We.isDirty)("ng-valid",We.isValid)("ng-invalid",We.isInvalid)("ng-pending",We.isPending)("ng-submitted",We.isSubmitted)},features:[M.qOj]}),Y})();const At="VALID",_t="INVALID",Bt="PENDING",pn="DISABLED";function ke(ee){return(fe(ee)?ee.validators:ee)||null}function ce(ee,Y){return(fe(Y)?Y.asyncValidators:ee)||null}function fe(ee){return null!=ee&&!Array.isArray(ee)&&"object"==typeof ee}class mn{constructor(Y,Me){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(Y),this._assignAsyncValidators(Me)}get validator(){return this._composedValidatorFn}set validator(Y){this._rawValidators=this._composedValidatorFn=Y}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(Y){this._rawAsyncValidators=this._composedAsyncValidatorFn=Y}get parent(){return this._parent}get valid(){return this.status===At}get invalid(){return this.status===_t}get pending(){return this.status==Bt}get disabled(){return this.status===pn}get enabled(){return this.status!==pn}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(Y){this._assignValidators(Y)}setAsyncValidators(Y){this._assignAsyncValidators(Y)}addValidators(Y){this.setValidators(gr(Y,this._rawValidators))}addAsyncValidators(Y){this.setAsyncValidators(gr(Y,this._rawAsyncValidators))}removeValidators(Y){this.setValidators(Xn(Y,this._rawValidators))}removeAsyncValidators(Y){this.setAsyncValidators(Xn(Y,this._rawAsyncValidators))}hasValidator(Y){return nr(this._rawValidators,Y)}hasAsyncValidator(Y){return nr(this._rawAsyncValidators,Y)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(Y={}){this.touched=!0,this._parent&&!Y.onlySelf&&this._parent.markAsTouched(Y)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(Y=>Y.markAllAsTouched())}markAsUntouched(Y={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(Me=>{Me.markAsUntouched({onlySelf:!0})}),this._parent&&!Y.onlySelf&&this._parent._updateTouched(Y)}markAsDirty(Y={}){this.pristine=!1,this._parent&&!Y.onlySelf&&this._parent.markAsDirty(Y)}markAsPristine(Y={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(Me=>{Me.markAsPristine({onlySelf:!0})}),this._parent&&!Y.onlySelf&&this._parent._updatePristine(Y)}markAsPending(Y={}){this.status=Bt,!1!==Y.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!Y.onlySelf&&this._parent.markAsPending(Y)}disable(Y={}){const Me=this._parentMarkedDirty(Y.onlySelf);this.status=pn,this.errors=null,this._forEachChild(re=>{re.disable({...Y,onlySelf:!0})}),this._updateValue(),!1!==Y.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...Y,skipPristineCheck:Me}),this._onDisabledChange.forEach(re=>re(!0))}enable(Y={}){const Me=this._parentMarkedDirty(Y.onlySelf);this.status=At,this._forEachChild(re=>{re.enable({...Y,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:Y.emitEvent}),this._updateAncestors({...Y,skipPristineCheck:Me}),this._onDisabledChange.forEach(re=>re(!1))}_updateAncestors(Y){this._parent&&!Y.onlySelf&&(this._parent.updateValueAndValidity(Y),Y.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(Y){this._parent=Y}getRawValue(){return this.value}updateValueAndValidity(Y={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===At||this.status===Bt)&&this._runAsyncValidator(Y.emitEvent)),!1!==Y.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!Y.onlySelf&&this._parent.updateValueAndValidity(Y)}_updateTreeValidity(Y={emitEvent:!0}){this._forEachChild(Me=>Me._updateTreeValidity(Y)),this.updateValueAndValidity({onlySelf:!0,emitEvent:Y.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?pn:At}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(Y){if(this.asyncValidator){this.status=Bt,this._hasOwnPendingAsyncValidator=!0;const Me=ut(this.asyncValidator(this));this._asyncValidationSubscription=Me.subscribe(re=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(re,{emitEvent:Y})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(Y,Me={}){this.errors=Y,this._updateControlsErrors(!1!==Me.emitEvent)}get(Y){let Me=Y;return null==Me||(Array.isArray(Me)||(Me=Me.split(".")),0===Me.length)?null:Me.reduce((re,We)=>re&&re._find(We),this)}getError(Y,Me){const re=Me?this.get(Me):this;return re&&re.errors?re.errors[Y]:null}hasError(Y,Me){return!!this.getError(Y,Me)}get root(){let Y=this;for(;Y._parent;)Y=Y._parent;return Y}_updateControlsErrors(Y){this.status=this._calculateStatus(),Y&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(Y)}_initObservables(){this.valueChanges=new M.vpe,this.statusChanges=new M.vpe}_calculateStatus(){return this._allControlsDisabled()?pn:this.errors?_t:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Bt)?Bt:this._anyControlsHaveStatus(_t)?_t:At}_anyControlsHaveStatus(Y){return this._anyControls(Me=>Me.status===Y)}_anyControlsDirty(){return this._anyControls(Y=>Y.dirty)}_anyControlsTouched(){return this._anyControls(Y=>Y.touched)}_updatePristine(Y={}){this.pristine=!this._anyControlsDirty(),this._parent&&!Y.onlySelf&&this._parent._updatePristine(Y)}_updateTouched(Y={}){this.touched=this._anyControlsTouched(),this._parent&&!Y.onlySelf&&this._parent._updateTouched(Y)}_registerOnCollectionChange(Y){this._onCollectionChange=Y}_setUpdateStrategy(Y){fe(Y)&&null!=Y.updateOn&&(this._updateOn=Y.updateOn)}_parentMarkedDirty(Y){return!Y&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(Y){return null}_assignValidators(Y){this._rawValidators=Array.isArray(Y)?Y.slice():Y,this._composedValidatorFn=function se(ee){return Array.isArray(ee)?bn(ee):ee||null}(this._rawValidators)}_assignAsyncValidators(Y){this._rawAsyncValidators=Array.isArray(Y)?Y.slice():Y,this._composedAsyncValidatorFn=function Fe(ee){return Array.isArray(ee)?Jt(ee):ee||null}(this._rawAsyncValidators)}}class Zn extends mn{constructor(Y,Me,re){super(ke(Me),ce(re,Me)),this.controls=Y,this._initObservables(),this._setUpdateStrategy(Me),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(Y,Me){return this.controls[Y]?this.controls[Y]:(this.controls[Y]=Me,Me.setParent(this),Me._registerOnCollectionChange(this._onCollectionChange),Me)}addControl(Y,Me,re={}){this.registerControl(Y,Me),this.updateValueAndValidity({emitEvent:re.emitEvent}),this._onCollectionChange()}removeControl(Y,Me={}){this.controls[Y]&&this.controls[Y]._registerOnCollectionChange(()=>{}),delete this.controls[Y],this.updateValueAndValidity({emitEvent:Me.emitEvent}),this._onCollectionChange()}setControl(Y,Me,re={}){this.controls[Y]&&this.controls[Y]._registerOnCollectionChange(()=>{}),delete this.controls[Y],Me&&this.registerControl(Y,Me),this.updateValueAndValidity({emitEvent:re.emitEvent}),this._onCollectionChange()}contains(Y){return this.controls.hasOwnProperty(Y)&&this.controls[Y].enabled}setValue(Y,Me={}){(function Ft(ee,Y,Me){ee._forEachChild((re,We)=>{if(void 0===Me[We])throw new M.vHH(1002,"")})})(this,0,Y),Object.keys(Y).forEach(re=>{(function nt(ee,Y,Me){const re=ee.controls;if(!(Y?Object.keys(re):re).length)throw new M.vHH(1e3,"");if(!re[Me])throw new M.vHH(1001,"")})(this,!0,re),this.controls[re].setValue(Y[re],{onlySelf:!0,emitEvent:Me.emitEvent})}),this.updateValueAndValidity(Me)}patchValue(Y,Me={}){null!=Y&&(Object.keys(Y).forEach(re=>{const We=this.controls[re];We&&We.patchValue(Y[re],{onlySelf:!0,emitEvent:Me.emitEvent})}),this.updateValueAndValidity(Me))}reset(Y={},Me={}){this._forEachChild((re,We)=>{re.reset(Y[We],{onlySelf:!0,emitEvent:Me.emitEvent})}),this._updatePristine(Me),this._updateTouched(Me),this.updateValueAndValidity(Me)}getRawValue(){return this._reduceChildren({},(Y,Me,re)=>(Y[re]=Me.getRawValue(),Y))}_syncPendingControls(){let Y=this._reduceChildren(!1,(Me,re)=>!!re._syncPendingControls()||Me);return Y&&this.updateValueAndValidity({onlySelf:!0}),Y}_forEachChild(Y){Object.keys(this.controls).forEach(Me=>{const re=this.controls[Me];re&&Y(re,Me)})}_setUpControls(){this._forEachChild(Y=>{Y.setParent(this),Y._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(Y){for(const[Me,re]of Object.entries(this.controls))if(this.contains(Me)&&Y(re))return!0;return!1}_reduceValue(){return this._reduceChildren({},(Me,re,We)=>((re.enabled||this.disabled)&&(Me[We]=re.value),Me))}_reduceChildren(Y,Me){let re=Y;return this._forEachChild((We,zn)=>{re=Me(re,We,zn)}),re}_allControlsDisabled(){for(const Y of Object.keys(this.controls))if(this.controls[Y].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(Y){return this.controls.hasOwnProperty(Y)?this.controls[Y]:null}}const ti=new M.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>no}),no="always";function Kt(ee,Y,Me=no){qn(ee,Y),Y.valueAccessor.writeValue(ee.value),(ee.disabled||"always"===Me)&&Y.valueAccessor.setDisabledState?.(ee.disabled),function Fr(ee,Y){Y.valueAccessor.registerOnChange(Me=>{ee._pendingValue=Me,ee._pendingChange=!0,ee._pendingDirty=!0,"change"===ee.updateOn&&Ci(ee,Y)})}(ee,Y),function Qr(ee,Y){const Me=(re,We)=>{Y.valueAccessor.writeValue(re),We&&Y.viewToModelUpdate(re)};ee.registerOnChange(Me),Y._registerOnDestroy(()=>{ee._unregisterOnChange(Me)})}(ee,Y),function di(ee,Y){Y.valueAccessor.registerOnTouched(()=>{ee._pendingTouched=!0,"blur"===ee.updateOn&&ee._pendingChange&&Ci(ee,Y),"submit"!==ee.updateOn&&ee.markAsTouched()})}(ee,Y),function cr(ee,Y){if(Y.valueAccessor.setDisabledState){const Me=re=>{Y.valueAccessor.setDisabledState(re)};ee.registerOnDisabledChange(Me),Y._registerOnDestroy(()=>{ee._unregisterOnDisabledChange(Me)})}}(ee,Y)}function Et(ee,Y,Me=!0){const re=()=>{};Y.valueAccessor&&(Y.valueAccessor.registerOnChange(re),Y.valueAccessor.registerOnTouched(re)),Rr(ee,Y),ee&&(Y._invokeOnDestroyCallbacks(),ee._registerOnCollectionChange(()=>{}))}function wn(ee,Y){ee.forEach(Me=>{Me.registerOnValidatorChange&&Me.registerOnValidatorChange(Y)})}function qn(ee,Y){const Me=dn(ee);null!==Y.validator?ee.setValidators(en(Me,Y.validator)):"function"==typeof Me&&ee.setValidators([Me]);const re=Fn(ee);null!==Y.asyncValidator?ee.setAsyncValidators(en(re,Y.asyncValidator)):"function"==typeof re&&ee.setAsyncValidators([re]);const We=()=>ee.updateValueAndValidity();wn(Y._rawValidators,We),wn(Y._rawAsyncValidators,We)}function Rr(ee,Y){let Me=!1;if(null!==ee){if(null!==Y.validator){const We=dn(ee);if(Array.isArray(We)&&We.length>0){const zn=We.filter(zr=>zr!==Y.validator);zn.length!==We.length&&(Me=!0,ee.setValidators(zn))}}if(null!==Y.asyncValidator){const We=Fn(ee);if(Array.isArray(We)&&We.length>0){const zn=We.filter(zr=>zr!==Y.asyncValidator);zn.length!==We.length&&(Me=!0,ee.setAsyncValidators(zn))}}}const re=()=>{};return wn(Y._rawValidators,re),wn(Y._rawAsyncValidators,re),Me}function Ci(ee,Y){ee._pendingDirty&&ee.markAsDirty(),ee.setValue(ee._pendingValue,{emitModelToViewChange:!1}),Y.viewToModelUpdate(ee._pendingValue),ee._pendingChange=!1}function li(ee,Y){qn(ee,Y)}function ss(ee,Y){ee._syncPendingControls(),Y.forEach(Me=>{const re=Me.control;"submit"===re.updateOn&&re._pendingChange&&(Me.viewToModelUpdate(re._pendingValue),re._pendingChange=!1)})}const Dr={provide:yn,useExisting:(0,M.Gpc)(()=>$e)},he=(()=>Promise.resolve())();let $e=(()=>{var ee;class Y extends yn{constructor(re,We,zn){super(),this.callSetDisabledState=zn,this.submitted=!1,this._directives=new Set,this.ngSubmit=new M.vpe,this.form=new Zn({},bn(re),Jt(We))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(re){he.then(()=>{const We=this._findContainer(re.path);re.control=We.registerControl(re.name,re.control),Kt(re.control,re,this.callSetDisabledState),re.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(re)})}getControl(re){return this.form.get(re.path)}removeControl(re){he.then(()=>{const We=this._findContainer(re.path);We&&We.removeControl(re.name),this._directives.delete(re)})}addFormGroup(re){he.then(()=>{const We=this._findContainer(re.path),zn=new Zn({});li(zn,re),We.registerControl(re.name,zn),zn.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(re){he.then(()=>{const We=this._findContainer(re.path);We&&We.removeControl(re.name)})}getFormGroup(re){return this.form.get(re.path)}updateModel(re,We){he.then(()=>{this.form.get(re.path).setValue(We)})}setValue(re){this.control.setValue(re)}onSubmit(re){return this.submitted=!0,ss(this.form,this._directives),this.ngSubmit.emit(re),"dialog"===re?.target?.method}onReset(){this.resetForm()}resetForm(re=void 0){this.form.reset(re),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(re){return re.pop(),re.length?this.form.get(re):this.form}}return(ee=Y).\u0275fac=function(re){return new(re||ee)(M.Y36(St,10),M.Y36(Ye,10),M.Y36(ti,8))},ee.\u0275dir=M.lG2({type:ee,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(re,We){1&re&&M.NdJ("submit",function(zr){return We.onSubmit(zr)})("reset",function(){return We.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[M._Bn([Dr]),M.qOj]}),Y})();function we(ee,Y){const Me=ee.indexOf(Y);Me>-1&&ee.splice(Me,1)}function Be(ee){return"object"==typeof ee&&null!==ee&&2===Object.keys(ee).length&&"value"in ee&&"disabled"in ee}const Ct=class extends mn{constructor(Y=null,Me,re){super(ke(Me),ce(re,Me)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(Y),this._setUpdateStrategy(Me),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),fe(Me)&&(Me.nonNullable||Me.initialValueIsDefault)&&(this.defaultValue=Be(Y)?Y.value:Y)}setValue(Y,Me={}){this.value=this._pendingValue=Y,this._onChange.length&&!1!==Me.emitModelToViewChange&&this._onChange.forEach(re=>re(this.value,!1!==Me.emitViewToModelChange)),this.updateValueAndValidity(Me)}patchValue(Y,Me={}){this.setValue(Y,Me)}reset(Y=this.defaultValue,Me={}){this._applyFormState(Y),this.markAsPristine(Me),this.markAsUntouched(Me),this.setValue(this.value,Me),this._pendingChange=!1}_updateValue(){}_anyControls(Y){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(Y){this._onChange.push(Y)}_unregisterOnChange(Y){we(this._onChange,Y)}registerOnDisabledChange(Y){this._onDisabledChange.push(Y)}_unregisterOnDisabledChange(Y){we(this._onDisabledChange,Y)}_forEachChild(Y){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(Y){Be(Y)?(this.value=this._pendingValue=Y.value,Y.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=Y}};let Pi=(()=>{var ee;class Y{}return(ee=Y).\u0275fac=function(re){return new(re||ee)},ee.\u0275dir=M.lG2({type:ee,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),Y})(),ps=(()=>{var ee;class Y{}return(ee=Y).\u0275fac=function(re){return new(re||ee)},ee.\u0275mod=M.oAB({type:ee}),ee.\u0275inj=M.cJS({}),Y})();const Bi=new M.OlP("NgModelWithFormControlWarning"),Os={provide:Jr,useExisting:(0,M.Gpc)(()=>Ri)};let Ri=(()=>{var ee;class Y extends Jr{set isDisabled(re){}constructor(re,We,zn,zr,Oo){super(),this._ngModelWarningConfig=zr,this.callSetDisabledState=Oo,this.update=new M.vpe,this._ngModelWarningSent=!1,this._setValidators(re),this._setAsyncValidators(We),this.valueAccessor=function Po(ee,Y){if(!Y)return null;let Me,re,We;return Array.isArray(Y),Y.forEach(zn=>{zn.constructor===Ce?Me=zn:function zi(ee){return Object.getPrototypeOf(ee.constructor)===ot}(zn)?re=zn:We=zn}),We||re||Me||null}(0,zn)}ngOnChanges(re){if(this._isControlChanged(re)){const We=re.form.previousValue;We&&Et(We,this,!1),Kt(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}(function Yo(ee,Y){if(!ee.hasOwnProperty("model"))return!1;const Me=ee.model;return!!Me.isFirstChange()||!Object.is(Y,Me.currentValue)})(re,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Et(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(re){this.viewModel=re,this.update.emit(re)}_isControlChanged(re){return re.hasOwnProperty("form")}}return(ee=Y)._ngModelWarningSentOnce=!1,ee.\u0275fac=function(re){return new(re||ee)(M.Y36(St,10),M.Y36(Ye,10),M.Y36(mt,10),M.Y36(Bi,8),M.Y36(ti,8))},ee.\u0275dir=M.lG2({type:ee,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[M._Bn([Os]),M.qOj,M.TTD]}),Y})();const rr={provide:yn,useExisting:(0,M.Gpc)(()=>vr)};let vr=(()=>{var ee;class Y extends yn{constructor(re,We,zn){super(),this.callSetDisabledState=zn,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new M.vpe,this._setValidators(re),this._setAsyncValidators(We)}ngOnChanges(re){this._checkFormPresent(),re.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Rr(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(re){const We=this.form.get(re.path);return Kt(We,re,this.callSetDisabledState),We.updateValueAndValidity({emitEvent:!1}),this.directives.push(re),We}getControl(re){return this.form.get(re.path)}removeControl(re){Et(re.control||null,re,!1),function No(ee,Y){const Me=ee.indexOf(Y);Me>-1&&ee.splice(Me,1)}(this.directives,re)}addFormGroup(re){this._setUpFormContainer(re)}removeFormGroup(re){this._cleanUpFormContainer(re)}getFormGroup(re){return this.form.get(re.path)}addFormArray(re){this._setUpFormContainer(re)}removeFormArray(re){this._cleanUpFormContainer(re)}getFormArray(re){return this.form.get(re.path)}updateModel(re,We){this.form.get(re.path).setValue(We)}onSubmit(re){return this.submitted=!0,ss(this.form,this.directives),this.ngSubmit.emit(re),"dialog"===re?.target?.method}onReset(){this.resetForm()}resetForm(re=void 0){this.form.reset(re),this.submitted=!1}_updateDomValue(){this.directives.forEach(re=>{const We=re.control,zn=this.form.get(re.path);We!==zn&&(Et(We||null,re),(ee=>ee instanceof Ct)(zn)&&(Kt(zn,re,this.callSetDisabledState),re.control=zn))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(re){const We=this.form.get(re.path);li(We,re),We.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(re){if(this.form){const We=this.form.get(re.path);We&&function Gr(ee,Y){return Rr(ee,Y)}(We,re)&&We.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){qn(this.form,this),this._oldForm&&Rr(this._oldForm,this)}_checkFormPresent(){}}return(ee=Y).\u0275fac=function(re){return new(re||ee)(M.Y36(St,10),M.Y36(Ye,10),M.Y36(ti,8))},ee.\u0275dir=M.lG2({type:ee,selectors:[["","formGroup",""]],hostBindings:function(re,We){1&re&&M.NdJ("submit",function(zr){return We.onSubmit(zr)})("reset",function(){return We.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[M._Bn([rr]),M.qOj,M.TTD]}),Y})(),Js=(()=>{var ee;class Y{}return(ee=Y).\u0275fac=function(re){return new(re||ee)},ee.\u0275mod=M.oAB({type:ee}),ee.\u0275inj=M.cJS({imports:[ps]}),Y})(),Oi=(()=>{var ee;class Y{static withConfig(re){return{ngModule:Y,providers:[{provide:ti,useValue:re.callSetDisabledState??no}]}}}return(ee=Y).\u0275fac=function(re){return new(re||ee)},ee.\u0275mod=M.oAB({type:ee}),ee.\u0275inj=M.cJS({imports:[Js]}),Y})(),so=(()=>{var ee;class Y{static withConfig(re){return{ngModule:Y,providers:[{provide:Bi,useValue:re.warnOnNgModelWithFormControl??"always"},{provide:ti,useValue:re.callSetDisabledState??no}]}}}return(ee=Y).\u0275fac=function(re){return new(re||ee)},ee.\u0275mod=M.oAB({type:ee}),ee.\u0275inj=M.cJS({imports:[Js]}),Y})()},6593:(Hn,It,X)=>{"use strict";X.d(It,{Dx:()=>Jr,b2:()=>nr,q6:()=>en,se:()=>gt});var M=X(5879),w=X(6814);class lt extends w.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class l extends lt{static makeCurrent(){(0,w.HT)(new l)}onAndCancel(ce,Fe,fe){return ce.addEventListener(Fe,fe),()=>{ce.removeEventListener(Fe,fe)}}dispatchEvent(ce,Fe){ce.dispatchEvent(Fe)}remove(ce){ce.parentNode&&ce.parentNode.removeChild(ce)}createElement(ce,Fe){return(Fe=Fe||this.getDefaultDocument()).createElement(ce)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ce){return ce.nodeType===Node.ELEMENT_NODE}isShadowRoot(ce){return ce instanceof DocumentFragment}getGlobalEventTarget(ce,Fe){return"window"===Fe?window:"document"===Fe?ce:"body"===Fe?ce.body:null}getBaseHref(ce){const Fe=function Ne(){return _e=_e||document.querySelector("base"),_e?_e.getAttribute("href"):null}();return null==Fe?null:function tt(se){Le=Le||document.createElement("a"),Le.setAttribute("href",se);const ce=Le.pathname;return"/"===ce.charAt(0)?ce:`/${ce}`}(Fe)}resetBaseElement(){_e=null}getUserAgent(){return window.navigator.userAgent}getCookie(ce){return(0,w.Mx)(document.cookie,ce)}}let Le,_e=null,ye=(()=>{var se;class ce{build(){return new XMLHttpRequest}}return(se=ce).\u0275fac=function(fe){return new(fe||se)},se.\u0275prov=M.Yz7({token:se,factory:se.\u0275fac}),ce})();const Ae=new M.OlP("EventManagerPlugins");let Ze=(()=>{var se;class ce{constructor(fe,nt){this._zone=nt,this._eventNameToPlugin=new Map,fe.forEach(Ft=>{Ft.manager=this}),this._plugins=fe.slice().reverse()}addEventListener(fe,nt,Ft){return this._findPluginFor(nt).addEventListener(fe,nt,Ft)}getZone(){return this._zone}_findPluginFor(fe){let nt=this._eventNameToPlugin.get(fe);if(nt)return nt;if(nt=this._plugins.find(mn=>mn.supports(fe)),!nt)throw new M.vHH(5101,!1);return this._eventNameToPlugin.set(fe,nt),nt}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(Ae),M.LFG(M.R0b))},se.\u0275prov=M.Yz7({token:se,factory:se.\u0275fac}),ce})();class Qe{constructor(ce){this._doc=ce}}const ot="ng-app-id";let mt=(()=>{var se;class ce{constructor(fe,nt,Ft,mn={}){this.doc=fe,this.appId=nt,this.nonce=Ft,this.platformId=mn,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,w.PM)(mn),this.resetHostNodes()}addStyles(fe){for(const nt of fe)1===this.changeUsageCount(nt,1)&&this.onStyleAdded(nt)}removeStyles(fe){for(const nt of fe)this.changeUsageCount(nt,-1)<=0&&this.onStyleRemoved(nt)}ngOnDestroy(){const fe=this.styleNodesInDOM;fe&&(fe.forEach(nt=>nt.remove()),fe.clear());for(const nt of this.getAllStyles())this.onStyleRemoved(nt);this.resetHostNodes()}addHost(fe){this.hostNodes.add(fe);for(const nt of this.getAllStyles())this.addStyleToHost(fe,nt)}removeHost(fe){this.hostNodes.delete(fe)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(fe){for(const nt of this.hostNodes)this.addStyleToHost(nt,fe)}onStyleRemoved(fe){const nt=this.styleRef;nt.get(fe)?.elements?.forEach(Ft=>Ft.remove()),nt.delete(fe)}collectServerRenderedStyles(){const fe=this.doc.head?.querySelectorAll(`style[${ot}="${this.appId}"]`);if(fe?.length){const nt=new Map;return fe.forEach(Ft=>{null!=Ft.textContent&&nt.set(Ft.textContent,Ft)}),nt}return null}changeUsageCount(fe,nt){const Ft=this.styleRef;if(Ft.has(fe)){const mn=Ft.get(fe);return mn.usage+=nt,mn.usage}return Ft.set(fe,{usage:nt,elements:[]}),nt}getStyleElement(fe,nt){const Ft=this.styleNodesInDOM,mn=Ft?.get(nt);if(mn?.parentNode===fe)return Ft.delete(nt),mn.removeAttribute(ot),mn;{const Zn=this.doc.createElement("style");return this.nonce&&Zn.setAttribute("nonce",this.nonce),Zn.textContent=nt,this.platformIsServer&&Zn.setAttribute(ot,this.appId),Zn}}addStyleToHost(fe,nt){const Ft=this.getStyleElement(fe,nt);fe.appendChild(Ft);const mn=this.styleRef,Zn=mn.get(nt)?.elements;Zn?Zn.push(Ft):mn.set(nt,{elements:[Ft],usage:1})}resetHostNodes(){const fe=this.hostNodes;fe.clear(),fe.add(this.doc.head)}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(w.K0),M.LFG(M.AFp),M.LFG(M.Ojb,8),M.LFG(M.Lbi))},se.\u0275prov=M.Yz7({token:se,factory:se.\u0275fac}),ce})();const xt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},pt=/%COMP%/g,Ie=new M.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Ye(se,ce){return ce.map(Fe=>Fe.replace(pt,se))}let gt=(()=>{var se;class ce{constructor(fe,nt,Ft,mn,Zn,Gn,dr,yr=null){this.eventManager=fe,this.sharedStylesHost=nt,this.appId=Ft,this.removeStylesOnCompDestroy=mn,this.doc=Zn,this.platformId=Gn,this.ngZone=dr,this.nonce=yr,this.rendererByCompId=new Map,this.platformIsServer=(0,w.PM)(Gn),this.defaultRenderer=new Wt(fe,Zn,dr,this.platformIsServer)}createRenderer(fe,nt){if(!fe||!nt)return this.defaultRenderer;this.platformIsServer&&nt.encapsulation===M.ifc.ShadowDom&&(nt={...nt,encapsulation:M.ifc.Emulated});const Ft=this.getOrCreateRenderer(fe,nt);return Ft instanceof Zt?Ft.applyToHost(fe):Ft instanceof Jn&&Ft.applyStyles(),Ft}getOrCreateRenderer(fe,nt){const Ft=this.rendererByCompId;let mn=Ft.get(nt.id);if(!mn){const Zn=this.doc,Gn=this.ngZone,dr=this.eventManager,yr=this.sharedStylesHost,Hr=this.removeStylesOnCompDestroy,ti=this.platformIsServer;switch(nt.encapsulation){case M.ifc.Emulated:mn=new Zt(dr,yr,nt,this.appId,Hr,Zn,Gn,ti);break;case M.ifc.ShadowDom:return new Vt(dr,yr,fe,nt,Zn,Gn,this.nonce,ti);default:mn=new Jn(dr,yr,nt,Hr,Zn,Gn,ti)}Ft.set(nt.id,mn)}return mn}ngOnDestroy(){this.rendererByCompId.clear()}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(Ze),M.LFG(mt),M.LFG(M.AFp),M.LFG(Ie),M.LFG(w.K0),M.LFG(M.Lbi),M.LFG(M.R0b),M.LFG(M.Ojb))},se.\u0275prov=M.Yz7({token:se,factory:se.\u0275fac}),ce})();class Wt{constructor(ce,Fe,fe,nt){this.eventManager=ce,this.doc=Fe,this.ngZone=fe,this.platformIsServer=nt,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(ce,Fe){return Fe?this.doc.createElementNS(xt[Fe]||Fe,ce):this.doc.createElement(ce)}createComment(ce){return this.doc.createComment(ce)}createText(ce){return this.doc.createTextNode(ce)}appendChild(ce,Fe){(Qt(ce)?ce.content:ce).appendChild(Fe)}insertBefore(ce,Fe,fe){ce&&(Qt(ce)?ce.content:ce).insertBefore(Fe,fe)}removeChild(ce,Fe){ce&&ce.removeChild(Fe)}selectRootElement(ce,Fe){let fe="string"==typeof ce?this.doc.querySelector(ce):ce;if(!fe)throw new M.vHH(-5104,!1);return Fe||(fe.textContent=""),fe}parentNode(ce){return ce.parentNode}nextSibling(ce){return ce.nextSibling}setAttribute(ce,Fe,fe,nt){if(nt){Fe=nt+":"+Fe;const Ft=xt[nt];Ft?ce.setAttributeNS(Ft,Fe,fe):ce.setAttribute(Fe,fe)}else ce.setAttribute(Fe,fe)}removeAttribute(ce,Fe,fe){if(fe){const nt=xt[fe];nt?ce.removeAttributeNS(nt,Fe):ce.removeAttribute(`${fe}:${Fe}`)}else ce.removeAttribute(Fe)}addClass(ce,Fe){ce.classList.add(Fe)}removeClass(ce,Fe){ce.classList.remove(Fe)}setStyle(ce,Fe,fe,nt){nt&(M.JOm.DashCase|M.JOm.Important)?ce.style.setProperty(Fe,fe,nt&M.JOm.Important?"important":""):ce.style[Fe]=fe}removeStyle(ce,Fe,fe){fe&M.JOm.DashCase?ce.style.removeProperty(Fe):ce.style[Fe]=""}setProperty(ce,Fe,fe){ce[Fe]=fe}setValue(ce,Fe){ce.nodeValue=Fe}listen(ce,Fe,fe){if("string"==typeof ce&&!(ce=(0,w.q)().getGlobalEventTarget(this.doc,ce)))throw new Error(`Unsupported event target ${ce} for event ${Fe}`);return this.eventManager.addEventListener(ce,Fe,this.decoratePreventDefault(fe))}decoratePreventDefault(ce){return Fe=>{if("__ngUnwrap__"===Fe)return ce;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>ce(Fe)):ce(Fe))&&Fe.preventDefault()}}}function Qt(se){return"TEMPLATE"===se.tagName&&void 0!==se.content}class Vt extends Wt{constructor(ce,Fe,fe,nt,Ft,mn,Zn,Gn){super(ce,Ft,mn,Gn),this.sharedStylesHost=Fe,this.hostEl=fe,this.shadowRoot=fe.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const dr=Ye(nt.id,nt.styles);for(const yr of dr){const Hr=document.createElement("style");Zn&&Hr.setAttribute("nonce",Zn),Hr.textContent=yr,this.shadowRoot.appendChild(Hr)}}nodeOrShadowRoot(ce){return ce===this.hostEl?this.shadowRoot:ce}appendChild(ce,Fe){return super.appendChild(this.nodeOrShadowRoot(ce),Fe)}insertBefore(ce,Fe,fe){return super.insertBefore(this.nodeOrShadowRoot(ce),Fe,fe)}removeChild(ce,Fe){return super.removeChild(this.nodeOrShadowRoot(ce),Fe)}parentNode(ce){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ce)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Jn extends Wt{constructor(ce,Fe,fe,nt,Ft,mn,Zn,Gn){super(ce,Ft,mn,Zn),this.sharedStylesHost=Fe,this.removeStylesOnCompDestroy=nt,this.styles=Gn?Ye(Gn,fe.styles):fe.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Zt extends Jn{constructor(ce,Fe,fe,nt,Ft,mn,Zn,Gn){const dr=nt+"-"+fe.id;super(ce,Fe,fe,Ft,mn,Zn,Gn,dr),this.contentAttr=function ct(se){return"_ngcontent-%COMP%".replace(pt,se)}(dr),this.hostAttr=function St(se){return"_nghost-%COMP%".replace(pt,se)}(dr)}applyToHost(ce){this.applyStyles(),this.setAttribute(ce,this.hostAttr,"")}createElement(ce,Fe){const fe=super.createElement(ce,Fe);return super.setAttribute(fe,this.contentAttr,""),fe}}let Pn=(()=>{var se;class ce extends Qe{constructor(fe){super(fe)}supports(fe){return!0}addEventListener(fe,nt,Ft){return fe.addEventListener(nt,Ft,!1),()=>this.removeEventListener(fe,nt,Ft)}removeEventListener(fe,nt,Ft){return fe.removeEventListener(nt,Ft)}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(w.K0))},se.\u0275prov=M.Yz7({token:se,factory:se.\u0275fac}),ce})();const zt=["alt","control","meta","shift"],Se={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ze={alt:se=>se.altKey,control:se=>se.ctrlKey,meta:se=>se.metaKey,shift:se=>se.shiftKey};let ut=(()=>{var se;class ce extends Qe{constructor(fe){super(fe)}supports(fe){return null!=ce.parseEventName(fe)}addEventListener(fe,nt,Ft){const mn=ce.parseEventName(nt),Zn=ce.eventCallback(mn.fullKey,Ft,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,w.q)().onAndCancel(fe,mn.domEventName,Zn))}static parseEventName(fe){const nt=fe.toLowerCase().split("."),Ft=nt.shift();if(0===nt.length||"keydown"!==Ft&&"keyup"!==Ft)return null;const mn=ce._normalizeKey(nt.pop());let Zn="",Gn=nt.indexOf("code");if(Gn>-1&&(nt.splice(Gn,1),Zn="code."),zt.forEach(yr=>{const Hr=nt.indexOf(yr);Hr>-1&&(nt.splice(Hr,1),Zn+=yr+".")}),Zn+=mn,0!=nt.length||0===mn.length)return null;const dr={};return dr.domEventName=Ft,dr.fullKey=Zn,dr}static matchEventFullKeyCode(fe,nt){let Ft=Se[fe.key]||fe.key,mn="";return nt.indexOf("code.")>-1&&(Ft=fe.code,mn="code."),!(null==Ft||!Ft)&&(Ft=Ft.toLowerCase()," "===Ft?Ft="space":"."===Ft&&(Ft="dot"),zt.forEach(Zn=>{Zn!==Ft&&(0,ze[Zn])(fe)&&(mn+=Zn+".")}),mn+=Ft,mn===nt)}static eventCallback(fe,nt,Ft){return mn=>{ce.matchEventFullKeyCode(mn,fe)&&Ft.runGuarded(()=>nt(mn))}}static _normalizeKey(fe){return"esc"===fe?"escape":fe}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(w.K0))},se.\u0275prov=M.Yz7({token:se,factory:se.\u0275fac}),ce})();const en=(0,M.eFA)(M._c5,"browser",[{provide:M.Lbi,useValue:w.bD},{provide:M.g9A,useValue:function _n(){l.makeCurrent()},multi:!0},{provide:w.K0,useFactory:function rn(){return(0,M.RDi)(document),document},deps:[]}]),dn=new M.OlP(""),Fn=[{provide:M.rWj,useClass:class Ke{addToWindow(ce){M.dqk.getAngularTestability=(fe,nt=!0)=>{const Ft=ce.findTestabilityInTree(fe,nt);if(null==Ft)throw new M.vHH(5103,!1);return Ft},M.dqk.getAllAngularTestabilities=()=>ce.getAllTestabilities(),M.dqk.getAllAngularRootElements=()=>ce.getAllRootElements(),M.dqk.frameworkStabilizers||(M.dqk.frameworkStabilizers=[]),M.dqk.frameworkStabilizers.push(fe=>{const nt=M.dqk.getAllAngularTestabilities();let Ft=nt.length,mn=!1;const Zn=function(Gn){mn=mn||Gn,Ft--,0==Ft&&fe(mn)};nt.forEach(Gn=>{Gn.whenStable(Zn)})})}findTestabilityInTree(ce,Fe,fe){return null==Fe?null:ce.getTestability(Fe)??(fe?(0,w.q)().isShadowRoot(Fe)?this.findTestabilityInTree(ce,Fe.host,!0):this.findTestabilityInTree(ce,Fe.parentElement,!0):null)}},deps:[]},{provide:M.lri,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]},{provide:M.dDg,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]}],pr=[{provide:M.zSh,useValue:"root"},{provide:M.qLn,useFactory:function bn(){return new M.qLn},deps:[]},{provide:Ae,useClass:Pn,multi:!0,deps:[w.K0,M.R0b,M.Lbi]},{provide:Ae,useClass:ut,multi:!0,deps:[w.K0]},gt,mt,Ze,{provide:M.FYo,useExisting:gt},{provide:w.JF,useClass:ye,deps:[]},[]];let nr=(()=>{var se;class ce{constructor(fe){}static withServerTransition(fe){return{ngModule:ce,providers:[{provide:M.AFp,useValue:fe.appId}]}}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(dn,12))},se.\u0275mod=M.oAB({type:se}),se.\u0275inj=M.cJS({providers:[...pr,...Fn],imports:[w.ez,M.hGG]}),ce})(),Jr=(()=>{var se;class ce{constructor(fe){this._doc=fe}getTitle(){return this._doc.title}setTitle(fe){this._doc.title=fe||""}}return(se=ce).\u0275fac=function(fe){return new(fe||se)(M.LFG(w.K0))},se.\u0275prov=M.Yz7({token:se,factory:function(fe){let nt=null;return nt=fe?new fe:function yn(){return new Jr((0,M.LFG)(w.K0))}(),nt},providedIn:"root"}),ce})();typeof window<"u"&&window},1160:(Hn,It,X)=>{"use strict";X.d(It,{gz:()=>Ji,y6:()=>kr,OD:()=>Yo,eC:()=>ln,wm:()=>or,wN:()=>vn,F0:()=>qi,rH:()=>Cs,Bz:()=>Ts,Hx:()=>yi});var M=X(5879),w=X(5592),lt=X(4674),_e=X(2459),Ne=X(2096),Le=X(5619),tt=X(2572),Ke=X(6973),ye=X(5211),Ae=X(4911),Ze=X(8407);function Qe(L,N){const H=(0,lt.m)(L)?L:()=>L,v=g=>g.error(H());return new w.y(N?g=>N.schedule(v,0,g):v)}var ot=X(6232),mt=X(7394),xt=X(9360),pt=X(8251);function et(){return(0,xt.e)((L,N)=>{let H=null;L._refCount++;const v=(0,pt.x)(N,void 0,void 0,void 0,()=>{if(!L||L._refCount<=0||0<--L._refCount)return void(H=null);const g=L._connection,E=H;H=null,g&&(!E||g===E)&&g.unsubscribe(),N.unsubscribe()});L.subscribe(v),v.closed||(H=L.connect())})}class Ot extends w.y{constructor(N,H){super(),this.source=N,this.subjectFactory=H,this._subject=null,this._refCount=0,this._connection=null,(0,xt.A)(N)&&(this.lift=N.lift)}_subscribe(N){return this.getSubject().subscribe(N)}getSubject(){const N=this._subject;return(!N||N.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:N}=this;this._subject=this._connection=null,N?.unsubscribe()}connect(){let N=this._connection;if(!N){N=this._connection=new mt.w0;const H=this.getSubject();N.add(this.source.subscribe((0,pt.x)(H,void 0,()=>{this._teardown(),H.complete()},v=>{this._teardown(),H.error(v)},()=>this._teardown()))),N.closed&&(this._connection=null,N=mt.w0.EMPTY)}return N}refCount(){return et()(this)}}var Pt=X(8645),Ce=X(6814),Ie=X(7398),ct=X(4664),St=X(8180),Ye=X(7921),gt=X(2181),Wt=X(1631),Nt=X(1374),an=X(6328),Qt=X(9397),Vt=X(6306),Jn=X(6699),Zt=X(3572);function Pn(L){return L<=0?()=>ot.E:(0,xt.e)((N,H)=>{let v=[];N.subscribe((0,pt.x)(H,g=>{v.push(g),L<v.length&&v.shift()},()=>{for(const g of v)H.next(g);H.complete()},void 0,()=>{v=null}))})}var zt=X(3026),Se=X(2737),Dt=X(4716),jt=X(7537),nn=X(6593);const ln="primary",_n=Symbol("RouteTitle");class bn{constructor(N){this.params=N||{}}has(N){return Object.prototype.hasOwnProperty.call(this.params,N)}get(N){if(this.has(N)){const H=this.params[N];return Array.isArray(H)?H[0]:H}return null}getAll(N){if(this.has(N)){const H=this.params[N];return Array.isArray(H)?H:[H]}return[]}get keys(){return Object.keys(this.params)}}function rn(L){return new bn(L)}function Jt(L,N,H){const v=H.path.split("/");if(v.length>L.length||"full"===H.pathMatch&&(N.hasChildren()||v.length<L.length))return null;const g={};for(let E=0;E<v.length;E++){const S=v[E],$=L[E];if(S.startsWith(":"))g[S.substring(1)]=$;else if(S!==$.path)return null}return{consumed:L.slice(0,v.length),posParams:g}}function dn(L,N){const H=L?Object.keys(L):void 0,v=N?Object.keys(N):void 0;if(!H||!v||H.length!=v.length)return!1;let g;for(let E=0;E<H.length;E++)if(g=H[E],!Fn(L[g],N[g]))return!1;return!0}function Fn(L,N){if(Array.isArray(L)&&Array.isArray(N)){if(L.length!==N.length)return!1;const H=[...L].sort(),v=[...N].sort();return H.every((g,E)=>v[E]===g)}return L===N}function pr(L){return L.length>0?L[L.length-1]:null}function nr(L){return function l(L){return!!L&&(L instanceof w.y||(0,lt.m)(L.lift)&&(0,lt.m)(L.subscribe))}(L)?L:(0,M.QGY)(L)?(0,_e.D)(Promise.resolve(L)):(0,Ne.of)(L)}const gr={exact:function Jr(L,N,H){if(!Tr(L.segments,N.segments)||!wr(L.segments,N.segments,H)||L.numberOfChildren!==N.numberOfChildren)return!1;for(const v in N.children)if(!L.children[v]||!Jr(L.children[v],N.children[v],H))return!1;return!0},subset:ui},Xn={exact:function yn(L,N){return dn(L,N)},subset:function Li(L,N){return Object.keys(N).length<=Object.keys(L).length&&Object.keys(N).every(H=>Fn(L[H],N[H]))},ignored:()=>!0};function Lr(L,N,H){return gr[H.paths](L.root,N.root,H.matrixParams)&&Xn[H.queryParams](L.queryParams,N.queryParams)&&!("exact"===H.fragment&&L.fragment!==N.fragment)}function ui(L,N,H){return hr(L,N,N.segments,H)}function hr(L,N,H,v){if(L.segments.length>H.length){const g=L.segments.slice(0,H.length);return!(!Tr(g,H)||N.hasChildren()||!wr(g,H,v))}if(L.segments.length===H.length){if(!Tr(L.segments,H)||!wr(L.segments,H,v))return!1;for(const g in N.children)if(!L.children[g]||!ui(L.children[g],N.children[g],v))return!1;return!0}{const g=H.slice(0,L.segments.length),E=H.slice(L.segments.length);return!!(Tr(L.segments,g)&&wr(L.segments,g,v)&&L.children[ln])&&hr(L.children[ln],N,E,v)}}function wr(L,N,H){return N.every((v,g)=>Xn[H](L[g].parameters,v.parameters))}class _r{constructor(N=new mr([],{}),H={},v=null){this.root=N,this.queryParams=H,this.fragment=v}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=rn(this.queryParams)),this._queryParamMap}toString(){return Do.serialize(this)}}class mr{constructor(N,H){this.segments=N,this.children=H,this.parent=null,Object.values(H).forEach(v=>v.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Or(this)}}class Di{constructor(N,H){this.path=N,this.parameters=H}get parameterMap(){return this._parameterMap||(this._parameterMap=rn(this.parameters)),this._parameterMap}toString(){return Mt(this)}}function Tr(L,N){return L.length===N.length&&L.every((H,v)=>H.path===N[v].path)}let yi=(()=>{var L;class N{}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:function(){return new Yr},providedIn:"root"}),N})();class Yr{parse(N){const H=new Ft(N);return new _r(H.parseRootSegment(),H.parseQueryParams(),H.parseFragment())}serialize(N){const H=`/${Co(N.root,!0)}`,v=function _t(L){const N=Object.keys(L).map(H=>{const v=L[H];return Array.isArray(v)?v.map(g=>`${ue(H)}=${ue(g)}`).join("&"):`${ue(H)}=${ue(v)}`}).filter(H=>!!H);return N.length?`?${N.join("&")}`:""}(N.queryParams);return`${H}${v}${"string"==typeof N.fragment?`#${function pe(L){return encodeURI(L)}(N.fragment)}`:""}`}}const Do=new Yr;function Or(L){return L.segments.map(N=>Mt(N)).join("/")}function Co(L,N){if(!L.hasChildren())return Or(L);if(N){const H=L.children[ln]?Co(L.children[ln],!1):"",v=[];return Object.entries(L.children).forEach(([g,E])=>{g!==ln&&v.push(`${g}:${Co(E,!1)}`)}),v.length>0?`${H}(${v.join("//")})`:H}{const H=function Mi(L,N){let H=[];return Object.entries(L.children).forEach(([v,g])=>{v===ln&&(H=H.concat(N(g,v)))}),Object.entries(L.children).forEach(([v,g])=>{v!==ln&&(H=H.concat(N(g,v)))}),H}(L,(v,g)=>g===ln?[Co(L.children[ln],!1)]:[`${g}:${Co(v,!1)}`]);return 1===Object.keys(L.children).length&&null!=L.children[ln]?`${Or(L)}/${H[0]}`:`${Or(L)}/(${H.join("//")})`}}function Xe(L){return encodeURIComponent(L).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ue(L){return Xe(L).replace(/%3B/gi,";")}function He(L){return Xe(L).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function at(L){return decodeURIComponent(L)}function yt(L){return at(L.replace(/\+/g,"%20"))}function Mt(L){return`${He(L.path)}${function At(L){return Object.keys(L).map(N=>`;${He(N)}=${He(L[N])}`).join("")}(L.parameters)}`}const Bt=/^[^\/()?;#]+/;function pn(L){const N=L.match(Bt);return N?N[0]:""}const ke=/^[^\/()?;=#]+/,ce=/^[^=?&#]+/,fe=/^[^&#]+/;class Ft{constructor(N){this.url=N,this.remaining=N}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new mr([],{}):new mr([],this.parseChildren())}parseQueryParams(){const N={};if(this.consumeOptional("?"))do{this.parseQueryParam(N)}while(this.consumeOptional("&"));return N}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const N=[];for(this.peekStartsWith("(")||N.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),N.push(this.parseSegment());let H={};this.peekStartsWith("/(")&&(this.capture("/"),H=this.parseParens(!0));let v={};return this.peekStartsWith("(")&&(v=this.parseParens(!1)),(N.length>0||Object.keys(H).length>0)&&(v[ln]=new mr(N,H)),v}parseSegment(){const N=pn(this.remaining);if(""===N&&this.peekStartsWith(";"))throw new M.vHH(4009,!1);return this.capture(N),new Di(at(N),this.parseMatrixParams())}parseMatrixParams(){const N={};for(;this.consumeOptional(";");)this.parseParam(N);return N}parseParam(N){const H=function se(L){const N=L.match(ke);return N?N[0]:""}(this.remaining);if(!H)return;this.capture(H);let v="";if(this.consumeOptional("=")){const g=pn(this.remaining);g&&(v=g,this.capture(v))}N[at(H)]=at(v)}parseQueryParam(N){const H=function Fe(L){const N=L.match(ce);return N?N[0]:""}(this.remaining);if(!H)return;this.capture(H);let v="";if(this.consumeOptional("=")){const S=function nt(L){const N=L.match(fe);return N?N[0]:""}(this.remaining);S&&(v=S,this.capture(v))}const g=yt(H),E=yt(v);if(N.hasOwnProperty(g)){let S=N[g];Array.isArray(S)||(S=[S],N[g]=S),S.push(E)}else N[g]=E}parseParens(N){const H={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const v=pn(this.remaining),g=this.remaining[v.length];if("/"!==g&&")"!==g&&";"!==g)throw new M.vHH(4010,!1);let E;v.indexOf(":")>-1?(E=v.slice(0,v.indexOf(":")),this.capture(E),this.capture(":")):N&&(E=ln);const S=this.parseChildren();H[E]=1===Object.keys(S).length?S[ln]:new mr([],S),this.consumeOptional("//")}return H}peekStartsWith(N){return this.remaining.startsWith(N)}consumeOptional(N){return!!this.peekStartsWith(N)&&(this.remaining=this.remaining.substring(N.length),!0)}capture(N){if(!this.consumeOptional(N))throw new M.vHH(4011,!1)}}function mn(L){return L.segments.length>0?new mr([],{[ln]:L}):L}function Zn(L){const N={};for(const v of Object.keys(L.children)){const E=Zn(L.children[v]);if(v===ln&&0===E.segments.length&&E.hasChildren())for(const[S,$]of Object.entries(E.children))N[S]=$;else(E.segments.length>0||E.hasChildren())&&(N[v]=E)}return function Gn(L){if(1===L.numberOfChildren&&L.children[ln]){const N=L.children[ln];return new mr(L.segments.concat(N.segments),N.children)}return L}(new mr(L.segments,N))}function dr(L){return L instanceof _r}function Hr(L){let N;const g=mn(function H(E){const S={};for(const te of E.children){const ve=H(te);S[te.outlet]=ve}const $=new mr(E.url,S);return E===L&&(N=$),$}(L.root));return N??g}function ti(L,N,H,v){let g=L;for(;g.parent;)g=g.parent;if(0===N.length)return Kt(g,g,g,H,v);const E=function cr(L){if("string"==typeof L[0]&&1===L.length&&"/"===L[0])return new wn(!0,0,L);let N=0,H=!1;const v=L.reduce((g,E,S)=>{if("object"==typeof E&&null!=E){if(E.outlets){const $={};return Object.entries(E.outlets).forEach(([te,ve])=>{$[te]="string"==typeof ve?ve.split("/"):ve}),[...g,{outlets:$}]}if(E.segmentPath)return[...g,E.segmentPath]}return"string"!=typeof E?[...g,E]:0===S?(E.split("/").forEach(($,te)=>{0==te&&"."===$||(0==te&&""===$?H=!0:".."===$?N++:""!=$&&g.push($))}),g):[...g,E]},[]);return new wn(H,N,v)}(N);if(E.toRoot())return Kt(g,g,new mr([],{}),H,v);const S=function Rr(L,N,H){if(L.isAbsolute)return new qn(N,!0,0);if(!H)return new qn(N,!1,NaN);if(null===H.parent)return new qn(H,!0,0);const v=no(L.commands[0])?0:1;return function Fr(L,N,H){let v=L,g=N,E=H;for(;E>g;){if(E-=g,v=v.parent,!v)throw new M.vHH(4005,!1);g=v.segments.length}return new qn(v,!1,g-E)}(H,H.segments.length-1+v,L.numberOfDoubleDots)}(E,g,L),$=S.processChildren?Qr(S.segmentGroup,S.index,E.commands):Ci(S.segmentGroup,S.index,E.commands);return Kt(g,S.segmentGroup,$,H,v)}function no(L){return"object"==typeof L&&null!=L&&!L.outlets&&!L.segmentPath}function Bo(L){return"object"==typeof L&&null!=L&&L.outlets}function Kt(L,N,H,v,g){let S,E={};v&&Object.entries(v).forEach(([te,ve])=>{E[te]=Array.isArray(ve)?ve.map(me=>`${me}`):`${ve}`}),S=L===N?H:Et(L,N,H);const $=mn(Zn(S));return new _r($,E,g)}function Et(L,N,H){const v={};return Object.entries(L.children).forEach(([g,E])=>{v[g]=E===N?H:Et(E,N,H)}),new mr(L.segments,v)}class wn{constructor(N,H,v){if(this.isAbsolute=N,this.numberOfDoubleDots=H,this.commands=v,N&&v.length>0&&no(v[0]))throw new M.vHH(4003,!1);const g=v.find(Bo);if(g&&g!==pr(v))throw new M.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class qn{constructor(N,H,v){this.segmentGroup=N,this.processChildren=H,this.index=v}}function Ci(L,N,H){if(L||(L=new mr([],{})),0===L.segments.length&&L.hasChildren())return Qr(L,N,H);const v=function li(L,N,H){let v=0,g=N;const E={match:!1,pathIndex:0,commandIndex:0};for(;g<L.segments.length;){if(v>=H.length)return E;const S=L.segments[g],$=H[v];if(Bo($))break;const te=`${$}`,ve=v<H.length-1?H[v+1]:null;if(g>0&&void 0===te)break;if(te&&ve&&"object"==typeof ve&&void 0===ve.outlets){if(!ro(te,ve,S))return E;v+=2}else{if(!ro(te,{},S))return E;v++}g++}return{match:!0,pathIndex:g,commandIndex:v}}(L,N,H),g=H.slice(v.commandIndex);if(v.match&&v.pathIndex<L.segments.length){const E=new mr(L.segments.slice(0,v.pathIndex),{});return E.children[ln]=new mr(L.segments.slice(v.pathIndex),L.children),Qr(E,0,g)}return v.match&&0===g.length?new mr(L.segments,{}):v.match&&!L.hasChildren()?Gr(L,N,H):v.match?Qr(L,0,g):Gr(L,N,H)}function Qr(L,N,H){if(0===H.length)return new mr(L.segments,{});{const v=function di(L){return Bo(L[0])?L[0].outlets:{[ln]:L}}(H),g={};if(!v[ln]&&L.children[ln]&&1===L.numberOfChildren&&0===L.children[ln].segments.length){const E=Qr(L.children[ln],N,H);return new mr(L.segments,E.children)}return Object.entries(v).forEach(([E,S])=>{"string"==typeof S&&(S=[S]),null!==S&&(g[E]=Ci(L.children[E],N,S))}),Object.entries(L.children).forEach(([E,S])=>{void 0===v[E]&&(g[E]=S)}),new mr(L.segments,g)}}function Gr(L,N,H){const v=L.segments.slice(0,N);let g=0;for(;g<H.length;){const E=H[g];if(Bo(E)){const te=Es(E.outlets);return new mr(v,te)}if(0===g&&no(H[0])){v.push(new Di(L.segments[N].path,on(H[0]))),g++;continue}const S=Bo(E)?E.outlets[ln]:`${E}`,$=g<H.length-1?H[g+1]:null;S&&$&&no($)?(v.push(new Di(S,on($))),g+=2):(v.push(new Di(S,{})),g++)}return new mr(v,{})}function Es(L){const N={};return Object.entries(L).forEach(([H,v])=>{"string"==typeof v&&(v=[v]),null!==v&&(N[H]=Gr(new mr([],{}),0,v))}),N}function on(L){const N={};return Object.entries(L).forEach(([H,v])=>N[H]=`${v}`),N}function ro(L,N,H){return L==H.path&&dn(N,H.parameters)}const bi="imperative";class ii{constructor(N,H){this.id=N,this.url=H}}class Yo extends ii{constructor(N,H,v="imperative",g=null){super(N,H),this.type=0,this.navigationTrigger=v,this.restoredState=g}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class zi extends ii{constructor(N,H,v){super(N,H),this.urlAfterRedirects=v,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ss extends ii{constructor(N,H,v,g){super(N,H),this.reason=v,this.code=g,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Po extends ii{constructor(N,H,v,g){super(N,H),this.reason=v,this.code=g,this.type=16}}class No extends ii{constructor(N,H,v,g){super(N,H),this.error=v,this.target=g,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Wn extends ii{constructor(N,H,v,g){super(N,H),this.urlAfterRedirects=v,this.state=g,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dr extends ii{constructor(N,H,v,g){super(N,H),this.urlAfterRedirects=v,this.state=g,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class he extends ii{constructor(N,H,v,g,E){super(N,H),this.urlAfterRedirects=v,this.state=g,this.shouldActivate=E,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class $e extends ii{constructor(N,H,v,g){super(N,H),this.urlAfterRedirects=v,this.state=g,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class we extends ii{constructor(N,H,v,g){super(N,H),this.urlAfterRedirects=v,this.state=g,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Be{constructor(N){this.route=N,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ct{constructor(N){this.route=N,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class kt{constructor(N){this.snapshot=N,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cn{constructor(N){this.snapshot=N,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gn{constructor(N){this.snapshot=N,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class un{constructor(N){this.snapshot=N,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class In{constructor(N,H,v){this.routerEvent=N,this.position=H,this.anchor=v,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Cr{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new kr,this.attachRef=null}}let kr=(()=>{var L;class N{constructor(){this.contexts=new Map}onChildOutletCreated(v,g){const E=this.getOrCreateContext(v);E.outlet=g,this.contexts.set(v,E)}onChildOutletDestroyed(v){const g=this.getContext(v);g&&(g.outlet=null,g.attachRef=null)}onOutletDeactivated(){const v=this.contexts;return this.contexts=new Map,v}onOutletReAttached(v){this.contexts=v}getOrCreateContext(v){let g=this.getContext(v);return g||(g=new Cr,this.contexts.set(v,g)),g}getContext(v){return this.contexts.get(v)||null}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})();class wi{constructor(N){this._root=N}get root(){return this._root.value}parent(N){const H=this.pathFromRoot(N);return H.length>1?H[H.length-2]:null}children(N){const H=io(N,this._root);return H?H.children.map(v=>v.value):[]}firstChild(N){const H=io(N,this._root);return H&&H.children.length>0?H.children[0].value:null}siblings(N){const H=Hi(N,this._root);return H.length<2?[]:H[H.length-2].children.map(g=>g.value).filter(g=>g!==N)}pathFromRoot(N){return Hi(N,this._root).map(H=>H.value)}}function io(L,N){if(L===N.value)return N;for(const H of N.children){const v=io(L,H);if(v)return v}return null}function Hi(L,N){if(L===N.value)return[N];for(const H of N.children){const v=Hi(L,H);if(v.length)return v.unshift(N),v}return[]}class Ki{constructor(N,H){this.value=N,this.children=H}toString(){return`TreeNode(${this.value})`}}function Pi(L){const N={};return L&&L.children.forEach(H=>N[H.value.outlet]=H),N}class To extends wi{constructor(N,H){super(N),this.snapshot=H,as(this,N)}toString(){return this.snapshot.toString()}}function Vr(L,N){const H=function qr(L,N){const S=new So([],{},{},"",{},ln,N,null,{});return new Ks("",new Ki(S,[]))}(0,N),v=new Le.X([new Di("",{})]),g=new Le.X({}),E=new Le.X({}),S=new Le.X({}),$=new Le.X(""),te=new Ji(v,g,S,$,E,ln,N,H.root);return te.snapshot=H.root,new To(new Ki(te,[]),H)}class Ji{constructor(N,H,v,g,E,S,$,te){this.urlSubject=N,this.paramsSubject=H,this.queryParamsSubject=v,this.fragmentSubject=g,this.dataSubject=E,this.outlet=S,this.component=$,this._futureSnapshot=te,this.title=this.dataSubject?.pipe((0,Ie.U)(ve=>ve[_n]))??(0,Ne.of)(void 0),this.url=N,this.params=H,this.queryParams=v,this.fragment=g,this.data=E}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ie.U)(N=>rn(N)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ie.U)(N=>rn(N)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ps(L,N="emptyOnly"){const H=L.pathFromRoot;let v=0;if("always"!==N)for(v=H.length-1;v>=1;){const g=H[v],E=H[v-1];if(g.routeConfig&&""===g.routeConfig.path)v--;else{if(E.component)break;v--}}return function Ai(L){return L.reduce((N,H)=>({params:{...N.params,...H.params},data:{...N.data,...H.data},resolve:{...H.data,...N.resolve,...H.routeConfig?.data,...H._resolvedData}}),{params:{},data:{},resolve:{}})}(H.slice(v))}class So{get title(){return this.data?.[_n]}constructor(N,H,v,g,E,S,$,te,ve){this.url=N,this.params=H,this.queryParams=v,this.fragment=g,this.data=E,this.outlet=S,this.component=$,this.routeConfig=te,this._resolve=ve}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=rn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=rn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(v=>v.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ks extends wi{constructor(N,H){super(H),this.url=N,as(this,H)}toString(){return Bi(this._root)}}function as(L,N){N.value._routerState=L,N.children.forEach(H=>as(L,H))}function Bi(L){const N=L.children.length>0?` { ${L.children.map(Bi).join(", ")} } `:"";return`${L.value}${N}`}function Os(L){if(L.snapshot){const N=L.snapshot,H=L._futureSnapshot;L.snapshot=H,dn(N.queryParams,H.queryParams)||L.queryParamsSubject.next(H.queryParams),N.fragment!==H.fragment&&L.fragmentSubject.next(H.fragment),dn(N.params,H.params)||L.paramsSubject.next(H.params),function en(L,N){if(L.length!==N.length)return!1;for(let H=0;H<L.length;++H)if(!dn(L[H],N[H]))return!1;return!0}(N.url,H.url)||L.urlSubject.next(H.url),dn(N.data,H.data)||L.dataSubject.next(H.data)}else L.snapshot=L._futureSnapshot,L.dataSubject.next(L._futureSnapshot.data)}function Ri(L,N){const H=dn(L.params,N.params)&&function Gi(L,N){return Tr(L,N)&&L.every((H,v)=>dn(H.parameters,N[v].parameters))}(L.url,N.url);return H&&!(!L.parent!=!N.parent)&&(!L.parent||Ri(L.parent,N.parent))}let rr=(()=>{var L;class N{constructor(){this.activated=null,this._activatedRoute=null,this.name=ln,this.activateEvents=new M.vpe,this.deactivateEvents=new M.vpe,this.attachEvents=new M.vpe,this.detachEvents=new M.vpe,this.parentContexts=(0,M.f3M)(kr),this.location=(0,M.f3M)(M.s_b),this.changeDetector=(0,M.f3M)(M.sBO),this.environmentInjector=(0,M.f3M)(M.lqb),this.inputBinder=(0,M.f3M)(Ti,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(v){if(v.name){const{firstChange:g,previousValue:E}=v.name;if(g)return;this.isTrackedInParentContexts(E)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(E)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(v){return this.parentContexts.getContext(v)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const v=this.parentContexts.getContext(this.name);v?.route&&(v.attachRef?this.attach(v.attachRef,v.route):this.activateWith(v.route,v.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new M.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new M.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new M.vHH(4012,!1);this.location.detach();const v=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(v.instance),v}attach(v,g){this.activated=v,this._activatedRoute=g,this.location.insert(v.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(v.instance)}deactivate(){if(this.activated){const v=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(v)}}activateWith(v,g){if(this.isActivated)throw new M.vHH(4013,!1);this._activatedRoute=v;const E=this.location,$=v.snapshot.component,te=this.parentContexts.getOrCreateContext(this.name).children,ve=new vr(v,te,E.injector);this.activated=E.createComponent($,{index:E.length,injector:ve,environmentInjector:g??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275dir=M.lG2({type:L,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[M.TTD]}),N})();class vr{constructor(N,H,v){this.route=N,this.childContexts=H,this.parent=v}get(N,H){return N===Ji?this.route:N===kr?this.childContexts:this.parent.get(N,H)}}const Ti=new M.OlP("");let Io=(()=>{var L;class N{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(v){this.unsubscribeFromRouteData(v),this.subscribeToRouteData(v)}unsubscribeFromRouteData(v){this.outletDataSubscriptions.get(v)?.unsubscribe(),this.outletDataSubscriptions.delete(v)}subscribeToRouteData(v){const{activatedRoute:g}=v,E=(0,tt.a)([g.queryParams,g.params,g.data]).pipe((0,ct.w)(([S,$,te],ve)=>(te={...S,...$,...te},0===ve?(0,Ne.of)(te):Promise.resolve(te)))).subscribe(S=>{if(!v.isActivated||!v.activatedComponentRef||v.activatedRoute!==g||null===g.component)return void this.unsubscribeFromRouteData(v);const $=(0,M.qFp)(g.component);if($)for(const{templateName:te}of $.inputs)v.activatedComponentRef.setInput(te,S[te]);else this.unsubscribeFromRouteData(v)});this.outletDataSubscriptions.set(v,E)}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac}),N})();function Si(L,N,H){if(H&&L.shouldReuseRoute(N.value,H.value.snapshot)){const v=H.value;v._futureSnapshot=N.value;const g=function Ms(L,N,H){return N.children.map(v=>{for(const g of H.children)if(L.shouldReuseRoute(v.value,g.value.snapshot))return Si(L,v,g);return Si(L,v)})}(L,N,H);return new Ki(v,g)}{if(L.shouldAttach(N.value)){const E=L.retrieve(N.value);if(null!==E){const S=E.route;return S.value._futureSnapshot=N.value,S.children=N.children.map($=>Si(L,$)),S}}const v=function Qi(L){return new Ji(new Le.X(L.url),new Le.X(L.params),new Le.X(L.queryParams),new Le.X(L.fragment),new Le.X(L.data),L.outlet,L.component,L)}(N.value),g=N.children.map(E=>Si(L,E));return new Ki(v,g)}}const $o="ngNavigationCancelingError";function Vo(L,N){const{redirectTo:H,navigationBehaviorOptions:v}=dr(N)?{redirectTo:N,navigationBehaviorOptions:void 0}:N,g=Mr(!1,0,N);return g.url=H,g.navigationBehaviorOptions=v,g}function Mr(L,N,H){const v=new Error("NavigationCancelingError: "+(L||""));return v[$o]=!0,v.cancellationCode=N,H&&(v.url=H),v}function ks(L){return ls(L)&&dr(L.url)}function ls(L){return L&&L[$o]}let go=(()=>{var L;class N{}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275cmp=M.Xpm({type:L,selectors:[["ng-component"]],standalone:!0,features:[M.jDz],decls:1,vars:0,template:function(v,g){1&v&&M._UZ(0,"router-outlet")},dependencies:[rr],encapsulation:2}),N})();function ns(L){const N=L.children&&L.children.map(ns),H=N?{...L,children:N}:{...L};return!H.component&&!H.loadComponent&&(N||H.loadChildren)&&H.outlet&&H.outlet!==ln&&(H.component=go),H}function Qn(L){return L.outlet||ln}function As(L){if(!L)return null;if(L.routeConfig?._injector)return L.routeConfig._injector;for(let N=L.parent;N;N=N.parent){const H=N.routeConfig;if(H?._loadedInjector)return H._loadedInjector;if(H?._injector)return H._injector}return null}class js{constructor(N,H,v,g,E){this.routeReuseStrategy=N,this.futureState=H,this.currState=v,this.forwardEvent=g,this.inputBindingEnabled=E}activate(N){const H=this.futureState._root,v=this.currState?this.currState._root:null;this.deactivateChildRoutes(H,v,N),Os(this.futureState.root),this.activateChildRoutes(H,v,N)}deactivateChildRoutes(N,H,v){const g=Pi(H);N.children.forEach(E=>{const S=E.value.outlet;this.deactivateRoutes(E,g[S],v),delete g[S]}),Object.values(g).forEach(E=>{this.deactivateRouteAndItsChildren(E,v)})}deactivateRoutes(N,H,v){const g=N.value,E=H?H.value:null;if(g===E)if(g.component){const S=v.getContext(g.outlet);S&&this.deactivateChildRoutes(N,H,S.children)}else this.deactivateChildRoutes(N,H,v);else E&&this.deactivateRouteAndItsChildren(H,v)}deactivateRouteAndItsChildren(N,H){N.value.component&&this.routeReuseStrategy.shouldDetach(N.value.snapshot)?this.detachAndStoreRouteSubtree(N,H):this.deactivateRouteAndOutlet(N,H)}detachAndStoreRouteSubtree(N,H){const v=H.getContext(N.value.outlet),g=v&&N.value.component?v.children:H,E=Pi(N);for(const S of Object.keys(E))this.deactivateRouteAndItsChildren(E[S],g);if(v&&v.outlet){const S=v.outlet.detach(),$=v.children.onOutletDeactivated();this.routeReuseStrategy.store(N.value.snapshot,{componentRef:S,route:N,contexts:$})}}deactivateRouteAndOutlet(N,H){const v=H.getContext(N.value.outlet),g=v&&N.value.component?v.children:H,E=Pi(N);for(const S of Object.keys(E))this.deactivateRouteAndItsChildren(E[S],g);v&&(v.outlet&&(v.outlet.deactivate(),v.children.onOutletDeactivated()),v.attachRef=null,v.route=null)}activateChildRoutes(N,H,v){const g=Pi(H);N.children.forEach(E=>{this.activateRoutes(E,g[E.value.outlet],v),this.forwardEvent(new un(E.value.snapshot))}),N.children.length&&this.forwardEvent(new cn(N.value.snapshot))}activateRoutes(N,H,v){const g=N.value,E=H?H.value:null;if(Os(g),g===E)if(g.component){const S=v.getOrCreateContext(g.outlet);this.activateChildRoutes(N,H,S.children)}else this.activateChildRoutes(N,H,v);else if(g.component){const S=v.getOrCreateContext(g.outlet);if(this.routeReuseStrategy.shouldAttach(g.snapshot)){const $=this.routeReuseStrategy.retrieve(g.snapshot);this.routeReuseStrategy.store(g.snapshot,null),S.children.onOutletReAttached($.contexts),S.attachRef=$.componentRef,S.route=$.route.value,S.outlet&&S.outlet.attach($.componentRef,$.route.value),Os($.route.value),this.activateChildRoutes(N,null,S.children)}else{const $=As(g.snapshot);S.attachRef=null,S.route=g,S.injector=$,S.outlet&&S.outlet.activateWith(g,S.injector),this.activateChildRoutes(N,null,S.children)}}else this.activateChildRoutes(N,null,v)}}class co{constructor(N){this.path=N,this.route=this.path[this.path.length-1]}}class Mo{constructor(N,H){this.component=N,this.route=H}}function oo(L,N,H){const v=L._root;return Wi(v,N?N._root:null,H,[v.value])}function Fi(L,N){const H=Symbol(),v=N.get(L,H);return v===H?"function"!=typeof L||(0,M.Z0I)(L)?N.get(L):L:v}function Wi(L,N,H,v,g={canDeactivateChecks:[],canActivateChecks:[]}){const E=Pi(N);return L.children.forEach(S=>{(function Hs(L,N,H,v,g={canDeactivateChecks:[],canActivateChecks:[]}){const E=L.value,S=N?N.value:null,$=H?H.getContext(L.value.outlet):null;if(S&&E.routeConfig===S.routeConfig){const te=function gs(L,N,H){if("function"==typeof H)return H(L,N);switch(H){case"pathParamsChange":return!Tr(L.url,N.url);case"pathParamsOrQueryParamsChange":return!Tr(L.url,N.url)||!dn(L.queryParams,N.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ri(L,N)||!dn(L.queryParams,N.queryParams);default:return!Ri(L,N)}}(S,E,E.routeConfig.runGuardsAndResolvers);te?g.canActivateChecks.push(new co(v)):(E.data=S.data,E._resolvedData=S._resolvedData),Wi(L,N,E.component?$?$.children:null:H,v,g),te&&$&&$.outlet&&$.outlet.isActivated&&g.canDeactivateChecks.push(new Mo($.outlet.component,S))}else S&&us(N,$,g),g.canActivateChecks.push(new co(v)),Wi(L,null,E.component?$?$.children:null:H,v,g)})(S,E[S.value.outlet],H,v.concat([S.value]),g),delete E[S.value.outlet]}),Object.entries(E).forEach(([S,$])=>us($,H.getContext(S),g)),g}function us(L,N,H){const v=Pi(L),g=L.value;Object.entries(v).forEach(([E,S])=>{us(S,g.component?N?N.children.getContext(E):null:N,H)}),H.canDeactivateChecks.push(new Mo(g.component&&N&&N.outlet&&N.outlet.isActivated?N.outlet.component:null,g))}function Xo(L){return"function"==typeof L}function En(L){return L instanceof Ke.K||"EmptyError"===L?.name}const ar=Symbol("INITIAL_VALUE");function ir(){return(0,ct.w)(L=>(0,tt.a)(L.map(N=>N.pipe((0,St.q)(1),(0,Ye.O)(ar)))).pipe((0,Ie.U)(N=>{for(const H of N)if(!0!==H){if(H===ar)return ar;if(!1===H||H instanceof _r)return H}return!0}),(0,gt.h)(N=>N!==ar),(0,St.q)(1)))}function Oo(L){return(0,Ze.z)((0,Qt.b)(N=>{if(dr(N))throw Vo(0,N)}),(0,Ie.U)(N=>!0===N))}class is{constructor(N){this.segmentGroup=N||null}}class Ko{constructor(N){this.urlTree=N}}function Ds(L){return Qe(new is(L))}function La(L){return Qe(new Ko(L))}class Vl{constructor(N,H){this.urlSerializer=N,this.urlTree=H}noMatchError(N){return new M.vHH(4002,!1)}lineralizeSegments(N,H){let v=[],g=H.root;for(;;){if(v=v.concat(g.segments),0===g.numberOfChildren)return(0,Ne.of)(v);if(g.numberOfChildren>1||!g.children[ln])return Qe(new M.vHH(4e3,!1));g=g.children[ln]}}applyRedirectCommands(N,H,v){return this.applyRedirectCreateUrlTree(H,this.urlSerializer.parse(H),N,v)}applyRedirectCreateUrlTree(N,H,v,g){const E=this.createSegmentGroup(N,H.root,v,g);return new _r(E,this.createQueryParams(H.queryParams,this.urlTree.queryParams),H.fragment)}createQueryParams(N,H){const v={};return Object.entries(N).forEach(([g,E])=>{if("string"==typeof E&&E.startsWith(":")){const $=E.substring(1);v[g]=H[$]}else v[g]=E}),v}createSegmentGroup(N,H,v,g){const E=this.createSegments(N,H.segments,v,g);let S={};return Object.entries(H.children).forEach(([$,te])=>{S[$]=this.createSegmentGroup(N,te,v,g)}),new mr(E,S)}createSegments(N,H,v,g){return H.map(E=>E.path.startsWith(":")?this.findPosParam(N,E,g):this.findOrReturn(E,v))}findPosParam(N,H,v){const g=v[H.path.substring(1)];if(!g)throw new M.vHH(4001,!1);return g}findOrReturn(N,H){let v=0;for(const g of H){if(g.path===N.path)return H.splice(v),g;v++}return N}}const wa={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xl(L,N,H,v,g){const E=Fa(L,N,H);return E.matched?(v=function $i(L,N){return L.providers&&!L._injector&&(L._injector=(0,M.MMx)(L.providers,N,`Route: ${L.path}`)),L._injector??N}(N,v),function rs(L,N,H,v){const g=N.canMatch;if(!g||0===g.length)return(0,Ne.of)(!0);const E=g.map(S=>{const $=Fi(S,L);return nr(function R(L){return L&&Xo(L.canMatch)}($)?$.canMatch(N,H):L.runInContext(()=>$(N,H)))});return(0,Ne.of)(E).pipe(ir(),Oo())}(v,N,H).pipe((0,Ie.U)(S=>!0===S?E:{...wa}))):(0,Ne.of)(E)}function Fa(L,N,H){if(""===N.path)return"full"===N.pathMatch&&(L.hasChildren()||H.length>0)?{...wa}:{matched:!0,consumedSegments:[],remainingSegments:H,parameters:{},positionalParamSegments:{}};const g=(N.matcher||Jt)(H,L,N);if(!g)return{...wa};const E={};Object.entries(g.posParams??{}).forEach(([$,te])=>{E[$]=te.path});const S=g.consumed.length>0?{...E,...g.consumed[g.consumed.length-1].parameters}:E;return{matched:!0,consumedSegments:g.consumed,remainingSegments:H.slice(g.consumed.length),parameters:S,positionalParamSegments:g.posParams??{}}}function Ul(L,N,H,v){return H.length>0&&function uo(L,N,H){return H.some(v=>bl(L,N,v)&&Qn(v)!==ln)}(L,H,v)?{segmentGroup:new mr(N,Gs(v,new mr(H,L.children))),slicedSegments:[]}:0===H.length&&function Fs(L,N,H){return H.some(v=>bl(L,N,v))}(L,H,v)?{segmentGroup:new mr(L.segments,Ls(L,0,H,v,L.children)),slicedSegments:H}:{segmentGroup:new mr(L.segments,L.children),slicedSegments:H}}function Ls(L,N,H,v,g){const E={};for(const S of v)if(bl(L,H,S)&&!g[Qn(S)]){const $=new mr([],{});E[Qn(S)]=$}return{...g,...E}}function Gs(L,N){const H={};H[ln]=N;for(const v of L)if(""===v.path&&Qn(v)!==ln){const g=new mr([],{});H[Qn(v)]=g}return H}function bl(L,N,H){return(!(L.hasChildren()||N.length>0)||"full"!==H.pathMatch)&&""===H.path}class al{constructor(N,H,v,g,E,S,$){this.injector=N,this.configLoader=H,this.rootComponentType=v,this.config=g,this.urlTree=E,this.paramsInheritanceStrategy=S,this.urlSerializer=$,this.allowRedirects=!0,this.applyRedirects=new Vl(this.urlSerializer,this.urlTree)}noMatchError(N){return new M.vHH(4002,!1)}recognize(){const N=Ul(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,N,ln).pipe((0,Vt.K)(H=>{if(H instanceof Ko)return this.allowRedirects=!1,this.urlTree=H.urlTree,this.match(H.urlTree);throw H instanceof is?this.noMatchError(H):H}),(0,Ie.U)(H=>{const v=new So([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ln,this.rootComponentType,null,{}),g=new Ki(v,H),E=new Ks("",g),S=function yr(L,N,H=null,v=null){return ti(Hr(L),N,H,v)}(v,[],this.urlTree.queryParams,this.urlTree.fragment);return S.queryParams=this.urlTree.queryParams,E.url=this.urlSerializer.serialize(S),this.inheritParamsAndData(E._root),{state:E,tree:S}}))}match(N){return this.processSegmentGroup(this.injector,this.config,N.root,ln).pipe((0,Vt.K)(v=>{throw v instanceof is?this.noMatchError(v):v}))}inheritParamsAndData(N){const H=N.value,v=ps(H,this.paramsInheritanceStrategy);H.params=Object.freeze(v.params),H.data=Object.freeze(v.data),N.children.forEach(g=>this.inheritParamsAndData(g))}processSegmentGroup(N,H,v,g){return 0===v.segments.length&&v.hasChildren()?this.processChildren(N,H,v):this.processSegment(N,H,v,v.segments,g,!0)}processChildren(N,H,v){const g=[];for(const E of Object.keys(v.children))"primary"===E?g.unshift(E):g.push(E);return(0,_e.D)(g).pipe((0,an.b)(E=>{const S=v.children[E],$=function ka(L,N){const H=L.filter(v=>Qn(v)===N);return H.push(...L.filter(v=>Qn(v)!==N)),H}(H,E);return this.processSegmentGroup(N,$,S,E)}),(0,Jn.R)((E,S)=>(E.push(...S),E)),(0,Zt.d)(null),function ze(L,N){const H=arguments.length>=2;return v=>v.pipe(L?(0,gt.h)((g,E)=>L(g,E,v)):Se.y,Pn(1),H?(0,Zt.d)(N):(0,zt.T)(()=>new Ke.K))}(),(0,Wt.z)(E=>{if(null===E)return Ds(v);const S=Ws(E);return function dc(L){L.sort((N,H)=>N.value.outlet===ln?-1:H.value.outlet===ln?1:N.value.outlet.localeCompare(H.value.outlet))}(S),(0,Ne.of)(S)}))}processSegment(N,H,v,g,E,S){return(0,_e.D)(H).pipe((0,an.b)($=>this.processSegmentAgainstRoute($._injector??N,H,$,v,g,E,S).pipe((0,Vt.K)(te=>{if(te instanceof is)return(0,Ne.of)(null);throw te}))),(0,Nt.P)($=>!!$),(0,Vt.K)($=>{if(En($))return function ol(L,N,H){return 0===N.length&&!L.children[H]}(v,g,E)?(0,Ne.of)([]):Ds(v);throw $}))}processSegmentAgainstRoute(N,H,v,g,E,S,$){return function jl(L,N,H,v){return!!(Qn(L)===v||v!==ln&&bl(N,H,L))&&("**"===L.path||Fa(N,L,H).matched)}(v,g,E,S)?void 0===v.redirectTo?this.matchSegmentAgainstRoute(N,g,v,E,S,$):$&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(N,g,H,v,E,S):Ds(g):Ds(g)}expandSegmentAgainstRouteUsingRedirect(N,H,v,g,E,S){return"**"===g.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(N,v,g,S):this.expandRegularSegmentAgainstRouteUsingRedirect(N,H,v,g,E,S)}expandWildCardWithParamsAgainstRouteUsingRedirect(N,H,v,g){const E=this.applyRedirects.applyRedirectCommands([],v.redirectTo,{});return v.redirectTo.startsWith("/")?La(E):this.applyRedirects.lineralizeSegments(v,E).pipe((0,Wt.z)(S=>{const $=new mr(S,{});return this.processSegment(N,H,$,S,g,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(N,H,v,g,E,S){const{matched:$,consumedSegments:te,remainingSegments:ve,positionalParamSegments:me}=Fa(H,g,E);if(!$)return Ds(H);const st=this.applyRedirects.applyRedirectCommands(te,g.redirectTo,me);return g.redirectTo.startsWith("/")?La(st):this.applyRedirects.lineralizeSegments(g,st).pipe((0,Wt.z)($t=>this.processSegment(N,v,H,$t.concat(ve),S,!1)))}matchSegmentAgainstRoute(N,H,v,g,E,S){let $;if("**"===v.path){const te=g.length>0?pr(g).parameters:{},ve=new So(g,te,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qa(v),Qn(v),v.component??v._loadedComponent??null,v,hc(v));$=(0,Ne.of)({snapshot:ve,consumedSegments:[],remainingSegments:[]}),H.children={}}else $=xl(H,v,g,N).pipe((0,Ie.U)(({matched:te,consumedSegments:ve,remainingSegments:me,parameters:st})=>te?{snapshot:new So(ve,st,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qa(v),Qn(v),v.component??v._loadedComponent??null,v,hc(v)),consumedSegments:ve,remainingSegments:me}:null));return $.pipe((0,ct.w)(te=>null===te?Ds(H):this.getChildConfig(N=v._injector??N,v,g).pipe((0,ct.w)(({routes:ve})=>{const me=v._loadedInjector??N,{snapshot:st,consumedSegments:$t,remainingSegments:er}=te,{segmentGroup:Yn,slicedSegments:Nr}=Ul(H,$t,er,ve);if(0===Nr.length&&Yn.hasChildren())return this.processChildren(me,ve,Yn).pipe((0,Ie.U)(Sr=>null===Sr?null:[new Ki(st,Sr)]));if(0===ve.length&&0===Nr.length)return(0,Ne.of)([new Ki(st,[])]);const Wr=Qn(v)===E;return this.processSegment(me,ve,Yn,Nr,Wr?ln:E,!0).pipe((0,Ie.U)(Sr=>[new Ki(st,Sr)]))}))))}getChildConfig(N,H,v){return H.children?(0,Ne.of)({routes:H.children,injector:N}):H.loadChildren?void 0!==H._loadedRoutes?(0,Ne.of)({routes:H._loadedRoutes,injector:H._loadedInjector}):function zr(L,N,H,v){const g=N.canLoad;if(void 0===g||0===g.length)return(0,Ne.of)(!0);const E=g.map(S=>{const $=Fi(S,L);return nr(function ba(L){return L&&Xo(L.canLoad)}($)?$.canLoad(N,H):L.runInContext(()=>$(N,H)))});return(0,Ne.of)(E).pipe(ir(),Oo())}(N,H,v).pipe((0,Wt.z)(g=>g?this.configLoader.loadChildren(N,H).pipe((0,Qt.b)(E=>{H._loadedRoutes=E.routes,H._loadedInjector=E.injector})):function il(L){return Qe(Mr(!1,3))}())):(0,Ne.of)({routes:[],injector:N})}}function fa(L){const N=L.value.routeConfig;return N&&""===N.path}function Ws(L){const N=[],H=new Set;for(const v of L){if(!fa(v)){N.push(v);continue}const g=N.find(E=>v.value.routeConfig===E.value.routeConfig);void 0!==g?(g.children.push(...v.children),H.add(g)):N.push(v)}for(const v of H){const g=Ws(v.children);N.push(new Ki(v.value,g))}return N.filter(v=>!H.has(v))}function qa(L){return L.data||{}}function hc(L){return L.resolve||{}}function Ba(L){return"string"==typeof L.title||null===L.title}function Na(L){return(0,ct.w)(N=>{const H=L(N);return H?(0,_e.D)(H).pipe((0,Ie.U)(()=>N)):(0,Ne.of)(N)})}const Qo=new M.OlP("ROUTES");let ea=(()=>{var L;class N{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,M.f3M)(M.Sil)}loadComponent(v){if(this.componentLoaders.get(v))return this.componentLoaders.get(v);if(v._loadedComponent)return(0,Ne.of)(v._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(v);const g=nr(v.loadComponent()).pipe((0,Ie.U)(Q),(0,Qt.b)(S=>{this.onLoadEndListener&&this.onLoadEndListener(v),v._loadedComponent=S}),(0,Dt.x)(()=>{this.componentLoaders.delete(v)})),E=new Ot(g,()=>new Pt.x).pipe(et());return this.componentLoaders.set(v,E),E}loadChildren(v,g){if(this.childrenLoaders.get(g))return this.childrenLoaders.get(g);if(g._loadedRoutes)return(0,Ne.of)({routes:g._loadedRoutes,injector:g._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(g);const S=this.loadModuleFactoryOrRoutes(g.loadChildren).pipe((0,Ie.U)(te=>{this.onLoadEndListener&&this.onLoadEndListener(g);let ve,me;return Array.isArray(te)?me=te:(ve=te.create(v).injector,me=ve.get(Qo,[],M.XFs.Self|M.XFs.Optional).flat()),{routes:me.map(ns),injector:ve}}),(0,Dt.x)(()=>{this.childrenLoaders.delete(g)})),$=new Ot(S,()=>new Pt.x).pipe(et());return this.childrenLoaders.set(g,$),$}loadModuleFactoryOrRoutes(v){return nr(v()).pipe((0,Ie.U)(Q),(0,Wt.z)(g=>g instanceof M.YKP||Array.isArray(g)?(0,Ne.of)(g):(0,_e.D)(this.compiler.compileModuleAsync(g))))}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})();function Q(L){return function B(L){return L&&"object"==typeof L&&"default"in L}(L)?L.default:L}let qe=(()=>{var L;class N{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Pt.x,this.configLoader=(0,M.f3M)(ea),this.environmentInjector=(0,M.f3M)(M.lqb),this.urlSerializer=(0,M.f3M)(yi),this.rootContexts=(0,M.f3M)(kr),this.inputBindingEnabled=null!==(0,M.f3M)(Ti,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Ne.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=E=>this.events.next(new Ct(E)),this.configLoader.onLoadStartListener=E=>this.events.next(new Be(E))}complete(){this.transitions?.complete()}handleNavigationRequest(v){const g=++this.navigationId;this.transitions?.next({...this.transitions.value,...v,id:g})}setupNavigations(v){return this.transitions=new Le.X({id:0,currentUrlTree:v.currentUrlTree,currentRawUrl:v.currentUrlTree,extractedUrl:v.urlHandlingStrategy.extract(v.currentUrlTree),urlAfterRedirects:v.urlHandlingStrategy.extract(v.currentUrlTree),rawUrl:v.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:bi,restoredState:null,currentSnapshot:v.routerState.snapshot,targetSnapshot:null,currentRouterState:v.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,gt.h)(g=>0!==g.id),(0,Ie.U)(g=>({...g,extractedUrl:v.urlHandlingStrategy.extract(g.rawUrl)})),(0,ct.w)(g=>{let E=!1,S=!1;return(0,Ne.of)(g).pipe((0,Qt.b)($=>{this.currentNavigation={id:$.id,initialUrl:$.rawUrl,extractedUrl:$.extractedUrl,trigger:$.source,extras:$.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,ct.w)($=>{const te=v.browserUrlTree.toString(),ve=!v.navigated||$.extractedUrl.toString()!==te||te!==v.currentUrlTree.toString();if(!ve&&"reload"!==($.extras.onSameUrlNavigation??v.onSameUrlNavigation)){const st="";return this.events.next(new Po($.id,v.serializeUrl(g.rawUrl),st,0)),v.rawUrlTree=$.rawUrl,$.resolve(null),ot.E}if(v.urlHandlingStrategy.shouldProcessUrl($.rawUrl))return Z($.source)&&(v.browserUrlTree=$.extractedUrl),(0,Ne.of)($).pipe((0,ct.w)(st=>{const $t=this.transitions?.getValue();return this.events.next(new Yo(st.id,this.urlSerializer.serialize(st.extractedUrl),st.source,st.restoredState)),$t!==this.transitions?.getValue()?ot.E:Promise.resolve(st)}),function Ic(L,N,H,v,g,E){return(0,Wt.z)(S=>function sl(L,N,H,v,g,E,S="emptyOnly"){return new al(L,N,H,v,g,S,E).recognize()}(L,N,H,v,S.extractedUrl,g,E).pipe((0,Ie.U)(({state:$,tree:te})=>({...S,targetSnapshot:$,urlAfterRedirects:te}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,v.config,this.urlSerializer,v.paramsInheritanceStrategy),(0,Qt.b)(st=>{if(g.targetSnapshot=st.targetSnapshot,g.urlAfterRedirects=st.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:st.urlAfterRedirects},"eager"===v.urlUpdateStrategy){if(!st.extras.skipLocationChange){const er=v.urlHandlingStrategy.merge(st.urlAfterRedirects,st.rawUrl);v.setBrowserUrl(er,st)}v.browserUrlTree=st.urlAfterRedirects}const $t=new Wn(st.id,this.urlSerializer.serialize(st.extractedUrl),this.urlSerializer.serialize(st.urlAfterRedirects),st.targetSnapshot);this.events.next($t)}));if(ve&&v.urlHandlingStrategy.shouldProcessUrl(v.rawUrlTree)){const{id:st,extractedUrl:$t,source:er,restoredState:Yn,extras:Nr}=$,Wr=new Yo(st,this.urlSerializer.serialize($t),er,Yn);this.events.next(Wr);const Sr=Vr(0,this.rootComponentType).snapshot;return g={...$,targetSnapshot:Sr,urlAfterRedirects:$t,extras:{...Nr,skipLocationChange:!1,replaceUrl:!1}},(0,Ne.of)(g)}{const st="";return this.events.next(new Po($.id,v.serializeUrl(g.extractedUrl),st,1)),v.rawUrlTree=$.rawUrl,$.resolve(null),ot.E}}),(0,Qt.b)($=>{const te=new Dr($.id,this.urlSerializer.serialize($.extractedUrl),this.urlSerializer.serialize($.urlAfterRedirects),$.targetSnapshot);this.events.next(te)}),(0,Ie.U)($=>g={...$,guards:oo($.targetSnapshot,$.currentSnapshot,this.rootContexts)}),function Oi(L,N){return(0,Wt.z)(H=>{const{targetSnapshot:v,currentSnapshot:g,guards:{canActivateChecks:E,canDeactivateChecks:S}}=H;return 0===S.length&&0===E.length?(0,Ne.of)({...H,guardsResult:!0}):function so(L,N,H,v){return(0,_e.D)(L).pipe((0,Wt.z)(g=>function zn(L,N,H,v,g){const E=N&&N.routeConfig?N.routeConfig.canDeactivate:null;if(!E||0===E.length)return(0,Ne.of)(!0);const S=E.map($=>{const te=As(N)??g,ve=Fi($,te);return nr(function K(L){return L&&Xo(L.canDeactivate)}(ve)?ve.canDeactivate(L,N,H,v):te.runInContext(()=>ve(L,N,H,v))).pipe((0,Nt.P)())});return(0,Ne.of)(S).pipe(ir())}(g.component,g.route,H,N,v)),(0,Nt.P)(g=>!0!==g,!0))}(S,v,g,L).pipe((0,Wt.z)($=>$&&function sa(L){return"boolean"==typeof L}($)?function ee(L,N,H,v){return(0,_e.D)(N).pipe((0,an.b)(g=>(0,ye.z)(function Me(L,N){return null!==L&&N&&N(new kt(L)),(0,Ne.of)(!0)}(g.route.parent,v),function Y(L,N){return null!==L&&N&&N(new gn(L)),(0,Ne.of)(!0)}(g.route,v),function We(L,N,H){const v=N[N.length-1],E=N.slice(0,N.length-1).reverse().map(S=>function xa(L){const N=L.routeConfig?L.routeConfig.canActivateChild:null;return N&&0!==N.length?{node:L,guards:N}:null}(S)).filter(S=>null!==S).map(S=>(0,Ae.P)(()=>{const $=S.guards.map(te=>{const ve=As(S.node)??H,me=Fi(te,ve);return nr(function P(L){return L&&Xo(L.canActivateChild)}(me)?me.canActivateChild(v,L):ve.runInContext(()=>me(v,L))).pipe((0,Nt.P)())});return(0,Ne.of)($).pipe(ir())}));return(0,Ne.of)(E).pipe(ir())}(L,g.path,H),function re(L,N,H){const v=N.routeConfig?N.routeConfig.canActivate:null;if(!v||0===v.length)return(0,Ne.of)(!0);const g=v.map(E=>(0,Ae.P)(()=>{const S=As(N)??H,$=Fi(E,S);return nr(function Js(L){return L&&Xo(L.canActivate)}($)?$.canActivate(N,L):S.runInContext(()=>$(N,L))).pipe((0,Nt.P)())}));return(0,Ne.of)(g).pipe(ir())}(L,g.route,H))),(0,Nt.P)(g=>!0!==g,!0))}(v,E,L,N):(0,Ne.of)($)),(0,Ie.U)($=>({...H,guardsResult:$})))})}(this.environmentInjector,$=>this.events.next($)),(0,Qt.b)($=>{if(g.guardsResult=$.guardsResult,dr($.guardsResult))throw Vo(0,$.guardsResult);const te=new he($.id,this.urlSerializer.serialize($.extractedUrl),this.urlSerializer.serialize($.urlAfterRedirects),$.targetSnapshot,!!$.guardsResult);this.events.next(te)}),(0,gt.h)($=>!!$.guardsResult||(v.restoreHistory($),this.cancelNavigationTransition($,"",3),!1)),Na($=>{if($.guards.canActivateChecks.length)return(0,Ne.of)($).pipe((0,Qt.b)(te=>{const ve=new $e(te.id,this.urlSerializer.serialize(te.extractedUrl),this.urlSerializer.serialize(te.urlAfterRedirects),te.targetSnapshot);this.events.next(ve)}),(0,ct.w)(te=>{let ve=!1;return(0,Ne.of)(te).pipe(function Mc(L,N){return(0,Wt.z)(H=>{const{targetSnapshot:v,guards:{canActivateChecks:g}}=H;if(!g.length)return(0,Ne.of)(H);let E=0;return(0,_e.D)(g).pipe((0,an.b)(S=>function fc(L,N,H,v){const g=L.routeConfig,E=L._resolve;return void 0!==g?.title&&!Ba(g)&&(E[_n]=g.title),function Hl(L,N,H,v){const g=function Ea(L){return[...Object.keys(L),...Object.getOwnPropertySymbols(L)]}(L);if(0===g.length)return(0,Ne.of)({});const E={};return(0,_e.D)(g).pipe((0,Wt.z)(S=>function Qs(L,N,H,v){const g=As(N)??v,E=Fi(L,g);return nr(E.resolve?E.resolve(N,H):g.runInContext(()=>E(N,H)))}(L[S],N,H,v).pipe((0,Nt.P)(),(0,Qt.b)($=>{E[S]=$}))),Pn(1),function ut(L){return(0,Ie.U)(()=>L)}(E),(0,Vt.K)(S=>En(S)?ot.E:Qe(S)))}(E,L,N,v).pipe((0,Ie.U)(S=>(L._resolvedData=S,L.data=ps(L,H).resolve,g&&Ba(g)&&(L.data[_n]=g.title),null)))}(S.route,v,L,N)),(0,Qt.b)(()=>E++),Pn(1),(0,Wt.z)(S=>E===g.length?(0,Ne.of)(H):ot.E))})}(v.paramsInheritanceStrategy,this.environmentInjector),(0,Qt.b)({next:()=>ve=!0,complete:()=>{ve||(v.restoreHistory(te),this.cancelNavigationTransition(te,"",2))}}))}),(0,Qt.b)(te=>{const ve=new we(te.id,this.urlSerializer.serialize(te.extractedUrl),this.urlSerializer.serialize(te.urlAfterRedirects),te.targetSnapshot);this.events.next(ve)}))}),Na($=>{const te=ve=>{const me=[];ve.routeConfig?.loadComponent&&!ve.routeConfig._loadedComponent&&me.push(this.configLoader.loadComponent(ve.routeConfig).pipe((0,Qt.b)(st=>{ve.component=st}),(0,Ie.U)(()=>{})));for(const st of ve.children)me.push(...te(st));return me};return(0,tt.a)(te($.targetSnapshot.root)).pipe((0,Zt.d)(),(0,St.q)(1))}),Na(()=>this.afterPreactivation()),(0,Ie.U)($=>{const te=function zo(L,N,H){const v=Si(L,N._root,H?H._root:void 0);return new To(v,N)}(v.routeReuseStrategy,$.targetSnapshot,$.currentRouterState);return g={...$,targetRouterState:te}}),(0,Qt.b)($=>{v.currentUrlTree=$.urlAfterRedirects,v.rawUrlTree=v.urlHandlingStrategy.merge($.urlAfterRedirects,$.rawUrl),v.routerState=$.targetRouterState,"deferred"===v.urlUpdateStrategy&&($.extras.skipLocationChange||v.setBrowserUrl(v.rawUrlTree,$),v.browserUrlTree=$.urlAfterRedirects)}),((L,N,H,v)=>(0,Ie.U)(g=>(new js(N,g.targetRouterState,g.currentRouterState,H,v).activate(L),g)))(this.rootContexts,v.routeReuseStrategy,$=>this.events.next($),this.inputBindingEnabled),(0,St.q)(1),(0,Qt.b)({next:$=>{E=!0,this.lastSuccessfulNavigation=this.currentNavigation,v.navigated=!0,this.events.next(new zi($.id,this.urlSerializer.serialize($.extractedUrl),this.urlSerializer.serialize(v.currentUrlTree))),v.titleStrategy?.updateTitle($.targetRouterState.snapshot),$.resolve(!0)},complete:()=>{E=!0}}),(0,Dt.x)(()=>{E||S||this.cancelNavigationTransition(g,"",1),this.currentNavigation?.id===g.id&&(this.currentNavigation=null)}),(0,Vt.K)($=>{if(S=!0,ls($)){ks($)||(v.navigated=!0,v.restoreHistory(g,!0));const te=new ss(g.id,this.urlSerializer.serialize(g.extractedUrl),$.message,$.cancellationCode);if(this.events.next(te),ks($)){const ve=v.urlHandlingStrategy.merge($.url,v.rawUrlTree),me={skipLocationChange:g.extras.skipLocationChange,replaceUrl:"eager"===v.urlUpdateStrategy||Z(g.source)};v.scheduleNavigation(ve,bi,null,me,{resolve:g.resolve,reject:g.reject,promise:g.promise})}else g.resolve(!1)}else{v.restoreHistory(g,!0);const te=new No(g.id,this.urlSerializer.serialize(g.extractedUrl),$,g.targetSnapshot??void 0);this.events.next(te);try{g.resolve(v.errorHandler($))}catch(ve){g.reject(ve)}}return ot.E}))}))}cancelNavigationTransition(v,g,E){const S=new ss(v.id,this.urlSerializer.serialize(v.extractedUrl),g,E);this.events.next(S),v.resolve(!1)}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})();function Z(L){return L!==bi}let Re=(()=>{var L;class N{buildTitle(v){let g,E=v.root;for(;void 0!==E;)g=this.getResolvedTitleForRoute(E)??g,E=E.children.find(S=>S.outlet===ln);return g}getResolvedTitleForRoute(v){return v.data[_n]}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:function(){return(0,M.f3M)(vt)},providedIn:"root"}),N})(),vt=(()=>{var L;class N extends Re{constructor(v){super(),this.title=v}updateTitle(v){const g=this.buildTitle(v);void 0!==g&&this.title.setTitle(g)}}return(L=N).\u0275fac=function(v){return new(v||L)(M.LFG(nn.Dx))},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})(),vn=(()=>{var L;class N{}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:function(){return(0,M.f3M)(Er)},providedIn:"root"}),N})();class Sn{shouldDetach(N){return!1}store(N,H){}shouldAttach(N){return!1}retrieve(N){return null}shouldReuseRoute(N,H){return N.routeConfig===H.routeConfig}}let Er=(()=>{var L;class N extends Sn{}return(L=N).\u0275fac=function(){let H;return function(g){return(H||(H=M.n5z(L)))(g||L)}}(),L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})();const vi=new M.OlP("",{providedIn:"root",factory:()=>({})});let xi=(()=>{var L;class N{}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:function(){return(0,M.f3M)(Br)},providedIn:"root"}),N})(),Br=(()=>{var L;class N{shouldProcessUrl(v){return!0}extract(v){return v}merge(v,g){return v}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})();var eo=function(L){return L[L.COMPLETE=0]="COMPLETE",L[L.FAILED=1]="FAILED",L[L.REDIRECTING=2]="REDIRECTING",L}(eo||{});function Ei(L,N){L.events.pipe((0,gt.h)(H=>H instanceof zi||H instanceof ss||H instanceof No||H instanceof Po),(0,Ie.U)(H=>H instanceof zi||H instanceof Po?eo.COMPLETE:H instanceof ss&&(0===H.code||1===H.code)?eo.REDIRECTING:eo.FAILED),(0,gt.h)(H=>H!==eo.REDIRECTING),(0,St.q)(1)).subscribe(()=>{N()})}function ki(L){throw L}function ko(L,N,H){return N.parse("/")}const Ps={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ta={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qi=(()=>{var L;class N{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,M.f3M)(M.c2e),this.isNgZoneEnabled=!1,this.options=(0,M.f3M)(vi,{optional:!0})||{},this.pendingTasks=(0,M.f3M)(M.HDt),this.errorHandler=this.options.errorHandler||ki,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||ko,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,M.f3M)(xi),this.routeReuseStrategy=(0,M.f3M)(vn),this.titleStrategy=(0,M.f3M)(Re),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,M.f3M)(Qo,{optional:!0})?.flat()??[],this.navigationTransitions=(0,M.f3M)(qe),this.urlSerializer=(0,M.f3M)(yi),this.location=(0,M.f3M)(Ce.Ye),this.componentInputBindingEnabled=!!(0,M.f3M)(Ti,{optional:!0}),this.isNgZoneEnabled=(0,M.f3M)(M.R0b)instanceof M.R0b&&M.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new _r,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Vr(0,null),this.navigationTransitions.setupNavigations(this).subscribe(v=>{this.lastSuccessfulId=v.id,this.currentPageId=this.browserPageId??0},v=>{this.console.warn(`Unhandled Navigation Error: ${v}`)})}resetRootComponentType(v){this.routerState.root.component=v,this.navigationTransitions.rootComponentType=v}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const v=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),bi,v)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(v=>{const g="popstate"===v.type?"popstate":"hashchange";"popstate"===g&&setTimeout(()=>{this.navigateToSyncWithBrowser(v.url,g,v.state)},0)}))}navigateToSyncWithBrowser(v,g,E){const S={replaceUrl:!0},$=E?.navigationId?E:null;if(E){const ve={...E};delete ve.navigationId,delete ve.\u0275routerPageId,0!==Object.keys(ve).length&&(S.state=ve)}const te=this.parseUrl(v);this.scheduleNavigation(te,g,$,S)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(v){this.config=v.map(ns),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(v,g={}){const{relativeTo:E,queryParams:S,fragment:$,queryParamsHandling:te,preserveFragment:ve}=g,me=ve?this.currentUrlTree.fragment:$;let $t,st=null;switch(te){case"merge":st={...this.currentUrlTree.queryParams,...S};break;case"preserve":st=this.currentUrlTree.queryParams;break;default:st=S||null}null!==st&&(st=this.removeEmptyProps(st));try{$t=Hr(E?E.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof v[0]||!v[0].startsWith("/"))&&(v=[]),$t=this.currentUrlTree.root}return ti($t,v,st,me??null)}navigateByUrl(v,g={skipLocationChange:!1}){const E=dr(v)?v:this.parseUrl(v),S=this.urlHandlingStrategy.merge(E,this.rawUrlTree);return this.scheduleNavigation(S,bi,null,g)}navigate(v,g={skipLocationChange:!1}){return function _s(L){for(let N=0;N<L.length;N++)if(null==L[N])throw new M.vHH(4008,!1)}(v),this.navigateByUrl(this.createUrlTree(v,g),g)}serializeUrl(v){return this.urlSerializer.serialize(v)}parseUrl(v){let g;try{g=this.urlSerializer.parse(v)}catch(E){g=this.malformedUriErrorHandler(E,this.urlSerializer,v)}return g}isActive(v,g){let E;if(E=!0===g?{...Ps}:!1===g?{...ta}:g,dr(v))return Lr(this.currentUrlTree,v,E);const S=this.parseUrl(v);return Lr(this.currentUrlTree,S,E)}removeEmptyProps(v){return Object.keys(v).reduce((g,E)=>{const S=v[E];return null!=S&&(g[E]=S),g},{})}scheduleNavigation(v,g,E,S,$){if(this.disposed)return Promise.resolve(!1);let te,ve,me;$?(te=$.resolve,ve=$.reject,me=$.promise):me=new Promise(($t,er)=>{te=$t,ve=er});const st=this.pendingTasks.add();return Ei(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(st))}),this.navigationTransitions.handleNavigationRequest({source:g,restoredState:E,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:v,extras:S,resolve:te,reject:ve,promise:me,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),me.catch($t=>Promise.reject($t))}setBrowserUrl(v,g){const E=this.urlSerializer.serialize(v);if(this.location.isCurrentPathEqualTo(E)||g.extras.replaceUrl){const $={...g.extras.state,...this.generateNgRouterState(g.id,this.browserPageId)};this.location.replaceState(E,"",$)}else{const S={...g.extras.state,...this.generateNgRouterState(g.id,(this.browserPageId??0)+1)};this.location.go(E,"",S)}}restoreHistory(v,g=!1){if("computed"===this.canceledNavigationResolution){const S=this.currentPageId-(this.browserPageId??this.currentPageId);0!==S?this.location.historyGo(S):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===S&&(this.resetState(v),this.browserUrlTree=v.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(g&&this.resetState(v),this.resetUrlToCurrentUrlTree())}resetState(v){this.routerState=v.currentRouterState,this.currentUrlTree=v.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,v.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(v,g){return"computed"===this.canceledNavigationResolution?{navigationId:v,\u0275routerPageId:g}:{navigationId:v}}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})(),Cs=(()=>{var L;class N{constructor(v,g,E,S,$,te){this.router=v,this.route=g,this.tabIndexAttribute=E,this.renderer=S,this.el=$,this.locationStrategy=te,this.href=null,this.commands=null,this.onChanges=new Pt.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const ve=$.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===ve||"area"===ve,this.isAnchorElement?this.subscription=v.events.subscribe(me=>{me instanceof zi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(v){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",v)}ngOnChanges(v){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(v){null!=v?(this.commands=Array.isArray(v)?v:[v],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(v,g,E,S,$){return!!(null===this.urlTree||this.isAnchorElement&&(0!==v||g||E||S||$||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const v=null===this.href?null:(0,M.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",v)}applyAttributeValue(v,g){const E=this.renderer,S=this.el.nativeElement;null!==g?E.setAttribute(S,v,g):E.removeAttribute(S,v)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(L=N).\u0275fac=function(v){return new(v||L)(M.Y36(qi),M.Y36(Ji),M.$8M("tabindex"),M.Y36(M.Qsj),M.Y36(M.SBq),M.Y36(Ce.S$))},L.\u0275dir=M.lG2({type:L,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(v,g){1&v&&M.NdJ("click",function(S){return g.onClick(S.button,S.ctrlKey,S.shiftKey,S.altKey,S.metaKey)}),2&v&&M.uIk("target",g.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",M.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",M.VuI],replaceUrl:["replaceUrl","replaceUrl",M.VuI],routerLink:"routerLink"},standalone:!0,features:[M.Xq5,M.TTD]}),N})();class cl{}let or=(()=>{var L;class N{preload(v,g){return g().pipe((0,Vt.K)(()=>(0,Ne.of)(null)))}}return(L=N).\u0275fac=function(v){return new(v||L)},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})(),ei=(()=>{var L;class N{constructor(v,g,E,S,$){this.router=v,this.injector=E,this.preloadingStrategy=S,this.loader=$}setUpPreloading(){this.subscription=this.router.events.pipe((0,gt.h)(v=>v instanceof zi),(0,an.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(v,g){const E=[];for(const S of g){S.providers&&!S._injector&&(S._injector=(0,M.MMx)(S.providers,v,`Route: ${S.path}`));const $=S._injector??v,te=S._loadedInjector??$;(S.loadChildren&&!S._loadedRoutes&&void 0===S.canLoad||S.loadComponent&&!S._loadedComponent)&&E.push(this.preloadConfig($,S)),(S.children||S._loadedRoutes)&&E.push(this.processRoutes(te,S.children??S._loadedRoutes))}return(0,_e.D)(E).pipe((0,jt.J)())}preloadConfig(v,g){return this.preloadingStrategy.preload(g,()=>{let E;E=g.loadChildren&&void 0===g.canLoad?this.loader.loadChildren(v,g):(0,Ne.of)(null);const S=E.pipe((0,Wt.z)($=>null===$?(0,Ne.of)(void 0):(g._loadedRoutes=$.routes,g._loadedInjector=$.injector,this.processRoutes($.injector??v,$.routes))));if(g.loadComponent&&!g._loadedComponent){const $=this.loader.loadComponent(g);return(0,_e.D)([S,$]).pipe((0,jt.J)())}return S})}}return(L=N).\u0275fac=function(v){return new(v||L)(M.LFG(qi),M.LFG(M.Sil),M.LFG(M.lqb),M.LFG(cl),M.LFG(ea))},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),N})();const Za=new M.OlP("");let wl=(()=>{var L;class N{constructor(v,g,E,S,$={}){this.urlSerializer=v,this.transitions=g,this.viewportScroller=E,this.zone=S,this.options=$,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},$.scrollPositionRestoration=$.scrollPositionRestoration||"disabled",$.anchorScrolling=$.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(v=>{v instanceof Yo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=v.navigationTrigger,this.restoredId=v.restoredState?v.restoredState.navigationId:0):v instanceof zi?(this.lastId=v.id,this.scheduleScrollEvent(v,this.urlSerializer.parse(v.urlAfterRedirects).fragment)):v instanceof Po&&0===v.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(v,this.urlSerializer.parse(v.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(v=>{v instanceof In&&(v.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(v.position):v.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(v.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(v,g){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new In(v,"popstate"===this.lastSource?this.store[this.restoredId]:null,g))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(L=N).\u0275fac=function(v){M.$Z()},L.\u0275prov=M.Yz7({token:L,factory:L.\u0275fac}),N})();function Bs(L,N){return{\u0275kind:L,\u0275providers:N}}function za(){const L=(0,M.f3M)(M.zs3);return N=>{const H=L.get(M.z2F);if(N!==H.components[0])return;const v=L.get(qi),g=L.get(Zl);1===L.get(pc)&&v.initialNavigation(),L.get(El,null,M.XFs.Optional)?.setUpPreloading(),L.get(Za,null,M.XFs.Optional)?.init(),v.resetRootComponentType(H.componentTypes[0]),g.closed||(g.next(),g.complete(),g.unsubscribe())}}const Zl=new M.OlP("",{factory:()=>new Pt.x}),pc=new M.OlP("",{providedIn:"root",factory:()=>1}),El=new M.OlP("");function ds(L){return Bs(0,[{provide:El,useExisting:ei},{provide:cl,useExisting:L}])}const mc=new M.OlP("ROUTER_FORROOT_GUARD"),zu=[Ce.Ye,{provide:yi,useClass:Yr},qi,kr,{provide:Ji,useFactory:function Ya(L){return L.routerState.root},deps:[qi]},ea,[]];function Va(){return new M.PXZ("Router",qi)}let Ts=(()=>{var L;class N{constructor(v){}static forRoot(v,g){return{ngModule:N,providers:[zu,[],{provide:Qo,multi:!0,useValue:v},{provide:mc,useFactory:ca,deps:[[qi,new M.FiY,new M.tp0]]},{provide:vi,useValue:g||{}},g?.useHash?{provide:Ce.S$,useClass:Ce.Do}:{provide:Ce.S$,useClass:Ce.b0},{provide:Za,useFactory:()=>{const L=(0,M.f3M)(Ce.EM),N=(0,M.f3M)(M.R0b),H=(0,M.f3M)(vi),v=(0,M.f3M)(qe),g=(0,M.f3M)(yi);return H.scrollOffset&&L.setOffset(H.scrollOffset),new wl(g,v,L,N,H)}},g?.preloadingStrategy?ds(g.preloadingStrategy).\u0275providers:[],{provide:M.PXZ,multi:!0,useFactory:Va},g?.initialNavigation?Pc(g):[],g?.bindToComponentInputs?Bs(8,[Io,{provide:Ti,useExisting:Io}]).\u0275providers:[],[{provide:Xl,useFactory:za},{provide:M.tb,multi:!0,useExisting:Xl}]]}}static forChild(v){return{ngModule:N,providers:[{provide:Qo,multi:!0,useValue:v}]}}}return(L=N).\u0275fac=function(v){return new(v||L)(M.LFG(mc,8))},L.\u0275mod=M.oAB({type:L}),L.\u0275inj=M.cJS({}),N})();function ca(L){return"guarded"}function Pc(L){return["disabled"===L.initialNavigation?Bs(3,[{provide:M.ip1,multi:!0,useFactory:()=>{const N=(0,M.f3M)(qi);return()=>{N.setUpLocationChangeListener()}}},{provide:pc,useValue:2}]).\u0275providers:[],"enabledBlocking"===L.initialNavigation?Bs(2,[{provide:pc,useValue:0},{provide:M.ip1,multi:!0,deps:[M.zs3],useFactory:N=>{const H=N.get(Ce.V_,Promise.resolve());return()=>H.then(()=>new Promise(v=>{const g=N.get(qi),E=N.get(Zl);Ei(g,()=>{v(!0)}),N.get(qe).afterPreactivation=()=>(v(!0),E.closed?(0,Ne.of)(void 0):E),g.initialNavigation()}))}}]).\u0275providers:[]]}const Xl=new M.OlP("")},3106:(Hn,It,X)=>{"use strict";X.d(It,{Z:()=>mt});var M=X(9058),w=X(4537),lt=X(534),l=X(7879);class _e{constructor(pt,et){this._delegate=pt,this.firebase=et,(0,lt._addComponent)(pt,new w.wA("app-compat",()=>this,"PUBLIC")),this.container=pt.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(pt){this._delegate.automaticDataCollectionEnabled=pt}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(pt=>{this._delegate.checkDestroyed(),pt()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,lt.deleteApp)(this._delegate)))}_getService(pt,et=lt._DEFAULT_ENTRY_NAME){var Ot;this._delegate.checkDestroyed();const Pt=this._delegate.container.getProvider(pt);return!Pt.isInitialized()&&"EXPLICIT"===(null===(Ot=Pt.getComponent())||void 0===Ot?void 0:Ot.instantiationMode)&&Pt.initialize(),Pt.getImmediate({identifier:et})}_removeServiceInstance(pt,et=lt._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(pt).clearInstance(et)}_addComponent(pt){(0,lt._addComponent)(this._delegate,pt)}_addOrOverwriteComponent(pt){(0,lt._addOrOverwriteComponent)(this._delegate,pt)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Le=new M.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),ye=function Ke(){const xt=function tt(xt){const pt={},et={__esModule:!0,initializeApp:function Ce(Ye,gt={}){const Wt=lt.initializeApp(Ye,gt);if((0,M.r3)(pt,Wt.name))return pt[Wt.name];const Nt=new xt(Wt,et);return pt[Wt.name]=Nt,Nt},app:Pt,registerVersion:lt.registerVersion,setLogLevel:lt.setLogLevel,onLog:lt.onLog,apps:null,SDK_VERSION:lt.SDK_VERSION,INTERNAL:{registerComponent:function ct(Ye){const gt=Ye.name,Wt=gt.replace("-compat","");if(lt._registerComponent(Ye)&&"PUBLIC"===Ye.type){const Nt=(an=Pt())=>{if("function"!=typeof an[Wt])throw Le.create("invalid-app-argument",{appName:gt});return an[Wt]()};void 0!==Ye.serviceProps&&(0,M.ZB)(Nt,Ye.serviceProps),et[Wt]=Nt,xt.prototype[Wt]=function(...an){return this._getService.bind(this,gt).apply(this,Ye.multipleInstances?an:[])}}return"PUBLIC"===Ye.type?et[Wt]:null},removeApp:function Ot(Ye){delete pt[Ye]},useAsService:function St(Ye,gt){return"serverAuth"===gt?null:gt},modularAPIs:lt}};function Pt(Ye){if(!(0,M.r3)(pt,Ye=Ye||lt._DEFAULT_ENTRY_NAME))throw Le.create("no-app",{appName:Ye});return pt[Ye]}return et.default=et,Object.defineProperty(et,"apps",{get:function Ie(){return Object.keys(pt).map(Ye=>pt[Ye])}}),Pt.App=xt,et}(_e);return xt.INTERNAL=Object.assign(Object.assign({},xt.INTERNAL),{createFirebaseNamespace:Ke,extendNamespace:function pt(et){(0,M.ZB)(xt,et)},createSubscribe:M.ne,ErrorFactory:M.LL,deepExtend:M.ZB}),xt}(),Ae=new l.Yd("@firebase/app-compat");if((0,M.jU)()&&void 0!==self.firebase){Ae.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const xt=self.firebase.SDK_VERSION;xt&&xt.indexOf("LITE")>=0&&Ae.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const mt=ye;!function ot(xt){(0,lt.registerVersion)("@firebase/app-compat","0.2.23",xt)}()},534:(Hn,It,X)=>{"use strict";X.r(It),X.d(It,{FirebaseError:()=>l.ZR,SDK_VERSION:()=>Xe,_DEFAULT_ENTRY_NAME:()=>hr,_addComponent:()=>Di,_addOrOverwriteComponent:()=>Gi,_apps:()=>_r,_clearComponents:()=>Yr,_components:()=>mr,_getProvider:()=>Mi,_registerComponent:()=>Tr,_removeServiceInstance:()=>yi,deleteApp:()=>at,getApp:()=>pe,getApps:()=>He,initializeApp:()=>ue,onLog:()=>At,registerVersion:()=>Mt,setLogLevel:()=>_t});var M=X(5861),w=X(4537),lt=X(7879),l=X(9058);const _e=(Kt,Et)=>Et.some(wn=>Kt instanceof wn);let Ne,Le;const ye=new WeakMap,Ae=new WeakMap,Ze=new WeakMap,Qe=new WeakMap,ot=new WeakMap;let pt={get(Kt,Et,wn){if(Kt instanceof IDBTransaction){if("done"===Et)return Ae.get(Kt);if("objectStoreNames"===Et)return Kt.objectStoreNames||Ze.get(Kt);if("store"===Et)return wn.objectStoreNames[1]?void 0:wn.objectStore(wn.objectStoreNames[0])}return Ce(Kt[Et])},set:(Kt,Et,wn)=>(Kt[Et]=wn,!0),has:(Kt,Et)=>Kt instanceof IDBTransaction&&("done"===Et||"store"===Et)||Et in Kt};function Pt(Kt){return"function"==typeof Kt?function Ot(Kt){return Kt!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ke(){return Le||(Le=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(Kt)?function(...Et){return Kt.apply(Ie(this),Et),Ce(ye.get(this))}:function(...Et){return Ce(Kt.apply(Ie(this),Et))}:function(Et,...wn){const cr=Kt.call(Ie(this),Et,...wn);return Ze.set(cr,Et.sort?Et.sort():[Et]),Ce(cr)}}(Kt):(Kt instanceof IDBTransaction&&function xt(Kt){if(Ae.has(Kt))return;const Et=new Promise((wn,cr)=>{const qn=()=>{Kt.removeEventListener("complete",Rr),Kt.removeEventListener("error",Fr),Kt.removeEventListener("abort",Fr)},Rr=()=>{wn(),qn()},Fr=()=>{cr(Kt.error||new DOMException("AbortError","AbortError")),qn()};Kt.addEventListener("complete",Rr),Kt.addEventListener("error",Fr),Kt.addEventListener("abort",Fr)});Ae.set(Kt,Et)}(Kt),_e(Kt,function tt(){return Ne||(Ne=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(Kt,pt):Kt)}function Ce(Kt){if(Kt instanceof IDBRequest)return function mt(Kt){const Et=new Promise((wn,cr)=>{const qn=()=>{Kt.removeEventListener("success",Rr),Kt.removeEventListener("error",Fr)},Rr=()=>{wn(Ce(Kt.result)),qn()},Fr=()=>{cr(Kt.error),qn()};Kt.addEventListener("success",Rr),Kt.addEventListener("error",Fr)});return Et.then(wn=>{wn instanceof IDBCursor&&ye.set(wn,Kt)}).catch(()=>{}),ot.set(Et,Kt),Et}(Kt);if(Qe.has(Kt))return Qe.get(Kt);const Et=Pt(Kt);return Et!==Kt&&(Qe.set(Kt,Et),ot.set(Et,Kt)),Et}const Ie=Kt=>ot.get(Kt),Ye=["get","getKey","getAll","getAllKeys","count"],gt=["put","add","delete","clear"],Wt=new Map;function Nt(Kt,Et){if(!(Kt instanceof IDBDatabase)||Et in Kt||"string"!=typeof Et)return;if(Wt.get(Et))return Wt.get(Et);const wn=Et.replace(/FromIndex$/,""),cr=Et!==wn,qn=gt.includes(wn);if(!(wn in(cr?IDBIndex:IDBObjectStore).prototype)||!qn&&!Ye.includes(wn))return;const Rr=function(){var Fr=(0,M.Z)(function*(di,...Ci){const Qr=this.transaction(di,qn?"readwrite":"readonly");let li=Qr.store;return cr&&(li=li.index(Ci.shift())),(yield Promise.all([li[wn](...Ci),qn&&Qr.done]))[0]});return function(Ci){return Fr.apply(this,arguments)}}();return Wt.set(Et,Rr),Rr}!function et(Kt){pt=Kt(pt)}(Kt=>({...Kt,get:(Et,wn,cr)=>Nt(Et,wn)||Kt.get(Et,wn,cr),has:(Et,wn)=>!!Nt(Et,wn)||Kt.has(Et,wn)}));class an{constructor(Et){this.container=Et}getPlatformInfoString(){return this.container.getProviders().map(wn=>{if(function Qt(Kt){const Et=Kt.getComponent();return"VERSION"===Et?.type}(wn)){const cr=wn.getImmediate();return`${cr.library}/${cr.version}`}return null}).filter(wn=>wn).join(" ")}}const Vt="@firebase/app",Zt=new lt.Yd("@firebase/app"),hr="[DEFAULT]",wr={[Vt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},_r=new Map,mr=new Map;function Di(Kt,Et){try{Kt.container.addComponent(Et)}catch(wn){Zt.debug(`Component ${Et.name} failed to register with FirebaseApp ${Kt.name}`,wn)}}function Gi(Kt,Et){Kt.container.addOrOverwriteComponent(Et)}function Tr(Kt){const Et=Kt.name;if(mr.has(Et))return Zt.debug(`There were multiple attempts to register component ${Et}.`),!1;mr.set(Et,Kt);for(const wn of _r.values())Di(wn,Kt);return!0}function Mi(Kt,Et){const wn=Kt.container.getProvider("heartbeat").getImmediate({optional:!0});return wn&&wn.triggerHeartbeat(),Kt.container.getProvider(Et)}function yi(Kt,Et,wn=hr){Mi(Kt,Et).clearInstance(wn)}function Yr(){mr.clear()}const Or=new l.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Co{constructor(Et,wn,cr){this._isDeleted=!1,this._options=Object.assign({},Et),this._config=Object.assign({},wn),this._name=wn.name,this._automaticDataCollectionEnabled=wn.automaticDataCollectionEnabled,this._container=cr,this.container.addComponent(new w.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Et){this.checkDestroyed(),this._automaticDataCollectionEnabled=Et}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Et){this._isDeleted=Et}checkDestroyed(){if(this.isDeleted)throw Or.create("app-deleted",{appName:this._name})}}const Xe="10.6.0";function ue(Kt,Et={}){let wn=Kt;"object"!=typeof Et&&(Et={name:Et});const cr=Object.assign({name:hr,automaticDataCollectionEnabled:!1},Et),qn=cr.name;if("string"!=typeof qn||!qn)throw Or.create("bad-app-name",{appName:String(qn)});if(wn||(wn=(0,l.aH)()),!wn)throw Or.create("no-options");const Rr=_r.get(qn);if(Rr){if((0,l.vZ)(wn,Rr.options)&&(0,l.vZ)(cr,Rr.config))return Rr;throw Or.create("duplicate-app",{appName:qn})}const Fr=new w.H0(qn);for(const Ci of mr.values())Fr.addComponent(Ci);const di=new Co(wn,cr,Fr);return _r.set(qn,di),di}function pe(Kt=hr){const Et=_r.get(Kt);if(!Et&&Kt===hr&&(0,l.aH)())return ue();if(!Et)throw Or.create("no-app",{appName:Kt});return Et}function He(){return Array.from(_r.values())}function at(Kt){return yt.apply(this,arguments)}function yt(){return(yt=(0,M.Z)(function*(Kt){const Et=Kt.name;_r.has(Et)&&(_r.delete(Et),yield Promise.all(Kt.container.getProviders().map(wn=>wn.delete())),Kt.isDeleted=!0)})).apply(this,arguments)}function Mt(Kt,Et,wn){var cr;let qn=null!==(cr=wr[Kt])&&void 0!==cr?cr:Kt;wn&&(qn+=`-${wn}`);const Rr=qn.match(/\s|\//),Fr=Et.match(/\s|\//);if(Rr||Fr){const di=[`Unable to register library "${qn}" with version "${Et}":`];return Rr&&di.push(`library name "${qn}" contains illegal characters (whitespace or "/")`),Rr&&Fr&&di.push("and"),Fr&&di.push(`version name "${Et}" contains illegal characters (whitespace or "/")`),void Zt.warn(di.join(" "))}Tr(new w.wA(`${qn}-version`,()=>({library:qn,version:Et}),"VERSION"))}function At(Kt,Et){if(null!==Kt&&"function"!=typeof Kt)throw Or.create("invalid-log-argument");(0,lt.Am)(Kt,Et)}function _t(Kt){(0,lt.Ub)(Kt)}const Bt="firebase-heartbeat-database",pn=1,ke="firebase-heartbeat-store";let se=null;function ce(){return se||(se=function ct(Kt,Et,{blocked:wn,upgrade:cr,blocking:qn,terminated:Rr}={}){const Fr=indexedDB.open(Kt,Et),di=Ce(Fr);return cr&&Fr.addEventListener("upgradeneeded",Ci=>{cr(Ce(Fr.result),Ci.oldVersion,Ci.newVersion,Ce(Fr.transaction),Ci)}),wn&&Fr.addEventListener("blocked",Ci=>wn(Ci.oldVersion,Ci.newVersion,Ci)),di.then(Ci=>{Rr&&Ci.addEventListener("close",()=>Rr()),qn&&Ci.addEventListener("versionchange",Qr=>qn(Qr.oldVersion,Qr.newVersion,Qr))}).catch(()=>{}),di}(Bt,pn,{upgrade:(Kt,Et)=>{0===Et&&Kt.createObjectStore(ke)}}).catch(Kt=>{throw Or.create("idb-open",{originalErrorMessage:Kt.message})})),se}function fe(){return(fe=(0,M.Z)(function*(Kt){try{return yield(yield ce()).transaction(ke).objectStore(ke).get(mn(Kt))}catch(Et){if(Et instanceof l.ZR)Zt.warn(Et.message);else{const wn=Or.create("idb-get",{originalErrorMessage:Et?.message});Zt.warn(wn.message)}}})).apply(this,arguments)}function nt(Kt,Et){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,M.Z)(function*(Kt,Et){try{const cr=(yield ce()).transaction(ke,"readwrite");yield cr.objectStore(ke).put(Et,mn(Kt)),yield cr.done}catch(wn){if(wn instanceof l.ZR)Zt.warn(wn.message);else{const cr=Or.create("idb-set",{originalErrorMessage:wn?.message});Zt.warn(cr.message)}}})).apply(this,arguments)}function mn(Kt){return`${Kt.name}!${Kt.options.appId}`}class dr{constructor(Et){this.container=Et,this._heartbeatsCache=null;const wn=this.container.getProvider("app").getImmediate();this._storage=new ti(wn),this._heartbeatsCachePromise=this._storage.read().then(cr=>(this._heartbeatsCache=cr,cr))}triggerHeartbeat(){var Et=this;return(0,M.Z)(function*(){var wn;const qn=Et.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Rr=yr();if(null==(null===(wn=Et._heartbeatsCache)||void 0===wn?void 0:wn.heartbeats)&&(Et._heartbeatsCache=yield Et._heartbeatsCachePromise),Et._heartbeatsCache.lastSentHeartbeatDate!==Rr&&!Et._heartbeatsCache.heartbeats.some(Fr=>Fr.date===Rr))return Et._heartbeatsCache.heartbeats.push({date:Rr,agent:qn}),Et._heartbeatsCache.heartbeats=Et._heartbeatsCache.heartbeats.filter(Fr=>{const di=new Date(Fr.date).valueOf();return Date.now()-di<=2592e6}),Et._storage.overwrite(Et._heartbeatsCache)})()}getHeartbeatsHeader(){var Et=this;return(0,M.Z)(function*(){var wn;if(null===Et._heartbeatsCache&&(yield Et._heartbeatsCachePromise),null==(null===(wn=Et._heartbeatsCache)||void 0===wn?void 0:wn.heartbeats)||0===Et._heartbeatsCache.heartbeats.length)return"";const cr=yr(),{heartbeatsToSend:qn,unsentEntries:Rr}=function Hr(Kt,Et=1024){const wn=[];let cr=Kt.slice();for(const qn of Kt){const Rr=wn.find(Fr=>Fr.agent===qn.agent);if(Rr){if(Rr.dates.push(qn.date),no(wn)>Et){Rr.dates.pop();break}}else if(wn.push({agent:qn.agent,dates:[qn.date]}),no(wn)>Et){wn.pop();break}cr=cr.slice(1)}return{heartbeatsToSend:wn,unsentEntries:cr}}(Et._heartbeatsCache.heartbeats),Fr=(0,l.L)(JSON.stringify({version:2,heartbeats:qn}));return Et._heartbeatsCache.lastSentHeartbeatDate=cr,Rr.length>0?(Et._heartbeatsCache.heartbeats=Rr,yield Et._storage.overwrite(Et._heartbeatsCache)):(Et._heartbeatsCache.heartbeats=[],Et._storage.overwrite(Et._heartbeatsCache)),Fr})()}}function yr(){return(new Date).toISOString().substring(0,10)}class ti{constructor(Et){this.app=Et,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,M.Z)(function*(){return!!(0,l.hl)()&&(0,l.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Et=this;return(0,M.Z)(function*(){return(yield Et._canUseIndexedDBPromise)&&(yield function Fe(Kt){return fe.apply(this,arguments)}(Et.app))||{heartbeats:[]}})()}overwrite(Et){var wn=this;return(0,M.Z)(function*(){var cr;if(yield wn._canUseIndexedDBPromise){const Rr=yield wn.read();return nt(wn.app,{lastSentHeartbeatDate:null!==(cr=Et.lastSentHeartbeatDate)&&void 0!==cr?cr:Rr.lastSentHeartbeatDate,heartbeats:Et.heartbeats})}})()}add(Et){var wn=this;return(0,M.Z)(function*(){var cr;if(yield wn._canUseIndexedDBPromise){const Rr=yield wn.read();return nt(wn.app,{lastSentHeartbeatDate:null!==(cr=Et.lastSentHeartbeatDate)&&void 0!==cr?cr:Rr.lastSentHeartbeatDate,heartbeats:[...Rr.heartbeats,...Et.heartbeats]})}})()}}function no(Kt){return(0,l.L)(JSON.stringify({version:2,heartbeats:Kt})).length}!function Bo(Kt){Tr(new w.wA("platform-logger",Et=>new an(Et),"PRIVATE")),Tr(new w.wA("heartbeat",Et=>new dr(Et),"PRIVATE")),Mt(Vt,"0.9.23",Kt),Mt(Vt,"0.9.23","esm2017"),Mt("fire-js","")}("")},4537:(Hn,It,X)=>{"use strict";X.d(It,{H0:()=>tt,wA:()=>lt});var M=X(5861),w=X(9058);class lt{constructor(ye,Ae,Ze){this.name=ye,this.instanceFactory=Ae,this.type=Ze,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(ye){return this.instantiationMode=ye,this}setMultipleInstances(ye){return this.multipleInstances=ye,this}setServiceProps(ye){return this.serviceProps=ye,this}setInstanceCreatedCallback(ye){return this.onInstanceCreated=ye,this}}const l="[DEFAULT]";class _e{constructor(ye,Ae){this.name=ye,this.container=Ae,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(ye){const Ae=this.normalizeInstanceIdentifier(ye);if(!this.instancesDeferred.has(Ae)){const Ze=new w.BH;if(this.instancesDeferred.set(Ae,Ze),this.isInitialized(Ae)||this.shouldAutoInitialize())try{const Qe=this.getOrInitializeService({instanceIdentifier:Ae});Qe&&Ze.resolve(Qe)}catch{}}return this.instancesDeferred.get(Ae).promise}getImmediate(ye){var Ae;const Ze=this.normalizeInstanceIdentifier(ye?.identifier),Qe=null!==(Ae=ye?.optional)&&void 0!==Ae&&Ae;if(!this.isInitialized(Ze)&&!this.shouldAutoInitialize()){if(Qe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ze})}catch(ot){if(Qe)return null;throw ot}}getComponent(){return this.component}setComponent(ye){if(ye.name!==this.name)throw Error(`Mismatching Component ${ye.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=ye,this.shouldAutoInitialize()){if(function Le(Ke){return"EAGER"===Ke.instantiationMode}(ye))try{this.getOrInitializeService({instanceIdentifier:l})}catch{}for(const[Ae,Ze]of this.instancesDeferred.entries()){const Qe=this.normalizeInstanceIdentifier(Ae);try{const ot=this.getOrInitializeService({instanceIdentifier:Qe});Ze.resolve(ot)}catch{}}}}clearInstance(ye=l){this.instancesDeferred.delete(ye),this.instancesOptions.delete(ye),this.instances.delete(ye)}delete(){var ye=this;return(0,M.Z)(function*(){const Ae=Array.from(ye.instances.values());yield Promise.all([...Ae.filter(Ze=>"INTERNAL"in Ze).map(Ze=>Ze.INTERNAL.delete()),...Ae.filter(Ze=>"_delete"in Ze).map(Ze=>Ze._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(ye=l){return this.instances.has(ye)}getOptions(ye=l){return this.instancesOptions.get(ye)||{}}initialize(ye={}){const{options:Ae={}}=ye,Ze=this.normalizeInstanceIdentifier(ye.instanceIdentifier);if(this.isInitialized(Ze))throw Error(`${this.name}(${Ze}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Qe=this.getOrInitializeService({instanceIdentifier:Ze,options:Ae});for(const[ot,mt]of this.instancesDeferred.entries())Ze===this.normalizeInstanceIdentifier(ot)&&mt.resolve(Qe);return Qe}onInit(ye,Ae){var Ze;const Qe=this.normalizeInstanceIdentifier(Ae),ot=null!==(Ze=this.onInitCallbacks.get(Qe))&&void 0!==Ze?Ze:new Set;ot.add(ye),this.onInitCallbacks.set(Qe,ot);const mt=this.instances.get(Qe);return mt&&ye(mt,Qe),()=>{ot.delete(ye)}}invokeOnInitCallbacks(ye,Ae){const Ze=this.onInitCallbacks.get(Ae);if(Ze)for(const Qe of Ze)try{Qe(ye,Ae)}catch{}}getOrInitializeService({instanceIdentifier:ye,options:Ae={}}){let Ze=this.instances.get(ye);if(!Ze&&this.component&&(Ze=this.component.instanceFactory(this.container,{instanceIdentifier:(Ke=ye,Ke===l?void 0:Ke),options:Ae}),this.instances.set(ye,Ze),this.instancesOptions.set(ye,Ae),this.invokeOnInitCallbacks(Ze,ye),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,ye,Ze)}catch{}var Ke;return Ze||null}normalizeInstanceIdentifier(ye=l){return this.component?this.component.multipleInstances?ye:l:ye}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class tt{constructor(ye){this.name=ye,this.providers=new Map}addComponent(ye){const Ae=this.getProvider(ye.name);if(Ae.isComponentSet())throw new Error(`Component ${ye.name} has already been registered with ${this.name}`);Ae.setComponent(ye)}addOrOverwriteComponent(ye){this.getProvider(ye.name).isComponentSet()&&this.providers.delete(ye.name),this.addComponent(ye)}getProvider(ye){if(this.providers.has(ye))return this.providers.get(ye);const Ae=new _e(ye,this);return this.providers.set(ye,Ae),Ae}getProviders(){return Array.from(this.providers.values())}}},7879:(Hn,It,X)=>{"use strict";X.d(It,{Am:()=>Ke,Ub:()=>tt,Yd:()=>Le,in:()=>w});const M=[];var w=function(ye){return ye[ye.DEBUG=0]="DEBUG",ye[ye.VERBOSE=1]="VERBOSE",ye[ye.INFO=2]="INFO",ye[ye.WARN=3]="WARN",ye[ye.ERROR=4]="ERROR",ye[ye.SILENT=5]="SILENT",ye}(w||{});const lt={debug:w.DEBUG,verbose:w.VERBOSE,info:w.INFO,warn:w.WARN,error:w.ERROR,silent:w.SILENT},l=w.INFO,_e={[w.DEBUG]:"log",[w.VERBOSE]:"log",[w.INFO]:"info",[w.WARN]:"warn",[w.ERROR]:"error"},Ne=(ye,Ae,...Ze)=>{if(Ae<ye.logLevel)return;const Qe=(new Date).toISOString(),ot=_e[Ae];if(!ot)throw new Error(`Attempted to log a message with an invalid logType (value: ${Ae})`);console[ot](`[${Qe}]  ${ye.name}:`,...Ze)};class Le{constructor(Ae){this.name=Ae,this._logLevel=l,this._logHandler=Ne,this._userLogHandler=null,M.push(this)}get logLevel(){return this._logLevel}set logLevel(Ae){if(!(Ae in w))throw new TypeError(`Invalid value "${Ae}" assigned to \`logLevel\``);this._logLevel=Ae}setLogLevel(Ae){this._logLevel="string"==typeof Ae?lt[Ae]:Ae}get logHandler(){return this._logHandler}set logHandler(Ae){if("function"!=typeof Ae)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Ae}get userLogHandler(){return this._userLogHandler}set userLogHandler(Ae){this._userLogHandler=Ae}debug(...Ae){this._userLogHandler&&this._userLogHandler(this,w.DEBUG,...Ae),this._logHandler(this,w.DEBUG,...Ae)}log(...Ae){this._userLogHandler&&this._userLogHandler(this,w.VERBOSE,...Ae),this._logHandler(this,w.VERBOSE,...Ae)}info(...Ae){this._userLogHandler&&this._userLogHandler(this,w.INFO,...Ae),this._logHandler(this,w.INFO,...Ae)}warn(...Ae){this._userLogHandler&&this._userLogHandler(this,w.WARN,...Ae),this._logHandler(this,w.WARN,...Ae)}error(...Ae){this._userLogHandler&&this._userLogHandler(this,w.ERROR,...Ae),this._logHandler(this,w.ERROR,...Ae)}}function tt(ye){M.forEach(Ae=>{Ae.setLogLevel(ye)})}function Ke(ye,Ae){for(const Ze of M){let Qe=null;Ae&&Ae.level&&(Qe=lt[Ae.level]),Ze.userLogHandler=null===ye?null:(ot,mt,...xt)=>{const pt=xt.map(et=>{if(null==et)return null;if("string"==typeof et)return et;if("number"==typeof et||"boolean"==typeof et)return et.toString();if(et instanceof Error)return et.message;try{return JSON.stringify(et)}catch{return null}}).filter(et=>et).join(" ");mt>=(Qe??ot.logLevel)&&ye({level:w[mt].toLowerCase(),message:pt,args:xt,type:ot.name})}}}},7852:(Hn,It,X)=>{"use strict";X.d(It,{w:()=>Jt,dr:()=>wr,oU:()=>mr,cs:()=>jo,YG:()=>yi,Sm:()=>Yr,PM:()=>Do,FN:()=>Or,Zi:()=>Co,tO:()=>Xe,Dq:()=>ue,wI:()=>at,W2:()=>yt,fr:()=>ke,Gu:()=>ce,gu:()=>Fe,pK:()=>mn,Ie:()=>Zn,Q$:()=>no,z0:()=>wn,fG:()=>cr,jP:()=>go,cJ:()=>Po,GO:()=>No,wd:()=>un,ho:()=>lr,sr:()=>Cr,Pc:()=>ba,r4:()=>gs,HT:()=>va,SH:()=>To,YI:()=>ms,QI:()=>Fn,j9:()=>pr,yF:()=>oo});var M=X(5861),w=X(5879),lt=X(95),l=X(7582),_e=X(2438),Ne=X(8645),Le=X(5619),tt=X(2572),Ke=X(2096),ye=X(1160),mt=(X(6506),X(8899),X(5298),X(8077),X(7876)),xt=X(544),pt=X(1273),et=X(8354),Pt=(X(1767),X(8946)),ct=(X(7643),X(4587),X(6953)),Ye=X(2181),gt=X(4664),Wt=X(3997),Nt=X(6814);const Qt=mt.i,Zt=["*"],jt=P=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(P):"function"==typeof requestAnimationFrame?requestAnimationFrame(P):setTimeout(P);let nn=(()=>{class P{constructor(R,ne){this.injector=R,this.el=ne,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(R){this.el.nativeElement.value=this.lastValue=R,ln(this.el)}handleValueChange(R,ne){R===this.el.nativeElement&&(ne!==this.lastValue&&(this.lastValue=ne,this.onChange(ne)),ln(this.el))}_handleBlurEvent(R){R===this.el.nativeElement&&(this.onTouched(),ln(this.el))}registerOnChange(R){this.onChange=R}registerOnTouched(R){this.onTouched=R}setDisabledState(R){this.el.nativeElement.disabled=R}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let R;try{R=this.injector.get(lt.a5)}catch{}if(!R)return;R.statusChanges&&(this.statusChanges=R.statusChanges.subscribe(()=>ln(this.el)));const ne=R.control;ne&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(En=>{if(typeof ne[En]<"u"){const ar=ne[En].bind(ne);ne[En]=(...ir)=>{ar(...ir),ln(this.el)}}})}}return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.zs3),w.Y36(w.SBq))},P.\u0275dir=w.lG2({type:P,hostBindings:function(R,ne){1&R&&w.NdJ("ionBlur",function(En){return ne._handleBlurEvent(En.target)})}}),P})();const ln=P=>{jt(()=>{const K=P.nativeElement,R=null!=K.value&&K.value.toString().length>0,ne=_n(K);bn(K,ne);const Pe=K.closest("ion-item");Pe&&bn(Pe,R?[...ne,"item-has-value"]:ne)})},_n=P=>{const K=P.classList,R=[];for(let ne=0;ne<K.length;ne++){const Pe=K.item(ne);null!==Pe&&rn(Pe,"ng-")&&R.push(`ion-${Pe.substring(3)}`)}return R},bn=(P,K)=>{const R=P.classList;R.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),R.add(...K)},rn=(P,K)=>P.substring(0,K.length)===K;let Jt=(()=>{class P extends nn{constructor(R,ne){super(R,ne)}writeValue(R){this.el.nativeElement.checked=this.lastValue=R,ln(this.el)}_handleIonChange(R){this.handleValueChange(R,R.checked)}}return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.zs3),w.Y36(w.SBq))},P.\u0275dir=w.lG2({type:P,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(R,ne){1&R&&w.NdJ("ionChange",function(En){return ne._handleIonChange(En.target)})},features:[w._Bn([{provide:lt.JU,useExisting:P,multi:!0}]),w.qOj]}),P})(),Fn=(()=>{class P extends nn{constructor(R,ne){super(R,ne)}_handleChangeEvent(R){this.handleValueChange(R,R.value)}}return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.zs3),w.Y36(w.SBq))},P.\u0275dir=w.lG2({type:P,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(R,ne){1&R&&w.NdJ("ionChange",function(En){return ne._handleChangeEvent(En.target)})},features:[w._Bn([{provide:lt.JU,useExisting:P,multi:!0}]),w.qOj]}),P})(),pr=(()=>{class P extends nn{constructor(R,ne){super(R,ne)}_handleInputEvent(R){this.handleValueChange(R,R.value)}}return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.zs3),w.Y36(w.SBq))},P.\u0275dir=w.lG2({type:P,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(R,ne){1&R&&w.NdJ("ionInput",function(En){return ne._handleInputEvent(En.target)})},features:[w._Bn([{provide:lt.JU,useExisting:P,multi:!0}]),w.qOj]}),P})();const nr=(P,K)=>{const R=P.prototype;K.forEach(ne=>{Object.defineProperty(R,ne,{get(){return this.el[ne]},set(Pe){this.z.runOutsideAngular(()=>this.el[ne]=Pe)}})})},gr=(P,K)=>{const R=P.prototype;K.forEach(ne=>{R[ne]=function(){const Pe=arguments;return this.z.runOutsideAngular(()=>this.el[ne].apply(this.el,Pe))}})},Xn=(P,K,R)=>{R.forEach(ne=>P[ne]=(0,_e.R)(K,ne))};function yn(P){return function(R){const{defineCustomElementFn:ne,inputs:Pe,methods:En}=P;return void 0!==ne&&ne(),Pe&&nr(R,Pe),En&&gr(R,En),R}}let wr=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-app"]],ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({})],P),P})(),mr=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],P),P})(),yi=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement,Xn(this,this.el,["ionFocus","ionBlur"])}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],P),P})(),Yr=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["collapse"]})],P),P})(),Do=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],P),P})(),Or=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["mode"]})],P),P})(),Co=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","mode","translucent"]})],P),P})(),Xe=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-card-subtitle"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","mode"]})],P),P})(),ue=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-card-title"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","mode"]})],P),P})(),at=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],P),P})(),yt=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement,Xn(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],P),P})(),ke=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["collapse","mode","translucent"]})],P),P})(),ce=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["collapse","mode","translucent"]})],P),P})(),Fe=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],P),P})(),mn=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement,Xn(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",shape:"shape",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","shape","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],P),P})(),Zn=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],P),P})(),no=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","mode","position"]})],P),P})(),wn=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement,Xn(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],P),P})(),cr=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["autoHide","color","disabled","menu","mode","type"]})],P),P})(),Po=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement,Xn(this,this.el,["ionChange"])}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],P),P})(),No=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["disabled","layout","mode","type","value"]})],P),P})(),un=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","size"]})],P),P})(),lr=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement,Xn(this,this.el,["ionChange","ionFocus","ionBlur"])}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",justify:"justify",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",name:"name",value:"value"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["checked","color","disabled","enableOnOffLabels","justify","labelPlacement","legacy","mode","name","value"]})],P),P})(),Cr=(()=>{let P=class{constructor(R,ne,Pe){this.z=Pe,R.detach(),this.el=ne.nativeElement}};return P.\u0275fac=function(R){return new(R||P)(w.Y36(w.sBO),w.Y36(w.SBq),w.Y36(w.R0b))},P.\u0275cmp=w.Xpm({type:P,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Zt,decls:1,vars:0,template:function(R,ne){1&R&&(w.F$t(),w.Hsn(0))},encapsulation:2,changeDetection:0}),P=(0,l.gn)([yn({inputs:["color","mode"]})],P),P})(),kr=(()=>{class P{get(R,ne){const Pe=io();return Pe?Pe.get(R,ne):null}getBoolean(R,ne){const Pe=io();return!!Pe&&Pe.getBoolean(R,ne)}getNumber(R,ne){const Pe=io();return Pe?Pe.getNumber(R,ne):0}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const wi=new w.OlP("USERCONFIG"),io=()=>{if(typeof window<"u"){const P=window.Ionic;if(P?.config)return P.config}return null};let Hi=(()=>{class P{constructor(R,ne){this.doc=R,this.backButton=new Ne.x,this.keyboardDidShow=new Ne.x,this.keyboardDidHide=new Ne.x,this.pause=new Ne.x,this.resume=new Ne.x,this.resize=new Ne.x,ne.run(()=>{let Pe;this.win=R.defaultView,this.backButton.subscribeWithPriority=function(En,ar){return this.subscribe(ir=>ir.register(En,Oi=>ne.run(()=>ar(Oi))))},Pi(this.pause,R,"pause"),Pi(this.resume,R,"resume"),Pi(this.backButton,R,"ionBackButton"),Pi(this.resize,this.win,"resize"),Pi(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),Pi(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(En=>{Pe=En}),this.win?.cordova?R.addEventListener("deviceready",()=>{Pe("cordova")},{once:!0}):Pe("dom")})}is(R){return(0,mt.a)(this.win,R)}platforms(){return(0,mt.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(R){return Ki(this.win.location.href,R)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia?.("(orientation: portrait)").matches}testUserAgent(R){const ne=this.win.navigator;return!!(ne?.userAgent&&ne.userAgent.indexOf(R)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return P.\u0275fac=function(R){return new(R||P)(w.LFG(Nt.K0),w.LFG(w.R0b))},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const Ki=(P,K)=>{K=K.replace(/[[\]\\]/g,"\\$&");const ne=new RegExp("[\\?&]"+K+"=([^&#]*)").exec(P);return ne?decodeURIComponent(ne[1].replace(/\+/g," ")):null},Pi=(P,K,R)=>{K&&K.addEventListener(R,ne=>{const Pe=ne?.detail;P.next(Pe)})};let To=(()=>{class P{constructor(R,ne,Pe,En){this.location=ne,this.serializer=Pe,this.router=En,this.direction=qr,this.animated=Ji,this.guessDirection="forward",this.lastNavId=-1,En&&En.events.subscribe(ar=>{if(ar instanceof ye.OD){const ir=ar.restoredState?ar.restoredState.navigationId:ar.id;this.guessDirection=ir<this.lastNavId?"back":"forward",this.guessAnimation=ar.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?ar.id:ir}}),R.backButton.subscribeWithPriority(0,ar=>{this.pop(),ar()})}navigateForward(R,ne={}){return this.setDirection("forward",ne.animated,ne.animationDirection,ne.animation),this.navigate(R,ne)}navigateBack(R,ne={}){return this.setDirection("back",ne.animated,ne.animationDirection,ne.animation),this.navigate(R,ne)}navigateRoot(R,ne={}){return this.setDirection("root",ne.animated,ne.animationDirection,ne.animation),this.navigate(R,ne)}back(R={animated:!0,animationDirection:"back"}){return this.setDirection("back",R.animated,R.animationDirection,R.animation),this.location.back()}pop(){var R=this;return(0,M.Z)(function*(){let ne=R.topOutlet;for(;ne;){if(yield ne.pop())return!0;ne=ne.parentOutlet}return!1})()}setDirection(R,ne,Pe,En){this.direction=R,this.animated=Vr(R,ne,Pe),this.animationBuilder=En}setTopOutlet(R){this.topOutlet=R}consumeTransition(){let ne,R="root";const Pe=this.animationBuilder;return"auto"===this.direction?(R=this.guessDirection,ne=this.guessAnimation):(ne=this.animated,R=this.direction),this.direction=qr,this.animated=Ji,this.animationBuilder=void 0,{direction:R,animation:ne,animationBuilder:Pe}}navigate(R,ne){if(Array.isArray(R))return this.router.navigate(R,ne);{const Pe=this.serializer.parse(R.toString());return void 0!==ne.queryParams&&(Pe.queryParams={...ne.queryParams}),void 0!==ne.fragment&&(Pe.fragment=ne.fragment),this.router.navigateByUrl(Pe,ne)}}}return P.\u0275fac=function(R){return new(R||P)(w.LFG(Hi),w.LFG(Nt.Ye),w.LFG(ye.Hx),w.LFG(ye.F0,8))},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const Vr=(P,K,R)=>{if(!1!==K){if(void 0!==R)return R;if("forward"===P||"back"===P)return P;if("root"===P&&!0===K)return"forward"}},qr="auto",Ji=void 0;class ps{constructor(K={}){this.data=K}get(K){return this.data[K]}}let Ai=(()=>{class P{constructor(){this.zone=(0,w.f3M)(w.R0b),this.applicationRef=(0,w.f3M)(w.z2F)}create(R,ne,Pe){return new So(R,ne,this.applicationRef,this.zone,Pe)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac}),P})();class So{constructor(K,R,ne,Pe,En){this.environmentInjector=K,this.injector=R,this.applicationRef=ne,this.zone=Pe,this.elementReferenceKey=En,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(K,R,ne,Pe){return this.zone.run(()=>new Promise(En=>{const ar={...ne};void 0!==this.elementReferenceKey&&(ar[this.elementReferenceKey]=K),En(Ks(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,K,R,ar,Pe,this.elementReferenceKey))}))}removeViewFromDom(K,R){return this.zone.run(()=>new Promise(ne=>{const Pe=this.elRefMap.get(R);if(Pe){Pe.destroy(),this.elRefMap.delete(R);const En=this.elEventsMap.get(R);En&&(En(),this.elEventsMap.delete(R))}ne()}))}}const Ks=(P,K,R,ne,Pe,En,ar,ir,Oi,so,ee)=>{const Y=w.zs3.create({providers:Ri(Oi),parent:R}),Me=(0,w.LMc)(ir,{environmentInjector:K,elementInjector:Y}),re=Me.instance,We=Me.location.nativeElement;if(Oi&&(ee&&void 0!==re[ee]&&console.error(`[Ionic Error]: ${ee} is a reserved property when using ${ar.tagName.toLowerCase()}. Rename or remove the "${ee}" property from ${ir.name}.`),Object.assign(re,Oi)),so)for(const zr of so)We.classList.add(zr);const zn=Bi(P,re,We);return ar.appendChild(We),ne.attachView(Me.hostView),Pe.set(We,Me),En.set(We,zn),We},as=[et.L,et.a,et.b,et.c,et.d],Bi=(P,K,R)=>P.run(()=>{const ne=as.filter(Pe=>"function"==typeof K[Pe]).map(Pe=>{const En=ar=>K[Pe](ar.detail);return R.addEventListener(Pe,En),()=>R.removeEventListener(Pe,En)});return()=>ne.forEach(Pe=>Pe())}),Os=new w.OlP("NavParamsToken"),Ri=P=>[{provide:Os,useValue:P},{provide:ps,useFactory:rr,deps:[Os]}],rr=P=>new ps(P),Ti=(P,K)=>((P=P.filter(R=>R.stackId!==K.stackId)).push(K),P),Si=(P,K)=>{const R=P.createUrlTree(["."],{relativeTo:K});return P.serializeUrl(R)},Qi=(P,K)=>{if(!P)return;const R=$o(K);for(let ne=0;ne<R.length;ne++){if(ne>=P.length)return R[ne];if(R[ne]!==P[ne])return}},$o=P=>P.split("/").map(K=>K.trim()).filter(K=>""!==K),Vo=P=>{P&&(P.ref.destroy(),P.unlistenEvents())};class Mr{constructor(K,R,ne,Pe,En,ar){this.containerEl=R,this.router=ne,this.navCtrl=Pe,this.zone=En,this.location=ar,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==K?$o(K):void 0}createView(K,R){const ne=Si(this.router,R),Pe=K?.location?.nativeElement,En=Bi(this.zone,K.instance,Pe);return{id:this.nextId++,stackId:Qi(this.tabsPrefix,ne),unlistenEvents:En,element:Pe,ref:K,url:ne}}getExistingView(K){const R=Si(this.router,K),ne=this.views.find(Pe=>Pe.url===R);return ne&&ne.ref.changeDetectorRef.reattach(),ne}setActive(K){const R=this.navCtrl.consumeTransition();let{direction:ne,animation:Pe,animationBuilder:En}=R;const ar=this.activeView,ir=((P,K)=>!K||P.stackId!==K.stackId)(K,ar);ir&&(ne="back",Pe=void 0);const Oi=this.views.slice();let so;const ee=this.router;ee.getCurrentNavigation?so=ee.getCurrentNavigation():ee.navigations?.value&&(so=ee.navigations.value),so?.extras?.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const Y=this.views.includes(K),Me=this.insertView(K,ne);Y||K.ref.changeDetectorRef.detectChanges();const re=K.animationBuilder;return void 0===En&&"back"===ne&&!ir&&void 0!==re&&(En=re),ar&&(ar.animationBuilder=En),this.zone.runOutsideAngular(()=>this.wait(()=>(ar&&ar.ref.changeDetectorRef.detach(),K.ref.changeDetectorRef.reattach(),this.transition(K,ar,Pe,this.canGoBack(1),!1,En).then(()=>ks(K,Me,Oi,this.location,this.zone)).then(()=>({enteringView:K,direction:ne,animation:Pe,tabSwitch:ir})))))}canGoBack(K,R=this.getActiveStackId()){return this.getStack(R).length>K}pop(K,R=this.getActiveStackId()){return this.zone.run(()=>{const ne=this.getStack(R);if(ne.length<=K)return Promise.resolve(!1);const Pe=ne[ne.length-K-1];let En=Pe.url;const ar=Pe.savedData;if(ar){const Oi=ar.get("primary");Oi?.route?._routerState?.snapshot.url&&(En=Oi.route._routerState.snapshot.url)}const{animationBuilder:ir}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(En,{...Pe.savedExtras,animation:ir}).then(()=>!0)})}startBackTransition(){const K=this.activeView;if(K){const R=this.getStack(K.stackId),ne=R[R.length-2],Pe=ne.animationBuilder;return this.wait(()=>this.transition(ne,K,"back",this.canGoBack(2),!0,Pe))}return Promise.resolve()}endBackTransition(K){K?(this.skipTransition=!0,this.pop(1)):this.activeView&&ls(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(K){const R=this.getStack(K);return R.length>0?R[R.length-1]:void 0}getRootUrl(K){const R=this.getStack(K);return R.length>0?R[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(Vo),this.activeView=void 0,this.views=[]}getStack(K){return this.views.filter(R=>R.stackId===K)}insertView(K,R){return this.activeView=K,this.views=((P,K,R)=>"root"===R?Ti(P,K):"forward"===R?((P,K)=>(P.indexOf(K)>=0?P=P.filter(ne=>ne.stackId!==K.stackId||ne.id<=K.id):P.push(K),P))(P,K):((P,K)=>P.indexOf(K)>=0?P.filter(ne=>ne.stackId!==K.stackId||ne.id<=K.id):Ti(P,K))(P,K))(this.views,K,R),this.views.slice()}transition(K,R,ne,Pe,En,ar){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(R===K)return Promise.resolve(!1);const ir=K?K.element:void 0,Oi=R?R.element:void 0,so=this.containerEl;return ir&&ir!==Oi&&(ir.classList.add("ion-page"),ir.classList.add("ion-page-invisible"),ir.parentElement!==so&&so.appendChild(ir),so.commit)?so.commit(ir,Oi,{duration:void 0===ne?0:void 0,direction:ne,showGoBack:Pe,progressAnimation:En,animationBuilder:ar}):Promise.resolve(!1)}wait(K){var R=this;return(0,M.Z)(function*(){void 0!==R.runningTask&&(yield R.runningTask,R.runningTask=void 0);const ne=R.runningTask=K();return ne.finally(()=>R.runningTask=void 0),ne})()}}const ks=(P,K,R,ne,Pe)=>"function"==typeof requestAnimationFrame?new Promise(En=>{requestAnimationFrame(()=>{ls(P,K,R,ne,Pe),En()})}):Promise.resolve(),ls=(P,K,R,ne,Pe)=>{Pe.run(()=>R.filter(En=>!K.includes(En)).forEach(Vo)),K.forEach(En=>{const ir=ne.path().split("?")[0].split("#")[0];if(En!==P&&En.url!==ir){const Oi=En.element;Oi.setAttribute("aria-hidden","true"),Oi.classList.add("ion-page-hidden"),En.ref.changeDetectorRef.detach()}})};let go=(()=>{class P{constructor(R,ne,Pe,En,ar,ir,Oi,so){this.parentOutlet=so,this.activatedView=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new Le.X(null),this.activated=null,this._activatedRoute=null,this.name=ye.eC,this.stackEvents=new w.vpe,this.activateEvents=new w.vpe,this.deactivateEvents=new w.vpe,this.parentContexts=(0,w.f3M)(ye.y6),this.location=(0,w.f3M)(w.s_b),this.environmentInjector=(0,w.f3M)(w.lqb),this.inputBinder=(0,w.f3M)(es,{optional:!0}),this.supportsBindingToComponentInputs=!0,this.config=(0,w.f3M)(kr),this.navCtrl=(0,w.f3M)(To),this.nativeEl=En.nativeElement,this.name=R||ye.eC,this.tabsPrefix="true"===ne?Si(ar,Oi):void 0,this.stackCtrl=new Mr(this.tabsPrefix,this.nativeEl,ar,this.navCtrl,ir,Pe),this.parentContexts.onChildOutletCreated(this.name,this)}get activatedComponentRef(){return this.activated}set animation(R){this.nativeEl.animation=R}set animated(R){this.nativeEl.animated=R}set swipeGesture(R){this._swipeGesture=R,this.nativeEl.swipeHandler=R?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ne=>this.stackCtrl.endBackTransition(ne)}:void 0}ngOnDestroy(){this.stackCtrl.destroy(),this.inputBinder?.unsubscribeFromRouteData(this)}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const R=this.getContext();R?.route&&this.activateWith(R.route,R.injector)}new Promise(R=>(0,xt.c)(this.nativeEl,R)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(R,ne){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ne=this.getContext();this.activatedView.savedData=new Map(ne.children.contexts);const Pe=this.activatedView.savedData.get("primary");if(Pe&&ne.route&&(Pe.route={...ne.route}),this.activatedView.savedExtras={},ne.route){const En=ne.route.snapshot;this.activatedView.savedExtras.queryParams=En.queryParams,this.activatedView.savedExtras.fragment=En.fragment}}const R=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(R)}}activateWith(R,ne){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=R;let Pe,En=this.stackCtrl.getExistingView(R);if(En){Pe=this.activated=En.ref;const ar=En.savedData;ar&&(this.getContext().children.contexts=ar),this.updateActivatedRouteProxy(Pe.instance,R)}else{const ar=R._futureSnapshot,ir=this.parentContexts.getOrCreateContext(this.name).children,Oi=new Le.X(null),so=this.createActivatedRouteProxy(Oi,R),ee=new $i(so,ir,this.location.injector);Pe=this.activated=this.location.createComponent(ar.routeConfig.component??ar.component,{index:this.location.length,injector:ee,environmentInjector:ne??this.environmentInjector}),Oi.next(Pe.instance),En=this.stackCtrl.createView(this.activated,R),this.proxyMap.set(Pe.instance,so),this.currentActivatedRoute$.next({component:Pe.instance,activatedRoute:R})}this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activatedView=En,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(En).then(ar=>{this.activateEvents.emit(Pe.instance),this.stackEvents.emit(ar)})}canGoBack(R=1,ne){return this.stackCtrl.canGoBack(R,ne)}pop(R=1,ne){return this.stackCtrl.pop(R,ne)}getLastUrl(R){const ne=this.stackCtrl.getLastUrl(R);return ne?ne.url:void 0}getLastRouteView(R){return this.stackCtrl.getLastUrl(R)}getRootView(R){return this.stackCtrl.getRootUrl(R)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(R,ne){const Pe=new ye.gz;return Pe._futureSnapshot=ne._futureSnapshot,Pe._routerState=ne._routerState,Pe.snapshot=ne.snapshot,Pe.outlet=ne.outlet,Pe.component=ne.component,Pe._paramMap=this.proxyObservable(R,"paramMap"),Pe._queryParamMap=this.proxyObservable(R,"queryParamMap"),Pe.url=this.proxyObservable(R,"url"),Pe.params=this.proxyObservable(R,"params"),Pe.queryParams=this.proxyObservable(R,"queryParams"),Pe.fragment=this.proxyObservable(R,"fragment"),Pe.data=this.proxyObservable(R,"data"),Pe}proxyObservable(R,ne){return R.pipe((0,Ye.h)(Pe=>!!Pe),(0,gt.w)(Pe=>this.currentActivatedRoute$.pipe((0,Ye.h)(En=>null!==En&&En.component===Pe),(0,gt.w)(En=>En&&En.activatedRoute[ne]),(0,Wt.x)())))}updateActivatedRouteProxy(R,ne){const Pe=this.proxyMap.get(R);if(!Pe)throw new Error("Could not find activated route proxy for view");Pe._futureSnapshot=ne._futureSnapshot,Pe._routerState=ne._routerState,Pe.snapshot=ne.snapshot,Pe.outlet=ne.outlet,Pe.component=ne.component,this.currentActivatedRoute$.next({component:R,activatedRoute:ne})}}return P.\u0275fac=function(R){return new(R||P)(w.$8M("name"),w.$8M("tabs"),w.Y36(Nt.Ye),w.Y36(w.SBq),w.Y36(ye.F0),w.Y36(w.R0b),w.Y36(ye.gz),w.Y36(P,12))},P.\u0275dir=w.lG2({type:P,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",name:"name"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),P})();class $i{constructor(K,R,ne){this.route=K,this.childContexts=R,this.parent=ne}get(K,R){return K===ye.gz?this.route:K===ye.y6?this.childContexts:this.parent.get(K,R)}}const es=new w.OlP("");let Ro=(()=>{class P{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(R){this.unsubscribeFromRouteData(R),this.subscribeToRouteData(R)}unsubscribeFromRouteData(R){this.outletDataSubscriptions.get(R)?.unsubscribe(),this.outletDataSubscriptions.delete(R)}subscribeToRouteData(R){const{activatedRoute:ne}=R,Pe=(0,tt.a)([ne.queryParams,ne.params,ne.data]).pipe((0,gt.w)(([En,ar,ir],Oi)=>(ir={...En,...ar,...ir},0===Oi?(0,Ke.of)(ir):Promise.resolve(ir)))).subscribe(En=>{if(!R.isActivated||!R.activatedComponentRef||R.activatedRoute!==ne||null===ne.component)return void this.unsubscribeFromRouteData(R);const ar=(0,w.qFp)(ne.component);if(ar)for(const{templateName:ir}of ar.inputs)R.activatedComponentRef.setInput(ir,En[ir]);else this.unsubscribeFromRouteData(R)});this.outletDataSubscriptions.set(R,Pe)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac}),P})(),jo=(()=>{class P{constructor(R,ne,Pe){this.routerOutlet=R,this.navCtrl=ne,this.config=Pe}onClick(R){const ne=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet?.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),R.preventDefault()):null!=ne&&(this.navCtrl.navigateBack(ne,{animation:this.routerAnimation}),R.preventDefault())}}return P.\u0275fac=function(R){return new(R||P)(w.Y36(go,8),w.Y36(To),w.Y36(kr))},P.\u0275dir=w.lG2({type:P,selectors:[["ion-back-button"]],hostBindings:function(R,ne){1&R&&w.NdJ("click",function(En){return ne.onClick(En)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),P})(),ms=(()=>{class P{constructor(R,ne,Pe,En,ar){this.locationStrategy=R,this.navCtrl=ne,this.elementRef=Pe,this.router=En,this.routerLink=ar,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const R=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=R}}onClick(R){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),R.preventDefault()}}return P.\u0275fac=function(R){return new(R||P)(w.Y36(Nt.S$),w.Y36(To),w.Y36(w.SBq),w.Y36(ye.F0),w.Y36(ye.rH,8))},P.\u0275dir=w.lG2({type:P,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(R,ne){1&R&&w.NdJ("click",function(En){return ne.onClick(En)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[w.TTD]}),P})();class Qn{constructor(K){this.ctrl=K}create(K){return this.ctrl.create(K||{})}dismiss(K,R,ne){return this.ctrl.dismiss(K,R,ne)}getTop(){return this.ctrl.getTop()}}let va=(()=>{class P extends Qn{constructor(){super(Pt.l)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),co=(()=>{class P extends Qn{constructor(){super(Pt.m),this.angularDelegate=(0,w.f3M)(Ai),this.injector=(0,w.f3M)(w.zs3),this.environmentInjector=(0,w.f3M)(w.lqb)}create(R){return super.create({...R,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac}),P})(),Mo=(()=>{class P extends Qn{constructor(){super(Pt.c),this.angularDelegate=(0,w.f3M)(Ai),this.injector=(0,w.f3M)(w.zs3),this.environmentInjector=(0,w.f3M)(w.lqb)}create(R){return super.create({...R,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac}),P})(),oo=(()=>{class P extends Qn{constructor(){super(Pt.t)}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();class gs{shouldDetach(K){return!1}shouldAttach(K){return!1}store(K,R){}retrieve(K){return null}shouldReuseRoute(K,R){if(K.routeConfig!==R.routeConfig)return!1;const ne=K.params,Pe=R.params,En=Object.keys(ne),ar=Object.keys(Pe);if(En.length!==ar.length)return!1;for(const ir of En)if(Pe[ir]!==ne[ir])return!1;return!0}}const us=(P,K,R)=>()=>{if(K.defaultView&&typeof window<"u"){(0,pt.s)({...P,_zoneGate:En=>R.run(En)});const Pe="__zone_symbol__addEventListener"in K.body?"__zone_symbol__addEventListener":"addEventListener";return function an(){var P=[];if(typeof window<"u"){var K=window;(!K.customElements||K.Element&&(!K.Element.prototype.closest||!K.Element.prototype.matches||!K.Element.prototype.remove||!K.Element.prototype.getRootNode))&&P.push(X.e(6748).then(X.t.bind(X,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||K.NodeList&&!K.NodeList.prototype.forEach||!K.fetch||!function(){try{var ne=new URL("b","http://a");return ne.pathname="c%20d","http://a/c%20d"===ne.href&&ne.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&P.push(X.e(2214).then(X.t.bind(X,2668,23)))}return Promise.all(P)}().then(()=>((P,K)=>typeof window>"u"?Promise.resolve():(0,ct.p)().then(()=>(Qt(),(0,ct.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"activated":[32]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"legacy":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),K))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:jt,jmp:En=>R.runOutsideAngular(En),ael(En,ar,ir,Oi){En[Pe](ar,ir,Oi)},rel(En,ar,ir,Oi){En.removeEventListener(ar,ir,Oi)}}))}};let ba=(()=>{class P{static forRoot(R){return{ngModule:P,providers:[{provide:wi,useValue:R},{provide:w.ip1,useFactory:us,multi:!0,deps:[wi,Nt.K0,w.R0b]},{provide:es,useFactory:Js,deps:[ye.F0]}]}}}return P.\u0275fac=function(R){return new(R||P)},P.\u0275mod=w.oAB({type:P}),P.\u0275inj=w.cJS({providers:[Ai,co,Mo],imports:[Nt.ez]}),P})();function Js(P){return P?.componentInputBindingEnabled?new Ro:null}},3182:(Hn,It,X)=>{"use strict";X.d(It,{C6:()=>M.getApps,Mq:()=>M.getApp});var M=X(534);(0,M.registerVersion)("firebase","10.6.0","app")},7142:(Hn,It,X)=>{"use strict";X.d(It,{Z:()=>M.Z});var M=X(3106);M.Z.registerVersion("firebase","10.6.0","app-compat")},5861:(Hn,It,X)=>{"use strict";function M(lt,l,_e,Ne,Le,tt,Ke){try{var ye=lt[tt](Ke),Ae=ye.value}catch(Ze){return void _e(Ze)}ye.done?l(Ae):Promise.resolve(Ae).then(Ne,Le)}function w(lt){return function(){var l=this,_e=arguments;return new Promise(function(Ne,Le){var tt=lt.apply(l,_e);function Ke(Ae){M(tt,Ne,Le,Ke,ye,"next",Ae)}function ye(Ae){M(tt,Ne,Le,Ke,ye,"throw",Ae)}Ke(void 0)})}}X.d(It,{Z:()=>w})},1180:(Hn,It,X)=>{"use strict";function M(_e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Ne){return typeof Ne}:function(Ne){return Ne&&"function"==typeof Symbol&&Ne.constructor===Symbol&&Ne!==Symbol.prototype?"symbol":typeof Ne})(_e)}function l(_e,Ne,Le){return(Ne=function lt(_e){var Ne=function w(_e,Ne){if("object"!==M(_e)||null===_e)return _e;var Le=_e[Symbol.toPrimitive];if(void 0!==Le){var tt=Le.call(_e,Ne||"default");if("object"!==M(tt))return tt;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===Ne?String:Number)(_e)}(_e,"string");return"symbol"===M(Ne)?Ne:String(Ne)}(Ne))in _e?Object.defineProperty(_e,Ne,{value:Le,enumerable:!0,configurable:!0,writable:!0}):_e[Ne]=Le,_e}X.d(It,{Z:()=>l})},7582:(Hn,It,X)=>{"use strict";function l(Se,ze){var ut={};for(var Dt in Se)Object.prototype.hasOwnProperty.call(Se,Dt)&&ze.indexOf(Dt)<0&&(ut[Dt]=Se[Dt]);if(null!=Se&&"function"==typeof Object.getOwnPropertySymbols){var jt=0;for(Dt=Object.getOwnPropertySymbols(Se);jt<Dt.length;jt++)ze.indexOf(Dt[jt])<0&&Object.prototype.propertyIsEnumerable.call(Se,Dt[jt])&&(ut[Dt[jt]]=Se[Dt[jt]])}return ut}function _e(Se,ze,ut,Dt){var ln,jt=arguments.length,nn=jt<3?ze:null===Dt?Dt=Object.getOwnPropertyDescriptor(ze,ut):Dt;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)nn=Reflect.decorate(Se,ze,ut,Dt);else for(var _n=Se.length-1;_n>=0;_n--)(ln=Se[_n])&&(nn=(jt<3?ln(nn):jt>3?ln(ze,ut,nn):ln(ze,ut))||nn);return jt>3&&nn&&Object.defineProperty(ze,ut,nn),nn}function Ze(Se,ze,ut,Dt){return new(ut||(ut=Promise))(function(nn,ln){function _n(Jt){try{rn(Dt.next(Jt))}catch(en){ln(en)}}function bn(Jt){try{rn(Dt.throw(Jt))}catch(en){ln(en)}}function rn(Jt){Jt.done?nn(Jt.value):function jt(nn){return nn instanceof ut?nn:new ut(function(ln){ln(nn)})}(Jt.value).then(_n,bn)}rn((Dt=Dt.apply(Se,ze||[])).next())})}function Ce(Se){return this instanceof Ce?(this.v=Se,this):new Ce(Se)}function Ie(Se,ze,ut){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var jt,Dt=ut.apply(Se,ze||[]),nn=[];return jt={},ln("next"),ln("throw"),ln("return"),jt[Symbol.asyncIterator]=function(){return this},jt;function ln(dn){Dt[dn]&&(jt[dn]=function(Fn){return new Promise(function(pr,nr){nn.push([dn,Fn,pr,nr])>1||_n(dn,Fn)})})}function _n(dn,Fn){try{!function bn(dn){dn.value instanceof Ce?Promise.resolve(dn.value.v).then(rn,Jt):en(nn[0][2],dn)}(Dt[dn](Fn))}catch(pr){en(nn[0][3],pr)}}function rn(dn){_n("next",dn)}function Jt(dn){_n("throw",dn)}function en(dn,Fn){dn(Fn),nn.shift(),nn.length&&_n(nn[0][0],nn[0][1])}}function St(Se){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ut,ze=Se[Symbol.asyncIterator];return ze?ze.call(Se):(Se=function xt(Se){var ze="function"==typeof Symbol&&Symbol.iterator,ut=ze&&Se[ze],Dt=0;if(ut)return ut.call(Se);if(Se&&"number"==typeof Se.length)return{next:function(){return Se&&Dt>=Se.length&&(Se=void 0),{value:Se&&Se[Dt++],done:!Se}}};throw new TypeError(ze?"Object is not iterable.":"Symbol.iterator is not defined.")}(Se),ut={},Dt("next"),Dt("throw"),Dt("return"),ut[Symbol.asyncIterator]=function(){return this},ut);function Dt(nn){ut[nn]=Se[nn]&&function(ln){return new Promise(function(_n,bn){!function jt(nn,ln,_n,bn){Promise.resolve(bn).then(function(rn){nn({value:rn,done:_n})},ln)}(_n,bn,(ln=Se[nn](ln)).done,ln.value)})}}}X.d(It,{FC:()=>Ie,KL:()=>St,_T:()=>l,gn:()=>_e,mG:()=>Ze,qq:()=>Ce}),"function"==typeof SuppressedError&&SuppressedError}},Hn=>{Hn(Hn.s=335)}]);